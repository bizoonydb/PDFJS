!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("dayjs"),require("dayjs-plugin-utc"),require("dialog-polyfill"),require("eventemitter3"),require("file-saver"),require("hammerjs"),require("i18next"),require("i18next-chained-backend"),require("i18next-localstorage-backend"),require("i18next-xhr-backend"),require("jquery"),require("jquery-contextmenu")):"function"==typeof define&&define.amd?define(["dayjs","dayjs-plugin-utc","dialog-polyfill","eventemitter3","file-saver","hammerjs","i18next","i18next-chained-backend","i18next-localstorage-backend","i18next-xhr-backend","jquery","jquery-contextmenu"],t):"object"==typeof exports?exports.PDFViewCtrl=t(require("dayjs"),require("dayjs-plugin-utc"),require("dialog-polyfill"),require("eventemitter3"),require("file-saver"),require("hammerjs"),require("i18next"),require("i18next-chained-backend"),require("i18next-localstorage-backend"),require("i18next-xhr-backend"),require("jquery"),require("jquery-contextmenu")):e.PDFViewCtrl=t(e.dayjs,e.dayjsPluginUTC,e.dialogPolyfill,e.EventEmitter,e.saveAs,e.Hammer,e.i18next,e.i18nextChainedBackend,e.i18nextLocalStorageBackend,e.i18nextXHRBackend,e.jQuery,e["jquery-contextmenu"])}(self,((e,t,n,i,r,o,a,s,u,c,l,d)=>(()=>{var h={9059:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape;return t+='<dialog class="fv__ui-layer fv__action-dialog" >\n   <div class="fv__action-dialog-header">\n  <div class="fv__action-dialog-title">',t+=n(i.i18n("viewer_:dialog.actionDialog.title")),t+='</div>\n  <div class="fv__action-dialog-close"><i class="fv__action-dialog-close-icon">x</i></div>\n   </div>\n   <div class="fv__action-dialog-body">\n  <div class="fv__action-dialog-select">\n <span class="fv__action-dialog-select-title">',t+=n(i.i18n("viewer_:dialog.actionDialog.selectKey")),t+='</span>\n <select id="select-action">\n<option value="TypeGoto">',t+=n(i.i18n("viewer_:dialog.actionDialog.selectAction.goto")),t+='</option>\n<option value="TypeURI">',t+=n(i.i18n("viewer_:dialog.actionDialog.selectAction.webLink")),t+='</option>\n </select>\n  </div>\n  <div class="fv__action-dialog-url fv__action-dialog-box" data-type="TypeURI">\n <div class="fv__action-dialog-url-title fv__action-box-title">',t+=n(i.i18n("viewer_:dialog.actionDialog.URLAction.title")),t+='</div>\n <div class="fv__action-dialog-url-input">\n<input class="fv__action-dialog-input" id="url-input"/>\n </div>\n  </div>\n  <div class="fv__action-dialog-goto fv__action-dialog-box" style="display:block;"  data-type="TypeGoto">\n <div class="fv__action-dialog-goto-title fv__action-box-title">',t+=n(i.i18n("viewer_:dialog.actionDialog.GotoAction.title")),t+='</div>\n <div class="fv__action-dialog-goto-container">\n<div class="fv__action-dialog-goto-center">\n   <div class="fv__action-dialog-goto-left">\n  <div class="fv__action-dialog-goto-target">',t+=n(i.i18n("viewer_:dialog.actionDialog.GotoAction.target")),t+=':</div>\n   </div>\n   <div class="fv__action-dialog-goto-right">\n  <div class="fv__action-dialog-goto-input">\n <input type="number" min="1" class="fv__action-dialog-input" id="goto-input"/>\n  </div>\n  <div class="fv__action-dialog-goto-position">\n <span class="fv__action-dialog-goto-position-left">',t+=n(i.i18n("viewer_:dialog.actionDialog.GotoAction.left")),t+=':</span><span class="fv__action-dialog-goto-left-value">0</span>\n <span class="fv__action-dialog-goto-position-top">',t+=n(i.i18n("viewer_:dialog.actionDialog.GotoAction.top")),t+=':</span><span class="fv__action-dialog-goto-top-value">0</span>\n  </div>\n   </div>\n</div>\n </div>\n  </div>\n   </div>\n   <div class="fv__action-dialog-footer">\n  <div class="fv__action-dialog-btns">\n  <button type="button" class="fv__action-btn fv__action-btn-ok">',t+=n(i.i18n("viewer_:dialog.actionDialog.OK")),t+='</button>\n  <button type="button" class="fv__action-btn fv__action-btn-cancel ">',t+=n(i.i18n("viewer_:dialog.actionDialog.Cancel")),t+="</button>\n  </div>\n   </div>\n</dialog>"}},875:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape;return t+='<dialog class="fv__ui-layer fv__place-redaction-dialog" >\n   <div class="fv__place-redaction-dialog-header">\n  <div class="fv__place-redaction-dialog-title">',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.title")),t+='</div>\n  <div class="fv__place-redaction-dialog-close"><i class="fv__place-redaction-dialog-close-icon">x</i></div>\n   </div>\n   <div class="fv__place-redaction-dialog-body">\n<div class="fv__redaction-container">\n<label>\n<input name="redaction-page-type" class="redaction-page-radio" type="radio" checked value="1" /><span>',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.allPage")),t+='</span>\n</label>\n</div>\n<div class="fv__redaction-container">\n<label>\n<input name="redaction-page-type" class="redaction-page-radio" type="radio" value="2" /><span>',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.specificPage")),t+='</span>\n<div class="fv__redaction-range">',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.pageRange")),t+=': <input type="text" class="fv__redaction-page-range" disabled placeholder="',t+=n(e),t+='"/></div>\n</label>\n</div> \n   </div>\n   <div class="fv__place-redaction-dialog-footer">\n<div class="fv__redaction-container footer" style="text-align:right">\n<button type="button" class="fv__redaction-btn fv__ui-dialog-ok-button">',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.OK")),t+='</button>\n<button type="button" class="fv__redaction-cancel fv__ui-dialog-cancel-button">',t+=n(i.i18n("viewer_:dialog.placeRedactionDialog.Cancel")),t+="</button>\n</div>\n   </div>\n</dialog>"}},5100:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).disabledAttr,r=e.disabled,o=e.i18nRoot,a=e.hlm,s=e.endingStyle,u=e.borderWidth,c=i.$escape,l=e.minBorderWidth,d=e.borderStyle,h=e.cloudy,f=e.highlightingMode,g=e.rotation,v=e.fillColor,p=e.checked,m=e.strFillColor,y=e.color,k=e.lineStartStyle,b=e.startStyle,w=e.lineEndStyle,_=e.endStyle,P=e.hasCap,A=(e.hasCapChecked,e.opacity);t+='<div class="fv__annot-properties-dialog">\n<div>\n';n=r?"disabled=disabled":"",a=(o="viewer_:dialog.")+"highlightingMode.",s=o+"endingStyle.";if(t+="\n",void 0!==u&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"borderWidth")),t+='</span>\n<div class="fv__property-item-field-container">\n<input id="thickness-input-tx" type="number"\n   min="',t+=c(null!=l?l:1),t+='" max="12" step="1" value="',t+=c(u),t+='"\n   ',t+=c(n),t+='>\n<input id="thickness-input" type="range"\n   value="',t+=c(u),t+='" min="1" max="12" step="1"\n   ',t+=c(n),t+=">\n</div>\n</div>\n"),!1!==d&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"borderStyle")),t+='</span>\n<div class="fv__property-item-field-container">\n<select id="borderStyle-select" ',t+=c(n),t+='>\n<option value="0">———————————</option>\n<option value="1">. . . . . . . . . . . . . . . . . . . . .</option>\n<option value="2">-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -</option>\n<option value="3">—  —  —  —  —  —  —  —  —</option>\n<option value="4">—  -  —  -  —  -  —  -  —  -  —  -</option>\n<option value="5">——  -  ——  -  ——  -  ——  -</option>\n<option value="6">-   ———   -   ———   -   ———</option>\n',!0===h&&(t+='\n<option value="7">﹋﹋﹋﹋﹋﹋﹋﹋﹋﹋﹋</option>\n<option value="8">~~~~~~~~~~~~~~~~~~~</option>\n'),t+="\n</select>\n</div>\n</div>\n"),void 0!==f&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(a+"title")),t+='</span>\n<div class="fv__property-item-field-container">\n<select id="highlighting-select" ',t+=c(n),t+='>\n<option value="0">',t+=c(i.i18n(a+"none")),t+='</option>\n<option value="1">',t+=c(i.i18n(a+"invert")),t+='</option>\n<option value="2">',t+=c(i.i18n(a+"outline")),t+='</option>\n<option value="3">',t+=c(i.i18n(a+"push")),t+='</option>\n<option value="4">',t+=c(i.i18n(a+"toggle")),t+="</option>\n</select>\n</div>\n</div>\n"),void 0!==g&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"rotate")),t+='</span>\n<div class="fv__property-item-field-container">\n<select id="rotation-select" ',t+=c(n),t+='>\n<option value="0">0</option>\n<option value="1">90</option>\n<option value="2">180</option>\n<option value="3">270</option>\n</select>\n</div>\n</div>\n'),void 0!==v){p="",r="",m=v;if(0==v)r="disabled=1",p="checked=1",m="#FFFFFF";else{for(m=(v&=16777215).toString(16);m.length<6;)m="0"+m;m="#"+m}t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"fillColor")),t+='</span>\n\n<div class="fv__property-item-field-container">\n<input id="fillcolor-input" type="color" value="',t+=c(m),t+='" ',t+=c(r),t+=" ",t+=c(n),t+='>\n\n<label>\n<input id="fillColor-transparent-input" type="checkbox" ',t+=c(p),t+=" ",t+=c(n),t+=">\n",t+=c(i.i18n(o+"transparent")),t+="\n</label>\n</div>\n</div>\n"}(void 0!==y&&(0===y&&(y="#ffffff"),t+='\n<div class="fv__property-item">\n<label>\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"color")),t+='</span>\n<div class="fv__property-item-field-container">\n<input id="color-input" type="color" value="',t+=c(y),t+='" ',t+=c(n),t+=">\n</div>\n</label>\n</div>\n"),k&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"startStyle")),t+='</span>\n<div class="fv__property-item-field-container">\n<select id="startstyle-select" value="',t+=c(b),t+='" ',t+=c(n),t+='>\n<option value="0">',t+=c(i.i18n(s+"none")),t+='</option>\n<option value="1">',t+=c(i.i18n(s+"square")),t+='</option>\n<option value="2">',t+=c(i.i18n(s+"circle")),t+='</option>\n<option value="3">',t+=c(i.i18n(s+"diamond")),t+='</option>\n<option value="4">',t+=c(i.i18n(s+"openArrow")),t+='</option>\n<option value="5">',t+=c(i.i18n(s+"closedArrow")),t+='</option>\n<option value="6">',t+=c(i.i18n(s+"butt")),t+='</option>\n<option value="7">',t+=c(i.i18n(s+"reverseOpenArrow")),t+='</option>\n<option value="8">',t+=c(i.i18n(s+"reverseClosedArrow")),t+='</option>\n<option value="9">',t+=c(i.i18n(s+"slash")),t+="</option>\n</select>\n</div>\n</div>\n"),w&&(t+='\n<div class="fv__property-item">\n<span class="fv__property-item-name-container">',t+=c(i.i18n(o+"endStyle")),t+='</span>\n<div class="fv__property-item-field-container">\n<select id="endstyle-select" value="',t+=c(_),t+='" ',t+=c(n),t+='>\n<option value="0" >',t+=c(i.i18n(s+"none")),t+='</option>\n<option value="1" >',t+=c(i.i18n(s+"square")),t+='</option>\n<option value="2" >',t+=c(i.i18n(s+"circle")),t+='</option>\n<option value="3" >',t+=c(i.i18n(s+"diamond")),t+='</option>\n<option value="4" >',t+=c(i.i18n(s+"openArrow")),t+='</option>\n<option value="5" >',t+=c(i.i18n(s+"closedArrow")),t+='</option>\n<option value="6" >',t+=c(i.i18n(s+"butt")),t+='</option>\n<option value="7" >',t+=c(i.i18n(s+"reverseOpenArrow")),t+='</option>\n<option value="8" >',t+=c(i.i18n(s+"reverseClosedArrow")),t+='</option>\n<option value="9" >',t+=c(i.i18n(s+"slash")),t+="</option>\n</select>\n</div>\n</div>\n"),void 0!==P)&&(t+='\n<div class="fv__property-item">\n<label class="fv__property-item-only-field-container">\n<input id="hasCap-input" type="checkbox" ',t+=c(P?"checked=true":""),t+=" ",t+=c(n),t+=">\n",t+=c(i.i18n(o+"hasCap")),t+="\n</label>\n</div>\n");return!1!==A&&(t+='\n<div class="fv__property-item">\n<label class="fv__property-item-name-container">',t+=c(i.i18n(o+"opacity")),t+='</label>\n<div class="fv__property-item-field-container">\n<input id="opacity-input" type="range" value="',t+=c(A),t+='" min="0" max="1" step="0.01" ',t+=c(n),t+=">\n</div>\n</div>\n"),t+='\n</div>\n<div class="fv__btn-close-container">\n<button type="button" class="fv__btn fv__btn-close">',t+=c(i.i18n(o+"close")),t+="</button>\n</div>\n</div>"}},4637:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape;return t+='<dialog class="fv__dialog fv__annot-reply-dialog trust-dia-dibox">\n  <p><span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.diaTitle")),t+='</span><i class="fv__icon-layer-close"></i></p>\n  <div class="fv__trust-tip-container">\n<p><i class="fv__icon-dialog-level-warning"></i><span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.disableTip")),t+='</span></p>\n  </div>\n  <div class="fv__textarea-container trust-dia-inbox">\n  <label>\n  <input type="checkbox" name="trustToClose">\n  <span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.rememberTime")),t+='</span>\n  </label>\n  </div>\n  <div class="fv__btn_reply_container btn-bot-box">\n  <button type="button" class="fv__btn fv__btn-reply trust-ok-btn">',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.play")),t+='</button>\n  <button type="button" class="fv__btn fv__btn-close trust-no-btn">',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.reject")),t+="</button>\n  </div>\n</dialog>"}},1160:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).i,r=(e.pointIndex,i.$escape);for(n=0;n<e.anchorCount;n++){t+="\n";t+='\n<div class="fv__pdf-annot-line-point" data-index="',t+=r(n),t+='"><div class="fv__pdf-annot-line-point-item"></div></div>\n'}return t+="\n\n",e.isLineDimension&&(t+='\n<div class="fv__pdf-annot-line-caption" data-index="caption">',t+=r(e.captionText),t+="</div>\n"),t}},1583:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.fillColor;return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M7.2,14.9H3.7c-.4,0-.7.3-.8.8V28.5c0,.4.3.7.8.8H7.2c.4,0,.7-.3.8-.8V15.7C7.9,15.2,7.6,14.9,7.2,14.9Z"/>\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M10.8,7.9h3.5a.79.79,0,0,1,.8.8V28.5a.79.79,0,0,1-.8.8H10.8a.79.79,0,0,1-.8-.8V8.7C10.1,8.3,10.4,7.9,10.8,7.9Z"/>\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M25.1,8h3.5a.79.79,0,0,1,.8.8V28.6a.79.79,0,0,1-.8.8H25.1a.79.79,0,0,1-.8-.8V8.8A.86.86,0,0,1,25.1,8Z"/>\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M17.9,19.9h3.5a.79.79,0,0,1,.8.8v7.8a.79.79,0,0,1-.8.8H17.9a.79.79,0,0,1-.8-.8V20.7C17.2,20.2,17.5,19.9,17.9,19.9Z"/>\n</svg>'}},6283:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 56">\n  <path stroke="#3f3f3f" transform="rotate(-44 14.147195816040043,29.311956405639645) " d="m22.48496,6.139239a10.573254,11.136632 0 0 1 3.338127,0.652288a9.244045,9.736598 0 0 1 5.769976,9.259314a9.4253,9.927512 0 0 1 -2.733941,7.127445l-18.503194,19.727748a6.585627,6.936531 0 0 1 -1.827662,1.272758a4.380348,4.613748 0 0 1 -2.129755,0.572741a5.603824,5.902415 0 0 1 -2.114651,-0.572741a5.55851,5.854687 0 0 1 -1.510465,-1.272758a6.177801,6.506975 0 0 1 -1.208372,-1.925046a4.531394,4.772842 0 0 1 -0.302093,-2.227326a8.307556,8.750211 0 0 1 1.510465,-4.168282l16.977624,-18.534538a2.326116,2.450059 0 0 1 1.223476,-0.636379a2.311011,2.43415 0 0 1 1.510465,0.636379a1.706825,1.797771 0 0 1 0.619291,1.288667a2.054232,2.163689 0 0 1 -0.619291,1.590947l-17.294822,18.216348a2.311011,2.43415 0 0 0 -0.604186,1.590947a1.9485,2.052322 0 0 0 1.782348,1.940956a1.510465,1.590947 0 0 0 1.223476,-0.636379l18.533403,-19.823205a5.060057,5.329674 0 0 0 1.510465,-4.168282a6.404371,6.745617 0 0 0 -1.510465,-4.152373a4.531394,4.772842 0 0 0 -3.64022,-1.909137a4.863697,5.122851 0 0 0 -3.957418,1.909137l-18.503194,19.807296a11.14723,11.741192 0 0 0 -2.114651,3.181895a9.334672,9.832055 0 0 0 0,7.381996a11.14723,11.741192 0 0 0 2.114651,3.181895a8.790905,9.259314 0 0 0 6.343952,2.879615a8.594545,9.052491 0 0 0 6.404371,-2.879615l18.820391,-19.489106a1.510465,1.590947 0 0 1 1.208372,-0.636379a1.842767,1.940956 0 0 1 1.208372,0.636379a1.616197,1.702314 0 0 1 0.619291,1.288667a1.510465,1.590947 0 0 1 -0.619291,1.272758l-18.503194,19.807296a14.878078,15.670832 0 0 1 -4.244406,3.181895a12.400916,13.061679 0 0 1 -4.863697,0.970478a12.325393,12.982131 0 0 1 -4.848592,-0.970478a9.87844,10.404796 0 0 1 -4.244406,-3.181895a12.400916,13.061679 0 0 1 -2.733941,-4.470562a13.760334,14.493531 0 0 1 -0.906279,-5.106941a15.512474,16.33903 0 0 1 0.906279,-5.44104a12.627486,13.300321 0 0 1 2.733941,-4.470562l18.503194,-19.807296a9.379986,9.879784 0 0 1 6.676254,-2.895524z" stroke-miterlimit="10" fill="',t+=(0,i.$escape)(e.fillColor),t+='"/>\n</svg>\n'}},6852:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M26.9,20.3h0l-.1-.1-.1-.1-4.9-5.2h0V4.1H23a.94.94,0,0,0,1-1V2.5a.94.94,0,0,0-1-1H8.4a.94.94,0,0,0-1,1v.6a.94.94,0,0,0,1,1H9.7V14.9h0l-5,5.2-.1.1-.1.1h0c-.1.1-.1.2-.1.4a.79.79,0,0,0,.8.8H15v8.6a1,1,0,0,0,.8.9h0a1.22,1.22,0,0,0,.8-.9V21.5h9.7a.77.77,0,0,0,.8-.7v-.1A.76.76,0,0,1,26.9,20.3Z"/>\n</svg>'}},8807:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M30.2,20.4,13.6,2.4H3L2.4,3v9.4L19.5,31l1.1-.2L30,21.5ZM6.2,7.5A1.75,1.75,0,0,1,4.5,5.8,1.75,1.75,0,0,1,6.2,4.1,1.75,1.75,0,0,1,7.9,5.8,1.69,1.69,0,0,1,6.2,7.5Z"/>\n</svg>'}},3110:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M2.56,16.77a1,1,0,0,1,0-1.41L6.5,11.42a1,1,0,0,1,1.41,0l5.75,5.75a1,1,0,0,0,1.41,0h0l9.43-9.43a1,1,0,0,1,1.41,0l3.94,3.94a1,1,0,0,1,0,1.41L15.08,27.88a1,1,0,0,1-1.41,0Z"/>\n</svg>'}},7308:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M16,2A14.13,14.13,0,0,0,1.77,16,14.12,14.12,0,0,0,16,29.94,14.13,14.13,0,0,0,30.32,16h0A14.13,14.13,0,0,0,16.06,2Zm0,26a12,12,0,1,1,.09,0Z"/>\n</svg>'}},3856:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M27.6,2H4.75a3,3,0,0,0-3,3V21.63a3,3,0,0,0,3,3H6.2l1.22,6.24V31l6.37-6.37H27.6a3,3,0,0,0,3-3V5A3,3,0,0,0,27.6,2Z"/>\n<path fill="#3f3f3f" isolation="isolate"\n  d="M27.24,6.92a.52.52,0,0,1-.52.52H6.22a.52.52,0,0,1-.52-.52h0a.52.52,0,0,1,.52-.52h20.5a.52.52,0,0,1,.52.52Z"/>\n<path fill="#3f3f3f" isolation="isolate"\n  d="M27.35,12.07a.51.51,0,0,1-.5.52H6.33a.51.51,0,0,1-.51-.51h0a.51.51,0,0,1,.51-.51H26.84a.51.51,0,0,1,.51.51Z"/>\n<path fill="#3f3f3f" isolation="isolate"\n  d="M22,17.19c0,.29-.18.52-.39.52H6.2c-.22,0-.39-.23-.39-.52h0c0-.28.17-.52.39-.52H21.63c.21,0,.39.24.39.52Z"/>\n</svg>'}},4814:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M24,1.4a1.55,1.55,0,0,0-2.18,0L17.17,6A1.55,1.55,0,0,1,15,6L10.35,1.4a1.55,1.55,0,0,0-2.18,0L1.59,8a1.55,1.55,0,0,0,0,2.18L6.22,14.8a1.56,1.56,0,0,1,0,2.19l-4.63,4.6a1.56,1.56,0,0,0,0,2.19l6.58,6.58a1.56,1.56,0,0,0,2.19,0L15,25.73a1.56,1.56,0,0,1,2.19,0l4.62,4.63a1.55,1.55,0,0,0,2.18,0l6.58-6.58a1.56,1.56,0,0,0,0-2.19L25.93,17a1.55,1.55,0,0,1,0-2.18h0l4.62-4.62a1.55,1.55,0,0,0,0-2.18Z"/>\n</svg>'}},9797:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M30.68,16.17A14.48,14.48,0,1,1,16.19,1.7h0A14.47,14.47,0,0,1,30.68,16.17Z"/>\n<path fill="#fff" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M11.23,13.28c0-2.28.95-5.29,5-5.29,3.2,0,5,2,5,4a4.9,4.9,0,0,1-1.35,3.6c-1.59,1.58-1.8,2.38-1.8,3.84h0c0,.19-.5.35-1.12.35H15.51c-.61,0-1.11-.32-1.11-.71a7.58,7.58,0,0,1,.33-1.77,11.61,11.61,0,0,1,1.21-2.63c.32-.41,1.56-.95,1.56-2.33,0-.88-.37-1.37-1.35-1.37C15.33,11,15,12.2,15,12.2a1.51,1.51,0,0,1-1.38,1.08Zm3.17,9a1.13,1.13,0,0,1,1.11-1.12h1.43a1.12,1.12,0,0,1,1.12,1.12h0V24a1.12,1.12,0,0,1-1.12,1.12H15.51A1.13,1.13,0,0,1,14.4,24Z"/>\n</svg>'}},4739:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M30.16,24.36,17.49,6.08a2,2,0,0,0-1.64-.92,2,2,0,0,0-1.63.92L1.55,24.36a2.06,2.06,0,0,0-.41,1.19,1.56,1.56,0,0,0,1.29,1.54H29.28a1.56,1.56,0,0,0,1.29-1.54A2.06,2.06,0,0,0,30.16,24.36Z"/>\n</svg>'}},1158:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M27.65,5.25A9.26,9.26,0,0,0,12.4,15L3,24.32a4.53,4.53,0,0,0-1.15,2.8v1.67a2,2,0,0,0,2,2h1.7a4.3,4.3,0,0,0,2.74-1.1,3.53,3.53,0,0,0,1-2.29.89.89,0,0,0,0-.23v-.05a.23.23,0,0,1,.07-.19.4.4,0,0,1,.28-.08,1.86,1.86,0,0,0,2-1.48.63.63,0,0,1,.46-.53,1.57,1.57,0,0,0,1.44-1.66v-.09a.38.38,0,0,1,0-.15h.18a2,2,0,0,0,2.15-.59,12.55,12.55,0,0,1,1.31-1.51l.46-.47a9.23,9.23,0,0,0,10-15.09Zm-2.1,4.86a1.92,1.92,0,1,1,0-2.72h0A1.93,1.93,0,0,1,25.55,10.11Z"/>\n</svg>'}},2186:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.fillColor;return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<polygon fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n points="5.88 28.59 4.82 24.23 5.06 5.18 6 2.71 9.65 2.59 19.29 3.06 21.65 4.47 25.41 7.76 25.65 9.53 26.1 21.8 25.52 28.58 23.53 29.29 9.41 28.94 5.88 28.59"/>\n<path fill="#3f3f3f"\n  d="M22.26,18.19a.35.35,0,0,1-.35.35H8.73a.35.35,0,0,1-.35-.35h0a.34.34,0,0,1,.33-.35h13.2a.35.35,0,0,1,.35.35Z"/>\n<path fill="#3f3f3f"\n  d="M22.26,21.8a.35.35,0,0,1-.35.35H8.73a.34.34,0,0,1-.35-.33v0h0a.35.35,0,0,1,.35-.35H21.91a.35.35,0,0,1,.35.35Z"/>\n<path fill="#3f3f3f"\n  d="M22.14,25.18a.35.35,0,0,1-.35.35H8.61a.35.35,0,0,1-.35-.35h0a.35.35,0,0,1,.35-.35H21.79a.35.35,0,0,1,.35.35Z"/>\n<path fill="#3f3f3f"\n  d="M22.26,14.69a.35.35,0,0,1-.35.35H8.73a.35.35,0,0,1-.35-.35h0a.35.35,0,0,1,.35-.35H21.91a.35.35,0,0,1,.35.35Z"/>\n<path fill="#3f3f3f"\n  d="M24.48,30.13H6.3A2.28,2.28,0,0,1,4,27.87V4.07A2.28,2.28,0,0,1,6.29,1.8H20.41l.14.13.13.14,5.8,5.69.14.13.14.14V27.85a2.28,2.28,0,0,1-2.28,2.28ZM6.73,3.83a.82.82,0,0,0-.81.81V27.29a.82.82,0,0,0,.81.8H24a.81.81,0,0,0,.82-.8h0V9.69H18.29V3.83ZM20.29,7.69h3.25L20.29,4.5Z"/>\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M23.28,28.58A.58.58,0,0,1,22.7,28V26.36a.58.58,0,0,0-.58-.58H20.48a.58.58,0,0,1-.58-.58V23a.58.58,0,0,1,.58-.58h1.64a.58.58,0,0,0,.58-.58V20.17a.6.6,0,0,1,.58-.59h2.24a.6.6,0,0,1,.58.59V21.8a.58.58,0,0,0,.58.58h1.63a.58.58,0,0,1,.58.58V25.2a.58.58,0,0,1-.58.58H26.68a.58.58,0,0,0-.58.58V28a.58.58,0,0,1-.58.58Z"/>\n</svg>'}},927:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<polygon fill="',t+=(0,i.$escape)(e.fillColor),t+='"\n points="6.35 4 5.88 28.59 7.53 29.77 19.88 29.41 22 28.82 26.23 24.47 27.06 10.94 26.71 3.41 24.94 2.47 6.71 3.06 6.35 4"/>\n<path fill="#3f3f3f"\n  d="M23.17,16.73a.37.37,0,0,0-.36-.35H9.33a.37.37,0,0,0-.36.35H9a.36.36,0,0,0,.36.36H22.81a.36.36,0,0,0,.36-.36Z"/>\n<path fill="#3f3f3f"\n  d="M23.17,13a.36.36,0,0,0-.36-.36H9.33A.36.36,0,0,0,9,13H9a.37.37,0,0,0,.36.35H22.81A.37.37,0,0,0,23.17,13Z"/>\n<path fill="#3f3f3f"\n  d="M23.17,9.35A.37.37,0,0,0,22.81,9H9.33A.37.37,0,0,0,9,9.35H9a.36.36,0,0,0,.36.36H22.81a.36.36,0,0,0,.36-.36Z"/>\n<path fill="#3f3f3f"\n  d="M23.17,20.31a.37.37,0,0,0-.36-.35H9.33a.37.37,0,0,0-.36.35H9a.36.36,0,0,0,.36.36H22.81a.36.36,0,0,0,.36-.36Z"/>\n<path fill="#3f3f3f"\n  d="M25.62,2a2.32,2.32,0,0,1,2.32,2.32V24.63l-.14.14-.14.13-5.93,5.82-.14.14-.14.14H7a2.32,2.32,0,0,1-2.32-2.32h0V4.34A2.32,2.32,0,0,1,7,2H25.62ZM7.46,28.92H19.28v-6H26v-18a.83.83,0,0,0-.83-.83H7.46a.83.83,0,0,0-.83.83V28.09A.83.83,0,0,0,7.46,28.92Zm13.87-4v3.27L24.65,25Z"/>\n</svg>'}},5984:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M10.36,2.52A7.93,7.93,0,0,0,9,2.77H9A6.45,6.45,0,0,0,4.51,9.1a6.52,6.52,0,0,0,6.23,6.77H11V29.19l1.49.69v.95h2.1L14.54,6h3.54V29.19l1.5.69v.95h2.09L21.59,6h3.7V2.52Z"/>\n</svg>'}},1490:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M28.87,16.67a.82.82,0,0,0,.3-1.12.86.86,0,0,0-.3-.3L13.94,4.65c-.54-.39-1-.16-1,.52V9.78A1.22,1.22,0,0,1,11.73,11H4.32a1.22,1.22,0,0,0-1.21,1.22v7.49a1.22,1.22,0,0,0,1.21,1.22h7.41a1.21,1.21,0,0,1,1.21,1.21h0v4.61c0,.67.46.9,1,.52Z"/>\n</svg>'}},9856:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M29,16h0a1.3,1.3,0,0,0-.07-.33c0-.42-.84-1.16-1.28-1.43L7.17,2a1.76,1.76,0,0,0-1.32-.26h0A1.16,1.16,0,0,0,5.33,2h0l7.25,14L5.33,30h0a1.09,1.09,0,0,0,.52.27h0A1.76,1.76,0,0,0,7.17,30L27.63,17.83c.44-.27,1.28-1,1.28-1.43a1.3,1.3,0,0,0,.07-.33h0Z"/>\n</svg>'}},7156:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M24.28,29.33A2.58,2.58,0,0,1,23.1,29l-4.89-2.64A3.73,3.73,0,0,0,16.47,26a3.7,3.7,0,0,0-1.73.37L9.85,29a2.56,2.56,0,0,1-1.18.34,1.43,1.43,0,0,1-1.14-.52,2,2,0,0,1-.33-1.75l1-5.47a4.17,4.17,0,0,0-1.08-3.3l-4-3.84a1.88,1.88,0,0,1-.7-2,1.84,1.84,0,0,1,1.72-1.17l5.5-.74a4.22,4.22,0,0,0,2.81-2l2.4-5a1.87,1.87,0,0,1,1.64-1.26,1.87,1.87,0,0,1,1.64,1.26l2.41,5a4.15,4.15,0,0,0,2.8,2l5.51.74a1.85,1.85,0,0,1,1.71,1.17,1.83,1.83,0,0,1-.7,2l-4,3.84a4.14,4.14,0,0,0-1.07,3.29l1,5.47a2,2,0,0,1-.33,1.75,1.43,1.43,0,0,1-1.14.52Z"/>\n</svg>'}},9649:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M16.49,3.74a.78.78,0,0,0-1.07-.28.75.75,0,0,0-.28.28L5,18.08c-.37.52-.15,1,.49,1H9.91a1.17,1.17,0,0,1,1.17,1.17h0v7.1a1.18,1.18,0,0,0,1.17,1.16h7.18a1.17,1.17,0,0,0,1.17-1.17h0v-7.1A1.17,1.17,0,0,1,21.7,19h4.51c.64,0,.86-.43.48-.95Z"/>\n</svg>'}},7283:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=(0,i.$escape)(e.fillColor),t+='" stroke="#3f3f3f" stroke-miterlimit="10" \n  d="M7.4,5C7,4.8,6.6,5,6.4,5.4c-0.1,0.1-0.1,0.3,0,0.4l1.3,17.5c0,0.6,0.5,0.8,1,0.4l3.4-2.8\n\tc0.5-0.4,1.2-0.3,1.6,0.2c0,0,0,0,0,0l4.5,5.5c0.4,0.5,1.1,0.6,1.6,0.2c0,0,0,0,0,0l5.5-4.6c0.5-0.4,0.6-1.1,0.2-1.6c0,0,0,0,0,0\n\tL21,15.1c-0.4-0.5-0.3-1.2,0.1-1.6l3.4-2.8c0.5-0.4,0.4-0.9-0.2-1.1L7.4,5z"/>\n</svg>\n'}},8998:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.fillColor;return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<circle fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" cx="7.53" cy="27.68" r="1"/>\n<circle fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" cx="25.53" cy="27.68" r="1"/>\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M26.53,15.76V14.61A10,10,0,0,0,16.6,4.68h-.14a10,10,0,0,0-9.93,9.93v1.15a6.5,6.5,0,0,0,1,12.92l.68-.3.32-.7v-13a8,8,0,0,1,16,0v13l.35.61.65.39a6.5,6.5,0,0,0,1-12.92Z"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="10.53" y="18.68" width="2" height="8" rx="0.99"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="20.53" y="18.68" width="2" height="8" rx="0.99"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="15.53" y="19.68" width="2" height="6" rx="0.99"/>\n</svg>'}},7697:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.fillColor;return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M9,12v2c0,4.4,2.6,8,7,8s7-3.6,7-8V12h2v2.07C25,19.53,21.53,24,16.07,24h-.14C10.47,24,7,19.53,7,14.07V12Z"/>\n<circle fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" cx="8" cy="12" r="1"/>\n<circle fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" cx="24" cy="12" r="1"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="15" y="23" width="2" height="5" rx="0.99"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="8" y="27" width="16" height="2" rx="0.99"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="12" y="4" width="8" height="16" rx="3.95"/>\n</svg>'}},9291:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.fillColor;return t+='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">\n<path fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10"\n  d="M18.7,4.62a5.88,5.88,0,0,0-3,1.79l-5.12,4.74H4.91a2,2,0,0,0-2,2v6.38a2,2,0,0,0,2,2h5.66l5.12,4.73a6,6,0,0,0,3,1.8.48.48,0,0,0,.51-.45V5.13C19.14,4.75,19,4.62,18.7,4.62Z"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="24" y="20.12" width="2" height="8" rx="0.99" transform="translate(-9.73 24.74) rotate(-45)"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="20.95" y="6.88" width="8" height="2" rx="0.99"\n  transform="translate(1.74 19.95) rotate(-45)"/>\n<rect fill="',t+=n(r),t+='" stroke="#3f3f3f" stroke-miterlimit="10" x="22" y="15" width="6" height="2" rx="0.99"/>\n</svg>'}},4252:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t,r="",o=i.$escape;return e.length&&(r+='\n<label class="fv__label-block-text">',r+=o(i.i18n("viewer_:dialog.replies")),r+="</label>\n",t=n(1186)(e),r+=t,r+="\n"),r}},4210:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t,r="",o=i.$escape;return r+='<li class="fv__replies_item"><span class="fv__replies_content">',r+=o(e.content),r+="</span>\n",t=n(1186)(e.replies),r+=t,r+="\n</li>"}},1186:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",r=i.$each;e.$value,e.$index;return e.length&&(t+='\n<ul class="fv__replies_list">\n',r(e,(function(e,i){var r;t+="\n",r=n(4210)(e),t+=r,t+="\n"})),t+="\n</ul>\n"),t}},6912:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",r=i.$escape,o=e.content,a=e.replies;return t+='<dialog class="fv__dialog fv__annot-reply-dialog">\n<div class="fv__textarea-container">\n<label>\n<span class="fv__label-block-text">',t+=r(i.i18n("viewer_:dialog.content")),t+='</span>\n<textarea class="fv__block-textarea content-textarea">',t+=r(o),t+='</textarea>\n</label>\n</div>\n<div class="fv__textarea-container">\n<label>\n<span class="fv__label-block-text">',t+=r(i.i18n("viewer_:dialog.reply")),t+='</span>\n<textarea class="fv__block-textarea reply-textarea"></textarea>\n</label>\n</div>\n<div class="fv__btn_reply_container">\n<button type="button" class="fv__btn fv__btn-reply" disabled>',t+=r(i.i18n("viewer_:dialog.reply")),t+='</button>\n</div>\n<div class="fv__dialog-replies-block">\n',function(e){t+=e}(n(4252)(a)),t+='\n</div>\n<div class="fv__btn-close-container">\n<button type="button" class="fv__btn fv__btn-close">',t+=r(i.i18n("viewer_:dialog.close")),t+="</button>\n</div>\n</dialog>"}},5322:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<div class="fv__text-boundary fv__text-boundary-',t+=(0,i.$escape)(e.direction),t+='">\n<div class="fv__text-boundary-blank">\n<div class="fv__text-boundary-cursor"></div>\n<div class="fv__text-boundary-sign"></div>\n</div>\n</div>'}},7539:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape;return t+='<dialog class="fv__dialog fv__annot-reply-dialog trust-dia-dibox">\n  <p><span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.diaTitle")),t+='</span><i class="fv__icon-layer-close"></i></p>\n  <div class="fv__trust-tip-container">\n<p><i class="fv__icon-dialog-level-warning"></i><span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.enableTip")),t+='</span></p>\n  </div>\n  <div class="fv__textarea-container trust-dia-inbox">\n  <label>\n  <input type="radio" name="trustMode" value="one" checked>\n  <span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.trustOneTime")),t+='</span>\n  </label>\n  <label>\n  <input type="radio" name="trustMode" value="always">\n  <span>',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.trustAlways")),t+='</span>\n  </label>\n  </div>\n  <div class="fv__btn_reply_container btn-bot-box">\n  <button type="button" class="fv__btn fv__btn-reply trust-ok-btn">',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.ok")),t+='</button>\n  <button type="button" class="fv__btn fv__btn-close trust-no-btn">',t+=n(i.i18n("viewer_:preferenceDialog.safeReading.cancel")),t+="</button>\n  </div>\n</dialog>"}},1771:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).border,r=e.borderWidth,o=e.borderColorHex,a=(e.position,e.background),s=e.align,u=(e.style,i.$escape),c=e.i,l=e.options,d=e.optClass;n="border:"+r+"px solid "+o+";box-sizing:border-box;",a="background-color:"+a+";outline:none;";switch(s){case 0:s="text-align:left;";break;case 1:s="text-align:center;";break;case 2:s="text-align:right;"}t+='\n<div class="checkbox form-field-options" style="',t+=u(n+"left:0px;top:100%;max-height:200px;width:100%;position:absolute;"+a+s+"overflow-y:auto"),t+='" tabindex="-1">\n';for(c=0;c<l.length;c++){d="form-field-option";l[c].selected&&(d+=" selected"),t+='\n<div \ntabindex="-1"\nclass="',t+=u(d),t+='" \ndata-val="',t+=u(l[c].value),t+='" \ndata-index="',t+=u(c),t+='"\nstyle="white-space: nowrap; overflow-x: hidden;"\n>',t+=u(l[c].label),t+="</div>\n"}return t+="\n</div>"}},7416:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).border,r=e.borderWidth,o=e.borderColor,a=e.position,s=e.height,u=e.width,c=e.background,l=e.align,d=(e.readonlyAttr,e.readonly),h=e.comboEditable,f=(e.cursor,e.fs,e.fontSize),g=(e.fcolor,e.color),v=e.style,p=e.dropButtonDisplay,m=i.$escape,y=e.value;n="border:"+r+"px solid "+o+";box-sizing:border-box;",a="left:0px;top:0px;height:"+s+";width:"+u+";position:absolute;",c="background-color:"+c+";outline:none;";switch(l){case 0:l="text-align:left;";break;case 1:l="text-align:center;";break;case 2:l="text-align:right;"}v=n+a+c+l+("font-size:"+f+";")+("color:"+g+";")+(h?"":"cursor:pointer;"),p=d?"display:none":"display:block";return t+='\n<input class="fwr__ui-combo-input" ',t+=m(d||!h?"readonly":""),t+=' style="',t+=m(v),t+='" value="',t+=m(y),t+='" tabindex="-1"/>\n<div class="fwr__ui-combo-dropdown" style="',t+=m(p),t+='"></div>\n<div class="fwr__ui-combo-arrow"><span /></div>'}},5143:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return"<div class='esign-china-field-username'\nstyle=\"\nposition: absolute;\nwidth: max-content;\ndisplay: none;\nheight: 24px;\ninset: 0px;\nline-height: 18px;\ncolor: white;\npadding: 3px;\nborder-radius: 3px;\nmargin: auto;\n\"\n></div>\n<div class='esign-china-stamp-container'\n style='position: absolute;\n display: none;\n width: 240px;\n overflow-y: scroll;\n max-height: 217px;\n padding: 10px 15px 15px 20px;\n background: #FFFFFF;\n border: solid 1px rgba(0, 0, 0, 0.1);\n box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.15);\n border-radius: 3px;'>\n</div>","<div class='esign-china-field-username'\nstyle=\"\nposition: absolute;\nwidth: max-content;\ndisplay: none;\nheight: 24px;\ninset: 0px;\nline-height: 18px;\ncolor: white;\npadding: 3px;\nborder-radius: 3px;\nmargin: auto;\n\"\n></div>\n<div class='esign-china-stamp-container'\n style='position: absolute;\n display: none;\n width: 240px;\n overflow-y: scroll;\n max-height: 217px;\n padding: 10px 15px 15px 20px;\n background: #FFFFFF;\n border: solid 1px rgba(0, 0, 0, 0.1);\n box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.15);\n border-radius: 3px;'>\n</div>"}},6892:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).border,r=e.borderColor,o=(e.position,e.background),a=e.borderStyle,s=e.borderWidth,u=e.align,c=(e.fs,e.fontSize),l=(e.fcolor,e.color),d=(e.style,e.optsClass,i.$escape),h=e.i,f=e.options,g=e.optClass,v=e.readonly;n="border-color:"+r+";box-sizing:border-box;",o="background-color:"+o+";outline:none;";switch(n+="underline"===a?"border-width: 0 0 "+s+"px 0;border-style:solid;":"border-width:"+s+"px;border-style:"+a+";",u){case 0:u="text-align:left;";break;case 1:u="text-align:center;";break;case 2:u="text-align:right;"}t+='\n<div class="form-field-options" style="',t+=d(n+"left:0px;top:0px;height:100%;width:100%;"+o+u+"overflow-y:auto;"+("font-size:"+c+";")+("color:"+l+";")),t+='" tabindex="-1">\n';for(h=0;h<f.length;h++){g="form-field-option";f[h].selected&&(g+=" selected"),v&&(g+=" readonly"),t+='\n<div \nclass="',t+=d(g),t+='" \ndata-val="',t+=d(f[h].value),t+='" \ndata-index="',t+=d(h),t+='"\nstyle="white-space: nowrap; overflow-x: hidden;"\ntabindex="-1"\n>',t+=d(f[h].label),t+="</div>\n"}return t+="\n</div>"}},2565:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<?xml version="1.0" standalone="no"?><svg t="1589451362275" viewBox="-100 -100 1224 1224" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path fill="',t+=(0,i.$escape)(e.fillColor),t+='" d="M997.888 70.144C686.592 261.12 460.8 502.272 358.912 623.104l-248.832-195.072-110.08 88.576 429.568 437.248c73.728-189.44 308.224-559.616 594.432-822.784l-26.112-60.928m0 0z"></path></svg>'}},2911:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).small,r=i.$escape,o=e.fillColor;return t+='<?xml version="1.0" standalone="no"?><svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">\n',0==n?(t+='\n<path stroke="',t+=r(o),t+='" d="M15 15 L185 185 M15 185 L185 15" style="stroke-width:12"></path></svg>\n'):(t+='\n<path stroke="',t+=r(o),t+='" d="M40 40 L160 160 M40 160 L160 40" style="stroke-width:30"></path></svg>\n'),t}},5133:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg viewBox="0 0 400 400"  width="400" height="400" xmlns="http://www.w3.org/2000/svg">\n  <path id="svg_4" d="m30.75,155.65323l131.477663,0l40.627609,-124.90323l40.627633,124.90323l131.477639,0l-106.367469,77.193558l40.629712,124.90323l-106.367515,-77.19566l-106.367492,77.19566l40.629723,-124.90323l-106.367503,-77.193558z" fill="',t+=(0,i.$escape)(e.fillColor),t+='"/>\n</svg>'}},5115:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<svg viewBox="0 0 300 300"  width="300" height="300" xmlns="http://www.w3.org/2000/svg">\n  <circle cx="151" cy="151" r="85" fill="',t+=(0,i.$escape)(e.fillColor),t+='"/>\n</svg>'}},781:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<?xml version="1.0" standalone="no"?><svg class="icon" viewBox="0 0 390 390" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">  <rect height="270" width="270" y="60" x="60" fill="',t+=(0,i.$escape)(e.fillColor),t+='"/></svg>'}},5617:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<?xml version="1.0" standalone="no"?><svg t="1589451342686" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path fill="',t+=(0,i.$escape)(e.fillColor),t+='" d="M512 69.479l442.498 442.498-442.498 442.498-442.498-442.498 442.498-442.498z"></path></svg>'}},9194:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";var t="",n=(e=e||{}).border,r=e.borderWidth,o=e.borderColor,a=e.position,s=e.left,u=e.top,c=e.height,l=e.width,d=e.background,h=e.transform,f=e.rotation,g=e.alignStyle,v=e.align,p=(e.fs,e.fontSize),m=(e.fcolor,e.color),y=e.transformStyle,k=e.style,b=e.maxLengthAttr,w=e.maxLength,_=e.spellCheckAttr,P=e.isNoSpellCheck,A=e.isMultiline,S=i.$escape,x=e.isNoScroll,C=e.ro,D=e.value,E=e.comb,I=e.diffLen,R=e.i,T=e.v,F=e.type,M=e.isPassword,O=e.readonly,L=e.isSafari;n="border:"+r+"px solid "+o+";",a="left:"+s+";top:"+u+";height:"+c+";width:"+l+";",d="background-color:"+d+";",h="";switch(0!==f&&(h="transform:rotate("+f+"deg);transform-origin: center;"),v){case 0:g="text-align:left;";break;case 1:g="text-align:center;";break;case 2:g="text-align:right;"}y=h,k=n+a+d+g+("font-size:"+p+";")+("color:"+m+";"),b=w?"maxlength="+w:"",_="spellcheck="+!P;if(A)k+="resize: none;",t+='\n<div class="textCombInput"><textarea class="fv__pdf-form-field-combo-textarea ',t+=S(x?"fv__no-scroll-text":"fv__scroll-text"),t+='" ',t+=S(C),t+=' style="',t+=S(k),t+='">',t+=S(D),t+="</textarea></div>\n";else if(E){t+='\n<div class="textCombInput" >\n<div class="textCombContainer">\n';for(I=w-D.length,R=0;R<w;R++){T=D[R];2==v&&w>D.length&&R<I&&(T=""),2==v&&R>=I&&(T=D[R-I]),t+='\n<div class="textComb" style="',t+=S(n),t+='" data-index="',t+=S(R),t+='">',t+=S(T),t+="</div>\n"}t+='\n</div>\n\n<input type="',t+=S(F),t+='" ',t+=S(C),t+=' style="',t+=S(k),t+='" ',t+=S(b),t+=" ",t+=S(_),t+=' value="',t+=S(D),t+='" tabindex="-1">\n</div>\n'}else{C=O?"readonly":"";t+='\n<div class="textCombInput">\n<input  type="',t+=S(F=M?"password":"text"),t+='" ',t+=S(C),t+=" ",t+=S(b),t+=" ",t+=S(_),t+=' style="',t+=S(k+y),t+=S(L&&"box-sizing: content-box; padding: 0;"),t+='" value="',t+=S(D),t+='" tabindex="-1"/>\n<div class="dtbox"></div>\n</div>\n'}return t}},4563:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+="<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n  <title>Document</title>\n  <script>\nwindow.initJS = function (PDFJSGlobal) {\n  const standardGlobalVariables = [\n  'app', 'event', 'doc',\n  'this', 'util', 'catalog',\n  'color', 'console', 'dbg'\n  ];\n  standardGlobalVariables.forEach(function(key) {\nObject.defineProperty(window, key, {\nget: function(){\nreturn PDFJSGlobal[key];\n},\nset: function(value){\nPDFJSGlobal[key] = value;\n}\n})\n  });\n  window.PDFJSGlobal = new Proxy(PDFJSGlobal, {\nhas: function(target, key) {\nreturn Reflect.has(target, key);\n},\nget: function(target, key) {\nreturn Reflect.get(target, key);\n},\nset: function(target, key, value) {\nReflect.set(target, key, value);\nif(standardGlobalVariables.indexOf(key) === -1) {\nReflect.set(window, key, value);\n}\n}\n  })\n  function appClosure() {\nfor (var i in window) {\n  if (i != 'PDFJSGlobal'\n&& i != 'location'\n&& i != 'window'\n&& i != 'appClosure') {\n  try {\neval('var ' + i + '=null');\n  } catch (ex) {}\n  }\n}\nvar proto = Object.getPrototypeOf ? Object.getPrototypeOf(window.PDFJSGlobal.doc) : window.PDFJSGlobal.doc.__proto__;\nObject.getOwnPropertyNames(proto).forEach(function (key) {\n  if (key === \"constructor\") return;\n  var descriptor = Object.getOwnPropertyDescriptor(proto, key);\n  if(typeof descriptor.value === 'function') {\nwindow[key] = function () {\n  return window.PDFJSGlobal.doc[key].apply(window.PDFJSGlobal.doc, arguments)\n}\n  } else {\n  if(window[key]){window[key] = window.PDFJSGlobal.doc[key];return}\nObject.defineProperty(window, key, {\n  get: function () {\nreturn window.PDFJSGlobal.doc[key];\n  }, set: function (val) {\nwindow.PDFJSGlobal.doc[key] = val\n  }\n})\n  }\n})\n\nreturn {\n  docClosure: function (f) {\nwith (PDFJSGlobal) {\n  with (PDFJSGlobal.doc) {\ntry {\n  eval(f);\n} catch (e) {\n  //",t+=(0,i.$escape)(e.log||""),t+="&&console.warn(e)\n}\nreturn function (f) {\n  return eval(f)\n}\n  }\n}\n  }\n}\n  }\n  window.__appClosure__ = appClosure();\n}\n\nwindow.runJS = function (data, engineEvent) {\n  var doc = window.PDFJSGlobal.doc;\n  window.PDFJSGlobal.event = engineEvent;\n\n  doc.timeStamp = engineEvent && engineEvent.timeStamp;\n\n  var resetDocClosure = function () {\nconst guessVariableNames = Array.from(new Set(data.code.split(/\\W/))).filter(name => {\nif(!doc.exec) {\ndoc.exec = window.__appClosure__.docClosure('');\n}\ntry {\ndoc.exec(name);\nreturn false\n} catch (error) {\nreturn true\n}\n});\ndoc.exec = window.__appClosure__.docClosure.call(doc, data.code);\nguessVariableNames.forEach(name => {\ntry {\nconst value = doc.exec(name);\ndoc[name] = value;\n} catch (error) {\n// IGNORE\n}\n})\n  }\n  if(typeof data.code === 'string')\n  data.code = data.code.replace(/window\\.open/g, ''); //Sanitize window.open\n  switch (data.action) {\ncase 'execute':\n  doc.exec(data.code, data, engineEvent);\n  break;\ncase 'reset':\n  resetDocClosure();\n  return;\ndefault:\n  if (data.global) { // 兼容旧版本\nreturn resetDocClosure();\n  }\n  }\n  window.PDFJSGlobal.event = null;\n}\n  <\/script>\n</head>\n\n<body>\n</body>\n\n</html>\n"}},8272:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<div class="fv__ui-print-process">\n<div class="fv__ui-print-process-title">',t+=(0,i.$escape)(e.title),t+='</div>\n<div class="fv__ui-print-process-digital-progress"><span class="fv__ui-print-process-current">0</span>/<span class="fv__ui-print-process-total">0</span></div>\n<div class="fv__ui-print-process-bar">\n<div class="fv__ui-print-process-percent"></div>\n</div>\n</div>'}},1885:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv-callout">\n<div class="fv__shape-control callout">\n<canvas class="fv__shape-control-previewer"></canvas>\n<div class="fv__shape-control-move-area"></div>\n<div class="fv__shape-control-inner-area">\n<div class="fv__shape-controller callout left text"></div>\n<div class="fv__shape-controller callout top text"></div>\n<div class="fv__shape-controller callout right text"></div>\n<div class="fv__shape-controller callout bottom text"></div>\n</div>\n<div class="fv__shape-control-text-area"></div>\n<div class="fv__shape-controller callout calloutStart"></div>\n<div class="fv__shape-controller callout calloutKnee"></div>\n</div>\n</div>','<div class="fv-callout">\n<div class="fv__shape-control callout">\n<canvas class="fv__shape-control-previewer"></canvas>\n<div class="fv__shape-control-move-area"></div>\n<div class="fv__shape-control-inner-area">\n<div class="fv__shape-controller callout left text"></div>\n<div class="fv__shape-controller callout top text"></div>\n<div class="fv__shape-controller callout right text"></div>\n<div class="fv__shape-controller callout bottom text"></div>\n</div>\n<div class="fv__shape-control-text-area"></div>\n<div class="fv__shape-controller callout calloutStart"></div>\n<div class="fv__shape-controller callout calloutKnee"></div>\n</div>\n</div>'}},8012:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$escape,r=e.previewer,o=e.moveable,a=e.resizable,s=e.enableFrame,u=e.enableDiagonally,c=e.enableSizeBox,l=e.rotatable,d=e.degreeInitVisibility;return t+='<div class="fv__shape-control">\n<canvas class="fv__shape-control-previewer" ',t+=n(r?"":"style=display:none"),t+=" ></canvas>\n",o&&(t+='\n<div class="fv__shape-control-move-area"></div>\n'),t+='\n<div class="fv__shape-controller-resizable-wrap" ',t+=n(a?"":"style=visibility:hidden"),t+=" >\n",s&&(t+='\n<div class="fv__shape-controller" direction="north"></div>\n<div class="fv__shape-controller" direction="south"></div>\n<div class="fv__shape-controller" direction="west"></div>\n<div class="fv__shape-controller" direction="east"></div>\n'),t+="\n",u&&(t+='\n<div class="fv__shape-controller" direction="north-west"></div>\n<div class="fv__shape-controller" direction="north-east"></div>\n<div class="fv__shape-controller" direction="south-west"></div>\n<div class="fv__shape-controller" direction="south-east"></div>\n'),t+="\n",c&&(t+='\n<div class="fv__shape-size"></div>\n'),t+="\n</div>\n",l&&(t+='\n<div class="fv__shape-rotate">\n<div class="fv-shape-rotate-handle fv__cursor-rotation"></div>\n<div class="fv-shape-rotate-degree" ',t+=n(d?"":"style=visibility:hidden"),t+=' ></div>\n<div class="fv-shape-rotate-bound"></div>\n</div>\n'),t+="\n</div>"}},564:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";var t="";return t+='<div class="fv__rendering-container" >\n',t+=(e=e||{}).isIE?'\n<ul class="fv__loading-animation">\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n':'\n<div class="fv__rendering-svg" aria-live="assertive" aria-busy="true"></div>\n',t+="\n</div>"}},4528:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv__ui-progress-layer">\n<div class="fv__ui-progress-icon"></div>\n<span class="fv__ui-progress-text"></span>\n</div>','<div class="fv__ui-progress-layer">\n<div class="fv__ui-progress-icon"></div>\n<span class="fv__ui-progress-text"></span>\n</div>'}},3013:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="",n=i.$each,r=e.actions,o=(e.$value,e.$index,i.$escape);return t+='<div class="fv__selection-tool-tip-container" tabindex="0">\n\x3c!--<div class="fv__selection-tool-tip-items-container">--\x3e\n<div class="fv__selection-tool-tip-items">\n',n(r,(function(e,n){t+='\n<div class="fv__selection-tool-tip-item ',t+=o(e.iconClass),t+='" action="',t+=o(e.name),t+='"></div>\n'})),t+="\n</div>\n\x3c!--</div>--\x3e\n</div>"}},9901:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<audio class="fv__player" src="',t+=(0,i.$escape)(e.url),t+='"  poster="#" width="100%" height="100%" controls="controls" controlsList="nodownload" style="width: 100%; height: 100%;">Your browser does not support the audio tag.</audio>\r\n<button>\r\n<i class="fv__close-video"></i>\r\n</button>'}},5680:(e,t,n)=>{n(5779);e.exports=function(e){"use strict";e=e||{};return'<div class="fv__pdf-viewer-layout">\r\n<div class="fv__pdf-viewer-rendering"></div>\r\n<div class="fv__pdf-viewer-container"></div>\r\n<div class="fv__pdf-viewer-handler-container"></div>\r\n</div>','<div class="fv__pdf-viewer-layout">\r\n<div class="fv__pdf-viewer-rendering"></div>\r\n<div class="fv__pdf-viewer-container"></div>\r\n<div class="fv__pdf-viewer-handler-container"></div>\r\n</div>'}},2843:(e,t,n)=>{var i=n(5779);e.exports=function(e){"use strict";e=e||{};var t="";return t+='<video class="fv__player" src="',t+=(0,i.$escape)(e.url),t+='" poster="#" width="100%" height="100%" controls="controls" controlsList="nodownload">Your browser does not support the video tag.</video>\r\n<button>\r\n<i class="fv__close-video"></i>\r\n</button>'}},973:e=>{window,e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(2)},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n(1);var i={isFirefox:function(){return"undefined"!=typeof InstallTrigger},getFirefoxMajorVersion:function(e){var t=(e=e||navigator.userAgent).toLowerCase().match(/firefox\/(\S+)/);if(t)return t[1].split(".").map((function(e){return parseInt(e)}))[0]},isIE:function(){return-1!==navigator.userAgent.indexOf("MSIE")||!!document.documentMode},isEdge:function(){return!i.isIE()&&!!window.StyleMedia},isChrome:function(){return!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).chrome},isSafari:function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||-1!==navigator.userAgent.toLowerCase().indexOf("safari")},isIOSChrome:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("crios")}},r=i,o={show:function(e){var t=document.createElement("div");t.setAttribute("style","font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;"),t.setAttribute("id","printJS-Modal");var n=document.createElement("div");n.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;");var i=document.createElement("div");i.setAttribute("class","printClose"),i.setAttribute("id","printClose"),n.appendChild(i);var r=document.createElement("span");r.setAttribute("class","printSpinner"),n.appendChild(r);var a=document.createTextNode(e.modalMessage);n.appendChild(a),t.appendChild(n),document.getElementsByTagName("body")[0].appendChild(t),document.getElementById("printClose").addEventListener("click",(function(){o.close()}))},close:function(){var e=document.getElementById("printJS-Modal");e&&e.parentNode.removeChild(e)}},a=o;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e){return e.charAt(0).toUpperCase()+e.slice(1)}function c(e,t){for(var n=0;n<e.length;n++)if("object"===s(t)&&-1!==t.indexOf(e[n]))return!0;return!1}function l(e,t){var n=document.createElement("div");if(f(t.header))n.innerHTML=t.header;else{var i=document.createElement("h1"),r=document.createTextNode(t.header);i.appendChild(r),i.setAttribute("style",t.headerStyle),n.appendChild(i)}e.insertBefore(n,e.childNodes[0])}function d(e,t){var n=document.createElement("div");if(f(t.footer))n.innerHTML=t.footer;else{var i=document.createElement("h1"),r=document.createTextNode(t.footer);i.appendChild(r),i.setAttribute("style",t.footerStyle),n.appendChild(i)}e.insertBefore(n,e.childNodes.lastChild)}function h(e){e.showModal&&a.close(),e.onLoadingEnd&&e.onLoadingEnd(),(e.showModal||e.onLoadingStart)&&window.URL.revokeObjectURL(e.printable);var t="mouseover";(r.isChrome()||r.isFirefox())&&(t="focus"),window.addEventListener(t,(function n(){window.removeEventListener(t,n),e.onPrintDialogClose();var i=document.getElementById(e.frameId);i&&(e.frameRemoveDelay?setTimeout((function(){i.remove()}),e.frameRemoveDelay):i.remove())}))}function f(e){return new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>").test(e)}function g(e,t){try{if(r.isEdge()||r.isIE())try{e.focus(),e.contentWindow.document.execCommand("print",!1,null),h(t)}catch(n){setTimeout((function(){e.focus(),e.contentWindow.print(),h(t)}),1e3)}else setTimeout((function(){e.focus(),e.contentWindow.print(),h(t)}),1e3)}catch(e){t.onError(e)}finally{r.isFirefox()&&r.getFirefoxMajorVersion()<110&&(e.style.visibility="hidden",e.style.left="-1px")}}var v={send:function(e,t){document.getElementsByTagName("body")[0].appendChild(t);var n=document.getElementById(e.frameId);n.onload=function(){if("pdf"!==e.type){var t=n.contentWindow||n.contentDocument;if(t.document&&(t=t.document),t.body.appendChild(e.printableElement),"pdf"!==e.type&&e.style){var i=document.createElement("style");i.innerHTML=e.style,t.head.appendChild(i)}var o=t.getElementsByTagName("img");o.length>0?function(e){var t=e.map((function(e){if(e.src&&e.src!==window.location.href)return function(e){return new Promise((function(t){!function n(){e&&void 0!==e.naturalWidth&&0!==e.naturalWidth&&e.complete?t():setTimeout(n,500)}()}))}(e)}));return Promise.all(t)}(Array.from(o)).then((function(){return g(n,e)})):g(n,e)}else r.isFirefox()&&r.getFirefoxMajorVersion()<110||r.isSafari()?setTimeout((function(){return g(n,e)}),1e3):g(n,e)}}},p=function(e,t){if(e.base64){-1!==e.printable.indexOf(",")&&(e.printable=e.printable.split(",")[1]);var n=Uint8Array.from(atob(e.printable),(function(e){return e.charCodeAt(0)}));m(e,t,n)}else{e.printable=/^(blob|http|\/\/)/i.test(e.printable)?e.printable:window.location.origin+("/"!==e.printable.charAt(0)?"/"+e.printable:e.printable);var i=new window.XMLHttpRequest;i.responseType="arraybuffer",i.addEventListener("error",(function(){h(e),e.onError(i.statusText,i)})),i.addEventListener("load",(function(){if(-1===[200,201].indexOf(i.status))return h(e),void e.onError(i.statusText,i);m(e,t,i.response)})),i.open("GET",e.printable,!0),i.send()}};function m(e,t,n){var i=new window.Blob([n],{type:"application/pdf"});i=window.URL.createObjectURL(i),t.setAttribute("src",i),v.send(e,t)}function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}var k=function(e,t){var n,i="object"===y(n=e.printable)&&n&&(n instanceof HTMLElement||1===n.nodeType)?e.printable:document.getElementById(e.printable);i?(e.printableElement=b(i,e),e.header&&l(e.printableElement,e),e.footer&&d(e.printableElement,e),v.send(e,t)):window.console.error("Invalid HTML element id: "+e.printable)};function b(e,t){for(var n=e.cloneNode(),i=Array.prototype.slice.call(e.childNodes),r=0;r<i.length;r++)if(-1===t.ignoreElements.indexOf(i[r].id)){var o=b(i[r],t);n.appendChild(o)}switch(t.scanStyles&&1===e.nodeType&&n.setAttribute("style",function(e,t){for(var n="",i=(document.defaultView||window).getComputedStyle(e,""),r=0;r<i.length;r++)(-1!==t.targetStyles.indexOf("*")||-1!==t.targetStyle.indexOf(i[r])||c(t.targetStyles,i[r]))&&i.getPropertyValue(i[r])&&(n+=i[r]+":"+i.getPropertyValue(i[r])+";");return n+"max-width: "+t.maxWidth+"px !important; font-size: "+t.font_size+" !important;"}(e,t)),e.tagName){case"SELECT":n.value=e.value;break;case"CANVAS":n.getContext("2d").drawImage(e,0,0)}return n}var w=function(e,t){e.printableElement=document.createElement("div"),e.printableElement.setAttribute("style","width:100%"),e.printableElement.innerHTML=e.printable,e.header&&l(e.printableElement,e),e.footer&&d(e.printableElement,e),v.send(e,t)},_=function(e,t){e.printable.constructor!==Array&&(e.printable=[e.printable]),e.printableElement=document.createElement("div"),e.printable.forEach((function(t){var n=document.createElement("img");if(n.setAttribute("style",e.imageStyle),n.src=t,r.isFirefox()){var i=n.src;n.src=i}var o=document.createElement("div");o.appendChild(n),e.printableElement.appendChild(o)})),e.header&&l(e.printableElement,e),e.footer&&d(e.printableElement,e),v.send(e,t)};function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}var A=function(e,t){if("object"!==P(e.printable))throw new Error("Invalid javascript data object (JSON).");if("boolean"!=typeof e.repeatTableHeader)throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!e.properties||!Array.isArray(e.properties))throw new Error("Invalid properties array for your JSON data.");e.properties=e.properties.map((function(t){return{field:"object"===P(t)?t.field:t,displayName:"object"===P(t)?t.displayName:t,columnSize:"object"===P(t)&&t.columnSize?t.columnSize+";":100/e.properties.length+"%;"}})),e.printableElement=document.createElement("div"),e.header&&l(e.printableElement,e),e.printableElement.innerHTML+=function(e){var t=e.printable,n=e.properties,i='<table style="border-collapse: collapse; width: 100%;">';e.repeatTableHeader&&(i+="<thead>"),i+="<tr>";for(var r=0;r<n.length;r++)i+='<th style="width:'+n[r].columnSize+";"+e.gridHeaderStyle+'">'+u(n[r].displayName)+"</th>";i+="</tr>",e.repeatTableHeader&&(i+="</thead>"),i+="<tbody>";for(var o=0;o<t.length;o++){i+="<tr>";for(var a=0;a<n.length;a++){var s=t[o],c=n[a].field.split(".");if(c.length>1)for(var l=0;l<c.length;l++)s=s[c[l]];else s=s[n[a].field];i+='<td style="width:'+n[a].columnSize+e.gridStyle+'">'+s+"</td>"}i+="</tr>"}return i+"</tbody></table>"}(e),e.footer&&d(e.printableElement,e),v.send(e,t)};function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}var x=["pdf","html","image","json","raw-html"],C=function(){var e={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",footer:null,footerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(e){throw e},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",frameRemoveDelay:null,printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},t=arguments[0];if(void 0===t)throw new Error("printJS expects at least 1 attribute.");switch(S(t)){case"string":e.printable=encodeURI(t),e.fallbackPrintable=e.printable,e.type=arguments[1]||e.type;break;case"object":for(var n in e.printable=t.printable,e.fallbackPrintable=void 0!==t.fallbackPrintable?t.fallbackPrintable:e.printable,e.fallbackPrintable=e.base64?"data:application/pdf;base64,".concat(e.fallbackPrintable):e.fallbackPrintable,e)"printable"!==n&&"fallbackPrintable"!==n&&(e[n]=void 0!==t[n]?t[n]:e[n]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+S(t))}if(!e.printable)throw new Error("Missing printable information.");if(!e.type||"string"!=typeof e.type||-1===x.indexOf(e.type.toLowerCase()))throw new Error("Invalid print type. Available types are: pdf, html, image and json.");e.showModal&&a.show(e),e.onLoadingStart&&e.onLoadingStart();var i=document.getElementById(e.frameId);i&&i.parentNode.removeChild(i);var o=document.createElement("iframe");switch(r.isFirefox()?o.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):o.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),o.setAttribute("id",e.frameId),"pdf"!==e.type&&(o.srcdoc="<html><head><title>"+e.documentTitle+"</title>",e.css&&(Array.isArray(e.css)||(e.css=[e.css]),e.css.forEach((function(e){o.srcdoc+='<link rel="stylesheet" href="'+e+'">'}))),o.srcdoc+="</head><body></body></html>"),e.type){case"pdf":if(r.isIE())try{console.info("Print.js doesn't support PDF printing in Internet Explorer."),window.open(e.fallbackPrintable,"_blank").focus(),e.onIncompatibleBrowser()}catch(t){e.onError(t)}finally{e.showModal&&a.close(),e.onLoadingEnd&&e.onLoadingEnd()}else p(e,o);break;case"image":_(e,o);break;case"html":k(e,o);break;case"raw-html":w(e,o);break;case"json":A(e,o)}},D=C;"undefined"!=typeof window&&(window.printJS=D),t.default=D}]).default},5585:(e,t,n)=>{"use strict";
/*! art-template@runtime | https://github.com/aui/art-template */var i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},r=Object.create(i),o=/["&'<>]/;function a(e){return"string"!=typeof e&&(e=null==e?"":"function"==typeof e?a(e.call(e)):JSON.stringify(e)),e}r.$escape=function(e){return function(e){var t=""+e,n=o.exec(t);if(!n)return e;var i="",r=void 0,a=void 0,s=void 0;for(r=n.index,a=0;r<t.length;r++){switch(t.charCodeAt(r)){case 34:s="&#34;";break;case 38:s="&#38;";break;case 39:s="&#39;";break;case 60:s="&#60;";break;case 62:s="&#62;";break;default:continue}a!==r&&(i+=t.substring(a,r)),a=r+1,i+=s}return a!==r?i+t.substring(a,r):i}(a(e))},r.$each=function(e,t){if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)t(e[n],n);else for(var r in e)t(e[r],r)},e.exports=r},5779:(e,t,n)=>{"use strict";e.exports=n(5585)},7187:e=>{var t=Object.create||function(e){var t=function(){};return t.prototype=e,new t},n=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},i=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function r(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=t(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0;var o,a=10;try{var s={};Object.defineProperty&&Object.defineProperty(s,"x",{value:0}),o=0===s.x}catch(e){o=!1}function u(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function c(e,n,i,r){var o,a,s;if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');if((a=e._events)?(a.newListener&&(e.emit("newListener",n,i.listener?i.listener:i),a=e._events),s=a[n]):(a=e._events=t(null),e._eventsCount=0),s){if("function"==typeof s?s=a[n]=r?[i,s]:[s,i]:r?s.unshift(i):s.push(i),!s.warned&&(o=u(e))&&o>0&&s.length>o){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+' "'+String(n)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');c.name="MaxListenersExceededWarning",c.emitter=e,c.type=n,c.count=s.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",c.name,c.message)}}else s=a[n]=i,++e._eventsCount;return e}function l(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=i.call(l,r);return o.listener=n,r.wrapFn=o,o}function h(e,t,n){var i=e._events;if(!i)return[];var r=i[t];return r?"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):g(r,r.length):[]}function f(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function g(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}o?Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');a=e}}):r.defaultMaxListeners=a,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return u(this)},r.prototype.emit=function(e){var t,n,i,r,o,a,s="error"===e;if(a=this._events)s=s&&null==a.error;else if(!s)return!1;if(s){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var u=new Error('Unhandled "error" event. ('+t+")");throw u.context=t,u}if(!(n=a[e]))return!1;var c="function"==typeof n;switch(i=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var i=e.length,r=g(e,i),o=0;o<i;++o)r[o].call(n)}(n,c,this);break;case 2:!function(e,t,n,i){if(t)e.call(n,i);else for(var r=e.length,o=g(e,r),a=0;a<r;++a)o[a].call(n,i)}(n,c,this,arguments[1]);break;case 3:!function(e,t,n,i,r){if(t)e.call(n,i,r);else for(var o=e.length,a=g(e,o),s=0;s<o;++s)a[s].call(n,i,r)}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,i,r,o){if(t)e.call(n,i,r,o);else for(var a=e.length,s=g(e,a),u=0;u<a;++u)s[u].call(n,i,r,o)}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(i-1),o=1;o<i;o++)r[o-1]=arguments[o];!function(e,t,n,i){if(t)e.apply(n,i);else for(var r=e.length,o=g(e,r),a=0;a<r;++a)o[a].apply(n,i)}(n,c,this,r)}return!0},r.prototype.addListener=function(e,t){return c(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return c(this,e,t,!0)},r.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,d(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,d(this,e,t)),this},r.prototype.removeListener=function(e,n){var i,r,o,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(i=r[e]))return this;if(i===n||i.listener===n)0==--this._eventsCount?this._events=t(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if("function"!=typeof i){for(o=-1,a=i.length-1;a>=0;a--)if(i[a]===n||i[a].listener===n){s=i[a].listener,o=a;break}if(o<0)return this;0===o?i.shift():function(e,t){for(var n=t,i=n+1,r=e.length;i<r;n+=1,i+=1)e[n]=e[i];e.pop()}(i,o),1===i.length&&(r[e]=i[0]),r.removeListener&&this.emit("removeListener",e,s||n)}return this},r.prototype.removeAllListeners=function(e){var i,r,o;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=t(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=t(null):delete r[e]),this;if(0===arguments.length){var a,s=n(r);for(o=0;o<s.length;++o)"removeListener"!==(a=s[o])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=t(null),this._eventsCount=0,this}if("function"==typeof(i=r[e]))this.removeListener(e,i);else if(i)for(o=i.length-1;o>=0;o--)this.removeListener(e,i[o]);return this},r.prototype.listeners=function(e){return h(this,e,!0)},r.prototype.rawListeners=function(e){return h(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},r.prototype.listenerCount=f,r.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},4953:function(e){
/* flatpickr v4.6.9, @license MIT */
e.exports=function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var e=function(){return e=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},e.apply(this,arguments)};function t(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i}var n=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],i={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(e){return"undefined"!=typeof console&&console.warn(e)},getWeek:function(e){var t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var n=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},r={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(e){var t=e%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},o=function(e,t){return void 0===t&&(t=2),("000"+e).slice(-1*t)},a=function(e){return!0===e?1:0};function s(e,t){var n;return function(){var i=this;clearTimeout(n),n=setTimeout((function(){return e.apply(i,arguments)}),t)}}var u=function(e){return e instanceof Array?e:[e]};function c(e,t,n){if(!0===n)return e.classList.add(t);e.classList.remove(t)}function l(e,t,n){var i=window.document.createElement(e);return t=t||"",n=n||"",i.className=t,void 0!==n&&(i.textContent=n),i}function d(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function h(e,t){return t(e)?e:e.parentNode?h(e.parentNode,t):void 0}function f(e,t){var n=l("div","numInputWrapper"),i=l("input","numInput "+e),r=l("span","arrowUp"),o=l("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?i.type="number":(i.type="text",i.pattern="\\d*"),void 0!==t)for(var a in t)i.setAttribute(a,t[a]);return n.appendChild(i),n.appendChild(r),n.appendChild(o),n}function g(e){try{return"function"==typeof e.composedPath?e.composedPath()[0]:e.target}catch(t){return e.target}}var v=function(){},p=function(e,t,n){return n.months[t?"shorthand":"longhand"][e]},m={D:v,F:function(e,t,n){e.setMonth(n.months.longhand.indexOf(t))},G:function(e,t){e.setHours(parseFloat(t))},H:function(e,t){e.setHours(parseFloat(t))},J:function(e,t){e.setDate(parseFloat(t))},K:function(e,t,n){e.setHours(e.getHours()%12+12*a(new RegExp(n.amPM[1],"i").test(t)))},M:function(e,t,n){e.setMonth(n.months.shorthand.indexOf(t))},S:function(e,t){e.setSeconds(parseFloat(t))},U:function(e,t){return new Date(1e3*parseFloat(t))},W:function(e,t,n){var i=parseInt(t),r=new Date(e.getFullYear(),0,2+7*(i-1),0,0,0,0);return r.setDate(r.getDate()-r.getDay()+n.firstDayOfWeek),r},Y:function(e,t){e.setFullYear(parseFloat(t))},Z:function(e,t){return new Date(t)},d:function(e,t){e.setDate(parseFloat(t))},h:function(e,t){e.setHours(parseFloat(t))},i:function(e,t){e.setMinutes(parseFloat(t))},j:function(e,t){e.setDate(parseFloat(t))},l:v,m:function(e,t){e.setMonth(parseFloat(t)-1)},n:function(e,t){e.setMonth(parseFloat(t)-1)},s:function(e,t){e.setSeconds(parseFloat(t))},u:function(e,t){return new Date(parseFloat(t))},w:v,y:function(e,t){e.setFullYear(2e3+parseFloat(t))}},y={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},k={Z:function(e){return e.toISOString()},D:function(e,t,n){return t.weekdays.shorthand[k.w(e,t,n)]},F:function(e,t,n){return p(k.n(e,t,n)-1,!1,t)},G:function(e,t,n){return o(k.h(e,t,n))},H:function(e){return o(e.getHours())},J:function(e,t){return void 0!==t.ordinal?e.getDate()+t.ordinal(e.getDate()):e.getDate()},K:function(e,t){return t.amPM[a(e.getHours()>11)]},M:function(e,t){return p(e.getMonth(),!0,t)},S:function(e){return o(e.getSeconds())},U:function(e){return e.getTime()/1e3},W:function(e,t,n){return n.getWeek(e)},Y:function(e){return o(e.getFullYear(),4)},d:function(e){return o(e.getDate())},h:function(e){return e.getHours()%12?e.getHours()%12:12},i:function(e){return o(e.getMinutes())},j:function(e){return e.getDate()},l:function(e,t){return t.weekdays.longhand[e.getDay()]},m:function(e){return o(e.getMonth()+1)},n:function(e){return e.getMonth()+1},s:function(e){return e.getSeconds()},u:function(e){return e.getTime()},w:function(e){return e.getDay()},y:function(e){return String(e.getFullYear()).substring(2)}},b=function(e){var t=e.config,n=void 0===t?i:t,o=e.l10n,a=void 0===o?r:o,s=e.isMobile,u=void 0!==s&&s;return function(e,t,i){var r=i||a;return void 0===n.formatDate||u?t.split("").map((function(t,i,o){return k[t]&&"\\"!==o[i-1]?k[t](e,r,n):"\\"!==t?t:""})).join(""):n.formatDate(e,t,r)}},w=function(e){var t=e.config,n=void 0===t?i:t,o=e.l10n,a=void 0===o?r:o;return function(e,t,r,o){if(0===e||e){var s,u=o||a,c=e;if(e instanceof Date)s=new Date(e.getTime());else if("string"!=typeof e&&void 0!==e.toFixed)s=new Date(e);else if("string"==typeof e){var l=t||(n||i).dateFormat,d=String(e).trim();if("today"===d)s=new Date,r=!0;else if(/Z$/.test(d)||/GMT$/.test(d))s=new Date(e);else if(n&&n.parseDate)s=n.parseDate(e,l);else{s=n&&n.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0);for(var h=void 0,f=[],g=0,v=0,p="";g<l.length;g++){var k=l[g],b="\\"===k,w="\\"===l[g-1]||b;if(y[k]&&!w){p+=y[k];var _=new RegExp(p).exec(e);_&&(h=!0)&&f["Y"!==k?"push":"unshift"]({fn:m[k],val:_[++v]})}else b||(p+=".");f.forEach((function(e){var t=e.fn,n=e.val;return s=t(s,n,u)||s}))}s=h?s:void 0}}if(s instanceof Date&&!isNaN(s.getTime()))return!0===r&&s.setHours(0,0,0,0),s;n.errorHandler(new Error("Invalid date provided: "+c))}}};function _(e,t,n){return void 0===n&&(n=!0),!1!==n?new Date(e.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):e.getTime()-t.getTime()}var P=function(e,t,n){return e>Math.min(t,n)&&e<Math.max(t,n)},A={DAY:864e5};function S(e){var t=e.defaultHour,n=e.defaultMinute,i=e.defaultSeconds;if(void 0!==e.minDate){var r=e.minDate.getHours(),o=e.minDate.getMinutes(),a=e.minDate.getSeconds();t<r&&(t=r),t===r&&n<o&&(n=o),t===r&&n===o&&i<a&&(i=e.minDate.getSeconds())}if(void 0!==e.maxDate){var s=e.maxDate.getHours(),u=e.maxDate.getMinutes();(t=Math.min(t,s))===s&&(n=Math.min(u,n)),t===s&&n===u&&(i=e.maxDate.getSeconds())}return{hours:t,minutes:n,seconds:i}}"function"!=typeof Object.assign&&(Object.assign=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!e)throw TypeError("Cannot convert undefined or null to object");for(var i=function(t){t&&Object.keys(t).forEach((function(n){return e[n]=t[n]}))},r=0,o=t;r<o.length;r++)i(o[r]);return e});var x=300;function C(v,m){var k={config:e(e({},i),E.defaultConfig),l10n:r};function C(){k.utils={getDaysInMonth:function(e,t){return void 0===e&&(e=k.currentMonth),void 0===t&&(t=k.currentYear),1===e&&(t%4==0&&t%100!=0||t%400==0)?29:k.l10n.daysInMonth[e]}}}function D(){k.element=k.input=v,k.isOpen=!1,_e(),Ae(),Ne(),Le(),C(),k.isMobile||q(),U(),(k.selectedDates.length||k.config.noCalendar)&&(k.config.enableTime&&L(k.config.noCalendar?k.latestSelectedDateObj:void 0),Ke(!1)),R();var e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!k.isMobile&&e&&Se(),je("onReady")}function I(e){return e.bind(k)}function R(){var e=k.config;!1===e.weekNumbers&&1===e.showMonths||!0!==e.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==k.calendarContainer&&(k.calendarContainer.style.visibility="hidden",k.calendarContainer.style.display="block"),void 0!==k.daysContainer){var t=(k.days.offsetWidth+1)*e.showMonths;k.daysContainer.style.width=t+"px",k.calendarContainer.style.width=t+(void 0!==k.weekWrapper?k.weekWrapper.offsetWidth:0)+"px",k.calendarContainer.style.removeProperty("visibility"),k.calendarContainer.style.removeProperty("display")}}))}function T(e){if(0===k.selectedDates.length){var t=void 0===k.config.minDate||_(new Date,k.config.minDate)>=0?new Date:new Date(k.config.minDate.getTime()),n=S(k.config);t.setHours(n.hours,n.minutes,n.seconds,t.getMilliseconds()),k.selectedDates=[t],k.latestSelectedDateObj=t}void 0!==e&&"blur"!==e.type&&ze(e);var i=k._input.value;O(),Ke(),k._input.value!==i&&k._debouncedChange()}function F(e,t){return e%12+12*a(t===k.l10n.amPM[1])}function M(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}function O(){if(void 0!==k.hourElement&&void 0!==k.minuteElement){var e=(parseInt(k.hourElement.value.slice(-2),10)||0)%24,t=(parseInt(k.minuteElement.value,10)||0)%60,n=void 0!==k.secondElement?(parseInt(k.secondElement.value,10)||0)%60:0;void 0!==k.amPM&&(e=F(e,k.amPM.textContent));var i=void 0!==k.config.minTime||k.config.minDate&&k.minDateHasTime&&k.latestSelectedDateObj&&0===_(k.latestSelectedDateObj,k.config.minDate,!0);if(void 0!==k.config.maxTime||k.config.maxDate&&k.maxDateHasTime&&k.latestSelectedDateObj&&0===_(k.latestSelectedDateObj,k.config.maxDate,!0)){var r=void 0!==k.config.maxTime?k.config.maxTime:k.config.maxDate;(e=Math.min(e,r.getHours()))===r.getHours()&&(t=Math.min(t,r.getMinutes())),t===r.getMinutes()&&(n=Math.min(n,r.getSeconds()))}if(i){var o=void 0!==k.config.minTime?k.config.minTime:k.config.minDate;(e=Math.max(e,o.getHours()))===o.getHours()&&t<o.getMinutes()&&(t=o.getMinutes()),t===o.getMinutes()&&(n=Math.max(n,o.getSeconds()))}N(e,t,n)}}function L(e){var t=e||k.latestSelectedDateObj;t&&N(t.getHours(),t.getMinutes(),t.getSeconds())}function N(e,t,n){void 0!==k.latestSelectedDateObj&&k.latestSelectedDateObj.setHours(e%24,t,n||0,0),k.hourElement&&k.minuteElement&&!k.isMobile&&(k.hourElement.value=o(k.config.time_24hr?e:(12+e)%12+12*a(e%12==0)),k.minuteElement.value=o(t),void 0!==k.amPM&&(k.amPM.textContent=k.l10n.amPM[a(e>=12)]),void 0!==k.secondElement&&(k.secondElement.value=o(n)))}function V(e){var t=g(e),n=parseInt(t.value)+(e.delta||0);(n/1e3>1||"Enter"===e.key&&!/[^\d]/.test(n.toString()))&&fe(n)}function B(e,t,n,i){return t instanceof Array?t.forEach((function(t){return B(e,t,n,i)})):e instanceof Array?e.forEach((function(e){return B(e,t,n,i)})):(e.addEventListener(t,n,i),void k._handlers.push({remove:function(){return e.removeEventListener(t,n)}}))}function j(){je("onChange")}function U(){if(k.config.wrap&&["open","close","toggle","clear"].forEach((function(e){Array.prototype.forEach.call(k.element.querySelectorAll("[data-"+e+"]"),(function(t){return B(t,"click",k[e])}))})),k.isMobile)Ve();else{var e=s(ke,50);if(k._debouncedChange=s(j,x),k.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&B(k.daysContainer,"mouseover",(function(e){"range"===k.config.mode&&ye(g(e))})),B(window.document.body,"keydown",me),k.config.inline||k.config.static||B(window,"resize",e),void 0!==window.ontouchstart?B(window.document,"touchstart",he):B(window.document,"mousedown",he),B(window.document,"focus",he,{capture:!0}),!0===k.config.clickOpens&&(B(k._input,"focus",k.open),B(k._input,"click",k.open)),void 0!==k.daysContainer&&(B(k.monthNav,"click",$e),B(k.monthNav,["keyup","increment"],V),B(k.daysContainer,"click",Ie)),void 0!==k.timeContainer&&void 0!==k.minuteElement&&void 0!==k.hourElement){var t=function(e){return g(e).select()};B(k.timeContainer,["increment"],T),B(k.timeContainer,"blur",T,{capture:!0}),B(k.timeContainer,"click",W),B([k.hourElement,k.minuteElement],["focus","click"],t),void 0!==k.secondElement&&B(k.secondElement,"focus",(function(){return k.secondElement&&k.secondElement.select()})),void 0!==k.amPM&&B(k.amPM,"click",(function(e){T(e),j()}))}k.config.allowInput&&B(k._input,"blur",pe)}}function H(e,t){var n=void 0!==e?k.parseDate(e):k.latestSelectedDateObj||(k.config.minDate&&k.config.minDate>k.now?k.config.minDate:k.config.maxDate&&k.config.maxDate<k.now?k.config.maxDate:k.now),i=k.currentYear,r=k.currentMonth;try{void 0!==n&&(k.currentYear=n.getFullYear(),k.currentMonth=n.getMonth())}catch(e){e.message="Invalid date supplied: "+n,k.config.errorHandler(e)}t&&k.currentYear!==i&&(je("onYearChange"),Q()),!t||k.currentYear===i&&k.currentMonth===r||je("onMonthChange"),k.redraw()}function W(e){var t=g(e);~t.className.indexOf("arrow")&&Y(e,t.classList.contains("arrowUp")?1:-1)}function Y(e,t,n){var i=e&&g(e),r=n||i&&i.parentNode&&i.parentNode.firstChild,o=Ue("increment");o.delta=t,r&&r.dispatchEvent(o)}function q(){var e=window.document.createDocumentFragment();if(k.calendarContainer=l("div","flatpickr-calendar"),k.calendarContainer.tabIndex=-1,!k.config.noCalendar){if(e.appendChild(ne()),k.innerContainer=l("div","flatpickr-innerContainer"),k.config.weekNumbers){var t=ae(),n=t.weekWrapper,i=t.weekNumbers;k.innerContainer.appendChild(n),k.weekNumbers=i,k.weekWrapper=n}k.rContainer=l("div","flatpickr-rContainer"),k.rContainer.appendChild(re()),k.daysContainer||(k.daysContainer=l("div","flatpickr-days"),k.daysContainer.tabIndex=-1),Z(),k.rContainer.appendChild(k.daysContainer),k.innerContainer.appendChild(k.rContainer),e.appendChild(k.innerContainer)}k.config.enableTime&&e.appendChild(ie()),c(k.calendarContainer,"rangeMode","range"===k.config.mode),c(k.calendarContainer,"animate",!0===k.config.animate),c(k.calendarContainer,"multiMonth",k.config.showMonths>1),k.calendarContainer.appendChild(e);var r=void 0!==k.config.appendTo&&void 0!==k.config.appendTo.nodeType;if((k.config.inline||k.config.static)&&(k.calendarContainer.classList.add(k.config.inline?"inline":"static"),k.config.inline&&(!r&&k.element.parentNode?k.element.parentNode.insertBefore(k.calendarContainer,k._input.nextSibling):void 0!==k.config.appendTo&&k.config.appendTo.appendChild(k.calendarContainer)),k.config.static)){var o=l("div","flatpickr-wrapper");k.element.parentNode&&k.element.parentNode.insertBefore(o,k.element),o.appendChild(k.element),k.altInput&&o.appendChild(k.altInput),o.appendChild(k.calendarContainer)}k.config.static||k.config.inline||(void 0!==k.config.appendTo?k.config.appendTo:window.document.body).appendChild(k.calendarContainer)}function K(e,t,n,i){var r=ge(t,!0),o=l("span","flatpickr-day "+e,t.getDate().toString());return o.dateObj=t,o.$i=i,o.setAttribute("aria-label",k.formatDate(t,k.config.ariaDateFormat)),-1===e.indexOf("hidden")&&0===_(t,k.now)&&(k.todayDateElem=o,o.classList.add("today"),o.setAttribute("aria-current","date")),r?(o.tabIndex=-1,He(t)&&(o.classList.add("selected"),k.selectedDateElem=o,"range"===k.config.mode&&(c(o,"startRange",k.selectedDates[0]&&0===_(t,k.selectedDates[0],!0)),c(o,"endRange",k.selectedDates[1]&&0===_(t,k.selectedDates[1],!0)),"nextMonthDay"===e&&o.classList.add("inRange")))):o.classList.add("flatpickr-disabled"),"range"===k.config.mode&&We(t)&&!He(t)&&o.classList.add("inRange"),k.weekNumbers&&1===k.config.showMonths&&"prevMonthDay"!==e&&n%7==1&&k.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+k.config.getWeek(t)+"</span>"),je("onDayCreate",o),o}function $(e){e.focus(),"range"===k.config.mode&&ye(e)}function z(e){for(var t=e>0?0:k.config.showMonths-1,n=e>0?k.config.showMonths:-1,i=t;i!=n;i+=e)for(var r=k.daysContainer.children[i],o=e>0?0:r.children.length-1,a=e>0?r.children.length:-1,s=o;s!=a;s+=e){var u=r.children[s];if(-1===u.className.indexOf("hidden")&&ge(u.dateObj))return u}}function G(e,t){for(var n=-1===e.className.indexOf("Month")?e.dateObj.getMonth():k.currentMonth,i=t>0?k.config.showMonths:-1,r=t>0?1:-1,o=n-k.currentMonth;o!=i;o+=r)for(var a=k.daysContainer.children[o],s=n-k.currentMonth===o?e.$i+t:t<0?a.children.length-1:0,u=a.children.length,c=s;c>=0&&c<u&&c!=(t>0?u:-1);c+=r){var l=a.children[c];if(-1===l.className.indexOf("hidden")&&ge(l.dateObj)&&Math.abs(e.$i-c)>=Math.abs(t))return $(l)}k.changeMonth(r),J(z(r),0)}function J(e,t){var n=ve(document.activeElement||document.body),i=void 0!==e?e:n?document.activeElement:void 0!==k.selectedDateElem&&ve(k.selectedDateElem)?k.selectedDateElem:void 0!==k.todayDateElem&&ve(k.todayDateElem)?k.todayDateElem:z(t>0?1:-1);void 0===i?k._input.focus():n?G(i,t):$(i)}function X(e,t){for(var n=(new Date(e,t,1).getDay()-k.l10n.firstDayOfWeek+7)%7,i=k.utils.getDaysInMonth((t-1+12)%12,e),r=k.utils.getDaysInMonth(t,e),o=window.document.createDocumentFragment(),a=k.config.showMonths>1,s=a?"prevMonthDay hidden":"prevMonthDay",u=a?"nextMonthDay hidden":"nextMonthDay",c=i+1-n,d=0;c<=i;c++,d++)o.appendChild(K(s,new Date(e,t-1,c),c,d));for(c=1;c<=r;c++,d++)o.appendChild(K("",new Date(e,t,c),c,d));for(var h=r+1;h<=42-n&&(1===k.config.showMonths||d%7!=0);h++,d++)o.appendChild(K(u,new Date(e,t+1,h%r),h,d));var f=l("div","dayContainer");return f.appendChild(o),f}function Z(){if(void 0!==k.daysContainer){d(k.daysContainer),k.weekNumbers&&d(k.weekNumbers);for(var e=document.createDocumentFragment(),t=0;t<k.config.showMonths;t++){var n=new Date(k.currentYear,k.currentMonth,1);n.setMonth(k.currentMonth+t),e.appendChild(X(n.getFullYear(),n.getMonth()))}k.daysContainer.appendChild(e),k.days=k.daysContainer.firstChild,"range"===k.config.mode&&1===k.selectedDates.length&&ye()}}function Q(){if(!(k.config.showMonths>1||"dropdown"!==k.config.monthSelectorType)){var e=function(e){return!(void 0!==k.config.minDate&&k.currentYear===k.config.minDate.getFullYear()&&e<k.config.minDate.getMonth()||void 0!==k.config.maxDate&&k.currentYear===k.config.maxDate.getFullYear()&&e>k.config.maxDate.getMonth())};k.monthsDropdownContainer.tabIndex=-1,k.monthsDropdownContainer.innerHTML="";for(var t=0;t<12;t++)if(e(t)){var n=l("option","flatpickr-monthDropdown-month");n.value=new Date(k.currentYear,t).getMonth().toString(),n.textContent=p(t,k.config.shorthandCurrentMonth,k.l10n),n.tabIndex=-1,k.currentMonth===t&&(n.selected=!0),k.monthsDropdownContainer.appendChild(n)}}}function ee(){var e,t=l("div","flatpickr-month"),n=window.document.createDocumentFragment();k.config.showMonths>1||"static"===k.config.monthSelectorType?e=l("span","cur-month"):(k.monthsDropdownContainer=l("select","flatpickr-monthDropdown-months"),k.monthsDropdownContainer.setAttribute("aria-label",k.l10n.monthAriaLabel),B(k.monthsDropdownContainer,"change",(function(e){var t=g(e),n=parseInt(t.value,10);k.changeMonth(n-k.currentMonth),je("onMonthChange")})),Q(),e=k.monthsDropdownContainer);var i=f("cur-year",{tabindex:"-1"}),r=i.getElementsByTagName("input")[0];r.setAttribute("aria-label",k.l10n.yearAriaLabel),k.config.minDate&&r.setAttribute("min",k.config.minDate.getFullYear().toString()),k.config.maxDate&&(r.setAttribute("max",k.config.maxDate.getFullYear().toString()),r.disabled=!!k.config.minDate&&k.config.minDate.getFullYear()===k.config.maxDate.getFullYear());var o=l("div","flatpickr-current-month");return o.appendChild(e),o.appendChild(i),n.appendChild(o),t.appendChild(n),{container:t,yearElement:r,monthElement:e}}function te(){d(k.monthNav),k.monthNav.appendChild(k.prevMonthNav),k.config.showMonths&&(k.yearElements=[],k.monthElements=[]);for(var e=k.config.showMonths;e--;){var t=ee();k.yearElements.push(t.yearElement),k.monthElements.push(t.monthElement),k.monthNav.appendChild(t.container)}k.monthNav.appendChild(k.nextMonthNav)}function ne(){return k.monthNav=l("div","flatpickr-months"),k.yearElements=[],k.monthElements=[],k.prevMonthNav=l("span","flatpickr-prev-month"),k.prevMonthNav.innerHTML=k.config.prevArrow,k.nextMonthNav=l("span","flatpickr-next-month"),k.nextMonthNav.innerHTML=k.config.nextArrow,te(),Object.defineProperty(k,"_hidePrevMonthArrow",{get:function(){return k.__hidePrevMonthArrow},set:function(e){k.__hidePrevMonthArrow!==e&&(c(k.prevMonthNav,"flatpickr-disabled",e),k.__hidePrevMonthArrow=e)}}),Object.defineProperty(k,"_hideNextMonthArrow",{get:function(){return k.__hideNextMonthArrow},set:function(e){k.__hideNextMonthArrow!==e&&(c(k.nextMonthNav,"flatpickr-disabled",e),k.__hideNextMonthArrow=e)}}),k.currentYearElement=k.yearElements[0],Ye(),k.monthNav}function ie(){k.calendarContainer.classList.add("hasTime"),k.config.noCalendar&&k.calendarContainer.classList.add("noCalendar");var e=S(k.config);k.timeContainer=l("div","flatpickr-time"),k.timeContainer.tabIndex=-1;var t=l("span","flatpickr-time-separator",":"),n=f("flatpickr-hour",{"aria-label":k.l10n.hourAriaLabel});k.hourElement=n.getElementsByTagName("input")[0];var i=f("flatpickr-minute",{"aria-label":k.l10n.minuteAriaLabel});if(k.minuteElement=i.getElementsByTagName("input")[0],k.hourElement.tabIndex=k.minuteElement.tabIndex=-1,k.hourElement.value=o(k.latestSelectedDateObj?k.latestSelectedDateObj.getHours():k.config.time_24hr?e.hours:M(e.hours)),k.minuteElement.value=o(k.latestSelectedDateObj?k.latestSelectedDateObj.getMinutes():e.minutes),k.hourElement.setAttribute("step",k.config.hourIncrement.toString()),k.minuteElement.setAttribute("step",k.config.minuteIncrement.toString()),k.hourElement.setAttribute("min",k.config.time_24hr?"0":"1"),k.hourElement.setAttribute("max",k.config.time_24hr?"23":"12"),k.hourElement.setAttribute("maxlength","2"),k.minuteElement.setAttribute("min","0"),k.minuteElement.setAttribute("max","59"),k.minuteElement.setAttribute("maxlength","2"),k.timeContainer.appendChild(n),k.timeContainer.appendChild(t),k.timeContainer.appendChild(i),k.config.time_24hr&&k.timeContainer.classList.add("time24hr"),k.config.enableSeconds){k.timeContainer.classList.add("hasSeconds");var r=f("flatpickr-second");k.secondElement=r.getElementsByTagName("input")[0],k.secondElement.value=o(k.latestSelectedDateObj?k.latestSelectedDateObj.getSeconds():e.seconds),k.secondElement.setAttribute("step",k.minuteElement.getAttribute("step")),k.secondElement.setAttribute("min","0"),k.secondElement.setAttribute("max","59"),k.secondElement.setAttribute("maxlength","2"),k.timeContainer.appendChild(l("span","flatpickr-time-separator",":")),k.timeContainer.appendChild(r)}return k.config.time_24hr||(k.amPM=l("span","flatpickr-am-pm",k.l10n.amPM[a((k.latestSelectedDateObj?k.hourElement.value:k.config.defaultHour)>11)]),k.amPM.title=k.l10n.toggleTitle,k.amPM.tabIndex=-1,k.timeContainer.appendChild(k.amPM)),k.timeContainer}function re(){k.weekdayContainer?d(k.weekdayContainer):k.weekdayContainer=l("div","flatpickr-weekdays");for(var e=k.config.showMonths;e--;){var t=l("div","flatpickr-weekdaycontainer");k.weekdayContainer.appendChild(t)}return oe(),k.weekdayContainer}function oe(){if(k.weekdayContainer){var e=k.l10n.firstDayOfWeek,n=t(k.l10n.weekdays.shorthand);e>0&&e<n.length&&(n=t(n.splice(e,n.length),n.splice(0,e)));for(var i=k.config.showMonths;i--;)k.weekdayContainer.children[i].innerHTML="\n      <span class='flatpickr-weekday'>\n        "+n.join("</span><span class='flatpickr-weekday'>")+"\n      </span>\n      "}}function ae(){k.calendarContainer.classList.add("hasWeeks");var e=l("div","flatpickr-weekwrapper");e.appendChild(l("span","flatpickr-weekday",k.l10n.weekAbbreviation));var t=l("div","flatpickr-weeks");return e.appendChild(t),{weekWrapper:e,weekNumbers:t}}function se(e,t){void 0===t&&(t=!0);var n=t?e:e-k.currentMonth;n<0&&!0===k._hidePrevMonthArrow||n>0&&!0===k._hideNextMonthArrow||(k.currentMonth+=n,(k.currentMonth<0||k.currentMonth>11)&&(k.currentYear+=k.currentMonth>11?1:-1,k.currentMonth=(k.currentMonth+12)%12,je("onYearChange"),Q()),Z(),je("onMonthChange"),Ye())}function ue(e,t){if(void 0===e&&(e=!0),void 0===t&&(t=!0),k.input.value="",void 0!==k.altInput&&(k.altInput.value=""),void 0!==k.mobileInput&&(k.mobileInput.value=""),k.selectedDates=[],k.latestSelectedDateObj=void 0,!0===t&&(k.currentYear=k._initialDate.getFullYear(),k.currentMonth=k._initialDate.getMonth()),!0===k.config.enableTime){var n=S(k.config);N(n.hours,n.minutes,n.seconds)}k.redraw(),e&&je("onChange")}function ce(){k.isOpen=!1,k.isMobile||(void 0!==k.calendarContainer&&k.calendarContainer.classList.remove("open"),void 0!==k._input&&k._input.classList.remove("active")),je("onClose")}function le(){void 0!==k.config&&je("onDestroy");for(var e=k._handlers.length;e--;)k._handlers[e].remove();if(k._handlers=[],k.mobileInput)k.mobileInput.parentNode&&k.mobileInput.parentNode.removeChild(k.mobileInput),k.mobileInput=void 0;else if(k.calendarContainer&&k.calendarContainer.parentNode)if(k.config.static&&k.calendarContainer.parentNode){var t=k.calendarContainer.parentNode;if(t.lastChild&&t.removeChild(t.lastChild),t.parentNode){for(;t.firstChild;)t.parentNode.insertBefore(t.firstChild,t);t.parentNode.removeChild(t)}}else k.calendarContainer.parentNode.removeChild(k.calendarContainer);k.altInput&&(k.input.type="text",k.altInput.parentNode&&k.altInput.parentNode.removeChild(k.altInput),delete k.altInput),k.input&&(k.input.type=k.input._type,k.input.classList.remove("flatpickr-input"),k.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((function(e){try{delete k[e]}catch(e){}}))}function de(e){return!(!k.config.appendTo||!k.config.appendTo.contains(e))||k.calendarContainer.contains(e)}function he(e){if(k.isOpen&&!k.config.inline){var t=g(e),n=de(t),i=t===k.input||t===k.altInput||k.element.contains(t)||e.path&&e.path.indexOf&&(~e.path.indexOf(k.input)||~e.path.indexOf(k.altInput)),r="blur"===e.type?i&&e.relatedTarget&&!de(e.relatedTarget):!i&&!n&&!de(e.relatedTarget),o=!k.config.ignoredFocusElements.some((function(e){return e.contains(t)}));r&&o&&(void 0!==k.timeContainer&&void 0!==k.minuteElement&&void 0!==k.hourElement&&""!==k.input.value&&void 0!==k.input.value&&T(),k.close(),k.config&&"range"===k.config.mode&&1===k.selectedDates.length&&(k.clear(!1),k.redraw()))}}function fe(e){if(!(!e||k.config.minDate&&e<k.config.minDate.getFullYear()||k.config.maxDate&&e>k.config.maxDate.getFullYear())){var t=e,n=k.currentYear!==t;k.currentYear=t||k.currentYear,k.config.maxDate&&k.currentYear===k.config.maxDate.getFullYear()?k.currentMonth=Math.min(k.config.maxDate.getMonth(),k.currentMonth):k.config.minDate&&k.currentYear===k.config.minDate.getFullYear()&&(k.currentMonth=Math.max(k.config.minDate.getMonth(),k.currentMonth)),n&&(k.redraw(),je("onYearChange"),Q())}}function ge(e,t){var n;void 0===t&&(t=!0);var i=k.parseDate(e,void 0,t);if(k.config.minDate&&i&&_(i,k.config.minDate,void 0!==t?t:!k.minDateHasTime)<0||k.config.maxDate&&i&&_(i,k.config.maxDate,void 0!==t?t:!k.maxDateHasTime)>0)return!1;if(!k.config.enable&&0===k.config.disable.length)return!0;if(void 0===i)return!1;for(var r=!!k.config.enable,o=null!==(n=k.config.enable)&&void 0!==n?n:k.config.disable,a=0,s=void 0;a<o.length;a++){if("function"==typeof(s=o[a])&&s(i))return r;if(s instanceof Date&&void 0!==i&&s.getTime()===i.getTime())return r;if("string"==typeof s){var u=k.parseDate(s,void 0,!0);return u&&u.getTime()===i.getTime()?r:!r}if("object"==typeof s&&void 0!==i&&s.from&&s.to&&i.getTime()>=s.from.getTime()&&i.getTime()<=s.to.getTime())return r}return!r}function ve(e){return void 0!==k.daysContainer&&-1===e.className.indexOf("hidden")&&-1===e.className.indexOf("flatpickr-disabled")&&k.daysContainer.contains(e)}function pe(e){e.target!==k._input||!(k.selectedDates.length>0||k._input.value.length>0)||e.relatedTarget&&de(e.relatedTarget)||k.setDate(k._input.value,!0,e.target===k.altInput?k.config.altFormat:k.config.dateFormat)}function me(e){var t=g(e),n=k.config.wrap?v.contains(t):t===k._input,i=k.config.allowInput,r=k.isOpen&&(!i||!n),o=k.config.inline&&n&&!i;if(13===e.keyCode&&n){if(i)return k.setDate(k._input.value,!0,t===k.altInput?k.config.altFormat:k.config.dateFormat),t.blur();k.open()}else if(de(t)||r||o){var a=!!k.timeContainer&&k.timeContainer.contains(t);switch(e.keyCode){case 13:a?(e.preventDefault(),T(),Ee()):Ie(e);break;case 27:e.preventDefault(),Ee();break;case 8:case 46:n&&!k.config.allowInput&&(e.preventDefault(),k.clear());break;case 37:case 39:if(a||n)k.hourElement&&k.hourElement.focus();else if(e.preventDefault(),void 0!==k.daysContainer&&(!1===i||document.activeElement&&ve(document.activeElement))){var s=39===e.keyCode?1:-1;e.ctrlKey?(e.stopPropagation(),se(s),J(z(1),0)):J(void 0,s)}break;case 38:case 40:e.preventDefault();var u=40===e.keyCode?1:-1;k.daysContainer&&void 0!==t.$i||t===k.input||t===k.altInput?e.ctrlKey?(e.stopPropagation(),fe(k.currentYear-u),J(z(1),0)):a||J(void 0,7*u):t===k.currentYearElement?fe(k.currentYear-u):k.config.enableTime&&(!a&&k.hourElement&&k.hourElement.focus(),T(e),k._debouncedChange());break;case 9:if(a){var c=[k.hourElement,k.minuteElement,k.secondElement,k.amPM].concat(k.pluginElements).filter((function(e){return e})),l=c.indexOf(t);if(-1!==l){var d=c[l+(e.shiftKey?-1:1)];e.preventDefault(),(d||k._input).focus()}}else!k.config.noCalendar&&k.daysContainer&&k.daysContainer.contains(t)&&e.shiftKey&&(e.preventDefault(),k._input.focus())}}if(void 0!==k.amPM&&t===k.amPM)switch(e.key){case k.l10n.amPM[0].charAt(0):case k.l10n.amPM[0].charAt(0).toLowerCase():k.amPM.textContent=k.l10n.amPM[0],O(),Ke();break;case k.l10n.amPM[1].charAt(0):case k.l10n.amPM[1].charAt(0).toLowerCase():k.amPM.textContent=k.l10n.amPM[1],O(),Ke()}(n||de(t))&&je("onKeyDown",e)}function ye(e){if(1===k.selectedDates.length&&(!e||e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled"))){for(var t=e?e.dateObj.getTime():k.days.firstElementChild.dateObj.getTime(),n=k.parseDate(k.selectedDates[0],void 0,!0).getTime(),i=Math.min(t,k.selectedDates[0].getTime()),r=Math.max(t,k.selectedDates[0].getTime()),o=!1,a=0,s=0,u=i;u<r;u+=A.DAY)ge(new Date(u),!0)||(o=o||u>i&&u<r,u<n&&(!a||u>a)?a=u:u>n&&(!s||u<s)&&(s=u));for(var c=0;c<k.config.showMonths;c++)for(var l=k.daysContainer.children[c],d=function(i,r){var u=l.children[i],c=u.dateObj.getTime(),d=a>0&&c<a||s>0&&c>s;return d?(u.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach((function(e){u.classList.remove(e)})),"continue"):o&&!d?"continue":(["startRange","inRange","endRange","notAllowed"].forEach((function(e){u.classList.remove(e)})),void(void 0!==e&&(e.classList.add(t<=k.selectedDates[0].getTime()?"startRange":"endRange"),n<t&&c===n?u.classList.add("startRange"):n>t&&c===n&&u.classList.add("endRange"),c>=a&&(0===s||c<=s)&&P(c,n,t)&&u.classList.add("inRange"))))},h=0,f=l.children.length;h<f;h++)d(h,f)}}function ke(){!k.isOpen||k.config.static||k.config.inline||Se()}function be(e,t){if(void 0===t&&(t=k._positionElement),!0===k.isMobile){if(e){e.preventDefault();var n=g(e);n&&n.blur()}return void 0!==k.mobileInput&&(k.mobileInput.focus(),k.mobileInput.click()),void je("onOpen")}if(!k._input.disabled&&!k.config.inline){var i=k.isOpen;k.isOpen=!0,i||(k.calendarContainer.classList.add("open"),k._input.classList.add("active"),je("onOpen"),Se(t)),!0===k.config.enableTime&&!0===k.config.noCalendar&&(!1!==k.config.allowInput||void 0!==e&&k.timeContainer.contains(e.relatedTarget)||setTimeout((function(){return k.hourElement.select()}),50))}}function we(e){return function(t){var n=k.config["_"+e+"Date"]=k.parseDate(t,k.config.dateFormat),i=k.config["_"+("min"===e?"max":"min")+"Date"];void 0!==n&&(k["min"===e?"minDateHasTime":"maxDateHasTime"]=n.getHours()>0||n.getMinutes()>0||n.getSeconds()>0),k.selectedDates&&(k.selectedDates=k.selectedDates.filter((function(e){return ge(e)})),k.selectedDates.length||"min"!==e||L(n),Ke()),k.daysContainer&&(De(),void 0!==n?k.currentYearElement[e]=n.getFullYear().toString():k.currentYearElement.removeAttribute(e),k.currentYearElement.disabled=!!i&&void 0!==n&&i.getFullYear()===n.getFullYear())}}function _e(){var t=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],r=e(e({},JSON.parse(JSON.stringify(v.dataset||{}))),m),o={};k.config.parseDate=r.parseDate,k.config.formatDate=r.formatDate,Object.defineProperty(k.config,"enable",{get:function(){return k.config._enable},set:function(e){k.config._enable=Oe(e)}}),Object.defineProperty(k.config,"disable",{get:function(){return k.config._disable},set:function(e){k.config._disable=Oe(e)}});var a="time"===r.mode;if(!r.dateFormat&&(r.enableTime||a)){var s=E.defaultConfig.dateFormat||i.dateFormat;o.dateFormat=r.noCalendar||a?"H:i"+(r.enableSeconds?":S":""):s+" H:i"+(r.enableSeconds?":S":"")}if(r.altInput&&(r.enableTime||a)&&!r.altFormat){var c=E.defaultConfig.altFormat||i.altFormat;o.altFormat=r.noCalendar||a?"h:i"+(r.enableSeconds?":S K":" K"):c+" h:i"+(r.enableSeconds?":S":"")+" K"}Object.defineProperty(k.config,"minDate",{get:function(){return k.config._minDate},set:we("min")}),Object.defineProperty(k.config,"maxDate",{get:function(){return k.config._maxDate},set:we("max")});var l=function(e){return function(t){k.config["min"===e?"_minTime":"_maxTime"]=k.parseDate(t,"H:i:S")}};Object.defineProperty(k.config,"minTime",{get:function(){return k.config._minTime},set:l("min")}),Object.defineProperty(k.config,"maxTime",{get:function(){return k.config._maxTime},set:l("max")}),"time"===r.mode&&(k.config.noCalendar=!0,k.config.enableTime=!0),Object.assign(k.config,o,r);for(var d=0;d<t.length;d++)k.config[t[d]]=!0===k.config[t[d]]||"true"===k.config[t[d]];for(n.filter((function(e){return void 0!==k.config[e]})).forEach((function(e){k.config[e]=u(k.config[e]||[]).map(I)})),k.isMobile=!k.config.disableMobile&&!k.config.inline&&"single"===k.config.mode&&!k.config.disable.length&&!k.config.enable&&!k.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),d=0;d<k.config.plugins.length;d++){var h=k.config.plugins[d](k)||{};for(var f in h)n.indexOf(f)>-1?k.config[f]=u(h[f]).map(I).concat(k.config[f]):void 0===r[f]&&(k.config[f]=h[f])}r.altInputClass||(k.config.altInputClass=Pe().className+" "+k.config.altInputClass),je("onParseConfig")}function Pe(){return k.config.wrap?v.querySelector("[data-input]"):v}function Ae(){"object"!=typeof k.config.locale&&void 0===E.l10ns[k.config.locale]&&k.config.errorHandler(new Error("flatpickr: invalid locale "+k.config.locale)),k.l10n=e(e({},E.l10ns.default),"object"==typeof k.config.locale?k.config.locale:"default"!==k.config.locale?E.l10ns[k.config.locale]:void 0),y.K="("+k.l10n.amPM[0]+"|"+k.l10n.amPM[1]+"|"+k.l10n.amPM[0].toLowerCase()+"|"+k.l10n.amPM[1].toLowerCase()+")",void 0===e(e({},m),JSON.parse(JSON.stringify(v.dataset||{}))).time_24hr&&void 0===E.defaultConfig.time_24hr&&(k.config.time_24hr=k.l10n.time_24hr),k.formatDate=b(k),k.parseDate=w({config:k.config,l10n:k.l10n})}function Se(e){if("function"!=typeof k.config.position){if(void 0!==k.calendarContainer){je("onPreCalendarPosition");var t=e||k._positionElement,n=Array.prototype.reduce.call(k.calendarContainer.children,(function(e,t){return e+t.offsetHeight}),0),i=k.calendarContainer.offsetWidth,r=k.config.position.split(" "),o=r[0],a=r.length>1?r[1]:null,s=t.getBoundingClientRect(),u=window.innerHeight-s.bottom,l="above"===o||"below"!==o&&u<n&&s.top>n,d=window.pageYOffset+s.top+(l?-n-2:t.offsetHeight+2);if(c(k.calendarContainer,"arrowTop",!l),c(k.calendarContainer,"arrowBottom",l),!k.config.inline){var h=window.pageXOffset+s.left,f=!1,g=!1;"center"===a?(h-=(i-s.width)/2,f=!0):"right"===a&&(h-=i-s.width,g=!0),c(k.calendarContainer,"arrowLeft",!f&&!g),c(k.calendarContainer,"arrowCenter",f),c(k.calendarContainer,"arrowRight",g);var v=window.document.body.offsetWidth-(window.pageXOffset+s.right),p=h+i>window.document.body.offsetWidth,m=v+i>window.document.body.offsetWidth;if(c(k.calendarContainer,"rightMost",p),!k.config.static)if(k.calendarContainer.style.top=d+"px",p)if(m){var y=xe();if(void 0===y)return;var b=window.document.body.offsetWidth,w=Math.max(0,b/2-i/2),_=".flatpickr-calendar.centerMost:before",P=".flatpickr-calendar.centerMost:after",A=y.cssRules.length,S="{left:"+s.left+"px;right:auto;}";c(k.calendarContainer,"rightMost",!1),c(k.calendarContainer,"centerMost",!0),y.insertRule(_+","+P+S,A),k.calendarContainer.style.left=w+"px",k.calendarContainer.style.right="auto"}else k.calendarContainer.style.left="auto",k.calendarContainer.style.right=v+"px";else k.calendarContainer.style.left=h+"px",k.calendarContainer.style.right="auto"}}}else k.config.position(k,e)}function xe(){for(var e=null,t=0;t<document.styleSheets.length;t++){var n=document.styleSheets[t];try{n.cssRules}catch(e){continue}e=n;break}return null!=e?e:Ce()}function Ce(){var e=document.createElement("style");return document.head.appendChild(e),e.sheet}function De(){k.config.noCalendar||k.isMobile||(Q(),Ye(),Z())}function Ee(){k._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(k.close,0):k.close()}function Ie(e){e.preventDefault(),e.stopPropagation();var t=function(e){return e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")},n=h(g(e),t);if(void 0!==n){var i=n,r=k.latestSelectedDateObj=new Date(i.dateObj.getTime()),o=(r.getMonth()<k.currentMonth||r.getMonth()>k.currentMonth+k.config.showMonths-1)&&"range"!==k.config.mode;if(k.selectedDateElem=i,"single"===k.config.mode)k.selectedDates=[r];else if("multiple"===k.config.mode){var a=He(r);a?k.selectedDates.splice(parseInt(a),1):k.selectedDates.push(r)}else"range"===k.config.mode&&(2===k.selectedDates.length&&k.clear(!1,!1),k.latestSelectedDateObj=r,k.selectedDates.push(r),0!==_(r,k.selectedDates[0],!0)&&k.selectedDates.sort((function(e,t){return e.getTime()-t.getTime()})));if(O(),o){var s=k.currentYear!==r.getFullYear();k.currentYear=r.getFullYear(),k.currentMonth=r.getMonth(),s&&(je("onYearChange"),Q()),je("onMonthChange")}if(Ye(),Z(),Ke(),o||"range"===k.config.mode||1!==k.config.showMonths?void 0!==k.selectedDateElem&&void 0===k.hourElement&&k.selectedDateElem&&k.selectedDateElem.focus():$(i),void 0!==k.hourElement&&void 0!==k.hourElement&&k.hourElement.focus(),k.config.closeOnSelect){var u="single"===k.config.mode&&!k.config.enableTime,c="range"===k.config.mode&&2===k.selectedDates.length&&!k.config.enableTime;(u||c)&&Ee()}j()}}k.parseDate=w({config:k.config,l10n:k.l10n}),k._handlers=[],k.pluginElements=[],k.loadedPlugins=[],k._bind=B,k._setHoursFromDate=L,k._positionCalendar=Se,k.changeMonth=se,k.changeYear=fe,k.clear=ue,k.close=ce,k._createElement=l,k.destroy=le,k.isEnabled=ge,k.jumpToDate=H,k.open=be,k.redraw=De,k.set=Te,k.setDate=Me,k.toggle=Be;var Re={locale:[Ae,oe],showMonths:[te,R,re],minDate:[H],maxDate:[H],clickOpens:[function(){!0===k.config.clickOpens?(B(k._input,"focus",k.open),B(k._input,"click",k.open)):(k._input.removeEventListener("focus",k.open),k._input.removeEventListener("click",k.open))}]};function Te(e,t){if(null!==e&&"object"==typeof e)for(var i in Object.assign(k.config,e),e)void 0!==Re[i]&&Re[i].forEach((function(e){return e()}));else k.config[e]=t,void 0!==Re[e]?Re[e].forEach((function(e){return e()})):n.indexOf(e)>-1&&(k.config[e]=u(t));k.redraw(),Ke(!0)}function Fe(e,t){var n=[];if(e instanceof Array)n=e.map((function(e){return k.parseDate(e,t)}));else if(e instanceof Date||"number"==typeof e)n=[k.parseDate(e,t)];else if("string"==typeof e)switch(k.config.mode){case"single":case"time":n=[k.parseDate(e,t)];break;case"multiple":n=e.split(k.config.conjunction).map((function(e){return k.parseDate(e,t)}));break;case"range":n=e.split(k.l10n.rangeSeparator).map((function(e){return k.parseDate(e,t)}))}else k.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(e)));k.selectedDates=k.config.allowInvalidPreload?n:n.filter((function(e){return e instanceof Date&&ge(e,!1)})),"range"===k.config.mode&&k.selectedDates.sort((function(e,t){return e.getTime()-t.getTime()}))}function Me(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=k.config.dateFormat),0!==e&&!e||e instanceof Array&&0===e.length)return k.clear(t);Fe(e,n),k.latestSelectedDateObj=k.selectedDates[k.selectedDates.length-1],k.redraw(),H(void 0,t),L(),0===k.selectedDates.length&&k.clear(!1),Ke(t),t&&je("onChange")}function Oe(e){return e.slice().map((function(e){return"string"==typeof e||"number"==typeof e||e instanceof Date?k.parseDate(e,void 0,!0):e&&"object"==typeof e&&e.from&&e.to?{from:k.parseDate(e.from,void 0),to:k.parseDate(e.to,void 0)}:e})).filter((function(e){return e}))}function Le(){k.selectedDates=[],k.now=k.parseDate(k.config.now)||new Date;var e=k.config.defaultDate||("INPUT"!==k.input.nodeName&&"TEXTAREA"!==k.input.nodeName||!k.input.placeholder||k.input.value!==k.input.placeholder?k.input.value:null);e&&Fe(e,k.config.dateFormat),k._initialDate=k.selectedDates.length>0?k.selectedDates[0]:k.config.minDate&&k.config.minDate.getTime()>k.now.getTime()?k.config.minDate:k.config.maxDate&&k.config.maxDate.getTime()<k.now.getTime()?k.config.maxDate:k.now,k.currentYear=k._initialDate.getFullYear(),k.currentMonth=k._initialDate.getMonth(),k.selectedDates.length>0&&(k.latestSelectedDateObj=k.selectedDates[0]),void 0!==k.config.minTime&&(k.config.minTime=k.parseDate(k.config.minTime,"H:i")),void 0!==k.config.maxTime&&(k.config.maxTime=k.parseDate(k.config.maxTime,"H:i")),k.minDateHasTime=!!k.config.minDate&&(k.config.minDate.getHours()>0||k.config.minDate.getMinutes()>0||k.config.minDate.getSeconds()>0),k.maxDateHasTime=!!k.config.maxDate&&(k.config.maxDate.getHours()>0||k.config.maxDate.getMinutes()>0||k.config.maxDate.getSeconds()>0)}function Ne(){k.input=Pe(),k.input?(k.input._type=k.input.type,k.input.type="text",k.input.classList.add("flatpickr-input"),k._input=k.input,k.config.altInput&&(k.altInput=l(k.input.nodeName,k.config.altInputClass),k._input=k.altInput,k.altInput.placeholder=k.input.placeholder,k.altInput.disabled=k.input.disabled,k.altInput.required=k.input.required,k.altInput.tabIndex=k.input.tabIndex,k.altInput.type="text",k.input.setAttribute("type","hidden"),!k.config.static&&k.input.parentNode&&k.input.parentNode.insertBefore(k.altInput,k.input.nextSibling)),k.config.allowInput||k._input.setAttribute("readonly","readonly"),k._positionElement=k.config.positionElement||k._input):k.config.errorHandler(new Error("Invalid input element specified"))}function Ve(){var e=k.config.enableTime?k.config.noCalendar?"time":"datetime-local":"date";k.mobileInput=l("input",k.input.className+" flatpickr-mobile"),k.mobileInput.tabIndex=1,k.mobileInput.type=e,k.mobileInput.disabled=k.input.disabled,k.mobileInput.required=k.input.required,k.mobileInput.placeholder=k.input.placeholder,k.mobileFormatStr="datetime-local"===e?"Y-m-d\\TH:i:S":"date"===e?"Y-m-d":"H:i:S",k.selectedDates.length>0&&(k.mobileInput.defaultValue=k.mobileInput.value=k.formatDate(k.selectedDates[0],k.mobileFormatStr)),k.config.minDate&&(k.mobileInput.min=k.formatDate(k.config.minDate,"Y-m-d")),k.config.maxDate&&(k.mobileInput.max=k.formatDate(k.config.maxDate,"Y-m-d")),k.input.getAttribute("step")&&(k.mobileInput.step=String(k.input.getAttribute("step"))),k.input.type="hidden",void 0!==k.altInput&&(k.altInput.type="hidden");try{k.input.parentNode&&k.input.parentNode.insertBefore(k.mobileInput,k.input.nextSibling)}catch(e){}B(k.mobileInput,"change",(function(e){k.setDate(g(e).value,!1,k.mobileFormatStr),je("onChange"),je("onClose")}))}function Be(e){if(!0===k.isOpen)return k.close();k.open(e)}function je(e,t){if(void 0!==k.config){var n=k.config[e];if(void 0!==n&&n.length>0)for(var i=0;n[i]&&i<n.length;i++)n[i](k.selectedDates,k.input.value,k,t);"onChange"===e&&(k.input.dispatchEvent(Ue("change")),k.input.dispatchEvent(Ue("input")))}}function Ue(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}function He(e){for(var t=0;t<k.selectedDates.length;t++)if(0===_(k.selectedDates[t],e))return""+t;return!1}function We(e){return!("range"!==k.config.mode||k.selectedDates.length<2)&&_(e,k.selectedDates[0])>=0&&_(e,k.selectedDates[1])<=0}function Ye(){k.config.noCalendar||k.isMobile||!k.monthNav||(k.yearElements.forEach((function(e,t){var n=new Date(k.currentYear,k.currentMonth,1);n.setMonth(k.currentMonth+t),k.config.showMonths>1||"static"===k.config.monthSelectorType?k.monthElements[t].textContent=p(n.getMonth(),k.config.shorthandCurrentMonth,k.l10n)+" ":k.monthsDropdownContainer.value=n.getMonth().toString(),e.value=n.getFullYear().toString()})),k._hidePrevMonthArrow=void 0!==k.config.minDate&&(k.currentYear===k.config.minDate.getFullYear()?k.currentMonth<=k.config.minDate.getMonth():k.currentYear<k.config.minDate.getFullYear()),k._hideNextMonthArrow=void 0!==k.config.maxDate&&(k.currentYear===k.config.maxDate.getFullYear()?k.currentMonth+1>k.config.maxDate.getMonth():k.currentYear>k.config.maxDate.getFullYear()))}function qe(e){return k.selectedDates.map((function(t){return k.formatDate(t,e)})).filter((function(e,t,n){return"range"!==k.config.mode||k.config.enableTime||n.indexOf(e)===t})).join("range"!==k.config.mode?k.config.conjunction:k.l10n.rangeSeparator)}function Ke(e){void 0===e&&(e=!0),void 0!==k.mobileInput&&k.mobileFormatStr&&(k.mobileInput.value=void 0!==k.latestSelectedDateObj?k.formatDate(k.latestSelectedDateObj,k.mobileFormatStr):""),k.input.value=qe(k.config.dateFormat),void 0!==k.altInput&&(k.altInput.value=qe(k.config.altFormat)),!1!==e&&je("onValueUpdate")}function $e(e){var t=g(e),n=k.prevMonthNav.contains(t),i=k.nextMonthNav.contains(t);n||i?se(n?-1:1):k.yearElements.indexOf(t)>=0?t.select():t.classList.contains("arrowUp")?k.changeYear(k.currentYear+1):t.classList.contains("arrowDown")&&k.changeYear(k.currentYear-1)}function ze(e){e.preventDefault();var t="keydown"===e.type,n=g(e),i=n;void 0!==k.amPM&&n===k.amPM&&(k.amPM.textContent=k.l10n.amPM[a(k.amPM.textContent===k.l10n.amPM[0])]);var r=parseFloat(i.getAttribute("min")),s=parseFloat(i.getAttribute("max")),u=parseFloat(i.getAttribute("step")),c=parseInt(i.value,10),l=c+u*(e.delta||(t?38===e.which?1:-1:0));if(void 0!==i.value&&2===i.value.length){var d=i===k.hourElement,h=i===k.minuteElement;l<r?(l=s+l+a(!d)+(a(d)&&a(!k.amPM)),h&&Y(void 0,-1,k.hourElement)):l>s&&(l=i===k.hourElement?l-s-a(!k.amPM):r,h&&Y(void 0,1,k.hourElement)),k.amPM&&d&&(1===u?l+c===23:Math.abs(l-c)>u)&&(k.amPM.textContent=k.l10n.amPM[a(k.amPM.textContent===k.l10n.amPM[0])]),i.value=o(l)}}return D(),k}function D(e,t){for(var n=Array.prototype.slice.call(e).filter((function(e){return e instanceof HTMLElement})),i=[],r=0;r<n.length;r++){var o=n[r];try{if(null!==o.getAttribute("data-fp-omit"))continue;void 0!==o._flatpickr&&(o._flatpickr.destroy(),o._flatpickr=void 0),o._flatpickr=C(o,t||{}),i.push(o._flatpickr)}catch(e){console.error(e)}}return 1===i.length?i[0]:i}"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return D(this,e)},HTMLElement.prototype.flatpickr=function(e){return D([this],e)});var E=function(e,t){return"string"==typeof e?D(window.document.querySelectorAll(e),t):e instanceof Node?D([e],t):D(e,t)};return E.defaultConfig={},E.l10ns={en:e({},r),default:e({},r)},E.localize=function(t){E.l10ns.default=e(e({},E.l10ns.default),t)},E.setDefaults=function(t){E.defaultConfig=e(e({},E.defaultConfig),t)},E.parseDate=w({}),E.formatDate=b({}),E.compareDates=_,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(e){return D(this,e)}),Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof e?parseInt(e,10):e))},"undefined"!=typeof window&&(window.flatpickr=E),E}()},2805:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["So","Mo","Di","Mi","Do","Fr","Sa"],longhand:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},months:{shorthand:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],longhand:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},firstDayOfWeek:1,weekAbbreviation:"KW",rangeSeparator:" bis ",scrollTitle:"Zum Ändern scrollen",toggleTitle:"Zum Umschalten klicken",time_24hr:!0};t.l10ns.de=n;var i=t.l10ns;e.German=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},969:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],longhand:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"]},months:{shorthand:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],longhand:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]},ordinal:function(){return"º"},firstDayOfWeek:1,rangeSeparator:" a ",time_24hr:!0};t.l10ns.es=n;var i=t.l10ns;e.Spanish=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},401:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={firstDayOfWeek:1,weekdays:{shorthand:["dim","lun","mar","mer","jeu","ven","sam"],longhand:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},months:{shorthand:["janv","févr","mars","avr","mai","juin","juil","août","sept","oct","nov","déc"],longhand:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},ordinal:function(e){return e>1?"":"er"},rangeSeparator:" au ",weekAbbreviation:"Sem",scrollTitle:"Défiler pour augmenter la valeur",toggleTitle:"Cliquer pour basculer",time_24hr:!0};t.l10ns.fr=n;var i=t.l10ns;e.French=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},9088:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],longhand:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"]},months:{shorthand:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],longhand:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"]},firstDayOfWeek:1,ordinal:function(){return"°"},rangeSeparator:" al ",weekAbbreviation:"Se",scrollTitle:"Scrolla per aumentare",toggleTitle:"Clicca per cambiare",time_24hr:!0};t.l10ns.it=n;var i=t.l10ns;e.Italian=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},6741:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["日","月","火","水","木","金","土"],longhand:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"]},months:{shorthand:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],longhand:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},time_24hr:!0,rangeSeparator:" から ",monthAriaLabel:"月",amPM:["午前","午後"],yearAriaLabel:"年",hourAriaLabel:"時間",minuteAriaLabel:"分"};t.l10ns.ja=n;var i=t.l10ns;e.Japanese=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},1844:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["일","월","화","수","목","금","토"],longhand:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"]},months:{shorthand:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],longhand:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]},ordinal:function(){return"일"},rangeSeparator:" ~ "};t.l10ns.ko=n;var i=t.l10ns;e.Korean=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},6679:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["zo","ma","di","wo","do","vr","za"],longhand:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"]},months:{shorthand:["jan","feb","mrt","apr","mei","jun","jul","aug","sept","okt","nov","dec"],longhand:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"]},firstDayOfWeek:1,weekAbbreviation:"wk",rangeSeparator:" t/m ",scrollTitle:"Scroll voor volgende / vorige",toggleTitle:"Klik om te wisselen",time_24hr:!0,ordinal:function(e){return 1===e||8===e||e>=20?"ste":"de"}};t.l10ns.nl=n;var i=t.l10ns;e.Dutch=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},7821:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["週日","週一","週二","週三","週四","週五","週六"],longhand:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},months:{shorthand:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],longhand:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},rangeSeparator:" 至 ",weekAbbreviation:"週",scrollTitle:"滾動切換",toggleTitle:"點擊切換 12/24 小時時制"};t.l10ns.zh_tw=n;var i=t.l10ns;e.MandarinTraditional=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},799:function(e,t){!function(e){"use strict";var t="undefined"!=typeof window&&void 0!==window.flatpickr?window.flatpickr:{l10ns:{}},n={weekdays:{shorthand:["周日","周一","周二","周三","周四","周五","周六"],longhand:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"]},months:{shorthand:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],longhand:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},rangeSeparator:" 至 ",weekAbbreviation:"周",scrollTitle:"滚动切换",toggleTitle:"点击切换 12/24 小时时制"};t.l10ns.zh=n;var i=t.l10ns;e.Mandarin=n,e.default=i,Object.defineProperty(e,"__esModule",{value:!0})}(t)},8552:(e,t,n)=>{var i=n(852)(n(5639),"DataView");e.exports=i},1989:(e,t,n)=>{var i=n(1789),r=n(8792),o=n(7667),a=n(1327),s=n(1866);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}u.prototype.clear=i,u.prototype.delete=r,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,e.exports=u},8407:(e,t,n)=>{var i=n(7040),r=n(4125),o=n(2117),a=n(7518),s=n(4705);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}u.prototype.clear=i,u.prototype.delete=r,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,e.exports=u},7071:(e,t,n)=>{var i=n(852)(n(5639),"Map");e.exports=i},3369:(e,t,n)=>{var i=n(4785),r=n(1285),o=n(6e3),a=n(9916),s=n(5265);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}u.prototype.clear=i,u.prototype.delete=r,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,e.exports=u},3818:(e,t,n)=>{var i=n(852)(n(5639),"Promise");e.exports=i},8525:(e,t,n)=>{var i=n(852)(n(5639),"Set");e.exports=i},8668:(e,t,n)=>{var i=n(3369),r=n(619),o=n(2385);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new i;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=r,a.prototype.has=o,e.exports=a},6384:(e,t,n)=>{var i=n(8407),r=n(7465),o=n(3779),a=n(7599),s=n(4758),u=n(4309);function c(e){var t=this.__data__=new i(e);this.size=t.size}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=a,c.prototype.has=s,c.prototype.set=u,e.exports=c},2705:(e,t,n)=>{var i=n(5639).Symbol;e.exports=i},1149:(e,t,n)=>{var i=n(5639).Uint8Array;e.exports=i},577:(e,t,n)=>{var i=n(852)(n(5639),"WeakMap");e.exports=i},4963:e=>{e.exports=function(e,t){for(var n=-1,i=null==e?0:e.length,r=0,o=[];++n<i;){var a=e[n];t(a,n,e)&&(o[r++]=a)}return o}},4636:(e,t,n)=>{var i=n(2545),r=n(5694),o=n(1469),a=n(4144),s=n(5776),u=n(6719),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),l=!n&&r(e),d=!n&&!l&&a(e),h=!n&&!l&&!d&&u(e),f=n||l||d||h,g=f?i(e.length,String):[],v=g.length;for(var p in e)!t&&!c.call(e,p)||f&&("length"==p||d&&("offset"==p||"parent"==p)||h&&("buffer"==p||"byteLength"==p||"byteOffset"==p)||s(p,v))||g.push(p);return g}},2488:e=>{e.exports=function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}},2908:e=>{e.exports=function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}},8470:(e,t,n)=>{var i=n(7813);e.exports=function(e,t){for(var n=e.length;n--;)if(i(e[n][0],t))return n;return-1}},8866:(e,t,n)=>{var i=n(2488),r=n(1469);e.exports=function(e,t,n){var o=t(e);return r(e)?o:i(o,n(e))}},4239:(e,t,n)=>{var i=n(2705),r=n(9607),o=n(2333),a=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?r(e):o(e)}},9454:(e,t,n)=>{var i=n(4239),r=n(7005);e.exports=function(e){return r(e)&&"[object Arguments]"==i(e)}},939:(e,t,n)=>{var i=n(2492),r=n(7005);e.exports=function e(t,n,o,a,s){return t===n||(null==t||null==n||!r(t)&&!r(n)?t!=t&&n!=n:i(t,n,o,a,e,s))}},2492:(e,t,n)=>{var i=n(6384),r=n(7114),o=n(8351),a=n(6096),s=n(4160),u=n(1469),c=n(4144),l=n(6719),d="[object Arguments]",h="[object Array]",f="[object Object]",g=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,v,p,m){var y=u(e),k=u(t),b=y?h:s(e),w=k?h:s(t),_=(b=b==d?f:b)==f,P=(w=w==d?f:w)==f,A=b==w;if(A&&c(e)){if(!c(t))return!1;y=!0,_=!1}if(A&&!_)return m||(m=new i),y||l(e)?r(e,t,n,v,p,m):o(e,t,b,n,v,p,m);if(!(1&n)){var S=_&&g.call(e,"__wrapped__"),x=P&&g.call(t,"__wrapped__");if(S||x){var C=S?e.value():e,D=x?t.value():t;return m||(m=new i),p(C,D,n,v,m)}}return!!A&&(m||(m=new i),a(e,t,n,v,p,m))}},8458:(e,t,n)=>{var i=n(3560),r=n(5346),o=n(3218),a=n(346),s=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,d=c.hasOwnProperty,h=RegExp("^"+l.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||r(e))&&(i(e)?h:s).test(a(e))}},8749:(e,t,n)=>{var i=n(4239),r=n(1780),o=n(7005),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&r(e.length)&&!!a[i(e)]}},280:(e,t,n)=>{var i=n(5726),r=n(6916),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!i(e))return r(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},2545:e=>{e.exports=function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}},7561:(e,t,n)=>{var i=n(7990),r=/^\s+/;e.exports=function(e){return e?e.slice(0,i(e)+1).replace(r,""):e}},1717:e=>{e.exports=function(e){return function(t){return e(t)}}},4757:e=>{e.exports=function(e,t){return e.has(t)}},4429:(e,t,n)=>{var i=n(5639)["__core-js_shared__"];e.exports=i},7114:(e,t,n)=>{var i=n(8668),r=n(2908),o=n(4757);e.exports=function(e,t,n,a,s,u){var c=1&n,l=e.length,d=t.length;if(l!=d&&!(c&&d>l))return!1;var h=u.get(e),f=u.get(t);if(h&&f)return h==t&&f==e;var g=-1,v=!0,p=2&n?new i:void 0;for(u.set(e,t),u.set(t,e);++g<l;){var m=e[g],y=t[g];if(a)var k=c?a(y,m,g,t,e,u):a(m,y,g,e,t,u);if(void 0!==k){if(k)continue;v=!1;break}if(p){if(!r(t,(function(e,t){if(!o(p,t)&&(m===e||s(m,e,n,a,u)))return p.push(t)}))){v=!1;break}}else if(m!==y&&!s(m,y,n,a,u)){v=!1;break}}return u.delete(e),u.delete(t),v}},8351:(e,t,n)=>{var i=n(2705),r=n(1149),o=n(7813),a=n(7114),s=n(8776),u=n(1814),c=i?i.prototype:void 0,l=c?c.valueOf:void 0;e.exports=function(e,t,n,i,c,d,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new r(e),new r(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=s;case"[object Set]":var g=1&i;if(f||(f=u),e.size!=t.size&&!g)return!1;var v=h.get(e);if(v)return v==t;i|=2,h.set(e,t);var p=a(f(e),f(t),i,c,d,h);return h.delete(e),p;case"[object Symbol]":if(l)return l.call(e)==l.call(t)}return!1}},6096:(e,t,n)=>{var i=n(8234),r=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,a,s){var u=1&n,c=i(e),l=c.length;if(l!=i(t).length&&!u)return!1;for(var d=l;d--;){var h=c[d];if(!(u?h in t:r.call(t,h)))return!1}var f=s.get(e),g=s.get(t);if(f&&g)return f==t&&g==e;var v=!0;s.set(e,t),s.set(t,e);for(var p=u;++d<l;){var m=e[h=c[d]],y=t[h];if(o)var k=u?o(y,m,h,t,e,s):o(m,y,h,e,t,s);if(!(void 0===k?m===y||a(m,y,n,o,s):k)){v=!1;break}p||(p="constructor"==h)}if(v&&!p){var b=e.constructor,w=t.constructor;b==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w||(v=!1)}return s.delete(e),s.delete(t),v}},1957:(e,t,n)=>{var i="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=i},8234:(e,t,n)=>{var i=n(8866),r=n(9551),o=n(3674);e.exports=function(e){return i(e,o,r)}},5050:(e,t,n)=>{var i=n(7019);e.exports=function(e,t){var n=e.__data__;return i(t)?n["string"==typeof t?"string":"hash"]:n.map}},852:(e,t,n)=>{var i=n(8458),r=n(7801);e.exports=function(e,t){var n=r(e,t);return i(n)?n:void 0}},9607:(e,t,n)=>{var i=n(2705),r=Object.prototype,o=r.hasOwnProperty,a=r.toString,s=i?i.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var i=!0}catch(e){}var r=a.call(e);return i&&(t?e[s]=n:delete e[s]),r}},9551:(e,t,n)=>{var i=n(4963),r=n(479),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),i(a(e),(function(t){return o.call(e,t)})))}:r;e.exports=s},4160:(e,t,n)=>{var i=n(8552),r=n(7071),o=n(3818),a=n(8525),s=n(577),u=n(4239),c=n(346),l="[object Map]",d="[object Promise]",h="[object Set]",f="[object WeakMap]",g="[object DataView]",v=c(i),p=c(r),m=c(o),y=c(a),k=c(s),b=u;(i&&b(new i(new ArrayBuffer(1)))!=g||r&&b(new r)!=l||o&&b(o.resolve())!=d||a&&b(new a)!=h||s&&b(new s)!=f)&&(b=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,i=n?c(n):"";if(i)switch(i){case v:return g;case p:return l;case m:return d;case y:return h;case k:return f}return t}),e.exports=b},7801:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},1789:(e,t,n)=>{var i=n(4536);e.exports=function(){this.__data__=i?i(null):{},this.size=0}},8792:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},7667:(e,t,n)=>{var i=n(4536),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(i){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return r.call(t,e)?t[e]:void 0}},1327:(e,t,n)=>{var i=n(4536),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return i?void 0!==t[e]:r.call(t,e)}},1866:(e,t,n)=>{var i=n(4536);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=i&&void 0===t?"__lodash_hash_undefined__":t,this}},5776:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var i=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==i||"symbol"!=i&&t.test(e))&&e>-1&&e%1==0&&e<n}},7019:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},5346:(e,t,n)=>{var i,r=n(4429),o=(i=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";e.exports=function(e){return!!o&&o in e}},5726:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},7040:e=>{e.exports=function(){this.__data__=[],this.size=0}},4125:(e,t,n)=>{var i=n(8470),r=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=i(t,e);return!(n<0)&&(n==t.length-1?t.pop():r.call(t,n,1),--this.size,!0)}},2117:(e,t,n)=>{var i=n(8470);e.exports=function(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]}},7518:(e,t,n)=>{var i=n(8470);e.exports=function(e){return i(this.__data__,e)>-1}},4705:(e,t,n)=>{var i=n(8470);e.exports=function(e,t){var n=this.__data__,r=i(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}},4785:(e,t,n)=>{var i=n(1989),r=n(8407),o=n(7071);e.exports=function(){this.size=0,this.__data__={hash:new i,map:new(o||r),string:new i}}},1285:(e,t,n)=>{var i=n(5050);e.exports=function(e){var t=i(this,e).delete(e);return this.size-=t?1:0,t}},6e3:(e,t,n)=>{var i=n(5050);e.exports=function(e){return i(this,e).get(e)}},9916:(e,t,n)=>{var i=n(5050);e.exports=function(e){return i(this,e).has(e)}},5265:(e,t,n)=>{var i=n(5050);e.exports=function(e,t){var n=i(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}},8776:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}},4536:(e,t,n)=>{var i=n(852)(Object,"create");e.exports=i},6916:(e,t,n)=>{var i=n(5569)(Object.keys,Object);e.exports=i},1167:(e,t,n)=>{e=n.nmd(e);var i=n(1957),r=t&&!t.nodeType&&t,o=r&&e&&!e.nodeType&&e,a=o&&o.exports===r&&i.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s},2333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5569:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},5639:(e,t,n)=>{var i=n(1957),r="object"==typeof self&&self&&self.Object===Object&&self,o=i||r||Function("return this")();e.exports=o},619:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},2385:e=>{e.exports=function(e){return this.__data__.has(e)}},1814:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},7465:(e,t,n)=>{var i=n(8407);e.exports=function(){this.__data__=new i,this.size=0}},3779:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},7599:e=>{e.exports=function(e){return this.__data__.get(e)}},4758:e=>{e.exports=function(e){return this.__data__.has(e)}},4309:(e,t,n)=>{var i=n(8407),r=n(7071),o=n(3369);e.exports=function(e,t){var n=this.__data__;if(n instanceof i){var a=n.__data__;if(!r||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(e,t),this.size=n.size,this}},346:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},7990:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},3279:(e,t,n)=>{var i=n(3218),r=n(7771),o=n(4841),a=Math.max,s=Math.min;e.exports=function(e,t,n){var u,c,l,d,h,f,g=0,v=!1,p=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=u,i=c;return u=c=void 0,g=t,d=e.apply(i,n)}function k(e){var n=e-f;return void 0===f||n>=t||n<0||p&&e-g>=l}function b(){var e=r();if(k(e))return w(e);h=setTimeout(b,function(e){var n=t-(e-f);return p?s(n,l-(e-g)):n}(e))}function w(e){return h=void 0,m&&u?y(e):(u=c=void 0,d)}function _(){var e=r(),n=k(e);if(u=arguments,c=this,f=e,n){if(void 0===h)return function(e){return g=e,h=setTimeout(b,t),v?y(e):d}(f);if(p)return clearTimeout(h),h=setTimeout(b,t),y(f)}return void 0===h&&(h=setTimeout(b,t)),d}return t=o(t)||0,i(n)&&(v=!!n.leading,l=(p="maxWait"in n)?a(o(n.maxWait)||0,t):l,m="trailing"in n?!!n.trailing:m),_.cancel=function(){void 0!==h&&clearTimeout(h),g=0,u=f=c=h=void 0},_.flush=function(){return void 0===h?d:w(r())},_}},7813:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},5694:(e,t,n)=>{var i=n(9454),r=n(7005),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,u=i(function(){return arguments}())?i:function(e){return r(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=u},1469:e=>{var t=Array.isArray;e.exports=t},8612:(e,t,n)=>{var i=n(3560),r=n(1780);e.exports=function(e){return null!=e&&r(e.length)&&!i(e)}},4144:(e,t,n)=>{e=n.nmd(e);var i=n(5639),r=n(5062),o=t&&!t.nodeType&&t,a=o&&e&&!e.nodeType&&e,s=a&&a.exports===o?i.Buffer:void 0,u=(s?s.isBuffer:void 0)||r;e.exports=u},8446:(e,t,n)=>{var i=n(939);e.exports=function(e,t){return i(e,t)}},3560:(e,t,n)=>{var i=n(4239),r=n(3218);e.exports=function(e){if(!r(e))return!1;var t=i(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1780:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},3218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},7005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},3448:(e,t,n)=>{var i=n(4239),r=n(7005);e.exports=function(e){return"symbol"==typeof e||r(e)&&"[object Symbol]"==i(e)}},6719:(e,t,n)=>{var i=n(8749),r=n(1717),o=n(1167),a=o&&o.isTypedArray,s=a?r(a):i;e.exports=s},3674:(e,t,n)=>{var i=n(4636),r=n(280),o=n(8612);e.exports=function(e){return o(e)?i(e):r(e)}},7771:(e,t,n)=>{var i=n(5639);e.exports=function(){return i.Date.now()}},479:e=>{e.exports=function(){return[]}},5062:e=>{e.exports=function(){return!1}},4841:(e,t,n)=>{var i=n(7561),r=n(3218),o=n(3448),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=s.test(e);return n||u.test(e)?c(e.slice(2),n?2:8):a.test(e)?NaN:+e}},7460:function(e,t){var n,i,r;
/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/i=[],n=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},n=!t.document&&!!t.postMessage,i=t.IS_PAPA_WORKER||!1,r={},o=0,a={parse:function(n,i){var s=(i=i||{}).dynamicTyping||!1;if(w(s)&&(i.dynamicTypingFunction=s,s={}),i.dynamicTyping=s,i.transform=!!w(i.transform)&&i.transform,i.worker&&a.WORKERS_SUPPORTED){var u=function(){if(!a.WORKERS_SUPPORTED)return!1;var n,i,s=(n=t.URL||t.webkitURL||null,i=e.toString(),a.BLOB_URL||(a.BLOB_URL=n.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",i,")();"],{type:"text/javascript"})))),u=new t.Worker(s);return u.onmessage=p,u.id=o++,r[u.id]=u}();return u.userStep=i.step,u.userChunk=i.chunk,u.userComplete=i.complete,u.userError=i.error,i.step=w(i.step),i.chunk=w(i.chunk),i.complete=w(i.complete),i.error=w(i.error),delete i.worker,void u.postMessage({input:n,config:i,workerId:u.id})}var f=null;return a.NODE_STREAM_INPUT,"string"==typeof n?(n=function(e){return 65279===e.charCodeAt(0)?e.slice(1):e}(n),f=i.download?new c(i):new d(i)):!0===n.readable&&w(n.read)&&w(n.on)?f=new h(i):(t.File&&n instanceof File||n instanceof Object)&&(f=new l(i)),f.stream(n)},unparse:function(e,t){var n=!1,i=!0,r=",",o="\r\n",s='"',u=s+s,c=!1,l=null,d=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(r=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(o=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(i=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");l=t.columns}void 0!==t.escapeChar&&(u=t.escapeChar+s),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(d=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var h=new RegExp(g(s),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,c);if("object"==typeof e[0])return f(l||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||l),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function f(e,t,n){var a="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var s=Array.isArray(e)&&0<e.length,u=!Array.isArray(t[0]);if(s&&i){for(var c=0;c<e.length;c++)0<c&&(a+=r),a+=v(e[c],c);0<t.length&&(a+=o)}for(var l=0;l<t.length;l++){var d=s?e.length:t[l].length,h=!1,f=s?0===Object.keys(t[l]).length:0===t[l].length;if(n&&!s&&(h="greedy"===n?""===t[l].join("").trim():1===t[l].length&&0===t[l][0].length),"greedy"===n&&s){for(var g=[],p=0;p<d;p++){var m=u?e[p]:p;g.push(t[l][m])}h=""===g.join("").trim()}if(!h){for(var y=0;y<d;y++){0<y&&!f&&(a+=r);var k=s&&u?e[y]:y;a+=v(t[l][k],y)}l<t.length-1&&(!n||0<d&&!f)&&(a+=o)}}return a}function v(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var i=!1;d&&"string"==typeof e&&d.test(e)&&(e="'"+e,i=!0);var o=e.toString().replace(h,u);return(i=i||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(o,a.BAD_DELIMITERS)||-1<o.indexOf(r)||" "===o.charAt(0)||" "===o.charAt(o.length-1))?s+o+s:o}}};if(a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!n&&!!t.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=v,a.ParserHandle=f,a.NetworkStreamer=c,a.FileStreamer=l,a.StringStreamer=d,a.ReadableStreamStreamer=h,t.jQuery){var s=t.jQuery;s.fn.parse=function(e){var n=e.config||{},i=[];return this.each((function(e){if("INPUT"!==s(this).prop("tagName").toUpperCase()||"file"!==s(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var r=0;r<this.files.length;r++)i.push({file:this.files[r],inputElem:this,instanceConfig:s.extend({},n)})})),r(),this;function r(){if(0!==i.length){var t,n,r,u,c=i[0];if(w(e.before)){var l=e.before(c.file,c.inputElem);if("object"==typeof l){if("abort"===l.action)return t="AbortError",n=c.file,r=c.inputElem,u=l.reason,void(w(e.error)&&e.error({name:t},n,r,u));if("skip"===l.action)return void o();"object"==typeof l.config&&(c.instanceConfig=s.extend(c.instanceConfig,l.config))}else if("skip"===l)return void o()}var d=c.instanceConfig.complete;c.instanceConfig.complete=function(e){w(d)&&d(e,c.file,c.inputElem),o()},a.parse(c.file,c.instanceConfig)}else w(e.complete)&&e.complete()}function o(){i.splice(0,1),r()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=k(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new f(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,n){if(this.isFirstChunk&&w(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(e);void 0!==r&&(e=r)}this.isFirstChunk=!1,this._halted=!1;var o=this._partialLine+e;this._partialLine="";var s=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var u=s.meta.cursor;this._finished||(this._partialLine=o.substring(u-this._baseIndex),this._baseIndex=u),s&&s.data&&(this._rowCount+=s.data.length);var c=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(i)t.postMessage({results:s,workerId:a.WORKER_ID,finished:c});else if(w(this._config.chunk)&&!n){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);s=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!c||!w(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),c||s&&s.meta.paused||this._nextChunk(),s}this._halted=!0},this._sendError=function(e){w(this._config.error)?this._config.error(e):i&&this._config.error&&t.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),u.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),n||(t.onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var i in e)t.setRequestHeader(i,e[i])}if(this._config.chunkSize){var r=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+r)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}n&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var n=t.statusText||e;this._sendError(new Error(n))}}function l(e){var t,n;(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),u.call(this,e);var i="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,i?((t=new FileReader).onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var r=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,r)}var o=t.readAsText(e,this._config.encoding);i||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function d(e){var t;u.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,n=this._config.chunkSize;return n?(e=t.substring(0,n),t=t.substring(n)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function h(e){u.call(this,e=e||{});var t=[],n=!0,i=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=b((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=b((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=b((function(){this._streamCleanUp(),i=!0,this._streamData("")}),this),this._streamCleanUp=b((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function f(e){var t,n,i,r=Math.pow(2,53),o=-r,s=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,u=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,c=this,l=0,d=0,h=!1,f=!1,p=[],m={data:[],errors:[],meta:{}};if(w(e.step)){var y=e.step;e.step=function(t){if(m=t,P())_();else{if(_(),0===m.data.length)return;l+=t.data.length,e.preview&&l>e.preview?n.abort():(m.data=m.data[0],y(m,c))}}}function b(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function _(){return m&&i&&(S("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),i=!1),e.skipEmptyLines&&(m.data=m.data.filter((function(e){return!b(e)}))),P()&&function(){if(m)if(Array.isArray(m.data[0])){for(var t=0;P()&&t<m.data.length;t++)m.data[t].forEach(n);m.data.splice(0,1)}else m.data.forEach(n);function n(t,n){w(e.transformHeader)&&(t=e.transformHeader(t,n)),p.push(t)}}(),function(){if(!m||!e.header&&!e.dynamicTyping&&!e.transform)return m;function t(t,n){var i,r=e.header?{}:[];for(i=0;i<t.length;i++){var o=i,a=t[i];e.header&&(o=i>=p.length?"__parsed_extra":p[i]),e.transform&&(a=e.transform(a,o)),a=A(o,a),"__parsed_extra"===o?(r[o]=r[o]||[],r[o].push(a)):r[o]=a}return e.header&&(i>p.length?S("FieldMismatch","TooManyFields","Too many fields: expected "+p.length+" fields but parsed "+i,d+n):i<p.length&&S("FieldMismatch","TooFewFields","Too few fields: expected "+p.length+" fields but parsed "+i,d+n)),r}var n=1;return!m.data.length||Array.isArray(m.data[0])?(m.data=m.data.map(t),n=m.data.length):m.data=t(m.data,0),e.header&&m.meta&&(m.meta.fields=p),d+=n,m}()}function P(){return e.header&&0===p.length}function A(t,n){return i=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[i]&&(e.dynamicTyping[i]=e.dynamicTypingFunction(i)),!0===(e.dynamicTyping[i]||e.dynamicTyping)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(function(e){if(s.test(e)){var t=parseFloat(e);if(o<t&&t<r)return!0}return!1}(n)?parseFloat(n):u.test(n)?new Date(n):""===n?null:n):n;var i}function S(e,t,n,i){var r={type:e,code:t,message:n};void 0!==i&&(r.row=i),m.errors.push(r)}this.parse=function(r,o,s){var u=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var n=new RegExp(g(t)+"([^]*?)"+g(t),"gm"),i=(e=e.replace(n,"")).split("\r"),r=e.split("\n"),o=1<r.length&&r[0].length<i[0].length;if(1===i.length||o)return"\n";for(var a=0,s=0;s<i.length;s++)"\n"===i[s][0]&&a++;return a>=i.length/2?"\r\n":"\r"}(r,u)),i=!1,e.delimiter)w(e.delimiter)&&(e.delimiter=e.delimiter(r),m.meta.delimiter=e.delimiter);else{var c=function(t,n,i,r,o){var s,u,c,l;o=o||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var d=0;d<o.length;d++){var h=o[d],f=0,g=0,p=0;c=void 0;for(var m=new v({comments:r,delimiter:h,newline:n,preview:10}).parse(t),y=0;y<m.data.length;y++)if(i&&b(m.data[y]))p++;else{var k=m.data[y].length;g+=k,void 0!==c?0<k&&(f+=Math.abs(k-c),c=k):c=k}0<m.data.length&&(g/=m.data.length-p),(void 0===u||f<=u)&&(void 0===l||l<g)&&1.99<g&&(u=f,s=h,l=g)}return{successful:!!(e.delimiter=s),bestDelimiter:s}}(r,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);c.successful?e.delimiter=c.bestDelimiter:(i=!0,e.delimiter=a.DefaultDelimiter),m.meta.delimiter=e.delimiter}var l=k(e);return e.preview&&e.header&&l.preview++,t=r,n=new v(l),m=n.parse(t,o,s),_(),h?{meta:{paused:!0}}:m||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,n.abort(),t=w(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){c.streamer._halted?(h=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return f},this.abort=function(){f=!0,n.abort(),m.meta.aborted=!0,w(e.complete)&&e.complete(m),t=""}}function g(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(e){var t,n=(e=e||{}).delimiter,i=e.newline,r=e.comments,o=e.step,s=e.preview,u=e.fastMode,c=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(c=e.escapeChar),("string"!=typeof n||-1<a.BAD_DELIMITERS.indexOf(n))&&(n=","),r===n)throw new Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<a.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==i&&"\r"!==i&&"\r\n"!==i&&(i="\n");var l=0,d=!1;this.parse=function(a,h,f){if("string"!=typeof a)throw new Error("Input must be a string");var v=a.length,p=n.length,m=i.length,y=r.length,k=w(o),b=[],_=[],P=[],A=l=0;if(!a)return K();if(e.header&&!h){var S=a.split(i)[0].split(n),x=[],C={},D=!1;for(var E in S){var I=S[E];w(e.transformHeader)&&(I=e.transformHeader(I,E));var R=I,T=C[I]||0;for(0<T&&(D=!0,R=I+"_"+T),C[I]=T+1;x.includes(R);)R=R+"_"+T;x.push(R)}if(D){var F=a.split(i);F[0]=x.join(n),a=F.join(i)}}if(u||!1!==u&&-1===a.indexOf(t)){for(var M=a.split(i),O=0;O<M.length;O++){if(P=M[O],l+=P.length,O!==M.length-1)l+=i.length;else if(f)return K();if(!r||P.substring(0,y)!==r){if(k){if(b=[],H(P.split(n)),$(),d)return K()}else H(P.split(n));if(s&&s<=O)return b=b.slice(0,s),K(!0)}}return K()}for(var L=a.indexOf(n,l),N=a.indexOf(i,l),V=new RegExp(g(c)+g(t),"g"),B=a.indexOf(t,l);;)if(a[l]!==t)if(r&&0===P.length&&a.substring(l,l+y)===r){if(-1===N)return K();l=N+m,N=a.indexOf(i,l),L=a.indexOf(n,l)}else if(-1!==L&&(L<N||-1===N))P.push(a.substring(l,L)),l=L+p,L=a.indexOf(n,l);else{if(-1===N)break;if(P.push(a.substring(l,N)),q(N+m),k&&($(),d))return K();if(s&&b.length>=s)return K(!0)}else for(B=l,l++;;){if(-1===(B=a.indexOf(t,B+1)))return f||_.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:l}),Y();if(B===v-1)return Y(a.substring(l,B).replace(V,t));if(t!==c||a[B+1]!==c){if(t===c||0===B||a[B-1]!==c){-1!==L&&L<B+1&&(L=a.indexOf(n,B+1)),-1!==N&&N<B+1&&(N=a.indexOf(i,B+1));var j=W(-1===N?L:Math.min(L,N));if(a.substr(B+1+j,p)===n){P.push(a.substring(l,B).replace(V,t)),a[l=B+1+j+p]!==t&&(B=a.indexOf(t,l)),L=a.indexOf(n,l),N=a.indexOf(i,l);break}var U=W(N);if(a.substring(B+1+U,B+1+U+m)===i){if(P.push(a.substring(l,B).replace(V,t)),q(B+1+U+m),L=a.indexOf(n,l),B=a.indexOf(t,l),k&&($(),d))return K();if(s&&b.length>=s)return K(!0);break}_.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:l}),B++}}else B++}return Y();function H(e){b.push(e),A=l}function W(e){var t=0;if(-1!==e){var n=a.substring(B+1,e);n&&""===n.trim()&&(t=n.length)}return t}function Y(e){return f||(void 0===e&&(e=a.substring(l)),P.push(e),l=v,H(P),k&&$()),K()}function q(e){l=e,H(P),P=[],N=a.indexOf(i,l)}function K(e){return{data:b,errors:_,meta:{delimiter:n,linebreak:i,aborted:d,truncated:!!e,cursor:A+(h||0)}}}function $(){o(K()),b=[],_=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return l}}function p(e){var t=e.data,n=r[t.workerId],i=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){i=!0,m(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(w(n.userStep)){for(var a=0;a<t.results.data.length&&(n.userStep({data:t.results.data[a],errors:t.results.errors,meta:t.results.meta},o),!i);a++);delete t.results}else w(n.userChunk)&&(n.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!i&&m(t.workerId,t.results)}function m(e,t){var n=r[e];w(n.userComplete)&&n.userComplete(t),n.terminate(),delete r[e]}function y(){throw new Error("Not implemented.")}function k(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var n in e)t[n]=k(e[n]);return t}function b(e,t){return function(){e.apply(t,arguments)}}function w(e){return"function"==typeof e}return i&&(t.onmessage=function(e){var n=e.data;if(void 0===a.WORKER_ID&&n&&(a.WORKER_ID=n.workerId),"string"==typeof n.input)t.postMessage({workerId:a.WORKER_ID,results:a.parse(n.input,n.config),finished:!0});else if(t.File&&n.input instanceof File||n.input instanceof Object){var i=a.parse(n.input,n.config);i&&t.postMessage({workerId:a.WORKER_ID,results:i,finished:!0})}}),(c.prototype=Object.create(u.prototype)).constructor=c,(l.prototype=Object.create(u.prototype)).constructor=l,(d.prototype=Object.create(d.prototype)).constructor=d,(h.prototype=Object.create(u.prototype)).constructor=h,a},void 0===(r="function"==typeof n?n.apply(t,i):n)||(e.exports=r)},1551:function(e){e.exports=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}var i=function(){function t(n,i){e(this,t),this.counter=0,this.modes={iframe:"iframe",popup:"popup"},this.standards={strict:"strict",loose:"loose",html5:"html5"};var r={mode:this.modes.iframe,standard:this.standards.html5,popHt:500,popWd:400,popX:200,popY:200,popTitle:"",popClose:!0,extraCss:"",extraHead:"",retainAttr:["id","class","style"]};this.settings=Object.assign({},r,i),this.idPrefix="printArea_",this.ele=1===n.nodeType?n:document.querySelector(n)}return n(t,[{key:"print",value:function(){var e=this;this.counter++;for(var t=document.querySelectorAll("[id^="+this.idPrefix+"]");t.length;)t[0].parentNode.removeChild(t[0]),t=document.querySelectorAll("[id^="+this.idPrefix+"]");this.settings.id=this.idPrefix+this.counter;var n=this.getPrintWindow();this.write(n.doc,this.ele),setTimeout((function(){e.windowPrint(n)}),1e3)}},{key:"windowPrint",value:function(e){var t=e.win;t.focus(),t.print(),this.settings.mode===this.modes.popup&&this.settings.popClose&&setTimeout((function(){t.close()}),1e3)}},{key:"write",value:function(e,t){e.open(),e.write(this.docType()+"<html>"+this.getHead()+this.getBody(t)+"</html>"),e.close()}},{key:"docType",value:function(){return this.settings.mode===this.modes.iframe?"":this.settings.standard===this.standards.html5?"<!DOCTYPE html>":'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01'+(this.settings.standard===this.standards.loose?" Transitional":"")+'//EN" "http://www.w3.org/TR/html4/'+(this.settings.standard===this.standards.loose?"loose":"strict")+'.dtd">'}},{key:"getHead",value:function(){var e="";this.settings.extraHead&&this.settings.extraHead.replace(/([^,]+)/g,(function(t){e+=t}));var t=document.querySelectorAll("link");return t=Array.from(t).filter((function(e){var t=e.getAttribute("rel");return t&&"stylesheet"===t.toLowerCase()})).filter((function(e){var t=e.getAttribute("media");return!t||"print"===t.toLowerCase()||"all"===t.toLowerCase()})).map((function(e){var t=e.getAttribute("href");return'<link type="text/css" rel="stylesheet" href="'.concat(t,'" >')})),this.settings.extraCss&&this.settings.extraCss.replace(/([^,\s]+)/g,(function(t){e+='<link type="text/css" rel="stylesheet" href="'+t+'">'})),"<head><title>"+this.settings.popTitle+"</title>"+e+t.join()+"</head>"}},{key:"getBody",value:function(e){var t="",n=this.settings.retainAttr,i=this.getFormData(e),r="";return n.forEach((function(e){var t=i.getAttribute(e);t&&(r+=(r.length>0?" ":"")+e+"='"+t+"'")})),"<body>"+(t+="<div "+r+">"+i.innerHTML+"</div>")+"</body>"}},{key:"getFormData",value:function(e){var t=e.cloneNode(!0),n=t.querySelectorAll("input,select,textarea");return Array.from(e.querySelectorAll("input,select,textarea")).forEach((function(e,t){var i=e.getAttribute("type");if(!i){var r=e.nodeName;i="SELECT"===r?"select":"TEXTAREA"===r?"textarea":""}var o=n[t];if("radio"===i||"checkbox"===i)o.removeAttribute("checked"),e.checked&&o.setAttribute("checked",!0);else if("text"===i||""===i)o.setAttribute("value",e.textContent);else if("select"===i){var a=e.querySelectorAll("option"),s=o.querySelectorAll("option");Array.from(a).forEach((function(e,t){s[t].removeAttribute("selected"),e.selected&&s[t].setAttribute("selected",!0)}))}else"textarea"===i&&(o.textContent=e.value)})),t}},{key:"getPrintWindow",value:function(){switch(this.settings.mode){case this.modes.iframe:var e=this.Iframe();return{win:e.contentWindow||e,doc:e.doc};case this.modes.popup:var t=this.Popup();return{win:t,doc:t.doc}}}},{key:"Iframe",value:function(){var e,t=this.settings.id,n="border:0;position:absolute;width:0px;height:0px;right:0px;top:0px;";try{e=document.createElement("iframe"),document.body.appendChild(e),e.setAttribute("style",n),e.setAttribute("id",t),e.setAttribute("src","#"+(new Date).getTime()),e.doc=null,e.doc=e.contentDocument?e.contentDocument:e.contentWindow?e.contentWindow.document:e.document}catch(e){throw e+". iframes may not be supported in this browser."}if(null==e.doc)throw"Cannot find document.";return e}},{key:"Popup",value:function(){var e="location=yes,statusbar=no,directories=no,menubar=no,titlebar=no,toolbar=no,dependent=no";e+=",width="+this.settings.popWd+",height="+this.settings.popHt,e+=",resizable=yes,screenX="+this.settings.popX+",screenY="+this.settings.popY+",personalbar=no,scrollbars=yes";var t=window.open("","_blank",e);return t.doc=t.document,t}}]),t}();return window.PrintArea=i,i}()},342:(e,t,n)=>{"use strict";n.d(t,{$j:()=>u,Ak:()=>d,YS:()=>l,dN:()=>s,kr:()=>o,si:()=>h});var i=n(3638),r=n(5171);function o(e){if("number"!=typeof e)throw new TypeError("Unexpected color value:"+e);if(e<0)return-1;var t=e.toString(16),n=6;for(e>16777215&&(n=8);t.length<n;)t="0"+t;return"#"+t}var a=Math.pow(2,24);function s(e){var t;return e<16777216?t=255:(t=e/a&255,e&=16777215),{r:e>>16&255,g:e>>8&255,b:255&e,a:t}}function u(e){var t,n,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HTML",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s="";if(e>4294967295)throw new Error("Incorrect color");switch("number"==typeof e&&(e=["int",e]),e[0]){case"int":t=(16711680&e[1])>>16,n=(65280&e[1])>>8,i=255&e[1];break;case"T":t=0,n=0,i=0,a=0;break;case"G":t=n=i=255*e[1];break;case"RGB":t=255*e[1],n=255*e[2],i=255*e[3];break;case"CMYK":t=(1-e[4])*(1-e[1])*255,n=(1-e[4])*(1-e[2])*255,i=(1-e[4])*(1-e[3])*255;break;case"r":t=+(r=e.match(/rgba?\((\d*),\s*(\d*),\s*(\d*),?\s*([\.0-9]*)?\)/))[1],n=+r[2],i=+r[3];var u=r[4];void 0!==u&&(a=+u);break;case"#":var c=4==e.length?/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/:/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/;r=e.match(c),t=parseInt(r[1],16),n=parseInt(r[2],16),i=parseInt(r[3],16);break;default:throw new Error("Unsupported color format")}switch(o){case"HTML":s=t===n&&n===i&&-1===i?"transparent":"rgba("+parseInt(t)+","+parseInt(n)+","+parseInt(i)+","+a+")";break;case"RGB":s=["RGB",t/255,n/255,i/255];break;case"#":s+=t<16?"#0"+t.toString(16):"#"+t.toString(16),s+=n<16?"0"+n.toString(16):n.toString(16),s+=i<16?"0"+i.toString(16):i.toString(16);break;case"int":s=0,s|=(a*=255)<<24,s|=t<<16,s|=n<<8,s|=i,s>>>=0;break;case"CMYK":var l=255-t,d=255-n,h=255-i;return["CMYK",l/255,d/255,h/255,Math.min(l,d,h)/255];case"GRAY":return["GRAY",(.3*t+.59*n+.11*i)/255]}return s}var c=4278190080;function l(e){switch(void 0===e?"undefined":(0,r._)(e)){case"number":if(e<=16777215)return c+e;if(e>16777215)return e;break;case"string":if((e=e.replace("#","").trim()).match(/^[0-9A-F]{8}$/i))return parseInt(e,16);if(e.match(/^[0-9A-F]{6}$/i))return c+parseInt(e,16);if(e.match(/^rgb\(\d{1,3}(,\d{1,3}){2}\)$/i)){var t=(0,i._)(e.split(/\D+/).map((function(e){return parseInt(e)})),4),n=t[1],o=t[2],a=t[3];return c+(n<<16)+(o<<8)+a}if(e.match(/^rgba\(\d{1,3}(,\d{1,3}){3}\)$/i)){var s=(0,i._)(e.split(/\D+/).map((function(e){return parseInt(e)})),5),u=s[1],l=s[2],d=s[3],h=s[4];return Math.floor(h*c)+(u<<16)+(l<<8)+d}}throw new Error('incorrect color format: "'.concat(e,'"'))}function d(e){return["RGB",((16711680&e)>>16)/255,((65280&e)>>8)/255,(255&e)/255]}function h(e){return 0===e?"transparent":u(16777215&e,"#")}},4157:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ApplicationContextImpl:()=>li,Aspect:()=>uo,BROWSER_DETECTION:()=>Vt,BasicIoCStrategy:()=>ei,BrowserInfo:()=>o,BuiltinIntersectionObserver:()=>ir,CLIPBOARD_DATA_TYPES:()=>so,Color:()=>co,DEVICE_DETACTION:()=>ae,DebounceAsyncTaskExecutor:()=>m,DebounceTaskExecutor:()=>pr,Defer:()=>Zo,DeviceInfo:()=>i,Disposable:()=>ai,EDITABLE_ELEMENT_SHORTCUTS:()=>Ai,ExecutionContext:()=>y,IOC_SHARED_SINGLETON:()=>rn,IOC_SINGLETON:()=>on,IoCScope:()=>nn,KEYBOARD_LOCATION:()=>L,KeyCodes:()=>ui,KeyboardImpl:()=>Ri,KeyboardUtils:()=>r,Lazy:()=>en,Log_Levels:()=>a,Logger:()=>On,LoggerFactory:()=>Kn,MODULE_LICENSE_INFO:()=>ho,NoLogger:()=>Ln,PrototypeIoCStrategy:()=>oi,Proxy:()=>I,QueuedAsyncTaskExecutor:()=>k,Reflect:()=>R,SHARED_STRATEGY:()=>ri,STANDARD_HTML_ELEMENTS:()=>fo,SYSTEM_DEFAULT_SHORTCUTS:()=>Pi,Shortcut:()=>_i,ShortcutContextImpl:()=>Ei,ShortcutEventApportunity:()=>xi,ShortcutEventImpl:()=>Ci,SingletonIoCStrategy:()=>ti,Store:()=>hi,ThrottleAsyncTaskExecutor:()=>w,ThrottleTaskStatus:()=>p,TrustedPointerEventInput:()=>na,ValueStore:()=>fi,Watcher:()=>wo,addClass:()=>cr,appOnly:()=>ji,assertThat:()=>an,attachContextMenuEvent:()=>rr,attachKeypressEvent:()=>Xe,browser:()=>u,checkHighContrast:()=>Po,colorConvertor:()=>_o.$j,config:()=>Rn,convertFromNumberToHex:()=>_o.kr,convertFromNumberToJSColor:()=>_o.Ak,convertFromNumberToRGBA:()=>_o.dN,copyText:()=>Xi,createClass:()=>sr,createClickEvent:()=>et,createDOM:()=>yo,createDeferred:()=>v,createFocusEvent:()=>tt,cssText:()=>fr,cursorIndex2Pos:()=>Xo,dayjs:()=>io,debounce:()=>mr,diffRender:()=>So,dom:()=>vo,doms:()=>po,dpr:()=>Yi,escapeXMLValue:()=>ma,eventPath:()=>Zi,excludeCommandInterceptor:()=>Fi,excludeEditableElementInterceptor:()=>Oi,extToMimeType:()=>Bi,extendOptions:()=>kr,focusNeedBeOn:()=>Ni,getCanvasPixelRatio:()=>er,getClientX:()=>Kt,getClientY:()=>$t,getClipboardData:()=>Qo,getCursorIndex:()=>Jo,getCursorPositionOfEditableElement:()=>Go,getDPI:()=>Ki,getKey:()=>Ue,getPtPxRatio:()=>$i,getPxPtRatio:()=>zi,getTransparentOrColor:()=>_o.si,getUniqueId:()=>O,includeCommandInterceptor:()=>Ti,interceptors:()=>s,invokeAddDestroyHook:()=>Zn,invokeAllInjected:()=>zn,invokeDestroy:()=>Jn,invokeInjected:()=>Gn,invokePullout:()=>Xn,is360:()=>Ft,isAliAppBrowser:()=>z,isAllSimilar:()=>An,isAlt:()=>De,isAltLeft:()=>Ee,isAltRight:()=>Ie,isAndroid:()=>Y,isBaidu:()=>Ct,isBlackBerry:()=>q,isChrome:()=>yt,isChromebook:()=>oe,isChromiumEdge:()=>mt,isCloseTo:()=>Pn,isCtrl:()=>_e,isCtrlLeft:()=>Pe,isCtrlRight:()=>Ae,isDefined:()=>vn,isDesktop:()=>Z,isDocument:()=>Wo,isEdge:()=>gt,isEditable:()=>_r,isEditableElement:()=>Mi,isElement:()=>Sr,isEnd:()=>Ve,isEnter:()=>Me,isFirefox:()=>wt,isFullscreen:()=>Ao,isFunction:()=>pn,isGecko:()=>bt,isHTMLElement:()=>Ho,isHome:()=>Ne,isHuawei:()=>te,isHuaweiBrowser:()=>Rt,isIE:()=>dt,isIE10:()=>ht,isIE10Compact:()=>Nt,isIE8:()=>Mt,isIE8Compact:()=>Ot,isIE9Compact:()=>Lt,isIEAtLeast11:()=>ft,isIOS:()=>j,isIOSChrome:()=>Tt,isIPAD:()=>H,isIPHONE:()=>U,isIPOD:()=>W,isInCloseRange:()=>kn,isInLeftCloseRange:()=>bn,isInOpenRange:()=>_n,isInRightCloseRange:()=>wn,isInteger:()=>cn,isKey:()=>je,isKindle:()=>$,isLazy:()=>Qn,isLiebao:()=>Et,isLinux:()=>ne,isMac:()=>B,isMacOS:()=>re,isMatch:()=>ke,isMaxthon:()=>_t,isMeta:()=>Re,isMetaLeft:()=>Te,isMetaRight:()=>Fe,isMiPad:()=>Q,isMiuiBrowser:()=>It,isMobile:()=>X,isNumber:()=>sn,isNumberInRange:()=>hn,isNumpadEnter:()=>Le,isOpera:()=>vt,isQQ:()=>At,isQuirksMode:()=>Pt,isRunningInBrowser:()=>nr,isRunningInWorker:()=>tr,isSafari:()=>kt,isSamePoint:()=>gn,isShift:()=>Se,isShiftLeft:()=>xe,isShiftPressedKey:()=>Ge,isShiftRight:()=>Ce,isSougou:()=>xt,isSpace:()=>Be,isSquaredNumber:()=>ln,isStandardEnter:()=>Oe,isString:()=>mn,isTablet:()=>J,isTeamsAndroid:()=>G,isTouchDevice:()=>N,isUC:()=>Dt,isValidNumber:()=>un,isValidRange:()=>yn,isValidRotationAngle:()=>dn,isWeChat:()=>St,isWebOS:()=>K,isWebkit:()=>pt,isWindowObject:()=>Ar,isWindows:()=>ie,isXiaomi:()=>ee,keyCodeToKey:()=>$e,keyboardStatus:()=>Ze,match:()=>ye,matchers:()=>we,mix:()=>ia,moduleType:()=>Oo,moveCursorOfContentEditable:()=>zo,moveCursorOfTextInput:()=>$o,moveCursorTo:()=>qo,moveCursorToEnd:()=>Yo,moveCursorToEndOfTextInput:()=>Ko,noop:()=>f,notImplemented:()=>Vn,observeResize:()=>xr,onTap:()=>Bt,preventDefaultInterceptor:()=>Li,preventFastClickByKeydown:()=>Yt,readFromClipboard:()=>ca,removeClass:()=>lr,replaceInvalidXMLCharacters:()=>pa,setAttrs:()=>gr,setLogLevel:()=>Fn,setThemeColor:()=>Vo,simulateKey:()=>Je,singletonCreator:()=>ur,standardColorAsARGBNumber:()=>_o.YS,stopPropagationOnShortcutEvent:()=>qt,strLogLevel2Num:()=>Tn,toggleClassByFlag:()=>dr,toggleLogOff:()=>Mn,unsupported:()=>Dr,useJQuery:()=>ao});var i={};n.r(i),n.d(i,{DEVICE_DETACTION:()=>ae,isAliAppBrowser:()=>z,isAndroid:()=>Y,isBlackBerry:()=>q,isChromebook:()=>oe,isDesktop:()=>Z,isHuawei:()=>te,isIOS:()=>j,isIPAD:()=>H,isIPHONE:()=>U,isIPOD:()=>W,isKindle:()=>$,isLinux:()=>ne,isMac:()=>B,isMacOS:()=>re,isMiPad:()=>Q,isMobile:()=>X,isTablet:()=>J,isTeamsAndroid:()=>G,isTouchDevice:()=>N,isWebOS:()=>K,isWindows:()=>ie,isXiaomi:()=>ee});var r={};n.r(r),n.d(r,{KEYBOARD_LOCATION:()=>L,getKey:()=>Ue,isAlt:()=>De,isAltLeft:()=>Ee,isAltRight:()=>Ie,isCtrl:()=>_e,isCtrlLeft:()=>Pe,isCtrlRight:()=>Ae,isEnd:()=>Ve,isEnter:()=>Me,isHome:()=>Ne,isKey:()=>je,isMatch:()=>ke,isMeta:()=>Re,isMetaLeft:()=>Te,isMetaRight:()=>Fe,isNumpadEnter:()=>Le,isShift:()=>Se,isShiftLeft:()=>xe,isShiftPressedKey:()=>Ge,isShiftRight:()=>Ce,isSpace:()=>Be,isStandardEnter:()=>Oe,keyCodeToKey:()=>$e,match:()=>ye,matchers:()=>we,simulateKey:()=>Je});var o={};n.r(o),n.d(o,{BROWSER_DETECTION:()=>Vt,is360:()=>Ft,isBaidu:()=>Ct,isChrome:()=>yt,isChromiumEdge:()=>mt,isEdge:()=>gt,isFirefox:()=>wt,isGecko:()=>bt,isHuaweiBrowser:()=>Rt,isIE:()=>dt,isIE10:()=>ht,isIE10Compact:()=>Nt,isIE8:()=>Mt,isIE8Compact:()=>Ot,isIE9Compact:()=>Lt,isIEAtLeast11:()=>ft,isIOSChrome:()=>Tt,isLiebao:()=>Et,isMaxthon:()=>_t,isMiuiBrowser:()=>It,isOpera:()=>vt,isQQ:()=>At,isQuirksMode:()=>Pt,isSafari:()=>kt,isSougou:()=>xt,isUC:()=>Dt,isWeChat:()=>St,isWebkit:()=>pt});var a={};n.r(a),n.d(a,{LEVEL_DEBUG:()=>xn,LEVEL_ERROR:()=>En,LEVEL_INFO:()=>Cn,LEVEL_WARN:()=>Dn});var s={};n.r(s),n.d(s,{excludeCommandInterceptor:()=>Fi,excludeEditableElementInterceptor:()=>Oi,focusNeedBeOn:()=>Ni,includeCommandInterceptor:()=>Ti,preventDefaultInterceptor:()=>Li});var u={};n.r(u),n.d(u,{copyText:()=>Xi,dpr:()=>Yi,eventPath:()=>Zi,getCanvasPixelRatio:()=>er,getDPI:()=>Ki,getPtPxRatio:()=>$i,getPxPtRatio:()=>zi,isRunningInBrowser:()=>nr,isRunningInWorker:()=>tr});var c=n(4375),l=n(6721),d=n(7327),h=n(6699);function f(){}var g=n(5136);function v(){return new function e(){var t=this;(0,c._)(this,e),(0,g._)(this,"promise",void 0),(0,g._)(this,"resolve",void 0),(0,g._)(this,"reject",void 0),(0,g._)(this,"isSettled",!1),this.promise=new Promise((function(e,n){t.resolve=function(n){t.isSettled=!0,e(n)},t.reject=function(e){t.isSettled=!0,n(e)}}))}}var p,m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,c._)(this,e),this.lastTaskPromise=Promise.resolve(),this.interval=t,this.pending=!1,this.leading=n,this.flag=0,this.cancelLast=f,this.currentTaskFn=f}return(0,l._)(e,[{key:"invokeTask",value:function(e){var t=this,n=e();return(0,d._)(n,Promise)?n.finally((function(){t.pending=!1})):(this.pending=!1,Promise.resolve(n))}},{key:"exec",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.flag++,this.currentTaskFn=(t=e).bind.apply(t,[r].concat((0,h._)(i)));var o=this.currentTaskFn;if(this.pending)return this.lastTaskPromise;this.leading&&(this.lastTaskPromise=this.lastTaskPromise.finally((function(){return o()})),this.currentTaskFn=f);var a=v(),s=function(){n.pending=!0,n.lastTaskPromise=n.lastTaskPromise.finally((function(){var e=setTimeout((function(){if(n.flag>0)n.flag=0,clearTimeout(e),s();else{var t=n.currentTaskFn();(0,d._)(t,Promise)?t=t.finally((function(){n.pending=!1})):n.pending=!1,a.resolve(t)}}),n.interval)}))};return s(),a.promise}},{key:"waitForLastTask",value:function(e){return this.lastTaskPromise||Promise.resolve(e)}},{key:"cancel",value:function(){this.currentTaskFn=f}},{key:"destroy",value:function(){this.cancel()}}]),e}(),y=function(){function e(t){(0,c._)(this,e),(0,g._)(this,"task",void 0),(0,g._)(this,"cancelled",void 0),(0,g._)(this,"defer",void 0),this.task=t,this.cancelled=!1,this.defer=v()}return(0,l._)(e,[{key:"cancel",value:function(){this.defer.resolve(),this.cancelled=!0}},{key:"isCancelled",value:function(){return this.cancelled}},{key:"promise",get:function(){return this.defer.promise}},{key:"reject",value:function(e){this.defer.reject(e)}},{key:"resolve",value:function(e){this.defer.resolve(e)}}]),e}(),k=function(){function e(){(0,c._)(this,e),(0,g._)(this,"executing",void 0),(0,g._)(this,"insertions",[]),(0,g._)(this,"executions",[]),(0,g._)(this,"isRunning",!1)}return(0,l._)(e,[{key:"notifyExecute",value:function(){var e=this;if(!this.isRunning){this.isRunning=!0;var t=function(){var n,i=e.getAndPopNextExecution();if(i){var r=null===(n=e.executing)||void 0===n?void 0:n.promise,o=function(){if(e.executing=i,i.isCancelled())t();else{var n=i.task;Promise.resolve(function(){try{return n()}catch(e){return Promise.reject(e)}}()).then((function(e){i.resolve(e)}),(function(e){i.reject(e)})).finally((function(){t()}))}};r?r.then(o,o):o()}else e.isRunning=!1};t()}}},{key:"execTasks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0===e.length)return this.waitForCurrentRunningTasks();var n,i,r=e.map((function(e){return new y(b(e))}));t?(n=this.executions).unshift.apply(n,(0,h._)(r)):(i=this.executions).push.apply(i,(0,h._)(r));var o=r[r.length-1].promise;return this.notifyExecute(),o}},{key:"execInverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;return this.exec(e,t,n,!0)}},{key:"exec",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=("number"==typeof n?Array(n).fill(0).map((function(e,t){return[t]})):n).map((function(n){return(t=e).bind.apply(t,[i].concat((0,h._)(n)))}));return this.execTasks(o,r)}},{key:"insert",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i,r=t.map(b).map((function(e){return new y(e)}));(i=this.insertions).push.apply(i,(0,h._)(r));var o=Promise.all(r.map((function(e){return e.promise})));return this.notifyExecute(),o}},{key:"resume",value:function(){}},{key:"cancel",value:function(){var e;this.insertions.forEach((function(e){e.cancel()})),this.executions.forEach((function(e){e.cancel()})),null===(e=this.executing)||void 0===e||e.cancel()}},{key:"waitForCurrentRunningTasks",value:function(){var e=this.insertions.concat(this.executions);return this.executing&&e.push(this.executing),Promise.all(e.map((function(e){return e.promise})))}},{key:"waitUntilQuiet",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return new Promise((function(n){var i=function(){setTimeout((function(){e.executions.length>0?i():n(e.waitForCurrentRunningTasks())}),t)};i()}))}},{key:"getRunningTaskCount",value:function(){return this.executions.filter((function(e){return!e.isCancelled()})).length}},{key:"getAndPopNextExecution",value:function(){var e;return this.insertions.length>0?(e=this.insertions[0],this.insertions.shift()):this.executions.length>0&&(e=this.executions[0],this.executions.shift()),e}}]),e}();function b(e){return"function"==typeof e?e:e.context?Array.isArray(e.args)?(t=e.task).bind.apply(t,[e.context].concat((0,h._)(e.args))):e.task.bind(e.context):e.task;var t}!function(e){e.IDLE="idle",e.RUNNING="running",e.CANCELLED="cancelled"}(p||(p={}));var w=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,c._)(this,e),(0,g._)(this,"interval",void 0),(0,g._)(this,"retainLastTask",void 0),(0,g._)(this,"status",void 0),(0,g._)(this,"lastCompleteTime",void 0),(0,g._)(this,"lastTaskPromise",void 0),(0,g._)(this,"retainTaskTimmerId",void 0),this.interval=t,this.retainLastTask=n,this.status="idle",this.lastCompleteTime=0,this.lastTaskPromise=Promise.resolve()}return(0,l._)(e,[{key:"exec",value:function(e,t,n){var i=this,r=function(){if("cancelled"!==i.status){i.status="running";var r=e.apply(n,t||[])||Promise.resolve();i.lastTaskPromise=r.finally((function(){i.lastCompleteTime=Date.now(),"cancelled"!==i.status&&(i.status="idle")}))}else i.status="idle"},o=Date.now();if("idle"===this.status)if(o-this.lastCompleteTime>=this.interval){var a=function(){return r(),i.lastTaskPromise};return this.lastTaskPromise.then(a,a)}return this.retainLastTask?new Promise((function(e){clearTimeout(i.retainTaskTimmerId);var t=i.interval-(Date.now()-i.lastCompleteTime)%i.interval;i.retainTaskTimmerId=setTimeout((function(){r(),e(i.lastTaskPromise)}),t)})):this.lastTaskPromise}},{key:"waitForLastTask",value:function(){return this.lastTaskPromise}},{key:"cancel",value:function(){this.status="cancelled"}},{key:"isRunning",value:function(){return"running"===this.status}}]),e}(),_=n(6147),P=n(216);Object.getOwnPropertyDescriptors||(Object.getOwnPropertyDescriptors=function(e){return Object.getOwnPropertyNames(e).reduce((function(t,n){return t[n]=Object.getOwnPropertyDescriptor(e,n),t}),{})});var A=["isProxy","constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","apply","arguments","bind","call","caller",Symbol.hasInstance,"valueOf","__defineGetter__","__defineSetter__","__lookupGetter__","__lookupSetter__"],S=["toSource","watch","unwatch"];function x(e,t){try{delete e[t]}catch(n){e[t]=void 0}}var C=A.concat(["length","name","prototype"]),D="origin",E="$proxy_class_symbol_"+Date.now().toString(32),I=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,null,[{key:"getNoopConstructor",value:function(e){function t(){}return t.prototype=Object.create(e.prototype),t}},{key:"getProxyClass",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return!0};if(r){n=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(e){var i;return(0,c._)(this,n),(i=t.call(this))[D]=e,i}return n}(this.getNoopConstructor(e)),n[E]=!0}else{n=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return n}("function"==typeof i?i:this.getNoopConstructor(e));var a=this.getStaticDescriptors(e);Object.defineProperties(n,a),n[E]=!0}var s=this.getClassDescriptors(e.prototype);if("function"==typeof t){var u=function(e){var n=s[e];if(!n||!o(e,n))return"continue";if("function"==typeof n.value){var i=n.value;n.value=r?function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.call(this,this[D],i,r,e,"method")}:function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.call(this,this,i,r,e,"method")}}if("function"==typeof n.get){var a=n.get;n.get=r?function(){return a.call(this[D])}:function(){return t.call(this,this,null,[],e,"getter")}}if("function"==typeof n.set){var u=n.set;n.set=r?function(e){u.call(this[D],e)}:function(n){return t.call(this,this,null,[n],e,"setter")}}};for(var l in s)u(l)}return Object.defineProperties(n.prototype,s),n}},{key:"isProxyClass",value:function(e){return"function"==typeof e&&e.hasOwnProperty(E)}},{key:"getProxyObject",value:function(e,t,n){if(null==e)throw new Error("Cannot proxy a null or undefined object");var i=e.constructor;return new(this.getProxyClass(i,t,i,!0,n))(e)}},{key:"getStaticDescriptors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C,n=function e(t){if(t===Object||t===Function||!t)return{};var n=Object.getPrototypeOf(t),i=e(n);return Object.assign(i,Object.getOwnPropertyDescriptors(t))}(e);return t.forEach((function(e){x(n,e)})),S.forEach((function(t){e[t]===Function.prototype[t]&&x(n,t)})),n}},{key:"getClassDescriptors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A,n=function e(t){if("object"!=typeof t||null===t)return{};var n=Object.getPrototypeOf(t),i=n===t?{}:e(n);return Object.assign(i,Object.getOwnPropertyDescriptors(t))}(e);return t.forEach((function(e){x(n,e)})),S.forEach((function(t){e[t]===Object.prototype[t]&&x(n,t)})),n}}]),e}();var R=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,null,[{key:"isSubClassOf",value:function(e,t){return"function"==typeof e&&"function"==typeof t&&(0,d._)(e.prototype,t)}},{key:"isOverrided",value:function(e,t,n){for(var i=t.prototype;;){var r=i.constructor;if(!r||r===e||r===Object)return!1;if(Object.prototype.hasOwnProperty.call(i,n))return!I.isProxyClass(r);i=Object.getPrototypeOf(i)}}},{key:"mixin",value:function(e,t){var n=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return n}(e),i=I.getStaticDescriptors(t);Object.defineProperties(n,i);var r=I.getClassDescriptors(t.prototype);return n.prototype=Object.create(n.prototype,r),n}}]),e}();var T=n(5171),F="unique_"+Date.now(),M=0;const O=function(e){return[e||"",F,M++].join("_")};var L,N=function(){if("undefined"==typeof window)return!1;var e=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||navigator.maxTouchPoints||window.DocumentTouch&&(0,d._)(document,DocumentTouch))||function(e){return!!window.matchMedia&&window.matchMedia(e).matches}(["(",e.join("touch-enabled),("),"heartz",")"].join(""))}(),V=navigator.userAgent.toLowerCase(),B=/macintosh|mac os x/.test(V),j=/ipad|iphone|ipod/.test(V),U=/iphone/.test(V),H=/ipad/.test(V),W=/ipod/.test(V),Y=/android/.test(V),q=/blackberry/.test(V),K=/webos/.test(V),$=/silk|kindle/.test(V),z=/aliapp/.test(V),G=/teamsmobile-android/.test(V),J=!z&&/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(V),X=(!J||G)&&(/mobile/.test(V)||j||Y||q||K||$),Z=!(X||J||Y||U||H||W||$||K),Q=/(MI(.*|\s*)PAD).*/i.test(V),ee=!Q&&/MI(\s+|\d+?|HM|xiaomi).*/i.test(V),te=/HUAWEI/i.test(navigator.userAgent),ne=/Linux/i.test(V),ie=!ne&&/Windows(\s+NT)?/i.test(V),re=/MacIntosh|(mac os)/i.test(V),oe=/(cros\s|chromebook)/i.test(V),ae={mac:B,ios:j,iphone:U,ipad:H,ipod:W,android:Y,blackberry:q,webos:K,kindle:$,tablet:J,mobile:X,desktop:Z,xiaomi:ee,huawei:te,touch:N,linux:ne,windows:ie,macos:re,chromebook:oe},se=1,ue=2,ce=3,le=0;!function(e){e[e.LEFT=KeyboardEvent.DOM_KEY_LOCATION_LEFT]="LEFT",e[e.RIGHT=KeyboardEvent.DOM_KEY_LOCATION_RIGHT]="RIGHT",e[e.STANDARD=KeyboardEvent.DOM_KEY_LOCATION_STANDARD]="STANDARD",e[e.NUMPAD=KeyboardEvent.DOM_KEY_LOCATION_NUMPAD]="NUMPAD"}(L||(L={}));var de=function(){function e(t){(0,c._)(this,e),(0,g._)(this,"isMatch",void 0),this.isMatch=t}return(0,l._)(e,[{key:"match",value:function(){return this.isMatch}}]),e}(),he=function(){function e(t){(0,c._)(this,e),(0,g._)(this,"keys",void 0),this.keys=t}return(0,l._)(e,[{key:"match",value:function(e){return this.keys.some((function(t){return"string"==typeof t?je(e,t):"boolean"==typeof t?t:t.match(e)}))}}]),e}(),fe=function(){function e(t){(0,c._)(this,e),(0,g._)(this,"callback",void 0),this.callback=t}return(0,l._)(e,[{key:"match",value:function(e){return this.callback(e)}}]),e}(),ge=function(){function e(t){(0,c._)(this,e),(0,g._)(this,"keys",void 0),this.keys=t}return(0,l._)(e,[{key:"match",value:function(e){return this.keys.every((function(t){return"string"==typeof t?je(e,t):"boolean"==typeof t?t:t.match(e)}))}}]),e}(),ve=function(){function e(t){(0,c._)(this,e),(0,g._)(this,"key",void 0),this.key=t}return(0,l._)(e,[{key:"match",value:function(e){return je(e,this.key)}}]),e}();KeyboardEvent.prototype.getModifierState||(KeyboardEvent.prototype.getModifierState=function(e){switch(e){case"Control":return this.ctrlKey;case"Shift":return this.shiftKey;case"Alt":return this.altKey;case"Meta":return this.metaKey}return!1});var pe=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,c._)(this,e),(0,g._)(this,"event",void 0),(0,g._)(this,"detectors",void 0),(0,g._)(this,"interrupted",void 0),this.event=t,this.detectors=n,this.interrupted=!1}return(0,l._)(e,[{key:"switchers",value:function(e){return this.ctrl(e).shift(e).meta(e).alt(e)}},{key:"ctrl",value:function(e){var t=this;return ze(e)?this.detectors.control=function(){return t.event.getModifierState("Control")===e}:delete this.detectors.control,this}},{key:"filter",value:function(e){var t=this;return"function"==typeof e&&(this.detectors[O("filter")]=function(){return e.call(t,t.event)}),this}},{key:"shift",value:function(e){var t=this;return ze(e)?this.detectors.shift=function(){return t.event.getModifierState("Shift")===e}:delete this.detectors.shift,this}},{key:"capsLock",value:function(e){var t=this;return ze(e)?this.detectors.capsLock=function(){return t.event.getModifierState("CapsLock")===e}:delete this.detectors.capsLock,this}},{key:"meta",value:function(e){var t=this;return ze(e)?this.detectors.meta=function(){return t.event.metaKey===e}:delete this.detectors.meta,this}},{key:"alt",value:function(e){var t=this;return ze(e)?this.detectors.alt=function(){return t.event.getModifierState("Alt")===e}:delete this.detectors.alt,this}},{key:"mod",value:function(e){return B?this.meta(e):this.ctrl(e)}},{key:"location",value:function(e){var t=this;return this.detectors.location=function(){return We(t.event)===e},this}},{key:"standard",value:function(){return this.location(L.STANDARD)}},{key:"numpad",value:function(){return this.location(L.NUMPAD)}},{key:"left",value:function(){return this.location(L.LEFT)}},{key:"right",value:function(){return this.location(L.RIGHT)}},{key:"run",value:function(e){this.passed()&&(!1===e(this.event)&&(this.interrupted=!0));return this.clone()}},{key:"key",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=new he(n.map((function(e){switch(void 0===e?"undefined":(0,T._)(e)){case"string":return we.key(e);case"boolean":return new de(e)}return e})));return this.detectors.keys=function(){return r.match(e.event)},this}},{key:"when",value:function(e,t){var n;return Array.isArray(e)?(n=this.clone()).key.apply(n,(0,h._)(e)).run(t):this.clone().key(e).run(t)}},{key:"clone",value:function(){return this.interrupted?new me(this.event,{}):new e(this.event,Object.assign({},this.detectors))}},{key:"passed",value:function(){return!this.interrupted&&!Object.values(this.detectors).some((function(e){return!e()}))}}]),e}(),me=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return(0,l._)(n,[{key:"switchers",value:function(){return this}},{key:"ctrl",value:function(){return this}},{key:"shift",value:function(){return this}},{key:"capsLock",value:function(){return this}},{key:"meta",value:function(){return this}},{key:"alt",value:function(){return this}},{key:"location",value:function(){return this}},{key:"standard",value:function(){return this}},{key:"numpad",value:function(){return this}},{key:"left",value:function(){return this}},{key:"right",value:function(){return this}},{key:"run",value:function(){return this}},{key:"key",value:function(){return this}},{key:"when",value:function(){return this}}]),n}(pe);function ye(e){return new pe(e)}function ke(e,t){var n=new pe(e),i=!1;return n.when(t,(function(){i=!0})),i}var be=function(e){return new ve(e)},we={or:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new he(t)},key:be,and:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new ge(t)},Space:new fe(Be),Home:new fe(Ne),End:new fe(Ve),Enter:new fe(Me),StandardEnter:new fe(Oe),NumpadEnter:new fe(Le),Tab:be("Tab"),CapsLock:be("CapsLock"),PageUp:be("PageUp"),PageDown:be("PageDown"),ArrowUp:be("ArrowUp"),ArrowDown:be("ArrowDown"),ArrowLeft:be("ArrowLeft"),ArrowRight:be("ArrowRight"),BackSpace:be("Backspace"),Delete:be("Delete"),Escape:be("Escape"),F1:be("F1"),F2:be("F2"),F3:be("F3"),F4:be("F4"),F5:be("F5"),F6:be("F6"),F7:be("F7"),F8:be("F8"),F9:be("F9"),F10:be("F10"),F11:be("F11"),F12:be("F12")};function _e(e){return Pe(e)||Ae(e)}function Pe(e){return He(e,"Control",se)}function Ae(e){return He(e,"Control",ue)}function Se(e){return xe(e)||Ce(e)}function xe(e){return He(e,"Shift",se)}function Ce(e){return He(e,"Shift",ue)}function De(e){return Ee(e)||Ie(e)}function Ee(e){return He(e,"Alt",se)}function Ie(e){return He(e,"Alt",ue)}function Re(e){return Te(e)||Fe(e)}function Te(e){return He(e,"Meta",se)}function Fe(e){return He(e,"Meta",ue)}function Me(e){return Oe(e)||Le(e)}function Oe(e){return He(e,"Enter",le)}function Le(e){return He(e,"Enter",ce)}function Ne(e){return He(e,"Home",le)}function Ve(e){return He(e,"End",le)}function Be(e){return je(e," ")}function je(e,t){return Ue(e)===t}function Ue(e){return Ye(e)?e.key:$e(e.keyCode,e.shiftKey)}function He(e,t,n){if(void 0!==n&&We(e)!==n)return!1;var i=e.key;return Ye(e)||(i=$e(e.keyCode,e.shiftKey)),i===t}function We(e){return void 0===e.location?e.keyLocation:e.location}function Ye(e){return void 0!==e.key}var qe={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",189:"_",187:"+",219:"{",220:"|",221:"}",186:":",222:'"',188:"<",190:">",191:"?",192:"~"},Ke={192:"`",191:"/",190:".",189:"-",188:",",220:"\\",222:"'",186:";",221:"]",219:"[",187:"=",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",27:"Escape",9:"Tab",20:"CapsLock",16:"Shift",17:"Control",91:"Meta",18:"Alt",32:" ",33:"PageUp",34:"PageDown",38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",13:"Enter",8:"Backspace",46:"Delete",45:"Insert",35:"End",36:"Home",144:"NumLock",111:"/",106:"*",109:"-",107:"+",110:".",96:0,97:1,98:2,99:3,100:4,101:5,102:6,103:7,104:8,105:9};function $e(e,t){if(e>=65&&e<=90){var n=String.fromCharCode(e);return t?n.toUpperCase():n}return e>=48&&e<=57?t?qe[e]:String.fromCharCode(e):t?qe[e]:Ke[e]}function ze(e){return"boolean"==typeof e}function Ge(e){return"string"==typeof qe[e.keyCode]&&e.shiftKey}function Je(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1},r=i.ctrlKey,o=i.shiftKey,a=i.altKey,s=i.metaKey,u=document.createEvent("KeyboardEvent");(u.initKeyboardEvent?u.initKeyboardEvent:u.initEvent).call(u,t,!0,!0,window,r,a,o,s,n,n,0),e.dispatchEvent(u)}function Xe(e,t,n,i){var r=!1,o=function(e){!r&&ke(e,n)&&(r=!0)},a=function(e){r&&ke(e,n)&&(r=!1,t(e))},s=function(e){((0,d._)(e,FocusEvent)||ke(e,n))&&(r=!1)};return e.addEventListener("keydown",o,i),e.addEventListener("keyup",a,i),document.addEventListener("keyup",s),window.addEventListener("blur",s),function(){e.removeEventListener("keydown",o,i),e.removeEventListener("keyup",a,i),document.removeEventListener("keyup",s),window.removeEventListener("blur",s)}}var Ze=new(function(){function e(){(0,c._)(this,e),this._ctrl=!1,this._shift=!1,this._win=!1,this._alt=!1,this._capsLock=!1,this._bindEvent()}return(0,l._)(e,[{key:"_bindEvent",value:function(){var e=this;window.addEventListener("keydown",(function(t){e._ctrl=t.ctrlKey,e._shift=t.shiftKey,e._alt=t.altKey,e._win=t.metaKey,e._capsLock=!!t.getModifierState&&t.getModifierState("CapsLock")}),!1),window.addEventListener("keyup",(function(t){e._shift=16!==t.keyCode&&e._shift,e._alt=18!==t.keyCode&&e._alt,e._ctrl=17!==t.keyCode&&e._ctrl,e._win=91!==t.keyCode&&e._win,e._capsLock=20!==t.keyCode&&e._capsLock}),!1),window.addEventListener("mousemove",(function(t){e._ctrl=t.ctrlKey,e._shift=t.shiftKey,e._alt=t.altKey,e._win=t.metaKey,e._capsLock=!!t.getModifierState&&t.getModifierState("CapsLock")}),{capture:!0}),window.addEventListener("wheel",(function(t){e._ctrl=t.ctrlKey,e._shift=t.shiftKey,e._alt=t.altKey,e._win=t.metaKey,e._capsLock=!!t.getModifierState&&t.getModifierState("CapsLock")}),{capture:!0})}},{key:"isCtrl",get:function(){return this._ctrl}},{key:"isCtrlDown",get:function(){return this._ctrl}},{key:"isShift",get:function(){return this._shift}},{key:"isShiftDown",get:function(){return this._shift}},{key:"isWin",get:function(){return this._win}},{key:"isWinDown",get:function(){return this._win}},{key:"isAlt",get:function(){return this._alt}},{key:"isAltDown",get:function(){return this._alt}},{key:"isCapsLock",get:function(){return this._capsLock}}]),e}());const Qe=Ze;function et(e){var t=document.createEvent("MouseEvent"),n=(0,d._)(e,MouseEvent)?e:{screenX:0,screenY:0,clientX:0,clientY:0,button:0,relatedTarget:null},i=n.screenX,r=n.screenY,o=n.clientX,a=n.clientY,s=n.button,u=n.relatedTarget;return t.initMouseEvent("click",(null==e?void 0:e.bubbles)||!1,(null==e?void 0:e.cancelable)||!1,window,(null==e?void 0:e.detail)||-1,i,r,o,a,(null==e?void 0:e.ctrlKey)||Qe.isCtrl,(null==e?void 0:e.altKey)||Qe.isAlt,(null==e?void 0:e.shiftKey)||Qe.isShift,(null==e?void 0:e.metaKey)||Qe.isWin,s||0,u),t.isFake=!0,Object.defineProperties(t,{srcElement:{get:function(){return null==e?void 0:e.srcElement}},fromElement:{get:function(){return null==e?void 0:e.fromElement}},target:{get:function(){return null==e?void 0:e.target}},toElement:{get:function(){return null==e?void 0:e.toElement}}}),t}function tt(e){var t=document.createEvent("FocusEvent");return t.initEvent("focus",!0,!1),Object.defineProperties(t,{target:{get:function(){return e}}}),t}var nt=navigator.userAgent.toLowerCase(),it=/opera|opr/.test(nt),rt=/msie/.test(nt),ot=/trident/.test(nt),at=/\sapplewebkit\//.test(nt),st=/chrome/.test(nt),ut=/safari/.test(nt),ct=/firefox/.test(nt),lt=/edg\//.test(nt),dt=(ot||rt)&&!it&&"msSaveBlob"in navigator,ht=dt&&function(){var e=nt.match(/msie ([\d\.]+)/);return!!e&&10===parseInt(e[1])}(),ft=!rt&&ot&&!it,gt=nt.indexOf("edge")>-1,vt=it,pt=at,mt=!vt&&st&&!!window.chrome&&lt,yt=/crios/.test(nt)||!vt&&st&&!!window.chrome&&!lt,kt=!/huawei/.test(nt)&&!vt&&ut&&!st,bt="Gecko"==navigator.product&&!pt&&!vt,wt=!yt&&!vt&&!kt&&ct,_t=/maxthon/.test(nt),Pt="BackCompact"==document.CompactMode,At=/tencenttraveler/.test(nt)||/qqbrowser/.test(nt),St=/wechat/.test(nt),xt=/metasr/.test(nt)||/sogou/.test(nt),Ct=/baidubrowser/.test(nt),Dt=/ucbrowser/.test(nt),Et=/liebao/.test(nt),It=/miuibrowser/.test(nt),Rt=/huaweibrowser/.test(nt)||/huaweialp/.test(nt),Tt=/crios/.test(nt),Ft=function(){if(At||Dt||xt||It||Et||_t)return!1;if(-1===nt.indexOf("chrome"))return!1;var e=function(e,t){var n=navigator.mimeTypes;for(var i in n)if(n[i][e]==t)return!0;return!1}("type","application/vnd.chromium.remoting-viewer");return!window.chrome||e}(),Mt=!!document.documentMode&&document.documentMode<8,Ot=8==document.documentMode,Lt=9==document.documentMode,Nt=10==document.documentMode,Vt={ie:dt,ieAtLeast11:ft,edge:gt,"chromium-edge":mt,opera:vt,webkit:pt,chrome:yt,safari:kt,gecko:bt,firefox:wt,maxthon:_t,quirksMode:Pt,"quirks-mode":Pt,qq:At,wechat:St,sougou:xt,baidu:Ct,liebao:Et,uc:Dt,miui:It,huawei:Rt,360:Ft};function Bt(e){var t=e.target,n=e.onDoubleTap,i=e.onSingleTap,r=e.interval,o=void 0===r?300:r,a=e.preventDefault,s=void 0!==a&&a,u=e.stopPropagation,c=void 0!==u&&u;(0,d._)(t,HTMLElement)&&(t.style.cssText+="\n                    touch-action: none;\n                ");var l=0,h=null;function f(e){l=Date.now(),h=[e.clientX,e.clientY]}t.addEventListener("pointerdown",f);var g,v=0,p=0,m=0;function y(e){if(l=Date.now()-l,clearTimeout(g),"function"==typeof s?s(e)&&e.preventDefault():s&&e.preventDefault(),"function"==typeof c?c(e)&&e.stopPropagation():c&&e.stopPropagation(),0===m)if(1===v){v=0;var r=Date.now();r-p<=o&&(n.call(t,jt(e,o)),p=0),p=r}else p=Date.now(),v=1,new Promise((function(e){g=setTimeout(e,o)})).then((function(){(v=0,p=0,i&&l<o&&h)&&(Math.sqrt(Math.pow(Math.abs(h[0]-e.clientX),2)+Math.pow(Math.abs(h[1]-e.clientY),2))<5&&i.call(t,jt(e,o)))}))}var k="pointerup";(j&&yt||void 0===window.PointerEvent)&&(k="mouseup");var b=function(e){m=(0,d._)(e,TouchEvent)?e.touches.length:0};return t.addEventListener("touchend",b),t.addEventListener(k,y),function(){t.removeEventListener(k,y),t.removeEventListener("touchend",b),t.removeEventListener("pointerdown",f)}}function jt(e,t){return{angle:0,deltaTime:t,deltaX:0,deltaY:0,direction:1,distance:0,eventType:4,isFinal:!0,isFirst:!1,maxPointers:1,offsetDirection:1,center:{x:e.clientX,y:e.clientY},changedPointers:[e],overallVelocity:0,overallVelocityX:0,overallVelocityY:0,pointerType:"mouse",pointers:[],preventDefault:function(){return e.preventDefault()},stopPropagation:function(){return e.stopPropagation()},rotation:0,scale:1,srcEvent:e,tapCount:2,target:e.target,timeStamp:e.timeStamp,type:"doubletap",velocity:0,velocityX:0,velocityY:0}}var Ut=we.or,Ht=we.Enter,Wt=we.Space;function Yt(e){var t=!1,n=function(e){ke(e,Ut(Ht,Wt))&&(t&&e.preventDefault(),t=!0)},i=function(e){((0,d._)(e,FocusEvent)||ke(e,Ut(Ht,Wt)))&&(t=!1)};return document.addEventListener("keyup",i,!0),window.addEventListener("blur",i),e.addEventListener("keydown",n,{capture:!0}),function(){document.removeEventListener("keyup",i,!0),window.removeEventListener("blur",i),e.removeEventListener("keydown",n,{capture:!0})}}function qt(e,t,n,i){var r=function(e){ke(e,n)&&e.stopPropagation()};return e.addEventListener(t,r,i),function(){e.removeEventListener(t,r,i)}}function Kt(e){if("clientX"in e)return e.clientX;switch(e.type){case"touchstart":case"touchmove":return e.touches[0].clientX;case"touchend":case"touchcancel":return e.changedTouches[0].clientX}throw new Error("Unexpected event type: ".concat(e.type))}function $t(e){if("clientY"in e)return e.clientY;switch(e.type){case"touchstart":case"touchmove":return e.touches[0].clientY;case"touchend":case"touchcancel":return e.changedTouches[0].clientY}throw new Error("Unexpected event type: ".concat(e.type))}var zt=n(4702),Gt=n(2834),Jt=n(6841),Xt={},Zt="__lazy__",Qt=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,null,[{key:"properties",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var i in n){var r=n[i];"function"==typeof r&&e.property(t,i,r)}}},{key:"property",value:function(t,n,i){var r=Xt;Object.getOwnPropertyDescriptor(t,Zt)||Object.defineProperty(t,Zt,{value:{},enumerable:!1,configurable:!1});var o=t[Zt][n]||{};t[Zt][n]=o,o.initialized=!1;var a=!1;Object.defineProperty(t,n,{get:function(){if(!o.initialized){if(a)throw new Error("The lazy property is not initialized and cannot be accessed at this time");a=!0;try{r=i()}catch(e){throw a=!1,e}o.initialized=!0,Promise.resolve().then((function(){(o.callbacks||[]).forEach((function(e){e(r)}))})),a=!1}return r},enumerable:!0,configurable:!0});var s=function(){e.release(t,n)};return"function"===t.addDestroyHook&&t.addDestroyHook(s),s}},{key:"value",value:function(t){var n="lazy_variable_"+Math.ceil(Math.random()*Date.now()).toString(34),i={};return e.property(i,n,t),{reset:function(){return e.reset(i,n)},get value(){return i[n]},get initialized(){return e.isPropertyIntialized(i,n)}}}},{key:"loadProperty",value:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);if(n&&n.get)return n.get.call(e)}},{key:"release",value:function(e,t){Zt in e&&!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&delete e[Zt][t],Object.defineProperty(e,t,{get:function(){},enumerable:!1,configurable:!0})}},{key:"reset",value:function(e,t){var n=e[Zt];if(n){var i=n[t];i&&(i.initialized=!1)}}},{key:"isPropertyIntialized",value:function(e,t){var n=e[Zt];return!!(n&&n[t]&&n[t].initialized)}},{key:"hasProperty",value:function(e,t){var n=e[Zt];return!(!n||!(t in n))}},{key:"notNullProperty",value:function(t,n,i){return e.property(t,n,(function(){var r=i();return null==r&&e.reset(t,n),r}))}},{key:"get",value:function(t,n,i){e.isPropertyIntialized(t,n)&&i(t[n])}},{key:"onInitialized",value:function(t,n,i){if(e.isPropertyIntialized(t,n))return i(t[n]),function(){};var r=t[Zt][n]||{};return t[Zt][n]=r,r.callbacks=r.callbacks||[],r.callbacks.push(i),function(){var e=r.callbacks.indexOf(i);e>-1&&r.callbacks.splice(e,1)}}}]),e}();const en=Qt;function tn(e){var t=e.services,n=e.inject||t;if("function"==typeof n){var i=n.call(e);return Array.isArray(i)?i.reduce((function(e,t,n){return e["service"+n]=t,e}),{}):"function"==typeof i?{service0:i}:i}return{}}var nn,rn="SHARED-SINGLETON",on="SINGLETON";function an(e,t){if(!e)throw new Error(t)}function sn(e){return"number"==typeof e}function un(e){return sn(e)&&isFinite(e)}function cn(e){return sn(e)&&Math.floor(e)===e}function ln(e){return Math.pow(Math.floor(e),2)!==e}function dn(e){return(e%360+360)%360%90==0}function hn(e,t,n){return(arguments.length>3&&void 0!==arguments[3]&&arguments[3]?e>=t:e>t)&&(arguments.length>4&&void 0!==arguments[4]&&arguments[4]?e<=n:e<n)}function fn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;return Math.abs(e-t)<n}function gn(e,t){return fn(e.x,t.x)&&fn(e.y,t.y)}function vn(e){return null!=e}function pn(e){return"function"==typeof e}function mn(e){return"string"==typeof e}function yn(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?e<=t:e<t}function kn(e,t,n){return!!sn(t)&&(!!sn(n)&&(!(t>n)&&(e>=t&&e<=n)))}function bn(e,t,n){return!!sn(t)&&(!!sn(n)&&(!(t>n)&&(e>=t&&e<n)))}function wn(e,t,n){return!!sn(t)&&(!!sn(n)&&(!(t>n)&&(e>t&&e<=n)))}function _n(e,t,n){return!!sn(t)&&(!!sn(n)&&(!(t>n)&&(e>t&&e<n)))}function Pn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.001;return Math.abs(e-t)<n}function An(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=n.reduce((function(e,t){return e+t}))/n.length;return-1===n.findIndex((function(t){return t-r>e}))}function Sn(e){var t=e.scope;return pn(t)&&t.call(e)||nn.SINGLETON}!function(e){e.SHARED_SINGLETON="SHARED-SINGLETON",e.SINGLETON="SINGLETON",e.PROTOTYPE="PROTOTYPE"}(nn||(nn={}));var xn=0,Cn=2,Dn=4,En=8;const In=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,[{key:"format",value:function(e,t,n){return[{type:"string",value:"[".concat(this.levelText(t),"]")},{type:"string",value:"{".concat(e,"}")}].concat(n.map((function(e){return null==e?{type:void 0===e?"undefined":(0,T._)(e),value:e+""}:{type:void 0===e?"undefined":(0,T._)(e),value:e}})))}},{key:"levelText",value:function(e){switch(e){case xn:return"DEBUG";case Cn:return"INFO";case Dn:return"WARN";case En:return"ERROR"}return"UNKNOWN LEVEL"}}]),e}();var Rn={logLevel:Tn("warn"),logLayout:"complex",logAppenders:["console"]||0,logOff:!1,setLogLevel:Fn,toggleLogOff:Mn};function Tn(e){switch(e){case"debug":return xn;case"info":return Cn;case"warn":return Dn;default:return En}}function Fn(e){switch(e){case xn:case Cn:case Dn:case En:Rn.logLevel=e}}function Mn(e){Rn.logOff="boolean"==typeof e?e:!Rn.logOff}var On=function(){function e(t,n,i){(0,c._)(this,e),this.appender=t,this.layout=n,this.module=i,this.logOff=!1}return(0,l._)(e,[{key:"getMinLevel",value:function(){return void 0===this.minLevel?Rn.logLevel:this.minLevel}},{key:"toggle",value:function(e){this.logOff="boolean"==typeof e?e:!this.logOff}},{key:"setLevel",value:function(e){this.minLevel=e}},{key:"doLog",value:function(e,t){if(!this.isLogOff(e)){var n=this.layout.format(this.module,e,t);this.appender.print(n,e)}}},{key:"log",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.doLog(e,n)}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.doLog(xn,t)}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.doLog(Cn,t)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.doLog(Dn,t)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.doLog(En,t)}},{key:"isLogOff",value:function(e){return this.logOff||Rn.logOff||e<this.getMinLevel()}}]),e}(),Ln=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return(0,l._)(n,[{key:"doLog",value:function(){}}]),n}(On);const Nn=On;const Vn=function(e){throw new Error("Method not implemented".concat(e?":"+e:""))};const Bn=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,[{key:"print",value:function(e,t){Vn(e,t)}}]),e}();var jn=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){return(0,c._)(this,n),t.apply(this,arguments)}return(0,l._)(n,[{key:"print",value:function(e,t){var n=e.map((function(e){return"string"!==e.type?" %o":" %c"+e.value})).join("").trim(),i=e.map((function(e){return"string"===e.type?e.style:e.value}));switch(i.splice(0,0,n),t){case xn:var r;(r=console).debug.apply(r,(0,h._)(i));break;case Cn:var o;(o=console).info.apply(o,(0,h._)(i));break;case Dn:var a;(a=console).warn.apply(a,(0,h._)(i));break;case En:var s;(s=console).error.apply(s,(0,h._)(i));break;default:var u;(u=console).log.apply(u,(0,h._)(i))}}}]),n}(Bn);const Un=jn;const Hn=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,[{key:"format",value:function(e,t,n){var i,r=this,o=(new Error).stack;o&&(i="\n  "+o.split("\n")[4].trim());return[{type:"string",style:"color: ".concat(this.levelColor(t),";"),value:"[".concat(this.levelText(t),"]")},{type:"string",style:"color: magenta",value:"{".concat(e,"}")}].concat(n.map((function(e){return null==e?{type:void 0===e?"undefined":(0,T._)(e),style:"color: megenta;font-weight: bold",value:e+""}:"string"==typeof e?{type:void 0===e?"undefined":(0,T._)(e),style:"color: ".concat(r.levelColor(t)),value:e}:{type:void 0===e?"undefined":(0,T._)(e),value:e}}))).concat({type:"string",style:"color: grey;",value:i})}},{key:"levelColor",value:function(e){switch(e){case xn:return"blue";case Cn:return"green";case Dn:return"#FCDCA0";case En:return"red"}return"#000"}},{key:"levelText",value:function(e){switch(e){case xn:return"DEBUG";case Cn:return"INFO";case Dn:return"WARN";case En:return"ERROR"}return"UNKNOWN LEVEL"}}]),e}();var Wn=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(e){var i;return(0,c._)(this,n),(i=t.call(this)).appenders=e||[],i}return(0,l._)(n,[{key:"print",value:function(e,t){this.appenders.forEach((function(n){return n.print(e,t)}))}}]),n}(Bn);const Yn=Wn;var qn={},Kn=function(){function e(){(0,c._)(this,e)}return(0,l._)(e,null,[{key:"toggleLogger",value:function(e){Mn(e)}},{key:"setLogLevel",value:function(e){Fn(e)}},{key:"getLogger",value:function(e){return qn[e]=qn[e]||this.createLogger(e)}},{key:"createLogger",value:function(e){var t,n;if("complex"===Rn.logLayout)t=new Hn;else t=new In;return n=Rn.logAppenders.map((function(e){switch(e){case"console":return new Un;case"websocket":return new WebsocketAppender}})).filter((function(e){return(0,d._)(e,Bn)})),new Nn(new Yn(n),t,e)}}]),e}();const $n=Kn;function zn(e){pn(e.serviceInjected)&&(e.serviceInjected(),e.serviceInjected=f),pn(e.allInjected)&&(e.allInjected(),e.allInjected=f)}function Gn(e,t,n){pn(e.injected)&&e.injected(t,n)}function Jn(e){pn(e.destroy)&&e.destroy()}function Xn(e,t){pn(e.pullout)&&e.pullout(t)}function Zn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;pn(e.addDestroyHook)&&(r=e).addDestroyHook.apply(r,(0,h._)(n))}function Qn(e){return!!pn(e.isLazy)&&e.isLazy()}var ei=function(){function e(){(0,c._)(this,e),(0,g._)(this,"map",new Map)}return(0,l._)(e,[{key:"getComponentInstance",value:function(e,t){if(mn(e))return this.map.get(e);var n=e.$$ioc_instance_name;if(mn(n)&&this.map.has(n))return this.map.get(n);e.length>0&&$n.getLogger(this+"").warn("Relying on other object instances through constructors is not a good practice",e);var i=1===e.length?new e(t):new e;return this.saveComponentInstance(e,i),i}},{key:"saveComponentInstance",value:function(e,t){var n;if(mn(e)?n=e:(n=e.$$ioc_instance_name||this.generateInstanceName(),e.$$ioc_instance_name=n),this.map.has(n))throw new Error("[IoC] An unknown error has occurred: Duplicate requests to create instances of the same type: (".concat(e,")!"));this.map.set(n,t)}},{key:"onInject",value:function(e){var t=e.targetStrategy,n=e.injectInto,i=e.component,r=e.propertyName;t.level>this.level&&Zn(i,(function(){Xn(n,r)}))}},{key:"destroyComponents",value:function(){this.map.forEach((function(e){Jn(e)})),this.map.clear()}},{key:"define",value:function(e){}}]),e}(),ti=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"singleton",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;return(0,c._)(this,n),e=t.call(this),(0,g._)((0,zt._)(e),"name",void 0),(0,g._)((0,zt._)(e),"level",void 0),e.name=i,e.level=r,e}return(0,l._)(n,[{key:"generateInstanceName",value:function(){return O(this.name)}},{key:"registerComponentInstance",value:function(e){var t=e.constructor;this.saveComponentInstance(t,e)}},{key:"registerComponentInstanceByName",value:function(e,t){this.saveComponentInstance(t,e)}}]),n}(ei),ni="object"==typeof window?window:globalThis,ii=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){return(0,c._)(this,n),t.call(this,"shared",1/0)}return(0,l._)(n,[{key:"destroyComponents",value:function(){}}]),n}(ti),ri=ni.__SHARED_IOC_STRATEGY__||new ii;ni.__SHARED_IOC_STRATEGY__=ri;var oi=function(){function e(){(0,c._)(this,e),(0,g._)(this,"level",Number.MIN_SAFE_INTEGER)}return(0,l._)(e,[{key:"getComponentInstance",value:function(e,t){return new e}},{key:"onInject",value:function(e){var t=e.targetStrategy,n=e.injectInto,i=e.component,r=e.propertyName;t.level>this.level&&Zn(i,(function(){Xn(n,r)}))}},{key:"destroyComponents",value:function(){}},{key:"define",value:function(){}}]),e}(),ai=function(){function e(){(0,c._)(this,e),this.destroyHooks=[],this.isDestroyed=!1}return(0,l._)(e,[{key:"ownsTo",value:function(t){if(!(0,d._)(t,e))throw new Error("Cannot owns to non Disposable instance");var n=t.addDestroyHook(this);this.addDestroyHook(n)}},{key:"addDestroyHook",value:function(){for(var t,n=this,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(t=this.destroyHooks).push.apply(t,(0,h._)(r.filter((function(t){if("function"!=typeof t&&!(0,d._)(t,e))throw new Error("[Illegal Argument] Invalid destroy hook:".concat(t,", It's not a function!"));return!0})))),function(){r.forEach((function(e){var t=n.destroyHooks.indexOf(e);t>-1&&n.destroyHooks.splice(t,1)}))}}},{key:"destroy",value:function(){this.destroyHooks.slice(0).forEach((function(t){try{"function"==typeof t?t():(0,d._)(t,e)&&t.destroy()}catch(e){throw e}})),this.destroyHooks=[],this.isDestroyed=!0}}]),e}();const si=ai;var ui,ci=O("$$ioc-component-instance-initialized"),li=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){var e;return(0,c._)(this,n),e=t.call(this),(0,g._)((0,zt._)(e),"strategies",new Map),e.setStrategy(nn.SHARED_SINGLETON,ri),e.setStrategy(nn.PROTOTYPE,new oi),e.setStrategy(nn.SINGLETON,new ti),e}return(0,l._)(n,[{key:"define",value:function(e){var t=Sn(e),n=this.getStrategy(t);null==n||n.define(e)}},{key:"getInstanceByClass",value:function(e,t){if(this.isDestroyed)throw new Error("IoC has been destroyed!");if("string"==typeof e){var n=this.getStrategy(nn.SINGLETON).getComponentInstance(e,t);return n&&this.initInstance(n)}if("function"==typeof e){var i=Sn(e),r=this.getStrategy(i).getComponentInstance(e,t);return this.initInstance(r)}}},{key:"initInstance",value:function(e){var t=function(t){if(en.hasProperty(e,t))return"continue";if(t in e&&e[t])throw new Error("Unable to inject instance, the same property name(".concat(t,") already exists in target instance."));en.property(e,t,(function(){var a=Sn(i),s=tn(i),u=n.getStrategy(a);if(u.level<o.level)throw new Error("[IoC] Instances of scope '".concat(r,"' cannot depend on scope '").concat(a,"'"));var c=n.getInstanceByClass(s[t],e);if(!c)throw new Error("Unexpected ioc component class ".concat(s[t],", name: ").concat(t,", owner: ").concat(e));return Gn(e,t,c),o.onInject({component:c,injectInto:e,propertyName:t,targetStrategy:u}),c})),Qn(i)||en.loadProperty(e,t)},n=this;if(this.isDestroyed)throw new Error("IoC has been destroyed!");if(!e||!e.constructor)throw new Error("".concat(e," is not a valid IoC Component instance!"));if(e[ci])return e;Object.defineProperty(e,ci,{get:function(){return!0},configurable:!1,enumerable:!1});var i=e.constructor,r=Sn(i),o=this.getStrategy(r),a=tn(i);for(var s in a)t(s);return zn(e),e}},{key:"setStrategy",value:function(e,t){this.strategies.set(e,t)}},{key:"getStrategy",value:function(e){var t=this.strategies.get(e);if(!t)throw new Error("[IoC] Incorrect scope: ".concat(e));return t}},{key:"hasStrategy",value:function(e){return this.strategies.has(e)}},{key:"destroy",value:function(){(0,Gt._)((0,Jt._)(n.prototype),"destroy",this).call(this),this.strategies.forEach((function(e){e.destroyComponents()}))}}]),n}(si);!function(e){e[e.Unknown=0]="Unknown",e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.CapsLock=20]="CapsLock",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.KEY_0=48]="KEY_0",e[e.KEY_1=49]="KEY_1",e[e.KEY_2=50]="KEY_2",e[e.KEY_3=51]="KEY_3",e[e.KEY_4=52]="KEY_4",e[e.KEY_5=53]="KEY_5",e[e.KEY_6=54]="KEY_6",e[e.KEY_7=55]="KEY_7",e[e.KEY_8=56]="KEY_8",e[e.KEY_9=57]="KEY_9",e[e.KEY_A=65]="KEY_A",e[e.KEY_B=66]="KEY_B",e[e.KEY_C=67]="KEY_C",e[e.KEY_D=68]="KEY_D",e[e.KEY_E=69]="KEY_E",e[e.KEY_F=70]="KEY_F",e[e.KEY_G=71]="KEY_G",e[e.KEY_H=72]="KEY_H",e[e.KEY_I=73]="KEY_I",e[e.KEY_J=74]="KEY_J",e[e.KEY_K=75]="KEY_K",e[e.KEY_L=76]="KEY_L",e[e.KEY_M=77]="KEY_M",e[e.KEY_N=78]="KEY_N",e[e.KEY_O=79]="KEY_O",e[e.KEY_P=80]="KEY_P",e[e.KEY_Q=81]="KEY_Q",e[e.KEY_R=82]="KEY_R",e[e.KEY_S=83]="KEY_S",e[e.KEY_T=84]="KEY_T",e[e.KEY_U=85]="KEY_U",e[e.KEY_V=86]="KEY_V",e[e.KEY_W=87]="KEY_W",e[e.KEY_X=88]="KEY_X",e[e.KEY_Y=89]="KEY_Y",e[e.KEY_Z=90]="KEY_Z",e[e.Meta=91]="Meta",e[e.ContextMenu=93]="ContextMenu",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.F13=124]="F13",e[e.F14=125]="F14",e[e.F15=126]="F15",e[e.F16=127]="F16",e[e.F17=128]="F17",e[e.F18=129]="F18",e[e.F19=130]="F19",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.US_SEMICOLON=186]="US_SEMICOLON",e[e.US_EQUAL=187]="US_EQUAL",e[e.US_COMMA=188]="US_COMMA",e[e.US_MINUS=189]="US_MINUS",e[e.US_DOT=190]="US_DOT",e[e.US_SLASH=191]="US_SLASH",e[e.US_BACKTICK=192]="US_BACKTICK",e[e.US_OPEN_SQUARE_BRACKET=219]="US_OPEN_SQUARE_BRACKET",e[e.US_BACKSLASH=220]="US_BACKSLASH",e[e.US_CLOSE_SQUARE_BRACKET=221]="US_CLOSE_SQUARE_BRACKET",e[e.US_QUOTE=222]="US_QUOTE",e[e.NUMPAD_0=96]="NUMPAD_0",e[e.NUMPAD_1=97]="NUMPAD_1",e[e.NUMPAD_2=98]="NUMPAD_2",e[e.NUMPAD_3=99]="NUMPAD_3",e[e.NUMPAD_4=100]="NUMPAD_4",e[e.NUMPAD_5=101]="NUMPAD_5",e[e.NUMPAD_6=102]="NUMPAD_6",e[e.NUMPAD_7=103]="NUMPAD_7",e[e.NUMPAD_8=104]="NUMPAD_8",e[e.NUMPAD_9=105]="NUMPAD_9",e[e.NUMPAD_MULTIPLY=106]="NUMPAD_MULTIPLY",e[e.NUMPAD_ADD=107]="NUMPAD_ADD",e[e.NUMPAD_SEPARATOR=108]="NUMPAD_SEPARATOR",e[e.NUMPAD_SUBTRACT=109]="NUMPAD_SUBTRACT",e[e.NUMPAD_DECIMAL=110]="NUMPAD_DECIMAL",e[e.NUMPAD_DIVIDE=111]="NUMPAD_DIVIDE",e[e.KEY_IN_COMPOSITION=112]="KEY_IN_COMPOSITION",e[e.ABNT_C1=113]="ABNT_C1",e[e.ABNT_C2=114]="ABNT_C2"}(ui||(ui={}));var di=Promise.resolve(),hi=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){var e;return(0,c._)(this,n),e=t.call(this),(0,g._)((0,zt._)(e),"__data",{}),(0,g._)((0,zt._)(e),"subscribers",{}),(0,g._)((0,zt._)(e),"reducers",[]),(0,g._)((0,zt._)(e),"filters",[]),e.addDestroyHook((function(){e.reducers.length=0,e.filters.length=0,e.subscribers={},e.clear()})),e}return(0,l._)(n,[{key:"getCurrentValue",value:function(e,t){if(arguments.length>1&&!this.has(e))return t;var n=this.__data[e];return this.reducers.reduce((function(t,n){return n(t,e)}),n)}},{key:"forEach",value:function(e){if("function"!=typeof e)throw new Error((void 0===e?"undefined":(0,T._)(e))+" is not a function!");for(var t in this.__data)e(this.getCurrentValue(t),t)}},{key:"has",value:function(e){return e in this.__data}},{key:"dispatch",value:function(e,t){var n=this;if(this.isDestroyed)return di;this.__data[e]=t;var i=this.subscribers[e]||[],r=this.getCurrentValue(e),o=0===this.filters.length||this.filters.some((function(e){return e(t)}));return o&&i.length?Promise.all(i.slice(0).map((function(t){return t.call(n,r,e)}))):di}},{key:"unDispatch",value:function(e){this.remove(e)}},{key:"remove",value:function(e){this.isDestroyed||(delete this.__data[e],this.subscribers[e]=[])}},{key:"subscribe",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;if(this.isDestroyed)return function(){};var i,r=!1,o=this.subscribers[e]||(this.subscribers[e]=[]),a=function(){if(!r)return n.call(t,t.getCurrentValue(e),e)};return o.push(a),e in this.__data&&Promise.resolve().then(a),function(){if(r)return i;r=!0;var e=o.indexOf(a);return i=e>-1&&o.splice(e,1).length>0}}},{key:"subscribeOnce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f,n=this.subscribe(e,(function(e,i){return n&&n(),t.apply(this,[e,i])}));return n}},{key:"takeWhile",value:function(e){var t=this;return new Promise((function(n){var i=t.subscribe(e,(function(e){try{i&&i()}finally{n(e)}}))}))}},{key:"reducer",value:function(e){var t=this;if(this.isDestroyed)return f;if("function"!=typeof e)return f;var n=e.bind(this);return this.reducers.push(n),function(){var e=t.reducers.indexOf(n);return e>-1&&t.reducers.splice(e,1).length>0}}},{key:"filter",value:function(e){var t=this;if(!this.isDestroyed){if("function"!=typeof e)return f;var n=function(t){return e(t)};return this.filters.push(n),function(){var e=t.filters.indexOf(n);-1!==e&&t.filters.splice(e,1)}}}},{key:"clear",value:function(){this.__data={}}}]),n}(si),fi=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(e){var i;return(0,c._)(this,n),i=t.call(this),(0,g._)((0,zt._)(i),"store",new hi),(0,g._)((0,zt._)(i),"key","k"),i.addDestroyHook(i.store),e&&i.dispatch(e),i}return(0,l._)(n,[{key:"getCurrentValue",value:function(e){return this.store.getCurrentValue(this.key)||e}},{key:"dispatch",value:function(e){this.store.dispatch(this.key,e)}},{key:"subscribe",value:function(e){return this.store.subscribe(this.key,(function(t){return e(t)}))}},{key:"subscribeOnce",value:function(e){return this.store.subscribeOnce(this.key,(function(t){return e(t)}))}},{key:"takeWhile",value:function(){return this.store.takeWhile(this.key)}},{key:"filter",value:function(e){return this.store.filter(e)}},{key:"reduce",value:function(e){return this.store.reducer((function(t){return e(t)}))}},{key:"remove",value:function(){this.store.unDispatch(this.key)}}]),n}(si),gi=-1,vi=function(){function e(){(0,c._)(this,e),(0,g._)(this,"activations",[])}return(0,l._)(e,[{key:"push",value:function(e){var t=this,n={context:e,order:++gi};this.activations.push(n);return function(){var e=t.activations.indexOf(n);e>-1&&t.activations.splice(e,1)}}},{key:"peak",value:function(){var e;return null===(e=this.activations[this.activations.length-1])||void 0===e?void 0:e.context}},{key:"clear",value:function(){this.activations.length=0}},{key:"size",value:function(){return this.activations.length}}]),e}();window.ActvationShortcutContextManager=vi;var pi=n(9422),mi=n(6784),yi=n(8189),ki=n.n(yi),bi=new(function(){function e(){(0,c._)(this,e),(0,g._)(this,"_keyCodeToStr",[]),(0,g._)(this,"_strToKeyCode",{})}return(0,l._)(e,[{key:"define",value:function(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}},{key:"keyCodeToStr",value:function(e){return this._keyCodeToStr[e]}},{key:"strToKeyCode",value:function(e){return this._strToKeyCode[e.toLowerCase()]||ui.Unknown}}]),e}());function wi(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach((function(t){bi.define(e,t)}))}wi(ui.Unknown,"unknown"),wi(ui.Backspace,"Backspace"),wi(ui.Tab,"Tab"),wi(ui.Enter,"Enter"),wi(ui.Shift,"Shift"),wi(ui.Ctrl,"Ctrl"),wi(ui.Alt,"Alt"),wi(ui.PauseBreak,"PauseBreak"),wi(ui.CapsLock,"CapsLock"),wi(ui.Escape,"Escape"),wi(ui.Space,"Space"),wi(ui.PageUp,"PageUp"),wi(ui.PageDown,"PageDown"),wi(ui.End,"End"),wi(ui.Home,"Home"),wi(ui.LeftArrow,"LeftArrow","Left"),wi(ui.UpArrow,"UpArrow","Up"),wi(ui.RightArrow,"RightArrow","Right"),wi(ui.DownArrow,"DownArrow","Down"),wi(ui.Insert,"Insert"),wi(ui.Delete,"Delete"),wi(ui.KEY_0,"0"),wi(ui.KEY_1,"1"),wi(ui.KEY_2,"2"),wi(ui.KEY_3,"3"),wi(ui.KEY_4,"4"),wi(ui.KEY_5,"5"),wi(ui.KEY_6,"6"),wi(ui.KEY_7,"7"),wi(ui.KEY_8,"8"),wi(ui.KEY_9,"9"),wi(ui.KEY_A,"A"),wi(ui.KEY_B,"B"),wi(ui.KEY_C,"C"),wi(ui.KEY_D,"D"),wi(ui.KEY_E,"E"),wi(ui.KEY_F,"F"),wi(ui.KEY_G,"G"),wi(ui.KEY_H,"H"),wi(ui.KEY_I,"I"),wi(ui.KEY_J,"J"),wi(ui.KEY_K,"K"),wi(ui.KEY_L,"L"),wi(ui.KEY_M,"M"),wi(ui.KEY_N,"N"),wi(ui.KEY_O,"O"),wi(ui.KEY_P,"P"),wi(ui.KEY_Q,"Q"),wi(ui.KEY_R,"R"),wi(ui.KEY_S,"S"),wi(ui.KEY_T,"T"),wi(ui.KEY_U,"U"),wi(ui.KEY_V,"V"),wi(ui.KEY_W,"W"),wi(ui.KEY_X,"X"),wi(ui.KEY_Y,"Y"),wi(ui.KEY_Z,"Z"),wi(ui.Meta,"Meta"),wi(ui.ContextMenu,"ContextMenu"),wi(ui.F1,"F1"),wi(ui.F2,"F2"),wi(ui.F3,"F3"),wi(ui.F4,"F4"),wi(ui.F5,"F5"),wi(ui.F6,"F6"),wi(ui.F7,"F7"),wi(ui.F8,"F8"),wi(ui.F9,"F9"),wi(ui.F10,"F10"),wi(ui.F11,"F11"),wi(ui.F12,"F12"),wi(ui.F13,"F13"),wi(ui.F14,"F14"),wi(ui.F15,"F15"),wi(ui.F16,"F16"),wi(ui.F17,"F17"),wi(ui.F18,"F18"),wi(ui.F19,"F19"),wi(ui.NumLock,"NumLock"),wi(ui.ScrollLock,"ScrollLock"),wi(ui.US_SEMICOLON,";",";","OEM_1"),wi(ui.US_EQUAL,"=","=","OEM_PLUS"),wi(ui.US_COMMA,",",",","OEM_COMMA"),wi(ui.US_MINUS,"-","-","OEM_MINUS"),wi(ui.US_DOT,".",".","OEM_PERIOD"),wi(ui.US_SLASH,"/","/","OEM_2"),wi(ui.US_BACKTICK,"`","`","OEM_3"),wi(ui.ABNT_C1,"ABNT_C1"),wi(ui.ABNT_C2,"ABNT_C2"),wi(ui.US_OPEN_SQUARE_BRACKET,"[","[","OEM_4"),wi(ui.US_BACKSLASH,"\\","\\","OEM_5"),wi(ui.US_CLOSE_SQUARE_BRACKET,"]","]","OEM_6"),wi(ui.US_QUOTE,"'","'","OEM_7"),wi(ui.NUMPAD_0,"NumPad0"),wi(ui.NUMPAD_1,"NumPad1"),wi(ui.NUMPAD_2,"NumPad2"),wi(ui.NUMPAD_3,"NumPad3"),wi(ui.NUMPAD_4,"NumPad4"),wi(ui.NUMPAD_5,"NumPad5"),wi(ui.NUMPAD_6,"NumPad6"),wi(ui.NUMPAD_7,"NumPad7"),wi(ui.NUMPAD_8,"NumPad8"),wi(ui.NUMPAD_9,"NumPad9"),wi(ui.NUMPAD_MULTIPLY,"NumPad_Multiply"),wi(ui.NUMPAD_ADD,"NumPad_Add"),wi(ui.NUMPAD_SEPARATOR,"NumPad_Separator"),wi(ui.NUMPAD_SUBTRACT,"NumPad_Subtract"),wi(ui.NUMPAD_DECIMAL,"NumPad_Decimal"),wi(ui.NUMPAD_DIVIDE,"NumPad_Divide");var _i=function(){function e(t,n,i,r,o){(0,c._)(this,e),(0,g._)(this,"ctrlKey",void 0),(0,g._)(this,"shiftKey",void 0),(0,g._)(this,"altKey",void 0),(0,g._)(this,"metaKey",void 0),(0,g._)(this,"keyCode",void 0),this.ctrlKey=t,this.shiftKey=n,this.altKey=i,this.metaKey=r,this.keyCode=o}return(0,l._)(e,[{key:"equals",value:function(t){return!!(0,d._)(t,e)&&(this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode)}},{key:"isError",value:function(){return this.keyCode===ui.Unknown}},{key:"toString",value:function(){var e,t=[];return this.ctrlKey&&t.push("Ctrl"),this.shiftKey&&t.push("Shift"),this.altKey&&t.push("Alt"),this.metaKey&&t.push("Meta"),t.join("+")+(t.length>0?"+":"")+(e=this.keyCode,bi.keyCodeToStr(e))}},{key:"match",value:function(e){return this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}}],[{key:"from",value:function(t){var n,i=function(e){e=e.trim().toLowerCase();var t,n=!1,i=!1,r=!1,o=!1;do{t=!1,/^ctrl[\+\-]/.test(e)&&(n=!0,e=e.substring(5),t=!0),/^shift[\+\-]/.test(e)&&(i=!0,e=e.substring(6),t=!0),/^alt[\+\-]/.test(e)&&(r=!0,e=e.substring(4),t=!0),/^meta[\+\-]/.test(e)&&(o=!0,e=e.substring(5),t=!0),/^win[\+\-]/.test(e)&&(o=!0,e=e.substring(4),t=!0),/^cmd[\+\-]/.test(e)&&(o=!0,e=e.substring(4),t=!0),/^mod[\+\-]/.test(e)&&(B?o=!0:n=!0,e=e.substring(4),t=!0)}while(t);return{ctrl:n,shift:i,alt:r,meta:o,key:e}}(t),r=(n=i.key,bi.strToKeyCode(n));if(r===ui.Unknown)throw new Error('Incorrect shortcut: "'.concat(t,'", "').concat(i.key,'" is not valid'));return new e(i.ctrl,i.shift,i.alt,i.meta,r)}}]),e}();var Pi=[_i.from("Mod+V"),_i.from("Mod+A"),_i.from("Mod+S"),_i.from("Mod+Shift+S"),_i.from("Mod+P"),_i.from("Mod+F")],Ai=[_i.from("Mod+A"),_i.from("Mod+Z"),_i.from("Mod+Y"),_i.from("Delete"),_i.from("Backspace"),_i.from("Mod+Delete"),_i.from("Mod+Backspace")];const Si=_i;var xi,Ci=function(){function e(t,n,i,r,o){(0,c._)(this,e),(0,g._)(this,"native",void 0),(0,g._)(this,"shortcut",void 0),(0,g._)(this,"opportunity",void 0),(0,g._)(this,"command",void 0),(0,g._)(this,"context",void 0),(0,g._)(this,"stopped",void 0),(0,g._)(this,"nativeEvent",void 0),this.native=t,this.shortcut=n,this.opportunity=i,this.command=r,this.context=o,this.stopped=!1,this.nativeEvent=this.native}return(0,l._)(e,[{key:"preventDefault",value:function(){this.native.preventDefault()}},{key:"stop",value:function(){this.stopped=!0}},{key:"stopPropagation",value:function(){this.native.stopPropagation()}}]),e}();!function(e){e.keydown="keydown",e.keyup="keyup"}(xi||(xi={}));var Di=$n.getLogger("ShortcutContext"),Ei=function(){function e(t){(0,c._)(this,e),(0,g._)(this,"name",void 0),(0,g._)(this,"uperLayer",void 0),(0,g._)(this,"parents",void 0),(0,g._)(this,"emitter",void 0),(0,g._)(this,"shortcuts",void 0),(0,g._)(this,"interceptors",void 0),this.name=t,this.uperLayer=[],this.parents=[],this.emitter=new(ki()),this.shortcuts={},this.interceptors=[]}return(0,l._)(e,[{key:"getUperLayers",value:function(){return this.uperLayer.slice(0)}},{key:"getParents",value:function(){return this.parents.slice(0)}},{key:"attach",value:function(e){var t=e;this.uperLayer.indexOf(t)>-1||this.uperLayer.push(t)}},{key:"extend",value:function(e){var t=e;this.parents.indexOf(t)>-1||this.parents.push(t)}},{key:"interceptor",value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=this.interceptors).push.apply(e,(0,h._)(i)),function(){i.forEach((function(e){var n=t.interceptors.indexOf(e);n>-1&&t.interceptors.splice(n,1)}))}}},{key:"registerShortcut",value:function(e,t){var n=this;return this.shortcuts[e]=Si.from(t),function(){delete n.shortcuts[e]}}},{key:"on",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clear:!1};i.clear&&this.removeListener(e);var r=function(e){var n=!!i.keydown,r=!!i.keyup||void 0===i.keydown&&void 0===i.keyup;(n&&e.opportunity===xi.keydown||r&&e.opportunity===xi.keyup)&&(e.stopped||(i.interceptors||[]).reduceRight((function(e,t){return function(n){t(n,e)}}),(function(n){i.preventDefault&&e.preventDefault(),t(n)}))(e))},o=function(t){t!==e&&t||n.emitter.off(e,r)};return t.__remove__=o,this.emitter.on(e,r),o}},{key:"keyup",value:function(e,t,n){return this.on(e,t,(0,mi._)((0,pi._)({},n),{keyup:!0,keydown:!1}))}},{key:"keydown",value:function(e,t,n){return this.on(e,t,(0,mi._)((0,pi._)({},n),{keyup:!1,keydown:!0}))}},{key:"removeListener",value:function(e,t){var n=t;t&&"string"==typeof n.__remove__?n.__remove__(e):this.emitter.removeAllListeners(e)}},{key:"handleEvent",value:function(e,t){var n=this,i=function(i){var u=a[i],c=new Ci(e,u,o,i,n);if(ke(e,u)){var l=t.concat(n.getInterceptors(i)).reduceRight((function(e,t){return function(n){t(n,e)}}),(function(t){r.getAncestorLink(i).forEach((function(e){e.emitter.emit(i,t)}));var n=Pi.some((function(e){return e.equals(u)}));n&&e.preventDefault()}));l(c),s=!0}},r=this,o=xi[e.type];if(!o)throw new Error("Unexpected keyboard event type: ".concat(e.type,', it should be "keydown" or "keyup"'));var a=this.getShortcuts(),s=!1;for(var u in a)i(u);return s||this.uperLayer.some((function(n){return n.handleEvent(e,t)}))}},{key:"getInterceptors",value:function(e){return this.getAncestorLink(e).reduceRight((function(e,t){return e.concat(t.interceptors)}),[])}},{key:"getAncestorLink",value:function(e){var t=this,n=[],i=function(r){var o=r.getParents().some((function(t){return t.getShortcut(e,!1)?(n.push(t),!0):i(t)}));o?n.unshift(r):t.getShortcut(e,!1)&&n.push(t)};return i(this),n}},{key:"getShortcut",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getShortcuts(t)[e]}},{key:"getShortcuts",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e){var t=this.parents.reduceRight((function(t,n){return Object.assign(t,n.getShortcuts(e))}),{});return Object.assign({},t,this.shortcuts)}return Object.assign({},this.shortcuts)}},{key:"getComandName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="string"==typeof e?Si.from(e):e,i=this.getShortcuts(t);for(var r in i){if(i[r].equals(n))return r}}},{key:"before",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Di.warn("Deprecated API: ShortcutContext.before"),this.on(e,t,{keydown:!0,keyup:!1,preventDefault:n})}},{key:"toString",value:function(){return this.name}}]),e}(),Ii=$n.getLogger("Keyboard"),Ri=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{anchor:document.body};return(0,c._)(this,n),e=t.call(this),(0,g._)((0,zt._)(e),"anchor",void 0),(0,g._)((0,zt._)(e),"disabled",!1),(0,g._)((0,zt._)(e),"contexts",new hi),(0,g._)((0,zt._)(e),"activationManager",new vi),(0,g._)((0,zt._)(e),"interceptors",[]),(0,g._)((0,zt._)(e),"defaultShortcutContext",new Ei("default-shortcut-context")),e.anchor=i.anchor,e.prepare(),e.contexts.filter(Boolean),e.addDestroyHook(e.contexts),e}return(0,l._)(n,[{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"setup",value:function(e){var t=this;e.forEach((function(e){t.createContext(e.context,e,(function(t){for(var n in e.shortcuts)t.registerShortcut(n,e.shortcuts[n])}))}))}},{key:"createContext",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=n.extends||[],o=n.topLayers||[],a=function(e){var n=t.getContextByName(e);if(!n)throw new Error("ShortcutContext cannot be used before created: ".concat(e));return n},s=r.map((function(e){return a(e)})),u=o.map((function(e){return a(e)})),c=this.getContextByName(e)||new Ei(e);return s.forEach((function(e){c.extend(e)})),u.forEach((function(e){c.attach(e)})),this.contexts.dispatch(e,c),i&&this.withContext(e,i),c}},{key:"withContext",value:function(e,t){var n=this;return this.contexts.takeWhile(e).then((function(e){return t.call(n,e),e}))}},{key:"activeContext",value:function(e){var t=this.contexts.getCurrentValue(e);return t?this.activationManager.push(t):f}},{key:"getActivateContext",value:function(){return this.activationManager.peak()||this.defaultShortcutContext}},{key:"on",value:function(e,t,n){var i=this.findContextByCommand(e).map((function(i){return i.on(e,t,n)}));return function(){i.forEach((function(e){return e()})),i.length=0}}},{key:"keydown",value:function(e,t,n){var i=this.findContextByCommand(e).map((function(i){return i.keydown(e,t,n)}));return function(){i.forEach((function(e){return e()})),i.length=0}}},{key:"keyup",value:function(e,t,n){var i=this.findContextByCommand(e).map((function(i){return i.keyup(e,t,n)}));return function(){i.forEach((function(e){return e()})),i.length=0}}},{key:"findContextByShortcut",value:function(e){var t=[];return this.contexts.forEach((function(n){n.getComandName(e,!1)&&t.push(n)})),t}},{key:"findContextByCommand",value:function(e){var t=[];return this.contexts.forEach((function(n){e in n.getShortcuts(!1)&&t.push(n)})),t}},{key:"getContextByName",value:function(e){return this.contexts.getCurrentValue(e)}},{key:"getBinder",value:function(e){return Ii.warn("Deprecated API: Keyboard.getBinder"),this.getContextByName(e)}},{key:"activeBinder",value:function(e){return Ii.warn("Deprecated API: Keyboard.activeBinder"),this.activeContext(e)}},{key:"markdown",value:function(){var e=[];return this.contexts.forEach((function(t){var n=t.getUperLayers(),i=t.getParents();n.forEach((function(n){e.push("    ".concat(n.name," --\x3e ").concat(t.name))})),i.forEach((function(n){e.push("    ".concat(n.name," -.Extends.-> ").concat(t.name))}));var r=t.getShortcuts(!1);if(Object.keys(r).length>0){for(var o in e.push("    subgraph ".concat(t.name,"_sub [").concat(t.name,"]")),r)e.push("    ".concat(t.name," ==Shortcut==> ").concat(o," -.-> ").concat(r[o].toString()));e.push("    end")}})),"```mermaid\n".concat("flowchart LR","\n").concat(e.join("\n"),"\n```")}},{key:"onShortcut",value:function(e,t,n){var i=e.toString();return this.defaultShortcutContext.registerShortcut(i,i),this.defaultShortcutContext.on(i,t,n)}},{key:"interceptor",value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=this.interceptors).push.apply(e,(0,h._)(i)),function(){i.forEach((function(e){var n=t.interceptors.indexOf(e);n>-1&&t.interceptors.splice(n,1)}))}}},{key:"getDefaultShortcutContext",value:function(){return this.defaultShortcutContext}},{key:"prepare",value:function(){var e=this,t=function(t){if(!e.disabled){e.defaultShortcutContext.handleEvent(t,e.interceptors);var n=e.activationManager.peak();n&&n.handleEvent(t,e.interceptors)}},n={};this.anchor.addEventListener("keyup",t,n),this.anchor.addEventListener("keydown",t,n),this.addDestroyHook((function(){e.anchor.removeEventListener("keyup",t,n),e.anchor.removeEventListener("keydown",t,n)}))}},{key:"getActivationManager",value:function(){return this.activationManager}}]),n}(si);function Ti(e){return function(t,n){if(e.indexOf(t.command))return n(t)}}function Fi(e){return function(t,n){if(-1===e.indexOf(t.command))return n(t)}}function Mi(e,t){if(!e||!(0,d._)(e,Element))return!1;var n=t||{},i=n.visible,r=void 0===i||i,o=n.enable,a=void 0===o||o,s=n.readonly,u=void 0===s||s;if(r){var c=e.getClientRects();if(0===c.length)return!1;var l=c[0];if(l.width*l.height==0)return!1}switch(e.tagName.toLowerCase()){case"input":case"select":case"textarea":var h=e;return(!a||!h.disabled)&&(!u||!h.disabled&&!h.readOnly)}switch(e.contentEditable){case"true":case"plaintext-only":return!0}return!1}function Oi(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(t,i){n.length>0&&n.indexOf(t.command)>-1?i(t):Mi(t.native.target,e)||i(t)}}function Li(e){return function(t,n){e&&t.command!==e||t.preventDefault(),n(t)}}function Ni(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,i){var r;r=t?function(e){return e===document.activeElement||e.contains(document.activeElement)}:function(e){return e===document.activeElement},!!e.find(r)&&i(n)}}const Vi={aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpg:"image/jpeg",jpeg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",mid:"audio/midi",midi:"audio/x-midi",mjs:"text/javascript",mp3:"audio/mpeg",cda:"application/x-cdf",mp4:"video/mp4",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",fdf:"application/vnd.fdf",xfdf:"application/vnd.adobe.fdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",".tiff":"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"};function Bi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/octet-stream";return Vi[e]||t}function ji(){}var Ui,Hi,Wi,Yi=(navigator.appVersion.match(/iphone/gi),"undefined"!=typeof devicePixelRatio?devicePixelRatio:1);var qi=72;function Ki(){return Ui||(Ui=function(){if("undefined"!=typeof screen&&screen.deviceXDPI)return{x:screen.deviceXDPI,y:screen.deviceYDPI};if("undefined"!=typeof document){var e=document.createElement("div");e.style.cssText="width:1in;height:1in;position:absolute;top:20in;border:none;padding:0;",document.body.appendChild(e);var t={x:parseInt(e.offsetWidth),y:parseInt(e.offsetHeight)};return e.parentNode.removeChild(e),t}return{x:96,y:96}}()),Ui}function $i(){if(void 0===Hi){var e=Ki();Hi=e.x/qi}return Hi}function zi(){if(void 0===Wi){var e=Ki();Wi=qi/e.x}return Wi}var Gi,Ji=function(e){var t=[new ClipboardItem((0,g._)({},e.type,e))];return navigator.clipboard.write(t)};function Xi(e){return function(){if(kt||wt)return Promise.resolve(!1);if(!navigator.permissions||!navigator.permissions.query)return Promise.resolve(!1);try{return navigator.permissions.query({name:"clipboard-write",allowWithoutGesture:!1}).then((function(e){return"granted"===e.state}))}catch(e){return console.log(e),Promise.resolve(!1)}}().then((function(t){if(t){var n=new Blob([e],{type:"text/plain"});return Ji(n).then((function(e){return!0}))}var i=Gi||((Gi=document.createElement("textarea")).style.opacity="0",Gi.style.top="-999px",Gi.style["z-index"]=-1,Gi.style.position="absolute",document.body.appendChild(Gi),Gi);i.value=e,i.select(),i.focus(),i.setSelectionRange(0,i.value.length);var r=document.execCommand("copy",!1,i.value);return i.blur(),r}))}function Zi(e){var t;try{0==(t=e.composedPath&&e.composedPath()).length&&(t=e.path)}catch(e){t=null}var n=e.target;return null!=t?t.indexOf(window)<0?t.concat(window):t:n===window?[window]:[n].concat(Qi(n),window)}function Qi(e,t){t=t||[];var n=e&&e.parentNode;return n?Qi(n,t.concat(n)):t}function er(){if("object"!=typeof window)return 1;var e=window.devicePixelRatio||1,t=document.createElement("canvas").getContext("2d");return e/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}function tr(){return"undefined"!=typeof WorkerGlobalScope&&(0,d._)(self,WorkerGlobalScope)}function nr(){return"undefined"!=typeof window}var ir=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,c._)(this,n),i=t.call(this),(0,g._)((0,zt._)(i),"observer",void 0),(0,g._)((0,zt._)(i),"observePairs",new Map),(0,g._)((0,zt._)(i),"lastIntersectionEntryMap",new WeakMap),i.observer=new IntersectionObserver((function(e){e.forEach((function(e){var t=i.observePairs.get(e.target);i.lastIntersectionEntryMap.set(e.target,e),null==t||t.callback.call(null,e.target,e.isIntersecting)}))}),{root:e,threshold:r}),i.addDestroyHook((function(){i.observer.disconnect(),i.observePairs.clear()})),i}return(0,l._)(n,[{key:"observe",value:function(e,t){var n=this,i={callback:t,element:e};return this.observePairs.set(e,i),this.observer.observe(e),function(){n.observer.unobserve(e),n.observePairs.delete(e)}}},{key:"forceUpdate",value:function(e){var t=this.lastIntersectionEntryMap.get(e);if(t){var n=this.observePairs.get(e);return Promise.resolve(null==n?void 0:n.callback.call(null,e,t.isIntersecting))}}}]),n}(si);function rr(e,t,n){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]||X&&(kt||ee||Dt)||H&&kt||te){var i,r=null,o=0,a=!1,s=function(e){a=!1,i=void 0,clearTimeout(r),r=null,e.touches&&1!==e.touches.length||(o=0,i={x:e.touches[0].pageX,y:e.touches[0].pageY},r=setTimeout((function(){a||c(e)}),600),e.stopPropagation())},u=function(e){if((!e.touches||1===e.touches.length)&&i){var t=e.touches[0],n=Math.pow(t.pageX-i.x,2)+Math.pow(t.pageY-i.y,2);(o=Math.max(o,n))>10&&(a=!0)}},c=function(n){if(i=null,n.changedTouches&&1===n.changedTouches.length){var o=n.changedTouches[0],a=new Event("contextmenu"),s=["target","currentTarget","clientX","clientY","pageX","pageY","offsetX","offsetY","path"].reduce((function(e,t){return e[t]={value:o[t]},e}),{});s.stopPropagation={value:function(){n.stopPropagation()}},s.preventDefault={value:function(){n.preventDefault()}};var u=Object.create(a,s);t.call(e,u),clearTimeout(r)}else clearTimeout(r)},l=function(){a=!1,clearTimeout(r)};e.addEventListener("touchstart",s,n),document.addEventListener("touchend",l,!0),document.addEventListener("touchmove",u,!0);var d=function(e){e.preventDefault()};return document.addEventListener("contextmenu",d,{capture:!0,passive:!1}),e.addEventListener("contextmenu",d),function(){e.removeEventListener("touchstart",s,n),document.removeEventListener("touchmove",u,!0),document.removeEventListener("touchend",l,!0),document.removeEventListener("contextmenu",d,{capture:!0,passive:!1}),e.removeEventListener("contextmenu",d)}}return e.addEventListener("contextmenu",t,n),function(){e.removeEventListener("contextmenu",t,n)}}var or=n(8490),ar=n(9307);function sr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object.hasOwnProperty.call(e,"constructor"),r=i?e.constructor:void 0,o=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){var e;return(0,c._)(this,n),e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),i?(0,ar._)(e,r.apply((0,zt._)(e),arguments)):e}return n}(t);return i&&delete e.constructor,Object.assign(o.prototype,e),e.constructor=r,Object.assign(o,n),o}function ur(e){var t=null;return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return null===t&&(t=(0,or._)(e,(0,h._)(i))),t}}function cr(e,t){var n=e.classList;n.contains(t)||n.add(t)}function lr(e,t){if(e){var n=e.classList;n.contains(t)&&n.remove(t)}}function dr(e,t,n,i){t?(cr(e,n),lr(e,i)):(lr(e,n),cr(e,i))}var hr=n(3638);function fr(e,t){var n=[],i=getComputedStyle(e);if("string"==typeof t){var r={};t.split(/;[\r\n\s]*/).forEach((function(e){var t=(0,hr._)(e.split(/\s*:\s*/),2),n=t[0],i=t[1];r[n]=i})),t=r}for(var o in t)i[o]!==t[o]&&n.push("".concat(o,":").concat(t[o]));n.length>0&&(e.style.cssText+=n.join(";"))}function gr(e,t){for(var n in t){var i=e[n],r=t[n];i!=r&&(e[n]=r)}}var vr=function(){},pr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,c._)(this,e),(0,g._)(this,"delay",void 0),(0,g._)(this,"leading",void 0),(0,g._)(this,"handle",void 0),(0,g._)(this,"flag",void 0),(0,g._)(this,"pending",void 0),this.delay=t,this.leading=n,this.handle=vr,this.flag=0,this.pending=!1}return(0,l._)(e,[{key:"exec",value:function(e){var t=this;if(this.flag++,this.handle=e,!this.pending){this.leading&&(e(),this.flag=0,this.handle=vr);var n=function(){t.pending=!0,setTimeout((function(){if(t.flag>1)t.flag=0,n();else{var e=t.handle;t.handle=vr,e(),t.pending=!1}}),t.delay)};n()}}},{key:"cancel",value:function(){this.handle=vr}}]),e}();function mr(e){var t=new pr(arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,arguments.length>2&&void 0!==arguments[2]&&arguments[2]);return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var o,a=(o=e).bind.apply(o,[this].concat((0,h._)(i)));t.exec(a)}}var yr={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Error]":"error","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"};function kr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=!0;"boolean"==typeof e&&(r=e,e=n[0],n=n.slice(1)),(null===e||"object"!=typeof e&&"function"!=typeof e)&&(e={});for(var o=0,a=n.length;o<a;o++){var s=n[o];if(null!=s)for(var u in s){var c=e[u],l=s[u];if(e!==l){var d=void 0;if(r&&l&&(wr(l)||(d=Array.isArray(l)))){var h=void 0;d?(d=!1,h=c&&Array.isArray(c)?c:[]):h=c&&wr(c)?c:{},e[u]=kr(r,h,l)}else void 0!==l&&(e[u]=l)}}}return e}function br(e,t){return null!=e&&{}.hasOwnProperty.call(e,t)}function wr(e){if(!e||"object"!==function(e){if(null===e)return"null";switch(void 0===e?"undefined":(0,T._)(e)){case"object":case"function":return yr[Object.prototype.toString(e)]||"object"}return void 0===e?"undefined":(0,T._)(e)}(e)||e.nodeType||null!=e&&e==e.window)return!1;if(e.constructor&&!br(e,"constructor")&&!br(e.constructor.prototype,"isPrototypeOf"))return!1;var t=void 0;for(t in e);return void 0===t||br(e,t)}function _r(e){return Mi(e,{visible:!1,readonly:!1,enable:!1})}function Pr(e){return function(){var e=new Set;function t(n){try{f.call(n.location.href)}catch(e){return}(0,d._)(n,n.Window)&&e.add(n);for(var i=0;i<n.length;i++)t(n[i])}var n=window.top;n&&Object.getPrototypeOf(n)||(n=window);return t(n),Array.from(e)}().map((function(t){return t[e]}))}function Ar(e){return Pr("window").indexOf(e)>=0}function Sr(e){return Pr("Element").some((function(t){return(0,d._)(e,t)}))}function xr(e,t){if(Ar(e)){var n=function(){t()};return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}if(!Sr(e))throw new TypeError("Failed to execute 'observeResize': parameter 1 is not of type `Element`");if("function"!=typeof t)throw new TypeError("Failed to execute 'observeResize': parameter 2 is not of type `Function`");if(window.ResizeObserver){var i=Cr(e),r=new ResizeObserver((function(e){if(1===e.length){var n,r,o=e[0].contentRect;r=o,((n=i).width!==r.width||n.height!==r.height)&&(t(),i=o)}}));return r.observe(e),function(){r.disconnect()}}var o,a=!1,s=Cr(e);return o=setInterval((function(){if(!a){var n=Cr(e);s&&n&&(n.width!==s.width||n.height!==s.height)&&t(),s=n}}),100),function(){a=!0,clearInterval(o)}}function Cr(e){if(!e)return null;if(dt)try{return e.getBoundingClientRect()}catch(e){return null}return e.getBoundingClientRect()}const Dr=function(){throw new Error("Unsupported operation!")};var Er=n(6244),Ir=n.n(Er),Rr=n(8366),Tr=n.n(Rr),Fr=n(449),Mr=n.n(Fr),Or=n(1434),Lr=n.n(Or),Nr=n(1128),Vr=n.n(Nr),Br=n(579),jr=n.n(Br),Ur=n(7074),Hr=n.n(Ur),Wr=n(890),Yr=n.n(Wr),qr=n(8990),Kr=n.n(qr),$r=n(5522),zr=n.n($r),Gr=n(3765),Jr=n.n(Gr),Xr=n(5576),Zr=n.n(Xr),Qr=n(859),eo=n.n(Qr),to=n(4883),no=n.n(to);Ir().locale(Vr()),Ir().locale(jr()),Ir().locale(Hr()),Ir().locale(Yr()),Ir().locale(Kr()),Ir().locale(Kr()),Ir().locale(zr()),Ir().locale(Jr()),Ir().locale(Zr()),Ir().locale(eo()),Ir().locale(Kr()),Ir().locale(no()),Ir().extend(Tr()),Ir().extend(Mr()),Ir().extend(Lr());const io=Ir();var ro=n(2047),oo=n.n(ro);function ao(e,t){var n=oo().fn.on;try{oo().fn.on=function(){for(var t=this,i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e.addDestroyHook((function(){oo().fn.off.apply(t,r)})),n.apply(this,r)},t(oo())}finally{oo().fn.on=n}}var so,uo=function(){function e(t){(0,c._)(this,e),this.originfn=t,this.beforeHooks=[],this.afterHooks=[],this.thrownHooks=[],this.aroundHooks=[]}return(0,l._)(e,[{key:"before",value:function(e){return"function"==typeof e&&this.beforeHooks.push(e),this}},{key:"after",value:function(e){return"function"==typeof e&&this.afterHooks.push(e),this}},{key:"thrown",value:function(e){return"function"==typeof e&&this.thrownHooks.push(e),this}},{key:"around",value:function(e){return"function"==typeof e&&this.aroundHooks.push(e),this}},{key:"proxy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.before,n=e.after,i=e.thrown,r=e.around;return this.before(t),this.after(n),this.thrown(i),this.around(r),this}},{key:"extract",value:function(){var e=this,t=e.beforeHooks,n=e.afterHooks,i=e.thrownHooks,r=e.aroundHooks,o=e.originfn;function a(){for(var e=this,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];t.forEach((function(t){return t.call(e,a)}));try{var u=o.apply(this,a);return(0,d._)(u,Promise)?(u.then((function(t){n.forEach((function(n){return n.call(e,t,a)}))})),u.catch((function(t){i.forEach((function(n){return n.call(e,t,a)}))}))):n.forEach((function(t){return t.call(e,u,a)})),u}catch(t){i.length,i.forEach((function(n){return n.call(e,t,a)}))}}return a.origin=o,r.reduceRight((function(e,t){return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return t(this,e,i)}}),a)}}],[{key:"on",value:function(t){if("function"==typeof t)return new e(t);if((0,d._)(t,e))return new e(t.extract());throw new TypeError("Unexpected type: ".concat(void 0===t?"undefined":(0,T._)(t)))}}]),e}(),co=function(){function e(t,n,i,r){(0,c._)(this,e),(0,g._)(this,"r",void 0),(0,g._)(this,"g",void 0),(0,g._)(this,"b",void 0),(0,g._)(this,"a",void 0),this.r=t,this.g=n,this.b=i,this.a=r}return(0,l._)(e,[{key:"toCSS_Hex",value:function(){return"#".concat(lo(this.r)).concat(lo(this.g)).concat(lo(this.b))}},{key:"toCSS_RGB",value:function(){return"rgb(".concat(this.r,",").concat(this.g,",").concat(this.b,")")}},{key:"toRGB",value:function(){return this.r<<16|this.g<<8|this.b}},{key:"toCSS_RGBA",value:function(){return"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.a/255,")")}},{key:"toHSL",value:function(){var e=this.r/255,t=this.g/255,n=this.b/255,i=Math.min(e,t,n),r=Math.max(e,t,n),o=r-i,a=0,s=0;return(a=0===o?0:r===e?(t-n)/o%6:r===t?(n-e)/o+2:(e-t)/o+4)<0&&(a+=360),s=(r+i)/2,{h:a,s:+(100*(0===o?0:o/(1-Math.abs(2*s-1)))).toFixed(1),l:s=+(100*s).toFixed(1)}}},{key:"toCSS_HSL",value:function(){var e=this.toHSL(),t=e.h,n=e.s,i=e.l;return"hsl(".concat(t,",").concat(n,"%,").concat(i,"%)")}},{key:"toCSS_HSLA",value:function(){var e=this.toHSL(),t=e.h,n=e.s,i=e.l;return"hsla(".concat(t,",").concat(n,"%,").concat(i,"%, ").concat(this.a/255,")")}},{key:"toCMYK",value:function(){return e.convertRGB2CMYK(this.r,this.g,this.b)}},{key:"toHSV",value:function(){return e.convertRGB2HSV(this.r,this.g,this.b)}},{key:"clone",value:function(){return new(0,this.constructor)(this.r,this.g,this.b,this.a)}},{key:"isSameAs",value:function(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}},{key:"asArray",value:function(){return[this.r,this.g,this.b,this.a]}}],[{key:"fromHSLA",value:function(t,n,i,r){var o=(0,hr._)(e.convertHSL2rgb(t,n,i),3);return new e(o[0],o[1],o[2],r)}},{key:"fromRGBA",value:function(t,n){var i=(0,hr._)(e.separateRGBNumber(t),3);return new e(i[0],i[1],i[2],n)}},{key:"fromARGB",value:function(t){if(t<=16777215)return e.fromRGBA(t,255);var n=255&t>>24,i=16777215&t;return e.fromRGBA(i,n)}},{key:"fromRGB",value:function(t){return e.fromRGBA(t,255)}},{key:"convertHSL2rgb",value:function(e,t,n){e=Math.min(359,Math.max(0,e)),t=Math.min(100,Math.max(0,t)),n=Math.min(100,Math.max(0,n)),n/=100;var i,r,o,a,s=(t/=100)*(1-Math.abs(2*n-1)),u=s*(1-Math.abs(e/60%2-1)),c=n-s/2;if(e>=0&&e<60)i=(a=[s,u,0])[0],r=a[1],o=a[2];else if(e>=60&&e<120){var l;i=(l=[u,s,0])[0],r=l[1],o=l[2]}else if(e>=120&&e<180){var d;i=(d=[0,s,u])[0],r=d[1],o=d[2]}else if(e>=180&&e<240){var h;i=(h=[0,u,s])[0],r=h[1],o=h[2]}else if(e>=240&&e<300){var f;i=(f=[u,0,s])[0],r=f[1],o=f[2]}else{var g;i=(g=[s,0,u])[0],r=g[1],o=g[2]}return[i,r,o].map((function(e){return Math.round(255*(e+c))}))}},{key:"convertRGB2CMYK",value:function(e,t,n){var i=e/255,r=t/255,o=n/255,a=1-Math.max(i,r,o);return{c:(1-i-a)/(1-a),m:(1-r-a)/(1-a),y:(1-o-a)/(1-a),k:a}}},{key:"convertRGB2HSV",value:function(e,t,n){var i=e/255,r=t/255,o=n/255,a=Math.max(i,r,o),s=a-Math.min(i,r,o);return{h:0===s?0:a===i?(r-o)/s*60%6:a===r?60*((o-i)/s+2):60*((i-r)/s+4),s:0===a?0:s/a,v:a}}},{key:"separateRGBNumber",value:function(e){return[e>>16&255,e>>8&255,255&e]}}]),e}();function lo(e){var t=e.toString(16);return 1===t.length?"0"+t:t}!function(e){e.PLAIN="text/plain",e.HTML="text/html",e.FILES="Files"}(so||(so={}));var ho="module-license-info",fo=["html","a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],go=document.createElement("div");function vo(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=mo(e,n);return go.innerHTML=r.trim(),go.firstChild}function po(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=mo(e,n);return go.innerHTML=r.trim(),Array.from(go.childNodes)}function mo(e,t){return t.reduce((function(t,n,i){return t+n+e[i+1]}),e[0])}function yo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=document.createElement(e);for(var r in t)i.setAttribute(r,t[r]+"");return n.forEach((function(e){i.appendChild(e)})),i}var ko="change",bo="update",wo=function(e){(0,_._)(n,e);var t=(0,P._)(n);function n(){var e;return(0,c._)(this,n),e=t.call(this),(0,g._)((0,zt._)(e),"store",new hi),e.addDestroyHook(e.store),e.store.filter((function(){return!e.isDestroyed})),e}return(0,l._)(n,[{key:"onChange",value:function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.store.subscribeOnce(ko,(function(t){return e(t)})):this.store.subscribe(ko,(function(t){return e(t)}))}},{key:"onUpdate",value:function(e){return this.store.subscribe(bo,(function(){return e()}))}},{key:"handle",value:function(e){this.store.dispatch(ko,e)}},{key:"update",value:function(){return this.store.dispatch(bo,null)}}]),n}(ai),_o=n(342);function Po(){var e,t="rgb(31,41,59)",n=document.createElement("div");n.style.color=t,document.body.appendChild(n);try{return(e=n,document.defaultView?document.defaultView.getComputedStyle(e):e.currentStyle).color.replace(/ /g,"")!==t}finally{document.body.removeChild(n)}}function Ao(){var e=document,t=e.mozFullscreen||e.webkitIsFullScreen||e.fullscreen;return X?kt?!!e.webkitCurrentFullScreenElement:t:t||window.innerHeight===window.screen.height&&window.innerWidth===window.screen.width}function So(e,t){var n=Array.from(e.childNodes.values());n.forEach((function(i,r){t.includes(i)||(e.removeChild(i),n.splice(r,1))})),t.forEach((function(i,r){if(i&&n[r]!==i){var o,a,s,u,c,l=n.indexOf(i),d=t[r-1];-1===l?(d?(c=d).getComponent&&"string"==typeof c.getComponent().attrs.slot?d.appendChild(i):d.after(i):e.prepend(i),n.splice(r,0,i)):r<n.length?(i.before(n[r]),s=l,u=(o=n)[a=r],o[a]=o[s],o[s]=u,d?d.after(i):e.prepend(i)):(n.push(i),e.appendChild(i))}}))}var xo="#9E3ABF",Co={"accent-color":{varKey:"--fv-accent-color",defaultValue:xo,referenceValue:"#923094"},"accent-fill":{varKey:"--fv-accent-fill-color",defaultValue:xo,referenceValue:"#923094"},"btn-color":{varKey:"--fv-btn-color",defaultValue:xo,referenceValue:xo},border:{varKey:"--fv-btn-border-color",defaultValue:xo,referenceValue:"#9E3ABF"},"hover-color":{varKey:"--fv-btn-hover-color",defaultValue:xo,referenceValue:xo},"border-hover":{varKey:"--fv-btn-border-hover-color",defaultValue:xo,referenceValue:"#f9e3fa"},"pressed-bg":{varKey:"--fv-btn-pressed-bg",defaultValue:xo,referenceValue:"#9432AC"},"disabled-bg":{varKey:"--fv-btn-disabled-bg",defaultValue:xo,referenceValue:"#70289B"},"border-disabled-color":{varKey:"--fv-btn-border-disabled-color",defaultValue:xo,referenceValue:"#70289B"},"focus-bg":{varKey:"--fv-btn-focus-bg",defaultValue:xo,referenceValue:"#9E3ABF"},"border-pressed":{varKey:"--fv-btn-border-pressed-color",defaultValue:xo,referenceValue:"#D4A1E5"},"outline-focus-color":{varKey:"--fv-btn-outline-focus-color",defaultValue:xo,referenceValue:"#9E3ABF"},"outline-color":{varKey:"--fv-btn-outline-color",defaultValue:xo,referenceValue:"#9E3ABF"},"accent-btn-bg":{varKey:"--fv-accent-btn-bg",defaultValue:xo,referenceValue:"#9E3ABF"},"accent-btn-border-color":{varKey:"--fv-accent-btn-border-color",defaultValue:xo,referenceValue:"#9E3ABF"},"accent-btn-hover-bg":{varKey:"--fv-accent-btn-hover-bg",defaultValue:xo,referenceValue:"#af40ca"},"accent-btn-border-hover-color":{varKey:"--fv-accent-btn-border-hover-color",defaultValue:xo,referenceValue:"#af40ca"},"accent-btn-pressed-bg":{varKey:"--fv-accent-btn-pressed-bg",defaultValue:xo,referenceValue:"#9432AC"},"accent-btn-border-pressed-color":{varKey:"--fv-accent-btn-border-pressed-color",defaultValue:xo,referenceValue:"#9432AC"},"accent-btn-disabled-bg":{varKey:"--fv-accent-btn-disabled-bg",defaultValue:xo,referenceValue:"#70289B"},"accent-btn-disabled-color":{varKey:"--fv-accent-btn-disabled-color",defaultValue:xo,referenceValue:"#AF57CC"},"accent-btn-border-disabled-color":{varKey:"--fv-accent-btn-border-disabled-color",defaultValue:xo,referenceValue:"#70289B"},"accent-btn-focus-bg":{varKey:"--fv-accent-btn-focus-bg",defaultValue:xo,referenceValue:"#9E3ABF"},"accent-btn-border-focus-color":{varKey:"--fv-accent-btn-border-focus-color",defaultValue:xo,referenceValue:"#9E3ABF"}},Do="#333333",Eo={background:{varKey:["--File_page_content_BG","--fv-primary-bg"],defaultValue:Do,referenceValue:Do},secondary:{varKey:"--fv-secondary-bg",defaultValue:Do,referenceValue:"#424242"},content:{varKey:"--fv-content-bg",defaultValue:Do,referenceValue:"#242424"},"hide-show":{varKey:"--fv-hide-show-bg",defaultValue:Do,referenceValue:"#131313"},hover:{varKey:"--fv-hover-bg",defaultValue:Do,referenceValue:"#515151"},active:{varKey:"--fv-active-bg",defaultValue:Do,referenceValue:"#424242"},input:{varKey:"--fv-input-bg",defaultValue:Do,referenceValue:"#242424"},footer:{varKey:"--fv-footer-bg",defaultValue:Do,referenceValue:"#131313"}},Io="#666666",Ro={border:{varKey:"--fv-border-color",defaultValue:Io,referenceValue:Io},frame:{varKey:"--fv-frame-border-color",defaultValue:Io,referenceValue:"#131313"},tab:{varKey:"--fv-doc-tab-border-color",defaultValue:Io,referenceValue:"#242424"},"tab-active":{varKey:"--fv-doc-tab-border-active-color",defaultValue:Io,referenceValue:"#131313"},"spacing-line-primary":{varKey:"--fv-spacing-line-primary-color",defaultValue:Io,referenceValue:"#131313"},"spacing-line-secondary":{varKey:"--Spacing_line",defaultValue:Io,referenceValue:"#242424"},"spacing-line-tertiary":{varKey:"--fv-spacing-line-tertiary-color",defaultValue:Io,referenceValue:"#424242"},input:{varKey:"--fv-input-border-color",defaultValue:Io,referenceValue:"#515151"}},To={link:{varKey:"--fv-link-color",defaultValue:"#99EBFF",referenceValue:"#99EBFF"}},Fo="#E3E3E3",Mo={primary:{varKey:["--fv-primary-color","--fv-ribbon-name-text"],defaultValue:Fo,referenceValue:Fo},secondary:{varKey:"--fv-secondary-color",defaultValue:Fo,referenceValue:"#F7F7F7"},placeholder:{varKey:"--fv-placeholder-color",defaultValue:Fo,referenceValue:"#ACACAC"},disable:{varKey:"--fv-disable-color",defaultValue:Fo,referenceValue:"#8B8B8B"},introductory:{varKey:"--fv-introductory-color",defaultValue:Fo,referenceValue:"#BDBDBD"}},Oo={primary:"primary",background:"brackground",border:"border",link:"link",text:"text"},Lo=new Map,No={primary:Co,background:Eo,border:Ro,link:To,text:Mo};function Vo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{dom,colors}];Lo.clear(),e.forEach((function(e){var t=e.dom,n=e.colors;if(n){var i=t||document.body;Object.keys(n).forEach((function(e){return function(e,t,n){if(!t)return void Object.keys(n).forEach((function(t){var i=n[t].varKey;Array.isArray(i)?i.forEach((function(t){e.style.removeProperty(t)})):e.style.removeProperty(i)}));var i=(0,_o.$j)(t,"RGB");i.shift(),Object.keys(n).forEach((function(r){var o=n[r],a=o.varKey,s=o.defaultValue,u=o.referenceValue;Array.isArray(a)?a.forEach((function(n){e.style.setProperty(n,s!==u?jo.apply(void 0,(0,h._)(i).concat([Bo(s,u)])):t)})):e.style.setProperty(a,s!==u?jo.apply(void 0,(0,h._)(i).concat([Bo(s,u)])):t)}))}(i,n[e],No[e])}))}}))}function Bo(e,t){var n="".concat(e,"-").concat(t);if(Lo.get(n))return Lo.get("".concat(e,"-").concat(t));var i=(0,_o.$j)(e,"RGB"),r=(0,_o.$j)(t,"RGB"),o={r:i[1]/r[1],g:i[2]/r[2],b:i[3]/r[3]};return Lo.set(n,o),o}function jo(e,t,n,i){var r=i.r,o=i.g,a=i.b,s=["RGB",Uo(e/r),Uo(t/o),Uo(n/a)];return(0,_o.$j)(s,"HTML")}function Uo(e){return e>1?1:e}function Ho(e){return Pr("HTMLElement").some((function(t){return(0,d._)(e,t)}))}function Wo(e){return Pr("document").indexOf(e)>=0}function Yo(e,t){(0,d._)(e,HTMLInputElement)||(0,d._)(e,HTMLTextAreaElement)?Ko(e,t):"inherit"!==e.contentEditable&&zo(e,t)}function qo(e,t,n){(0,d._)(e,HTMLInputElement)||(0,d._)(e,HTMLTextAreaElement)?$o(e,t,n):"inherit"!==e.contentEditable&&zo(e,n,t)}function Ko(e,t){var n=(0,d._)(e,HTMLInputElement)?e.value.length:e.textLength;$o(e,{startOffset:n,endOffset:n},t)}function $o(e,t,n){e.focus(n),setTimeout((function(){e.focus(n),e.setSelectionRange(t.startOffset,t.endOffset)})),e.setSelectionRange(t.startOffset,t.endOffset)}function zo(e,t,n){e.focus(t),setTimeout((function(){return e.focus(t)}));var i=document.createRange();if(i.selectNodeContents(e),n){var r,o=e.childNodes[n.startNodeIndex||0];if(o)i.setStart(o,Math.min(n.startOffset,(null===(r=o.textContent)||void 0===r?void 0:r.length)||0));var a,s=e.childNodes[n.endNodeIndex||0];if(s)i.setStart(s,Math.min(n.endOffset,(null===(a=o.textContent)||void 0===a?void 0:a.length)||0))}i.collapse(!0);var u=window.getSelection();u&&(u.removeAllRanges(),u.addRange(i))}function Go(e){var t=window.getSelection();if(null==t?void 0:t.rangeCount){var n=t.getRangeAt(0);if(e.contains(n.startContainer)&&e.contains(n.endContainer))return{startNodeIndex:i(n.startContainer),endNodeIndex:i(n.endContainer),startOffset:n.startOffset,endOffset:n.endOffset}}return null;function i(t){for(var n=t;n&&n.parentElement!==e;)n=n.parentNode;return Array.from(e.childNodes).indexOf(n)}}function Jo(e,t){return{startCursorIndex:n(e.startNodeIndex||0,e.startOffset),endCursorIndex:n(e.endNodeIndex||0,e.endOffset)};function n(e,n){return Array.from(t.childNodes).slice(0,e).reduce((function(e,t){var n;return(0,d._)(t,HTMLBRElement)?e+1:e+((null===(n=t.textContent)||void 0===n?void 0:n.length)||0)}),0)+n}}function Xo(e,t){for(var n=0,i=e,r=Array.from(t.childNodes),o=0,a=0;a<r.length;a++){var s,u=r[a],c=(0,d._)(u,HTMLBRElement)?1:(null===(s=u.textContent)||void 0===s?void 0:s.length)||0;if(0!==a){if(i<=o){n=a;break}i-=o}else o=c}return i>o&&(i=o),{nodeIndex:n,offset:i}}var Zo=function e(){var t=this;(0,c._)(this,e),(0,g._)(this,"promise",void 0),(0,g._)(this,"resolve",void 0),(0,g._)(this,"reject",void 0),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))};function Qo(e){var t=so.PLAIN,n=so.HTML,i=so.FILES,r=[],o=e.clipboardData,a=v();if(o&&o.items){var s=o.items,u=o.types,c=u[0],l=0;if(u.length>1){var d=u.indexOf(n);d>-1&&(l=d,c=n)}switch(c){case t:s[l].getAsString((function(e){var t;try{if("number"==typeof(t=JSON.parse(e)))throw new Error("Pure number")}catch(n){t=[{type:"string",value:e}]}t.some((function(e){var t=e.value;return"string"===e.type&&"widget"===t.type&&7===t.fieldType}))||(r=t,a.resolve(r))}));break;case n:var h=o.getData(n);h&&(r=[{type:"html",value:h}]),a.resolve(r);break;case i:var f=s[l].getAsFile();f&&(r=[{type:"file",value:f}]),a.resolve(r)}}return a.promise}var ea=n(3214),ta=n.n(ea)().PointerEventInput;function na(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ta.apply(this,t)}function ia(e){return e}na.prototype=Object.create(ta.prototype,{init:{value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=this.domHandler;return this.domHandler=function(e){if(e.isTrusted)return i.call(this,e)},ta.prototype.init.apply(this,t)}}});var ra=n(6448),oa=n(7582),aa=document.createElement("textarea");function sa(){return ua.apply(this,arguments)}function ua(){return(ua=(0,ra._)((function(){return(0,oa.Jh)(this,(function(e){switch(e.label){case 0:if(wt)return[2,!1];if(!navigator.permissions)return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,navigator.permissions.query({name:"clipboard-write"})];case 2:return[2,"granted"===e.sent().state];case 3:return e.sent(),[2,!1];case 4:return[2]}}))}))).apply(this,arguments)}function ca(){return la.apply(this,arguments)}function la(){return(la=(0,ra._)((function(){return(0,oa.Jh)(this,(function(e){switch(e.label){case 0:return navigator.clipboard?[4,sa()]:[3,2];case 1:return e.sent()?[2,navigator.clipboard.readText()]:[2,da()];case 2:return[2,da()];case 3:return[2]}}))}))).apply(this,arguments)}function da(){var e=document.activeElement||aa;"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&(e=aa),e===aa&&(document.body.appendChild(aa),e.focus());var t=e.value;e.value="";try{return document.execCommand("paste")?e.value:Promise.reject("Unable to read from clipboard")}catch(e){return Promise.reject("Unable to read from clipboard")}finally{e.value=t,document.body.removeChild(aa)}}aa.style.cssText+="\n    position: fixed;\n    top: -9999px;\n    left: -9999px;\n    width: 1px;\n    height: 1px;\n    padding: 0;\n    border: none;\n    outline: none;\n    opacity: 0.1;\n";var ha={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},fa=va(ha),ga={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":"","&iexcl;":"¡","&cent;":"¢","&pound;":"£","&curren;":"¤","&yen;":"¥","&brvbar;":"¦","&sect;":"§","&uml;":"¨","&copy;":"©","&ordf;":"ª","&laquo;":"«","&not;":"¬","&shy;":"­","&reg;":"®","&macr;":"¯","&deg;":"°","&plusmn;":"±","&sup2;":"²","&sup3;":"³","&acute;":"´","&micro;":"µ","&para;":"¶","&cedil;":"¸","&sup1;":"¹","&ordm;":"º","&raquo;":"»","&frac14;":"¼","&frac12;":"½","&frac34;":"¾","&iquest;":"¿","&times;":"×","&divide;":"÷","&forall;":"∀","&part;":"∂","&exist;":"∃","&empty;":"∅","&nabla;":"∇","&isin;":"∈","&notin;":"∉","&ni;":"∋","&prod;":"∏","&sum;":"∑","&minus;":"−","&lowast;":"∗","&radic;":"√","&prop;":"∝","&infin;":"∞","&ang;":"∠","&and;":"∧","&or;":"∨","&cap;":"∩","&cup;":"∪","&int;":"∫","&there4;":"∴","&sim;":"∼","&cong;":"≅","&asymp;":"≈","&ne;":"≠","&equiv;":"≡","&le;":"≤","&ge;":"≥","&sub;":"⊂","&sup;":"⊃","&nsub;":"⊄","&sube;":"⊆","&supe;":"⊇","&oplus;":"⊕","&otimes;":"⊗","&perp;":"⊥","&sdot;":"⋅","&Alpha;":"Α","&Beta;":"Β","&Gamma;":"Γ","&Delta;":"Δ","&Epsilon;":"Ε","&Zeta;":"Ζ","&Eta;":"Η","&Theta;":"Θ","&Iota;":"Ι","&Kappa;":"Κ","&Lambda;":"Λ","&Mu;":"Μ","&Nu;":"Ν","&Xi;":"Ξ","&Omicron;":"Ο","&Pi;":"Π","&Rho;":"Ρ","&Sigma;":"Σ","&Tau;":"Τ","&Upsilon;":"Υ","&Phi;":"Φ","&Chi;":"Χ","&Psi;":"Ψ","&Omega;":"Ω","&alpha;":"α","&beta;":"β","&gamma;":"γ","&delta;":"δ","&epsilon;":"ε","&zeta;":"ζ","&eta;":"η","&theta;":"θ","&iota;":"ι","&kappa;":"κ","&lambda;":"λ","&mu;":"μ","&nu;":"ν","&xi;":"ξ","&omicron;":"ο","&pi;":"π","&rho;":"ρ","&sigmaf;":"ς","&sigma;":"σ","&tau;":"τ","&upsilon;":"υ","&phi;":"φ","&chi;":"χ","&psi;":"ψ","&omega;":"ω","&thetasym;":"ϑ","&upsih;":"ϒ","&piv;":"ϖ","&OElig;":"Œ","&oelig;":"œ","&Scaron;":"Š","&scaron;":"š","&Yuml;":"Ÿ","&fnof;":"ƒ","&circ;":"ˆ","&tilde;":"˜","&ensp;":"","&emsp;":"","&thinsp;":"","&zwnj;":"‌","&zwj;":"‍","&lrm;":"‎","&rlm;":"‏","&ndash;":"–","&mdash;":"—","&lsquo;":"‘","&rsquo;":"’","&sbquo;":"‚","&ldquo;":"“","&rdquo;":"”","&bdquo;":"„","&dagger;":"†","&Dagger;":"‡","&bull;":"•","&hellip;":"…","&permil;":"‰","&prime;":"′","&Prime;":"″","&lsaquo;":"‹","&rsaquo;":"›","&oline;":"‾","&euro;":"€","&trade;":"™","&larr;":"←","&uarr;":"↑","&rarr;":"→","&darr;":"↓","&harr;":"↔","&crarr;":"↵","&lceil;":"⌈","&rceil;":"⌉","&lfloor;":"⌊","&rfloor;":"⌋","&loz;":"◊","&spades;":"♠","&clubs;":"♣","&hearts;":"♥","&diams;":"♦"};va(ga);function va(e){return Object.keys(e).reduce((function(t,n){return t[e[n]]=n,t}),{})}function pa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";if(!e)return e;for(var n=e.replace(/[^\x09\x0A\x0D\x20-\uD7FF\uE000-\uFFFD]/g,t),i=String.fromCharCode(55296);;){var r=n.indexOf(i);if(-1===r)break;n=n.replace(n.substring(r,r+2),t)}return n}function ma(e){if(!e)return e;var t=e.replace(/&/g,(function(e,t,n){return/^#?(\d+)|([a-z]+);/i.test(n.substr(t+1))?e:"&amp;"})).replace(new RegExp(Object.keys(fa).join("|"),"g"),(function(e){return"&"===e?e:fa[e]}));return pa(t.replace(/\&[^;#]+;/g,(function(e){return(e=e.toLowerCase())in ha?e:e in ga?ga[e]:e.replace("&","&amp;")}))," ")}},6537:(e,t,n)=>{"use strict";n.r(t),n.d(t,{active3DHandle:()=>g,agreeActive3D:()=>S,destroy3DInteraction:()=>w,initJR3DAnnot:()=>b,render3D:()=>p,setAnnot3DTool:()=>P,setDefaultView:()=>A});var i=n(6448),r=n(6699),o=n(7582),a=n(6118),s=n(4157),u=n(4375),c=n(6721),l=function(){};!function(){function e(){(0,u._)(this,e),this._queue=[],this._initPromise()}(0,c._)(e,[{key:"_initPromise",value:function(){var e=this;return!this._promiseIsEnd&&this.promise||(this.promise=new Promise((function(t,n){var i=e;e._resolve=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];i._promiseIsEnd=!0,t.apply(void 0,(0,r._)(n))},e._reject=function(t){e._promiseIsEnd=!0,e._queue=[],n(t)}})),this._promiseIsEnd=!1),this.promise}},{key:"assign",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._queue=e}},{key:"push",value:function(e,t){this._queue.push([e,t])}},{key:"start",value:function(){var e=this._initPromise();return this._exec(),e}},{key:"_exec",value:function(){var e=this;if(!this._execIng){this._execIng=!0;var t,n=this._queue,i=n.shift()||[l];try{t=Promise.resolve(i[0]())}catch(t){try{return Promise.resolve(i[1](t)).then((function(){e._reject(t)}))}catch(e){return this._reject(t)}}t.then((function(t){if(e._execIng=!1,!n.length)return e._resolve(t);e._exec()}),(function(t){return e._reject(t)}))}}},{key:"end",value:function(){return this._queue=[],this._exec(),this.promise}}])}();var d=n(3214),h=n.n(d),f={rotate:0,spin:1,pan:2,zoom:3};function g(e,t){return v.apply(this,arguments)}function v(){return v=(0,i._)((function(e,t){var n,a,u,c,l,d,f;return(0,o.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.agreeActive3D()];case 1:if(!t.sent())return[2];n=e.annot,e.isActived3DHandleLoaded=!0,e.isActive3D=!0,a=e.parent().$handler,u=function(e,t,n){var i,o=e.e3DTarget;if(o)return{eTarget:o,eCanvas:e._e3DCanvas};o=document.createElement("div"),o.id="fv__pdf-page-3d-annot-interaction-handler-".concat(n),o.className="fv__pdf-page-3d-annot-interaction-handler";var a=document.createElement("canvas"),s=a.transferControlToOffscreen(),u=e.annot.page.doc.engine;return(i=u.api).setCanvas.apply(i,[{path:"jr/doc/3d",clientTransfer:[s]}].concat((0,r._)(k(e)),[s])),a.className="fv__pdf-page-3d-annot-interaction-canvas",o.appendChild(a),t.appendChild(o),e._e3DCanvas=a,e.e3DTarget=o,{eTarget:o,eCanvas:a}}(e,a[0],n.getId()),c=u.eTarget,l=u.eCanvas,t.label=2;case 2:return t.trys.push([2,4,,5]),[4,p(e,e.scale,e.rotate)];case 3:return t.sent(),function(e,t,n){if(e.off3DInteraction)return;var r,a=new(h().Manager)(n);a.add(new(h().Pan)),a.add(new(h().Press));var u=-1,c=new s.ThrottleAsyncTaskExecutor(50,!0),l=function(e,t,n,r){var a;c.exec((a=(0,i._)((function(i){return(0,o.Jh)(this,(function(i){switch(i.label){case 0:return[4,_(e,t,n,r)];case 1:return i.sent(),[2]}}))})),function(e){return a.apply(this,arguments)}))};a.on("panstart",(function(t){u=0,r=t.srcEvent.target.getBoundingClientRect(),l(e,t,1,r)})),a.on("panmove",(function(t){-1!==u&&2!==u&&(u=1,l(e,t,0,r))})),a.on("panend",(function(t){-1!==u&&(u=2,l(e,t,2,r))}));var d=function(t){e.showContextMenu()},f=function(t){e.showToolbar()},g=function(t){e.hideToolbar()};a.on("press",d),t.addEventListener("contextmenu",d),t.addEventListener("mouseover",f),t.addEventListener("mouseout",g),s.isTouchDevice&&t.addEventListener("touchstart",f);e.off3DInteraction=function(){a.off("panstart"),a.off("panmove"),a.off("panend"),a.off("press"),t.removeEventListener("contextmenu",d),t.removeEventListener("mouseover",f),t.removeEventListener("mouseout",g),s.isTouchDevice&&t.addEventListener("touchstart",f),a.destroy(),e.off3DInteraction=null}}(e,c,l),[3,5];case 4:return d=t.sent(),e.isActive3D=!1,(null==d||null===(f=d.message)||void 0===f?void 0:f.includes("Method not permission."))&&e.pdfViewer.setEnable3DInteraction(!1),[3,5];case 5:return[2]}}))})),v.apply(this,arguments)}function p(e,t,n){return m.apply(this,arguments)}function m(){return m=(0,i._)((function(e,t,n){var i,r,s,u;return(0,o.Jh)(this,(function(o){switch(o.label){case 0:return e._e3DCanvas&&(i=e.e3DTarget)?(r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.scale,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.scale,i=e.annot,r=(0,a.oC)(t),o=i.getDeviceRect(r,0),s=i.getDeviceRect(t,n);return{smartRect:o,showRect:s}}(e,t,n),s=r.smartRect,function(e,t){t.style.cssText="z-index:999;position:absolute;top:".concat(e.top,"px;left:").concat(e.left,"px;width:").concat(e.right-e.left,"px;height:").concat(e.bottom-e.top,"px;")}(r.showRect,i),(u=e.parent().$handler.addClass("active")[0])&&(u.style.transform=null),[4,y(e,s)]):[2];case 1:return o.sent(),[2,!0]}}))})),m.apply(this,arguments)}function y(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.rotate;return(n=e.annot.page.doc.engine.api).LoadAnnot3DBitmap.apply(n,[{path:"jr/doc/3d",transfer:["bitmap"]}].concat((0,r._)(k(e)),[t,i]))}function k(e){var t=e.annot,n=e.getPDFPage();return[n.getPDFDoc().getId(),n.getIndex(),t.getId()]}function b(e){if(e._ready3DPromise)return e._ready3DPromise;var t=e.annot.page.doc.engine;return e._ready3DPromise=t.api.getPDF3D({path:"jr/doc"},e.getPDFPage().getPDFDoc().getId())}function w(e){e.off3DInteraction&&(e.off3DInteraction(),e.off3DInteraction=null),e._interactionHammer&&(e._interactionHammer.destroy(),e._interactionHammer=null),e.isActive3D=!1}function _(e,t,n,i){var o,a=t.srcEvent,s={movementX:t.deltaX,movementY:t.deltaY,timeStamp:a.timeStamp,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey,metaKey:a.metaKey,button:a.button,buttons:a.buttons,targetX:a.clientX-i.left,targetY:a.clientY-i.top,canvasX:a.clientX-i.left,canvasY:a.clientX-i.left};return(o=e.annot.page.doc.engine.api).process3DMouseEvent.apply(o,[{path:"jr/doc/3d"}].concat((0,r._)(k(e)),[s,n]))}function P(e,t){var n;return(n=e.annot.page.doc.engine.api).setAnnot3DTool.apply(n,[{path:"jr/doc/3d"}].concat((0,r._)(k(e)),[f[t]||0]))}function A(e){var t;return(t=e.annot.page.doc.engine.api).setDefaultView.apply(t,[{path:"jr/doc/3d"}].concat((0,r._)(k(e)))).then((function(){return p(e,e.scale,e.rotate)}))}function S(e){return!0}},6118:(e,t,n)=>{"use strict";n.d(t,{ke:()=>v,oC:()=>g,F2:()=>f});var i=n(4157);n(8469);var r=n(4375),o=n(6721),a=n(5136),s=n(3638);var u,c=function(){function e(t){(0,r._)(this,e),(0,a._)(this,"values",void 0),(0,a._)(this,"cols",void 0),(0,i.assertThat)(Array.isArray(t),"Illegal Matrix values, it should be an array! But actual: "+t),(0,i.assertThat)(16===t.length,"Incorrect matrix values size, it must be 16!"),this.values=t,this.cols=Math.sqrt(t.length)}return(0,o._)(e,[{key:"multiVec4",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[this.getAt(0,0)*e+this.getAt(0,1)*t+this.getAt(0,2)*n+this.getAt(0,3)*i,this.getAt(1,0)*e+this.getAt(1,1)*t+this.getAt(1,2)*n+this.getAt(1,3)*i,this.getAt(2,0)*e+this.getAt(2,1)*t+this.getAt(2,2)*n+this.getAt(2,3)*i,this.getAt(3,0)*e+this.getAt(3,1)*t+this.getAt(3,2)*n+this.getAt(3,3)*i]}},{key:"getAt",value:function(e,t){var n=e*this.cols+t;return(0,i.assertThat)(n<this.values.length,"Cannot access value at (".concat(e,",").concat(t,"), it out bound of this matrix!")),this.values[n]}}]),e}(),l=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,r._)(this,e),(0,a._)(this,"a",void 0),(0,a._)(this,"b",void 0),(0,a._)(this,"c",void 0),(0,a._)(this,"d",void 0),this.a=t,this.b=n,this.c=i,this.d=o}return(0,o._)(e,[{key:"transform",value:function(t){var n=(0,s._)(t.multiVec4(this.a,this.b,this.c,this.d),4);return new e(n[0],n[1],n[2],n[3])}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.transform(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return new c([e,0,0,0,0,t,0,0,0,0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,0,0,0,0,1])}(e,t,n))}},{key:"rotateZ",value:function(e){return this.transform(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/180*Math.PI,t=Math.cos(e),n=Math.sin(e);return new c([t,n,0,0,-n,t,0,0,0,0,1,0,0,0,0,1])}(e))}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.transform(function(e){return new c([1,0,0,e,0,1,0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,0,0,1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,0,0,0,1])}(e,t,n))}}]),e}(),d=72;function h(e){return function(){if(!u){var e=(0,i.getDPI)();u=[e.x,e.y]}return u}()[e]}function f(e){return e*h(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/d}function g(e){return e*i.dpr}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=new l(e,t,0).scale(n).rotateZ(i);return[Math.round(Math.abs(r.a)),Math.round(Math.abs(r.b))]}},5222:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(4375);const r=function e(t){(0,i._)(this,e),this.option=t}},8469:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(4375),r=n(6721),o=n(7327);const a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if((0,i._)(this,e),"function"==typeof t.transformRect){var u=t;t=u.a,n=u.b,r=u.c,o=u.d,a=u.e,s=u.f}else if(Array.isArray(t)){var c=t;t=c[0],n=c[1],r=c[2],o=c[3],a=c[4],s=c[5]}this.a=t,this.b=n,this.c=r,this.d=o,this.e=a,this.f=s}return(0,r._)(e,[{key:"set",value:function(e,t,n,i,r,o){this.a=e,this.b=t,this.c=n,this.d=i,this.e=r,this.f=o}},{key:"reset",value:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0}},{key:"reverse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=t.a*t.d-t.b*t.c;if(0==n)return t;var i=-n;return new e(t.d/n,t.b/i,t.c/i,t.a/n,(t.c*t.f-t.d*t.e)/n,(t.a*t.f-t.b*t.e)/i)}},{key:"setReverse",value:function(e){var t=this.reverse(e);this.set(t.a,t.b,t.c,t.d,t.e,t.f)}},{key:"rotate",value:function(t,n){var i,r=Math.cos(t),o=Math.sin(t),a=new e(r,o,-o,r,0,0);i=n?e.Concat2mt(a,this):e.Concat2mt(this,a),this.set(i.a,i.b,i.c,i.d,i.e,i.f)}},{key:"rotateAt",value:function(e,t,n,i){this.translate(e,t,i),this.rotate(n,i),this.translate(-e,-t,i)}},{key:"translate",value:function(e,t,n){n?(this.e+=e*this.a+t*this.c,this.f+=t*this.d+e*this.b):(this.e+=e,this.f+=t)}},{key:"concat",value:function(t,n,i,r,a,s,u){var c,l;(0,o._)(t,e)?(c=t,u=n):c=new e(t,n,i,r,a,s),l=u?e.Concat2mt(c,this):e.Concat2mt(this,c),this.set(l.a,l.b,l.c,l.d,l.e,l.f)}},{key:"is90Rotated",value:function(){var e=1e3*this.a;e<0&&(e*=-1);var t=1e3*this.d;t<0&&(t*=-1);var n=this.b;n<0&&(n*=-1);var i=this.c;return i<0&&(i*=-1),e<n&&t<i}},{key:"isScaled",value:function(){var e=1e3*this.b;e<0&&(e*=-1);var t=1e3*this.c;t<0&&(t*=-1);var n=this.a;n<0&&(n*=-1);var i=this.d;return i<0&&(i*=-1),e<n&&t<i}},{key:"getA",value:function(){return this.a}},{key:"getB",value:function(){return this.b}},{key:"getC",value:function(){return this.c}},{key:"getD",value:function(){return this.d}},{key:"getE",value:function(){return this.e}},{key:"getF",value:function(){return this.f}},{key:"scale",value:function(e,t,n){this.a*=e,this.d*=t,n?(this.b*=e,this.c*=t):(this.b*=t,this.c*=e,this.e*=e,this.f*=t)}},{key:"transformXDistance",value:function(e){var t=this.a*e,n=this.b*e;return Math.sqrt(t*t+n*n)}},{key:"transformYDistance",value:function(e){var t=this.c*e,n=this.d*e;return Math.sqrt(t*t+n*n)}},{key:"transformDistance",value:function(e,t){var n=this.a*e+this.c*t,i=this.b*e+this.d*t;return Math.sqrt(n*n+i*i)}},{key:"transformPoint",value:function(e,t){return[this.a*e+this.c*t+this.e,this.b*e+this.d*t+this.f]}},{key:"transformRect",value:function(e,t,n,i){for(var r,o=[e,e,n,n],a=[t,i,t,i],s=0;s<4;s++)r=this.transformPoint(o[s],a[s]),o[s]=r[0],a[s]=r[1];for(var u=[o[0],o[0],a[0],a[0]],c=1;c<4;c++)u[0]>o[c]&&(u[0]=o[c]),u[1]<o[c]&&(u[1]=o[c]),u[2]>a[c]&&(u[2]=a[c]),u[3]<a[c]&&(u[3]=a[c]);return[u[0],u[2],u[1],u[3]]}},{key:"getXUnit",value:function(){var e=this.a,t=this.b;return 0===t?Math.abs(e):0===e?Math.abs(t):Math.sqrt(e*e+t*t)}},{key:"getYUnit",value:function(){var e=this.c,t=this.d;return 0===e?Math.abs(t):0===t?Math.abs(e):Math.sqrt(e*e+t*t)}},{key:"getUnitRect",value:function(){return this.transformRect(0,0,1,1)}},{key:"matchRect",value:function(e,t){var n=t[0]-t[2];this.a=Math.abs(n)<.001?1:(e[0]-e[2])/n,n=t[3]-t[1],this.d=Math.abs(n)<.001?1:(e[3]-e[1])/n,this.e=e[0]-t[0]*this.a,this.f=e[3]-t[3]*this.d,this.b=0,this.c=0}},{key:"getAngle",value:function(){return Math.atan2(this.b,this.a)}},{key:"toArray",value:function(){return[this.a,this.b,this.c,this.d,this.e,this.f]}}],[{key:"Concat2mt",value:function(t,n){return new e(t.a*n.a+t.b*n.c,t.a*n.b+t.b*n.d,t.c*n.a+t.d*n.c,t.c*n.b+t.d*n.d,t.e*n.a+t.f*n.c+n.e,t.e*n.b+t.f*n.d+n.f)}}]),e}()},8095:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(4375),r=n(6721),o=n(7327),a=n(4157),s=function(){};const u=function(){function e(t){(0,i._)(this,e);this.cacheMap={},this.callMap={},this.listeners={};this.setWorker(t),this.promises=[],this.workflow={out:[]},this._isIE10=a.isIE10,this.isDestroyed=!1}return(0,r._)(e,[{key:"destroy",value:function(){this.isDestroyed||(this.isDestroyed=!0,this.worker&&this.worker.terminate())}},{key:"setWorker",value:function(e){var t=this,n=this.cacheMap,i=this.callMap,r=this.listeners;this.worker=e,e.onmessage=function(a){var u=a.data;if(u.workflow){var c=t.workflow[u.workflow];return c?c.forEach((function(e){return e(u)})):void 0}var l=u.destroyId;if(l)delete i[l];else{var d=u.params;if(u.uiListener){var h=r[u.uiListener];if(h)for(var f=0,g=h.length;f<g;f++)h[f](d)}else{var v=u.callId;if(v)Promise.resolve((i[v]||s)(d)).then((function(n){var i=(0,o._)(n,ArrayBuffer)?[n]:[];t._isIE10&&(i=null),e.postMessage({backId:u.backId,params:n},i)}));else{var p=u.id,m=n[p];delete n[p];var y=+u.type;try{m&&m[["resolve","reject"][y]](d)}catch(e){0}setTimeout((function(){if(Object.keys(n).length<1){var e=t.listeners.idle;e&&e.forEach((function(e){return e()}));var i=t.listeners.reset;i&&i.forEach((function(e){return e()}))}}),0)}}}},e.onerror=function(e){console.error("WorkerError",e)}}},{key:"emit",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._isIE10&&(i=i[0]);var o=t&&t[0];return"object"==typeof o&&"clientTransfer"in o&&(i=o.clientTransfer),new Promise((function(o,s){var u=(0,a.getUniqueId)("worker");n.cacheMap[u]={resolve:o,reject:s};try{n.worker.postMessage({name:e,params:t,id:u,more:r},i)}catch(i){n.worker.postMessage({name:e,params:t,id:u,more:r})}}))}},{key:"calls",value:function(e){var t=(0,a.getUniqueId)("worker_call");return this.callMap[t]=e,t}},{key:"releaseCall",value:function(e){delete this.callMap[e]}},{key:"once",value:function(e,t){var n=this,i=arguments,r=this.listeners[e]=this.listeners[e]||[],o=function(){t.apply(n,i),n.off(e,o)};return r.push(o),function(){return n.off(e,o)}}},{key:"on",value:function(e,t){(this.listeners[e]=this.listeners[e]||[]).push(t)}},{key:"registerWorkflow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"out",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};this.workflow[e]?this.workflow[e].push(t):this.workflow[e]=[t]}},{key:"unregisterWorkflow",value:function(e,t){var n=this.workflow[e].indexOf(t);n>=0&&this.workflow[e].splice(n,1)}},{key:"off",value:function(e,t){var n=this.listeners[e];if(n){var i=n.indexOf(t);-1!=i&&n.splice(i,1)}}},{key:"over",value:function(e){}}]),e}()},302:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>P});var i=n(4375),r=n(6721),o=n(6147),a=n(216),s=n(4157),u=n(8490),c=n(7327),l=n(9307),d=n(6699),h=n(5222),f=n(8095);function g(e){var t=[];return(0,c._)(e,ArrayBuffer)&&(t=[e]),t}var v="FoxitPDFSDKForWeb_JREngineCache_",p=v+"wasmBinary",m=v+"asmMem",y=v+"asmJs",k={get:function(e,t,n){return void 0===e[t]?function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.workerPromise.emit(t,i)}:Reflect.get(e,t,n)}},b=function(e){(0,o._)(n,e);var t=(0,a._)(n);function n(e){var r,o;if((0,i._)(this,n),(r=t.call(this,e)).readyWorker=null,o=e.readyWorker){r.readyWorker=o,_(r.workerPromise=new f.Z(o.worker));var a=function(){e.licenseSN=e.licenseKey=e.l=""};return o.initJREnginePromise.then(a,a),(0,l._)(r)}var u=e.workerPath,c=e.workerBlobUrl;"/"!==u[u.length-1]&&(u+="/");var d=r.workerUrl=u+"WebPDFJRWorker.js?h=9df4163d945902b5ea6010aafa2483f8",h=c||d;h+="&dpr="+window.devicePixelRatio;var g=new Worker(h);return s.isIE&&(g.terminate(),g=new Worker(h)),_(r.workerPromise=new f.Z(g)),r}return(0,r._)(n,[{key:"setWorker",value:function(e){this.workerPromise.setWorker(e)}},{key:"registerWorkflow",value:function(e,t){this.workerPromise.registerWorkflow(e,t)}},{key:"unregisterWorkflow",value:function(e,t){this.workerPromise.unregisterWorkflow(e,t)}},{key:"init",value:function(){var e;if(e=this.readyWorker)return new Promise((function(t,n){return e.initJREnginePromise.then(t,n)}));var t,n={};(t=localStorage.getItem(p))&&(n.wasmBinary=t),(t=localStorage.getItem(m))&&(n.asmMem=t),(t=localStorage.getItem(y))&&(n.asmJs=t);var i=this.option,r=this.workerPromise;i.cache=n,i.compatibilityURL=r.calls((function(e){return URL.createObjectURL(e)})),i.d=location.href;var o=r.emit("initJREngine",i).then((function(e){return e}));return o.finally((function(){r.releaseCall(i.compatibilityURL)})),o}},{key:"once",value:function(e,t){return this.workerPromise.once(e,t)}},{key:"off",value:function(e,t){return this.workerPromise.off(e,t)}},{key:"handleGroupMarkup",value:function(e,t,n,i){return this.workerPromise.emit("handleGroupMarkup",{docId:e,pageId:t,annotIds:n,isGroup:i})}},{key:"continueProgress",value:function(e){return this.workerPromise.emit("progressContinue",{progressiveId:e})}},{key:"cancleProgress",value:function(e){return this.workerPromise.emit("cancleProgress",{progressiveId:e})}},{key:"getPDFDocIdByFile",value:function(e,t){var n=g(e);return this.workerPromise.emit("getPDFDocByFile",{file:e,option:t},n)}},{key:"createNewDoc",value:function(e,t,n){return this.workerPromise.emit("createNewDoc",{title:e,author:t,pageSize:n})}},{key:"createNewPortfolioDoc",value:function(e,t,n){var i=[e].concat((0,d._)(t||[]));return this.workerPromise.emit("createNewPortfolioDoc",{fileCoversheet:e,files:t,title:n},i)}},{key:"getPDFDocIdByChunk",value:function(e,t){var n=this,i=this.workerPromise.calls(t),r=this.workerPromise.emit("getPDFDocAsync",{size:e,getChunk:i});return r.finally((function(){n.workerPromise.releaseCall(i)})),r}},{key:"getPDFDocIdByHttpRangeRequest",value:function(e){return this.workerPromise.emit("getPDFDocIdByHttpRangeRequest",{size:e.size,range:e.range})}},{key:"getPDFDocIdByArrayBuffer",value:function(e){return this.workerPromise.emit("getPDFDocByArrayBuffer",{buffer:e},[e])}},{key:"setIcons",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.workerPromise.emit("setIcons",{icons:e})}},{key:"addIcon",value:function(e){return this.workerPromise.emit("addIcon",{icon:e})}},{key:"removeIcon",value:function(e,t,n){return this.workerPromise.emit("removeIcon",{type:e,catalog:t,name:n})}},{key:"checkCertificatePassword",value:function(e,t){return this.workerPromise.emit("checkCertificatePassword",{pfxFile:e,password:t})}},{key:"getCertificateInfo",value:function(e,t){return this.workerPromise.emit("getCertificateInfo",{file:e,password:t})}},{key:"createCertificateFile",value:function(e,t){return this.workerPromise.emit("createCertificateFile",{docId:e,info:t})}},{key:"getCertificateSerials",value:function(e){return this.workerPromise.emit("getCertificateSerials",{docId:e})}},{key:"parseByCertificate",value:function(e,t){return this.workerPromise.emit("parseByCertificate",{docId:e,info:t})}},{key:"parsePDFDocByPassword",value:function(e,t,n){var i=[],r=n.fdf;return r&&(0,c._)(r.file,ArrayBuffer)&&(i=[r.file]),this.workerPromise.emit("parsePDFDocByPassword",{id:e,password:t,initData:n},i)}},{key:"getPDFDocInfoById",value:function(e){return this.workerPromise.emit("getPDFDocInfoById",e)}},{key:"getMetadata",value:function(e){return this.workerPromise.emit("getMetadata",e)}},{key:"setMetadataValue",value:function(e,t,n){return this.workerPromise.emit("setMetadataValue",{id:e,key:t,value:n})}},{key:"getFileVersion",value:function(e){return this.workerPromise.emit("getFileVersion",e)}},{key:"isLinearized",value:function(e){return this.workerPromise.emit("isLinearized",{docId:e})}},{key:"loadForm",value:function(e){return this.workerPromise.emit("loadForm",{docId:e})}},{key:"updateFormControl",value:function(e,t,n,i,r){return this.workerPromise.emit("updateFormControl",{docId:e,fieldName:t,objectNumber:n,key:i,value:r})}},{key:"updateField",value:function(e,t,n,i){return this.workerPromise.emit("updateField",{docId:e,title:t,key:n,value:i})}},{key:"reloadFieldByName",value:function(e,t){return this.workerPromise.emit("reloadFieldByName",{docId:e,fieldName:t})}},{key:"updateMKProperty",value:function(e,t,n,i,r){return this.workerPromise.emit("updateMKProperty",{docId:e,pageId:t,annotId:n,key:i,value:r})}},{key:"setWidgetAS",value:function(e,t,n,i){return this.workerPromise.emit("setWidgetAS",{docId:e,pageId:t,annotId:n,AS:i})}},{key:"setFieldValue",value:function(e,t,n){return this.workerPromise.emit("setFieldValue",{docId:e,title:t,value:n})}},{key:"formFillerEvent",value:function(e,t,n,i){return this.workerPromise.emit("formFillerEvent",{docId:e,type:t,pageIndex:n,point:i})}},{key:"getFieldsValue",value:function(e){return this.workerPromise.emit("getFieldsValue",{docId:e})}},{key:"addControl",value:function(e,t,n,i,r,o){return this.workerPromise.emit("addControl",{docId:e,pageIndex:t,fieldName:n,fieldType:i,rect:r,options:o})}},{key:"addSignatureControlBatch",value:function(e,t,n){return this.workerPromise.emit("addSignatureControlBatch",{docId:e,signatureInfos:t,shareVDictType:n})}},{key:"createFieldByCopyControl",value:function(e,t,n,i,r,o,a,s){return this.workerPromise.emit("createFieldByCopyControl",{docId:e,pageIndex:t,fieldType:n,isImgFieldType:i,newFieldName:r,newRect:o,srcFieldName:a,srcObjectNumber:s})}},{key:"validateFieldName",value:function(e,t,n){return this.workerPromise.emit("validateFieldName",{docId:e,fieldName:t,fieldType:n})}},{key:"renameField",value:function(e,t,n){return this.workerPromise.emit("renameField",{docId:e,fieldName:t,newName:n})}},{key:"removeField",value:function(e,t){return this.workerPromise.emit("removeField",{docId:e,fieldName:t})}},{key:"removeControl",value:function(e,t,n,i){return this.workerPromise.emit("removeControl",{docId:e,fieldName:n,pageIndex:t,controlObjectNumber:i})}},{key:"isLastSignature",value:function(e,t){return this.workerPromise.emit("isLastSignature",{docId:e,fieldName:t})}},{key:"fixPageFields",value:function(e,t){return this.workerPromise.emit("fixPageFields",{docId:e,pageIndex:t})}},{key:"hasFixedPageFields",value:function(e,t){return this.workerPromise.emit("hasFixedPageFields",{docId:e,pageIndex:t})}},{key:"getControlCount",value:function(e,t){return this.workerPromise.emit("getControlCount",{docId:e,pageIndex:t})}},{key:"copyControls",value:function(e,t,n,i){return this.workerPromise.emit("copyControls",{docId:e,pageIndex:t,dstPageIndex:n,controls:i})}},{key:"getControlPageIndex",value:function(e,t,n){return this.workerPromise.emit("getControlPageIndex",{docId:e,fieldName:t,objectNumber:n})}},{key:"getPageInfoByIndex",value:function(e,t){return this.workerPromise.emit("getPageInfoByIndex",{id:e,index:t})}},{key:"setRenderFlag",value:function(e,t){return this.workerPromise.emit("setRenderFlag",{docId:e,flags:t})}},{key:"getPageBitmap",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:["page"],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"view",s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=arguments.length>9?arguments[9]:void 0;return this.workerPromise.emit("getPageBitmap",{docId:e,pageId:t,scale:n,rotate:i,rect:r,flags:o,usage:a,id:s,isSharedPage:u,annotData:c})}},{key:"getPageAndHighlightBitmap",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;return this.workerPromise.emit("getPageAndHighlightBitmap",{docId:e,pageId:t,scale:n,rotate:i,rect:r,exclude:o})}},{key:"clearDesignerAssitCache",value:function(e,t){return this.workerPromise.emit("clearDesignerAssitCache",{docId:e,pageId:t})}},{key:"clearAllDesignerAssistCache",value:function(e){return this.workerPromise.emit("clearAllDesignerAssistCache",{docId:e})}},{key:"getAnnotBitmapByRange",value:function(e,t,n,i,r,o){return this.workerPromise.emit("getAnnotBitmapByRange",{docId:e,pageId:t,range:n,scale:i,rotate:r,rect:o})}},{key:"getAnnot",value:function(e,t,n){return this.workerPromise.emit("getAnnot",{docId:e,pageId:t,annotId:n})}},{key:"getPageAnnotIDList",value:function(e,t){return this.workerPromise.emit("getPageAnnotIDList",{docId:e,pageId:t})}},{key:"getAnnots",value:function(e,t,n,i){return this.workerPromise.emit("getAnnots",{docId:e,pageId:t,idList:n,reload:i})}},{key:"getAnnotBitmap",value:function(e,t,n,i,r,o,a){return this.workerPromise.emit("getAnnotBitmap",{docId:e,pageId:t,annotId:n,scale:i,rotate:r,rect:o,renderAppearanceType:a})}},{key:"getAnnotObjNumByNM",value:function(e,t,n){return this.workerPromise.emit("getAnnotObjNumByNM",{docId:e,pageId:t,nm:n})}},{key:"getAnnotIdAtPoint",value:function(e,t,n,i){var r=n.x,o=n.y;return this.workerPromise.emit("getAnnotIdAtPoint",{docId:e,pageId:t,points:{x:r,y:o},tolerance:i})}},{key:"getAnnotIdAtDevicePoint",value:function(e,t,n,i,r){var o=n.x,a=n.y;return this.workerPromise.emit("getAnnotIdAtDevicePoint",{docId:e,pageId:t,points:{x:o,y:a},tolerance:i,matrix:r})}},{key:"getAnnotObjectNumAtPoint",value:function(e,t,n,i){var r=n.x,o=n.y;return this.workerPromise.emit("getAnnotObjectNumAtPoint",{docId:e,pageId:t,points:{x:r,y:o},tolerance:i})}},{key:"getAnnotObjectNumAtDevicePoint",value:function(e,t,n,i,r){var o=n.x,a=n.y;return this.workerPromise.emit("getAnnotObjectNumAtDevicePoint",{docId:e,pageId:t,points:{x:o,y:a},tolerance:i,matrix:r})}},{key:"getCharInfoAtPoint",value:function(e,t,n,i){var r=n.x,o=n.y;return this.workerPromise.emit("getCharInfoAtPoint",{docId:e,pageId:t,points:{x:r,y:o},tolerance:i})}},{key:"getThumb",value:function(e,t,n,i){return this.workerPromise.emit("getThumb",{docId:e,pageId:t,rotate:n,ratio:i})}},{key:"getMediaBoxBitmap",value:function(e,t,n,i){return this.workerPromise.emit("getMediaBoxBitmap",{docId:e,pageId:t,width:n,height:i})}},{key:"movePageTo",value:function(e,t,n){return this.workerPromise.emit("movePageTo",{docId:e,pageId:t,destIndex:n})}},{key:"insertPage",value:function(e,t,n,i){return this.workerPromise.emit("insertPage",{docId:e,pageIndex:t,width:n,height:i})}},{key:"removePage",value:function(e,t){return this.workerPromise.emit("removePage",{docId:e,pageIndex:t})}},{key:"updateAnnotQuadPointsByCharIndex",value:function(e,t,n,i,r){return this.workerPromise.emit("updateAnnotQuadPointsByCharIndex",{docId:e,pageId:t,annotId:n,startCharIndex:i,endCharIndex:r})}},{key:"setAnnotContent",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotContent",{docId:e,pageId:t,annotId:n,content:i})}},{key:"setAnnotBorderColor",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotBorderColor",{docId:e,pageId:t,annotId:n,color:i})}},{key:"setAnnotBorderStyle",value:function(e,t,n,i,r){return this.workerPromise.emit("setAnnotBorderStyle",{docId:e,pageId:t,annotId:n,style:i,styleParam:r})}},{key:"setAnnotBorderWidth",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotBorderWidth",{docId:e,pageId:t,annotId:n,width:i})}},{key:"setAnnotFillColor",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotFillColor",{docId:e,pageId:t,annotId:n,color:i})}},{key:"setRedactAnnotFillColor",value:function(e,t,n,i,r){return this.workerPromise.emit("setRedactAnnotFillColor",{docId:e,pageId:t,annotId:n,color:i,onlyForFill:r})}},{key:"setAnnotBorderInfo",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotBorderInfo",{docId:e,pageId:t,annotId:n,borderInfo:i})}},{key:"setRedactOverlayText",value:function(e,t,n,i){return this.workerPromise.emit("setRedactOverlayText",{docId:e,pageId:t,annotId:n,overlayText:i})}},{key:"removeRedactOverlayText",value:function(e,t,n){return this.workerPromise.emit("removeRedactOverlayText",{docId:e,pageId:t,annotId:n})}},{key:"setRedactOverlayTextAlignment",value:function(e,t,n,i){return this.workerPromise.emit("setRedactOverlayTextAlignment",{docId:e,pageId:t,annotId:n,alignment:i})}},{key:"setRedactRepeat",value:function(e,t,n,i){return this.workerPromise.emit("setRedactRepeat",{docId:e,pageId:t,annotId:n,isRepeat:i})}},{key:"setRedactAutoFontSize",value:function(e,t,n,i){return this.workerPromise.emit("setRedactAutoFontSize",{docId:e,pageId:t,annotId:n,isAutoFontSize:i})}},{key:"getRedactDefaultAppearance",value:function(e,t,n){return this.workerPromise.emit("getRedactDefaultAppearance",{docId:e,pageId:t,annotId:n})}},{key:"setRedactDefaultAppearance",value:function(e,t,n,i){return this.workerPromise.emit("setRedactDefaultAppearance",{docId:e,pageId:t,annotId:n,appearance:i})}},{key:"setRedactOpacity",value:function(e,t,n,i,r){return this.workerPromise.emit("setRedactOpacity",{docId:e,pageId:t,annotId:n,opacity:i,only4Fill:r})}},{key:"setRedactApplyFillColor",value:function(e,t,n,i){return this.workerPromise.emit("setRedactApplyFillColor",{docId:e,pageId:t,annotId:n,color:i})}},{key:"setAnnotOpacity",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotOpacity",{docId:e,pageId:t,annotId:n,opacity:i})}},{key:"setAnnotRotation",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotRotation",{docId:e,pageId:t,annotId:n,rotation:i})}},{key:"removeAnnot",value:function(e,t,n){return this.workerPromise.emit("removeAnnot",{docId:e,pageId:t,annotId:n})}},{key:"annotAddReply",value:function(e,t,n,i){return this.workerPromise.emit("annotAddReply",{docId:e,pageId:t,annotId:n,content:i})}},{key:"setAnnotRect",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotRect",{docId:e,pageId:t,annotId:n,rect:i})}},{key:"setAnnotRectAndInnerRect",value:function(e,t,n,i,r){return this.workerPromise.emit("setAnnotRectAndInnerRect",{docId:e,pageId:t,annotId:n,rect:i,innerRect:r})}},{key:"getAnnotInnerRect",value:function(e,t,n){return this.workerPromise.emit("getAnnotInnerRect",{docId:e,pageId:t,annotId:n})}},{key:"moveAnnotTo",value:function(e,t,n,i){return this.workerPromise.emit("moveAnnotTo",{docId:e,pageId:t,annotId:n,position:i})}},{key:"getPDFDocStream",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(t),a=this.workerPromise.emit("getPDFDocStream",{docId:e,writeStream:o,flag:n,endAllOperations:i});return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"setAnnotIconName",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotIconName",{docId:e,pageId:t,annotId:n,iconName:i})}},{key:"getFileattachmentStream",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(i),a=this.workerPromise.emit("getFileattachmentStream",{docId:e,pageId:t,annotId:n,writeStream:o});return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"setAnnotEndingStyle",value:function(e,t,n,i,r){return this.workerPromise.emit("setAnnotEndingStyle",{docId:e,pageId:t,annotId:n,isBeginning:i,style:r})}},{key:"setLineStartPoint",value:function(e,t,n,i,r){return this.workerPromise.emit("setLineStartPoint",{docId:e,pageId:t,annotId:n,x:i,y:r})}},{key:"setLineEndPoint",value:function(e,t,n,i,r){return this.workerPromise.emit("setLineEndPoint",{docId:e,pageId:t,annotId:n,x:i,y:r})}},{key:"setAnnotLeaderLineLength",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotLeaderLineLength",{docId:e,pageId:t,annotId:n,length:i})}},{key:"setAnnotLeaderLineExtend",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotLeaderLineExtend",{docId:e,pageId:t,annotId:n,length:i})}},{key:"setAnnotLeaderLineOffset",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotLeaderLineOffset",{docId:e,pageId:t,annotId:n,offset:i})}},{key:"setAnnotCaptionOffset",value:function(e,t,n,i,r){return this.workerPromise.emit("setAnnotCaptionOffset",{docId:e,pageId:t,annotId:n,x:i,y:r})}},{key:"updateAnnotVertexes",value:function(e,t,n,i,r,o){return this.workerPromise.emit("updateAnnotVertexes",{docId:e,pageId:t,annotId:n,pointIndex:i,x:r,y:o})}},{key:"setAnnotVertexes",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotVertexes",{docId:e,pageId:t,annotId:n,vertexes:i})}},{key:"setHighlightingMode",value:function(e,t,n,i){return this.workerPromise.emit("setHighlightingMode",{docId:e,pageId:t,annotId:n,highlightingMode:i})}},{key:"setAnnotAPBitmap",value:function(e,t,n,i,r){return this.workerPromise.emit("setAnnotAPBitmap",{docId:e,pageId:t,annotId:n,url:i,size:r})}},{key:"getBitmapBuffer",value:function(e,t,n){return this.workerPromise.emit("getBitmapBuffer",{docId:e,pageId:t,annotId:n})}},{key:"setAnnotInnerRect",value:function(e,t,n,i){var r=i.left,o=i.right,a=i.top,s=i.bottom;return this.workerPromise.emit("setAnnotInnerRect",{docId:e,pageId:t,annotId:n,rect:{left:r,right:o,top:a,bottom:s}})}},{key:"setCalloutLineEndingStyle",value:function(e,t,n,i){return this.workerPromise.emit("setCalloutLineEndingStyle",{docId:e,pageId:t,annotId:n,endingStyle:i})}},{key:"setAction",value:function(e,t,n,i,r,o){return this.workerPromise.emit("setAction",{docId:e,pageId:t,annotId:n,type:i,trigger:r,append:o})}},{key:"removeAction",value:function(e,t,n,i,r,o){return this.workerPromise.emit("removeAction",{docId:e,pageId:t,annotId:n,trigger:i,parentObject:r,objectNumber:o})}},{key:"setDefaultAppearance",value:function(e,t,n,i){return this.workerPromise.emit("setDefaultAppearance",{docId:e,pageId:t,annotId:n,da:i})}},{key:"removeAnnotAction",value:function(e,t,n){return this.workerPromise.emit("removeAnnotAction",{docId:e,pageId:t,annotId:n})}},{key:"getAction",value:function(e,t,n){return this.workerPromise.emit("getAction",{docId:e,pageId:t,annotId:n})}},{key:"getStructureRoles",value:function(e){return this.workerPromise.emit("getStructureRoles",{docId:e})}},{key:"setActionDataByIndex",value:function(e,t,n,i,r){return this.workerPromise.emit("setActionDataByIndex",{docId:e,pageId:t,annotId:n,data:i,actionIndex:r})}},{key:"addBookmarksFromStructureRoles",value:function(e,t,n){return this.workerPromise.emit("addBookmarksFromStructureRoles",{docId:e,structureRoles:t,rootTitle:n})}},{key:"setCalloutLinePoints",value:function(e,t,n,i){return this.workerPromise.emit("setCalloutLinePoints",{docId:e,pageId:t,annotId:n,calloutLinePoints:i})}},{key:"setSubject",value:function(e,t,n,i){return this.workerPromise.emit("setSubject",{docId:e,pageId:t,annotId:n,subject:i})}},{key:"setTitle",value:function(e,t,n,i){return this.workerPromise.emit("setTitle",{docId:e,pageId:t,annotId:n,title:i})}},{key:"setCreateDateTime",value:function(e,t,n,i){return this.workerPromise.emit("setCreateDateTime",{docId:e,pageId:t,annotId:n,date:i})}},{key:"setModifiedDateTime",value:function(e,t,n,i){return this.workerPromise.emit("setModifiedDateTime",{docId:e,pageId:t,annotId:n,date:i})}},{key:"setUniqueId",value:function(e,t,n,i){return this.workerPromise.emit("setUniqueId",{docId:e,pageId:t,annotId:n,newId:i})}},{key:"setDefaultAp",value:function(e,t,n,i){return this.workerPromise.emit("setDefaultAp",{docId:e,pageId:t,annotId:n,defaultAppearance:i})}},{key:"setAlignment",value:function(e,t,n,i){return this.workerPromise.emit("setAlignment",{docId:e,pageId:t,annotId:n,value:i})}},{key:"setAnnotFlag",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotFlag",{docId:e,pageId:t,annotId:n,flag:i})}},{key:"importFromFDF",value:function(e,t,n){var i=g(t);return this.workerPromise.emit("importFromFDF",{docId:e,fdf:t,dataType:n},i)}},{key:"importFromFDFFile",value:function(e,t,n,i){return this.workerPromise.emit("importFromFDFFile",{docId:e,file:t,size:n,type:i})}},{key:"exportToStardardXml",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("exportToStardardXml",{docId:e,fileName:t,callbackId:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"exportToFDF",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.workerPromise.emit("exportToFDF",{docId:e,fileType:t,dataType:n,pageAnnots:i})}},{key:"exportToImage",value:function(e,t,n,i,r){var o=this,a=this.workerPromise.calls(r),s=this.workerPromise.emit("exportToImage",{docId:e,imageSetting:t,fileName:n,pageRange:i,callbackId:a});return s.finally((function(){o.workerPromise.releaseCall(a)})),s}},{key:"exportToTxt",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(i),a=this.workerPromise.emit("exportToTxt",{docId:e,taskName:t,pageRange:n,callbackId:o});return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"exportImageObjectToImage",value:function(e,t,n,i,r){var o=this,a=this.workerPromise.calls(r),s=this.workerPromise.emit("exportImageObjectToImage",{docId:e,graphicsObject:t,imageSetting:n,fileName:i,callbackId:a});return s.finally((function(){o.workerPromise.releaseCall(a)})),s}},{key:"cancelExport",value:function(e){return this.workerPromise.emit("cancelExport",{docId:e})}},{key:"addAnnot",value:function(e,t,n){return this.workerPromise.emit("addAnnot",{docId:e,pageId:t,annot:n})}},{key:"addAnnots",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("addAnnots",{docId:e,annotJsonArray:t,progress:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"markRedactAnnot",value:function(e,t,n,i){return this.workerPromise.emit("markRedactAnnot",{docId:e,pageId:t,rects:n,annot:i})}},{key:"redactApply",value:function(e,t,n){return this.workerPromise.emit("redactApply",{docId:e,pageId:t,annotId:n})}},{key:"applyRedaction",value:function(e){return this.workerPromise.emit("applyRedaction",{docId:e})}},{key:"addAnnotGroup",value:function(e,t,n,i){return this.workerPromise.emit("addAnnotGroup",{docId:e,pageId:t,annots:n,headerIndex:i})}},{key:"getBlankPageIndexes",value:function(e){return this.workerPromise.emit("getBlankPageIndexes",{docId:e})}},{key:"getBookmarks",value:function(e){return this.workerPromise.emit("getBookmarks",{docId:e})}},{key:"getCurFileSymbolId",value:function(e){return this.workerPromise.emit("getCurFileSymbolId",{docId:e})}},{key:"getFadeOutBackground",value:function(e,t){return this.workerPromise.emit("getFadeOutBackground",{docId:e,imgBuffer:t})}},{key:"getConvertToMono",value:function(e,t){return this.workerPromise.emit("getConvertToMono",{docId:e,imgBuffer:t})}},{key:"createRootBookmark",value:function(e){return this.workerPromise.emit("createRootBookmark",{docId:e})}},{key:"setBookmarkProperty",value:function(e,t,n){return this.workerPromise.emit("setBookmarkProperty",{docId:e,bkId:t,properties:n})}},{key:"removeBookmark",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.workerPromise.emit("removeBookmark",{docId:e,bkId:t,isOldVersion:n})}},{key:"getBookmarkDestination",value:function(e,t){return this.workerPromise.emit("getBookmarkDestination",{docId:e,bkId:t})}},{key:"setBookmarkDestination",value:function(e,t,n){return this.workerPromise.emit("setBookmarkDestination",{docId:e,bkId:t,gotoAction:n})}},{key:"getBookmarkAction",value:function(e,t){return this.workerPromise.emit("getBookmarkAction",{docId:e,bkId:t})}},{key:"setBookmarkAction",value:function(e,t,n){return this.workerPromise.emit("setBookmarkAction",{docId:e,bkId:t,action:n})}},{key:"moveBookmarkAction",value:function(e,t,n){return this.workerPromise.emit("moveBookmarkAction",{docId:e,bkId:t,moveInfo:n})}},{key:"removeBookmarkAction",value:function(e,t,n){return this.workerPromise.emit("removeBookmarkAction",{docId:e,bkId:t,action:n})}},{key:"getLayerNodes",value:function(e){return this.workerPromise.emit("getLayerNodes",{docId:e})}},{key:"setLayerNodeVisiable",value:function(e,t,n){return this.workerPromise.emit("setLayerNodeVisiable",{docId:e,layerId:t,visiable:n})}},{key:"getTextRectsAtRect",value:function(e,t,n){return this.workerPromise.emit("getTextRectsAtRect",{docId:e,pageId:t,rect:n})}},{key:"getTextContinuousRectsAtRect",value:function(e,t,n){return this.workerPromise.emit("getTextContinuousRectsAtRect",{docId:e,pageId:t,rect:n})}},{key:"getTextContinuousRectsAtPoints",value:function(e,t,n,i,r,o,a,s){return this.workerPromise.emit("getTextContinuousRectsAtPoints",{docId:e,pageId:t,point1:n,point2:i,tolerance:r,start:o,end:a,isTextIndex:s})}},{key:"getTextContinuousCharsAtRect",value:function(e,t,n,i){return this.workerPromise.emit("getTextContinuousCharsAtRect",{docId:e,pageId:t,rect:n,allInRect:i})}},{key:"getDoubleClickTextRectAtPoint",value:function(e,t,n,i){return this.workerPromise.emit("getDoubleClickTextRectAtPoint",{docId:e,pageId:t,doubleClickPoint:n,tolerance:i})}},{key:"getTextSearch",value:function(e,t,n,i){return this.workerPromise.emit("getTextSearch",{docId:e,pageId:t,pattern:n,flags:i})}},{key:"getAnnotTextSearch",value:function(e,t,n,i,r){return this.workerPromise.emit("getAnnotTextSearch",{docId:e,pageId:t,annotId:n,pattern:i,flags:r})}},{key:"textSearchFindNext",value:function(e){return this.workerPromise.emit("textSearchFindNext",{id:e})}},{key:"textSearchFindPrev",value:function(e){return this.workerPromise.emit("textSearchFindPrev",{id:e})}},{key:"textSearchDestroy",value:function(e){return this.workerPromise.emit("textSearchDestroy",{id:e})}},{key:"registerSecurityCallback",value:function(e,t){return this.workerPromise.emit("registerSecurityCallback",{type:e,options:t})}},{key:"registerCustomWebPluginSecurityCallback",value:function(e,t,n){return this.workerPromise.emit("registerCustomWebPluginSecurityCallback",{fileName:e,filter:t,pluginSecurityObj:n})}},{key:"unRegisterSecurityHandler",value:function(e,t){return this.workerPromise.emit("unRegisterSecurityHandler",{pluginId:e,filter:t})}},{key:"customProtectDoc",value:function(e,t){return this.workerPromise.emit("customProtectDoc",{docId:e,filter:t})}},{key:"destroyDoc",value:function(e){return this.workerPromise.emit("destroyDoc",{id:e})}},{key:"destroyPage",value:function(e,t){return this.workerPromise.emit("destroyPage",{docId:e,pageId:t})}},{key:"setDocOpenAction",value:function(e,t,n){return this.workerPromise.emit("setDocOpenAction",{docId:e,type:t,params:n})}},{key:"setDocActionData",value:function(e,t,n){return this.workerPromise.emit("setDocActionData",{docId:e,data:t,index:n})}},{key:"moveCaretRectByCharIndex",value:function(e,t,n,i){return this.workerPromise.emit("moveCaretRectByCharIndex",{docId:e,pageId:t,annotId:n,charIndex:i})}},{key:"setAnnotIntent",value:function(e,t,n,i){return this.workerPromise.emit("setAnnotIntent",{docId:e,pageId:t,annotId:n,intent:i})}},{key:"setInkList",value:function(e,t,n,i){return this.workerPromise.emit("setInkList",{docId:e,pageId:t,annotId:n,inkList:i})}},{key:"setUserName",value:function(e){return this.workerPromise.emit("setUserName",{name:e})}},{key:"getUserName",value:function(){return this.workerPromise.emit("getUserName")}},{key:"addAnnotReviewState",value:function(e,t,n,i){return this.workerPromise.emit("addAnnotReviewState",{docId:e,pageId:t,annotId:n,stateName:i})}},{key:"addAnnotMarkedState",value:function(e,t,n,i){return this.workerPromise.emit("addAnnotMarkedState",{docId:e,pageId:t,annotId:n,stateName:i})}},{key:"removeAllStateAnnots",value:function(e,t,n){return this.workerPromise.emit("removeAllStateAnnots",{docId:e,pageId:t,annotId:n})}},{key:"setStateName",value:function(e,t,n,i){return this.workerPromise.emit("setStateName",{docId:e,pageId:t,stateAnnotId:n,stateName:i})}},{key:"setNoteOpenStatus",value:function(e,t,n,i){return this.workerPromise.emit("setNoteOpenStatus",{docId:e,pageId:t,annotId:n,isOpen:i})}},{key:"flatten",value:function(e,t,n){return this.workerPromise.emit("flatten",{docId:e,pageId:t,option:n})}},{key:"setDynamicInfoFormula",value:function(e,t){return this.workerPromise.emit("setDynamicInfoFormula",{seperator:e,timeFormat:t})}},{key:"getDynamicInfoFormula",value:function(){return this.workerPromise.emit("getDynamicInfoFormula")}},{key:"setDigitalTimeFormat",value:function(e){return this.workerPromise.emit("setDigitalTimeFormat",{timeFormat:e})}},{key:"setDigitalInfo",value:function(e){return this.workerPromise.emit("setDigitalInfo",{identityInfo:e})}},{key:"getGraphicObjectsInfo",value:function(e,t){return this.workerPromise.emit("getGraphicObjectsInfo",{docId:e,pageId:t})}},{key:"updatePageInfo",value:function(e,t){return this.workerPromise.emit("updatePageInfo",{docId:e,pageId:t})}},{key:"setPageRotation",value:function(e,t,n){return this.workerPromise.emit("setPageRotation",{docId:e,pageId:t,rotation:n})}},{key:"addPageImage",value:function(e,t,n,i,r,o,a){return this.workerPromise.emit("addPageImage",{docId:e,pageId:t,imageBuffer:n,point:i,width:r,height:o,rotation:a})}},{key:"getPageAction",value:function(e,t,n){return this.workerPromise.emit("getPageAction",{docId:e,pageId:t,trigger:n})}},{key:"setPageAction",value:function(e,t,n,i){return this.workerPromise.emit("setPageAction",{docId:e,pageId:t,trigger:n,action:i})}},{key:"removePageAction",value:function(e,t,n,i){return this.workerPromise.emit("removePageAction",{docId:e,pageId:t,trigger:n,action:i})}},{key:"movePageAction",value:function(e,t,n){return this.workerPromise.emit("movePageAction",{docId:e,pageId:t,moveInfo:n})}},{key:"addWatermark",value:function(e,t,n){return this.workerPromise.emit("addWatermark",{docId:e,pageId:t,data:n})}},{key:"getSecurityType",value:function(e){return this.workerPromise.emit("getSecurityType",{docId:e})}},{key:"setCertificateAndPermission",value:function(e,t,n,i){return this.workerPromise.emit("setCertificateAndPermission",{docId:e,infos:t,cipher:n,isEncryptMetadata:i})}},{key:"setPasswordAndPermission",value:function(e,t,n,i,r,o){return this.workerPromise.emit("setPasswordAndPermission",{docId:e,userPassword:t,ownerPassword:n,permission:i,cipher:r,isEncryptMetadata:o})}},{key:"removeSecurity",value:function(e){return this.workerPromise.emit("removeSecurity",{docId:e})}},{key:"checkPassword",value:function(e,t){return this.workerPromise.emit("checkPassword",{docId:e,password:t})}},{key:"getPermission",value:function(e){return this.workerPromise.emit("getPermission",{docId:e})}},{key:"getStdCipherOptions",value:function(e){return this.workerPromise.emit("getStdCipherOptions",{docId:e})}},{key:"getUserPassword",value:function(e,t){return this.workerPromise.emit("getUserPassword",{docId:e,password:t})}},{key:"getGraphicsObjectAtPoint",value:function(e,t,n,i,r,o){return this.workerPromise.emit("getGraphicsObjectAtPoint",{docId:e,pageId:t,point:n,tolerance:i,type:r,rect:o})}},{key:"setGraphicsObjectMatrix",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectMatrix",{docId:e,pageId:t,id:n,matrix:i})}},{key:"setGraphicsObjectRect",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectRect",{docId:e,pageId:t,id:n,rect:i})}},{key:"getGraphicsObjectBitmap",value:function(e,t,n,i,r){return this.workerPromise.emit("getGraphicsObjectBitmap",{docId:e,pageId:t,id:n,scale:i,rotation:r})}},{key:"setGraphicsObjectBorderStyle",value:function(e,t,n,i,r){return this.workerPromise.emit("setGraphicsObjectBorderStyle",{docId:e,pageId:t,id:n,value:i,dashes:r})}},{key:"setGraphicsObjectBorderWidth",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectBorderWidth",{docId:e,pageId:t,id:n,width:i})}},{key:"setGraphicsObjectBorderColor",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectBorderColor",{docId:e,pageId:t,id:n,color:i})}},{key:"setGraphicsObjectFillColor",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectFillColor",{docId:e,pageId:t,id:n,color:i})}},{key:"setGraphicsObjectOpacity",value:function(e,t,n,i){return this.workerPromise.emit("setGraphicsObjectOpacity",{docId:e,pageId:t,id:n,opacity:i})}},{key:"addGraphicsObject",value:function(e,t,n){return this.workerPromise.emit("addGraphicsObject",{docId:e,pageId:t,info:n})}},{key:"setImageObjectOpacity",value:function(e,t,n,i){return this.workerPromise.emit("setImageObjectOpacity",{docId:e,pageId:t,id:n,opacity:i})}},{key:"setImageObjectRotation",value:function(e,t,n,i){return this.workerPromise.emit("setImageObjectRotation",{docId:e,pageId:t,id:n,rotation:i})}},{key:"getImageObjectStream",value:function(e,t,n){return this.workerPromise.emit("getImageObjectStream",{docId:e,pageId:t,id:n})}},{key:"setActionDestination",value:function(e,t,n){return this.workerPromise.emit("setActionDestination",{docId:e,objNum:t,destination:n})}},{key:"setActionFieldNames",value:function(e,t,n){return this.workerPromise.emit("setActionFieldNames",{docId:e,objNum:t,fieldNames:n})}},{key:"setActionHideState",value:function(e,t,n){return this.workerPromise.emit("setActionHideState",{docId:e,objNum:t,isHide:n})}},{key:"setActionScript",value:function(e,t,n){return this.workerPromise.emit("setActionScript",{docId:e,objNum:t,script:n})}},{key:"setActionOCGState",value:function(e,t,n){return this.workerPromise.emit("setActionOCGState",{docId:e,objNum:t,layerIds:n})}},{key:"setThreadActionIndex",value:function(e,t,n){return this.workerPromise.emit("setThreadActionIndex",{docId:e,objNum:t,index:n})}},{key:"setActionFlags",value:function(e,t,n){return this.workerPromise.emit("setActionFlags",{docId:e,objNum:t,flags:n})}},{key:"setActionURI",value:function(e,t,n){return this.workerPromise.emit("setActionURI",{docId:e,objNum:t,uri:n})}},{key:"insertSubAction",value:function(e,t,n,i){return this.workerPromise.emit("insertSubAction",{docId:e,objNum:t,index:n,type:i})}},{key:"setSubAction",value:function(e,t,n,i){return this.workerPromise.emit("setSubAction",{docId:e,objNum:t,index:n,type:i})}},{key:"removeAllSubActions",value:function(e,t){return this.workerPromise.emit("removeAllSubActions",{docId:e,objNum:t})}},{key:"removeSubAction",value:function(e,t,n){return this.workerPromise.emit("removeSubAction",{docId:e,objNum:t,index:n})}},{key:"setActionData",value:function(e,t,n){return this.workerPromise.emit("setActionData",{docId:e,objNum:t,data:n})}},{key:"moveAction",value:function(e,t,n,i){return this.workerPromise.emit("moveAction",{docId:e,pageId:t,objNum:n,moveInfo:i})}},{key:"removeGraphicsObject",value:function(e,t,n,i){return this.workerPromise.emit("removeGraphicsObject",{docId:e,pageId:t,id:n,isFinal:i})}},{key:"setPopupOpenStatus",value:function(e,t,n,i){return this.workerPromise.emit("setPopupOpenStatus",{docId:e,pageId:t,annotId:n,status:i})}},{key:"removePageAllAnnot",value:function(e,t){return this.workerPromise.emit("removePageAllAnnot",{docId:e,pageId:t})}},{key:"setTextObjectChar",value:function(e,t,n,i){return this.workerPromise.emit("setTextObjectChar",{docId:e,pageId:t,id:n,char:i})}},{key:"setTextObjectItalic",value:function(e,t,n,i){return this.workerPromise.emit("setTextObjectItalic",{docId:e,pageId:t,id:n,italic:i})}},{key:"setTextObjectBold",value:function(e,t,n,i){return this.workerPromise.emit("setTextObjectBold",{docId:e,pageId:t,id:n,bold:i})}},{key:"setTextObjectFontSize",value:function(e,t,n,i){return this.workerPromise.emit("setTextObjectFontSize",{docId:e,pageId:t,id:n,size:i})}},{key:"setTextObjectStandardFont",value:function(e,t,n,i){return this.workerPromise.emit("setTextObjectStandardFont",{docId:e,pageId:t,id:n,standardId:i})}},{key:"setTextObjectFontByName",value:function(e,t,n,i,r,o){return this.workerPromise.emit("setTextObjectFontByName",{docId:e,pageId:t,id:n,name:i,styles:r,charset:o})}},{key:"getTextObjectWoff",value:function(e,t,n){return this.workerPromise.emit("getTextObjectWoff",{docId:e,pageId:t,id:n})}},{key:"getAnnotWoff",value:function(e,t,n){return this.workerPromise.emit("getAnnotWoff",{docId:e,pageId:t,id:n})}},{key:"drmEncrypt",value:function(e,t){return this.workerPromise.emit("drmEncrypt",{docId:e,options:t})}},{key:"getActionFileStream",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("getActionFileStream",{docId:e,objNum:t,writeStream:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"getTemplates",value:function(e){return this.workerPromise.emit("getTemplates",{docId:e})}},{key:"hideTemplate",value:function(e,t,n){return this.workerPromise.emit("hideTemplate",{docId:e,templateObj:t,isHidden:n})}},{key:"spawnPage",value:function(e,t,n,i,r){return this.workerPromise.emit("spawnPage",{docId:e,templateObj:t,nPage:n,bRename:i,bOverlay:r})}},{key:"setFieldsValue",value:function(e,t,n){return this.workerPromise.emit("setFieldsValue",{docId:e,fieldsValue:t,resetAP:n})}},{key:"removeTemplate",value:function(e,t){return this.workerPromise.emit("removeTemplate",{docId:e,name:t})}},{key:"getFontBufferByName",value:function(e,t){return this.workerPromise.emit("getFontBufferByName",{docId:e,fontName:t})}},{key:"getPageSizes",value:function(e,t,n){return this.workerPromise.emit("getPageSizes",{docId:e,index:t,count:n})}},{key:"setMeasureRatio",value:function(e,t,n,i){return this.workerPromise.emit("setMeasureRatio",{docId:e,pageId:t,annotId:n,ratioInfo:i})}},{key:"setMeasureUnit",value:function(e,t,n,i,r){return this.workerPromise.emit("setMeasureUnit",{docId:e,pageId:t,annotId:n,unit:i,measureType:r})}},{key:"setMeasureConversionFactor",value:function(e,t,n,i){return this.workerPromise.emit("setMeasureConversionFactor",{docId:e,pageId:t,annotId:n,factor:i})}},{key:"startImportPages",value:function(e,t,n,i,r,o,a,s){return this.workerPromise.emit("startImportPages",{docId:e,destIndex:t,file:n,password:i,flags:r,layerName:o,startIndex:a,endIndex:s})}},{key:"importPagesFromPDFDocs",value:function(e,t,n,i){return this.workerPromise.emit("importPagesFromPDFDocs",{docId:e,destIndex:t,srcDocs:n,layerName:i})}},{key:"exportPagesToPDFDocs",value:function(e,t,n,i,r){return this.workerPromise.emit("exportPagesToPDFDocs",{docId:e,srcPages:t,destDocs:n,layerName:i,bookmarkTitle:r})}},{key:"extractPages",value:function(e,t,n,i,r){var o=this,a=this.workerPromise.calls(n),s=this.workerPromise.emit("extractPages",{docId:e,pageRange:t,writeStream:a,file:i,password:r});return s.finally((function(){o.workerPromise.releaseCall(a)})),s}},{key:"copyPages",value:function(e,t,n){return this.workerPromise.emit("copyPages",{docId:e,pageRange:t,destIndex:n})}},{key:"saveCopyPagesData",value:function(e,t){return this.workerPromise.emit("saveCopyPagesData",{docId:e,pageRange:t})}},{key:"pastePages",value:function(e,t){return this.workerPromise.emit("pastePages",{docId:e,destIndex:t})}},{key:"embedAllPageThumbnail",value:function(e){return this.workerPromise.emit("embedAllPageThumbnail",{docId:e})}},{key:"removeEmbeddedPageThumbnail",value:function(e){return this.workerPromise.emit("removeEmbeddedPageThumbnail",{docId:e})}},{key:"getAllBoxes",value:function(e,t){return this.workerPromise.emit("getAllBoxes",{docId:e,index:t})}},{key:"setAllBoxesByIndexes",value:function(e,t,n,i,r,o,a,s){return this.workerPromise.emit("setAllBoxesByIndexes",{docId:e,indexes:t,width:n,height:i,xOffset:r,yOffset:o,boxes:a,isMoveWhite:s})}},{key:"getPageFormat",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;return this.workerPromise.emit("getPageFormat",{docId:e,type:t,previewWidth:n,previewHeight:i,fileName:r,newDocId:o,localFormat:a})}},{key:"getPageFormatThumb",value:function(e,t,n,i,r,o,a,s){return this.workerPromise.emit("getPageFormatThumb",{docId:e,type:t,pageIndex:n,data:i,isUpdate:r,bitmapWidth:o,bitmapHeight:a,rotate:s})}},{key:"addPageFormat",value:function(e,t,n,i){return this.workerPromise.emit("addPageFormat",{docId:e,type:t,data:n,isUpdate:i})}},{key:"removeAllPageFormat",value:function(e,t){return this.workerPromise.emit("removeAllPageFormat",{docId:e,type:t})}},{key:"extractPrintPages",value:function(e,t){return this.workerPromise.emit("extractPrintPages",{docId:e,data:t})}},{key:"getHeaderFooter",value:function(e){return this.workerPromise.emit("getHeaderFooter",e)}},{key:"addHeaderFooter",value:function(e,t){return this.workerPromise.emit("addHeaderFooter",{headerFooter:t,docId:e})}},{key:"updateHeaderFooter",value:function(e,t){return this.workerPromise.emit("updateHeaderFooter",{headerFooter:t,docId:e})}},{key:"removeHeaderFooter",value:function(e){return this.workerPromise.emit("removeHeaderFooter",e)}},{key:"paste",value:function(e,t,n,i,r,o){return this.workerPromise.emit("paste",{docId:e,pageId:t,srcPageId:n,type:i,objectId:r,position:o})}},{key:"setFontMap",value:function(e){return this.workerPromise.emit("setFontMap",e)}},{key:"setWatermarkFontMap",value:function(e){return this.workerPromise.emit("setWatermarkFontMap",e)}},{key:"addFontMap",value:function(e){return this.workerPromise.emit("addFontMap",e)}},{key:"setJPXDownSample",value:function(e){return this.workerPromise.emit("setJPXDownSample",e)}},{key:"getAnnotsRawData",value:function(e,t){return this.workerPromise.emit("getAnnotsRawData",{docId:e,rawAnnots:t})}},{key:"attachFile",value:function(e,t){return this.workerPromise.emit("attachFile",{docId:e,blob:t})}},{key:"signDoc",value:function(e,t,n){return this.workerPromise.emit("signDoc",{docId:e,signInfo:t,ap:n})}},{key:"signDocForESignCN",value:function(e,t){return this.workerPromise.emit("signDocForESignCN",{docId:e,signInfo:t})}},{key:"getGraphicsObjectByIndex",value:function(e,t,n){return this.workerPromise.emit("getGraphicsObjectByIndex",{docId:e,pageId:t,index:n})}},{key:"getGraphicsObjectsCount",value:function(e,t){return this.workerPromise.emit("getGraphicsObjectsCount",{docId:e,pageId:t})}},{key:"getFontsInfo",value:function(e){return this.workerPromise.emit("getFontsInfo",{docId:e})}},{key:"getDocAdditionalActions",value:function(e){return this.workerPromise.emit("getDocAdditionalActions",{docId:e})}},{key:"calcPageContentBBox",value:function(e,t,n){return this.workerPromise.emit("calcPageContentBBox",{docId:e,pageIndex:t,mode:n})}},{key:"getPageBox",value:function(e,t,n){return this.workerPromise.emit("getPageBox",{docId:e,pageIndex:t,boxType:n})}},{key:"setPageBox",value:function(e,t,n,i){return this.workerPromise.emit("setPageBox",{docId:e,pageIndex:t,boxType:n,rect:i})}},{key:"setPageSize",value:function(e,t,n,i){return this.workerPromise.emit("setPageSize",{docId:e,pageIndex:t,width:n,height:i})}},{key:"syncDataCache",value:function(e,t){return this.workerPromise.emit("syncDataCache",{docId:e,pageIdMap:t})}},{key:"setDocColors",value:function(e,t){return this.workerPromise.emit("setDocColors",{docId:e,colors:t})}},{key:"setPageDisplayPreferences",value:function(e,t){return this.workerPromise.emit("setPageDisplayPreferences",{docId:e,pageDisplayPreferences:t})}},{key:"moveAnnotsToPage",value:function(e,t,n,i){return this.workerPromise.emit("moveAnnotsToPage",{docId:e,srcPageId:t,dstPageId:n,annotInfos:i})}},{key:"getOriginalStream",value:function(e){return this.workerPromise.emit("getOriginalStream",{docId:e})}},{key:"hasForm",value:function(e){return this.workerPromise.emit("hasForm",{docId:e})}},{key:"setTabOrder",value:function(e,t,n){return this.workerPromise.emit("setTabOrder",{docId:e,pageIndex:t,type:n})}},{key:"getTabOrder",value:function(e,t){return this.workerPromise.emit("getTabOrder",{docId:e,pageIndex:t})}},{key:"setStructureOrder",value:function(e,t,n){return this.workerPromise.emit("setStructureOrder",{docId:e,pageIndex:t,idList:n})}},{key:"setLockAction",value:function(e,t,n,i){return this.workerPromise.emit("setLockAction",{docId:e,title:t,type:n,fieldNames:i})}},{key:"VerifySignature",value:function(e,t,n){return this.workerPromise.emit("VerifySignature",{docId:e,fieldName:t,verifyConfig:n})}},{key:"getDigitalSignatureInfo",value:function(e,t,n){return this.workerPromise.emit("getDigitalSignatureInfo",{docId:e,fieldName:t,trustedCertificateList:n})}},{key:"verifyDocSignature",value:function(e,t){return this.workerPromise.emit("verifyDocSignature",{docId:e,verifyConfig:t})}},{key:"verifySignatureLtv",value:function(e,t,n){return this.workerPromise.emit("verifySignatureLtv",{docId:e,fieldName:t,verifyConfig:n})}},{key:"clearSignature",value:function(e,t,n){return this.workerPromise.emit("clearSignature",{docId:e,fieldName:t,verifyConfig:n})}},{key:"setImage",value:function(e,t,n,i){return this.workerPromise.emit("setImage",{docId:e,pageId:t,annotId:n,buffer:i})}},{key:"getWidgetMkOption",value:function(e,t,n){return this.workerPromise.emit("getWidgetMkOption",{docId:e,pageId:t,annotId:n})}},{key:"setWidgetIconCaptionRelation",value:function(e,t,n,i){return this.workerPromise.emit("setWidgetIconCaptionRelation",{docId:e,pageId:t,annotId:n,relation:i})}},{key:"setWidgetHighlighting",value:function(e,t,n,i){return this.workerPromise.emit("setWidgetHighlighting",{docId:e,pageId:t,annotId:n,mode:i})}},{key:"setWidgetMkCaption",value:function(e,t,n,i,r){return this.workerPromise.emit("setWidgetMkCaption",{docId:e,pageId:t,annotId:n,position:i,caption:r})}},{key:"setWidgetMkIcon",value:function(e,t,n,i,r){return this.workerPromise.emit("setWidgetMkIcon",{docId:e,pageId:t,annotId:n,position:i,buffer:r})}},{key:"getWidgetIconFitOption",value:function(e,t,n){return this.workerPromise.emit("getWidgetIconFitOption",{docId:e,pageId:t,annotId:n})}},{key:"setWidgetIconFitOption",value:function(e,t,n,i){return this.workerPromise.emit("setWidgetIconFitOption",{docId:e,pageId:t,annotId:n,option:i})}},{key:"duplicateWidget",value:function(e,t,n,i){return this.workerPromise.emit("duplicateWidget",{docId:e,pages:t,fieldName:n,objectNumber:i})}},{key:"duplicateField",value:function(e,t,n,i,r,o,a){return this.workerPromise.emit("duplicateField",{docId:e,fieldName:t,pageIndex:n,annotObjNum:i,columns:r,rows:o,positions:a})}},{key:"getAllModuleLicenseRight",value:function(){return this.workerPromise.emit("getAllModuleLicenseRight")}},{key:"ensureSideModeLoaded",value:function(e){return this.workerPromise.emit("ensureSideModeLoaded",{moduleType:e})}},{key:"moveGraphicsObjectByPosition",value:function(e,t,n,i,r){return this.workerPromise.emit("moveGraphicsObjectByPosition",{docId:e,pageId:t,id:n,type:i,graphicObjectId:r})}},{key:"setDictionaryEntry",value:function(e,t,n,i,r){return this.workerPromise.emit("setDictionaryEntry",{docId:e,pageId:t,annotId:n,key:i,value:r})}},{key:"getDictionaryEntry",value:function(e,t,n,i){return this.workerPromise.emit("getDictionaryEntry",{docId:e,pageId:t,annotId:n,key:i})}},{key:"resetAppearanceStream",value:function(e,t,n){return this.workerPromise.emit("resetAppearanceStream",{docId:e,pageId:t,annotId:n})}},{key:"setCO",value:function(e,t){return this.workerPromise.emit("setCO",{docId:e,CO:t})}},{key:"renderTemplatesByObjNum",value:function(e,t){return this.workerPromise.emit("renderTemplatesByObjNum",{docId:e,objNum:t})}},{key:"getNameTree",value:function(e,t){return this.workerPromise.emit("getNameTree",{docId:e,type:t})}},{key:"addNameTreeObj",value:function(e,t,n,i){return this.workerPromise.emit("addNameTreeObj",{docId:e,type:t,name:n,objNum:i})}},{key:"removeNameTreeObj",value:function(e,t,n){return this.workerPromise.emit("removeNameTreeObj",{docId:e,type:t,name:n})}},{key:"replaceNameTreeObj",value:function(e,t,n,i){return this.workerPromise.emit("replaceNameTreeObj",{docId:e,type:t,name:n,objNum:i})}},{key:"renameNameTreeObj",value:function(e,t,n,i){return this.workerPromise.emit("renameNameTreeObj",{docId:e,type:t,oldName:n,newName:i})}},{key:"getPageIndexByObjNum",value:function(e,t){return this.workerPromise.emit("getPageIndexByObjNum",{docId:e,objNum:t})}},{key:"nameTreeTemplatesToPages",value:function(e,t){return this.workerPromise.emit("nameTreeTemplatesToPages",{docId:e,name:t})}},{key:"nameTreePagesToTemplates",value:function(e,t){return this.workerPromise.emit("nameTreePagesToTemplates",{docId:e,name:t})}},{key:"showNameTreePageAtTheEnd",value:function(e){return this.workerPromise.emit("showNameTreePageAtTheEnd",{docId:e})}},{key:"hideNameTreePage",value:function(e,t){return this.workerPromise.emit("hideNameTreePage",{docId:e,pageIndex:t})}},{key:"addFileSpec",value:function(e,t,n,i){return this.workerPromise.emit("addFileSpec",{docId:e,fileName:t,fileBuffer:n,modifiedDateTime:i})}},{key:"setFileSpecDesc",value:function(e,t,n){return this.workerPromise.emit("setFileSpecDesc",{docId:e,desc:t,objNum:n})}},{key:"getFileSpecStream",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("getFileSpecStream",{docId:e,fileSpecObjNum:t,writeStreamCall:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"getFileSpecStreamByName",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("getFileSpecStreamByName",{docId:e,name:t,writeStreamCall:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"addEmbeddedFileByAttachments",value:function(e,t,n){return this.workerPromise.emit("addEmbeddedFileByAttachments",{docId:e,name:t,objNum:n})}},{key:"setEmbeddedFileByAttachments",value:function(e,t,n){return this.workerPromise.emit("setEmbeddedFileByAttachments",{docId:e,name:t,objNum:n})}},{key:"removeEmbeddedFileByAttachments",value:function(e,t){return this.workerPromise.emit("removeEmbeddedFileByAttachments",{docId:e,name:t})}},{key:"cancelEmbedAllPageThumbnail",value:function(e){return this.workerPromise.emit("cancelEmbedAllPageThumbnail",{docId:e})}},{key:"cancelRemoveEmbeddedPageThumbnail",value:function(e){return this.workerPromise.emit("cancelRemoveEmbeddedPageThumbnail",{docId:e})}},{key:"moveControl",value:function(e,t,n,i){return this.workerPromise.emit("moveControl",{docId:e,fieldId:t,fieldName:n,newName:i})}},{key:"getAnnotIdArrayByOrder",value:function(e,t){return this.workerPromise.emit("getAnnotIdArrayByOrder",{docId:e,pageId:t})}},{key:"getAAJson",value:function(e,t){return this.workerPromise.emit("getAAJson",{docId:e,fieldName:t})}},{key:"getPageDictionary",value:function(e,t){return this.workerPromise.emit("getPageDictionary",{docId:e,pageId:t})}},{key:"getPDFDictInfo",value:function(e){return this.workerPromise.emit("getPDFDictInfo",{docId:e})}},{key:"startFormDesignerAssit",value:function(e){return this.workerPromise.emit("startFormDesignerAssit",{docId:e})}},{key:"stopFormDesignerAssit",value:function(e){return this.workerPromise.emit("stopFormDesignerAssit",{docId:e})}},{key:"getPageLabels",value:function(e,t){return this.workerPromise.emit("getPageLabels",{docId:e,indexes:t})}},{key:"hasKey",value:function(e,t,n){return this.workerPromise.emit("hasKey",{docId:e,id:t,key:n})}},{key:"setAt",value:function(e,t,n,i){return this.workerPromise.emit("setAt",{docId:e,id:t,key:n,value:i})}},{key:"getAt",value:function(e,t,n){return this.workerPromise.emit("getAt",{docId:e,id:t,key:n})}},{key:"getSuggestedFormDesignerRect",value:function(e,t,n){return this.workerPromise.emit("getSuggestedFormDesignerRect",{docId:e,pageId:t,point:n})}},{key:"autoRecognitionForm",value:function(e){return this.workerPromise.emit("autoRecognitionForm",{docId:e})}},{key:"isStaticXFA",value:function(e){return this.workerPromise.emit("isStaticXFA",{docId:e})}},{key:"isXFA",value:function(e){return this.workerPromise.emit("isXFA",{docId:e})}},{key:"removeXFA",value:function(e){return this.workerPromise.emit("removeXFA",{docId:e})}},{key:"getAllXFAWidgetsByPageIndex",value:function(e,t){return this.workerPromise.emit("getAllXFAWidgetsByPageIndex",{docId:e,pageIndex:t})}},{key:"triggerXFAWidgetEvent",value:function(e,t,n){return this.workerPromise.emit("triggerXFAWidgetEvent",{docId:e,pageIndex:t,info:n})}},{key:"createWebLinks",value:function(e,t,n){return this.workerPromise.emit("createWebLinks",{docId:e,pageId:t,paramPages:n})}},{key:"removeWebLinks",value:function(e,t,n){return this.workerPromise.emit("removeWebLinks",{docId:e,pageId:t,paramPages:n})}},{key:"linkHasPA",value:function(e,t,n){return this.workerPromise.emit("linkHasPA",{docId:e,pageId:t,annotId:n})}},{key:"linkResetAByPA",value:function(e,t,n){return this.workerPromise.emit("linkResetAByPA",{docId:e,pageId:t,annotId:n})}},{key:"getDestinationsArray",value:function(e){return this.workerPromise.emit("getDestinationsArray",{docId:e})}},{key:"deleteDestination",value:function(e,t,n){return this.workerPromise.emit("deleteDestination",{docId:e,pageId:t,name:n})}},{key:"renameDestination",value:function(e,t,n,i){return this.workerPromise.emit("renameDestination",{docId:e,pageId:t,oldName:n,newName:i})}},{key:"createDestination",value:function(e,t,n,i){return this.workerPromise.emit("createDestination",{docId:e,pageId:t,title:n,pageNum:i})}},{key:"resetDestination",value:function(e,t,n,i){return this.workerPromise.emit("resetDestination",{docId:e,pageId:t,title:n,pageNum:i})}},{key:"moveBookmark",value:function(e,t,n,i,r){return this.workerPromise.emit("moveBookmark",{docId:e,targetBookmarkId:t,destBookmarkId:n,position:i,isOldVersion:r})}},{key:"combineFormsToCSV",value:function(e,t){var n=this,i=this.workerPromise.calls(t),r=this.workerPromise.emit("combineFormsToCSV",{filesArray:e,writeStreamCall:i});return r.finally((function(){n.workerPromise.releaseCall(i)})),r}},{key:"addAnnotObjects",value:function(e,t,n){return this.workerPromise.emit("addAnnotObjects",{docId:e,pageId:t,objects:n})}},{key:"reversePages",value:function(e,t){return this.workerPromise.emit("reversePages",{docId:e,pageRanges:t})}},{key:"movePagesTo",value:function(e,t,n){return this.workerPromise.emit("movePagesTo",{docId:e,pageRange:t,destIndex:n})}},{key:"removePages",value:function(e,t){return this.workerPromise.emit("removePages",{docId:e,pageRange:t})}},{key:"insertBlankPages",value:function(e,t,n,i){return this.workerPromise.emit("insertBlankPages",{docId:e,pageRange:t,width:n,height:i})}},{key:"insertBlankPages2",value:function(e,t,n,i){return this.workerPromise.emit("insertBlankPages2",{docId:e,pageRange:t,width:n,height:i})}},{key:"rotatePages",value:function(e,t,n){return this.workerPromise.emit("rotatePages",{docId:e,pageRange:t,rotation:n})}},{key:"getPageIndexByLabelText",value:function(e,t){return this.workerPromise.emit("getPageIndexByLabelText",{docId:e,text:t})}},{key:"getCurrentPageLabelInfo",value:function(e,t){return this.workerPromise.emit("getCurrentPageLabelInfo",{docId:e,pageIndex:t})}},{key:"checkDocIsUseLogicPage",value:function(e){return this.workerPromise.emit("checkDocIsUseLogicPage",{docId:e})}},{key:"formatPageNumbers",value:function(e,t,n,i){return this.workerPromise.emit("formatPageNumbers",{docId:e,isExtendNumbering:t,pageRange:n,numberingInfo:i})}},{key:"updatePageLabelsByAction",value:function(e,t,n){return this.workerPromise.emit("updatePageLabelsByAction",{docId:e,action:t,args:n})}},{key:"getPortfolioTreeNode",value:function(e){return this.workerPromise.emit("getPortfolioTreeNode",{docId:e})}},{key:"getPortfolioInitialNodePath",value:function(e){return this.workerPromise.emit("getPortfolioInitialNodePath",{docId:e})}},{key:"sendSortFolioParam",value:function(e,t,n){return this.workerPromise.emit("sendSortFolioParam",{docId:e,target:t,order:n})}},{key:"getFolioNodePDFDoc",value:function(e){return this.workerPromise.emit("getFolioNodePDFDoc",{docId:e})}},{key:"recordPDFFileByPortFolioNode",value:function(e,t){return this.workerPromise.emit("recordPDFFileByPortFolioNode",{docId:e,handle:t})}},{key:"getPortfolioFileStream",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("getPortfolioFileStream",{docId:e,nodeHandle:t,writeStream:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"getPortfolioStream",value:function(e,t){return this.workerPromise.emit("getPortfolioStream",{docId:e,nodeHandles:t})}},{key:"getPortfolioSubNodes",value:function(e,t){return this.workerPromise.emit("getPortfolioSubNodes",{docId:e,nodeHandle:t})}},{key:"changePortfolioSubNodesOrder",value:function(e,t,n,i){return this.workerPromise.emit("changePortfolioSubNodesOrder",{docId:e,nodeHandle:t,sourceIndexes:n,targetIndex:i})}},{key:"portfolioMoveSubNodeToSubFolderNode",value:function(e,t,n,i){return this.workerPromise.emit("portfolioMoveSubNodeToSubFolderNode",{docId:e,nodeHandle:t,sourceHandles:n,targetHandle:i})}},{key:"portfolioHasSameNameSubNode",value:function(e,t,n,i){return this.workerPromise.emit("portfolioHasSameNameSubNode",{docId:e,name:t,type:n,targetHandle:i})}},{key:"setPortfolioInitialViewMode",value:function(e,t){return this.workerPromise.emit("setPortfolioInitialViewMode",{docId:e,value:t})}},{key:"setPortfolioSortingOrder",value:function(e,t){return this.workerPromise.emit("setPortfolioSortingOrder",{docId:e,bool:t})}},{key:"setPortfolioOrderSchemaField",value:function(e,t){return this.workerPromise.emit("setPortfolioOrderSchemaField",{docId:e,keyName:t})}},{key:"deletePortfolioSchemaField",value:function(e,t){return this.workerPromise.emit("deletePortfolioSchemaField",{docId:e,index:t})}},{key:"addPortfolioSchemaField",value:function(e,t){return this.workerPromise.emit("addPortfolioSchemaField",{docId:e,name:t})}},{key:"changePortfolioSchemaFieldVisible",value:function(e,t,n){return this.workerPromise.emit("changePortfolioSchemaFieldVisible",{docId:e,index:t,isVisible:n})}},{key:"changePortfolioSchemaFieldPosition",value:function(e,t,n){return this.workerPromise.emit("changePortfolioSchemaFieldPosition",{docId:e,index:t,offset:n})}},{key:"getPortfolioInfo",value:function(e){return this.workerPromise.emit("getPortfolioInfo",{docId:e})}},{key:"setPortfolioInfo",value:function(e,t){return this.workerPromise.emit("setPortfolioInfo",{docId:e,info:t})}},{key:"portfolioAddFiles",value:function(e,t,n,i){return this.workerPromise.emit("portfolioAddFiles",{docId:e,files:t,targetIndex:n,folderNodeHandle:i})}},{key:"portfolioCreateFolder",value:function(e,t,n){return this.workerPromise.emit("portfolioCreateFolder",{docId:e,name:t,folderNodeHandle:n})}},{key:"portfolioRemoveSubNodes",value:function(e,t,n){return this.workerPromise.emit("portfolioRemoveSubNodes",{docId:e,folderNodeHandle:t,subNodeHandles:n})}},{key:"portfolioRegenerateTOC",value:function(e,t){return this.workerPromise.emit("portfolioRegenerateTOC",{docId:e,title:t})}},{key:"getSnappedPoint",value:function(e,t,n,i){return this.workerPromise.emit("getSnappedPoint",{docId:e,pageId:t,point:n,mode:i})}},{key:"getPageTextRectCount",value:function(e,t){return this.workerPromise.emit("getPageTextRectCount",{docId:e,pageId:t})}},{key:"getPageTextByRectIndex",value:function(e,t,n){return this.workerPromise.emit("getPageTextByRectIndex",{docId:e,pageId:t,rectIndex:n})}},{key:"isCPDF",value:function(e){return this.workerPromise.emit("isCPDF",{docId:e})}},{key:"getDocURI",value:function(e){return this.workerPromise.emit("getDocURI",{docId:e})}},{key:"convertToCPDF",value:function(e,t,n,i,r){return this.workerPromise.emit("convertToCPDF",{docId:e,cPDFFileName:t,cPDFEndPoint:n,cPDFUserToken:i,cPDFUserIDFromToken:r})}},{key:"removeCDocId",value:function(e,t,n,i,r){return this.workerPromise.emit("removeCDocId",{docId:e,cPDFFileName:t,cPDFEndPoint:n,cPDFUserToken:i,cPDFUserIDFromToken:r})}},{key:"changePEProperty",value:function(e,t,n,i){return this.workerPromise.emit("changePEProperty",{docId:e,type:n,fn:t,param:i})}},{key:"handlePageEditorEvent",value:function(e,t,n){for(var i=arguments.length,r=new Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];return this.workerPromise.emit("handlePageEditorEvent",{docId:e,fn:t,delay:n,args:r})}},{key:"reInitPageEditor",value:function(e){return this.workerPromise.emit("reInitPageEditor",{docId:e})}},{key:"updateWinlessMatrix",value:function(e,t,n){return this.workerPromise.emit("updateWinlessMatrix",{docId:e,type:t,matrixes:n})}},{key:"changeEditingProperty",value:function(e,t,n){return this.workerPromise.emit("changeEditingProperty",{docId:e,fn:t,args:n})}},{key:"triggerPopMenuAction",value:function(e,t){return this.workerPromise.emit("triggerPopMenuAction",{docId:e,action:t})}},{key:"removeMetadata",value:function(e,t){return this.workerPromise.emit("removeMetadata",{id:e,key:t})}},{key:"getViewerPreference",value:function(e){return this.workerPromise.emit("getViewerPreference",{docId:e})}},{key:"setViewPreference",value:function(e,t,n){return this.workerPromise.emit("setViewPreference",{docId:e,key:t,value:n})}},{key:"handleTouchUpEvent",value:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this.workerPromise.emit("handleTouchUpEvent",{docId:e,fn:t,args:i})}},{key:"handleFindReplaceEvent",value:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this.workerPromise.emit("handleFindReplaceEvent",{docId:e,fn:t,args:i})}},{key:"triggerTUPopMenuAction",value:function(e,t,n){return this.workerPromise.emit("triggerTUPopMenuAction",{docId:e,action:t,args:n})}},{key:"removeLayerNode",value:function(e,t){return this.workerPromise.emit("removeLayerNode",{docId:e,layerId:t})}},{key:"getLayersByPage",value:function(e,t){return this.workerPromise.emit("getLayersByPage",{docId:e,pageId:t})}},{key:"updateLayerInfo",value:function(e,t){return this.workerPromise.emit("updateLayerInfo",{docId:e,layerInfo:t})}},{key:"flattenLayers",value:function(e){return this.workerPromise.emit("flattenLayers",{docId:e})}},{key:"mergeLayers",value:function(e,t,n){return this.workerPromise.emit("mergeLayers",{docId:e,layerIds:t,mergeTo:n})}},{key:"getLayerRelatedAnnots",value:function(e,t){return this.workerPromise.emit("getLayerRelatedAnnots",{docId:e,layerId:t})}},{key:"layerMoveTo",value:function(e,t,n,i){return this.workerPromise.emit("layerMoveTo",{docId:e,layerId:t,parentLayerId:n,index:i})}},{key:"getInfos",value:function(e){return this.workerPromise.emit("getInfos",{docId:e})}},{key:"hasDocIsWrapped",value:function(e){return this.workerPromise.emit("hasDocIsWrapped",{docId:e})}},{key:"getEmbeddedFontData",value:function(e){return this.workerPromise.emit("getEmbeddedFontData",{docId:e})}},{key:"computeAuditSpace",value:function(e){return this.workerPromise.emit("computeAuditSpace",{docId:e})}},{key:"optimizer",value:function(e,t,n){return this.workerPromise.emit("optimizer",{docId:e,option:t,portfolioNodeHandle:n})}},{key:"optimizeScannedPDF",value:function(e,t,n){var i=this,r=this.workerPromise.calls(n),o=this.workerPromise.emit("optimizeScannedPDF",{docId:e,option:t,callback:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"startReplacePages",value:function(e,t,n,i,r){return this.workerPromise.emit("startReplacePages",{docId:e,startIndex:t,count:n,srcPdfDocId:i,srcPageindexRange:r})}},{key:"importAsLayer",value:function(e,t){return this.workerPromise.emit("importAsLayer",{docId:e,args:t})}},{key:"previewImportLayer",value:function(e,t){return this.workerPromise.emit("previewImportLayer",{docId:e,args:t})}},{key:"reloadLayer",value:function(e){return this.workerPromise.emit("reloadLayer",{docId:e})}},{key:"cloneGraphicObject",value:function(e,t,n,i){return this.workerPromise.emit("cloneGraphicObject",{docId:e,pageId:t,srcPageId:n,ids:i})}},{key:"compareDoc",value:function(e){var t={baseDocId:e.baseDocId,basePageCount:e.basePageCount,basePageIndex:e.basePageIndex,baseFileName:e.baseFileName,compareDocId:e.compareDocId,comparedPageCount:e.comparedPageCount,comparePageIndex:e.comparePageIndex,comparePageNum:e.comparePageNum,compareFileName:e.compareFileName,newTemplateId:e.newTemplateId,oldTemplateId:e.oldTemplateId,inputOptions:e.options,compareResultStrings:e.compareResultStrings};return this.workerPromise.emit("compareDoc",{compareDocParam:t})}},{key:"searchDoc",value:function(e,t,n,i,r){return this.workerPromise.emit("searchDoc",{docId:e,type:t,words:n,flag:i,isForRedact:r})}},{key:"generateDocHash",value:function(e,t){return this.workerPromise.emit("generateDocHash",{docId:e,buffer:t})}},{key:"getSignIdForEvidence",value:function(e){return this.workerPromise.emit("getSignIdForEvidence",{docId:e})}},{key:"assignSignerForESignCN",value:function(e,t){return this.workerPromise.emit("assignSignerForESignCN",{docId:e,data:t})}},{key:"setESignCNFlowSignMode",value:function(e,t){return this.workerPromise.emit("setESignCNFlowSignMode",{docId:e,type:t})}},{key:"getESignCNFlowSignMode",value:function(e){return this.workerPromise.emit("getESignCNFlowSignMode",{docId:e})}},{key:"isESignCNFile",value:function(e){return this.workerPromise.emit("isESignCNFile",{docId:e})}},{key:"getESignCNMode",value:function(e,t){return this.workerPromise.emit("getESignCNMode",{docId:e,fieldName:t})}},{key:"isESignCNSignature",value:function(e,t,n){return this.workerPromise.emit("isESignCNSignature",{docId:e,fieldId:t,pageIndex:n})}},{key:"addAuditTrail",value:function(e){return this.workerPromise.emit("addAuditTrail",{docId:e})}},{key:"getDocAuditTrail",value:function(e,t,n){return this.workerPromise.emit("getDocAuditTrail",{docId:e,buffer:t,flowSignAnnots:n})}},{key:"destroyForm",value:function(e){return this.workerPromise.emit("destroyForm",{docId:e})}},{key:"updatePropAuthDictForESignCN",value:function(e,t,n){return this.workerPromise.emit("updatePropAuthDictForESignCN",{docId:e,fieldName:t,willingnessInfo:n})}},{key:"getAssignInfoForESignCN",value:function(e){return this.workerPromise.emit("getAssignInfoForESignCN",{docId:e})}},{key:"getOrderOfSignFlowFile",value:function(e){return this.workerPromise.emit("getOrderOfSignFlowFile",{docId:e})}},{key:"checkFieldWhetherFill",value:function(e,t){return this.workerPromise.emit("checkFieldWhetherFill",{docId:e,emailValue:t})}},{key:"setSignatureAP",value:function(e,t,n,i,r){return this.workerPromise.emit("setSignatureAP",{docId:e,pageIndex:t,annotId:n,inkSignBuffer:i,pagingSigObjNum:r})}},{key:"getFlowSignInfo",value:function(e){return this.workerPromise.emit("getFlowSignInfo",{docId:e})}},{key:"addPagingSealSignature",value:function(e,t){return this.workerPromise.emit("addPagingSealSignature",{docId:e,pagingSigConfig:t})}},{key:"updatePagingSealSignature",value:function(e,t,n){return this.workerPromise.emit("updatePagingSealSignature",{docId:e,pagingSigConfig:t,pagingSigObjNum:n})}},{key:"getAllPagingSealSignatures",value:function(e,t){return this.workerPromise.emit("getAllPagingSealSignatures",{docId:e,pagingSigObjNum:t})}},{key:"removePagingSealSignature",value:function(e,t){return this.workerPromise.emit("removePagingSealSignature",{docId:e,pagingSigObjNum:t})}},{key:"getAllPagingSigsInfo",value:function(e,t){return this.workerPromise.emit("getAllPagingSigsInfo",{docId:e,pagingSigObjNum:t})}},{key:"normalizePage",value:function(e,t){return this.workerPromise.emit("normalizePage",{docId:e,pageId:t})}},{key:"getViewportRect",value:function(e,t){return this.workerPromise.emit("getViewportRect",{docId:e,pageId:t})}},{key:"getMeasureScaleRatio",value:function(e,t){return this.workerPromise.emit("getMeasureScaleRatio",{docId:e,pageId:t})}},{key:"setMeasureScaleRatio",value:function(e,t,n,i){return this.workerPromise.emit("setMeasureScaleRatio",{docId:e,pageId:t,storeInPage:n,measureInfo:i})}},{key:"exportMeasureData",value:function(e,t){return this.workerPromise.emit("exportMeasureData",{docId:e,columnNames:t})}},{key:"setRenderConfigLineWeight",value:function(e,t){return this.workerPromise.emit("setRenderConfigLineWeight",{docId:e,lineWeight:t})}},{key:"convertToTextMarkup",value:function(e,t){return this.workerPromise.emit("convertToTextMarkup",{docId:e,findResults:t})}},{key:"redactSearch",value:function(e,t,n,i,r,o){return this.workerPromise.emit("redactSearch",{docId:e,findResults:t,start:n,count:i,overlayTexts:r,opts:o})}},{key:"setRedactAppearance",value:function(e,t,n,i){return this.workerPromise.emit("setRedactAppearance",{docId:e,pageId:t,annotId:n,option:i})}},{key:"getCompareFileFilterNums",value:function(e){return this.workerPromise.emit("getCompareFileFilterNums",{docId:e})}},{key:"getPDFDocFromImageFile",value:function(e,t){return this.workerPromise.emit("getPDFDocFromImageFile",e,t)}},{key:"isScannedDoc",value:function(e){return this.workerPromise.emit("isScannedDoc",{docId:e})}},{key:"getPageCountAsync",value:function(e){return this.workerPromise.emit("getPageCountAsync",{docId:e})}},{key:"getPageTexts",value:function(e,t,n,i,r){return this.workerPromise.emit("getPageTexts",{docId:e,pageId:t,settings:n,minWidth:i,eol:r})}},{key:"hasOwnerPassword",value:function(e){return this.workerPromise.emit("hasOwnerPassword",{docId:e})}},{key:"removePDFAID",value:function(e){return this.workerPromise.emit("removePDFAID",{docId:e})}},{key:"setPageTransition",value:function(e,t,n,i,r){return this.workerPromise.emit("setPageTransition",{docId:e,transName:t,direction:n,speed:i,range:r})}},{key:"getPageTransitionByIndex",value:function(e,t){return this.workerPromise.emit("getPageTransitionByIndex",{docId:e,pageIndex:t})}},{key:"getStampTypeByPageIndex",value:function(e,t){return this.workerPromise.emit("getStampTypeByPageIndex",{docId:e,pageIndex:t})}},{key:"getText",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(i),a=this.workerPromise.emit("getText",{docId:e,pageRange:t,taskId:n,taskProgress:o});return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"cancelTaskProgress",value:function(e,t){return this.workerPromise.emit("cancelTaskProgress",{docId:e,taskId:t})}},{key:"isScannedPage",value:function(e,t){return this.workerPromise.emit("isScannedPage",{docId:e,pageId:t})}},{key:"createSummarizeComments",value:function(e,t,n){var i=this,r=this.workerPromise.calls(t),o=this.workerPromise.emit("createSummarizeComments",{docId:e,param:n,writeStream:r});return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"getPageTransition",value:function(e,t){return this.workerPromise.emit("getPageTransition",{docId:e,pageId:t})}},{key:"hiddenDataSanitizeDocument",value:function(e){return this.workerPromise.emit("hiddenDataSanitizeDocument",{docId:e})}},{key:"hiddenDataRemoveHiddenInfo",value:function(e,t){return this.workerPromise.emit("hiddenDataRemoveHiddenInfo",{docId:e,options:t})}},{key:"cacheFontConfig",value:function(e,t,n){return this.workerPromise.emit("cacheFontConfig",{fontServerRoot:e,notExistFonts:t,customUploadFonts:n})}},{key:"getFxcoreFontList",value:function(){return this.workerPromise.emit("getFxcoreFontList")}},{key:"getPureTexts",value:function(e,t,n){return this.workerPromise.emit("getPureTexts",{docId:e,pageId:t,lr:n})}},{key:"getLRContentForChatWithDoc",value:function(e,t){return this.workerPromise.emit("getLRContentForChatWithDoc",{docId:e,options:t})}},{key:"getDocPurText",value:function(e){return this.workerPromise.emit("getDocPurText",{docId:e})}},{key:"docCanDoOcr",value:function(e){return this.workerPromise.emit("docCanDoOcr",{docId:e})}},{key:"fetchContentByType",value:function(e,t){return this.workerPromise.emit("fetchContentByType",{docId:e,options:t})}},{key:"getFATLAndEUTLList",value:function(e,t){return this.workerPromise.emit("getFATLAndEUTLList",{urls:e,isUpdate:t})}},{key:"getTextInRect",value:function(e,t,n,i){return this.workerPromise.emit("getTextInRect",{docId:e,pageId:t,rect:n,type:i})}},{key:"previewIconDoc",value:function(e){return this.workerPromise.emit("previewIconDoc",{icon:e})}},{key:"getAnnotRects",value:function(e,t){return this.workerPromise.emit("getAnnotRects",{docId:e,pageId:t})}},{key:"transformPage",value:function(e,t,n){return this.workerPromise.emit("transformPage",{docId:e,pageId:t,options:n})}},{key:"getSignatureBitmap",value:function(e,t){return this.workerPromise.emit("getSignatureBitmap",{docId:e,fieldName:t})}},{key:"setSignatureBitmap",value:function(e,t,n){return this.workerPromise.emit("setSignatureBitmap",{docId:e,fieldName:t,buffer:n})}},{key:"getGraphicsObjectsByRect",value:function(e,t,n,i,r,o){return this.workerPromise.emit("getGraphicsObjectsByRect",{docId:e,pageId:t,rect:n,tolerance:i,type:r,isInRect:o})}},{key:"removeAllEmbeddedFiles",value:function(e){return this.workerPromise.emit("removeAllEmbeddedFiles",{docId:e})}},{key:"getEmbeddedFileNames",value:function(e){return this.workerPromise.emit("getEmbeddedFileNames",{docId:e})}},{key:"comparePDFDocuments",value:function(e,t,n,i){return this.workerPromise.emit("comparePDFDocuments",{docId:e,otherDocId:t,params:n,progressId:i})}},{key:"getCharBBox",value:function(e,t){return this.workerPromise.emit("getCharBBox",{fontId:e,unicode:t})}},{key:"getCharWidthByFontID",value:function(e,t){return this.workerPromise.emit("getCharWidthByFontID",{fontId:e,unicode:t})}},{key:"getFontToneByFontID",value:function(e){return this.workerPromise.emit("getFontToneByFontID",{fontId:e})}},{key:"updateCalloutFigure",value:function(e,t,n,i,r,o){return this.workerPromise.emit("updateCalloutFigure",{docId:e,pageId:t,annotId:n,outerRect:i,innerRect:r,calloutLinePoints:o})}},{key:"clearPageRenderCache",value:function(e,t){return this.workerPromise.emit("clearPageRenderCache",{docId:e,pageId:t})}},{key:"updateRectFigure",value:function(e,t,n,i,r){return this.workerPromise.emit("updateRectFigure",{docId:e,pageId:t,annotId:n,outerRect:i,innerRect:r})}},{key:"drawTextString",value:function(e,t){return this.workerPromise.emit("drawTextString",{docId:e,font:t})}},{key:"loadAdvEditorConfigFile",value:function(e,t,n){return this.workerPromise.emit("loadAdvEditorConfigFile",{docId:e,fileBuffer:t,moduleName:n})}},{key:"setAdvEditorTextToolStyle",value:function(e,t){return this.workerPromise.emit("setAdvEditorTextToolStyle",{docId:e,style:t})}},{key:"setAdvEditorEditingObjectToolStyle",value:function(e,t){return this.workerPromise.emit("setAdvEditorEditingObjectToolStyle",{docId:e,style:t})}}]),n}(h.Z);const w=new Proxy(b,{construct:function(e,t){return new Proxy((0,u._)(e,(0,d._)(t)),k)}});function _(e){e.on("wasmBinary",(function(e){localStorage.setItem(p,e)})),e.on("asmMem",(function(e){localStorage.setItem(m,e)})),e.on("asmJs",(function(e){localStorage.setItem(y,e)}))}const P=function(e){return function(e){(0,o._)(n,e);var t=(0,a._)(n);function n(e,r,o){var a;return(0,i._)(this,n),(a=t.call(this,e,r,o)).api=new w(e),o.configuration&&a.updateConfigurations(o.configuration),a}return(0,r._)(n,[{key:"registerSecurityCallback",value:function(e,t){return this.api.registerSecurityCallback(e,t)}},{key:"registerCustomWebPluginSecurityCallback",value:function(e,t,n){return this.api.registerCustomWebPluginSecurityCallback(e,t,n)}},{key:"unRegisterSecurityHandler",value:function(e,t){return this.api.unRegisterSecurityHandler(e,t)}},{key:"setFontMap",value:function(e){return this.api.setFontMap(e)}},{key:"setWatermarkFontMap",value:function(e){return this.api.setWatermarkFontMap(e)}},{key:"addFontMap",value:function(e){return this.api.addFontMap(e)}},{key:"getCharBBox",value:function(e,t){return this.api.getCharBBox(e,t)}},{key:"getCharWidthByFontID",value:function(e,t){return this.api.getCharWidthByFontID(e,t)}},{key:"getFontToneByFontID",value:function(e){return this.api.getFontToneByFontID(e)}},{key:"setJPXDownSample",value:function(e){return this.api.setJPXDownSample(e)}},{key:"cacheFontConfig",value:function(e,t,n){return this.api.cacheFontConfig(e,t,n)}},{key:"getFxcoreFontList",value:function(){return this.api.getFxcoreFontList()}},{key:"getFATLAndEUTLList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.api.getFATLAndEUTLList(e,t)}},{key:"updateConfigurations",value:function(e){return this.configuration=(0,s.extendOptions)({},this.configuration||{},e),this.api.setConfiguration({path:"jr"},e)}}]),n}(e)}},1322:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var i=n(4375),r=n(6147),o=n(216),a=n(6721),s=n(7327),u=n(8095),c="0.15892419966282523";function l(e){var t=Object.getOwnPropertyNames(e.prototype);return function(e){(0,r._)(l,e);var n=(0,o._)(l);function l(e){var r,o=function(e){var n=t[e],i=f.indexOf(n);if(-1!==i)return f.splice(i,1),"continue";r[n]=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return h.emit(n,t)}};(0,i._)(this,l),r=n.call(this,e);var a=e.workerPath,s=e.workerBlobUrl;"/"!==a.slice(-1)&&(a+="/");for(var d=new Worker(s||a+"WebPDFSRWorker.js?h="+c),h=r.workerPromise=new u.Z(d),f=Object.getOwnPropertyNames(r.constructor.prototype),g=t.length;g--;)o(g);return r}return(0,a._)(l,[{key:"init",value:function(){return this.workerPromise.emit("initSREngine",this.option)}},{key:"getPDFDocIdByFile",value:function(e,t){var n=function(e){var t=[];return(0,s._)(e,ArrayBuffer)&&(t=[e]),t}(e);return this.workerPromise.emit("getPDFDocByFile",[e,t],n)}},{key:"getPDFDocStream",value:function(e,t,n){var i=this,r=this.workerPromise.calls(t),o=this.workerPromise.emit("getPDFDocStream",[e,r,n]);return o.finally((function(){i.workerPromise.releaseCall(r)})),o}},{key:"getFileattachmentStream",value:function(e,t,n,i){var r=this,o=this.workerPromise.calls(i),a=this.workerPromise.emit("getFileattachmentStream",[e,t,n,o]);return a.finally((function(){r.workerPromise.releaseCall(o)})),a}},{key:"resetEngine",value:function(e){return this.workerPromise.emit("resetEngine",[e])}}]),l}(e)}const d=function(e){return function(e){(0,r._)(n,e);var t=(0,o._)(n);function n(e,r,o){var a;return(0,i._)(this,n),(a=t.call(this,e,r,o)).api=new(l(a.api.constructor))(e),a}return n}(e)}},8990:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={s:"ein paar Sekunden",m:["eine Minute","einer Minute"],mm:"%d Minuten",h:["eine Stunde","einer Stunde"],hh:"%d Stunden",d:["ein Tag","einem Tag"],dd:["%d Tage","%d Tagen"],M:["ein Monat","einem Monat"],MM:["%d Monate","%d Monaten"],y:["ein Jahr","einem Jahr"],yy:["%d Jahre","%d Jahren"]};function r(e,t,n){var r=i[n];return Array.isArray(r)&&(r=r[t?0:1]),r.replace("%d",e)}var o={name:"de",weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Feb._März_Apr._Mai_Juni_Juli_Aug._Sept._Okt._Nov._Dez.".split("_"),ordinal:function(e){return e+"."},weekStart:1,yearStart:4,formats:{LTS:"HH:mm:ss",LT:"HH:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY HH:mm",LLLL:"dddd, D. MMMM YYYY HH:mm"},relativeTime:{future:"in %s",past:"vor %s",s:r,m:r,mm:r,h:r,hh:r,d:r,dd:r,M:r,MM:r,y:r,yy:r}};return n.default.locale(o,null,!0),o}(n(6244))},4883:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(e){return e+"º"}};return n.default.locale(i,null,!0),i}(n(6244))},5522:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"fr",weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(e){return e+(1===e?"er":"")}};return n.default.locale(i,null,!0),i}(n(6244))},890:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"it",weekdays:"domenica_lunedì_martedì_mercoledì_giovedì_venerdì_sabato".split("_"),weekdaysShort:"dom_lun_mar_mer_gio_ven_sab".split("_"),weekdaysMin:"do_lu_ma_me_gi_ve_sa".split("_"),months:"gennaio_febbraio_marzo_aprile_maggio_giugno_luglio_agosto_settembre_ottobre_novembre_dicembre".split("_"),weekStart:1,monthsShort:"gen_feb_mar_apr_mag_giu_lug_ago_set_ott_nov_dic".split("_"),formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"tra %s",past:"%s fa",s:"qualche secondo",m:"un minuto",mm:"%d minuti",h:"un' ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:function(e){return e+"º"}};return n.default.locale(i,null,!0),i}(n(6244))},859:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"ja",weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e){return e+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日 dddd HH:mm",l:"YYYY/MM/DD",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日(ddd) HH:mm"},meridiem:function(e){return e<12?"午前":"午後"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}};return n.default.locale(i,null,!0),i}(n(6244))},5576:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"ko",weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),ordinal:function(e){return e+"일"},formats:{LT:"A h:mm",LTS:"A h:mm:ss",L:"YYYY.MM.DD.",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 A h:mm",LLLL:"YYYY년 MMMM D일 dddd A h:mm",l:"YYYY.MM.DD.",ll:"YYYY년 MMMM D일",lll:"YYYY년 MMMM D일 A h:mm",llll:"YYYY년 MMMM D일 dddd A h:mm"},meridiem:function(e){return e<12?"오전":"오후"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇 초",m:"1분",mm:"%d분",h:"한 시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한 달",MM:"%d달",y:"일 년",yy:"%d년"}};return n.default.locale(i,null,!0),i}(n(6244))},3765:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"nl",weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"zo_ma_di_wo_do_vr_za".split("_"),months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_"),ordinal:function(e){return"["+e+(1===e||8===e||e>=20?"ste":"de")+"]"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"een minuut",mm:"%d minuten",h:"een uur",hh:"%d uur",d:"een dag",dd:"%d dagen",M:"een maand",MM:"%d maanden",y:"een jaar",yy:"%d jaar"}};return n.default.locale(i,null,!0),i}(n(6244))},1128:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e,t){return"W"===t?e+"周":e+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(e,t){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1100?"上午":n<1300?"中午":n<1800?"下午":"晚上"}};return n.default.locale(i,null,!0),i}(n(6244))},7074:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"zh-hk",months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),ordinal:function(e,t){return"W"===t?e+"週":e+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日dddd HH:mm",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"一分鐘",mm:"%d 分鐘",h:"一小時",hh:"%d 小時",d:"一天",dd:"%d 天",M:"一個月",MM:"%d 個月",y:"一年",yy:"%d 年"},meridiem:function(e,t){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1100?"上午":n<1300?"中午":n<1800?"下午":"晚上"}};return n.default.locale(i,null,!0),i}(n(6244))},579:function(e,t,n){e.exports=function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),i={name:"zh-tw",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e,t){return"W"===t?e+"週":e+"日"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日 HH:mm",LLLL:"YYYY年M月D日dddd HH:mm",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"1 分鐘",mm:"%d 分鐘",h:"1 小時",hh:"%d 小時",d:"1 天",dd:"%d 天",M:"1 個月",MM:"%d 個月",y:"1 年",yy:"%d 年"},meridiem:function(e,t){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1100?"上午":n<1300?"中午":n<1800?"下午":"晚上"}};return n.default.locale(i,null,!0),i}(n(6244))},1434:function(e){e.exports=function(){"use strict";return function(e,t){var n=t.prototype,i=n.format;n.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return i.bind(this)(e);var r=this.$utils(),o=(e||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case"Q":return Math.ceil((t.$M+1)/3);case"Do":return n.ordinal(t.$D);case"gggg":return t.weekYear();case"GGGG":return t.isoWeekYear();case"wo":return n.ordinal(t.week(),"W");case"w":case"ww":return r.s(t.week(),"w"===e?1:2,"0");case"W":case"WW":return r.s(t.isoWeek(),"W"===e?1:2,"0");case"k":case"kk":return r.s(String(0===t.$H?24:t.$H),"k"===e?1:2,"0");case"X":return Math.floor(t.$d.getTime()/1e3);case"x":return t.$d.getTime();case"z":return"["+t.offsetName()+"]";case"zzz":return"["+t.offsetName("long")+"]";default:return e}}));return i.bind(this)(o)}}}()},8366:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(i,r,o){var a=r.prototype;o.utc=function(e){return new r({date:e,utc:!0,args:arguments})},a.utc=function(t){var n=o(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},a.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var s=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var u=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else u.call(this)};var c=a.utcOffset;a.utcOffset=function(i,r){var o=this.$utils().u;if(o(i))return this.$u?0:o(this.$offset)?c.call(this):this.$offset;if("string"==typeof i&&(i=function(e){void 0===e&&(e="");var i=e.match(t);if(!i)return null;var r=(""+i[0]).match(n)||["-",0,0],o=r[0],a=60*+r[1]+ +r[2];return 0===a?0:"+"===o?a:-a}(i),null===i))return this;var a=Math.abs(i)<=16?60*i:i,s=this;if(r)return s.$offset=a,s.$u=0===i,s;if(0!==i){var u=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(a+u,e)).$offset=a,s.$x.$localOffset=u}else s=this.utc();return s};var l=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var d=a.toDate;a.toDate=function(e){return"s"===e&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var h=a.diff;a.diff=function(e,t,n){if(e&&this.$u===e.$u)return h.call(this,e,t,n);var i=this.local(),r=o(e).local();return h.call(i,r,t,n)}}}()},6244:t=>{"use strict";t.exports=e},449:e=>{"use strict";e.exports=t},8717:e=>{"use strict";e.exports=n},8189:e=>{"use strict";e.exports=i},1276:e=>{"use strict";e.exports=r},3214:e=>{"use strict";e.exports=o},1543:e=>{"use strict";e.exports=a},9903:e=>{"use strict";e.exports=s},1821:e=>{"use strict";e.exports=u},1416:e=>{"use strict";e.exports=c},2047:e=>{"use strict";e.exports=l},7686:e=>{"use strict";e.exports=d},9643:(e,t,n)=>{"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,{F:()=>i})},1556:(e,t,n)=>{"use strict";function i(e){if(Array.isArray(e))return e}n.d(t,{o:()=>i})},4702:(e,t,n)=>{"use strict";function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Q:()=>i,_:()=>i})},6448:(e,t,n)=>{"use strict";function i(e,t,n,i,r,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(i,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){i(a,r,o,s,u,"next",e)}function u(e){i(a,r,o,s,u,"throw",e)}s(void 0)}))}}n.d(t,{_:()=>r})},4375:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(7327);function r(e,t){if(!(0,i._)(e,t))throw new TypeError("Cannot call a class as a function")}},8490:(e,t,n)=>{"use strict";n.d(t,{L:()=>o,_:()=>o});var i=n(1162),r=n(548);function o(e,t,n){return o=(0,i.R)()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&(0,r.b)(o,n.prototype),o},o.apply(null,arguments)}},6721:(e,t,n)=>{"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,{_:()=>r})},216:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});var i=n(6841),r=n(1162),o=n(9307);function a(e){var t=(0,r.R)();return function(){var n,r=(0,i.X)(e);if(t){var a=(0,i.X)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,o.v)(this,n)}}},5136:(e,t,n)=>{"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{_:()=>i,j:()=>i})},2834:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(6841);function r(e,t,n){return r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,i.X)(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n||e):o.value}},r(e,t,n||e)}},6841:(e,t,n)=>{"use strict";function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}n.d(t,{X:()=>i,_:()=>i})},6147:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(548);function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&(0,i.b)(e,t)}},7327:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(7327);function r(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):(0,i._)(e,t)}},1162:(e,t,n)=>{"use strict";function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n.d(t,{R:()=>i})},5706:(e,t,n)=>{"use strict";function i(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{f:()=>i})},2640:(e,t,n)=>{"use strict";function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{i:()=>i})},9422:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(5136);function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){(0,i.j)(e,t,n[t])}))}return e}},6784:(e,t,n)=>{"use strict";function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}n.d(t,{_:()=>i})},9307:(e,t,n)=>{"use strict";n.d(t,{_:()=>o,v:()=>o});var i=n(4702),r=n(5171);function o(e,t){return!t||"object"!==(0,r.j)(t)&&"function"!=typeof t?(0,i.Q)(e):t}},548:(e,t,n)=>{"use strict";function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}n.d(t,{b:()=>i})},3638:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});var i=n(1556);var r=n(2640),o=n(2430);function a(e,t){return(0,i.o)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(e,t)||(0,o.N)(e,t)||(0,r.i)()}},6699:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});var i=n(9643);var r=n(5706);var o=n(2430);function a(e){return function(e){if(Array.isArray(e))return(0,i.F)(e)}(e)||(0,r.f)(e)||(0,o.N)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},5171:(e,t,n)=>{"use strict";function i(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}n.d(t,{_:()=>i,j:()=>i})},2430:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});var i=n(9643);function r(e,t){if(e){if("string"==typeof e)return(0,i.F)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,i.F)(e,t):void 0}}},7582:(e,t,n)=>{"use strict";n.d(t,{Jh:()=>i});function i(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError}},f={};function g(e){var t=f[e];if(void 0!==t)return t.exports;var n=f[e]={id:e,loaded:!1,exports:{}};return h[e].call(n.exports,n,n.exports,g),n.loaded=!0,n.exports}g.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return g.d(t,{a:t}),t},g.d=(e,t)=>{for(var n in t)g.o(t,n)&&!g.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},g.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),g.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},g.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var v={};return(()=>{"use strict";g.r(v),g.d(v,{ActivationGroup:()=>hx,AnnotComponent:()=>To,AnnotationApRenderer:()=>tc,AnnotationAuthorityManager:()=>e_,BrowserInfo:()=>j.BrowserInfo,CalloutShape:()=>Jd,CaretComponent:()=>md,CircleComponent:()=>vl,CombindForms:()=>FS,Consts:()=>t,CustomScrollWrap:()=>IA,Deps:()=>JS,DeviceInfo:()=>j.DeviceInfo,DivScrollWrap:()=>GS,DocCustomRender:()=>ha,Events:()=>de,FakeAreaHighlightAnnotation:()=>WS,FakeCircleAnnotation:()=>VS,FakeLineAnnotation:()=>$S,FakePolygonAnnotation:()=>qS,FakePolylineAnnotation:()=>YS,FakeSquareAnnotation:()=>NS,FileAttachmentComponent:()=>vd,FontUtil:()=>u,FormRender:()=>wa,FreeTextBoxComponent:()=>dh,FreeTextCalloutComponent:()=>ch,FreeTextComponent:()=>Wd,FreeTextTypeWritterComponent:()=>Kd,HighlightComponent:()=>ac,HtmlUtil:()=>a,IContextMenu:()=>Om,IStateHandler:()=>Ha,IViewMode:()=>ta,InkComponent:()=>Pd,KeyboardUtils:()=>j.KeyboardUtils,LineComponent:()=>Tc,LinkAnnotComponent:()=>dl,LocalCanvasApRenderer:()=>nc,Log:()=>tx,MarkupAnnotComponent:()=>ku,Matrix:()=>nn.Z,NoteComponent:()=>hd,PDF:()=>sx,PDFDocRendering:()=>da,PDFPageRendering:()=>H,PDFPreviewer:()=>US,PDFViewer:()=>RP,PDFViewerRendering:()=>V,PageCustomRender:()=>W,PolyLineComponent:()=>Hc,PolygonCloudAnnotComponent:()=>Od,PolygonComponent:()=>Qc,PropertiesControl:()=>uu,RetryPasswordComponent:()=>Vs,STATE_HANDLER_NAMES:()=>r,ScreenComponent:()=>Gf,ScrollWrap:()=>ja,ShapeControl:()=>zu,SignatureUtil:()=>f,SnappedPointAssistant:()=>Dc,SnapshotServer:()=>km,SoundComponent:()=>rg,SquareComponent:()=>kd,SquigglyComponent:()=>hc,StampComponent:()=>wd,StrikeOutComponent:()=>uc,StrikeOutTextEditComponent:()=>Jf,TextMarkupAnnotComponent:()=>ec,TileJREngineApRenderer:()=>fd,UnderlineComponent:()=>lc,UserPermission:()=>fa,ViewerEvents:()=>zS,_internal:()=>fx,bookmark:()=>vx,collab:()=>lx,commons:()=>j,constants:()=>ux,creation:()=>ex,interfaces:()=>ox,keyboard:()=>cx,overlayComparison:()=>ZS,printer:()=>dx,readAloud:()=>p,renderers:()=>gx,shared:()=>QS,stateHandler:()=>nx,storage:()=>y,ui:()=>rx,vendors:()=>XS,viewMode:()=>ix,viewerui:()=>ax});var e={};g.r(e),g.d(e,{Activatable:()=>X,ActivationGroup:()=>Z,ActivationManager:()=>Q});var t={};g.r(t),g.d(t,{ANNOT_APPEARANCE_TYPE:()=>Ue,AnnotFlagsName:()=>Pe,BORDER_STYLE:()=>me,CREATING_DRAWING_CONTEXTMENU:()=>De,CREATING_MEASUREMENT_CONTEXTMENU:()=>Ce,CUSTOM_STAMPS_LOCALKEY:()=>He,DB_PREFIX:()=>Me,DISTANCE_TOLERANCE:()=>Re,EMPTY_STR:()=>Fe,FAVORITE_STAMPS_LOCALKEY:()=>We,HIDE_FORM_FIELD_PROPERTY_BOX:()=>Le,HIDE_FORM_FIELD_SIMPLE_PROPERTY_BOX:()=>Ne,HIGHLIGHTING_MODE:()=>Ee,INTERNAL_THUMBNAIL_BITMAP_HEIGHT:()=>je,INTERNAL_THUMBNAIL_BITMAP_WIDTH:()=>Be,Intents:()=>ke,LINE_CAPTION_POSITION:()=>_e,LineEndingName:()=>be,LineEndingStyle:()=>we,MARKUP_ANNOTATION_STATE:()=>ve,MEASUREMENT_INFO:()=>Ve,MODULE_NAME_TYPE:()=>Ye,MeasureType:()=>Se,PDFDocPermission:()=>Ae,POINT_TOLERANCE:()=>Te,POINT_TYPE:()=>ye,POS_TYPE:()=>pe,RESOLVED_PROMISE_VOID:()=>Ie,SET_FORM_CREATION_CONTINUOUSLY:()=>Oe,STORE_NAMES:()=>xe});var n={};g.r(n),g.d(n,{Action_Trigger:()=>St,Action_Type:()=>ot,Additional_Permission:()=>Xe,AdvEditor:()=>Ht,Alignment:()=>it,Border_Style:()=>Qe,Box_Type:()=>Ct,Calc_Margin_Mode:()=>xt,CornerMarkStyle:()=>Bt,Ending_Style:()=>nt,Error_Code:()=>Je,FileAttachment_Icon:()=>et,File_Type:()=>ut,FillSignType:()=>Nt,Flatten_Option:()=>ct,Font_CIDCharset:()=>Tt,Font_Charset:()=>Rt,Font_Descriptor_Flags:()=>_t,Font_StandardID:()=>Et,Font_Style:()=>Ze,Font_Styles:()=>It,Graphics_FillMode:()=>Ft,Graphics_ObjectType:()=>Mt,Highlight_Mode:()=>at,MK_Properties:()=>Ot,NameTreeType:()=>Vt,NewWindowFlag:()=>Ut,Note_Icon:()=>tt,Point_Type:()=>rt,PosType:()=>Lt,Position:()=>lt,Range_Filter:()=>mt,Relationship:()=>st,Rendering_Content:()=>yt,Rendering_Usage:()=>kt,Rotation:()=>ft,Rotation_Degree:()=>gt,STAMP_TEXT_TYPE:()=>jt,Saving_Flag:()=>pt,Search_Flag:()=>vt,Signature_Ap_Flags:()=>At,Signature_State:()=>Pt,Standard_Font:()=>ht,Text_Mode:()=>Dt,Watermark_Flag:()=>dt,date_Format:()=>bt,page_Number_Format:()=>wt});var i={};g.r(i),g.d(i,{allIsSpace:()=>sn,debounce:()=>an,getQuadPointsFromRect:()=>on,normalizeQuadPoints:()=>rn,verifyRect:()=>un});var r={};g.r(r),g.d(r,{STATE_HANDLER_CHECK_THE_SEARCH:()=>yn,STATE_HANDLER_CREATE_AREA:()=>Tn,STATE_HANDLER_CREATE_AREA_HIGHLIGHT:()=>_n,STATE_HANDLER_CREATE_ARROW:()=>bn,STATE_HANDLER_CREATE_ARTICLE_BUTTON:()=>ci,STATE_HANDLER_CREATE_CARET:()=>kn,STATE_HANDLER_CREATE_CIRCLE:()=>Pn,STATE_HANDLER_CREATE_CIRCLE_AREA:()=>Fn,STATE_HANDLER_CREATE_CREATE_AREA_HIGHLIGHT:()=>wn,STATE_HANDLER_CREATE_CROP_PAGES:()=>ii,STATE_HANDLER_CREATE_DISTANCE:()=>In,STATE_HANDLER_CREATE_DOCUMENT_ATTACHMENT:()=>ri,STATE_HANDLER_CREATE_EDIT_IMAGE:()=>Cn,STATE_HANDLER_CREATE_FIELD_PUSH_BUTTON:()=>si,STATE_HANDLER_CREATE_FIELD_SIGNATURE:()=>ai,STATE_HANDLER_CREATE_FIELD_TEXT:()=>oi,STATE_HANDLER_CREATE_FILE_ATTACHMENT:()=>An,STATE_HANDLER_CREATE_FREETEXT_BOX:()=>ti,STATE_HANDLER_CREATE_FREETEXT_CALLOUT:()=>ei,STATE_HANDLER_CREATE_FREETEXT_TYPEWRITER:()=>Qn,STATE_HANDLER_CREATE_HIGHLIGHT:()=>Sn,STATE_HANDLER_CREATE_IMAGE:()=>xn,STATE_HANDLER_CREATE_LINE:()=>En,STATE_HANDLER_CREATE_LINK:()=>Dn,STATE_HANDLER_CREATE_PENCIL:()=>Mn,STATE_HANDLER_CREATE_PERIMETER:()=>Rn,STATE_HANDLER_CREATE_POLYGON:()=>Ln,STATE_HANDLER_CREATE_POLYGON_CLOUD:()=>On,STATE_HANDLER_CREATE_POLYLINE:()=>Nn,STATE_HANDLER_CREATE_RADIO_BUTTON:()=>ui,STATE_HANDLER_CREATE_REPLACE:()=>Vn,STATE_HANDLER_CREATE_SQUARE:()=>Bn,STATE_HANDLER_CREATE_SQUARE_CROP:()=>jn,STATE_HANDLER_CREATE_SQUIGGLY:()=>Un,STATE_HANDLER_CREATE_STAMP:()=>Hn,STATE_HANDLER_CREATE_STRIKE_OUT:()=>Wn,STATE_HANDLER_CREATE_TEXT:()=>Yn,STATE_HANDLER_CREATE_UNDERLINE:()=>qn,STATE_HANDLER_ERASER:()=>$n,STATE_HANDLER_HAND:()=>mn,STATE_HANDLER_LOUPE:()=>zn,STATE_HANDLER_MARQUEE:()=>Kn,STATE_HANDLER_SELECT_ANNOTATION:()=>Zn,STATE_HANDLER_SELECT_TEXT:()=>Xn,STATE_HANDLER_SELECT_TEXT_ANNOTATION:()=>Gn,STATE_HANDLER_SELECT_TEXT_IMAGE:()=>Jn,STATE_HANDLER_SNAPSHOT_TOOL:()=>ni,StateNameAnnotTypeMap:()=>li,StateNameFieldTypeMap:()=>di});var o={};g.r(o),g.d(o,{CENTIMETER:()=>Ei,CUSTOM:()=>_i,FOOT:()=>Si,INCH:()=>wi,KILOMETER:()=>Ci,METER:()=>Di,MILE:()=>Pi,MILLIMETER:()=>Ii,PICA:()=>Ri,PIXEL_HORIZONTAL:()=>Ti,PIXEL_VERTICAL:()=>Fi,POINT:()=>Ai,YARD:()=>xi,getScaleByUnit:()=>Li,getUnitByName:()=>Oi});var a={};g.r(a),g.d(a,{html2Escape:()=>Nh,htmlCharacter2Entity:()=>Vh,jquerySelector2Escape:()=>Bh});var s={};g.r(s),g.d(s,{arrayBufferToBase64:()=>Vk,base64ToArrayBuffer:()=>Bk,formatFileLastModified:()=>Lk,formatFileSize:()=>Ok,isFDFFile:()=>Fk,isJSONFile:()=>Tk,isXFDFFile:()=>Mk,removeWhiteBgFromBase64:()=>Nk});var u={};g.r(u),g.d(u,{AdditionalFamilies:()=>Zb,BaseFontFamilies:()=>Jb,BaseFontFamiliesCN:()=>Xb,FontFamilies:()=>zb,FoxitFontMap:()=>$b,extensionFontFamilies:()=>ew,getDefaultName:()=>tw,isStandardFont:()=>Gb,mapFontName2StdID:()=>qb,mapStdID2FontName:()=>Kb,standardFontFamilies:()=>Qb,stdFontMap:()=>Yb});var c={};g.r(c),g.d(c,{isAudioFile:()=>ZP,isBMP:()=>aA,isFDF:()=>uA,isGIF:()=>oA,isImageFile:()=>nA,isJPEG:()=>iA,isPDF:()=>jP,isPDFFile:()=>BP,isPNG:()=>rA,isPlainText:()=>gA,isSVG:()=>sA,isTheoraCodec:()=>zP,isValidMP3:()=>QP,isValidMP4:()=>qP,isValidOGGAudio:()=>eA,isValidOGGVideo:()=>$P,isValidWebM:()=>KP,isVideoFile:()=>UP,isVorbisCodec:()=>tA,isXDP:()=>cA,matchFileHead:()=>VP,supportsH264Video:()=>WP,supportsMP3:()=>JP,supportsOGGAudio:()=>XP,supportsOGGVideo:()=>YP});var l={};g.r(l),g.d(l,{BorderStyle:()=>dA,SelectionEventType:()=>hA,Selections:()=>pA,createAreaLimitationReducer:()=>vA});var d={};g.r(d),g.d(d,{convertPermissionToUIData:()=>yA,convertUIDataToPermission:()=>kA,getInputOwnerPwd:()=>AA,getPermissionDefaultUIData:()=>mA,getPwdPopupLatestUIData:()=>wA,requestOwnerPassword:()=>DA,setCertificateAndPermission:()=>xA,setInputOwnerPwd:()=>SA,setPasswordAndPermission:()=>CA,setPwdPopupLatestUIData:()=>_A});var h={};g.r(h),g.d(h,{Eraser:()=>LA,Point:()=>FA,PointType:()=>RA});var f={};g.r(f),g.d(f,{addFATLAndEUTLListToCertificateList:()=>uS,addTrustedCert:()=>QA,getFATLAndEUTLList:()=>lS,getSignatureFieldFromPDFDoc:()=>YA,getTrustedCertificateList:()=>aS,getTrustedCertificateListDb:()=>ZA,hasCertifySignatureInPDF:()=>qA,hasSignedSignatureInPDF:()=>KA,removeTrustedCert:()=>tS,removeTrustedCerts:()=>iS,verifySignatureUtil:()=>gS});var p={};g.r(p),g.d(p,{AbstractPDFTextToSpeechSynthesis:()=>o_,PDFTextToSpeechSynthesisStatus:()=>Ww,ReadAloudService:()=>h_,Store:()=>r_});var m={};g.r(m),g.d(m,{FileFormat:()=>c,SecurityUtils:()=>d,file:()=>s,pageRangeTwoDimensionToOne:()=>Zo});var y={};g.r(y),g.d(y,{IndexedDBStorageDriver:()=>rP,LocalStorageDriver:()=>BS,StorageFeature:()=>Yi});var k=g(9422),b=g(6784),w=g(4702),_=g(6448),P=g(4375),A=g(6721),S=g(2834),x=g(6841),C=g(6147),D=g(7327),E=g(3638),I=g(6699),R=g(5171),T=g(216),F=g(7582),M=g(2047),O=g.n(M),L=g(5680),N=g.n(L);const V=function(){function e(t,n){(0,P._)(this,e),this.$ui=O()(t),this.pdfViewerRender=n,this.pdfViewer=n.pdfViewer}return(0,A._)(e,[{key:"rendering",value:function(){this.closeLoadingFn=this.pdfViewer.viewerUI.loading(this.$ui.get(0))}},{key:"rendered",value:function(){this.closeLoadingFn&&this.closeLoadingFn(),this.$ui.addClass("rendered")}}]),e}();const B='<div class="fv__pdf-view-mode-item"> <div class="fv__pdf-page-layout"> <div class="fv__pdf-page-rendering" style="position:absolute;width:100%;z-index:1000"></div> <div class="fv__pdf-custom-page-container"></div> <div class="fv__pdf-page-container"> </div> <div class="fv__pdf-page-annots-container"></div> <div class="fv__pdf-page-customs-container"></div> <div class="fv__pdf-page-handler-container"></div> </div> </div>';var j=g(4157),U=g(6118);const H=function(){function e(t,n){(0,P._)(this,e),this.$ui=O()(t),this.pageRender=n,this.docRender=n.docRender,this.viewerRender=this.docRender.viewerRender,this.pdfViewer=this.viewerRender.pdfViewer}return(0,A._)(e,[{key:"rendering",value:function(){this.$ui.removeClass("rendered"),this.closeRenderingFn=this.pdfViewer.viewerUI.loading(this.$ui.get(0),"page")}},{key:"rendered",value:function(){this.$ui.addClass("rendered"),this.closeRenderingFn&&this.closeRenderingFn()}},{key:"destroy",value:function(){this.closeRenderingFn&&this.closeRenderingFn(),this.$ui=null}}]),e}();var W=function(){function e(t,n){(0,P._)(this,e),this.eCustom=t,this.pdfPageRender=n}return(0,A._)(e,[{key:"render",value:function(e,t){}},{key:"destroy",value:function(){this.pdfPageRender=null,this.eCustom=null}}]),e}(),Y=g(1556),q=g(5706),K=g(2640),z=g(2430);function G(e){return(0,Y.o)(e)||(0,q.f)(e)||(0,z.N)(e)||(0,K.i)()}var J=g(5136),X=function(){function e(){(0,P._)(this,e),(0,J._)(this,"isActive",!1)}return(0,A._)(e,[{key:"active",value:function(){this.isActive||(this.isActive=!0,this.doActive())}},{key:"unActive",value:function(){this.isActive&&(this.isActive=!1,this.doDeactive())}}]),e}(),Z=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,J._)((0,w._)(e),"activations",[]),e}return(0,A._)(n,[{key:"add",value:function(e){this.contains(e)||(this.activations.push(e),this.isActive&&!e.isActive&&e.active())}},{key:"remove",value:function(e){var t=this,i=this.activations.indexOf(e);return i<0?this.activations.some((function(i,r){if((0,D._)(i,n)){var o=i.remove(e);return o&&!i.hasActivations()&&t.activations.splice(r,1),o}return!1})):(this.activations.splice(i,1),this.isActive&&e.isActive&&((0,D._)(e,n)?(e.activations||[]).forEach((function(e){return e.unActive()})):e.unActive()),!0)}},{key:"exclude",value:function(e){return this.activations.filter((function(t){return!e.contains(t)}))}},{key:"contains",value:function(e){return this.activations.indexOf(e)>-1||this.activations.some((function(t){return(0,D._)(t,n)&&t.contains(e)}))}},{key:"clear",value:function(){this.activations.forEach((function(e){e.isActive&&e.unActive()})),this.activations.length=0}},{key:"getAllActivations",value:function(){return this.activations.reduce((function(e,t){return(0,D._)(t,n)?e.push.apply(e,t.getAllActivations()):e.push(t),e}),[])}},{key:"hasActivations",value:function(){return this.activations.length>0}},{key:"doActive",value:function(){this.activations.forEach((function(e){e.isActive||e.active()}))}},{key:"doDeactive",value:function(){this.activations.forEach((function(e){e.isActive&&e.unActive()})),this.activations.length=0}}]),n}(X),Q=function(){function e(){(0,P._)(this,e),(0,J._)(this,"currentActivatable",void 0)}return(0,A._)(e,[{key:"active",value:function(e){if(this.getCurrentActivatable()!==e){if((0,D._)(this.currentActivatable,Z)){if(this.currentActivatable.contains(e))return;if((0,D._)(e,Z)){var t=this.currentActivatable.exclude(e);t.length>0?t.forEach((function(e){e.isActive&&e.unActive()})):this.currentActivatable.isActive&&this.currentActivatable.unActive()}else{var n,i;if(null===(n=this.currentActivatable)||void 0===n?void 0:n.isActive)null===(i=this.currentActivatable)||void 0===i||i.unActive()}}else{var r,o;if(null===(r=this.currentActivatable)||void 0===r?void 0:r.isActive)null===(o=this.currentActivatable)||void 0===o||o.unActive()}this.currentActivatable=e,e.isActive||e.active()}}},{key:"unActive",value:function(e){var t=this.getCurrentActivatable();t&&e&&e.isActive&&((0,D._)(t,Z)?t.remove(e):t===e&&(e.isActive&&e.unActive(),this.currentActivatable=void 0))}},{key:"unActiveCurrent",value:function(){var e,t;(null===(e=this.currentActivatable)||void 0===e?void 0:e.isActive)&&(null===(t=this.currentActivatable)||void 0===t||t.unActive());this.currentActivatable=void 0}},{key:"getCurrentActivatable",value:function(){var e;if(null===(e=this.currentActivatable)||void 0===e?void 0:e.isActive)return this.currentActivatable}},{key:"getAllCurrentActivatables",value:function(){var e=this.getCurrentActivatable();return e?(0,D._)(e,Z)?e.getAllActivations():[e]:[]}},{key:"hasActivations",value:function(){return null!=this.currentActivatable&&(!(0,D._)(this.currentActivatable,Z)||this.currentActivatable.hasActivations())}},{key:"currentActivableIs",value:function(e){var t=this.getCurrentActivatable();return t===e||(0,D._)(t,Z)&&t.contains(e)}},{key:"clear",value:function(){this.currentActivatable=void 0}}]),e}(),ee=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:null,pdfViewer:null};return(0,P._)(this,n),(e=t.call(this)).disposor=new j.Disposable,e._parent=i,e._parentName=i.name,e.pdfViewer=i.pdfViewer,e.isDestroyed=!1,e}return(0,A._)(n,[{key:"addDestroyHook",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i;(i=this.disposor).addDestroyHook.apply(i,(0,I._)(t))}},{key:"destroy",value:function(){this._parent=null,this.isDestroyed=!0,this.disposor.destroy()}},{key:"parent",value:function(e){var t=this._parent;return e?t?e===this._parentName?t:t.parent(e):null:t}},{key:"doActive",value:function(){}},{key:"doDeactive",value:function(){}}]),n}(X);const te=ee;var ne=function(){},ie=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,o)).name=n.getDefaultName(),a.$ui=e,a.$handler=i,a.$page=o.$ui,a.annot=r,a.component=new(a.pdfViewer.annotManager.get(r))(r,e[0],i[0],(0,w._)(a)),a}return(0,A._)(n,[{key:"destroy",value:function(){this.component.destroy()}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.component.updateSize(e,t)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=arguments.length>2?arguments[2]:void 0;if(this.isDestroyed||this.component.isDestroyed)return Promise.resolve();var i=this.scale,r=this.rotate;this.scale=e,this.rotate=t;var o=this.component;if(o.setVisibleRect(n),o.isHidden()){if(o.$ui.addClass("fv__markup-annot-invisible"),!o.isFormControl())return Promise.resolve()}else o.isUIVisible()&&o._showUI();return o.$ui.removeClass("fv__markup-annot-invisible"),o.isUIVisible()?Promise.resolve(o.render(e,t)).then((function(n){var a=i!==e||r!==t;return Promise.resolve(o.afterRender({transformed:a,prescale:i,scale:e,prerotate:r,rotate:t})).then((function(e){return n}))})).catch(ne):Promise.resolve()}},{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.scale=e,this.rotate=t,Promise.resolve(this.component.add(e,t))}},{key:"active",value:function(e){return Promise.resolve(this.component.active(e))}},{key:"unActive",value:function(){return Promise.resolve(this.component.unActive())}},{key:"focus",value:function(){return this.component.focus(this.$page)}},{key:"blur",value:function(){return this.component.blur(this.$page)}},{key:"remove",value:function(e){var t=this,n=this.parent();if(e)return n.unActiveAnnot(this.annot).then((function(){t.component.remove(),n.removeAnnotRender(t)}));for(var i=this.getRelevanceRenders(),r=[],o=i.length;o--;)r[o]=i[o].remove(!0);return Promise.all(r)}},{key:"showContextMenu",value:function(e,t){return this.component.showContextMenu(e,t)}},{key:"doubleTapAnnot",value:function(){this.component.doubleTapAnnot()}},{key:"redraw",value:function(e,t){if(e)return Promise.resolve(this.component.redraw(t));for(var n=this.getGroupRenders(),i=[],r=n.length;r--;)i[r]=n[r].redraw(!0,t);return Promise.all(i)}},{key:"getAnnot",value:function(){return this.getPDFAnnot()}},{key:"getPDFAnnot",value:function(){return this.annot}},{key:"getGroupRenders",value:function(){var e=this.annot,t=[e];if(!e.IsGrouped||!e.IsGrouped())return[this];t=[].concat(e.getGroupElements());var n=this.parent().getAnnotRenders(),i=[];for(var r in n){var o=n[r],a=t.indexOf(o.getPDFAnnot());if(a>-1&&(i.push(o),t.splice(a,1)),!t.length)break}return i}},{key:"getRelevanceRenders",value:function(){var e,t=[],n=this.annot;(e=(n=n.getGroupHeader&&n.getGroupHeader()||n).getPopup&&n.getPopup())&&t.push(e),function(e,t){oe(e,"getReplies",t)}(n,t),ae(n,t),se(n,t);var i=n.isGrouped&&n.isGrouped()?n.getGroupElements():[n];t=t.concat(i);var r=this.parent().getAnnotRenders(),o=[];try{for(var a in r){var s=r[a],u=t.indexOf(s.getPDFAnnot());if(u>-1&&(o.push(s),t.splice(u,1)),!t.length)break}}catch(e){}return o}},{key:"moved",value:function(e){this.component.moved(),this.component.movedByOther(e)}},{key:"getComponent",value:function(){return this.component}},{key:"invisibleRender",value:function(){this.component.invisibleRender()}},{key:"clearCache",value:function(){this.component.clearCache()}}],[{key:"getDefaultName",value:function(){return"annotRender"}}]),n}(te);const re=ie;function oe(e,t,n){if(e[t]){var i=e[t](),r=i.length;if(r){n.push.apply(n,i);for(var o=r;o--;){var a=i[o];ae(a,n),se(a,n),oe(a,t,n)}}}}function ae(e,t){return oe(e,"getMarkedStates",t)}function se(e,t){return oe(e,"getReviewStates",t)}var ue=function(){return!0},ce=function(e,t){return t[e]};const le={annotationUpdated:"annotation-updated",annotationIDUpdated:"annotation-id-updated",annotationAppearanceUpdated:"annotation-appearance-updated",annotationReplyAdd:"annotation-reply-add",annotationReplyAdded:"annotation-reply-add",annotationReviewStateAnnotAdd:"annotation-review-state-annot-add",annotationReviewStateAnnotAdded:"annotation-review-state-annot-add",annotationMarkedStateAnnotAdd:"annotation-marked-state-annot-add",annotationMarkedStateAnnotAdded:"annotation-marked-state-annot-add",annotationStatesCleared:"annotation-states-cleared",annotationRemoved:"annotation-removed",annotationMovedPosition:"annotation-moved-position",annotationPositionMoved:"annotation-moved-position",annotationOrderChanged:"annotation-order-changed",annotationAdded:"annotation-add",annotationAdd:"annotation-add",moveAnnotsToPages:"moveAnnotsToPages",annotationImported:"annotation-imported",annotationImportedEx:"annotation-imported-ex",annotationLoaded:"annotation-loaded",actionUpdated:"action-updated",actionAdd:"action-add",actionAdded:"action-add",actionRemove:"action-remove",actionRemoved:"action-remove",layerVisibleChange:"layer-visible-change",layerVisibleChanged:"layer-visible-change",layerRemoved:"layer-removed",layerMerged:"layer-merged",layerAdded:"layer-added",bookmarkAdded:"bookmark-added",structureBookmarkAdded:"structure-bookmark-added",bookmarkUpdated:"bookmark-updated",bookmarkRemoved:"bookmark-removed",stateAnnotNameUpdated:"state-annot-name-updated",pageInfoChange:"page-info-change",pageInfoChanged:"page-info-change",pageRotationChange:"page-rotation-change",beforePageRotationChanged:"before-page-rotation-changed",pageRotationChanged:"page-rotation-change",imageAdded:"image-added",watermarkAdded:"watermark-added",watermarkRemoved:"watermark-removed",graphicsUpdated:"graphics-updated",permissionChanged:"permission-changed",docPasswordChanged:"doc-password-changed",drmEncryptSuccess:"drm-encrypt-success",drmEncryptSucceeded:"drm-encrypt-success",drmEncryptFailed:"drm-encrypt-failed",removePwdAndPerm:"remove-password-and-permission",pwdAndPermRemoved:"remove-password-and-permission",securityTypeChanged:"security-type-changed",pageMoved:"page-moved",pageRemoved:"page-removed",pageAdded:"page-added",insertPages:"import-pages",pagesInserted:"import-pages",importPages:"import-pages",documentAttachmentAdd:"document-attachment-add",docAttachmentAdded:"document-attachment-add",documentAttachmentModify:"document-attachment-modify",docAttachmentModified:"document-attachment-modify",documentAttachmentRemove:"document-attachment-remove",docAttachmentRemoved:"document-attachment-remove",applyRedaction:"apply-redaction",redactionApplied:"apply-redaction",removeReviewState:"remove-review-state",reviewStateRemoved:"remove-review-state",removeMarkedState:"remove-marked-state",markedStateRemoved:"remove-marked-state",formValueChanged:"form-value-changed",metaDataChanged:"meta-data-changed",docModified:"doc-modified",flattened:"flattened",headerFooterUpdated:"headerFooterUpdated",headerFooterAdded:"headerFooterAdded",COChange:"COChange",COChanged:"COChange",pagesReversed:"pages-reversed",pagesMoved:"pages-moved",pagesRemoved:"pages-removed",pagesRotated:"pages-rotated",pageMeasureScaleRatioChanged:" page-measure-scale-ratio-changed",obtainsPageFromEngine:"obtains-page-from-engine",pagesBoxChange:"pages-box-changed",pagesBoxChanged:"pages-box-changed",pagesLabelChange:"pages-label-change",pagesLabelChanged:"pages-label-change",pagesLabelNeedUpdate:"pages-label-need-change",pagesLabelNeedUpdated:"pages-label-need-change",pagesReplace:"pages-replace",pagesReplaced:"pages-replace",recognitionForm:"recognition-form",removeEmbeddedPageThumbnail:"remove-embedded-page-thumbnail",embeddedPageThumbnailRemoved:"remove-embedded-page-thumbnail",objectStartEdit:"object-start-edit",objectEndEdit:"object-end-edit",objectSelectionChanged:"object-selection-changed",objectAdded:"object-added",objectPropertyChanged:"object-property-changed",objectContentChanged:"object-content-changed",paragraphContentChanged:"paragraph-text-changed",paragraphTextOnActivate:"paragraph-text-on-activate",paragraphTextOnDeactivate:"paragraph-text-on-deactivate",paragraphTextEnterEdit:"paragraph-text-enter-edit",paragraphTextExitEdit:"paragraph-text-exit-edit",paragraphTextOnChar:"paragraph-text-on-char",findSuccess:"find-success",replaceSuccess:"replace-success",replaceAllSuccess:"replace-all-success",articleThreadAdded:"article-thread-added",articleThreadUpdated:"article-thread-updated",articleThreadRemoved:"article-thread-removed",articleBeadAdded:"article-bead-added",articleBeadRemoved:"article-bead-removed",articleBeadUpdated:"article-bead-updated",articleEnterReadMode:"article-enter-read-mode",articleOutReadMode:"article-out-read-mode",invalidRect:"invalidRect",xfaContentChanged:"xfa-content-changed",formReloaded:"formReloaded",formFieldImported:"form-field-imported"};const de=Object.assign({jrLicenseSuccess:"jr-license-success",srLicenseSuccess:"sr-license-success",beforeOpenFile:"before-open-file",openingFile:"opening-file",beforeLoadPDFDoc:"before-load-pdf-document",openFileSuccess:"open-file-success",openFileFailed:"open-file-failed",willCloseDocument:"will-close-document",renderFileSuccess:"render-file-success",renderFileFailed:"render-file-error",beforeRenderPage:"before-render-page",renderPageSuccess:"render-page-success",updateZoomMode:"update-zoom-mode",beforeZoomTo:"before-zoom-to",zoomToSuccess:"zoom-to-success",zoomToFailed:"zoom-to-failed",startChangeViewMode:"start-change-view-mode",changeViewModeSuccess:"change-view-mode-success",toggleFullScreen:"toggle-full-screen",changeViewModeFailed:"change-view-mode-failed",pagesLayoutRedrawBegin:"pages-layout-redraw-begin",pageLayoutRedraw:"page-layout-redraw",pagesLayoutRedrawEnd:"pages-layout-redraw-end",copyTextSuccess:"copy-text-success",copyTextFailed:"copy-text-failed",tapPage:"tap-page",tapAnnotation:"tap-annotation",pressPage:"press-page",pressAnnotation:"press-annotation",pressText:"press-text",rightClickPage:"right-click-page",rightClickAnnotation:"right-click-annotation",doubleTapPage:"double-tap-page",doubleTapAnnotation:"double-tap-annotation",activeAnnotationBefore:"active-annotation-before",activeAnnotation:"active-annotation",activeAnnotationAfter:"active-annotation-after",panActiveAnnotation:"pan-active-annotation",doubleTapActiveAnnotation:"double-tap-active-annotation",contextMenuActiveAnnotation:"contextmenu-action-annotation",activeMultipleAnnotations:"active-multiple-annotations",unActiveAnnotation:"unactive-annotation",updateActiveAnnotation:"update-action-annotation",updateActionAnnotation:"update-action-annotation",removeActiveAnnotationBefore:"remove-action-annotation-before",removeActionAnnotationBefore:"remove-action-annotation-before",removeActiveAnnotationSuccess:"remove-action-annotation-success",removeActionAnnotationSuccess:"remove-action-annotation-success",removeActiveAnnotationFailed:"remove-action-annotation-failed",removeActionAnnotationFailed:"remove-action-annotation-failed",beforeSwitchStateHandler:"before-switch-state-handler",switchStateHandler:"switch-state-handler",deactiveStateHandler:"deactive-state-handler",redactAnnotAllApplyed:"applyed-all-redaction",redactAnnotApplyed:"applyed-redaction",pageNumberChange:"page-number-change",beforeDocumentRotation:"before-document-rotation",afterDocumentRotation:"after-document-rotation",snapModeChanged:"snap-mode-changed",createPageAreaRenderer:"create-page-area-renderer",destroyPageAreaRenderer:"destroy-page-area-renderer",startUpdatePageAreaRenderer:"start-update-page-area-renderer",createSnapshotArea:"create-snapshot-area",updateSnapshotArea:"update-snapshot-area",stabilizedSnapshotArea:"stabilized-snapshot-area",switchPageAreaRenderer:"switch-page-area-renderer",fitWidthResizeViewport:"fit-width-resize-viewport",signatureFieldMouseLButtonDown:"signature-field-Lbutton-down",signatureFieldMouseLButtonUp:"signature-field-LButton-up",signatureFieldMouseEnter:"signature-field-mouse-enter",signatureFieldMouseExit:"signature-field-mouse-exit",visiblePagesRenderCompleted:"completed-render-visible-pages",marqueeZoomIn:"marquee-zoom-in",marqueeZoomOut:"marquee-zoom-out",inkSignAdded:"inkSign-added",inkSignDeleted:"inkSign-deleted",onlineSignAdded:"onlineSign-added",onlineSignDeleted:"onlineSign-deleted",changeReadSpeed:"changeReadSpeed",changeReadVolume:"changeReadVolume",pageMoved:"page-moved",pageRemoved:"page-removed",pageAdded:"page-added",customDataAdd:"custom-data-add",customDataImported:"custom-data-imported",customDataRemoved:"custom-data-removed",customDataUpdated:"custom-data-updated",distanceAnnotCreationStart:"distance-creation-start",perimeterAnnotCreationStart:"perimeter-creation-start",updateDistanceAnnot:"update-distance-annot",distanceAnnotCreationEnd:"distance-creation-end",distanceAnnotCreationCancel:"distance-creation-cancel",drawingAnnotCreationStart:"drawing-creation-start",drawingAnnotCreationEnd:"drawing-creation-end",drawingAnnotCreationCancel:"drawing-creation-cancel",addEditImage:"add-edit-image",InkImageSelected:"ink-image-selected",OnlineImageSelected:"online-image-selected",checkTheSearch:"check-the-search",activeElementChanged:"active-element-changed",cancelCreatingDistance:"cancel-creating-measurement",completeCreatingDistance:"complete-creating-measurement",eraserSuccess:"eraser-success",addAnnotSuccess:"add-annot-success",cancelAddAnnot:"cancel-add-annot",globalAnnotFlagChanged:"global-annot-flag-changed",toolbarTabsClicked:"toolbar-tabs-clicked",sideBarChanged:"sidebar-changed",showWhatsNew:"show-whats-new",disableScroll:"disable-scroll",enableScroll:"enable-scroll",updateScrollableStatus:"update-scrollable-status",selectText:"select-text",changeEnableJS:"change-enable-js",toggleEngineSr2JrSuccess:"toggle-engine-sr-to-jr-success",iconInited:"iconInited",iconAdded:"iconAdded",iconRemoved:"iconRemoved",annotationPermissionChanged:"annotation-premission-changed",startScrollingPage:"pdfui-start-scrolling-page",scrollingPage:"pdfui-scrolling-page",endScrollingPage:"pdfui-end-scrolling-page",designerAssistantStatusChanged:"form-designer-assistant-status-changed",mouseEnter:"mouse-enter",mouseLeave:"mouse-leave",setFromFieldHighlight:"set_form_field_highlight",AddFontMaps:"set_font_map",thumbnailClicked:"thumbnail-clicked",layerActionActived:"layer-action-actived",redeModeShowSidebar:"rede-mode-show-sidebar",gridToggle:"grid-toggle",snapGridToggle:"snap-grid-toggle",toggleCollaborationMode:"toggleCollaborationMode",findReplaceDialogVisibleChange:"find-replace-dialog-visible-change",showAllComments:"show-all-comments",hideAllComments:"hide-all-comments",focusOnControl:"focus-on-control",blurFromObject:"blur-from-object",documentWillPrint:"document-will-print",documentDidPrint:"document-did-print",documentWillSave:"document-will-save",documentDidSave:"document-did-save",verifyDocSignatureEvent:"verify-doc-signature",verifySignatureEvent:"verify-signature",clearSignatureEvent:"clear-signature",viewSignedVersionDocEvent:"view-signed-version",showFieldPropertiesEvent:"show-field-properties",showSignatureVerifyInfoEvent:"show-signature-tusted-info",compareSignedVersionEvent:"compare-signed-version",showCompareSignedVersionResultEvent:"show-compare-signed-version-result",eSignCnShowAuthPromote:"eSignCnShowAuthPromote",eSignCnShowMultiPageStamp:"eSignCnShowMultiPageStamp",eSignCNAddDateStamp:"eSignCNAddDateStamp",eSignCNCloseStamp:"eSignCNCloseStamp",eSignCNChangePagingSeal:"eSignCNChangePagingSeal",eSignCNOpenProcessSeal:"eSignCNOpenProcessSeal",eSignCnApply:"eSignCnApply",eSignCNShowOfflineResult:"eSignCNShowOfflineResult",eSignCnExit:"eSignCnExit",tapField:"tap-field",tapGraphicsObject:"tap-graphics-object",spawnPageSuccess:" spawn-page-success",progressChanged:"progress-changed",togglePageContextMenu:"toggle-page-contextmenu",beforeRenderingVisiblePages:"before-rerendering-visible-pages",afterRenderingVisiblePages:"after-rerendering-visible-pages"},le);g(7686);var he=function(){},fe=function(){function e(){(0,P._)(this,e),this.queue=[],this.promise=Promise.resolve()}return(0,A._)(e,[{key:"push",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:he,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return this.queue.push([e,n]),new Promise((function(e,n){setTimeout((function(){return t.exec()}),i)}))}},{key:"exec",value:function(){var e=this;if(!this.execIng){var t=this.queue.pop();if(t){this.execIng=!0;for(var n=0,i=this.queue.length;n<i;n++)this.queue[n][1]();return this.queue=[],Promise.resolve(t[0]()).catch((function(){try{return Promise.resolve(t[1]()).catch(he)}catch(e){}})).finally((function(){e.execIng=!1,setTimeout((function(){e.exec()}),30)}))}}}},{key:"end",value:function(){this.queue=[]}}]),e}(),ge=function(){function e(){(0,P._)(this,e),this.executor=new j.QueuedAsyncTaskExecutor}return(0,A._)(e,[{key:"serial",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.executor.cancel(),this.executor.waitForCurrentRunningTasks().then((function(){return e.executor.resume(),e.executor.execTasks(t.map((function(e){return{task:e}})))}))}},{key:"push",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.executor.execTasks(t.map((function(e){return{task:e}})))}},{key:"unshift",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.executor.insert(t.map((function(e){return{task:e}}))),this.executor.waitForCurrentRunningTasks()}},{key:"concat",value:function(){var e=this;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(t){e.executor.exec(t)})),this.executor.waitForCurrentRunningTasks()}},{key:"exec",value:function(){return this.executor.waitForCurrentRunningTasks()}},{key:"end",value:function(){return this.executor.cancel(),this.executor.waitForCurrentRunningTasks()}}]),e}();!function(){function e(){(0,P._)(this,e),this.queue=[],this.continueExec=!0,this.deferred=(0,j.createDeferred)(),this.task=Promise.resolve()}(0,A._)(e,[{key:"serial",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.queue=e,this.exec(),this.deferred.promise}},{key:"push",value:function(){this.queue.push.apply(this.queue,arguments)}},{key:"unshift",value:function(){this.queue.unshift.apply(this.queue,arguments)}},{key:"concat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.queue.concat(e)}},{key:"exec",value:function(){var e=this;if(!this.execIng){this.execIng=!0;var t=this.queue.shift()||[he],n=t[0]();return this.execIngEnd=t[1]||he,Promise.resolve(n).finally((function(){return e.execIng=!1,e.queue.length?e.continueExec?void e.task.then((function(t){return e.exec()})):(e.queue=[],e.deferred.resolve(n)):e.deferred.resolve(n)})).catch(he),this.deferred.promise}}},{key:"end",value:function(){if(this.execIng)try{Promise.resolve(this.execIngEnd()).catch(he)}catch(e){}return this.continueExec=!1,this.queue=[],this.deferred.promise}}])}();const ve={MARKED:"marked",UNMARKED:"unmarked",ACCEPTED:"accepted",REJECTED:"rejected",CANCELLED:"cancelled",COMPLETED:"completed",DEFERRED:"deferred",FUTURE:"future",NONE:"none"};var pe={FIRST:0,LAST:1,AFTER:2,BEFORE:3,NEXT:2,PREV:3},me={SOLID:0,DASHED:1,UNDERLINE:2,BEVELED:3,INSET:4,CLOUDY:5,NOBORDER:6},ye={MOVE_TO:1,LINE_TO:2,LINE_TO_CLOSE_FIGURE:3,BEZIER_TO:4,BEZIER_TO_CLOSE_FIGURE:5},ke={LINE_ARROW:"LineArrow",LINE_DIMENSION:"LineDimension",POLYGON_CLOUD:"PolygonCloud",POLYGON_DIMENSION:"PolygonDimension",POLYLINE_DIMENSION:"PolyLineDimension",CIRCLE_DIMENSION:"CircleDimension",FREETEXT_TYPEWRITER:"FreeTextTypewriter",FREETEXT_CALLOUT:"FreeTextCallout",FREETEXT_TEXTBOX:"FreeTextTextbox",STRIKEOUT_TEXTEDIT:"StrikeOutTextEdit"},be={0:"None",1:"Square",2:"Circle",3:"Diamond",4:"OpenArrow",5:"ClosedArrow",6:"Butt",7:"ROpenArrow",8:"RClosedArrow",9:"Slash"},we=Object.keys(be).reduce((function(e,t){return e[be[t]]=Number(t),e}),{}),_e={POS_INLINE:0,POS_TOP:1},Pe={0:"invisible",1:"hidden",2:"print",3:"nozoom",4:"norotate",5:"noview",6:"readonly",7:"locked",8:"togglenoview"},Ae={PrintLowQuality:4,ModifyDocument:8,Extract:16,AnnotForm:32,FillForm:256,ExtractAccess:512,Assemble:1024,PrintHighQuality:2048},Se={MeasureTypeX:0,MeasureTypeY:1,MeasureTypeD:2,MeasureTypeA:3,MeasureTypeT:4,MeasureTypeS:5},xe={SELECTION_INFO:"viewer--store-selection-info"},Ce="creating-measurement-contextmenu",De="creating-drawing-contextmenu",Ee={NONE:0,INVERT:1,OUTLINE:2,PUSH:3,TOGGLE:4},Ie=Promise.resolve(),Re=2,Te=.01,Fe="",Me="FoxitPDFSDKForWeb_",Oe="set_form_creation_continuously",Le="hideFormFieldPropertyBox",Ne="hideFormFieldSimplePropertyBox",Ve="measurementInfo",Be=200,je=258,Ue={ROLLOVER:"rollover",NORMAL:"normal",DOWN:"down"},He="CUSTOM-STAMPS",We="FAVORITE-STAMPS-LIST",Ye={ConnectedPDF:1,XFA:2,Redaction:3,RMS:4,OCR:5,Comparison:6,Compliance:7,Optimizer:8,Conversion:9,LayoutRecognition:10,AdvEdit:11},qe=g(6244),Ke=g.n(qe);var $e=function(e,t,n){var i="";if("object"==typeof e&&e.IsValid){if(!e.IsValid())return i;e=function(e){return new Date(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.milliseconds)}(e)}var r=Ke()(e);if((t=t||"YYYY-MM-DD HH:mm:ss").indexOf("Z")>=0){n=Object.assign({separator:":",prefix:"",suffix:"",showSpace:!0},n);var o=r.format("Z");":"!==n.separator&&(o=o.replace(":",String(n.separator))),""!==n.prefix&&(o=String(n.prefix)+o),""!==n.suffix&&(o+=String(n.suffix)),t=t.replace(/\s+Z+|Z+/g,"");var a=n.showSpace?" ":"";i=r.format(t)+a+o}else i=r.format(t);return i},ze=function(e){return"D:"+$e(e,"YYYYMMDDHHmmssZ",{separator:"'",showSpace:!1})+"'"};const Ge=$e;const Je={success:0,file:1,format:2,password:3,handle:4,certificate:5,unknown:6,invalidLicense:7,param:8,unsupported:9,outOfMemory:10,securityHandler:11,notParsed:12,notFound:13,invalidType:14,conflict:15,unknownState:16,dataNotReady:17,invalidData:18,xFALoadError:19,notLoaded:20,invalidState:21,notCDRM:22,canNotConnectToServer:23,invalidUserToken:24,noRights:25,rightsExpired:26,deviceLimitation:27,canNotRemoveSecurityFromServer:28,canNotGetACL:29,canNotSetACL:30,isAlreadyCPDF:31,isAlreadyCDRM:32,canNotUploadDocInfo:33,canNotUploadCDRMInfo:34,invalidWrapper:35,canNotGetClientID:36,canNotGetUserToken:37,invalidACL:38,invalidClientID:39,OCREngineNotInit:40,diskFull:41,OCRTrialIsEnd:42,filePathNotExist:43,complianceEngineNotInit:44,complianceEngineInvalidUnlockCode:45,complianceEngineInitFailed:46,timeStampServerMgrNotInit:47,LTVVerifyModeNotSet:48,LTVRevocationCallbackNotSet:49,LTVCannotSwitchVersion:50,LTVCannotCheckDTS:51,LTVCannotLoadDSS:52,LTVCannotLoadDTS:53,needSigned:54,complianceResourceFile:55,timeStampServerMgrNoDefaltServer:56,defaultTimeStampServer:57,noConnectedPDFModuleRight:58,noXFAModuleRight:59,noRedactionModuleRight:60,noRMSModuleRight:61,noOCRModuleRight:62,noComparisonModuleRight:63,noComplianceModuleRight:64,noOptimizerModuleRight:65,noConversionModuleRight:66,collaborationSession:1400};var Xe={download:1},Ze={normal:0,italic:1,bold:2},Qe={solid:0,dashed:1,underline:2,beveled:3,inset:4,cloudy:5,noBorder:6},et={graph:"Graph",pushPin:"PushPin",paperclip:"Paperclip",tag:"Tag"},tt={Check:"Check",Circle:"Circle",Comment:"Comment",Cross:"Cross",Help:"Help",Insert:"Insert",Key:"Key",NewParagraph:"NewParagraph",Note:"Note",Paragraph:"Paragraph",RightArrow:"RightArrow",RightPointer:"RightPointer",Star:"Star",UpArrow:"UpArrow",UpLeftArrow:"UpLeftArrow"},nt={None:0,Square:1,Circle:2,Diamond:3,OpenArrow:4,ClosedArrow:5,Butt:6,ReverseOpenArrow:7,ReverseClosedArrow:8,Slash:9},it={left:0,center:1,right:2},rt={moveTo:1,lineTo:2,lineToCloseFigure:3,bezierTo:4,bezierToCloseFigure:5},ot={goto:"TypeGoto",launch:"TypeLaunch",uri:"TypeURI",named:"TypeNamed",thread:"TypeThread",submitForm:"TypeSubmitForm",resetForm:"TypeResetForm",javaScript:"TypeJavaScript",importData:"TypeImportData",hide:"TypeHide",gotoE:"TypeGoToE"},at={none:0,invert:1,outline:2,push:3,toggle:4},st={firstChild:0,lastChild:1,previousSibling:2,nextSibling:3,firstSibling:4,lastSibling:5},ut={fdf:0,xfdf:1,xml:2,csv:3,txt:4,json:5},ct={all:0,field:1,annot:2},lt={topLeft:"TopLeft",topCenter:"TopCenter",topRight:"TopRight",centerLeft:"CenterLeft",center:"Center",centerRight:"CenterRight",bottomLeft:"BottomLeft",bottomCenter:"BottomCenter",bottomRight:"BottomRight"},dt={asContent:0,asAnnot:1,onTop:2,unprintable:4,display:8},ht={courier:0,courierBold:1,courierBoldOblique:2,courierOblique:3,helvetica:4,helveticaBold:5,helveticaBoldOblique:6,helveticaOblique:7,timesRoman:8,timesBold:9,timesBoldItalic:10,timesItalic:11,symbol:12,zapfDingbats:13},ft={rotation0:0,rotation1:1,rotation2:2,rotation3:3},gt={rotation0:0,rotation90:90,rotation180:180,rotation270:270},vt={caseSensitive:1,wholeWord:2,consecutively:4},pt={normal:0,incremental:1,noOriginal:2,XRefStream:8,linearized:4096,removeRedundantObjects:16},mt={all:0,even:1,odd:2},yt={page:"page",annot:"annot"},kt={print:"print",view:"view"},bt={MSlashD:0,MSlashDSlashYY:1,MSlashDSlashYYYY:2,MMSlashDDSlashYY:3,MMSlashDDSlashYYYY:4,DSlashMSlashYY:5,DSlashMSlashYYYY:6,DDSlashMMSlashYY:7,DDSlashMMSlashYYYY:8,MMSlashYY:9,MMSlashYYYY:10,MDotDDotYY:11,MDotDDotYYYY:12,MMDotDDDotYY:13,MMDotDDDotYYYY:14,MMDotYY:15,DDotMDotYYYY:16,DDDotMMDotYY:17,DDDotMMDotYYYY:18,YYHyphenMMHyphenDD:19,YYYYHyphenMMHyphenDD:20},wt={default:0,numberOfCount:1,numberSlashCount:2,pageNumber:3,pageNumberOfCount:4},_t={FixedPitch:1,Serif:2,Symbolic:4,Script:8,Nonsymbolic:32,Italic:64,AllCap:65536,SmallCap:131072,ForceBold:262144},Pt={VerifyErrorByteRange:64,verifyChange:128,verifyIncredible:256,verifyNoChange:1024,stateVerifyIssueUnknown:2048,verifyIssueValid:4096,verifyIssueUnknown:8192,verifyIssueRevoke:16384,verifyIssueExpire:32768,verifyIssueUncheck:65536,verifyIssueCurrent:131072,verifyTimestampNone:262144,verifyTimestampDoc:524288,verifyTimestampValid:1048576,verifyTimestampInvalid:2097152,verifyTimestampExpire:4194304,verifyTimestampIssueUnknown:8388608,verifyTimestampIssueValid:16777216,verifyTimestampTimeBefore:33554432,verifyChangeLegal:134217728,verifyChangeIllegal:268435456},At={showTagImage:1,showLabel:2,showReason:4,showDate:8,showDistinguishName:16,showLocation:32,showSigner:64,showBitmap:128,showText:256,showDrawing:512},St={click:-1,keyStroke:7,format:8,validate:9,calculate:10,mouseEnter:11,mouseExit:12,mouseDown:13,mouseUp:14,onFocus:15,onBlur:16},xt={CalcContentsBox:0,CalcDetection:1},Ct={MediaBox:0,CropBox:1,TrimBox:2,ArtBox:3,BleedBox:4},Dt={Fill:0,Stroke:1,FillStroke:2,Invisible:3,FillClip:4,StrokeClip:5,FillStrokeClip:6,Clip:7},Et={Courier:0,CourierB:1,CourierBI:2,CourierI:3,Helvetica:4,HelveticaB:5,HelveticaBI:6,HelveticaI:7,Times:8,TimesB:9,TimesBI:10,TimesI:11,Symbol:12,ZapfDingbats:13},It={FixedPitch:1,Serif:2,Symbolic:4,Script:8,NonSymbolic:32,Italic:64,AllCap:65536,SmallCap:131072,Bold:262144},Rt={ANSI:0,Default:1,Symbol:2,Shift_JIS:128,Hangeul:129,GB2312:134,ChineseBig5:136,Thai:222,EastEurope:238,Russian:204,Greek:161,Turkish:162,Hebrew:177,Arabic:178,Baltic:186},Tt={Unknown:0,GB1:1,CNS1:2,JAPAN1:3,KOREA1:4,UNICODE:5},Ft={None:0,Alternate:1,Winding:2},Mt={All:0,Text:1,Path:2,Image:3,Shading:4,FormXObject:5},Ot={borderColor:"borderColor",fillColor:"fillColor",normalCaption:"normalCaption",downCaption:"downCaption",rolloverCaption:"rolloverCaption"},Lt={first:0,last:1,after:2,before:3,next:2,prev:3},Nt={crossMark:1,checkMark:2,roundRectangle:3,line:4,dot:5},Vt={Dests:1,JavaScript:2,EmbeddedFiles:3,Templates:4,Pages:5},Bt={none:1,superscript:2,subscript:3},jt={CUSTOM_TEXT:"type here to insert text",NAME:"author name",NAME_DATE_TIME:"author name, date and time",DATE_TIME:"date and time",DATE:"date"},Ut={NewWindowFlagFalse:0,NewWindowFlagTrue:1,NewWindowFlagNone:2},Ht={Style_Type:{editTextBox:0,editTextCaret:1,addTextBBox:2,editObjectBox:3,editShapeBox:4},Line_Type:{straightLine:0,thinDashedLine:1,normalDashedLine:2,thickDashedLine:3,thinDashedDotLine:4,normalDashedDotLine:5,thickDashedDotLine:6}};var Wt="WRRRRRRRRWWRWWRRRRRRRRRRRRRRRRRRWRRRRDRRDDRNRNNDNNNNNNNNNNRRDRDRRRRRRRRRRRRRRRRRRRRRRRRRRRRDRDRRRRRRRRRRRRRRRRRRRRRRRRRRRRRDRDRRWRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRW";function Yt(e){var t,n=e.length,i=0;for(t=0;t<n;t++){var r=e.charCodeAt(t);r>=128||"W"==Wt[r]||"#"==e[t]||"D"==Wt[r]?i+=3:i++}if(i==n)return e;var o="";for(t=0;t<n;t++){var a=e.charCodeAt(t);if(a>=128||"W"==Wt[a]||"#"==e[t]||"D"==Wt[a]){if("W"==Wt[a]&&0==a)continue;o+="#",o+="0123456789ABCDEF"[parseInt(a/16)],o+="0123456789ABCDEF"[a%16]}else o+=e[t]}return o}function qt(e){var t;for(t=0;t<e.length&&!(e.charCodeAt(t)>255);t++);if(t===e.length)return"("+e.replace(/([\(|\)])/g,"\\$1")+")";var n="<FEFF";for(t=0;t<e.length;t++){for(var i=e.charCodeAt(t).toString(16);i.length<4;)i="0"+i;n+=i}return n+">"}function Kt(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n));return new Uint8Array(t)}var $t=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,null,[{key:"JSONToFDF",value:function(t){for(var n={next:2,annotRef:[],file:"%FDF-1.2\n1 0 obj<</FDF<</Annots[{annotsRefArray}]>>/Type/Catalog>>endobj\n"},i=[],r=0,o=t.length;r<o;r++){var a=t[r];a.type&&(a.deleted?i.push({name:a.name,page:a.page}):e.singleAnnotJSONToFDF(n,a,!1))}return new Blob([Kt(n.file.replace(/\{annotsRefArray\}/,n.annotRef.join(" "))+"trailer\n<</Root 1 0 R>>\n%%EOF")],{type:"application/fdf"})}},{key:"singleAnnotJSONToFDF",value:function(t,n){var i,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=t.next;if(r?i="Popup":r="popup"==(i={unknowntype:"UnKnownType",text:"Text",link:"Link",freetext:"FreeText",line:"Line",square:"Square",circle:"Circle",polygon:"Polygon",polyline:"PolyLine",highlight:"Highlight",underline:"Underline",squiggly:"Squiggly",strikeout:"StrikeOut",stamp:"Stamp",caret:"Caret",ink:"Ink",psink:"PsInk",fileattachment:"FileAttachment",sound:"Sound",movie:"Movie",widget:"Widget",screen:"Screen",printermark:"PrinterMark",trapnet:"TrapNet",watermark:"Watermark","3d":"3D",popup:"Popup",redact:"Redact"}[(n&&n.type&&n.type.toLowerCase()||"").toString().toLowerCase()]).toLowerCase(),!i||"link"==i.toLowerCase()||"screen"==i.toLowerCase()||"sound"==i.toLowerCase())return 0;var a=n.style||"S";a=a.toUpperCase()[0];var s=n.width,u=n.color||"",c="C"==a?"C":"S",l=n.intensity,d=0===n.opacity?0:n.opacity||1,h=qt(n.contents||""),f=n.flags||"print",g=f.split(",");for(var v in f=0,Pe)-1!=g.indexOf(Pe[v])&&(f|=1<<parseInt(v));var p=n.creationdate,m=n.date,y=n.name||"",k=n.page,b=(n.rect||"").replace(/,/g," "),w=qt(n.subject||"subject"),_=qt(n.title||"title"),P=n["interior-color"]||n.interiorColor,A="".concat(o," 0 obj\n")+"<<"+"/Rect [".concat(b,"]")+"/Subtype /".concat(i)+"/NM (".concat(y,")");for(var S in n.customEntries)A+="/".concat(S," ").concat(qt(n.customEntries[S]),"\n");if(t.annotRef.push("".concat(o," 0 R ")),t.next++,!r){var x;if(m&&(A+="/M (".concat(m,")")),A+="/CA ".concat(d)+"/CreationDate (".concat(p,")")+"/F ".concat(f)+"/Page ".concat(k)+"/Subj ".concat(w)+"/T ".concat(_)+"/Type /Annot",h&&(A+="/Contents ".concat(h)),n.replyType)x="string"==typeof n.replyType&&n.replyType||"Group",A+="/RT /".concat(x[0].toUpperCase()+x.substr(1));n.inreplyto&&(A+="/IRT (".concat(n.inreplyto,")")),n.measureRatio&&(A+="/Measure<</R(".concat(n.measureRatio,")/X[<</C ").concat(n.measureConversionFactor,"/U(").concat(n.measureUnit,")>>]/Type/Measure/Subtype/RL>>"))}if((a||s)&&"Stamp"!=i){a=a||"S",s=s||"0",l=l||"0",c=c||"S";var C=(n.dashes||"").replace(/,/g," ");A+="/BS <</S /".concat(a," /W ").concat(s," /D [").concat(C,"]>>")+"/BE <</S /".concat(c," /I ").concat(l,">>")}if("FreeText"!=i?(u&&(A+="/C "+Jt(u)),P&&(A+="/IC "+Jt(P))):(P&&(A+="/C "+Jt(P)),u&&(A+="/IC "+Jt(u),A+="/DS (color:".concat(n.fontColor,")"))),void 0!==n.rotation&&(A+="/Rotate ".concat(n.rotation)),void 0!==n.bm&&(A+="/BM /".concat(Yt(n.bm))),void 0!==n.bm&&(A+="/ca ".concat(n.ca)),-1===["link","screen","Popup"].indexOf(i)){var D=n.intent||n.IT;D&&(A+="/IT /".concat(D.replaceAll(" ","#20")))}var I="";switch(i){case"Text":case"Note":var R;A=A.replace(/\/Subtype\s?\/Note/,"/Subtype /Text"),n.icon&&(A+="/Name/".concat(Yt(n.icon))),(R=n.state)&&(A+="/State(".concat(R,")/StateModel(").concat(n.statemodel,")"));break;case"Link":return"";case"FreeText":A=A.replace(/\/C\s?\[[\s\S]*?\]/,""),P&&(A+="/C ".concat(Jt(P)));var T=n.defaultappearance,F=n.justification,M="/DA (".concat(T,")")+"/Q ".concat(F);if(n.callout){var O=n.callout.replace(/,/g," ");M+="/CL  [".concat(O,"]"),M+="/LE/".concat(n.head)}if(n.fringe){var L=n.fringe.replace(/,/g," ");M+="/RD [".concat(L,"]")}I=M;break;case"Line":var N="yes"===n.caption,V=n.head,B=n.tail,j="[/".concat(V,"/").concat(B,"]"),U=n.leaderLength,H=n.start.replace(/,/g," ")+" "+n.end.replace(/,/g," "),W=n.leaderExtend,Y=n.leaderOffset,q=n.captionOffset?n.captionOffset.x+" "+n.captionOffset.y:"",K="/Cap ".concat(N)+"/LE ".concat(j)+"/LL ".concat(U)+"/L [".concat(H,"]")+"/LLE ".concat(W)+"/LLO ".concat(Y);q&&(K+="/CO [".concat(q,"]")),void 0!==n.captionColor&&(K+="/CC ".concat(Jt(n.captionColor))),I=K;break;case"Square":case"Circle":var $=n.fringe.replace(/,/g," "),z="/RD [".concat($,"]");if(n.measureRatio&&n.measureUnit&&void 0!==n.measureConversionFactor){void 0!==n.captionColor&&(z+="/CC ".concat(Jt(n.captionColor)));var G="yes"===n.caption;z+="/Cap ".concat(G),z+="/Measure<</R(".concat(n.measureRatio,")/X[<</C ").concat(n.measureConversionFactor,"/U(").concat(n.measureUnit,")>>]/Type/Measure/Subtype/RL>>")}I=z;break;case"Polygon":case"PolyLine":var J=n.vertices.replace(/[,|;]/g," "),X=(n.intent,"yes"===n.caption),Z="/Vertices [".concat(J,"]");if(n.measureRatio&&n.measureUnit&&void 0!==n.measureConversionFactor&&(void 0!==n.captionColor&&(Z+="/CC ".concat(Jt(n.captionColor))),Z+="/Cap ".concat(X),Z+="/Measure<</R(".concat(n.measureRatio,")/X[<</C ").concat(n.measureConversionFactor,"/U(").concat(n.measureUnit,")>>]/Type/Measure/Subtype/RL>>")),"PolyLine"==i){var Q=n.head,ee=n.tail,te="[/".concat(Q,"/").concat(ee,"]");Z+="/LE ".concat(te)}if(n.path&&n.path.length>0){var ne=n.path.split(";").map((function(e){return"[".concat(e.replace(/,/g," "),"]")})).join(" ");Z+="/Path [".concat(ne,"]")}I=Z;break;case"Redact":if(I+="/OC "+Jt(u),I+="/Repeat "+("yes"==n.repeat?"true":"false"),"Redact"==i){I+="/OverlayText"+qt(n["overlay-text"]||n.overlaText||"");var ie=n.defaultappearance;I+="/DA (".concat(ie,")"),I+="/Q ".concat(n.justification||0)}case"StrikeOut":case"Highlight":case"Squiggly":case"Underline":if("coords"in n){var re;if(n.coords||"Redact"===i)re=n.coords.replace(/,/g," ");else{var oe=(0,E._)(n.rect.split(","),4),ae=oe[0],se=oe[1],ue=oe[2],ce=oe[3];re=[ae,ce,ue,ce,ae,se,ue,se].join(" ")}I+="/QuadPoints [".concat(re,"]")}break;case"Caret":var le=n.fringe.replace(/,/g," ");I="/RD [".concat(le,"]");break;case"Stamp":if(n.icon&&(I="/Name/".concat(Yt(n.icon))),n.raw&&n.raw.N){var de=zt(t,n.raw,n.raw.N);I+="/AP << /N ".concat(de," 0 R >>\n")}break;case"Ink":if("["===n.inklist[0]){var he=n.inklist.substr(1,n.inklist.length-2).split("],["),fe="";he.map((function(e){fe+="["+e.replace(/[,|;]/g," ")+"]"})),I="/InkList [".concat(fe,"]")}else I="/InkList [[".concat(n.inklist.replace(/[,|;]/g," "),"]]");break;case"Popup":I="/Open "+("yes"==n.open?"true":"false"),n.parentObjNum&&(I+="/Parent "+n.parentObjNum+" 0 R");break;case"Sound":I+="/Sound "+zt(t,n,{Filter:"/ASCIIHexDecode",R:n.rate,Type:"/Sound",stream:n.soundStream})+" 0 R";case"FileAttachment":if(n.icon&&(I+="/Name/".concat(Yt(n.icon))),n.raw){var ge=zt(t,n.raw,n.raw.FS);I+="/FS ".concat(ge," 0 R ")}}n.popup&&(n.popup.parentObjNum=o,I+="/Popup "+e.singleAnnotJSONToFDF(t,n.popup,!0)+" 0 R");return t.file+=A+I+">>\nendobj\n",o}}]),e}(),zt=function(e,t,n){var i=e.next;e.next++;var r="";if(r+="".concat(i," 0 obj\n"),"string"==typeof n)r+=n;else if((0,D._)(n,Array))r+="["+n.map((function(n){return Gt(e,t,n)})).join(" ")+"]";else{r+="<<\n";for(var o in n)"stream"!=o&&(r+="/"+o+" "+Gt(e,t,n[o]));if(r+=">>",n&&n.stream){for(var a="",s=0;s<n.stream.length;s+=2){var u=parseInt(n.stream[s],16),c=parseInt(n.stream[s+1],16);a+=String.fromCharCode((u<<4)+c)}r+="stream\n"+a+"\nendstream"}}return r+="\nendobj\n",e.file+=r,i},Gt=function(e,t,n){if(null===n)return"null";var i,r=void 0===n?"undefined":(0,R._)(n);if("number"==r)return n;if("string"==r)return"true"===n||"false"===n?n:"/"==n[0]?"/"+Yt(n.replace("/","")):"<"==n[0]?n:(i=n.match(/^(\d*)R$/))?zt(e,t,t[i[1]])+" 0 R":"("+n+")";if("boolean"==r)return n?"true":"false";if((0,D._)(n,Array))return"["+n.map((function(n){return Gt(e,t,n)})).join(" ")+"]";var o="<<";for(var a in n)o+="/".concat(a," ")+Gt(e,t,n[a]);return o+">>"},Jt=function(e){var t=e.match(/\#?(\w{2})(\w{2})(\w{2})/),n=parseInt(t[1],16)/255,i=parseInt(t[2],16)/255,r=parseInt(t[3],16)/255;return"["+n.toFixed(2)+" "+i.toFixed(2)+" "+r.toFixed(2)+"]"},Xt=function(e){for(var t in be)if(be[t]==e)return+t;return 0},Zt=function e(t,n,i,r){(0,P._)(this,e),this.left=t,this.bottom=n,this.right=i,this.top=r};const Qt={print:4,modify:8,extract:16,annotForm:32,fillForm:256,extractAccess:512,assemble:1024,printHigh:2048};const en={contentUpdated:"content-updated",borderInfoUpdated:"borderInfo-updated",borderStyleUpdated:"borderStyle-updated",borderWidthUpdated:"borderWidth-updated",borderColorUpdated:"borderColor-updated",captionColorUpdated:"captionColor-updated",modifiedDateTimeUpdated:"modifiedDateTime-updated",uniqueIDUpdated:"uniqueID-updated",flagsUpdated:"flags-updated",rectUpdated:"rect-updated",innerRectUpdated:"innerRect-updated",iconNameUpdated:"iconName-updated",rotationUpdated:"rotation-updated",defaultAppearanceUpdated:"defaultAppearance-updated",calloutLineEndingStyleUpdated:"calloutLineEndingStyle-updated",calloutLinePointsUpdated:"calloutLinePoints-updated",fillColorUpdated:"fillColor-updated",textColorUpdated:"textColor-updated",alignmentUpdated:"alignment-updated",inkListUpdated:"inkList-updated",endPointUpdated:"endPoint-updated",startPointUpdated:"startPoint-updated",endingStyleUpdated:"endingStyle-updated",enableCaptionUpdated:"enableCaption-updated",leaderCaptionOffsetUpdated:"leaderCaptionOffset-updated",styleFillColorUpdated:"styleFillColor-updated",leaderLineLengthUpdated:"leaderLineLength-updated",leaderLineExtendUpdated:"leaderLineExtend-updated",leaderLineOffsetUpdated:"leaderLineOffset-updated",measureRatioUpdated:"measureRatio-updated",measureUnitUpdated:"measureUnit-updated",measureConversionFactorUpdated:"measureConversionFactor-updated",removeAction:"remove-action",actionDataUpdated:"actionData-updated",addAction:"add-action",moveAction:"move-action",highlightingModeUpdated:"highlightingMode-updated",subjectUpdated:"subject-updated",titleUpdated:"title-updated",createDateTimeUpdated:"createDateTime-updated",opacityUpdated:"opacity-updated",intentUpdated:"intent-updated",vertexesUpdated:"vertexes-updated",applyFillColorUpdated:"applyFillColor-updated",overlayTextUpdated:"overlayText-updated",overlayTexAlignmentUpdated:"overlayTextAlignment-updated",repeatUpdated:"repeat-updated",autoFontSizeUpdated:"autoFontSize-updated",redactDefaultAppearanceUpdated:"redactDefaultAppearance-update",redactOpacityUpdated:"redactOpacity-updated",quadPointsUpdated:"quadPoints-updated",reviewStateUpdated:"review-state-updated",markedStateUpdated:"marked-state-updated",statesCleared:"state-cleared",replyAdded:"add-replies",richTextUpdated:"rich-text-updated",richTextRemoved:"rich-text-removed",addDictionary:"add-dictionary",imageUpdated:"image-updated",formFieldValueUpdated:"form-field-value",formFieldsMaxLengthUpdated:"maxLength",formFieldItemsUpdated:"setItems",formFieldIconUpdated:"icon",formFieldInsertedItem:"insertItemAt",formFieldExportValueUpdated:"form-field-export-value",formFieldMKPropertyUpdated:"form-field-mk-property",formFieldAlternateName:"form-field-alternate-name",formFieldMappingName:"form-field-mapping-name",formFieldActionUpdated:"form-field-action",pathUpdated:"annot-path-updated",cloudyApUpdated:"set-to-cemicircle-cloudy"};const tn={invisible:1,hidden:2,print:4,noZoom:8,noRotate:16,noView:32,readOnly:64,locked:128,toggleNoView:256,lockedContents:512};var nn=g(8469);function rn(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=new nn.Z;if(o.translate(t.x,t.y),o.rotate(Math.atan2(t.y-n.y,n.x-t.x)),o.transformPoint(i.x,i.y)[1]>0){var a=t;t=i,i=a,a=n,n=r,r=a}return[t,n,i,r]}function on(e,t){var n=e.left,i=e.right,r=e.top,o=e.bottom;switch(t%4){case 0:return[{x:n,y:r},{x:i,y:r},{x:n,y:o},{x:i,y:o}];case 1:return[{x:i,y:r},{x:i,y:o},{x:n,y:r},{x:n,y:o}];case 2:return[{x:i,y:o},{x:n,y:o},{x:i,y:r},{x:n,y:r}];case 3:return[{x:n,y:o},{x:n,y:r},{x:i,y:o},{x:i,y:r}]}var a=new nn.Z,s=(n+i)/2,u=(r+o)/2;a.rotateAt(s,u,-radian);var c=a.transformRect(n,r,i,o),l=a.transformPoint(c[0],c[3]);l={x:l[0],y:l[1]};var d=a.transformPoint(c[2],c[3]);d={x:d[0],y:d[1]};var h=a.transformPoint(c[0],c[1]);h={x:h[0],y:h[1]};var f=a.transformPoint(c[2],c[1]);return[l,d,h,f={x:f[0],y:f[1]}]}function an(e,t){var n;return function(){var i=this,r=arguments;clearTimeout(n),n=setTimeout((function(){t.apply(i,r)}),e)}}function sn(e){return 0===e.replace(/\s+/gi,"").length}function un(e){var t,n;if(["left","right","top","bottom"].some((function(t){return"number"!=typeof e[t]})))throw new Error("Param error: The rect parameter includes top, bottom, left and right. And only number is available");if(e.left===e.right||e.top===e.bottom)throw new Error("Param error: The value of the rect parameter is invalid.");e.left>e.right&&(t=[e.right,e.left],e.left=t[0],e.right=t[1]);e.bottom>e.top&&(n=[e.bottom,e.top],e.top=n[0],e.bottom=n[1]);return e}var cn=function(){function e(t,n){(0,P._)(this,e),this._isEmpty=!t,this.info=t||{},this.page=n,this.api=n.api,this.engine=n.engine,this.eventEmitter=n.engine.eventEmitter,this.id=t.id,this.objectNumber=t.objectNumber,this.isDestroyed=!1}return(0,A._)(e,[{key:"destroy",value:function(){this.isDestroyed=!0,this.info=null,this.page=null,this.api=null,this.eventEmitter=null}},{key:"checkModidyPerm",value:function(){if("widget"!=this.info.type){if(!this.page.doc.checkPermission(Qt.annotForm))throw new Error("Permission error")}else if(!this.page.doc.checkPermission(Qt.fillForm|Qt.annotForm))throw new Error("Permission error")}},{key:"hasModifyPermission",value:function(){return"widget"==this.info.type?this.page.doc.checkPermission(Qt.fillForm|Qt.annotForm):this.page.doc.checkPermission(Qt.annotForm)}},{key:"isEmpty",value:function(){return this._isEmpty}},{key:"getInfo",value:function(){return this.info}},{key:"getId",value:function(){return this.info.objectNumber}},{key:"getObjectNumber",value:function(){return this.info.objectNumber}},{key:"getUniqueID",value:function(){return this.info.name}},{key:"setUniqueID",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc(),r=this.getUniqueID();return this.page.doc.api.setUniqueId(i.getId(),n.getId(),this.getId(),e).then((function(i){return i?(t.info.name=e,t.update(en.uniqueIDUpdated).then((function(){return t.eventEmitter.emit(le.annotationIDUpdated,e,r,t,n),i}))):i}))}},{key:"getName",value:function(){return this.info.name}},{key:"getPDFPage",value:function(){return this.page}},{key:"getPage",value:function(){return this.getPDFPage()}},{key:"getType",value:function(){return this.info.type}},{key:"getTitle",value:function(){return this.info.title}},{key:"isMarkup",value:function(){return this.info.isMarkup}},{key:"isDeleted",value:function(){return this.info.isDeleted}},{key:"getRect",value:function(){var e=this.info.rect;return new Zt(e.left,e.bottom,e.right,e.top)}},{key:"_setRect",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.oldRect=this.info.rect,this.info.rect=e;var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotRect(r.getId(),i.getId(),this.getId(),e).then((function(e){return e?t.update(en.rectUpdated,n).then((function(){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage()),e})):(t.info.rect=t.oldRect,e)}))}},{key:"setRect",value:function(e){var t=this;this.oldRect=this.info.rect,e=un(e),this.info.rect=e;var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotRect(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(en.rectUpdated).then((function(e){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage()),!0})):(t.info.rect=t.oldRect,e)}))}},{key:"setRectAndInnerRect",value:function(e,t){var n=this;this.oldRect=this.info.rect,this.info.rect=e,this.info.innerRect=t;var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotRectAndInnerRect(r.getId(),i.getId(),this.getId(),e,t).then((function(e){return e?n.update(en.rectUpdated).then((function(e){return n.eventEmitter.emit(le.annotationAppearanceUpdated,[n],n.getPDFPage()),!0})):e}))}},{key:"moveTo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=t.top,r=t.action,o=t.triggerAction,a=void 0===o||o,s=Object.assign({},this.info.rect),u=s.right,c=s.bottom,l=n-s.left,d=i-s.top;this.oldRect=s,this.info.rect={left:n,top:i,right:u+l,bottom:c+d};var h=this.getPDFPage(),f=h.getPDFDoc().getId(),g=h.getId(),v=this.getId();return this.page.doc.api.moveAnnotTo(f,g,v,{left:n,top:i}).then((function(e){return h.getAnnotsByObjectNumArray(e)})).then((function(t){return Promise.all(t.map((function(e){return e._update()}))).then((function(n){a&&e.eventEmitter.emit(le.annotationUpdated,t,h,en.rectUpdated),"move"==r&&e.eventEmitter.emit(le.annotationMovedPosition,t,h,e)}))}))}},{key:"getDeviceRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.page.getDeviceRect(this.getRect(),e,t);if(16&this.info.flag){var i=this.page.getDevicePoint([this.info.rect.left,this.info.rect.top],e,t);return{left:i[0],top:i[1],right:i[0]+n.right-n.left,bottom:i[1]+n.bottom-n.top}}return n}},{key:"getDeviceInnerRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.page.getDeviceRect(this.getInnerRect(),e,t)}},{key:"getContent",value:function(){return this.info.content}},{key:"setContent",value:function(e){var t=this;return this.checkModidyPerm(),this._setContent(e).then((function(n){return t.info.content=e,t.eventEmitter.emit(le.annotationUpdated,[t],t.getPDFPage(),en.contentUpdated),t}))}},{key:"_setContent",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.setAnnotContent(n.getId(),t.getId(),this.getId(),e)}},{key:"getBorderColor",value:function(){return this.info.borderColor}},{key:"setBorderColor",value:function(e){var t=this;this.checkModidyPerm(),isNaN(e)&&(e=(0,j.colorConvertor)(e,"int",1));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotBorderColor(i.getId(),n.getId(),this.getId(),e).then((function(i){return i?(0===e&&(t.info.hasBorderColor=!1),t.update(en.borderColorUpdated).then((function(){t.isGrouped&&t.isGrouped()&&t.getGroupElements().map((function(e){e!=t&&t.eventEmitter.emit(le.annotationAppearanceUpdated,[e],n)}));return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n),i}))):i}))}},{key:"getBorderStyle",value:function(){return this.info.borderInfo.style}},{key:"getBorderStyleWithParam",value:function(){var e,t=this.info.borderInfo,n=t.style,i=t.cloudIntensity,r=t.dashes;switch(n){case me.SOLID:e=[];break;case me.CLOUDY:e=i;break;case me.DASHED:e=r}return{style:n,param:e}}},{key:"getBorderInfo",value:function(){return Object.assign({},this.info.borderInfo)}},{key:"setBorderInfo",value:function(e){var t=this;this.checkModidyPerm();var n=this.getType();if(this.getQuadPoints||"caret"===n||"text"===n)return Promise.resolve();var i=JSON.parse(JSON.stringify(this.info.borderInfo||{}));e=this.info.borderInfo=Object.assign(i,e);var r=this.getPDFPage(),o=r.getPDFDoc();return 1===e.style&&0===e.dashes.length&&(e.dashes=[2,2]),5===e.style&&e.cloudIntensity>2&&(e.cloudIntensity=2),this.page.doc.api.setAnnotBorderInfo(o.getId(),r.getId(),this.getId(),e).then((function(e){return t._update()})).then((function(e){return t.eventEmitter.emit(le.annotationUpdated,[t],r,en.borderInfoUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],r),!0}))}},{key:"setBorderStyle",value:function(e,t){var n=this,i=this.info.borderInfo;switch(i.style=e,e){case 1:i.dashes=t;break;case 5:i.cloudIntensity=t}var r=this.getPDFPage(),o=r.getPDFDoc();return this.page.doc.api.setAnnotBorderStyle(o.getId(),r.getId(),this.getId(),e,t).then((function(e){return r.getAnnotsByObjectNumArray(e)})).then((function(e){for(var t=[],n=e.length;n--;)t.push(e[n]._update());return Promise.all(t)})).then((function(e){return n.eventEmitter.emit(le.annotationUpdated,e,r,en.borderStyleUpdated),n.eventEmitter.emit(le.annotationAppearanceUpdated,e,r),!0}))}},{key:"getBorderDashes",value:function(){return Object.assign([],this.info.borderInfo.dashes)}},{key:"getBorderWidth",value:function(){var e=this.info.borderInfo.width;return void 0===e?1:+e}},{key:"setBorderWidth",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotBorderWidth(i.getId(),n.getId(),this.getId(),e).then((function(e){return t._update().then((function(t){return e}))})).then((function(e){return e&&(t.eventEmitter.emit(le.annotationUpdated,[t],n,en.borderWidthUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)),e}))}},{key:"getCloudIntensity",value:function(){return this.info.borderInfo.cloudIntensity||0}},{key:"reviseSummary",value:function(e){return Promise.resolve(this)}},{key:"rectIsEmpty",value:function(){return this.info.rectIsEmpty}},{key:"update",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._update().then((function(){return n&&e&&t.eventEmitter.emit(le.annotationUpdated,[t],t.getPDFPage(),e),t}))}},{key:"_update",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.getAnnot(i.getId(),n.getId(),this.getId()).then((function(n){return n.rotation&&n.rotation<0&&(n.rotation+=360),e.updateInfo(n,t),e}))}},{key:"_updateMore",value:function(){}},{key:"getRectData",value:function(){var e=this.getPDFPage(),t=e.getPDFDoc();return this.page.doc.api.getRectData({path:"jr/doc/page/annot"},t.getId(),e.getId(),this.getId())}},{key:"updateRectData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.getRectData().then((function(n){return e.oldRect=e.info.rect,e.info=Object.assign({},e.info,n),e.updateInfo(e.info,t),e}))}},{key:"getFlags",value:function(){return this.info.flag}},{key:"isReplace",value:function(){return!1}},{key:"getIndex",value:function(){return this.info.index}},{key:"setFlags",value:function(e,t){var n=this;this.checkModidyPerm(),this.info.flag=e;var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotFlag(r.getId(),i.getId(),this.getId(),e).then((function(r){return r?("widget"==n.getType()&&n.updateUI({type:"display",value:e}),n.update(en.flagsUpdated,!t).then((function(e){return n.eventEmitter.emit(le.annotationAppearanceUpdated,[n],i),r}))):r}))}},{key:"setFlagValue",value:function(e,t){return this.setFlags(e,t)}},{key:"getModifiedDateTime",value:function(){var e=this.info.modifiedTimestamp;return e<0?null:new Date(e)}},{key:"setModifiedDateTime",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setModifiedDateTime(i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(en.modifiedDateTimeUpdated)}))}},{key:"_setModifiedDateTime",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setModifiedDateTime(r.getId(),i.getId(),this.getId(),e).then((function(e){return n.update(en.modifiedDateTimeUpdated,t)}))}},{key:"exportToJSON",value:function(){var e=this.info.hasBorderColor?(0,j.colorConvertor)(16777215&this.info.borderColor,"#"):0,t=this.info.flag,n=[];for(var i in Pe)t&1<<parseInt(i)&&n.push(Pe[i]);n=n.join(",");var r=this.info.name,o=this.page.getIndex(),a=this.info.rect,s=a.left+","+a.bottom+","+a.right+","+a.top,u=this.info.content,c=this.info.borderInfo,l=this.info.type,d=this.info.customEntries,h={type:l,color:e,flags:n,name:r,page:o,rect:s,contents:u,width:c.width,customEntries:d,objectNumber:this.info.objectNumber};switch(-1!=this.info.modifiedTimestamp&&(h.date=ze(new Date(this.info.modifiedTimestamp))),c.style){case me.SOLID:h.style="solid";break;case me.DASHED:h.style="dashed",h.dashPhase=c.dashPhase,h.dashes=c.dashes.join(",");break;case me.UNDERLINE:h.style="underline";break;case me.BEVELED:h.style="beveled";break;case me.INSET:h.style="inset";break;case me.CLOUDY:h.style="cloudy",h.intensity=c.cloudIntensity}return h}},{key:"updateInfo",value:function(e,t){this._isEmpty=!e;var n=this.oldRect||this.info.rect;this.oldRect=null;var i=e.rect;this.info=e,t||this.eventEmitter.emit(le.invalidRect,new Zt(n.left,n.bottom,n.right,n.top),new Zt(i.left,i.bottom,i.right,i.top),e.type,e,this.page),this._updateMore(),this.action&&e.action&&(this.action=this.page.doc.engine.actionFactory.createAction(e.action,this.page.doc,this.page.doc.api,this.eventEmitter,this))}},{key:"getIntent",value:function(){return""}},{key:"setCustomEntries",value:function(e,t){this.info.customEntries=this.info.customEntries||{},this.info.customEntries[e]=t}},{key:"setDictionaryEntry",value:function(e,t){var n=this;return this._setDictionaryEntry(e,t).then((function(e){return e&&n.eventEmitter.emit(le.annotationUpdated,[n],n.getPDFPage(),en.addDictionary),e}))}},{key:"_setDictionaryEntry",value:function(e,t){var n=this,i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setDictionaryEntry(r.getId(),i.getId(),this.getId(),e,t).then((function(i){return i&&n.setCustomEntries(e,t),i}))}},{key:"getDictionaryEntry",value:function(e){return this._getDictionaryEntry(e)}},{key:"_getDictionaryEntry",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.getDictionaryEntry(n.getId(),t.getId(),this.getId(),e)}},{key:"resetAppearanceStream",value:function(){var e=this.getPDFPage(),t=e.getPDFDoc();return this.page.doc.api.resetAppearanceStream(t.getId(),e.getId(),this.getId())}},{key:"getDictValue",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.getDictValue({path:"jr/doc/page/annot"},n.getId(),t.getId(),this.getId(),e)}},{key:"setDictValue",value:function(e,t){var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setDictValue({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e,t)}},{key:"setCustomAPStream",value:function(e,t){var n=this;return this.page.doc.api.setCustomAPStream({path:"jr/doc/page/annot"},doc.getId(),page.getId(),this.getId(),e,t).then((function(e){n.updateInfo(n.info,!1),n.eventEmitter.emit(le.annotationUpdated,[n],n.getPDFPage(),le.annotationAppearanceUpdated)}))}}]),e}();const ln=cn;var dn,hn={ReadOnly:1,Required:2,NoExport:4,Hidden:8,ButtonNoToggleToOff:16384,ButtonRadiosInUnison:33554432,TextMultiline:4096,TextPassword:8192,TextDoNotSpellCheck:4194304,TextDoNotScroll:8388608,TextComb:16777216,ComboEdit:262144,ChoiceMultiSelect:2097152,CommitOnSelChange:67108864,inUnison:function(e){return e&hn.ButtonRadiosInUnison},isHidden:function(e){return e&hn.Hidden},isReadOnly:function(e){return e&hn.ReadOnly},isRequired:function(e){return e&hn.Required},isNoExport:function(e){return e&hn.NoExport},isMultiline:function(e){return e&hn.TextMultiline},isPassword:function(e){return e&hn.TextPassword},isComb:function(e){return e&hn.TextComb},isNoSpellCheck:function(e){return e&hn.TextDoNotSpellCheck},isNoScroll:function(e){return e&hn.TextDoNotScroll},isComboEdit:function(e){return e&hn.ComboEdit},isChoiceMultiSelect:function(e){return e&hn.ChoiceMultiSelect}},fn={FlagExclude:1,FlagIncludeNoValueFields:2,FlagExportFormat:4,FlagGetMethod:8,FlagWithCoordinates:16,FlagAsXFDF:32,FlagIncludeAppendSaves:64,FlagIncludeAnnotations:128,FlagSubmitAsPDF:256,FlagCanonicalFormat:512,FlagExclNonUserAnnots:1024,FlagExclFKey:2048,FlagEmbedForm:8192,isExclude:function(e){return e&fn.FlagExclude},isIncludeNoValueFields:function(e){return e&fn.FlagIncludeNoValueFields},isHTML:function(e){return e&fn.FlagExportFormat},isGetMethod:function(e){return e&fn.FlagGetMethod},isXFDF:function(e){return e&fn.FlagAsXFDF},isPDF:function(e){return e&fn.FlagSubmitAsPDF},getType:function(e){var t=fn.isHTML(e);if(t)return"HTML";var n=fn.isXFDF(e);if(n)return"XFDF";var i=fn.isPDF(e);return i?"PDF":t||n||i?void 0:"FDF"}},gn={Unknown:0,PushButton:1,CheckBox:2,RadioButton:3,Text:6,ListBox:5,ComboBox:4,Sign:7,Barcode:8},vn=hn;!function(e){e.STATE_HANDLER_HAND="hand",e.STATE_HANDLER_CHECK_THE_SEARCH="checkTheSearch",e.STATE_HANDLER_CREATE_CARET="createCaret",e.STATE_HANDLER_CREATE_ARROW="createArrow",e.STATE_HANDLER_CREATE_AREA_HIGHLIGHT="createAreaHighlight",e.STATE_HANDLER_CREATE_CREATE_AREA_HIGHLIGHT="createAreaHighlight",e.STATE_HANDLER_CREATE_CIRCLE="createCircle",e.STATE_HANDLER_CREATE_FILE_ATTACHMENT="createFileAttachment",e.STATE_HANDLER_CREATE_HIGHLIGHT="createHighlight",e.STATE_HANDLER_CREATE_IMAGE="createImage",e.STATE_HANDLER_CREATE_LINK="createLink",e.STATE_HANDLER_CREATE_LINE="createLine",e.STATE_HANDLER_CREATE_DISTANCE="createDistance",e.STATE_HANDLER_CREATE_PERIMETER="createPerimeter",e.STATE_HANDLER_CREATE_AREA="createArea",e.STATE_HANDLER_CREATE_CIRCLE_AREA="createCircleArea",e.STATE_HANDLER_CREATE_PENCIL="createPencil",e.STATE_HANDLER_CREATE_POLYGON_CLOUD="createPolygonCloud",e.STATE_HANDLER_CREATE_POLYGON="createPolygon",e.STATE_HANDLER_CREATE_POLYLINE="createPolyline",e.STATE_HANDLER_CREATE_REPLACE="createReplace",e.STATE_HANDLER_CREATE_SQUARE="createSquare",e.STATE_HANDLER_CREATE_SQUIGGLY="createSquiggly",e.STATE_HANDLER_CREATE_STAMP="createStamp",e.STATE_HANDLER_CREATE_STRIKE_OUT="createStrikeOut",e.STATE_HANDLER_CREATE_TEXT="createText",e.STATE_HANDLER_CREATE_UNDERLINE="createUnderline",e.STATE_HANDLER_MARQUEE="marquee",e.STATE_HANDLER_ERASER="eraser",e.STATE_HANDLER_LOUPE="loupe",e.STATE_HANDLER_SELECT_TEXT_ANNOTATION="select-text-annotation",e.STATE_HANDLER_SELECT_TEXT_IMAGE="select-text-image",e.STATE_HANDLER_SELECT_ANNOTATION="select-annotation",e.STATE_HANDLER_CREATE_FREETEXT_BOX="createFreeTextBox",e.STATE_HANDLER_CREATE_FREETEXT_CALLOUT="createFreeTextCallout",e.STATE_HANDLER_CREATE_FREETEXT_TYPEWRITER="createFreeTextTypewriter",e.STATE_HANDLER_CREATE_FIELD_TEXT="CreateTextStateHandler",e.STATE_HANDLER_CREATE_FIELD_SIGNATURE="CreateSignStateHandler",e.STATE_HANDLER_CREATE_FIELD_PUSH_BUTTON="CreatePushButtonStateHandler",e.STATE_HANDLER_CREATE_FIELD_CHECK_BOX="CreateCheckBoxStateHandler",e.STATE_HANDLER_CREATE_RADIO_BUTTON="CreateRadioButtonStateHandler",e.STATE_HANDLER_CREATE_FIELD_COMBO_BOX="CreateComboBoxStateHandler",e.STATE_HANDLER_CREATE_FIELD_LIST_BOX="CreateListBoxStateHandler",e.STATE_HANDLER_CREATE_FIELD_DATE="CreateDateStateHandler",e.STATE_HANDLER_CREATE_FIELD_IMAGE="CreateImageStateHandler",e.STATE_HANDLER_SNAPSHOT_TOOL="snapshot-tool",e.STATE_HANDLER_CREATE_DOCUMENT_ATTACHMENT="createDocumentAttachment"}(dn||(dn={}));var pn,mn=dn.STATE_HANDLER_HAND,yn=dn.STATE_HANDLER_CHECK_THE_SEARCH,kn=dn.STATE_HANDLER_CREATE_CARET,bn=dn.STATE_HANDLER_CREATE_ARROW,wn=dn.STATE_HANDLER_CREATE_AREA_HIGHLIGHT,_n=dn.STATE_HANDLER_CREATE_AREA_HIGHLIGHT,Pn=dn.STATE_HANDLER_CREATE_CIRCLE,An=dn.STATE_HANDLER_CREATE_FILE_ATTACHMENT,Sn=dn.STATE_HANDLER_CREATE_HIGHLIGHT,xn=dn.STATE_HANDLER_CREATE_IMAGE,Cn="createEditImage",Dn=dn.STATE_HANDLER_CREATE_LINK,En=dn.STATE_HANDLER_CREATE_LINE,In=dn.STATE_HANDLER_CREATE_DISTANCE,Rn=dn.STATE_HANDLER_CREATE_PERIMETER,Tn=dn.STATE_HANDLER_CREATE_AREA,Fn=dn.STATE_HANDLER_CREATE_CIRCLE_AREA,Mn=dn.STATE_HANDLER_CREATE_PENCIL,On=dn.STATE_HANDLER_CREATE_POLYGON_CLOUD,Ln=dn.STATE_HANDLER_CREATE_POLYGON,Nn=dn.STATE_HANDLER_CREATE_POLYLINE,Vn=dn.STATE_HANDLER_CREATE_REPLACE,Bn=dn.STATE_HANDLER_CREATE_SQUARE,jn="createSquareCrop",Un=dn.STATE_HANDLER_CREATE_SQUIGGLY,Hn=dn.STATE_HANDLER_CREATE_STAMP,Wn=dn.STATE_HANDLER_CREATE_STRIKE_OUT,Yn=dn.STATE_HANDLER_CREATE_TEXT,qn=dn.STATE_HANDLER_CREATE_UNDERLINE,Kn=dn.STATE_HANDLER_MARQUEE,$n=dn.STATE_HANDLER_ERASER,zn=dn.STATE_HANDLER_LOUPE,Gn=dn.STATE_HANDLER_SELECT_TEXT_ANNOTATION,Jn=dn.STATE_HANDLER_SELECT_TEXT_IMAGE,Xn="select-text",Zn=dn.STATE_HANDLER_SELECT_ANNOTATION,Qn=dn.STATE_HANDLER_CREATE_FREETEXT_TYPEWRITER,ei=dn.STATE_HANDLER_CREATE_FREETEXT_CALLOUT,ti=dn.STATE_HANDLER_CREATE_FREETEXT_BOX,ni=dn.STATE_HANDLER_SNAPSHOT_TOOL,ii="create-crop-pages",ri=dn.STATE_HANDLER_CREATE_DOCUMENT_ATTACHMENT,oi=dn.STATE_HANDLER_CREATE_FIELD_TEXT,ai=dn.STATE_HANDLER_CREATE_FIELD_SIGNATURE,si=dn.STATE_HANDLER_CREATE_FIELD_PUSH_BUTTON,ui=dn.STATE_HANDLER_CREATE_RADIO_BUTTON,ci="CreateArticleButtonStateHandler",li=(pn={},(0,J._)(pn,Yn,"text"),(0,J._)(pn,Sn,"highlight"),(0,J._)(pn,Wn,"strikeout"),(0,J._)(pn,qn,"underline"),(0,J._)(pn,Un,"squiggly"),(0,J._)(pn,Vn,"strikeout"),(0,J._)(pn,kn,"caret"),(0,J._)(pn,Qn,"freetext"),(0,J._)(pn,ei,"freetext"),(0,J._)(pn,ti,"freetext"),(0,J._)(pn,Bn,"square"),(0,J._)(pn,Pn,"circle"),(0,J._)(pn,En,"line"),(0,J._)(pn,bn,"line"),(0,J._)(pn,Ln,"polygon"),(0,J._)(pn,Nn,"polyline"),(0,J._)(pn,On,"polygon"),(0,J._)(pn,wn,"highlight"),(0,J._)(pn,Mn,"ink"),(0,J._)(pn,Hn,"stamp"),(0,J._)(pn,In,"line"),(0,J._)(pn,Rn,"polyline"),(0,J._)(pn,Tn,"polygon"),(0,J._)(pn,Fn,"circle"),(0,J._)(pn,An,"fileattachment"),(0,J._)(pn,xn,"screen"),(0,J._)(pn,Dn,"link"),(0,J._)(pn,"create-multi-media-state","screen"),(0,J._)(pn,"create-redaction-text-image-state","redact"),(0,J._)(pn,"create-redaction-state","redact"),pn),di={CreatePushButtonStateHandler:gn.PushButton,CreateCheckBoxStateHandler:gn.CheckBox,CreateRadioButtonStateHandler:gn.RadioButton,CreateComboBoxStateHandler:gn.ComboBox,CreateListBoxStateHandler:gn.ListBox,CreateTextStateHandler:gn.Text,CreateSignStateHandler:gn.Sign,CreateDateStateHandler:gn.Text,CreateImageStateHandler:gn.PushButton};const hi={annotation:"annotation"};var fi=function(){function e(t){(0,P._)(this,e),this.annot=t.isGrouped&&t.isGrouped()?t.getGroupHeader():t,this.tooltip="",this.delay=500,this.moveThreshold=2,this.positionThreshold=10,this.oldClientX=0,this.oldClientY=0,this.tipElement=document.createElement("div"),document.getElementsByClassName("fv_viewer-tooltip-container").length>0&&(this.tooltip=document.getElementsByClassName("fv_viewer-tooltip-container")[0]),this.createTooltipElement()}return(0,A._)(e,[{key:"createTooltipElement",value:function(){if(!(document.getElementsByClassName("fv_viewer-tooltip-container").length>0)){this.tipElement.classList.add("fv_viewer-tooltip-container"),this.tipElement.classList.add("tooltip-unactive");var e="";e+='<div class="fv_viewer-tooltip-title"> '+this.annot.getTitle()+"</div>",e+='<div class="fv_viewer-tooltip-content"> '+this.annot.getContent()+"</div>",this.tipElement.innerHTML=e,document.getElementsByTagName("body")[0].appendChild(this.tipElement),this.tooltip=document.getElementsByClassName("fv_viewer-tooltip-container")[0]}}},{key:"getPosition",value:function(e,t){var n=document.documentElement.clientHeight,i=this.tooltip.getBoundingClientRect().width,r=this.tooltip.getBoundingClientRect().height,o=e+this.positionThreshold,a=t+this.positionThreshold;return document.documentElement.clientWidth-e<i+this.positionThreshold&&(o-=i+this.positionThreshold),n-a<r&&(a=t-r),{x:o,y:a}}},{key:"setPosition",value:function(e,t){this.tooltip.style.left=e+"px",this.tooltip.style.top=t+"px"}},{key:"hide",value:function(){this.tooltip.classList.remove("tooltip-active"),this.tooltip.classList.add("tooltip-unactive")}},{key:"show",value:function(e,t){if("widget"===this.annot.getType()){var n=this.annot.getField();if(!n.getAlternateName())return;document.getElementsByClassName("fv_viewer-tooltip-title")[0].innerHTML="",document.getElementsByClassName("fv_viewer-tooltip-content")[0].innerHTML=n.getAlternateName()}else{var i=this.annot.getTitle(),r=this.annot.getContent();if(!i)return;document.getElementsByClassName("fv_viewer-tooltip-title")[0].innerHTML=i,document.getElementsByClassName("fv_viewer-tooltip-content")[0].innerHTML=r}var o=this.getPosition(e,t);this.setPosition(o.x,o.y),this.tooltip.classList.remove("tooltip-unactive"),this.tooltip.classList.add("tooltip-active")}}]),e}();function gi(e,t){var n=e.x,i=e.y,r=t.left,o=t.right,a=t.top,s=t.bottom;return n>=r&&n<=o&&i>=s&&i<=a}var vi="vertical",pi="horizontal",mi=function(){function e(t,n){(0,P._)(this,e),this.fromInchRate=t,this.name=n,Object.defineProperties(this,{fromInchRate:{value:t,enumerable:!0,writable:!1,configurable:!0},name:{value:n,enumerable:!0,writable:!1,configurable:!0}})}return(0,A._)(e,[{key:"isPixel",get:function(){return!1}},{key:"convertTo",value:function(e,t){return e/this.fromInchRate*t.fromInchRate}},{key:"convertAreaTo",value:function(e,t){return e/Math.pow(this.fromInchRate,2)*Math.pow(t.fromInchRate,2)}}]),e}(),yi=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,0,"px")).orientation=e,Object.defineProperty((0,w._)(i),"fromInchRate",{get:function(){var t=(0,j.getDPI)();switch(e){case pi:return t.x;case vi:return t.y;default:return t.x}}}),i}return(0,A._)(n,[{key:"isPixel",get:function(){return!0}}]),n}(mi);const ki={inch:"inch",custom:"custom",mi:"mi",pt:"pt",ft:"ft",yd:"yd",km:"km",m:"m",cm:"cm",mm:"mm",pica:"pica"};var bi,wi=new mi(1,ki.inch),_i=new mi(1,ki.custom),Pi=new mi(1/63360,ki.mi),Ai=new mi(72,ki.pt),Si=new mi(1/12,ki.ft),xi=new mi(1/36,ki.yd),Ci=new mi(.0254/1e3,ki.km),Di=new mi(.0254,ki.m),Ei=new mi(2.54,ki.cm),Ii=new mi(25.4,ki.mm),Ri=new mi(6,ki.pica),Ti=new yi(pi),Fi=new yi(vi),Mi=(bi={},(0,J._)(bi,wi.name,wi),(0,J._)(bi,_i.name,_i),(0,J._)(bi,Pi.name,Pi),(0,J._)(bi,Ai.name,Ai),(0,J._)(bi,Si.name,Si),(0,J._)(bi,xi.name,xi),(0,J._)(bi,Ci.name,Ci),(0,J._)(bi,Di.name,Di),(0,J._)(bi,Ei.name,Ei),(0,J._)(bi,Ii.name,Ii),(0,J._)(bi,Ri.name,Ri),(0,J._)(bi,Ti.name,Ti),bi);function Oi(e){switch(e=(e=e.toLowerCase()).replace(/[^a-z]/g,"")){case"in":e="inch";break;case"p":e="pica"}return Mi[e]}function Li(e){var t=1;switch(e){case"pt":t=72;break;case"in":case"inch":default:t=1;break;case"cm":t=2.54;break;case"p":case"pica":t=5.9;break;case"mm":t=25.4}return t}var Ni,Vi="userSpaceUnit",Bi="userSpaceScaleValue",ji="realScaleValue",Ui=(Ni={},(0,J._)(Ni,dn.STATE_HANDLER_CREATE_PERIMETER,"perimeter"),(0,J._)(Ni,dn.STATE_HANDLER_CREATE_DISTANCE,"distance"),(0,J._)(Ni,dn.STATE_HANDLER_CREATE_AREA,"area"),(0,J._)(Ni,dn.STATE_HANDLER_CREATE_CIRCLE_AREA,"area"),function(){function e(){(0,P._)(this,e)}return(0,A._)(e,null,[{key:"convertPoint2RealUnit",value:function(e,t){if(!t)return e;var n=t[Bi],i=t[Vi],r=t[ji];return Ai.convertTo(e,i)*(r/n)}},{key:"caculateDistance",value:function(t,n,i){var r=n.x-t.x,o=n.y-t.y,a=Math.abs(r),s=Math.abs(o),u=Math.sqrt(a*a+s*s);return e.convertPoint2RealUnit(u,i)}},{key:"caculateAngle",value:function(t,n,i,r){var o=e.caculateDistance(t,n,r),a=e.caculateDistance(n,i,r),s=e.caculateDistance(t,i,r),u=(Math.pow(o,2)+Math.pow(a,2)-Math.pow(s,2))/(2*o*a);return Number.isNaN(u)||Number.isNaN(Math.acos(u))?0:Math.round(Math.abs(Math.acos(u))/Math.PI*180*100)/100}},{key:"caculateTriangleArea",value:function(e,t,n,i){var r=e.x*t.y+t.x*n.y+n.x*e.y-(e.x*n.y+t.x*e.y+n.x*t.y);if(r/=2,!i)return r;var o=i[Bi],a=i[Vi],s=i[ji];return Ai.convertAreaTo(r,a)*Math.pow(s/o,2)}},{key:"caculatePolygonArea",value:function(t,n){for(var i={x:0,y:0},r=0,o=1;o<=t.length;++o)o<t.length?r+=e.caculateTriangleArea(i,t[o-1],t[o],n):r+=e.caculateTriangleArea(i,t[o-1],t[0],n);return Math.abs(r)}},{key:"caculateCircleArea",value:function(e,t){var n=(e.right-e.left)*(e.top-e.bottom)*Math.PI;if(!t)return n;var i=t[Bi],r=t[Vi],o=t[ji];return Ai.convertAreaTo(n/4,r)*Math.pow(o/i,2)}}]),e}());const Hi={unKnownType:"unknowntype",text:"text",link:"link",freeText:"freetext",line:"line",square:"square",circle:"circle",polygon:"polygon",polyLine:"polyline",polyline:"polyline",highlight:"highlight",underline:"underline",squiggly:"squiggly",strikeOut:"strikeout",stamp:"stamp",caret:"caret",ink:"ink",psInk:"psink",fileAttachment:"fileattachment",sound:"sound",movie:"movie",widget:"widget",screen:"screen",printerMark:"printermark",trapNet:"trapnet",watermark:"watermark",threeD:"3d",popup:"popup",redact:"redact"};var Wi,Yi;function qi(){}!function(e){e[e.throttle=0]="throttle",e[e.debounce=1]="debounce"}(Wi||(Wi={})),function(e){e.MEASUREMENT="measurement",e.COMPARISON="comparison",e.STAMP="stamp",e.SIGN_CERTIFY="sign-certify",e.SIGNATURE="signature"}(Yi||(Yi={}));var Ki="measurement-info",$i={userSpaceUnit:wi,userSpaceScaleValue:1,realUnit:wi,realScaleValue:1,caption:"",markup:!0},zi="measurementInfo",Gi=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,J._)((0,w._)(e),"pdfViewer",void 0),e}return(0,A._)(n,[{key:"allInjected",value:function(){var e=this;this.pdfViewer.store.dispatch(zi,$i),this.getStorage().get(Yi.MEASUREMENT,Ki).then((function(t){e.isDestroyed||t&&(e.pdfViewer.getStore().dispatch(zi,(0,k._)({},e.convertFromRaw(t))),e.addDestroyHook(e.pdfViewer.store.subscribe(zi,(function(t){if(!e.isDestroyed)return e.updateMeasurementInfo(t)}))))}));var t=this;this.addDestroyHook(this.getStorage().onChange((function(t){t.context.feature===Yi.MEASUREMENT&&e.pdfViewer.store.dispatch(zi,e.convertFromRaw(t.newValue))})),this.pdfViewer.addEventListener(de.pageNumberChange,(0,_._)((function(){var e,n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return t.isDestroyed?[2]:[4,(e=t.getStorage()).get(Yi.MEASUREMENT,Ki)];case 1:return n=i.sent(),[4,e.set(Yi.MEASUREMENT,Ki,n)];case 2:return i.sent(),[2]}}))}))))}},{key:"updateMeasurementInfo",value:function(e){var t=this;return(0,_._)((function(){var n,i,r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return[4,t.getMeasurementInfo()];case 1:return n=o.sent(),i=(0,k._)({},n,e),r=t.convertToRaw(i),[4,t.getStorage().set(Yi.MEASUREMENT,Ki,r)];case 2:return o.sent(),[2]}}))}))()}},{key:"getMeasurementInfo",value:function(){return this.pdfViewer.store.getCurrentValue(zi)}},{key:"onMeasurementInfoChange",value:function(e){return this.pdfViewer.store.subscribe(zi,e)||qi}},{key:"getStorage",value:function(){return this.pdfViewer.getStorage()}},{key:"convertFromRaw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"object"!=typeof e?Object.assign({},$i):{userSpaceUnit:e.userSpaceUnit?new mi(e.userSpaceUnit.fromInchRate,e.userSpaceUnit.name):wi,userSpaceScaleValue:null==e.userSpaceScaleValue?1:e.userSpaceScaleValue,realUnit:e.realUnit?new mi(e.realUnit.fromInchRate,e.realUnit.name):wi,realScaleValue:null==e.realScaleValue?1:e.realScaleValue,caption:e.caption||"",markup:!1!==e.markup}}},{key:"convertToRaw",value:function(e){return{userSpaceUnit:e.userSpaceUnit?{fromInchRate:e.userSpaceUnit.fromInchRate,name:e.userSpaceUnit.name}:$i.userSpaceUnit,userSpaceScaleValue:e.userSpaceScaleValue||$i.userSpaceScaleValue,realUnit:e.realUnit?{fromInchRate:e.realUnit.fromInchRate,name:e.realUnit.name}:$i.realUnit,realScaleValue:e.realScaleValue||$i.realScaleValue,caption:e.caption||$i.caption,markup:void 0===e.markup?$i.markup:e.markup}}},{key:"isSame",value:function(e,t){return JSON.stringify(this.convertToRaw(e))===JSON.stringify(this.convertToRaw(t))}}],[{key:"inject",value:function(){return{pdfViewer:RP}}}]),n}(j.Disposable),Ji=function(){},Xi=0,Zi=(0,j.createDOM)("canvas",{class:"highlightAP fv__ui-annots"}),Qi=(0,j.createDOM)("canvas",{class:"annotRenderers fv__ui-annots"}),er=(0,j.createDOM)("div",{class:"linkHighlightMode",style:"display:none;cursor:pointer;position:absolute;z-index:27;"}),tr=(0,j.createDOM)("div",{class:"curAnnot",style:"cursor:pointer;position:absolute;z-index:28;"}),nr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;(0,P._)(this,n),(o=t.call(this,r)).name="annotsRender",o.$ui=e,0==o.$ui.find(".curAnnot").length&&o.$ui.append(o.$ownUI=O()([Zi.cloneNode(),Qi.cloneNode(),er.cloneNode(),tr.cloneNode()])),o.annotRenders={};var a=o.pdfViewer.customs||{};return o.activeAnnotBefore=a.activeAnnotBefore||Ji,o.activeAnnotAfter=a.activeAnnotAfter||Ji,o.unActiveAnnotBefore=a.unActiveAnnotBefore||Ji,o.unActiveAnnotAfter=a.unActiveAnnotAfter||Ji,o.pageRender=o._parent,o.initAnnotEvent(),o.renderParams=[r.scale,r.rotate,r.containerVisibleRect],o.hotAnnot=0,o.showAnnots=new Set,o.backAnnots=new Set,o.annotFiltered=r.docRender.hideMarkupFlag,o.rerenderAfterFilterTaskExecutor=new j.DebounceAsyncTaskExecutor,o.rerenderAnnotThrottleTaskExecutor=new j.ThrottleAsyncTaskExecutor(50,!0),o.rerenderAnnotDebounceTaskExecutor=new j.DebounceAsyncTaskExecutor(50,!1),o.mouseEventTaskExecutor=new j.ThrottleAsyncTaskExecutor(50,!0),o.rerenderMode=Wi.throttle,o}return(0,A._)(n,[{key:"setRerenderMode",value:function(e){this.rerenderMode=e}},{key:"getRerenderMode",value:function(){return this.rerenderMode}},{key:"getRerenderAnnotTaskExecutor",value:function(){return this.rerenderMode===Wi.throttle?this.rerenderAnnotThrottleTaskExecutor:this.rerenderAnnotDebounceTaskExecutor}},{key:"removeUI",value:function(){}},{key:"getAnnotAtPoint",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.pdfViewer.stateHandlerManager.currentStateHandler.getStateName();if(-1!=["hand","select-annotation"].indexOf(n)){var i=this._parent;if(!i)return null;var r=i.getPDFPointFromClientPoint(e.clientX,e.clientY);return i.getActiveAnnotInfo(r,t)}}},{key:"processStateData",value:function(e){var t=e.reduce((function(e,t){var n=t.getTitle(),i=e[n];return i?i.getModifiedDateTime()<=t.getModifiedDateTime()&&(e[n]=t):e[n]=t,e}),{});return Object.values(t).map((function(e){return e.getState()}))}},{key:"initEmitter",value:function(){var e,t=this,n=this.pdfViewer.getEventEmitter(),i=this._parent,r=function(){var e,t,n,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Array.isArray(o)||(o=[o]);var a=o.filter((function(e){return"popup"!=e.getType()})).map((function(e){Object.assign({},e.info.rect);var t=i.scale*j.dpr;return i.page.getAnnotDeviceRect(e,t,i.rotate)}));return{left:(e=Math).min.apply(e,(0,I._)(a.map((function(e){return e.left})))),bottom:(t=Math).max.apply(t,(0,I._)(a.map((function(e){return e.bottom})))),right:(n=Math).max.apply(n,(0,I._)(a.map((function(e){return e.right})))),top:(r=Math).min.apply(r,(0,I._)(a.map((function(e){return e.top})))),hasHighlight:o.some((function(e){return"highlight"==e.getType()}))}},o=function(e,n){return n=n||r(e),t.updateRender(n)};n.on(de.annotationLoaded,this.annotLoaded=function(e,n,i){t.isDestroyed||t.pageRender.isDestroyed||e==t.pageRender.page&&t.renderWidget.apply(t,(0,I._)(t.renderParams))}),n.on("updatePageAnnot",this.updatePageAnnot=function(e,n,i,r){t.isDestroyed||t.pageRender.isDestroyed||(e==t.pageRender.page&&o(n),i==t.pageRender.page&&o(r))});var a,s=[de.annotationRemoved,de.annotationAdd,de.annotationOrderChanged];s.forEach((function(e){n.on(e,t[e+"Handler"]=function(e){if(!t.isDestroyed&&!t.pageRender.isDestroyed&&e[0]&&e[0].page&&e[0].page.getIndex()==t.pageRender.index){if(e[0].isDeleted()||e.map((function(e){return t.showAnnots.add(e.id)})),a){var n=r(e);a={left:Math.min(a.left,n.left),bottom:Math.max(a.bottom,n.bottom),right:Math.max(a.right,n.right),top:Math.min(a.top,n.top),hasHighlight:a.hasHighlight||e.some((function(e){return"highlight"==e.getType()}))}}else a=r(e);t.getRerenderAnnotTaskExecutor().exec((function(e){if(e[0].page&&t.pageRender&&t.pageRender.page){var n=a&&o(e,a).then((function(e){e&&t.pdfViewer.eventEmitter.emit("renderAnnotSuccess",t.pageRender)}));return a=null,n}}),[e])}})}));var u,c=[de.invalidRect];c.forEach((function(e){n.on(e,t[e+"Handler"]=function(e,n,i,r,s){if(!t.isDestroyed&&!t.pageRender.isDestroyed&&s==t.pageRender.page){e=t.pageRender.page.getAnnotDeviceRect(r,t.pageRender.scale*j.dpr,t.pageRender.rotate,e),n=t.pageRender.page.getAnnotDeviceRect(r,t.pageRender.scale*j.dpr,t.pageRender.rotate,n);var u={left:Math.min(e.left,n.left),bottom:Math.max(e.bottom,n.bottom),right:Math.max(e.right,n.right),top:Math.min(e.top,n.top),hasHighlight:"highlight"==i};a=a?{left:Math.min(a.left,u.left),bottom:Math.max(a.bottom,u.bottom),right:Math.max(a.right,u.right),top:Math.min(a.top,u.top),hasHighlight:a.hasHighlight||"highlight"==i}:u,"screen"==i&&r.isAudioVideo?(t.genScreenIcon(t.pageRender,r),t.updateActiveRect(t.pageRender,r,".fv__pdf-player")):"freetext"==i?t.updateActiveRect(t.pageRender,r,".fv__pdf-page-annot-handler-rect",i):"line"==i&&(t.updateActiveRect(t.pageRender,r,".fv__pdf-page-annot-handler-rect"),t.updateLinePoint(t.pageRender,r)),t.getRerenderAnnotTaskExecutor().exec((function(e){if(t.pageRender&&t.pageRender.page){var n=a&&o(e,a);return a=null,n}}),[])}})})),n.on("annot-filter",this.applyFilter=function(e,n){switch(e){case"start":t.startFilterAnnot();break;case"end":t.endFilterAnnot();break;default:t.addShowAnnot(n)}}),n.on(de.mouseEnter,this.mouseEnterListener=function(e,n){(t.pdfViewer.config.showAnnotTooltip&&"widget"!==n.annots[0].getType()||t.pdfViewer.config.showFormFieldTooltip&&"widget"===n.annots[0].getType())&&(u=t.pdfViewer.customs.AnnotTooltip?new t.pdfViewer.customs.AnnotTooltip(t.pdfViewer,n.annots[0]):new fi(n.annots[0])).show(n.e.clientX,n.e.clientY)}),n.on(de.mouseLeave,this.mouseLeaveListener=function(e,t){u&&u.hide()}),n.on(de.pageMeasureScaleRatioChanged,this.updatePageMeasureScaleRatio=function(e,n){t._updatePageMeasureScaleRatio(e,n)}),(e=s).push.apply(e,(0,I._)(c)),this.addDestroyHook.apply(this,[this.pdfViewer.addEventListener(de.annotationImported,(function(){t.pdfViewer.getAllActiveElements().forEach((function(e){e.isActive&&e.annot&&e.active()}))})),function(){return n.off(de.annotationLoaded,t.annotLoaded)},function(){return n.off(de.fitWidthResizeViewport,t.resize)},function(){return n.off("updatePageAnnot",t.updatePageAnnot)},function(){return n.off("annot-filter",t.applyFilter)},function(){return n.off(de.mouseEnter,t.mouseEnterListener)},function(){return n.off(de.mouseLeave,t.mouseLeaveListener)},function(){return n.off(de.pageMeasureScaleRatioChanged,t.updatePageMeasureScaleRatio)}].concat((0,I._)(s.map((function(e){return function(){return n.off(e,t[e+"Handler"])}})))))}},{key:"isAnnotHidden",value:function(e){var t=this.pdfViewer.getAnnotManager().getAnnotFlag(e).flag;return(t&tn.invisible)===tn.invisible||(t&tn.hidden)===tn.hidden||(t&tn.noView)===tn.noView}},{key:"initAnnotEvent",value:function(){var e=this,t=this,n=this.pdfViewer,i=n.getCurrentPDFDoc();if(i&&!i.isDestroyed&&!i.isDynamicXFA()){var r=n.getEventEmitter(),o=this._parent;this.initEmitter();var a,s=function(e){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&t.$ui.find(".curAnnot").hide(),t.hotAnnot&&-1!==["redact","link"].indexOf(t.hotAnnot.type)&&!t.hotAnnot.isDeleted){if("link"==t.hotAnnot.type)return void t.$ui.find(".linkHighlightMode").css({border:"none",background:"none","mix-blend-mode":"initial"}).hide();if(t.hotAnnot.type==Hi.redact&&t.getAnnotRender(t.hotAnnot.id).component.isActive)return;var n=o.page.getDeviceRect(t.hotAnnot.rect,o.scale*j.dpr,o.rotate);t.mouseEventTaskExecutor.cancel(),t.mouseEventTaskExecutor.waitForLastTask().then((function(){return t.pageRender.page.getAnnotBitmap(t.hotAnnot.id,o.scale*j.dpr*4/3,o.rotate,{x:n.left-3,y:n.top-3,width:n.right-n.left+6,height:n.bottom-n.top+6},!0,"normal").then((function(e){return t.hotAnnot=0,a=null,t.updateCanvas(e,".annotRenderers")}))}))}r.emit(de.mouseLeave,hi.annotation,{annots:[a],e})},u=function(t){if(o.isDestroyed)return e.hotAnnot=null,Promise.resolve();var n=(0,E._)(o.getPDFPointFromClientPoint(t.clientX,t.clientY,!0),2),i=n[0],r=n[1];return(o.page.getAnnotCount()>1e3?new Promise((function(n){var i=e.getAnnotAtPoint(t);n(i?i.id:-1)})):o.getPDFPage().then((function(e){if(e.isVirtual())return-1;var t=o.scale,n=o.rotate,a=e.getDeviceMatrix(n);return a.scale(t,t),e.getAnnotObjectNumAtDevicePoint([i,r],5,[a.a,a.b,a.c,a.d,a.e,a.f])}))).then((function(t){if(-1===t)return e.hotAnnot=null;e.hotAnnot=0;var n=e.getAnnotRender(t);if(n){var i=n.component.annot;return j.isTouchDevice||(e.hotAnnot=i.info),i}})).then((function(t){if(t){var n=t.info;return-1!==["widget","link","screen"].indexOf(n.type)?n:e.annotFiltered&&!e.showAnnots.has(n.id)||e.isAnnotHidden(t)?e.hotAnnot=0:n}}))};this.findAnnot=u;this.$ui.find(".curAnnot").on("mousemove",(function(e){})).on("mouseleave",s);var c=function(){if(!n)return!1;var e=n.getStateHandlerManager().getStateHandlerConfig(mn);return!e||!!e.enableAnnotationSelectionTool},l=function(t,n){var i=o.page.getDeviceRect(t.getRect(),o.scale*j.dpr,o.rotate);return e.pageRender.page.getAnnotBitmap(t.id,o.scale*j.dpr*4/3,o.rotate,{x:i.left-3,y:i.top-3,width:i.right-i.left+6,height:i.bottom-i.top+6},!0,n).then((function(n){return e.updateCanvas(n,t.getType()===Hi.highlight?".highlightAP":".annotRenderers")}))};this.moveHandler=function(t){if(!Xi){1;var i=n.stateHandlerManager.currentStateHandler.getStateName();-1!=["hand","select-annotation"].indexOf(i)&&("hand"!==i||c())&&e.mouseEventTaskExecutor.exec((function(){return u(t).then((function(i){if(!i){var s=n.getAllActiveElements();if(!s.length)return e.$ui.find(".curAnnot").hide();var u=s.find((function(e){return e.annot&&e.annot.getType()===Hi.redact}));if(!u||!a||a.isDeleted())return e.$ui.find(".curAnnot").hide();if(!j.isTouchDevice){if(u.getPDFPage().getIndex()!==o.page.getIndex())return;return l(a,"normal")}}Promise.resolve();if(a&&!a.isDeleted()&&a.getType()===Hi.redact&&i.type===Hi.redact&&a.id!==i.id){if(a.getPDFPage().getIndex()!==o.page.getIndex()||!o.page.annotIdMap[a.id])return;l(a,"normal")}a=o.page.annotIdMap[i.id],r.emit(de.mouseEnter,hi.annotation,{annots:[a],e:t});var c=e.getEngineAnnot(i),d=e.getAnnotRect(c);if(e.$ui.find(".curAnnot").data("annot",i.id).css(d).show(),!j.isTouchDevice&&i.type==Hi.redact&&!i.isDeleted)return l(o.page.annotIdMap[i.id],"rollover");if("3d"==i.type){var h=e.getAnnotRender(i.id);if(!h)return;h.component.isActive3D&&e.$ui.find(".curAnnot").hide()}}))}))}},j.isTouchDevice||o.$ui.on("mousemove",this.moveHandler);var d,h=this;this.tapPage=(d=(0,_._)((function(e){var t,n,i;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return h.hotAnnot=0,j.isTouchDevice?(t="hand"==h.pdfViewer.getStateHandlerManager().currentStateHandler.getStateName())&&!c()?[2,!1]:[4,u(e)]:[2,!1];case 1:if(!(n=o.sent()))return[2,!1];if(!(i=h.getAnnotRender(n.id)))return[2,!1];if(t&&-1!==["screen","link","image","sound"].indexOf(n.type))["screen","sound"].indexOf(n.type)>-1?i.component.play():["link","image"].indexOf(n.type)>-1&&i.component.doAction();else{if("3d"===n.type)return[2,!0];h.activeAnnot(n.id)}return i&&r.emit(de.tapAnnotation,i),[2,!0]}}))})),function(e){return d.apply(this,arguments)});var f=this;this.doubleTapPage=function(){var e=(0,_._)((function(e){var t;return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return j.isTouchDevice?[4,u(e)]:[2,!1];case 1:return(t=n.sent())?(f.doubleTapAnnot(t.id,e),[2,!0]):[2,!1]}}))}));return function(t){return e.apply(this,arguments)}}();var g=this;this.pressPage=function(){var e=(0,_._)((function(e){var t;return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return j.isTouchDevice?[4,u(e)]:[2];case 1:return(t=n.sent())?(r.emit(de.pressAnnotation,g.getAnnotRender(t.id),e),w(e,1),e.preventDefault(),e.stopPropagation(),[2,!0]):[2,!1]}}))}));return function(t){return e.apply(this,arguments)}}(),this.panStart=function(t){e.moveHandler(t),e.hotAnnot&&-1==["screen","link","image","watermark"].indexOf(e.hotAnnot.type)&&e.activeAnnot(e.hotAnnot.id,t)};var v=this.$ui.find(".curAnnot").get(0),p=new Hammer.Manager(v);p.add(new Hammer.Tap({event:"doubletap",taps:2})),p.add(new Hammer.Tap({event:"singletap"})),p.add(new Hammer.Pan),p.get("doubletap").recognizeWith("singletap"),p.get("singletap").requireFailure("doubletap"),p.add(new Hammer.Press);var m=Promise.resolve();if(p.on("panstart",(function(t){m.then((function(n){if(e.hotAnnot&&-1==["screen","link","image","watermark"].indexOf(e.hotAnnot.type)){e.getAnnotRender(e.hotAnnot.id);e.activeAnnot(e.hotAnnot.id,t.srcEvent,!0)}}))})),p.on("hammer.input",(function(t){if("pointerdown"==t.srcEvent.type)return Xi=1,void(0||(m=function(t){return j.isTouchDevice&&e.moveHandler(t),u(t).then((function(i){if(e.hotAnnot){var r=e.getAnnotRender(e.hotAnnot.id),a=n.stateHandlerManager.currentStateHandler.getStateName();if("hand"===a&&-1!==["screen","link","image","3d"].indexOf(e.hotAnnot.type)||setTimeout((function(){e.hotAnnot&&e.activeAnnot(e.hotAnnot.id)}),200),"hand"===a)if("link"===e.hotAnnot.type){var s=r.annot.getBorderWidth(),u=e.$ui.find(".linkHighlightMode").show(),c=o.page.getDeviceRect(e.hotAnnot.rect,o.scale,o.rotate);switch(c.width=c.right-c.left,c.height=c.bottom-c.top,delete c.right,delete c.bottom,r.annot.info.highlightingMode){case Ee.NONE:u.hide();break;case Ee.OUTLINE:return c.width<2*s&&(c.left-=(2*s-c.width)/2),c.height<2*s&&(c.top-=(2*s-c.height)/2),void u.css(Object.assign({"border-width":s,borderColor:"black",borderStyle:"solid",backgroundColor:"none"},c)).show();case Ee.INVERT:return void u.css(Object.assign({"background-color":"white","mix-blend-mode":"difference"},c)).show();case Ee.PUSH:return c.width<2*s&&(c.left-=(2*s-c.width)/2),c.height<2*s&&(c.top-=(2*s-c.height)/2),void u.css(Object.assign({border:"".concat(s,"px solid"),"border-color":"black #aaa #aaa black"},c)).show();case Ee.TOGGLE:return}}else if("3d"===e.hotAnnot.type){var l=e.getAnnotRender(e.hotAnnot.id);if(!l)return;e.$ui.find(".curAnnot").hide(),l.component.active3DHandle(t)}}}))}(t.srcEvent)));if("pointerup"==t.srcEvent.type){Xi=0;var i="hand"==e.pdfViewer.getStateHandlerManager().currentStateHandler.getStateName();e.hotAnnot&&i&&-1!==["screen","link","image","sound"].indexOf(e.hotAnnot.type)&&(-1===["screen","sound"].indexOf(e.hotAnnot.type)&&t.srcEvent.target===v&&e.getAnnotRender(e.hotAnnot.id).component.doAction(),e.$ui.find(".linkHighlightMode").css({border:"none",background:"none","mix-blend-mode":"initial"}).hide())}})),p.on("singletap",(function(t){var n="hand"==e.pdfViewer.getStateHandlerManager().currentStateHandler.getStateName();if(e.hotAnnot){var i=e.getAnnotRender(e.hotAnnot.id);n&&-1!==["screen","link","image","sound"].indexOf(e.hotAnnot.type)&&["screen","sound"].indexOf(e.hotAnnot.type)>-1&&i.component.play(),r.emit(de.tapAnnotation,i)}})),j.isTouchDevice&&(j.isSafari||j.isChrome)){var y="pointerdown";(j.isIOS&&j.isChrome||void 0===window.PointerEvent)&&(y="mousedown");var k=function(t){var n=e._findAnnotRender(t.target);n&&!e._isFormWidget(n)&&t.stopPropagation()};v.addEventListener(y,k);var b=(0,j.onTap)({target:v,stopPropagation:!1,onDoubleTap:function(t){var n=e._findAnnotRender(t.target);if(n&&!e._isFormWidget(n)){var i=n.annot.getId();r.emit(de.doubleTapAnnotation,n,t),e.doubleTapAnnot(i,t),t.stopPropagation()}}});this.addDestroyHook(b,(function(){v.removeEventListener(y,k)}))}else p.on("doubletap",(function(t){var n=e._findAnnotRender(t.target);if(n&&!e._isFormWidget(n)&&-1===["link","screen"].indexOf(n.annot.getType())){var i=n.annot.getId();r.emit(de.doubleTapAnnotation,n,t),e.doubleTapAnnot(i,t)}}));p.on("press",(function(t){if(!(0,j.isEditable)(t.target)){var n=e.getAnnotRender(+O()(t.target).data("annot"));n&&!e._isFormWidget(n)&&r.emit(de.pressAnnotation,n,t)}}));var w=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t._findAnnotRender(e.target);if(n||i){if(n){var o=t.getAnnotAtPoint(e,!0);if(!o)return;i=t.getAnnotRender(o.id)}var a=i.annot.getType();if("select-annotation"==t.pdfViewer.getStateHandlerManager().currentStateHandler.getStateName()||-1===["link","screen","widget"].indexOf(a)||i.component.isActive||j.isTouchDevice){var s=i.annot.getId();r.emit(de.rightClickAnnotation,i,e),t.showContextMenu(s,e.clientX,e.clientY,e).then((function(t){!1!==t&&(e.stopPropagation(),e.preventDefault())}))}else e.preventDefault()}};this.addDestroyHook((function(){p.destroy(),o.$ui&&o.$ui.off("mousemove",e.moveHandler),e.$ui.find(".curAnnot").off("mouseleave",s)}),(0,j.attachContextMenuEvent)(this.$ui.get(0),w,{capture:!0}))}}},{key:"getEngineAnnot",value:function(e){return this.getAnnotRender(e.id).component.annot}},{key:"getAnnotRect",value:function(e){var t=this._parent,n=e.getDeviceRect(t.scale,t.rotate),i=n.right-n.left+4,r=n.bottom-n.top+4;return 8&e.getFlags()&&(i/=t.scale,r/=t.scale),{width:i,height:r,left:n.left-2,top:n.top-2}}},{key:"_isFormWidget",value:function(e){return"widget"===e.annot.getType()}},{key:"_isFormWatermark",value:function(e){return"watermark"===e.annot.getType()}},{key:"_findAnnotRender",value:function(e){var t=this;if(e==this.$ui.find(".curAnnot").get(0))return this.getAnnotRender(+O()(e).data("annot"));var n=function(){return Object.keys(t.annotRenders).map((function(e){return t.annotRenders[e]}))},i=e.closest(".fv__pdf-page-annot-handler-container");return i?n().filter((function(e){return e.component.$handler.get(0)===i}))[0]:e.closest(".fv__shape-control.callout")?n().filter((function(e){var t=e.component;return!(e.annot.getIntent()!==ke.FREETEXT_CALLOUT||!j.Lazy.isPropertyIntialized(t,"shapeControl"))&&t.shapeControl.annot.getId()===e.annot.getId()}))[0]:void 0}},{key:"updateSize",value:function(e,t){for(var n in this.annotRenders){var i=this.annotRenders[n].component;i.scale=e,i.rotate=t}if(0!=this.$ui.find(".annotRenderers").width()){var r=(0,E._)(this.renderParams||[e],1)[0],o=this.renderParams[2],a=e/r,s="matrix(".concat(a,",0,0,").concat(a,",").concat(o.left*(a-1),",").concat(o.top*(a-1),")");this.$ui.find(".fv__ui-annots").css("transform",s);var u=this.$ui.find(".fv__pdf-form-control-handler-container, .fv__pdf-page-3d-annot-handler-container"),c=!0,l=!1,d=void 0;try{for(var h,f=u[Symbol.iterator]();!(c=(h=f.next()).done);c=!0){var g=h.value,v=parseFloat(O()(g).css("left")),p=parseFloat(O()(g).css("top"));O()(g).css({transform:"matrix(".concat(a,",0,0,").concat(a,",").concat(v*(a-1),",").concat(p*(a-1),")")})}}catch(e){l=!0,d=e}finally{try{c||null==f.return||f.return()}finally{if(l)throw d}}this.scaleChanged=!0}}},{key:"renderWidget",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.widgetsDone=1,this.isDestroyed)return Promise.resolve();var r=this.renderSerialPromise;r&&r.end().catch(Ji);var o=this.pageRender.page.annots.filter((function(e){return!t.annotRenders[e.objectNumber]&&"widget"==e.getType()})).map((function(e){return t.annotRenders[e.objectNumber]=new re(O()("<div>"),O()("<div>"),e,t)}));this.$ui.append(o.reduce((function(e,t){return e.append(t.$ui,t.$handler),e}),O()(document.createDocumentFragment())));var a=o.map((function(r){return function(r){if(t.isDestroyed)return Promise.resolve();try{return r.render(e,n,i).then((function(e){return r.component.afterRender()}))}catch(e){return Promise.reject(e)}}(r)}));return r=this.renderSerialPromise=new ge(0),Promise.all(a)}},{key:"skipRender",value:function(e,t){return!!this.isDestroyed||(this._parent.pdfViewer.getScrollWrap().disabled||Math.abs(e-4*t/3)>1e-6)}},{key:"getBitmap",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"noHighlight",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{left:r.left/j.dpr,right:r.right/j.dpr,top:r.top/j.dpr,bottom:r.bottom/j.dpr};if(this.skipRender(4/3,1))return Promise.resolve([1]);var u=this._parent,c="noHighlight"==o,l=0;c&&"redact"==(null===(t=this.hotAnnot)||void 0===t?void 0:t.type)&&u.page.annots.find((function(e){return e.getId()===n.hotAnnot.id}))&&(l=this.hotAnnot.id);var d=u.docRender.hideMarkupFlag,h=["annot"];d&&h.push("hideMarkup"),c?h.push("noHighlight"):h.push("onlyHighlight");var f,g=this.pdfViewer.getAnnotManager().getAnnotFlag_;return this.pageRender&&this.pageRender.page||Promise.resolve([1]),f=this.pageRender.page.annots.map((function(e){var t=e.info.id;if(g&&e.getType()!==Hi.link&&n.isAnnotHidden(e))return t;if(n.annotFiltered){if(!n.showAnnots.has(t)&&e.isMarkup())return t}else if(d&&e.isMarkup())return t})),u.page.getPageBitmap(4*e/3*j.dpr,i,{x:r.left,y:r.top,width:r.right-r.left,height:r.bottom-r.top},h,"view","",{hideAnnots:f,hotAnnot:l,dpr:j.dpr}).then((function(t){var i=t.buffer,r=t.image,o=(t.progressiveId,t.x,t.y,t.width),u=t.height,l=t.scale;t.rate;if(n.skipRender(l,e*j.dpr))return[1];if(a)return t;n.$ui.find(c?".annotRenderers":".highlightAP");var d=O()("<canvas class='".concat(c?"annotRenderers":"highlightAP"," fv__ui-annots'></canvas>"))[0];O()(d).css({transform:"scale(1)",left:s.left,top:s.top,width:s.right-s.left,height:s.bottom-s.top});var h=d.getContext("2d");if(d.width=o,d.height=u,h.clearRect(0,0,d.width,d.height),r)return new Promise((function(t,n){try{var i=new Image;i.onload=function(){h.drawImage(i,0,0,o,u),URL.revokeObjectURL(i.src),t([0,e])},i.src=URL.createObjectURL(r)}catch(e){n(e)}}));var f=h.createImageData(o,u);return f.data.set(new(Uint8ClampedArray||Uint8Array)(i)),h.putImageData(f,0,0),n.skipRender(l,e*j.dpr)?[1]:[0,e,d]}))}},{key:"genScreenIcon",value:function(e,t){var n=e.scale,i=e.page.getDeviceRect(t.rect,n,e.rotate),r="fv__screen-decorator-".concat(t.id),o=this.$ui.find("."+r);o.length||(o=O()("<div class='fv__pdf-page-multi-media-annot-container screen-border ".concat(r,"' data-id='").concat(t.id,"'><div class='icon play'></div></div>")),this.$ui.append(o)),o.css({padding:(t.borderWidth||2)*j.dpr*n*4/3,left:i.left/e.getShowWidth()*100+"%",top:i.top/e.getShowHeight()*100+"%",width:(i.right-i.left)/e.getShowWidth()*100+"%",height:(i.bottom-i.top)/e.getShowHeight()*100+"%"});var a=this.pdfViewer.getPDFDocRender(),s=!1;this.pdfViewer.getAnnotManager().getAnnotFlag_&&this.isAnnotHidden(e.page.annotIdMap[t.id])&&(s=!0),a.noInteraction||s?o.hide():o.show()}},{key:"updateActiveRect",value:function(e,t,n,i){var r=e.annotsRender.getAnnotRender(t.name);if(r){var o=r.component;if(!(t.intent===ke.FREETEXT_CALLOUT)||!o.isActive){var a=r.$handler.find(n),s=e.scale,u=e.page.getDeviceRect("freetext"===i?t.innerRect:t.rect,s,e.rotate);if(!a)return u;var c="px";return a.css({left:u.left+c,top:u.top+c,width:u.right-u.left+c,height:u.bottom-u.top+c}),u}o.active()}}},{key:"updateLinePoint",value:function(e,t){var n=e.annotsRender.getAnnotRender(t.name);n&&"Line"===n.component.name&&n.component.updateHandlerPosition(!0)}},{key:"updateCanvas",value:function(e,t){var n=e.buffer,i=(e.image,e.progressiveId,e.x),r=e.y,o=e.width,a=e.height,s=(e.scale,e.rate,this.$ui.find(t));if(!s[0].width){var u=this.renderParams[2];s.attr({width:u.right-u.left,height:u.bottom-u.top})}var c=s[0].getContext("2d");if(0!==o&&0!==a){var l=c.createImageData(o,a);l.data.set(new(Uint8ClampedArray||Uint8Array)(n)),this.renderParams[2]&&(c.putImageData(l,i-this.renderParams[2].left*j.dpr,r-this.renderParams[2].top*j.dpr),j.isSafari&&(s.hide(),setTimeout((function(){s.show()}),0)))}}},{key:"updateRender",value:function(e){var t=this,n=this.pageRender.page.annots.some((function(e){return"highlight"==e.getType()}));[[".annotRenderers",".annotRenderers"],[".highlightAP",".highlightAP"]].map((function(e){var i=(0,E._)(e,2),r=i[0],o=i[1];if((".highlightAP"!=r||n)&&0==t.$ui.find(r)[0].width){var a=t.renderParams[2];t.$ui.find(o).css({transform:"none",left:a.left,top:a.top,width:a.right-a.left,height:a.bottom-a.top}).attr({width:(a.right-a.left)*j.dpr,height:(a.bottom-a.top)*j.dpr})}}));var i=this.pageRender,r=(i.scale,j.dpr,e);r.left-=3,r.top-=3,r.right+=3,r.bottom+=3,r.left<0&&(r.left=0),r.top<0&&(r.top=0);var o=i.getCurrentVisibleRect();r.left=Math.min(r.left,o.left*j.dpr),r.top=Math.min(r.top,o.top*j.dpr),r.right=Math.max(r.right,o.right*j.dpr),r.bottom=Math.max(r.bottom,o.bottom*j.dpr);var a=[this.getBitmap(i.scale,i.rotate,r,"noHighlight",1)];return e.hasHighlight&&a.push(this.getBitmap(i.scale,i.rotate,r,"onlyHigh",1)),Promise.all(a).then((function(e){var n=(0,E._)(e,2),i=n[0],r=n[1];return!(1==i[0]||r&&1==r[0])&&(t.updateCanvas(i,".annotRenderers"),r&&t.updateCanvas(r,".highlightAP"),!0)}))}},{key:"render",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.skipRender(4/3,1))return[1];if(this.pageRender.isDestroyed)return[1];var r=this.pageRender,o=r.page,a=r.docRender.hideMarkupFlag,s=r.docRender.forceLoadAnnot,u=this.pdfViewer.getAnnotManager().getAnnotFlag_;return(a||s||u?o.getAnnots().then((function(e){return e&&e.map((function(e){return e.info}))})):o.getAnnotRects()).then((function(e){if(!o.isDestroyed)return o.doc.hasFixedPageFields(o.getIndex()).then((function(e){if(e&&!o.hasFixedPageFields)return o.hasFixedPageFields=!0,o.doc.reloadPDFForm()})).then((function(t){return e}))})).then((function(o){if(o){if(t.renderParams=[e,n,i],!o.length)return t.$ui.find(".annotRenderers,.highlightAP").css({left:i.left,top:i.top,transform:"scale(1)",width:i.right-i.left,height:i.bottom-i.top}).attr({width:0,height:0}),void(t.widgetsDone=1);var a={left:i.left*j.dpr,right:i.right*j.dpr,top:i.top*j.dpr,bottom:i.bottom*j.dpr};return Promise.all([t.getBitmap(e,n,a,"noHighlight"),o.some((function(e){return"highlight"==e.type}))?t.getBitmap(e,n,a,"onlyHigh"):Promise.resolve([0])]).then((function(e){var n=(0,E._)(e,2),i=n[0],r=n[1];if(i[0]||r[0])return[1];var o=t.$ui.find(".annotRenderers"),a=t.$ui.find(".highlightAP");return o.replaceWith(i[2]),r.length>1?a.replaceWith(r[2]):a.attr({width:0,height:0}),t.$ownUI=t.$ui.find(".fv__ui-annots,.linkHighlightMode,.curAnnot"),[0,i[1]]})).then((function(a){var s=(0,E._)(a,2),u=s[0],c=s[1];if(!u){if(t.pdfViewer.eventEmitter.emit("renderAnnotSuccess",t.pageRender),t.scaleChanged)t.$ui.find(".fv__pdf-page-annot-handler-container").each((function(e,t){t.style.transform=null})),t.scaleChanged=!1;for(var l in o.forEach((function(e){"screen"==e.type&&e.isAudioVideo&&(t.genScreenIcon(r,e),t.updateActiveRect(r,e,".fv__pdf-player"))})),t.annotRenders){var d=t.annotRenders[l],h=d.component;if(h&&h.annot){var f=h.annot.getType();"widget"===f?d.render(c,n):"3d"===f&&h.isActive3D&&h.render3D(c,n);var g=d.scale,v=d.rotate;h.scale=c,h.rotate=n,d.scale=c,d.rotate=n;var p=g!==c||v!==n;d.component.isActive&&p&&d.component.active()}}if(!t.widgetsDone){if(!r||!r.page)return;if(r.page.annots.length)return t.renderWidget(e,n,i);var m;t.disposor.addDestroyHook((function(){clearTimeout(m)}));m=setTimeout((function(){t.isDestroyed||r&&r.page&&r.page.getAnnots()}),0)}}}))}}))}},{key:"adjustHighlightsRender",value:function(){return Promise.resolve()}},{key:"adjustHighlightAnnots",value:function(){var e=[];for(var t in this.annotRenders){var n=this.annotRenders[t];"highlight"===n.annot.getType()&&e.push(n.redraw())}return Promise.all(e)}},{key:"destroy",value:function(){for(var e in this.annotRenders){var t=this.annotRenders[e];t&&t.destroy()}(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.invisibleRender(),this.pageRender=null,this.annotRenders=null,this.rerenderAnnotDebounceTaskExecutor.cancel(),this.rerenderAnnotThrottleTaskExecutor.cancel(),this.rerenderAfterFilterTaskExecutor.cancel()}},{key:"clickNoteAt",value:function(e){var t=this.annotRenders[e];t&&t.focus()}},{key:"unActiveAnnot",value:function(e){var t=this,n=this.pdfViewer.getAllActiveElements();if(!n.length)return Promise.resolve();this.pdfViewer.eventEmitter;return e||this.pdfViewer.clearMultiSelectActiveFlag(),Promise.resolve(this.unActiveAnnotBefore()).then((function(i){if(!1!==i&&null!=t.pageRender){var r=n.filter((function(e){return e.annot}));(0,D._)(e,ln)?r=r.filter((function(t){return t.annot===e})):"number"==typeof e&&(r=r.filter((function(t){return t.annot.objectNumber===e}))),r.forEach((function(e){t.pdfViewer.deactivateElement(e),t.unActiveAnnotAfter(e)}))}}))}},{key:"_unActiveAnnot",value:function(e){e.unActive()}},{key:"_forEachRenderer",value:function(e){for(var t in this.annotRenders)e.call(this,this.annotRenders[t],t,this.annotRenders)}},{key:"activeAnnot",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getAnnotRender(e);if(!r)return Promise.resolve();var o=this.pdfViewer;if(o.activationManager.currentActivableIs(r.component)&&!j.keyboardStatus.isShiftDown&&!i)return Promise.resolve(r);var a=o.eventEmitter,s=this.pdfViewer.customs;return Promise.resolve((s.activeAnnotBefore||Ji)(r,e,this)).then((function(i){if(a.emit(de.activeAnnotationBefore,r,e,n),!1===i)return r;if(r.annot.isGrouped&&r.annot.isGrouped()){var o=[];return r.getGroupRenders().map((function(e){"popup"!==e.annot.getType()&&o.push(e.active())})),Promise.all(o).then((function(){return a.emit(de.activeAnnotation,r,e,n),Promise.resolve((s.activeAnnotationAfter||Ji)(r,e,n))})).then((function(){return a.emit(de.activeAnnotationAfter,r,e,n),r}))}return r.active(t).then((function(){return a.emit(de.activeAnnotation,r,e,n),Promise.resolve((s.activeAnnotationAfter||Ji)(r,e,n))})).then((function(){return a.emit(de.activeAnnotationAfter,r,e,n),t&&r.component.triggerPointerDownOnShapeControl(t),r}))}))}},{key:"_activeAnnot",value:function(e,t){var n=this.annotRenders[e];return n?n.active():Promise.resolve()}},{key:"splitAnnotIndexArr",value:function(e,t,n){for(var i=[],r=[],o=e+1,a=e-1,s=-1,u=0,c=t.length;u<c;u++){var l=t[u],d=l.length;if(1===d&&l[0]===e)return!1;for(var h=0,f=d;h<f;h++){var g=l[h];if((0,D._)(g,Array)){var v=g[0],p=g[1];if(e===v){s=u,i=l.slice(0,h),r=(r=p>o?[[o,p]]:[p]).concat(l.slice(h+1));break}if(e===p){s=u,i=l.slice(0,h),v<a?i.push([v,a]):i.push(v),r=l.slice(h+1);break}if(e>v&&e<p){s=u,i=l.slice(0,h),a===v?i.push(v):i.push([v,a]),r=(r=o===p?[p]:[[o,p]]).concat(l.slice(h+1));break}}else if(g===e){s=u,i=l.slice(0,h),r=l.slice(h+1);break}}if(-1!==s)break}if(-1===s)return!1;var m=JSON.stringify(t[s]),y=n[m],k=[s,1];return i.length&&k.push(i),k.push([e]),r.length&&k.push(r),t.splice.apply(t,k),{removeTileCanvas:y,beforeIndexArr:i,splitIndexArr:[e],afterIndexArr:r,tileCanvasMap:n,splitKey:m}}},{key:"splitTileCanvas",value:function(e,t,n,i,r,o,a,s,u,c){var l=e.beforeIndexArr,d=e.splitIndexArr,h=e.afterIndexArr,f=e.removeTileCanvas,g=e.tileCanvasMap,v=e.splitKey,p=O()(document.createDocumentFragment()),m=[];return l.length&&m.push(this.rangeAnnotTileCanvasRedraw(t,n,l,g,p,i,r,o,a,s,u,c)),m.push(this.renderSplitAnnots(d,t,n,p,i,u,c)),h.length&&m.push(this.rangeAnnotTileCanvasRedraw(t,n,h,g,p,i,r,o,a,s,u,c)),Promise.all(m).then((function(){f.$container.before(p),f.destroy(),delete g[v]}))}},{key:"createAnnotRender",value:function(e){if(this.annotRenders[e.id||e.getId()])return this.annotRenders[e.id||e.getId()];var t=O()("<div/>"),n=O()("<div/>");this.$ui.append(n);var i=new re(t,n,e,this);return this.annotRenders[e.getId()]=i,i.component.rotate=this._parent.rotate,i.component.scale=this._parent.scale,i}},{key:"getAnnotRender",value:function(e){if(void 0!==e){var t=this._parent;if(!t)return null;var n=t.page;if("number"==typeof e){var i=this.annotRenders[e];if(i)return i;var r=n.getAnnotsSync([e])[0];return r?this.createAnnotRender(r):null}if(e.trim().length<1)return null;var o=n.annots.find((function(t){return t.getName()===e}));return o?this.createAnnotRender(o):null}}},{key:"getAnnotRenderSafely",value:function(e){var t=this.pageRender.page.annots.find((function(t){return t.id===e}));return t?this.createAnnotRender(t):null}},{key:"removeAnnotRender",value:function(e){var t=e.annot.getId();delete this.annotRenders[t]}},{key:"showContextMenu",value:function(e,t,n,i){return this.activeAnnot(e,i).then((function(e){return e&&e.showContextMenu(t,n)}))}},{key:"doubleTapAnnot",value:function(e,t){return this.activeAnnot(e,t).then((function(e){return e&&e.doubleTapAnnot()}))}},{key:"getOrCreateAnnotRender",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$ui[0],n=e.getId();if(this.annotRenders[n])return this.annotRenders[n];var i=O()("<div></div>"),r=O()("<div></div>");return t.appendChild(i[0]),t.appendChild(r[0]),this.annotRenders[n]=new re(i,r,e,this)}},{key:"addAnnots",value:function(e){var t=this,n=O()(document.createDocumentFragment());this.annots.reduce((function(e,i){var r=i.getId();return e[r]||(e[r]=t.getOrCreateAnnotRender(i,n[0])),e}),this.annotRenders),this.$ui.append(n);for(var i=!1,r=0,o=e.length;r<o;r++){if("highlight"===e[r].getType()){i=!0;break}}i&&this.parent("pdfPageRender").redrawContent(!0)}},{key:"getAnnotRenders",value:function(){return this.annotRenders}},{key:"removeAnnotRenders",value:function(e){var t=this,n=(this.annotRenders,e.map((function(e){var n=e.getId(),i=t.getAnnotRender(n);return i&&i.remove(!0)})));return Promise.all(n)}},{key:"redrawAnnotRenders",value:function(e){}},{key:"movedAnnotRenders",value:function(e,t){for(var n=e.length;n--;){var i=e[n].getId(),r=this.getAnnotRender(i);r&&r.moved(t)}}},{key:"addAnnotRenders",value:function(e){}},{key:"updateAnnotRendersId",value:function(e,t){e in this.annotRenders&&(this.annotRenders[t]=this.annotRenders[e],delete this.annotRenders[e])}},{key:"endRender",value:function(){var e=this.renderSerialPromise;e&&e.end().catch(Ji)}},{key:"invisibleRender",value:function(){this.endRender();var e=this.annotRenders;for(var t in e)e[t].invisibleRender()}},{key:"showDownIcon",value:function(e){}},{key:"startFilterAnnot",value:function(){this.annotFiltered=1,this.showAnnots=new Set}},{key:"addShowAnnot",value:function(e){this.showAnnots.add(e)}},{key:"endFilterAnnot",value:function(){var e=this;this.annotFiltered&&this.rerenderAfterFilterTaskExecutor.exec((function(){if(!e.isDestroyed)return e.render.apply(e,(0,I._)(e.renderParams))}))}},{key:"_updatePageMeasureScaleRatio",value:function(e,t){var n=this;if(0!==t.length){var i=function(e,t){var n=t.x-e.x,i=t.y-e.y,r=Math.abs(n),o=Math.abs(i);return Math.sqrt(r*r+o*o)};t.forEach((function(t){var r=t.getPDFPage().getIndex();e.getIndex()===r&&e.getMeasureScaleRatio().then((function(r){var o=r.ratioMap,a=r.unitName,s=r.scale;e.getViewportRect().then((function(e){var r=t.getType(),u=!0;switch(r){case"circle":var c=t.getRect();u=gi({x:c.left,y:c.top},e);case"line":u=gi(t.getStartPoint(),e);break;case"polyline":case"polygon":var l=G(t.getVertexes()).slice(0);if(l.length<1)return;u=gi({x:l[0].x,y:l[0].y},e)}var d,h,f,g=n.pdfViewer.getIoC().getInstanceByClass(Gi).getMeasurementInfo();if(s&&u)g=o.length?{userSpaceScaleValue:d=o[0].value,userSpaceUnit:h=Oi(o[0].unit),realScaleValue:f=o[1].value,realUnit:Oi(o[1].unit)}:null;else{if(!g)return;s=1,d=g.userSpaceScaleValue,h=g.userSpaceUnit,f=g.realScaleValue,g.realUnit}var v=t.getContent(),p=v.indexOf("\n");p>=0&&(p+=1);var m=v.substr(0,p),y=0;switch(r){case"circle":var k=Ui.caculateCircleArea(t.getRect(),g);return void t.setContent("".concat(m).concat(parseFloat(k*Math.pow(s,2)).toFixed(2)," sq ").concat(a));case"line":var b=t.getStartPoint(),w=t.getEndPoint();y=i(b,w);break;case"polyline":for(var _=t.getVertexes(),P=_[0],A=1;A<_.length;A++)y+=i(P,_[A]),P=_[A];break;case"polygon":var S=t.getVertexes(),x=Ui.caculatePolygonArea(S,g);return void t.setContent("".concat(m).concat(parseFloat(x*Math.pow(s,2)).toFixed(2)," sq ").concat(a))}var C=y;g?C=Ai.convertTo(y*s,h)*(f/d):C=y*s;t.setContent("".concat(m).concat(parseFloat(C).toFixed(2)," ").concat(a))}))}))}))}}}]),n}(te);const ir=nr;function rr(){if("undefined"!=typeof window){if(window.crypto)return e=new Uint32Array(1),window.crypto.getRandomValues(e),e[0]/4294967296;if(window.msCrypto)return function(){var e=new Uint32Array(1);return window.msCrypto.getRandomValues(e),e[0]/4294967296}()}var e;return ce("random",Math)()}var or=function(){},ar=(0,j.createDOM)("canvas",{width:"0",class:"fv__tiles-canvas"}),sr=((0,j.createDOM)("div",{class:"fv__tiles-col"},[ar.cloneNode()]),(0,j.createDOM)("div",{class:"fv__tiles-row"}),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!e||e.right-e.left<=t||e.bottom-e.top<=t}),ur=function(e,t){return e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom},cr=function(e,t,n){if(!n&&e.left==t.left&&e.right==t.right&&e.top==t.top&&e.bottom==t.bottom)return[];var i={left:Math.max(e.left,t.left),bottom:Math.min(e.bottom,t.bottom),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top)};if(i.left<i.right&&i.top<i.bottom){if(n)return i;if(ur(t,e))return[];var r,o;i.left==t.left?(r={left:i.right,right:t.right,top:t.top,bottom:t.bottom},o=i.top==t.top?{left:i.left,right:i.right,top:i.bottom,bottom:t.bottom}:{left:i.left,right:i.right,top:t.top,bottom:e.top}):i.right==t.right&&(o={left:t.left,right:i.left,top:t.top,bottom:t.bottom},r=i.top==t.top?{left:i.left,right:i.right,top:i.bottom,bottom:t.bottom}:{left:i.left,right:i.right,top:t.top,bottom:i.top});var a=[];return sr(o,0)||a.push(o),sr(r,0)||a.push(r),0!=a.length||sr(t)?a:[t]}return n?null:sr(t)?[]:[t]},lr=function(e,t){var n=e.left>t.left?e.left:t.left,i=e.right<t.right?e.right:t.right,r=e.bottom<t.bottom?e.bottom:t.bottom,o=e.top>t.top?e.top:t.top;if(!(n>=i||r<=o))return{left:n,right:i,bottom:r,top:o}},dr=function(e,t){return e.left<=t.left&&e.right>=t.right&&e.bottom>=t.bottom&&e.top<=t.top},hr=function(){function e(t,n,i){var r=this,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];(0,P._)(this,e),this.isDestroyed=!1,this.enableCache=o,this.cache={},this.getImageData=t,i&&(this.pageRender=i,this.api=i.page.api),this.tileTasks={},this.timer={};var a="fv__tiles-container";n=n?n.addClass(a):O()((0,j.createDOM)("div",{class:a})),this.setDom(n),this.updateCanvasMore=or,this.updateCanvasContainer=or,this.defer={},Object.defineProperties(this,{$canvases:{get:function(){return r.$container.find(".fv__tiles-canvas")}},rows:{get:function(){return r.$container.find(".fv__tiles-row").length}},$cols:{get:function(){return r.$container.find(".fv__tiles-col")}},cols:{get:function(){return r.$container.find(".fv__tiles-row").eq(0).find(".fv__tiles-col").length}}})}return(0,A._)(e,[{key:"setDom",value:function(e){this.$container=e}},{key:"redraw",value:function(e,t,n,i,r,o,a,s){var u,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=this.getCurrentCanvas();if(d&&!d.isInvalid&&(u=this.getRenderedRect(d))){var h=this.getVisibleRealRect();if(h&&u.left<=h.left&&u.right>=h.right&&u.top<=h.top&&u.bottom>=h.bottom&&this.scale==a&&this.rotate===s&&this.showWidth===n&&this.showHeight===i)return Promise.resolve()}this.showWidth=n,this.showHeight=i;var f=[e,t,n,i,r,o,a,s,c,l];this.lastRedrawParams=f;var g=this.$container,v={left:c*a+"px",top:l*a+"px"};if(g.css(v),g.css(v),this.getRectBitmap){var p=!!this.scale&&this.scale!=a;return this.scale=a,this.rotate=s,this.renderVisibleRect(o,a,p)}return this.scale=a,this.rotate=s,this.updateDom(e,t,n,i,r,o,a,s,c,l),this.updateRenderCanvasSerial(e,t,n,i,r,o,a,s,c,l)}},{key:"isRenderingDone",value:function(e,t){return e===this.scale&&t===this.$container.width()}},{key:"updateDom",value:function(e,t,n,i,r,o,a,s){var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:this.$container;if(0!=n){var d={left:u*a+"px",top:c*a+"px"};this.updateCanvasContainer=function(){l.css(d)},l.css(d);var h=n/j.dpr,f=i/j.dpr,g=O()((0,j.createDOM)("canvas",{id:"pdfcanvas",style:"width:".concat(h,"px;height:").concat(f,"px;")})),v=g[0];if(v.width=n,v.height=i,this.$container){var p=this.$container.find("#pdfcanvas");if(g.css("display",p.css("display")),this.$container.append(v),p&&p.length>0){var m=p[0];m.width=m.height=0,m.remove()}this.$container.show()}this.pageRender||this.lastRedrawParams||(this.lastRedrawParams=[e,t,n,i,r,o,a,s,u,c])}}},{key:"updateRenderCanvasSerial",value:function(e,t,n,i,r,o,a,s){var u=this,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,d=this.renderContentImageSerial;if(d&&d.end().catch((function(){})),0==n)return this.updateCanvasContainer(),Promise.resolve();d=this.renderContentImageSerial=new ge;var h=[],f=r*a/o,g=r,v=parseInt(n%r+.5);v=v||1;var p=parseInt(i%r+.5);p=p||1;for(var m=c*a,y=l*a,k=this.visibleRect,b=0,w=e;b<w;b++)for(var _=0,P=t;_<P;_++){if(k){var A=k.left-20,S=k.right+20,x=k.top-20,C=k.bottom+20,D=m+_*f,E=y+b*f;if(!(D+f>A&&D<S&&E+f>x&&E<C)){this.$canvases[t*b+_].width=0;continue}}var I=g,R=g;b===e-1&&(R=p),_===t-1&&(I=v),h.push(function(e,t,n,i,r,o){return function(){return u.isDestroyed?Promise.resolve():u.updateCanvas(e,t,n,i,r,o,a,s,c,l)}}(b,_,I,R,r,o))}return d.serial(h)}},{key:"updateCanvas",value:function(e,t,n,i,r,o,a,s,u,c){return this.renderImageData(e,t,n,i,r,o,a,s,u,c)}},{key:"renderImageData",value:function(e,t,n,i,r,o,a,s,u,c){var l=this;if(this.isDestroyed)return Promise.resolve();var d=[e,t,n,i,r,o,u,c,s].join("-"),h=this.cache,f=([d,"canvas"].join("-"),[d,"imageData"].join("-")),g=[d,"imageUrl"].join("-"),v=h[f];return(v?Promise.resolve(v):this.getImageData(e,t,n,i,r,o,u,c,s)).then((function(n){if(!n)return[];var i=n.width,s=n.height,d=n.buffer,v=n.image,p=n.type,m=n.url;h[f]={width:i,height:s,buffer:d,image:v,type:p,url:m};var y=l.getCurrentCanvas(),k=o/a,b=l.lastRedrawParams[2],w=l.lastRedrawParams[3],_=y.getContext("2d");if(0==i||0==s)return y.width=0,[_,e,t,i,s,r,o,u,c];if(Math.abs(y.width-b)>1&&(y.width=b,y.height=w,O()(y).css({width:l.showWidth/k,height:l.showHeight/k})),m)return new Promise((function(n,a){var d=h[g];if(d)return l.updateCanvasContainer(),_.drawImage(d,e*r,t*r),n([_,e,t,i,s,r,o,u,c]);var f=new Image;f.onload=function(){h[g]=f,l.updateCanvasContainer(),_.drawImage(f,e*r,t*r),n([_,e,t,i,s,r,o,u,c])},f.src=m}));if(v)return new Promise((function(n,a){var d=h[g];if(d)return l.updateCanvasContainer(),_.drawImage(d,0,0),n([_,e,t,i,s,r,o,u,c]);try{var f=new Image;f.onload=function(){h[g]=f,l.updateCanvasContainer(),_.drawImage(f,0,0),n([_,e,t,i,s,r,o,u,c])},f.src=URL.createObjectURL(v)}catch(e){console.log(e)}}));var P=new(Uint8ClampedArray||Uint8Array)(d),A=_.createImageData(i,s);return A.data.set(P),l.updateCanvasContainer(),l.$container.css({width:l.showWidth/k,height:l.showHeight/k}),_.putImageData(A,t*r,e*r),[y,_,e,t,i,s,r,o,u,c]})).then((function(e){var t=(0,E._)(e,7),n=(t[0],t[1]),i=t[2],r=t[3],o=t[4],a=t[5],s=t[6];l.updateCanvasMore(n,i,r,o,a,s,i,r)}))}},{key:"hideContainer",value:function(){this.$container.hide(),this.invisibleRender()}},{key:"showContainer",value:function(){var e=this.$container;if(!e.is(":visible")){e.show();var t=this.lastRedrawParams;t&&this.redraw.apply(this,t)}}},{key:"setUpdateCanvasMore",value:function(e){this.updateCanvasMore=e}},{key:"setRenderViewWatermark",value:function(e){this.isRenderViewWatermark=e}},{key:"destroy",value:function(){this.offRender&&this.offRender(),this.isDestroyed=!0,delete this.getImageData,this.updateCanvasMore=or,this.updateCanvasContainer=or,this.$canvases.each((function(e,t){t.width=0}));var e=this.getCurrentCanvas();e&&(e.width=0,e.parentNode.removeChild(e)),this.$container.remove(),delete this.$container,this.clearCache()}},{key:"setVisibleRect",value:function(e){this.visibleRect=e}},{key:"clearCache",value:function(){var e=this.cache;for(var t in e)delete e[t];this.cache={};var n=this.getCurrentCanvas();n&&(n.isInvalid=!0),this.clearProgressiveTask()}},{key:"clearProgressiveTask",value:function(){if(this.getRectBitmap){for(var e in this.timer)clearTimeout(this.timer[e]);this.timer={};var t=[];for(var n in this.tileTasks)t.push(this.api.cancleProgress(n));return this.tileTasks={},this.offRender=null,Promise.all(t)}}},{key:"cancelInvisibleProgressiveTask",value:function(e){for(var t in this.tileTasks){var n=this.tileTasks[t];lr(n,e)||(this.timer[t]&&(clearTimeout(this.timer[t]),delete this.timer[t]),this.api.cancleProgress(t),delete this.tileTasks[t])}}},{key:"invisibleRender",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.enableCache||!this.getRectBitmap||e){this.$canvases.each((function(e,t){t.width=0}));var t=this.getCurrentCanvas();t&&(t.width=0,t.parentNode.removeChild(t)),this.clearCache()}}},{key:"invisibleCanvas",value:function(){}},{key:"getRenderedRect",value:function(e){if(e)return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}},{key:"recurToReduceRect",value:function(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i],o=cr(r,t);if(o.length){for(var a=0;a<o.length;a++)if(i==e.length-1)n.push(o[a]);else{var s,u=e.slice(i+1),c=this.recurToReduceRect(u,o[a]);(s=n).push.apply(s,(0,I._)(c))}break}if(dr(r,t))return[]}return n}},{key:"pushToRenderRectsQueue",value:function(e){var t=[];for(var n in this.tileTasks){var i=this.tileTasks[n];t.push(i)}if(0==t.length)return e;var r=[],o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r=r.concat(this.recurToReduceRect(t,l))}}catch(e){a=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return r}},{key:"getCurrentCanvas",value:function(){if(!this.$container)return null;var e=this.$container.find("#pdfcanvas");return e&&e.length?e[0]:null}},{key:"renderVisibleRect",value:function(e,t,n){var i=this;if(0===t)return Promise.resolve();this.isZoom=n;var r,o=this.visibleRect.right-this.visibleRect.left,a=this.visibleRect.bottom-this.visibleRect.top,s=this.getVisibleRealRect(),u=this.getCurrentCanvas();if(u&&u.left==s.left&&u.top==s.top&&u.right==s.right&&u.bottom==s.bottom)r=u,u.isInvalid=!1;else{var c=O()((0,j.createDOM)("canvas",{id:"pdfcanvas",style:"width:".concat(o,"px;height:").concat(a,"px;left:").concat(this.visibleRect.left,"px;top:").concat(this.visibleRect.top,"px; position:relative;")}));(r=c[0]).left=s.left,r.top=s.top,r.right=s.right,r.bottom=s.bottom,r.width=s.right-s.left,r.height=s.bottom-s.top}if(this.isZoom?this.clearProgressiveTask():this.cancelInvisibleProgressiveTask(s),!this.pageRender.pdfViewer.getScrollWrap().disabled){var l=r.getContext("2d"),d=[s];if(!this.isZoom&&u&&r!=u&&!u.isInvalid){var h=this.getRenderedRect(u);if(h){var f=lr(h,s);if(f&&u){var g=h,v=f.right-f.left,p=f.bottom-f.top,m={left:f.left-g.left,top:f.top-g.top,width:v,height:p},y={left:f.left-s.left,top:f.top-s.top,width:v,height:p};l.drawImage(u,m.left,m.top,v,p,y.left,y.top,v,p)}d=cr(h,s)}}var k=function(e){var t=i.getCurrentCanvas();t!=r&&(i.$container.append(r),i.$container.show(),t&&(t.width=t.height=0,t.remove(),t=null))};if(this.isZoom||k(),(d=this.pushToRenderRectsQueue(d)).length){var b=[];return d.forEach((function(t){var n={x:t.left,y:t.top,width:t.right-t.left,height:t.bottom-t.top};if(0!=n.width&&0!=n.height){var o=""+Date.now()+rr();i.tileTasks[o]=t;var a=i.getRectBitmap(n,e,o,i.rotate).then((function(e){if(e){var t=i.isZoom?r:i.getCurrentCanvas(),a=i.displayImage(e,n,t),s=function(e){if(i.api){var t=i.api.continueProgress(o).then((function(e){var t=i.isZoom?r:i.getCurrentCanvas();i.displayImage(e,n,t)}));t.then((function(e){i.tileTasks[o]&&(i.timer[o]&&(clearTimeout(i.timer[o]),delete i.timer[o]),i.timer[o]=setTimeout(s.bind(i),10))}))}};return 100!=e.rate&&s(),a}}));b.push(a)}})),Promise.all(b).then((function(e){i.isZoom&&(e.every((function(e){return 1==e}))&&k())}))}}}},{key:"displayImage",value:function(e,t,n){var i=this,r=e.buffer,o=e.isFirst,a=e.image,s=e.progressiveId,u=e.x,c=e.y,l=e.width,d=e.height,h=e.isVirtual,f=(0,E._)(this.lastRedrawParams,10),g=(f[0],f[1],f[2],f[3],f[4],f[5]),v=(f[6],f[7],f[8],f[9],4*g/3),p=e.scale||v,m=function(){i.tileTasks[s]&&(i.api.cancleProgress(s),delete i.tileTasks[s]),i.timer[s]&&(clearTimeout(i.timer[s]),delete i.timer[s])},y=this.pageRender.pdfViewer.getScrollWrap();if(e.isEmpty||this.isDestroyed||!h&&!this.tileTasks[s])return m(),Promise.resolve(0);if(Math.abs(p-v)>1e-6||y.disabled)return m(),Promise.resolve(0);var k,b=this.$container;b.css({transform:"scale(1)"});var w=(0,j.createDeferred)();if(a){var _=new Image;_.onload=function(){k=function(e,t,n){e.drawImage(_,t,n)},w.resolve()},_.onerror=function(){w.reject()},_.src=URL.createObjectURL(a)}else{if(!r)return w.resolve();var P=new(Uint8ClampedArray||Uint8Array)(r);if(!n)return;var A=n.getContext("2d").createImageData(l,d);if(A.data.set(P),j.isChrome&&this.isRenderViewWatermark){var S=document.createElement("canvas"),x=S.getContext("2d");S.width=l,S.height=d,x.putImageData(A,0,0);var C=new Image;C.src=S.toDataURL(),k=function(e,t,n){e.drawImage(C,t,n)}}else k=function(e,t,n){e.putImageData(A,t,n)};w.resolve()}return w.promise.then((function(){var r=n.getContext("2d"),a=n.left,h=n.top;return k(r,u-a,c-h),i.updateCanvasMore(r,u,c,a,h,l,d,1e6,0,0,t),i.renderedScale=p,o&&i.setDom(b),100==e.rate&&(i.timer[s]&&(clearTimeout(i.timer[s]),delete i.timer[s]),i.tileTasks[s]&&(i.api.cancleProgress(s),delete i.tileTasks[s]),0==Object.keys(i.tileTasks).length&&(i.offRender=null)),1}))}},{key:"getVisibleRealRect",value:function(){var e=this.visibleRect;return e?{left:parseInt(e.left*j.dpr+.5),right:parseInt(e.right*j.dpr+.5),top:parseInt(e.top*j.dpr+.5),bottom:parseInt(e.bottom*j.dpr+.5)}:null}},{key:"clearCanvasContent",value:function(){Array.from(this.$canvases).forEach((function(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}))}}]),e}();const fr=hr;var gr=g(3214),vr=g.n(gr);const pr=function(){function e(t,n){(0,P._)(this,e),this.$handler=t,this.render=n,this.states=[]}return(0,A._)(e,[{key:"active",value:function(){}},{key:"destroy",value:function(){}},{key:"intoState",value:function(){}},{key:"outState",value:function(){}},{key:"resetState",value:function(){}},{key:"setStates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.states;this.states=e}},{key:"getStates",value:function(){return this.states}},{key:"clearStates",value:function(){}}]),e}();function mr(){var e,t=this,n=t.$handler,i=n[0],r=this.render,o=r.pdfViewer.eventEmitter,a=new(vr().Manager)(i,{recognizers:[[vr().Pan,{direction:vr().DIRECTION_ALL}]]});return a.add(new(vr().Tap)({event:"doubletap",taps:2})),a.add(new(vr().Tap)({event:"singletap"})),a.get("doubletap").recognizeWith("singletap"),a.get("singletap").requireFailure("doubletap"),a.on("singletap",(function(e){var t=r.annotsRender;t?(t.unActiveAnnot(),r.parent("pdfDocRender").getFormRender().blurControl(),o.emit(de.tapPage,e)):o.emit(de.tapPage,e)})),a.on("doubletap",(function(e){var t=r.annotsRender;t?(t.unActiveAnnot(),r.parent("pdfDocRender").getFormRender().blurControl(),o.emit(de.doubleTapPage,e)):o.emit(de.doubleTapPage,e)})),a.on("press",(function(e){var t=r.annotsRender;t?(t.unActiveAnnot(),r.parent("pdfDocRender").getFormRender().blurControl(),o.emit(de.pressPage,e)):o.emit(de.pressPage,e)})),i.oncontextmenu=function(e){e.preventDefault()},n.on("mouseup",e=function(e){if(3===e.which){var t=r.annotsRender;t?(t.unActiveAnnot(),o.emit(de.rightClickPage,e)):o.emit(de.rightClickPage,e)}}),function(){var r;a.destroy(),n.off("mouseup",e),t=r,n=r,i=r,o=r,e=r}}var yr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).handlers={hand:mr},r.destroyStateHandlers={},r}return(0,A._)(n,[{key:"active",value:function(){this.activated||(this.activated=!0,this.$handler.addClass("fv__active"));this.states.length||this.resetState()}},{key:"destroy",value:function(){this.$handler.removeClass("fv__active")}},{key:"intoState",value:function(e){var t=this.states;if(-1===t.indexOf(e)){t.push(e);var n=this.handlers[e];n&&(this.destroyStateHandlers[e]=n.bind(this)())}}},{key:"outState",value:function(e){var t,n;(t=this.destroyStateHandlers[e])&&(t.bind(this)(),delete this.destroyStateHandlers[e]),-1!==(n=this.states.indexOf(e))&&this.states.splice(n,1)}},{key:"resetState",value:function(){this.setStates(["hand"])}},{key:"setStates",value:function(e){for(var t=this.states,n=0,i=t.length;n<i;n++)this.outState(t[n]);for(var r=0,o=e.length;r<o;r++)this.intoState(e[r])}},{key:"getStates",value:function(){return this.states}}]),n}(pr);const kr=yr;var br=function(){function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,P._)(this,e),this.pageRender=t,this.secondaryScale=r,this.fixedPosition=o;var a=document.createElement("div");a.classList.add("fv__page-area-renderer");var s=document.createElement("canvas");a.appendChild(s),this.canvas=s,this.element=a,this.setDimension(n,i),this.offsetPageX=0,this.offsetPageY=0}return(0,A._)(e,[{key:"setDimension",value:function(e,t){this.width=e,this.height=t,this.canvas.width=e,this.canvas.height=t,this.element.style.cssText+="width: ".concat(e,"px;height:").concat(t,"px")}},{key:"setPosition",value:function(e,t){this.offsetPageX=e,this.offsetPageY=t}},{key:"setSecondaryScale",value:function(e){e=Number(e),(!isFinite(e)||e<=0)&&(e=1),this.secondaryScale=e}},{key:"update",value:function(){var e=this,t=this.pageRender;return t.getPDFPage().then((function(n){var i=n.doc.api;e.tasks&&(i.cancleProgress(e.tasks.id),e.tasks=null);var r=t.scale,o=e.canvas,a=4*r/3*e.secondaryScale,s=t.getShowWidth()*e.secondaryScale,u=t.getShowHeight()*e.secondaryScale,c=o.width,l=o.height,d=c/2,h=l/2,f=e.offsetPageX*e.secondaryScale,g=e.offsetPageY*e.secondaryScale,v=f-d,p=f+d,m=g-h,y=g+h,k=0,b=0;e.fixedPosition?(v<0&&(p=(v=0)+c),p>s&&(v=(p=s)-c),m<0&&(y=(m=0)+l),y>u&&(m=(y=u)-l)):(v<0?k=Math.min(-v,d):p>s&&(k=Math.max(s-p,-d)),m<0?b=Math.min(-m,h):y>u&&(b=Math.max(u-y,-h)),o.style.cssText+="left: ".concat(k,"px; top: ").concat(b,"px"));var w=Math.max(0,v),_=Math.min(p,s),P=Math.max(0,m),A=Math.min(y,u),S=Math.round(_-w),x=Math.round(A-P),C=Math.abs(Math.min(0,k)),D=Math.abs(Math.min(0,b)),E=""+Date.now()+rr();return e.tasks={id:E,canvasDrawingLeft:C,canvasDrawingTop:D},e.getPageBitmap(n.getPDFDoc().getId(),n.getId(),a,e.pageRender.rotate,{x:w,y:P,width:S,height:x},E,j.dpr).then(e.displayImage.bind(e))}))}},{key:"displayImage",value:function(e){var t=e.buffer,n=e.image,i=e.progressiveId,r=(e.x,e.y,e.width),o=e.height,a=e.rate;if(!e.isEmpty&&this.tasks){if(this.tasks.id==i){var s=this.canvas,u=s.getContext("2d");if(u.clearRect(0,0,this.canvas.width,this.canvas.height),n)return new Promise((function(e,t){try{var i=new Image;i.onload=function(){u.drawImage(i,0,0,r,o),URL.revokeObjectURL(i.src),e(s)},i.src=URL.createObjectURL(n)}catch(e){console.log(e)}}));var c=u.createImageData(r,o);return c.data.set(new(Uint8ClampedArray||Uint8Array)(t)),u.putImageData(c,this.tasks.canvasDrawingLeft,this.tasks.canvasDrawingTop),100==a&&(this.tasks=null),s}}else this.tasks=null}},{key:"getPageBitmap",value:function(e,t,n,i,r,o,a){return this.pageRender.getPDFPage().then((function(s){return s.doc.api.getPageBitmap(e,t,n,i,r,["page","annot","form"],"view",o,!1,{hotAnnot:0,hideAnnots:[],dpr:a}).then((function(u){var c=function(u){return u.rate<100?s.doc.api.continueProgress(u.progressiveId).then(c):u.buffer||u.image?u:s.doc.api.getPageBitmap(e,t,n,i,r,["page","annot","form"],"view",o,!1,{hotAnnot:0,hideAnnots:[],dpr:a})};return u.rate>=100?u:c(u)}))}))}}]),e}(),wr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Center",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-45,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100;(0,P._)(this,e),this.position=t,this.offsetX=n,this.offsetY=i,this.scaleX=r,this.scaleY=o,this.rotation=a,this.opacity=s}return(0,A._)(e,[{key:"setPosition",value:function(e){this.position=e}},{key:"getPosition",value:function(){return this.position}},{key:"setOffsetX",value:function(e){this.offsetX=e}},{key:"getOffsetX",value:function(){return this.offsetX}},{key:"setOffsetY",value:function(e){this.offsetY=e}},{key:"getOffsetY",value:function(){return this.offsetY}},{key:"setScaleX",value:function(e){this.scaleX=e}},{key:"getScaleX",value:function(){return this.scaleX}},{key:"setScaleY",value:function(e){this.scaleY=e}},{key:"getScaleY",value:function(){return this.scaleY}},{key:"setRotation",value:function(e){this.rotation=e}},{key:"getRotation",value:function(){return this.rotation}},{key:"setOpacity",value:function(e){this.opacity=e}},{key:"getOpacity",value:function(){return this.opacity}}]),e}(),_r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Microsoft Yahei",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#000000",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"normal",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"center";(0,P._)(this,e),this.font=t,this.fontSize=n,this.color=i,this.fontStyle=r,this.lineSpace=o,this.alignment=a}return(0,A._)(e,[{key:"setFont",value:function(e){this.font=e}},{key:"getFont",value:function(){return this.font}},{key:"setFontSize",value:function(e){this.fontSize=e}},{key:"getFontSize",value:function(){return this.fontSize}},{key:"setColor",value:function(e){this.color=e}},{key:"getColor",value:function(){return this.color}},{key:"setFontStyle",value:function(e){this.fontStyle=e}},{key:"getFontStyle",value:function(){return this.fontStyle}},{key:"setLineSpace",value:function(e){this.lineSpace=e}},{key:"getLineSpace",value:function(){return this.lineSpace}},{key:"setAlignment",value:function(e){this.alignment=e}},{key:"getAlignment",value:function(){return this.alignment}}]),e}(),Pr=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"watermark",void 0),(0,J._)(this,"imageURL",void 0),(0,J._)(this,"imagePromise",void 0),(0,J._)(this,"image",void 0),(0,J._)(this,"originImageWidth",void 0),(0,J._)(this,"originImageHeight",void 0),this.watermark=t,this.imageURL=n,this.originImageWidth=0,this.originImageHeight=0,this.imagePromise=this.loadImage()}return(0,A._)(e,[{key:"ready",value:function(){var e=this;return this.imagePromise.then((function(t){return e.image=t,e.originImageWidth=t.width,e.originImageHeight=t.height,e}))}},{key:"render",value:function(e,t,n,i){if(!this.image)throw new Error("Image watermark renderer has not been ready!");var r=document.createElement("canvas");r.width=n,r.height=i;var o=this.watermark.watermarkSettings,a=o.getOffsetX(),s=o.getOffsetY(),u=o.getScaleX(),c=o.getScaleY(),l=r.getContext("2d"),d=this.watermark.smartScale;l.globalAlpha=o.opacity/100;var h=this.image;return h.width=this.originImageWidth*u*d,h.height=this.originImageHeight*c*d,l.translate(-e,-t),this.performTransformation(l,h),l.drawImage(h,-h.width/2+a,-h.height/2+s,h.width,h.height),r}},{key:"performTransformation",value:function(e,t){var n=this.watermark.watermarkSettings,i=n.getRotation(),r=function(e,t,n){var i,r,o=Math.sqrt(Math.pow(e/2,2)+Math.pow(t/2,2)),a=Math.asin(t/2/o)/(Math.PI/180),s=(n+360)%360;s>=270&&s<360||s>=90&&s<180?(i=n-a,r=a+n):(i=n+a,r=n-a);var u=o*Math.abs(Math.sin(i*Math.PI/180));return{x:o*Math.abs(Math.cos(r*Math.PI/180))-e/2,y:u-t/2}}(t.width,t.height,i),o=r.x,a=r.y,s=this.watermark.showWidth,u=this.watermark.showHeight;switch(n.getPosition()){case"TopLeft":c(o+t.width/2,a+t.height/2);break;case"TopCenter":c(s/2,a+t.height/2);break;case"TopRight":c(s-o-t.width/2,a+t.height/2);break;case"CenterLeft":c(o+t.width/2,u/2);break;case"Center":c(s/2,u/2);break;case"CenterRight":c(s-o-t.width/2,u/2);break;case"BottomLeft":c(o+t.width/2,u-a-t.height/2);break;case"BottomCenter":c(s/2,u-a-t.height/2);break;case"BottomRight":c(s-o-t.width/2,u-a-t.height/2)}function c(t,n){e.translate(t,n)}i%360!=0&&e.rotate(i*Math.PI/180)}},{key:"loadImage",value:function(){var e=this,t=document.createElement("img");return new Promise((function(n,i){t.onload=function(){n(t)},t.onerror=function(t){var n=new Error("Failed to load watermark image: ".concat(e.imageURL));n.originEvent=t,i(n)},t.src=e.imageURL}))}}]),e}();var Ar=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"watermark",void 0),(0,J._)(this,"text",void 0),(0,J._)(this,"allLines",void 0),this.watermark=t,this.text=n,this.allLines=n.split(/[\r\n]/)}return(0,A._)(e,[{key:"ready",value:function(){return Promise.resolve(this)}},{key:"render",value:function(e,t,n,i){var r=document.createElement("canvas");r.width=n,r.height=i;var o=this.watermark,a=o.smartScale,s=o.watermarkTextProperties,u=o.watermarkSettings,c=s.getFontSize()*a,l=s.getLineSpace()*a,d=s.getColor(),h=s.getFont(),f=r.getContext("2d");f.font="".concat(c,"px ").concat(h),f.fillStyle=d,f.lineWidth=1,f.strokeStyle=d,f.textBaseline="top",f.globalAlpha=u.getOpacity()/100;var g=this.allLines,v=g.length*c+(g.length-1)*l,p=this.resolveMaxWidth(f);return f.translate(-e,-t),this.performTransformation(f,p,v),this.renderText(f,p,v),r}},{key:"renderText",value:function(e,t,n){var i=this.allLines,r=this.watermark,o=r.smartScale,a=r.watermarkTextProperties,s=r.watermarkSettings,u=a.getFontSize()*o,c=a.getLineSpace()*o,l=a.getFontStyle(),d=a.getAlignment(),h=s.getOffsetX(),f=s.getOffsetY();u<12&&e.scale(u/12,u/12),i.forEach((function(i,r){var o,a,s=i.replace(/(^\s*)|(\s*$)/g,""),g=s.length*u,v=0,p=0;switch(d){case"left":e.textAlign="left",o=-g/2-(t-g)/2,a=g/2-(t-g)/2,v=-t/2,p=-n/2;break;case"right":e.textAlign="right",o=-g/2+(t-g)/2,a=g/2+(t-g)/2,v=t/2,p=-n/2;break;default:e.textAlign="center",o=-g/2,a=g/2,p=-n/2}e.fillText(s,v+h,p+r*(c+u)+f),"underline"===l&&(e.moveTo(o+h,-n/2+u+r*(u+c)+f),e.lineTo(a+h,-n/2+u+r*(u+c)+f),e.stroke())}))}},{key:"performTransformation",value:function(e,t,n){var i=this.watermark,r=i.showWidth,o=i.showHeight,a=i.watermarkSettings,s=a.getRotation(),u=function(e,t,n){var i,r,o=Math.sqrt(Math.pow(e/2,2)+Math.pow(t/2,2)),a=Math.asin(t/2/o)/(Math.PI/180),s=(n+360)%360;s>=270&&s<360||s>=90&&s<180?(i=n-a,r=a+n):(i=n+a,r=n-a);var u=o*Math.abs(Math.sin(i*Math.PI/180));return{x:o*Math.abs(Math.cos(r*Math.PI/180))-e/2,y:u-t/2}}(t,n,s),c=u.x,l=u.y;switch(a.getPosition()){case"TopLeft":d(c+t/2,l+n/2);break;case"TopCenter":d(r/2,l+n/2);break;case"TopRight":d(r-c-t/2,l+n/2);break;case"CenterLeft":d(c+t/2,o/2);break;case"Center":d(r/2,o/2);break;case"CenterRight":d(r-c-t/2,o/2);break;case"BottomLeft":d(c+t/2,o-l-n/2);break;case"BottomCenter":d(r/2,o-l-n/2);break;case"BottomRight":d(r-c-t/2,o-l-n/2)}function d(t,n){e.translate(t,n)}s%360!=0&&e.rotate(s*Math.PI/180)}},{key:"resolveMaxWidth",value:function(e){var t=this.text.split(/[\r\n]+/);return Math.max.apply(Math,t.map((function(t){return e.measureText(t).width})))}}]),e}();var Sr=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"watermark",void 0),this.watermark=t}return(0,A._)(e,[{key:"getColumnSpace",value:function(){var e=this.watermark,t=e.columnSpace,n=e.smartScale;return(0,U.F2)(t)*n}},{key:"getRowSpace",value:function(){var e=this.watermark,t=e.rowSpace,n=e.smartScale;return(0,U.F2)(t)*n}},{key:"getColor",value:function(){return this.watermark.watermarkTextProperties.getColor()}},{key:"resolveDimensions",value:function(e,t,n){return Math.ceil(e/(t+n))}}]),e}(),xr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e),(0,J._)((0,w._)(r),"watermark",void 0),(0,J._)((0,w._)(r),"text",void 0),(0,J._)((0,w._)(r),"allLines",void 0),r.watermark=e,r.text=i,r.allLines=i.split(/[\r\n]/),r}return(0,A._)(n,[{key:"ready",value:function(){return Promise.resolve(this)}},{key:"setupFontInfo",value:function(e){var t=this.watermark.watermarkTextProperties,n=this.getFontSize(),i=t.getColor(),r=this.getFont();e.font="".concat(Math.max(12,n),"px ").concat(r),e.fillStyle=i,e.lineWidth=1,e.strokeStyle=i,e.textBaseline="top"}},{key:"getFontSize",value:function(){var e=this.watermark,t=e.smartScale,n=e.watermarkTextProperties;return(0,U.F2)(n.getFontSize())*t}},{key:"getFont",value:function(){return this.watermark.watermarkTextProperties.getFont()}},{key:"getLineSpacePx",value:function(){var e=this.watermark.watermarkTextProperties;return(0,U.F2)(e.getLineSpace())}},{key:"resolveTextBlockRect",value:function(e){var t=this;return this.invoke(e,(function(e){var n,i=t.getLineSpacePx();t.setupFontInfo(e);var r=t.getFontSize(),o=r<12?r/12:1,a=t.allLines.map((function(t){var n=e.measureText(t);return{width:n.width*o,height:(n.actualBoundingBoxDescent-n.actualBoundingBoxAscent)*o}})),s=a.reduce((function(e,t){return e+t.height}),0)+i*(a.length-1),u=(n=Math).max.apply(n,(0,I._)(a.map((function(e){return e.width}))));return{width:u,height:s,sizes:a,fontScale:o}}))}},{key:"invoke",value:function(e,t){var n=!1;try{e.save();var i=t(e);return"function"==typeof i.then&&"function"==typeof i.finally&&(n=!0,i.finally((function(){e.restore()}))),i}finally{n||e.restore()}}}]),n}(Sr);function Cr(e,t,n){var i,r,o,a,s=e/2,u=t/2,c=[{x:-s,y:-u},{x:s,y:-u},{x:-s,y:u},{x:s,y:u}].map((function(e){return{x:e.x*Math.cos(n)-e.y*Math.sin(n),y:e.x*Math.sin(n)+e.y*Math.cos(n)}})),l=e/((i=Math).max.apply(i,(0,I._)(c.map((function(e){return e.x}))))-(r=Math).min.apply(r,(0,I._)(c.map((function(e){return e.x}))))),d=t/((o=Math).max.apply(o,(0,I._)(c.map((function(e){return e.y}))))-(a=Math).min.apply(a,(0,I._)(c.map((function(e){return e.y})))));return Math.min(l,d)}var Dr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"render",value:function(e,t,n,i){var r=document.createElement("canvas");r.width=n,r.height=i;var o=r.getContext("2d");if(!o)throw new Error("An unknown error has occurred and the view watermark cannot be rendered!");var a=this.resolveTextBlockRect(o),s=this.watermark,u=(s.smartScale,s.showWidth),c=s.showHeight,l=s.watermarkSettings,d=l.opacity,h=l.rotation,f=l.scaleX,g=l.scaleY;this.setupFontInfo(o);var v=(h+360)%360/180*Math.PI,p=Cr(u,c,v),m=.5*u-e,y=.5*c-t;o.globalAlpha=d/100,o.translate(m,y),o.scale(p,p),o.rotate(-v),o.translate(-m,-y);for(var k=this.getColumnSpace(),b=this.getRowSpace(),w=a.width*f*a.fontScale,_=a.height*g*a.fontScale,P=this.resolveDimensions(u,w,k),A=this.resolveDimensions(c,_,b),S={left:e,top:t,right:e+n,bottom:t+i},x=0;x<=P;x++)for(var C=x*w+k*x,D=0;D<=A;D++){var E=D*_+b*D;this.renderText(C,E,a,S,o,x,D)}return r}},{key:"renderText",value:function(e,t,n,i,r,o,a){var s=t,u=this.watermark,c=u.watermarkTextProperties,l=c.fontStyle,d=c.color,h=c.alignment,f=u.smartScale,g=u.watermarkSettings,v=g.scaleX,p=g.scaleY,m=n.sizes,y=n.fontScale,k=this.getLineSpacePx()*p*f,b="underline"===l,w=this.allLines.map((function(e,t){return m[t].width*v*y})),_=n.width*v*y;this.allLines.some((function(t,n){var i=m[n],o=i.width,a=i.height,u=o*v*y,c=a*p*y,l=function(e){switch(h){case"right":return _-w[e];case"center":return.5*(_-w[e])}return 0}(n);if(r.save(),r.scale(y,y),r.fillText(t,(e+l)/y,s/y),r.restore(),b){r.save(),r.imageSmoothingEnabled=!0,r.lineWidth=Math.floor(1*f),r.strokeStyle=d;var g=s+c;r.moveTo(e+l,g),r.lineTo(e+l+u,g),r.stroke(),r.restore()}return s+=c+k,!1}))}}]),n}(xr),Er=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e),(0,J._)((0,w._)(r),"watermark",void 0),(0,J._)((0,w._)(r),"imageURL",void 0),(0,J._)((0,w._)(r),"imagePromise",void 0),(0,J._)((0,w._)(r),"image",void 0),(0,J._)((0,w._)(r),"originImageWidth",void 0),(0,J._)((0,w._)(r),"originImageHeight",void 0),r.watermark=e,r.imageURL=i,r.originImageWidth=0,r.originImageHeight=0,r.imagePromise=r.loadImage(),r}return(0,A._)(n,[{key:"ready",value:function(){var e=this;return this.imagePromise.then((function(t){return e.image=t,e.originImageWidth=t.width,e.originImageHeight=t.height,e}))}},{key:"render",value:function(e,t,n,i){if(!this.image)throw new Error("Image watermark renderer has not been ready!");var r=document.createElement("canvas");r.width=n,r.height=i;var o=r.getContext("2d");if(!o)throw new Error("An unknown error has occurred and the view watermark cannot be rendered!");var a=this.watermark,s=a.smartScale,u=a.showWidth,c=a.showHeight,l=a.watermarkSettings,d=l.opacity,h=l.rotation,f=l.scaleX,g=l.scaleY,v=(h+360)%360/180*Math.PI,p=Cr(u,c,v),m=.5*u-e,y=.5*c-t;o.globalAlpha=d/100,o.translate(m,y),o.scale(p,p),o.rotate(-v),o.translate(-m-e,-y-t);var k=this.getColumnSpace(),b=this.getRowSpace(),w=this.originImageWidth*f*s,_=this.originImageHeight*g*s;this.image.width=w,this.image.height=_;for(var P=this.resolveDimensions(u,w,k),A=this.resolveDimensions(c,_,b),S=0;S<=P;S++)for(var x=S*w+k*S,C=0;C<=A;C++){var D=C*_+b*C;o.drawImage(this.image,x,D,w,_)}return r}},{key:"loadImage",value:function(){var e=this,t=document.createElement("img");return new Promise((function(n,i){t.onload=function(){n(t)},t.onerror=function(t){var n=new Error("Failed to load watermark image: ".concat(e.imageURL));n.originEvent=t,i(n)},0===e.imageURL.indexOf("blob")||0===e.imageURL.indexOf("data")?t.src=e.imageURL:function(e){if(Ir.has(e))return Ir.get(e);var t=fetch(e).then((function(e){return e.blob()})).then((function(e){return URL.createObjectURL(e)}));return Ir.set(e,t),t}(e.imageURL).then((function(e){t.src=e}))}))}}]),n}(Sr),Ir=new Map;var Rr=function(){function e(t,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=o.isMultiline,s=void 0!==a&&a,u=o.rowSpace,c=void 0===u?0:u,l=o.columnSpace,d=void 0===l?0:l,h=o.watermarkSettings,f=void 0===h?{position:"Center",offsetX:0,offsetY:0,scaleX:1,scaleY:1,rotation:-45,opacity:100}:h,g=o.watermarkTextProperties,v=void 0===g?{font:"Microsoft Yahei",fontSize:20,color:"#000000",fontStyle:"normal",lineSpace:10,alignment:"center"}:g;(0,P._)(this,e),this.isMultiline=s,this.rowSpace=c,this.columnSpace=d,this.showWidth=t,this.showHeight=n,this.tileSize=i,this.smartScale=r;var p=f.position,m=f.offsetX,y=f.offsetY,k=f.scaleX,b=f.scaleY,w=f.rotation,_=f.opacity,A=v.font,S=v.fontSize,x=v.color,C=v.fontStyle,D=v.lineSpace,E=v.alignment;this.watermarkSettings=new wr(p,m,y,k,b,w,_),this.watermarkTextProperties=new _r(A,S,x,C,D,E)}return(0,A._)(e,[{key:"exportDataURL",value:function(e){var t=e.content,n=e.type,i=function(e){return e.toDataURL()};return"text"===n?this.createTextWatermark(t).then(i):"image"===n?this.createImageWatermark(t).then(i):void 0}},{key:"getWatermarkRenderer",value:function(e){var t=e.content;switch(e.type){case"text":return this.isMultiline?new Dr(this,t).ready():new Ar(this,t).ready();case"image":return this.isMultiline?new Er(this,t).ready():new Pr(this,t).ready()}}},{key:"createImageWatermark",value:function(e){var t=this,n=(0,j.createDeferred)(),i=document.createElement("canvas");i.width=this.showWidth,i.height=this.showHeight;var r=i.getContext("2d"),o=i.getContext("2d"),a=new Image;a.src=e;var s=this.watermarkSettings,u=s.getOffsetX(),c=s.getOffsetY(),l=s.getScaleX(),d=s.getScaleY(),h=s.getRotation(),f=this.showWidth,g=this.showHeight;return a.onload=function(){a.width=a.width*l*t.smartScale,a.height=a.height*d*t.smartScale,Tr(r,s.getOpacity()),r.save();var e=Fr(a.width,a.height,h),v=e.x,p=e.y;switch(s.getPosition()){case"TopLeft":o.translate(v+a.width/2,p+a.height/2);break;case"TopCenter":o.translate(f/2,p+a.height/2);break;case"TopRight":o.translate(f-v-a.width/2,p+a.height/2);break;case"CenterLeft":o.translate(v+a.width/2,g/2);break;case"Center":o.translate(f/2,g/2);break;case"CenterRight":o.translate(f-v-a.width/2,g/2);break;case"BottomLeft":o.translate(v+a.width/2,g-p-a.height/2);break;case"BottomCenter":o.translate(f/2,g-p-a.height/2);break;case"BottomRight":o.translate(f-v-a.width/2,g-p-a.height/2)}h%360!=0&&o.rotate(h*Math.PI/180),o.drawImage(a,-a.width/2+u,-a.height/2+c,a.width,a.height),r.restore(),n.resolve(i)},a.onerror=function(e){var t=new Error("Failed to load image");t.originEvent=e,n.reject(t)},a.oncancel=function(e){var t=new Error("Load image has been cancelled");t.originEvent=e,n.reject(t)},n.promise}},{key:"createTextWatermark",value:function(e){var t=(0,j.createDeferred)(),n=document.createElement("canvas");n.width=this.showWidth,n.height=this.showHeight;var i=e.split("\n"),r=n.getContext("2d"),o=n.getContext("2d"),a=this.showWidth,s=this.showHeight,u=this.watermarkTextProperties,c=u.getFontSize()*this.smartScale,l=u.getLineSpace()*this.smartScale,d=u.getFontStyle(),h=u.getColor(),f=u.getAlignment(),g=u.getFont();o.font=c+"px "+g,o.fillStyle=h;var v=this.watermarkSettings,p=v.getOffsetX(),m=v.getOffsetY(),y=(v.getScaleX(),v.getScaleY(),v.getRotation()),k=0,b=i.length,w=b*c+(b-1)*l;i.map((function(e){var t=e.replace(/\s+/g,"");k=Math.max(t.length*c,k)})),o.lineWidth=1,o.strokeStyle=h,r.textBaseline="top",Tr(r,v.getOpacity());var _=Fr(k,w,y),P=_.x,A=_.y;switch(v.getPosition()){case"TopLeft":o.translate(P+k/2,A+w/2);break;case"TopCenter":o.translate(a/2,A+w/2);break;case"TopRight":o.translate(a-P-k/2,A+w/2);break;case"CenterLeft":o.translate(P+k/2,s/2);break;case"Center":o.translate(a/2,s/2);break;case"CenterRight":o.translate(a-P-k/2,s/2);break;case"BottomLeft":o.translate(P+k/2,s-A-w/2);break;case"BottomCenter":o.translate(a/2,s-A-w/2);break;case"BottomRight":o.translate(a-P-k/2,s-A-w/2)}return o.rotate(y*Math.PI/180),c<12&&o.scale(c/12,c/12),i.map((function(e,t){var n,i,a=e.replace(/(^\s*)|(\s*$)/g,""),s=a.length*c,u=0,h=0;switch(f){case"left":r.textAlign="left",n=-s/2-(k-s)/2,i=s/2-(k-s)/2,u=-k/2,h=-w/2;break;case"right":r.textAlign="right",n=-s/2+(k-s)/2,i=s/2+(k-s)/2,u=k/2,h=-w/2;break;default:r.textAlign="center",n=-s/2,i=s/2,h=-w/2}o.fillText(a,u+p,h+t*(l+c)+m),"underline"===d&&(o.moveTo(n,-w/2+c+t*(c+l)),o.lineTo(i,-w/2+c+t*(c+l)),o.stroke())})),t.resolve(n),t.promise}},{key:"getWatermarkSettings",value:function(){return this.watermarkSettings}},{key:"getWatermarkTextProperties",value:function(){return this.watermarkTextProperties}},{key:"getHeight",value:function(){return this.showHeight}},{key:"getWidth",value:function(){return this.showWidth}}]),e}();function Tr(e,t){e.globalAlpha=t/100}function Fr(e,t,n){var i,r,o=Math.sqrt(Math.pow(e/2,2)+Math.pow(t/2,2)),a=Math.asin(t/2/o)/(Math.PI/180),s=(n+360)%360;s>=270&&s<360||s>=90&&s<180?(i=n-a,r=a+n):(i=n+a,r=n-a);var u=o*Math.abs(Math.sin(i*Math.PI/180));return{x:o*Math.abs(Math.cos(r*Math.PI/180))-e/2,y:u-t/2}}var Mr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,r)).name="customsRender",o.$ui=e,o.customs=i,o.customRenders={},o}return(0,A._)(n,[{key:"render",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.scale=e,this.rotate=t;var n=this.customs;this.adjustCustomsRenderInit(n);var i=this.pdfViewer.customRenderManager,r=this.customRenders;return Promise.all(n.map((function(n){return r[i.getCustomDataId(n)].render(e,t)})))}},{key:"activeCustom",value:function(e){var t=this.customRenders[this.customManager.getCustomDataId(e)];return t?(this.currentActiveCustomRender=t,t.render(this.scale,this.rotate)):Promise.reject(new Error("Custom render not found!"))}},{key:"unActiveCustoms",value:function(){var e=this.currentActiveCustomRender;if(e)return e.unActive()}},{key:"adjustCustomsRenderInit",value:function(e){var t=this,n=this.pdfViewer.customRenderManager,i=this.customRenders,r=document.createDocumentFragment();e.filter((function(e){return!i[n.getCustomDataId(e)]})).map((function(e){var o=document.createElement("div"),a=document.createElement("div");r.appendChild(o),r.appendChild(a),i[n.getCustomDataId(e)]=new(n.get(e))(o,a,e,t)})).length&&this.$ui.append(r)}},{key:"addCustomRenders",value:function(e){this.adjustCustomsRenderInit(e);var t=this.pdfViewer.customRenderManager,n=this.customRenders,i=this.scale,r=this.rotate;return Promise.all(e.map((function(e){return n[t.getCustomDataId(e)].render(i,r)})))}},{key:"removeCustomRenders",value:function(e){var t={},n=this.pdfViewer.customRenderManager,i=this.customRenders;e.map((function(e){var r=n.getCustomDataId(e);t[r]=1,delete i[r]}));for(var r=this.customs,o=r.length;o--;)t[n.getCustomDataId(r[o])]&&r.splice(o,1)}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this);var e=this.customRenders;for(var t in e){var i=e[t];i&&i.destroy()}this.customRenders=null}},{key:"updateCustomRenders",value:function(e){for(var t=this,n={},i=this.pdfViewer.customRenderManager,r=this.customRenders,o=e.map((function(e){var t=i.getCustomDataId(e);return n[t]=e,r[t]})),a=this.customs,s=a.length;s--;){var u=i.getCustomDataId(a[s]);n[u]&&(a[s]=n[u])}return Promise.all(o.map((function(e){return e&&e.render(t.scale,t.rotate)})))}}]),n}(te),Or=function(){function e(){(0,P._)(this,e),this.init.apply(this,arguments)}return(0,A._)(e,[{key:"init",value:function(){if(1==arguments.length)this.info={type:arguments[0]};else{var e=(0,E._)(arguments,6),t=e[0],n=e[1],i=e[2],r=(e[3],e[4]),o=e[5];this.info=t,this.factory=n,this.doc=i,this.host=o,this.eventEmitter=r}this.initSubAction()}},{key:"checkInserted",value:function(){if(!this.doc.api)throw new Error("Please insert this action to a host first.")}},{key:"initSubAction",value:function(){var e=this;this.subAction=[],this.info.subAction&&this.info.subAction.forEach((function(t){e.subAction.push(e.factory.createAction(t,e.doc,e.doc.api,e.eventEmitter,e.host))}))}},{key:"appendSubAction",value:function(e){this.subAction.push(e),this.info.subAction=this.info.subAction||[],this.info.subAction.push(e.info)}},{key:"getType",value:function(){return this.info.type}},{key:"getSubActionCount",value:function(){return this.info.subAction.length||0}},{key:"getSubAction",value:function(e){return this.subAction[e]}},{key:"insertSubAction",value:function(t,n){var i=this;if(this.checkInserted(),"number"!=typeof t)throw new Error("param error. Only number is available.");return t=Math.max(0,Math.min(t,this.getSubActionCount())),(0,D._)(n,e)&&(n=n.getType()),this.doc.api.insertSubAction(this.doc.getId(),this.info.objNumber,t,n).then((function(e){return i.updateAction(e),e}))}},{key:"setSubAction",value:function(t,n){var i=this;if(this.checkInserted(),"number"!=typeof t)throw new Error("param error. Only number is available.");var r=this.getSubActionCount();if(0===r)throw new Error("Cannot be set without sub action.");return t=Math.max(0,Math.min(t,r-1)),(0,D._)(n,e)&&(n=n.getType()),this.doc.api.setSubAction(this.doc.getId(),this.info.objNumber,t,n).then((function(e){return i.updateAction(e),e}))}},{key:"removeAllSubActions",value:function(){var e=this;if(this.doc.api)return this.doc.api.removeAllSubActions(this.doc.getId(),this.info.objNumber).then((function(t){e.updateAction(t)}))}},{key:"removeSubAction",value:function(e){var t=this;if(this.doc.api){if("number"!=typeof e)throw new Error("param error. Only number is available.");var n=this.getSubActionCount();if(0===n)throw new Error("Cannot be remove without sub action.");return e=Math.max(0,Math.min(e,n-1)),this.doc.api.removeSubAction(this.doc.getId(),this.info.objNumber,e).then((function(e){t.updateAction(e)}))}}},{key:"setActionData",value:function(e){var t=this;return this.doc.api.setActionData(this.doc.getId(),this.info.objNumber,e).then((function(e){t.updateAction(e)}))}},{key:"updateAction",value:function(e){Object.assign(this.info,e),this.initSubAction(),this.host&&(this.eventEmitter.emit(le.actionUpdated,this.host),(0,D._)(this.host,ln)&&this.eventEmitter.emit(le.annotationUpdated,[this.host],this.host.getPDFPage(),"widget"===this.host.getType()?en.formFieldActionUpdated:en.actionDataUpdated))}},{key:"checkOutData",value:function(e){return!0}},{key:"exportToJson",value:function(){return{type:this.getType()}}}]),e}(),Lr=g(9307),Nr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,ot.uri),(0,Lr._)(u)):(u=t.call(this,e,i,r,o,a,s),(0,Lr._)(u))}return(0,A._)(n,[{key:"getURI",value:function(){return this.info.uri}},{key:"checkOutData",value:function(e){return e&&e.uri}},{key:"setURI",value:function(e){var t=this;if(!e&&"string"==typeof e)throw new Error("param error. Only non-empty strings is available.");return this.doc?this.doc.api.setActionURI(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e})):(this.info.uri=e,Promise.resolve())}},{key:"exportToJson",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJson",this).call(this);return Object.assign(e,{uri:this.getURI()})}}]),n}(Or),Vr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,P._)(this,e),this.fileSpec=t}return(0,A._)(e,[{key:"setFileName",value:function(e){this._assetEmptyStringValue("fileName",e),this.fileSpec.fileName=e}},{key:"getChecksum",value:function(){return this.fileSpec.checksum}},{key:"getCreationDateTime",value:function(){return this.fileSpec.creationDateTime}},{key:"getDescription",value:function(){return this.fileSpec.description}},{key:"getDict",value:function(){return this.fileSpec.dict}},{key:"getFileData",value:function(){return this.fileSpec.fileData}},{key:"getFileName",value:function(){return this.fileSpec.fileName}},{key:"getFileSize",value:function(){return this.fileSpec.fileSize}},{key:"getModifiedDateTime",value:function(){return this.fileSpec.modifiedDateTime}},{key:"getSubtype",value:function(){return this.fileSpec.subtype}},{key:"isEmbedded",value:function(){return this.fileSpec.isEmbedded}},{key:"_assetEmptyStringValue",value:function(e,t){if("string"!=typeof t||0==t.length)throw new Error("[Illegal Argument] Invalid ".concat(e,": ").concat(e," is required."))}}]),e}(),Br=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,ot.launch),(0,Lr._)(u)):((u=t.call(this,e,i,r,o,a,s)).fileSpec=u.info.fileSpec&&new Vr(u.info.fileSpec)||null,(0,Lr._)(u))}return(0,A._)(n,[{key:"setFileSpec",value:function(e){var t=this;return this.fileSpec=e,this.info.fileSpec=e.fileSpec,this.doc?this.doc.api.setFileSpec({path:"jr/doc/action"},this.doc.id,this.info.objNumber,this.info.fileSpec).then((function(e){return t.updateAction(e)})):Promise.resolve()}},{key:"getFileSpec",value:function(){return this.fileSpec}},{key:"checkOutData",value:function(e){return e&&e.buffer}},{key:"updateAction",value:function(e){return this.fileSpec=e.fileSpec&&new Vr(e.fileSpec)||null,(0,S._)((0,x._)(n.prototype),"updateAction",this).call(this,e)}}]),n}(Or);const jr=Br;var Ur=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){return(0,P._)(this,n),t.call(this,e,i,r,o,a,s)}return(0,A._)(n,[{key:"getName",value:function(){return this.info.name}},{key:"checkOutData",value:function(e){return e&&e.name}}]),n}(Or);const Hr=Ur;var Wr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,ot.javaScript),(0,Lr._)(u)):((u=t.call(this,e,i,r,o,a,s)).info.script&&(u.info.javascript=u.info.script),(0,Lr._)(u))}return(0,A._)(n,[{key:"getScript",value:function(){return this.info.javascript}},{key:"checkOutData",value:function(e){return e&&e.javascript}},{key:"setScript",value:function(e){var t=this;return this.doc?this.doc.api.setActionScript(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e})):(this.info.javascript=e,Promise.resolve())}},{key:"exportToJson",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJson",this).call(this);return Object.assign(e,{script:this.getScript()})}}]),n}(Or);const Yr=Wr;var qr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),u=e?t.call(this,e,i,r,o,a,s):t.call(this,ot.submitForm),(0,Lr._)(u)}return(0,A._)(n,[{key:"getFlags",value:function(){return this.info.flags}},{key:"getURL",value:function(){return this.info.url}},{key:"getFieldNames",value:function(){return this.info.fieldNames}},{key:"checkOutData",value:function(e){return e&&e.fieldNames&&e.url}},{key:"setData",value:function(e,t,n){this.info.flags=e,this.info.url=t,this.info.fieldNames=n}}]),n}(Or);const Kr=qr;var $r=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;if((0,P._)(this,n),0==arguments.length)return e=t.call(this,ot.resetForm),(0,Lr._)(e);var i=(0,E._)(arguments,6),r=i[0],o=i[1],a=i[2],s=i[3],u=i[4],c=i[5];return e=t.call(this,r,o,a,s,u,c),(0,Lr._)(e)}return(0,A._)(n,[{key:"getFlags",value:function(){return this.info.flags}},{key:"getFieldNames",value:function(){return this.info.fieldNames}},{key:"checkOutData",value:function(e){return e&&e.fieldNames}},{key:"setFieldNames",value:function(e){var t=this;return this.doc?this.doc.api.setActionFieldNames(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e})):(this.info.fieldNames=e,Promise.resolve())}},{key:"setFlags",value:function(e){var t=this;if(!this.doc)return this.info.flags=e,Promise.resolve();if(0!==e&&1!==e)throw new Error("param error. Only 0 or 1 is available.");return this.doc.api.setActionFlags(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e}))}},{key:"exportToJson",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJson",this).call(this);return Object.assign(e,{fieldNames:this.getFieldNames(),flags:this.getFlags()})}}]),n}(Or);const zr=$r;var Gr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,ot.importData),(0,Lr._)(u)):((u=t.call(this,e,i,r,o,a,s)).fileSpec=u.info.fileSpec&&new Vr(u.info.fileSpec)||null,(0,Lr._)(u))}return(0,A._)(n,[{key:"setFileSpec",value:function(e){this.fileSpec=e,this.info.fileSpec=e.fileSpec}},{key:"getFileSpec",value:function(){return this.fileSpec}},{key:"checkOutData",value:function(e){return e&&e.buffer}},{key:"updateAction",value:function(e){return this.fileSpec=e.fileSpec&&new Vr(e.fileSpec)||null,(0,S._)((0,x._)(n.prototype),"updateAction",this).call(this,e)}}]),n}(Or);const Jr=Gr;var Xr=["ZoomXYZ","ZoomFitPage","ZoomFitHorz","ZoomFitRect","ZoomFitBHorz","ZoomFitVert"],Zr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,ot.goto),(0,Lr._)(u)):(u=t.call(this,e,i,r,o,a,s),(0,Lr._)(u))}return(0,A._)(n,[{key:"getDestination",value:function(){return this.info.destination}},{key:"checkOutData",value:function(e){return function(e){var t;t=!!e.type;var n={ZoomXYZ:function(){t=null!=e.pageIndex&&null!=e.left&&null!=e.top&&null!=e.zoomFactor},ZoomFitPage:function(){t=!(null==e.pageIndex)},ZoomFitHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitVert:function(){t=null!=e.pageIndex&&e.left},ZoomFitRect:function(){t=null!=e.pageIndex&&e.left&&null!=e.top&&null!=e.bottom&&null!=e.right},ZoomFitBBox:function(){t=!(null==e.pageIndex)},ZoomFitBHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitBVert:function(){t=null!=e.pageIndex&&null!=e.left}};return n[e.type](),t}(e)}},{key:"setDestination",value:function(e){var t=this;if(!this.doc)return this.info.destination=e,Promise.resolve();if(-1===Xr.indexOf(e.zoomMode))throw new Error("param error. ZoomMode is invalid.");return e.pageIndex=Math.min(this.doc.getPageCount()-1,Math.max(e.pageIndex,0)),this.doc.api.setActionDestination(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e}))}},{key:"exportToJson",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJson",this).call(this);return Object.assign(e,{destination:this.getDestination()})}}]),n}(Or);var Qr=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,ot.hide),(0,Lr._)(u)):(u=t.call(this,e,i,r,o,a,s),(0,Lr._)(u))}return(0,A._)(n,[{key:"getFieldNames",value:function(){return this.info.fieldNames}},{key:"getHideState",value:function(){return this.info.hideState}},{key:"setFieldNames",value:function(e){var t=this;return this.doc?this.doc.api.setActionFieldNames(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e})):(this.info.fieldNames=e,Promise.resolve())}},{key:"setHideState",value:function(e){var t=this;return this.doc?this.doc.api.setActionHideState(this.doc.getId(),this.info.objNumber,e).then((function(e){return t.updateAction(e),e})):(this.info.hideState=e,Promise.resolve())}},{key:"checkOutData",value:function(e){return e&&e.fieldNames&&e.hideState}},{key:"exportToJson",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJson",this).call(this);return Object.assign(e,{fieldNames:this.getFieldNames(),hideState:this.getHideState()})}}]),n}(Or),eo=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),(u=t.call(this,e,i,r,o,a,s)).fileSpec=u.info.fileSpec&&new Vr(u.info.fileSpec)||null,u}return(0,A._)(n,[{key:"getDestinationName",value:function(){return this.info.destinationName}},{key:"getDestination",value:function(){return this.info.destination}},{key:"getFileSpec",value:function(){return this.fileSpec}},{key:"getNewWindowFlag",value:function(){return this.info.newWindowFlag}},{key:"getFileSpecStream",value:function(){var e=[];return this.doc.api.getActionFileStream(this.doc.getId(),this.info.objNumber,(function(t){var n=t.arrayBuffer;e.push(n)})).then((function(){return e}))}},{key:"checkOutData",value:function(e){return function(e){var t;t=!!e.type;var n={ZoomXYZ:function(){t=null!=e.pageIndex&&null!=e.left&&null!=e.top&&null!=e.zoomFactor},ZoomFitPage:function(){t=!(null==e.pageIndex)},ZoomFitHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitVert:function(){t=null!=e.pageIndex&&e.left},ZoomFitRect:function(){t=null!=e.pageIndex&&e.left&&null!=e.top&&null!=e.bottom&&null!=e.right},ZoomFitBBox:function(){t=!(null==e.pageIndex)},ZoomFitBHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitBVert:function(){t=null!=e.pageIndex&&null!=e.left}};return n[e.type](),t&&e.buffer&&e.newWindowFlag}(e)}}]),n}(Or);var to=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),(u=t.call(this,e,i,r,o,a,s)).rootFile=u.info.rootFile&&new Vr(u.info.rootFile)||null,u}return(0,A._)(n,[{key:"getDestinationName",value:function(){return this.info.destinationName}},{key:"getDestination",value:function(){return this.info.destination}},{key:"getRootFile",value:function(){return this.rootFile}},{key:"getNewWindowFlag",value:function(){return this.info.newWindowFlag}},{key:"getTarget",value:function(){return this.info.target}},{key:"getTargetFileInfo",value:function(){var e=this,t=this.getTarget();if(!t)return Promise.resolve(null);Promise.resolve();return t.pageIndex>-1?this.doc.getPageByIndex(t.pageIndex).then((function(e){return e.getAnnots()})).then((function(e){var n=e[t.fileAttachmentAnnotIndex];return Promise.all([n,n.getFileattachmentStream()])})).then((function(e){var t=(0,E._)(e,2),n=t[0],i=t[1],r=n.getFileSpec().fileSpec,o=r.description,a=r.fileName,s=r.fileSize;return{blob:new Blob(i,{type:"application/pdf"}),description:o,fileName:a,fileSize:s}})):this.doc.getNameTree(Vt.EmbeddedFiles).then((function(n){var i=n[t.attachedFileName];if(i){var r=i.objNum,o=i.description,a=i.fileName,s=i.fileSize;return e.doc.getFileSpecStream(r).then((function(e){return{blob:new Blob(e,{type:"application/pdf"}),description:o,fileName:a,fileSize:s}}))}}))}},{key:"checkOutData",value:function(e){return function(e){var t;t=!!e.type;var n={ZoomXYZ:function(){t=null!=e.pageIndex&&null!=e.left&&null!=e.top&&null!=e.zoomFactor},ZoomFitPage:function(){t=!(null==e.pageIndex)},ZoomFitHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitVert:function(){t=null!=e.pageIndex&&e.left},ZoomFitRect:function(){t=null!=e.pageIndex&&e.left&&null!=e.top&&null!=e.bottom&&null!=e.right},ZoomFitBBox:function(){t=!(null==e.pageIndex)},ZoomFitBHorz:function(){t=null!=e.pageIndex&&null!=e.top},ZoomFitBVert:function(){t=null!=e.pageIndex&&null!=e.left}};return n[e.type](),t&&e.buffer&&e.newWindowFlag}(e)}}]),n}(Or);var no=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){var u;return(0,P._)(this,n),0==arguments.length?(u=t.call(this,ot.thread),(0,Lr._)(u)):((u=t.call(this,e,i,r,o,a,s)).info.dest_thread_index&&(u.info.dest_thread_index=u.info.dest_thread_index),(0,Lr._)(u))}return(0,A._)(n,[{key:"getName",value:function(){return this.info.name}},{key:"checkOutData",value:function(e){return e&&e.name}}]),n}(Or),io=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o,a,s){return(0,P._)(this,n),t.call(this,e,i,r,o,a,s)}return(0,A._)(n,[{key:"getName",value:function(){return this.info.name}},{key:"checkOutData",value:function(e){return e&&e.name}},{key:"setOCGState",value:function(e){var t=this,n=this._getLayerIds(e),i=n.hideLayerIds,r=n.visibleLayerIds;return this.doc?this.doc.api.setActionOCGState(this.doc.getId(),this.info.objNumber,i,r).then((function(e){return t.updateAction(e),e})):(this.info.hideLayerIds=i,this.info.visibleLayerIds=r,Promise.resolve())}},{key:"_getLayerIds",value:function(e){var t=[],n=[];function i(e){e.children.length>0&&e.children.forEach((function(e){i(e)})),e.visible?n.push(e.id):t.push(e.id)}for(var r=0;r<e.length;r++)i(e[r]);return{hideLayerIds:t,visibleLayerIds:n}}}]),n}(Or),ro=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,null,[{key:"createAction",value:function(e,t,n,i,r){if(e)switch(e.type){case"TypeThread":return new no(e,this,t,n,i,r);case"TypeURI":return new Nr(e,this,t,n,i,r);case"TypeLaunch":return new jr(e,this,t,n,i,r);case"TypeNamed":return new Hr(e,this,t,n,i,r);case"TypeJavaScript":return new Yr(e,this,t,n,i,r);case"TypeSubmitForm":return new Kr(e,this,t,n,i,r);case"TypeResetForm":return new zr(e,this,t,n,i,r);case"TypeImportData":return new Jr(e,this,t,n,i,r);case"TypeGoto":return new Zr(e,this,t,n,i,r);case"TypeHide":return new Qr(e,this,t,n,i,r);case"TypeGoToR":return new eo(e,this,t,n,i,r);case"TypeGoToE":return new to(e,this,t,n,i,r);case"TypeSetOCGState":return new io(e,this,t,n,i,r);default:return new Or(e,this,t,n,i,r)}}}]),e}();const oo=ro;var ao=function(){function e(t,n,i){(0,P._)(this,e),this.doc=t,this.field=n,this.info=i,this.changes={}}return(0,A._)(e,[{key:"getExportValue",value:function(){return this.info.exportValue}},{key:"setExportValue",value:function(e){this.info.exportValue=e}},{key:"updateProperty",value:function(e,t){return this.changes[e]=t,this.info&&-1==this.info.objectNumber||!this.doc?Promise.resolve():this.doc.api.updateFormControl(this.doc.id,this.field.getName(),this.info.objectNumber,e,t)}},{key:"getProperty",value:function(e){return this.changes[e]}},{key:"destroy",value:function(){this.doc=null,this.info=null}},{key:"isEmpty",value:function(){return this.changes==={}}},{key:"setWidget",value:function(e){this.widget=e}},{key:"getWidget",value:function(){return this.widget}},{key:"getWidgetAnnot",value:function(){var e=this;return this.widget?Promise.resolve(this.widget):this.doc.api.getControlPageIndex(this.doc.id,this.field.getName(),this.info.objectNumber).then((function(t){if(t>=0)return e.doc.getPageAnnots(t)})).then((function(t){return e.widget?e.widget:t?e.widget=t.find((function(t){return t.info.objectNumber==e.info.objectNumber})):void 0}))}},{key:"getIndex",value:function(){return this.info.index}},{key:"getField",value:function(){return this.field}},{key:"getDefaultAppearance",value:function(){var e=this.info&&this.info.DA;if(e&&Object.keys(e).length>0)return e=Object.assign({},this.info.DA);var t=this.getField();return Object.assign({},t.info&&t.info.DA)}},{key:"setDefaultAppearance",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.fillForm|Qt.annotForm))throw new Error("Permission error");var n=(e=Object.assign({},this.info.DA,e)).textColor,i=e.textSize;if("number"!=typeof n||"number"!=typeof i)throw new Error("param error. Only number is available.");n=(4278190080|n)>>>0,e.textColor=n,e.textSize=i;(0,j.colorConvertor)(n,"RGB");var r=JSON.stringify(e);return this.doc.api.updateFormControl(this.doc.id,this.field.getName(),this.info.objectNumber,"DA",r).then((function(){t.info.DA=e;var n=t.widget;if(n)return n.updateMKProperty("DA",e).then((function(i){var r=n.getPDFPage();t.widget.info.DA=e,t.doc.engine.eventEmitter.emit(de.annotationUpdated,[n],r,en.defaultAppearanceUpdated),n.updateUI({type:"DA",value:e})}))}))}}]),e}();const so=ao;var uo=function(){function e(t){(0,P._)(this,e),this.match=t}return(0,A._)(e,[{key:"getEndCharIndex",value:function(){return this.match.endCharIndex}},{key:"getPageIndex",value:function(){return this.match.pageIndex}},{key:"getRects",value:function(){return this.match.rectArray}},{key:"getSentence",value:function(){return this.match.sentence}},{key:"getSentenceStartIndex",value:function(){return this.match.sentenceStartIndex}},{key:"getStartCharIndex",value:function(){return this.match.startCharIndex}}]),e}(),co=function(){function e(t,n){(0,P._)(this,e),this.id=t,this.annot=n,this.page=n.getPDFPage(),this.api=this.page.api}return(0,A._)(e,[{key:"getId",value:function(){return this.id}},{key:"findNext",value:function(){return this.page.doc.api.textSearchFindNext(this.getId()).then((function(e){return e?new uo(e):null}))}},{key:"findPrev",value:function(){return this.page.doc.api.textSearchFindPrev(this.getId()).then((function(e){return e?new uo(e):null}))}},{key:"destroy",value:function(){return this.page.doc.api.textSearchDestroy(this.getId())}}]),e}(),lo=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).resetAction(),r.mapFormControl(),r}return(0,A._)(n,[{key:"resetAction",value:function(){this.action=this.page.doc.engine.actionFactory.createAction(this.info.action,this.page.doc,this.page.doc.api,this.eventEmitter,this)}},{key:"mapFormControl",value:function(){var e=this.info,t=this.getField();if(t){var n=t.getControlById(e.objectNumber);n&&!n.isEmpty()&&n.setWidget(this),this.formControl=n}}},{key:"destroy",value:function(){this.action=null,this.render=null,(0,S._)((0,x._)(n.prototype),"destroy",this).call(this)}},{key:"getControl",value:function(){return this.formControl||this.mapFormControl(),this.formControl}},{key:"setDisplay",value:function(e,t){var n=this.info.flag;switch(e){case 0:n&=-2,n&=-3,n&=-33,n|=4;break;case 1:n&=-2,n&=-33,n|=6;break;case 2:n&=-2,n&=-5,n&=-3,n&=-33;break;case 3:n|=32,n|=4,n&=-3}return this.setFlagValue(n,t)}},{key:"getObjNum",value:function(){return this.info.objectNumber}},{key:"getAction",value:function(){return this.action}},{key:"getRotation",value:function(){return this.info.rotation}},{key:"getField",value:function(){if(!this.page)return null;var e=this.page.getPDFDoc().getPDFForm();return e&&e.getField(this.info.field)}},{key:"getMKProperty",value:function(e){switch(e){case"borderColor":return this.info.MKBorderColor;case"fillColor":return this.info.fillColor;default:return this.info[e]}}},{key:"setMKProperty",value:function(e,t){if(this.isDestroyed)return Promise.resolve();if(8===this.info.fieldType&&"rotation"!==e)return Promise.resolve();if("borderColor"===e){if(this.info.MKBorderColor==t)return Promise.resolve(!0);this.info.MKBorderColor=t}else{if(this.info[e]==t)return Promise.resolve(!0);this.info[e]=t}return this.updateMKProperty(e,t)}},{key:"_setMKProperty",value:function(e,t){switch(e){case"borderColor":if(this.info.MKBorderColor==t)break;this.info.MKBorderColor=t;break;default:if(this.info[e]==t)break;this.info[e]=t}}},{key:"getBorderColor",value:function(){return this.getMKProperty("borderColor")}},{key:"updateMKProperty",value:function(e,t){var n=this,i=this.page,r=i.getPDFDoc(),o={type:e,value:t};return this.page.doc.api.updateMKProperty(r.getId(),i.getId(),this.getId(),e,t).then((function(t){return n.triggerUpdateEvent(en.formFieldMKPropertyUpdated,e),n.updateUI(o),t}))}},{key:"triggerUpdateEvent",value:function(e,t){this.eventEmitter.emit(le.annotationUpdated,[this],this.getPDFPage(),e,t)}},{key:"updateUI",value:function(e){this.isDestroyed||this.render&&this.render(e)}},{key:"setRenderNotifier",value:function(e){this.render=e}},{key:"getAdditionalAction",value:function(e){if(-1==e)return this.action;var t=this.getField();if(e>=St.keyStroke&&e<=St.calculate)return t&&t.getAction(e);if(!this.engineActions)for(var n in this.engineActions={},this.info.AA)this.engineActions[n]=oo.createAction(this.info.AA[n],this.page.getPDFDoc());return this.engineActions[e]?this.engineActions[e]:t&&t.getAction(e)}},{key:"switchAS",value:function(){var e=this.getField(),t=e.getType();if(3==t&&"Off"!=this.info.ApState)return Promise.resolve();1==this.info.ApStates.length&&"Off"!=this.info.ApStates[0]&&(this.info.ApStates[1]="Off"),this.info.ApStates[0]==this.info.ApState?this.info.ApState=this.info.ApStates[1]:this.info.ApState=this.info.ApStates[0];var n=this.info.ApState;return 3!=t&&2!=t||"Off"==n||(n=this.formControl.getExportValue()),e.setValue(n,this)}},{key:"setAS",value:function(e,t){this._setAS(e,t);var n=this.page,i=n.getPDFDoc();return this.page.doc.api.setWidgetAS(i.getId(),n.getId(),this.getId(),this.info.ApState)}},{key:"_setAS",value:function(e,t){var n="Off",i=this.info.ApStates;if(3===this.getField().getType()){var r=this.getControl().getExportValue(),o=this.getOnAS();n=t==this.info.objectNumber?e==r||e==o?o:"Off":(!t||vn.inUnison(this.getField().getFlags()))&&(e==r||e==o)?o:"Off"}else{var a=this.getField().getControlById(t);(!t||t&&this.getControl().getExportValue()==a.getExportValue())&&(n="Off"!=e?i[1]:i[0])}this.info.ApState=n}},{key:"getWidgetMkOption",value:function(){var e=this.page,t=e.getPDFDoc();return e.doc.api.getWidgetMkOption(t.getId(),e.getId(),this.getId())}},{key:"setWidgetIconCaptionRelation",value:function(e){var t=this,n=this.page,i=n.getPDFDoc();return n.doc.api.setWidgetIconCaptionRelation(i.getId(),n.getId(),this.getId(),e).then((function(e){t.updateUI({})}))}},{key:"setWidgetHighlighting",value:function(e){var t=this,n=this.page,i=n.getPDFDoc();return n.doc.api.setWidgetHighlighting(i.getId(),n.getId(),this.getId(),e).then((function(e){t.updateUI({})}))}},{key:"setWidgetMkCaption",value:function(e,t){var n=this,i=this.page,r=i.getPDFDoc();return i.doc.api.setWidgetMkCaption(r.getId(),i.getId(),this.getId(),e,t).then((function(e){n.updateUI({})}))}},{key:"setWidgetMkIcon",value:function(e,t){var n=this,i=this.page,r=i.getPDFDoc();return i.doc.api.setWidgetMkIcon(r.getId(),i.getId(),this.getId(),e,t).then((function(e){n.updateUI({})}))}},{key:"getWidgetIconFitOption",value:function(){var e=this.page,t=e.getPDFDoc();return e.doc.api.getWidgetIconFitOption(t.getId(),e.getId(),this.getId())}},{key:"setWidgetIconFitOption",value:function(e){var t=this,n=this.page,i=n.getPDFDoc();return n.doc.api.setWidgetIconFitOption(i.getId(),n.getId(),this.getId(),e).then((function(e){t.updateUI({})}))}},{key:"getDAFontSize",value:function(){var e=this.getDefaultAppearance(),t=e&&e.textSize;return t||this.getField().getDAFontSize()}},{key:"getDirectionRTL",value:function(){return this.info.directionRTL}},{key:"setDirectionRTL",value:function(e){var t=this;if(void 0!==e&&0!==e&&1!==e)throw new Error("Unknown directionRTL: "+e);return this.updateMKProperty("directionRTL",e).then((function(){return t.update().then((function(){return t.getField().setAlignment(e?2:0)}))}))}},{key:"getLineSpace",value:function(){return this.info.lineSpace}},{key:"setLineSpace",value:function(e){var t=this;if(!(void 0===e||Array.isArray(e)&&2===e.length&&-1!==[0,1,2,3].indexOf(e[0])&&e[1]>=0))throw new Error("Unknown lineSpace: "+e);return this.updateMKProperty("lineSpace",e).then((function(){return t.update()}))}},{key:"getOnAS",value:function(){return"Off"!=this.info.ApStates[0]?this.info.ApStates[0]:this.info.ApStates[1]}},{key:"getAS",value:function(){return this.info.ApState}},{key:"getIconObjNum",value:function(e){switch(e){case 0:return this.info.normalIcon;case 1:return this.info.downIcon;case 2:return this.info.rollIcon}}},{key:"setIconObj",value:function(e,t){var n;switch(t){case 0:n="normalIcon",this.info.normalIcon=e;break;case 1:n="downIcon",this.info.downIcon=e;break;case 2:n="rolloverIcon",this.info.rollIcon=e}return this.updateMKProperty(n,e)}},{key:"setAdditionalAction",value:function(e,t){if("string"==typeof t){var n=new Yr;n.setScript(t),t=n}return e>=St.keyStroke&&e<=St.calculate?this.getField().setAction(e,t):this.setAction(e,t)}},{key:"setAction",value:function(e,t,n){var i=this;if(!t)throw new Error("No Action!");var r=this.page,o=r.doc;return this.engineActions||this.getAdditionalAction(11),this.page.doc.api.setAction(o.getId(),r.getId(),this.getId(),t.info,e,n).then((function(r){if(!i.page.doc)return r;t.init(r,i.page.doc.engine.actionFactory,o,i.page.doc.api,i.page.doc.engine.eventEmitter,i);var a=!1;return-1==e&&i.info.action&&(a=!0),-1!=e&&i.engineActions[e]&&(a=!0),n&&a?-1==e?i.action.appendSubAction(t):i.engineActions[e].appendSubAction(t):-1==e?(i.info.action=t.info,i.action=t):(i.info.AA[e]=t.info,i.engineActions[e]=t),n?(i.eventEmitter.emit(le.actionAdd,i),i.triggerUpdateEvent(en.addAction)):a?(i.eventEmitter.emit(le.actionUpdated,i),i.triggerUpdateEvent(en.formFieldActionUpdated)):(i.eventEmitter.emit(le.actionAdd,i),i.triggerUpdateEvent(en.addAction)),r}))}},{key:"removeAction",value:function(e,t){var n=this,i=this.getField(),r=0,o=0;t?(r=0,o=t.info.objNumber):delete i.info.AA[e],"-1"==e?(delete this.info.action,delete this.action):(delete this.info.AA[e],this.engineActions&&delete this.engineActions[e],i.engineActions&&delete i.engineActions);var a=this.page,s=a.doc;return s.api.removeAction(s.getId(),a.getId(),this.getId(),e,r,o).then((function(t){var r=t[0];r?"-1"==e?(n.info.action=r,n.action=oo.createAction(r,n.page.getPDFDoc())):(n.info.AA[e]=r,n.engineActions[e]=oo.createAction(r,n.page.getPDFDoc())):delete i.info.AA[e],t[1]&&(i.info.AA[e]=t[1]),n.triggerUpdateEvent(en.formFieldActionUpdated)}))}},{key:"moveAction",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.moveAction(i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(en.moveAction).then((function(e){t.updateAdditionalAction()}))}))}},{key:"updateAdditionalAction",value:function(){for(var e in this.engineActions={},this.info.AA)this.engineActions[e]=oo.createAction(this.info.AA[e],this.page.getPDFDoc())}},{key:"getDAFontColor",value:function(){var e=this.getDefaultAppearance(),t=e&&e.textColor;return t||this.getField().getDAFontColor()}},{key:"getAlignment",value:function(){return void 0!==this.info.alignment?this.info.alignment:this.getField().getAlignment()}},{key:"getDefaultAppearance",value:function(){return this.formControl||this.mapFormControl(),this.formControl&&this.formControl.getDefaultAppearance()}},{key:"setDefaultAppearance",value:function(e){return this.formControl||this.mapFormControl(),this.formControl&&this.formControl.setDefaultAppearance(e)}},{key:"_update",value:function(e){return this.engineActions=null,(0,S._)((0,x._)(n.prototype),"_update",this).call(this,e)}},{key:"getTextSearch",value:function(e,t){var n=this,i=this.page,r=i.doc;return this.page.doc.api.getAnnotTextSearch(r.getId(),i.getId(),this.getId(),e,t).then((function(e){return new co(e,n)}))}}]),n}(ln);const ho=lo;var fo=function(){function e(t,n,i){(0,P._)(this,e),this.pageRender=t,this.pdfDoc=t.getPDFDoc(),this.pdfArticle=this.pdfDoc.pdfArticle,this.pdfPage=t.page,this.pdfViewer=t.pdfViewer,this.$container=t.$customsContainer,this.articleInfo=n,this.articleBeadInfo=i,this.$dom=null,this.render()}return(0,A._)(e,[{key:"render",value:function(){this.createDom()}},{key:"updateRender",value:function(e,t){e&&(this.articleInfo=e),t&&(this.articleBeadInfo=t);var n=this.getDeviceRect(),i=n.left,r=n.top,o=n.right-i,a=n.bottom-r;this.$dom.css({width:o+"px",height:a+"px",top:r+"px",left:i+"px"})}},{key:"read",value:function(){var e=this,t="fv__article-read";this.$dom.addClass(t),setTimeout((function(){e.$dom.removeClass(t)}),500);var n=this.articleBeadInfo,i=n.rect,r=n.pageIndex,o=this.pdfViewer;return o.zoomTo(2).then((function(){return o.goToPage(r,i.top,i.left)}))}},{key:"getDeviceRect",value:function(){var e=this.articleBeadInfo.rect,t=this.pageRender,n=t.getScale(),i=t.getRotation();return this.pdfPage.getDeviceRect(e,n,i)}},{key:"createDom",value:function(){var e=this.getDeviceRect(),t=e.left,n=e.top,i=e.right,r=e.bottom;this.$dom=O()('<div style="position:absolute;width:'+(i-t)+"px;height:"+(r-n)+"px;left:"+t+"px;top:"+n+'px;z-index:26;"></div>'),this.$container.append(this.$dom)}},{key:"destroy",value:function(){this.articleBeadInfo=null,this.$dom.remove(),this.$dom=null,this.pdfDoc=null,this.pdfArticle=null}}]),e}();const go=fo;const vo={PageOpened:0,PageClosed:1,DocWillClose:2,DocWillSave:3,DocSaved:4,DocWillPrint:5,DocPrinted:6,FieldKeyStroke:7,FieldWillFormat:8,FieldValueChanged:9,FieldRecalculateValue:10,AnnotCursorEnter:11,AnnotCursorExit:12,AnnotMouseButtonPressed:13,AnnotMouseButtonReleased:14,AnnotReceiveInputFocus:15,AnnotLoseInputFocus:16,AnnotPageOpened:17,AnnotPageClosed:18,AnnotPageVisible:19,AnnotPageInvisible:20};var po="zIndexContextMenu";const mo=function(){function e(t){(0,P._)(this,e),this.flag=t}return(0,A._)(e,[{key:"getValue",value:function(){return this.flag}},{key:"checkInvisible",value:function(){return(this.flag&tn.invisible)===tn.invisible}},{key:"checkHidden",value:function(){return(this.flag&tn.hidden)===tn.hidden}},{key:"checkPrint",value:function(){return(this.flag&tn.print)===tn.print}},{key:"checkNoZoom",value:function(){return(this.flag&tn.noZoom)===tn.noZoom}},{key:"checkNoRotate",value:function(){return(this.flag&tn.noRotate)===tn.noRotate}},{key:"checkNoView",value:function(){return(this.flag&tn.noView)===tn.noView}},{key:"checkReadOnly",value:function(){return(this.flag&tn.readOnly)===tn.readOnly}},{key:"checkLocked",value:function(){return(this.flag&tn.locked)===tn.locked}},{key:"checkToggleNoView",value:function(){return(this.flag&tn.toggleNoView)===tn.toggleNoView}},{key:"checkLockedContents",value:function(){return(this.flag&tn.lockedContents)===tn.lockedContents}},{key:"check",value:function(e){return(this.flag&e)===e}},{key:"or",value:function(e){return this.flag=this.flag|e,this}}]),e}();var yo,ko,bo,wo,_o,Po,Ao;!function(e){e.CREATE_ANNOT="create-annots",e.REMOVE_ANNOT="remove-annots",e.UPDATE_ANNOT="update-annots",e.ADD_REPLY="add-reply",e.REMOVE_REPLY="remove-reply",e.ADD_REVIEW_STATE="add-review-state",e.ADD_MARKED_STATE="add-marked-state",e.UPDATE_ANNOT_CONTENT="update-comment-content",e.PPO_REMOVE_PAGE="ppo-remove-page",e.PPO_REMOVE_PAGES="ppo-remove-pages",e.PPO_INSERT_PAGE="ppo-insert-page",e.PPO_ROTATE_PAGE="ppo-rotate-page",e.PPO_MOVE_PAGE="ppo-move-page",e.MOVE_ANNOTS_BETWEEN_PAGES="move-annotations-between-pages",e.IMPORT_ANNOTATIONS_FILE="import-annotations-file"}(yo||(yo={})),function(e){e.SELECT_ALL="builtin-command-select-all-annotations",e.CREATION_UNDO_LAST="builtin-command-creation-undo-last",e.DELETE_SELECTED_OBJECT="builtin-command-delete-selected-object",e.DELETE_SELECTED_ANNOT_MAC="builtin-command-delete-selected-annot-mac",e.UNSELECT_OBJECT="builtin-command-unselect-object",e.UNDO_OPERATION="builtin-command-undo",e.REDO_OPERATION="builtin-command-redo",e.CANCEL_CREATING_ANNOTATION_OPERATION="builtin-command-cancel-creating-annotation",e.CLOSE_LAYER="builtin-command-close-closable-layer",e.ARROW_UP="builtin-command-arrow-up",e.ARROW_DOWN="builtin-command-arrow-down",e.ARROW_LEFT="builtin-command-arrow-left",e.ARROW_RIGHT="builtin-command-arrow-right",e.SWITCH_TO_HAND_STATE="builtin-command-switch-hand-state",e.COPY_ACTIVATE_ELEMENT="builtin-command-copy-activate-element",e.CUT_ACTIVATE_ELEMENT="builtin-command-cut-activate-element",e.ADD_BOOKMARK="builtin-command-add-bookmark",e.COPY_TEXT_IMAGE="builtin-command-copy-text-image",e.BLUR_EDITTING_TEXT_OBJECT="builtin-command-blur-editting-text-object",e.ALIGNMENT_REDUCE_WIDTH="builtin-command-alignment-reduce-width",e.ALIGNMENT_RAISE_WIDTH="builtin-command-alignment-raise-width",e.ALIGNMENT_REDUCE_HEIGHT="builtin-command-alignment-reduce-height",e.ALIGNMENT_RAISE_HEIGHT="builtin-command-alignment-raise-height",e.ALIGNMENT_REDUCE_STEP_WIDTH="builtin-command-alignment-reduce-step-width",e.ALIGNMENT_RAISE_STEP_WIDTH="builtin-command-alignment-raise-step-width",e.ALIGNMENT_REDUCE_STEP_HEIGHT="builtin-command-alignment-reduce-step-height",e.ALIGNMENT_RAISE_STEP_HEIGHT="builtin-command-alignment-raise-step-height",e.TAB_NEXT_OPERATION="builtin-command-tab-next",e.TAB_PREVIOUS_OPERATION="builtin-command-tab-previous",e.DELETE_ATTACHMENT="builtin-command-delete-attachment",e.JUMP_TO_NEXT_PAGE="builtin-command-jump-to-next-page",e.JUMP_TO_PREVIOUS_PAGE="builtin-command-jump-to-previsous-page",e.JUMP_TO_FIRST_PAGE="builtin-command-jump-to-first-page",e.JUMP_TO_LAST_PAGE="builtin-command-jump-to-last-page",e.SCROLL_TO_NEXT_VISIBLE_AREA="builtin-command-scroll-to-next-visible-area",e.SCROLL_TO_PREVIOUS_VISIBLE_AREA="builtin-command-scroll-to-previous-visible-area",e.SCROLL_VIEWER_SCROLLBAR_LEFT="builtin-command-scroll-viewer-scrollbar-left",e.SCROLL_VIEWER_SCROLLBAR_RIGHT="builtin-command-scroll-viewer-scrollbar-right",e.SCROLL_VIEWER_SCROLLBAR_UP="builtin-command-scroll-viewer-scrollbar-up",e.SCROLL_VIEWER_SCROLLBAR_DOWN="builtin-command-scroll-viewer-scrollbar-down"}(ko||(ko={})),function(e){e.GLOBAL="builtin-shortcut-context-global",e.SELECTION="builtin-shortcut-context-selection",e.BASIC_STATE_HANDLER="builtin-shortcut-context-state-hander",e.ANNOTATION_PROPERTIES="builtin-shortcut-context-annot-properties",e.ACTIVATION_ANY="builtin-shortcut-context-activation-any",e.ACTIVATION_ANNOTATION="builtin-shortcut-context-activation-annot",e.ACTIVATION_WIDGET="builtin-shortcut-context-activation-widget",e.ACTIVATION_GRAPH_OBJ="builtin-shortcut-context-activation-graph_obj",e.VIEWER="builtin-shortcut-context-viewer",e.CREATING_ANNOTATION="builtin-shortcut-context-creating-annotation",e.CLOSABLE_LAYER="builtin-shortcut-context-closable-layer",e.EDIT_TEXT_OBJECT="builtin-shortcut-context-edit-text-object"}(bo||(bo={}));const So=[{context:"builtin-shortcut-context-global",topLayers:[],extends:[],shortcuts:{}},{context:"builtin-shortcut-context-closable-layer",topLayers:["builtin-shortcut-context-global"],extends:[],shortcuts:(0,J._)({},"builtin-command-close-closable-layer","Escape")},{context:"builtin-shortcut-context-viewer",topLayers:["builtin-shortcut-context-global"],extends:[],shortcuts:(wo={},(0,J._)(wo,"builtin-command-undo","Mod+Z"),(0,J._)(wo,"builtin-command-redo","Mod+Y"),(0,J._)(wo,"builtin-command-add-bookmark","Mod+B"),(0,J._)(wo,"builtin-command-delete-attachment","Delete"),(0,J._)(wo,"builtin-command-jump-to-previsous-page","LeftArrow"),(0,J._)(wo,"builtin-command-jump-to-next-page","RightArrow"),(0,J._)(wo,"builtin-command-arrow-up","UpArrow"),(0,J._)(wo,"builtin-command-arrow-down","DownArrow"),(0,J._)(wo,"builtin-command-jump-to-first-page","Home"),(0,J._)(wo,"builtin-command-jump-to-last-page","End"),(0,J._)(wo,"builtin-command-scroll-to-next-visible-area","PageDown"),(0,J._)(wo,"builtin-command-scroll-to-previous-visible-area","PageUp"),(0,J._)(wo,"builtin-command-scroll-viewer-scrollbar-left","Shift+LeftArrow"),(0,J._)(wo,"builtin-command-scroll-viewer-scrollbar-right","Shift+RightArrow"),(0,J._)(wo,"builtin-command-scroll-viewer-scrollbar-up","Shift+UpArrow"),(0,J._)(wo,"builtin-command-scroll-viewer-scrollbar-down","Shift+DownArrow"),wo)},{context:"builtin-shortcut-context-edit-text-object",topLayers:["builtin-shortcut-context-global"],extends:[],shortcuts:(0,J._)({},"builtin-command-blur-editting-text-object","Escape")},{context:"builtin-shortcut-context-creating-annotation",topLayers:["builtin-shortcut-context-viewer"],extends:[],shortcuts:(0,J._)({},"builtin-command-cancel-creating-annotation","Escape")},{context:"builtin-shortcut-context-selection",topLayers:[],extends:[],shortcuts:(0,J._)({},"builtin-command-select-all-annotations","Mod+A")},{context:"builtin-shortcut-context-activation-any",topLayers:["builtin-shortcut-context-viewer"],extends:["builtin-shortcut-context-selection"],shortcuts:(_o={},(0,J._)(_o,"builtin-command-delete-selected-object","Delete"),(0,J._)(_o,"builtin-command-delete-selected-annot-mac","Mod+Backspace"),(0,J._)(_o,"builtin-command-unselect-object","Escape"),(0,J._)(_o,"builtin-command-copy-activate-element","Mod+C"),(0,J._)(_o,"builtin-command-cut-activate-element","Mod+X"),_o)},{context:"builtin-shortcut-context-activation-annot",topLayers:["builtin-shortcut-context-viewer"],extends:["builtin-shortcut-context-activation-any"],shortcuts:{}},{context:"builtin-shortcut-context-activation-widget",topLayers:["builtin-shortcut-context-viewer"],extends:["builtin-shortcut-context-activation-any"],shortcuts:(Po={},(0,J._)(Po,"builtin-command-alignment-reduce-width","Mod+LeftArrow"),(0,J._)(Po,"builtin-command-alignment-raise-width","Mod+RightArrow"),(0,J._)(Po,"builtin-command-alignment-reduce-height","Mod+UpArrow"),(0,J._)(Po,"builtin-command-alignment-raise-height","Mod+DownArrow"),(0,J._)(Po,"builtin-command-alignment-reduce-step-width","Mod+Shift+LeftArrow"),(0,J._)(Po,"builtin-command-alignment-raise-step-width","Mod+Shift+RightArrow"),(0,J._)(Po,"builtin-command-alignment-reduce-step-height","Mod+Shift+UpArrow"),(0,J._)(Po,"builtin-command-alignment-raise-step-height","Mod+Shift+DownArrow"),Po)},{context:"builtin-shortcut-context-activation-graph_obj",topLayers:["builtin-shortcut-context-viewer"],extends:["builtin-shortcut-context-activation-any"],shortcuts:{}},{context:"builtin-shortcut-context-state-hander",topLayers:["builtin-shortcut-context-viewer"],extends:[],shortcuts:(0,J._)({},"builtin-command-switch-hand-state","Escape")},{context:Yn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:mn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:Sn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Wn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:qn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Un,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Vn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:kn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Qn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:ei,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:ti,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Bn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Pn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:En,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:bn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Ln,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Nn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:On,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:wn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Mn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Hn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:In,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Rn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Tn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Fn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:An,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:xn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Dn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"create-multi-media-state",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"create-redaction-text-state",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"create-redaction-state",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreatePushButtonStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateCheckBoxStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateRadioButtonStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateComboBoxStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateListBoxStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateTextStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateSignStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateDateStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:"CreateImageStateHandler",topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:yn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:Cn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:Kn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:$n,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:zn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:Gn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:Jn,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:(Ao={},(0,J._)(Ao,"builtin-command-copy-text-image","Mod+C"),(0,J._)(Ao,"builtin-command-add-bookmark","Mod+B"),(0,J._)(Ao,"builtin-command-select-all-annotations","Mod+A"),Ao)},{context:Zn,topLayers:["builtin-shortcut-context-state-hander"],extends:["builtin-shortcut-context-selection"],shortcuts:{}},{context:ni,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:oi,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:ai,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:si,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}},{context:ui,topLayers:["builtin-shortcut-context-state-hander"],extends:[],shortcuts:{}}];var xo="undefined"!=typeof PointerEvent,Co=j.isIE10?"MSPointerDown":xo?"pointerdown":"mousedown",Do=j.isIE10?"MSPointerDown":"pointerdown",Eo="add",Io="minus",Ro=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,o)).hasFocus=!1,a.docRender=a.parent("pdfDocRender"),a.name="annot",a.eUi=i,a.element=i;var s=a.$ui=O()(i);if(s.addClass("fv__pdf-page-annot-container").data(po,(0,w._)(a)),s.attr("objectNumber",e.objectNumber),a.eHandler=r,(a.$handler=O()(r)).addClass("fv__pdf-page-annot-handler-container"),a.$page=o.$page,a.annot=e,a.$$isUIVisible=!0,s.data("component",(0,w._)(a)),a.deleteStatus=0,a.annotsRender=o.parent("annotsRender"),a.eventHandlers=[],a.mouseEnterAnnots=[],!a.pdfViewer.getCurrentPDFDoc().isDynamicXFA()&&(a.bindDoubleTab(),j.isIOS)){var u=function(e){return e.preventDefault()};i.addEventListener("touchstart",u),a.addDestroyHook((function(){i.removeEventListener("touchstart",u)}))}var c=function(){a.isDestroyed||a.annot.isDestroyed||a.getAppPermission().then((function(e){a.updateOnPermissionChange(e)}))},l=function(){a.isDestroyed||a.annot.isDestroyed||a.removed||a.isActive&&a.mouseLeave()},d=function(){a.removed=!0},h=a.pdfViewer.eventEmitter;return h.on(de.permissionChanged,c),h.on(de.globalAnnotFlagChanged,c),h.on(de.activeElementChanged,l),h.on(de.annotationRemoved,d),a.addDestroyHook((function(){h.off(de.permissionChanged,c),h.off(de.globalAnnotFlagChanged,c),h.off(de.activeElementChanged,l),h.off(de.annotationRemoved,d)})),a}return(0,A._)(n,[{key:"id",get:function(){return this.annot?this.annot.getId():void 0}},{key:"getAppPermission",value:function(){return this.pdfViewer.getAnnotAuthorityManager().getPermission(this.annot)}},{key:"initMouseEvent",value:function(){var e=this,t=this.pdfViewer.eventEmitter,n=this.getContainerElement();n.addEventListener("mouseenter",a),n.addEventListener("mousemove",(function(e){if(!o)return;var t=u(e);if(t.length===r.length)return;var n=[],a=Eo;t.length>r.length?n=t.filter((function(e){return!r.some((function(t){return t.getId()===e.getId()}))})):(n=r.filter((function(e){return!t.some((function(t){return t.getId()===e.getId()}))})),a=Io);n.length&&(i.mouseMove&&i.mouseMove(n,a),r=t)})),n.addEventListener("mouseleave",s),this.addDestroyHook((function(){n.removeEventListener("mouseenter",a),n.removeEventListener("mouseleave",s)}));var i=this,r=[],o=!1;function a(e){r=i.mouseEnterAnnots=u(e),t.emit(de.mouseEnter,hi.annotation,{annots:i.mouseEnterAnnots,e}),i.mouseEnter&&i.mouseEnter(hi.annotation,{annots:i.mouseEnterAnnots,e}),o=i.needToggleView()}function s(e){r=[],t.emit(de.mouseLeave,hi.annotation,{annots:i.mouseEnterAnnots,e}),i.mouseLeave&&i.mouseLeave(hi.annotation,{annots:i.mouseEnterAnnots,e})}var u=function(t){var n=e.annotsRender.getAnnotRenders(),i=Object.keys(n).map((function(e){return n[e]})),r=t.clientX,o=t.clientY,a=[];return i.forEach((function(t){if(!e.annotsRender._isFormWidget(t)&&!e.annotsRender._isFormWatermark(t)){var n=t.component.$ui.get(0).getBoundingClientRect();r>=n.left&&r<=n.right&&o>=n.top&&o<=n.bottom&&a.push(t.annot)}})),a}}},{key:"initPointerDownEvent",value:function(){var e=this,t=this.pdfViewer.getEventEmitter(),n=function(n){var i=function(e){var i=e.component,r=i.shapeControl,o=!!r&&r.isActive;return t.emit(de.tapAnnotation,e,n),Promise.resolve(i.tapAnnot(n)).then((function(){o||i.triggerPointerDownOnShapeControl(n)}))};if(1===n.which&&!n.isManual&&!["fv__shape-control-text-area","fv__shape-control-move-area","fv__shape-controller","fv-shape-rotate-handle"].some((function(e){return O()(n.target).hasClass(e)}))){var r=e.parent("pdfPageRender"),o=(0,E._)(r.getPDFPointFromClientPoint(n.clientX,n.clientY,!0),2),a=o[0],s=o[1],u=e.parent();return r.getPDFPage().then((function(e){var t=r.scale,n=r.rotate,i=e.getDeviceMatrix();return i.scale(t,t),i.rotate(n),e.getAnnotObjectNumAtDevicePoint([a,s],1,[i.a,i.b,i.c,i.d,i.e,i.f])})).then((function(t){var n=e.annotsRender.getAnnotRender(t);if(n&&n!==u)if("watermark"===n.annot.getType())i(u);else i(n);else i(u)})),!1}};this.eUi.addEventListener(Co,n),this.eHandler.addEventListener(Co,n),this.addDestroyHook((function(){e.eHandler.removeEventListener(Co,n),e.eUi.removeEventListener(Co,n)}))}},{key:"triggerPointerDownOnShapeControl",value:function(e){var t,n=this.eHandler.querySelector(".fv__shape-control-move-area");n&&("function"!=typeof PointerEvent||(0,D._)(e,MouseEvent)?((t=document.createEvent("MouseEvent")).initMouseEvent(Do,e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,null),t.pointerId=e.pointerId):t=new PointerEvent("pointerdown",e),t.isManual=!0,n.dispatchEvent(t),n.dispatchEvent(t))}},{key:"getContainerElement",value:function(){return this.$ui.get(0)}},{key:"getHandlerElement",value:function(){return this.$handler.get(0)}},{key:"getModel",value:function(){return this.annot}},{key:"tapAnnot",value:function(){var e=this,t=this.getModel().getId();return this.pdfViewer.isMultiSelectActive()&&this.pdfViewer.getAllActivatedElements().find((function(t){return t===e}))&&!j.keyboardStatus.isShiftDown?this.annotsRender.unActiveAnnot(t):this.annotsRender.activeAnnot(t)}},{key:"getId",value:function(){return this.id}},{key:"getIndex",value:function(){return this.annot.getIndex()}},{key:"setId",value:function(e){var t=this;return this.annot.setUniqueID(e).then((function(){t.id=e}))}},{key:"isHidden",value:function(){var e=this.getAnnotFlag();return!!(e.checkHidden()||e.checkNoView()&&!e.checkToggleNoView())}},{key:"_hideUI",value:function(){this.$ui[0].classList.add("fv__ui-hide"),this.$handler[0].classList.add("fv__ui-hide")}},{key:"_showUI",value:function(){this.$ui[0].classList.remove("fv__ui-hide"),this.$handler[0].classList.remove("fv__ui-hide")}},{key:"hideUI",value:function(){return this.isUIVisible()?(this.isActive&&this.annotsRender.unActiveAnnot(this.annot),this.$$isUIVisible=!1,this._hideUI(),Promise.resolve()):Promise.resolve()}},{key:"updateSize",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;if(this.scale=t,this.rotate=n,e=this.annot.getDeviceRect(this.scale,this.rotate),8&this.annot.getFlags()){var i=this.annot.getRect();i.top-i.bottom,i.right-i.left}else e.bottom-e.top,e.right-e.left}},{key:"showUI",value:function(){var e=this;return this.isUIVisible()?Promise.resolve():(this.$$isUIVisible=!0,this._showUI(),Promise.resolve(this.redraw()).then((function(){e.pdfViewer.getAnnotAuthorityManager().update(e.annot)})))}},{key:"isUIVisible",value:function(){return this.$$isUIVisible}},{key:"render",value:function(e,t){return this.scale=e,this.rotate=t,Promise.resolve()}},{key:"afterRender",value:function(){if(!this.isDestroyed){var e=this.annot.getType();j.isDesktop&&this.pdfViewer.config.showFormFieldTooltip&&"widget"===e&&this.bindAnnotMouseEvents()}}},{key:"add",value:function(e,t){return this.render(e,t)}},{key:"redraw",value:function(){}},{key:"willRedraw",value:function(){}},{key:"afterRedraw",value:function(){}},{key:"doActive",value:function(){var e=this;if(this.bindEvent(),!this.pdfViewer.activationManager.currentActivableIs(this)){var t=this.annot;if(t.isGrouped&&t.isGrouped()){var n=new Z;t.groupElements.forEach((function(t){var i=e.pdfViewer.getAnnotRender(t.getPDFPage().getIndex(),t.getId()).component;n.add(i)})),this.pdfViewer.activeElement(n)}else this.pdfViewer.activeElement(this)}}},{key:"doDeactive",value:function(){this.unBindEvent()}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this)}},{key:"destroy",value:function(){this.isActive=!1,this.$ui&&this.$ui.remove(),this.$handler&&this.$handler.remove(),this.unBindEvent(),this.eventHandlers=[],(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.annot=null,this.component=null,this.docRender=null,this.$ui=null,this.eHandler=null,this.$handler=null,this.$page=null,this.annotsRender=null}},{key:"remove",value:function(){this.destroy()}},{key:"showContextMenu",value:function(){}},{key:"enableContextMenu",value:function(e){this._disabledContextMenu=!e}},{key:"contextMenuIsEnable",value:function(){return!this._disabledContextMenu}},{key:"zIndexDown",value:function(){this.$ui.addClass("fv__zindex-down"),this.zIndexDownFlag=!0}},{key:"checkZIndexDown",value:function(){return!this.zIndexDownFlag}},{key:"zIndexRecover",value:function(){this.$ui.removeClass("fv__zindex-down"),this.zIndexDownFlag=!1}},{key:"moveTo",value:function(e,t,n){var i,r=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(!(!(arguments.length>3&&void 0!==arguments[3])||arguments[3]))return this.$ui.css({left:e,top:t}),Promise.resolve(!0);if(o)i={left:e,top:t,action:n,triggerAction:a};else{var s=this.scale,u=this.rotate,c=this.getPDFPage(),l=this.annot.getDeviceRect(s,u),d=e-l.left,h=t-l.top;if("freetext"!==this.annot.getType()&&Math.abs(d)<1&&Math.abs(h)<1)return Promise.resolve();var f=(0,E._)(c.reverseDeviceOffset([d,h],s,u),2),g=f[0],v=f[1],p=this.annot.getRect();i={left:p.left+g,top:p.top+v,action:n,triggerAction:a}}return this.annot.moveTo(i).then((function(e){return r.updateRender&&r.updateRender().then((function(){r.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,r)}))}))}},{key:"move",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.annot.getDeviceRect(this.scale,this.rotate);return this.moveTo(i.left+e,i.top+t,n)}},{key:"moved",value:function(){var e=this.annot.getDeviceRect(this.scale,this.rotate);this.$ui.css({left:e.left+"px",top:e.top+"px"}),this.activeRect()}},{key:"movedByOther",value:function(e){}},{key:"setRectInPDF",value:function(e,t){var n=this;return this.annot._setRect(e,t).then((function(e){return e?n.updateRender().then((function(){return t&&n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n),e})):e}))}},{key:"_setRect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=t.top,r=t.width,o=t.height,a=arguments.length>1?arguments[1]:void 0;r=Math.max(.001,r),o=Math.max(.001,o);var s=this.scale,u=this.rotate,c=this.getPDFPage().reverseDeviceRect({left:n,top:i,right:n+r,bottom:i+o},s,u);return this.annot._setRect(c,a).then((function(t){return t?e.updateRender().then((function(){return e.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,e),t})):t}))}},{key:"setRect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=t.top,r=t.width,o=t.height;r=Math.max(.001,r),o=Math.max(.001,o);var a=this.scale,s=this.rotate,u=this.getPDFPage().reverseDeviceRect({left:n,top:i,right:n+r,bottom:i+o},a,s);return this.annot.setRect(u).then((function(t){return t&&e.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,e),t}))}},{key:"getRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.getPDFPage(),i=this.annot.getRect();return n.getDeviceRect(i,e,t)}},{key:"getBoundary",value:function(){var e=this.annot.getDeviceRect(this.scale,this.rotate),t=this.annot.getRect(),n=e.right-e.left,i=e.bottom-e.top;return 8&this.annot.getFlags()&&(n=t.right-t.left,i=t.top-t.bottom),{left:e.left,top:e.top,width:n,height:i}}},{key:"getPosition",value:function(){var e=this.getPDFPage(),t=this.annot.getRect(),n=(0,E._)(e.getDevicePoint([t.left,t.top],this.scale,this.rotate),2);return{left:n[0],top:n[1]}}},{key:"getDimension",value:function(){var e=this.getPDFPage(),t=this.annot.getRect(),n=e.getDeviceRect(t,this.scale,this.rotate);return{width:n.right-n.left,height:n.bottom-n.top}}},{key:"removeAnnot",value:function(){var e=this;return this.getAppPermission().then((function(t){if(t.ignorable()&&e.getAnnotFlag().checkLocked())throw new Error("The remove operation was rejected because it is locked!");if(t.isDeletable())return e.doRemoveAnnot()}))}},{key:"doRemoveAnnot",value:function(){}},{key:"deleteDisabled",value:function(){if(!(32&this.docRender.getUserPermission().getValue()))return!0;var e=this.getAnnotFlag();return e.checkLocked()||e.checkReadOnly()}},{key:"replyDisabled",value:function(){return!(32&this.docRender.getUserPermission().getValue())||(!this.annot.getContent()||"sound"===this.annot.getType())}},{key:"propertyDisabled",value:function(){if(!(32&this.docRender.getUserPermission().getValue()))return!0;var e=this.getAnnotFlag();return e.checkLocked()||e.checkReadOnly()}},{key:"moveDisabled",value:function(){if(!(32&this.docRender.getUserPermission().getValue()))return!0;var e=this.getAnnotFlag();return e.checkLocked()||e.checkReadOnly()}},{key:"readOnlyDisabled",value:function(){return!(32&this.docRender.getUserPermission().getValue())||this.getAnnotFlag().checkReadOnly()}},{key:"isLocked",value:function(){return this.getAnnotFlag().checkLocked()}},{key:"bindEvent",value:function(){var e=this;this.pdfViewer&&this.pdfViewer.getKeyboard().withContext(bo.ACTIVATION_ANY,(function(t){if(!e.isDestroyed){e.__off__delete__event__&&e.__off__delete__event__();var n=ko.DELETE_SELECTED_OBJECT;0,e.__off__delete__event__=t.keyup(n,(function(t){!1!==e.isActive&&(e.removeAnnot(),t.stopPropagation())}),{interceptors:[(0,j.excludeEditableElementInterceptor)(),function(t,n){var i=e.pdfViewer.getStore().getCurrentValue(j.MODULE_LICENSE_INFO);if(e.annot){var r=e.annot.getType(),o=!0;"redact"==r&&(o=Object.keys(i).find((function(e){return e.startsWith(r)?i[e]:""._}))),o?n(t):e.pdfViewer.viewerUI.alert("dialog.error.noRedactionLicense")}}]})}}))}},{key:"unBindEvent",value:function(){this.__off__delete__event__&&this.__off__delete__event__(),this.__off__delete__event__=qi}},{key:"updateDeleteStatus",value:function(e){e?++this.deleteStatus:--this.deleteStatus,this.deleteStatus>0?this.unBindEvent():this.bindEvent()}},{key:"getPDFAnnot",value:function(){return this.annot}},{key:"getPDFPage",value:function(){return this.getPDFAnnot().getPDFPage()}},{key:"getAnnotFlag",value:function(){return this.pdfViewer.annotManager.getAnnotFlag(this.annot)}},{key:"groupMoveDisabled",value:function(){var e=!1;return this.annot&&this.annot.isGrouped&&this.annot.isGrouped()&&this.annot.groupElements.map((function(t){var n=t.getType();"strikeout"!==n&&"highlight"!==n&&"squiggly"!==n&&"underline"!==n||(e=!0)})),e}},{key:"setVisibleRect",value:function(e){this.visibleRect=e}},{key:"invisibleRender",value:function(){}},{key:"clearCache",value:function(){}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;if(!this.annot)return null;var n=this.annot.getDeviceRect(e,this.rotate),i=this.getRect(),r=this.annot.page,o=this.pdfViewer.getSmartScale(e);return{annotInfo:this.annot.info,annotFlag:this.getAnnotFlag(),smartScale:o,rect:i,outerDeviceRect:n,innerDeviceRect:this.annot.getInnerRect?this.annot.getDeviceInnerRect(e,t):n,engineRenderingRect:r.getDeviceRect(i,o,t),scale:e,rotate:t,page:this.annot.page}}},{key:"toImageURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}},t=this.annot.page,n=this.pdfViewer.getSmartScale(this.scale),i=this.annot.getDeviceRect(1,this.rotate);return t.getAnnotBitmap(this.annot.objectNumber,(0,U.F2)(n),this.rotate,e(i,this,this.scale,this.rotate),!0).then((function(e){var t=e.width,n=e.height,i=e.buffer,r=(e.image,e.type,e.url),o=document.createElement("canvas");o.width=t,o.height=n;var a=o.getContext("2d");if(r)return new Promise((function(e){var t=new Image;t.onload=function(){a.drawImage(t,0,0),e(o.toDataURL())},t.src=r}));var s=new(Uint8ClampedArray||Uint8Array)(i),u=a.createImageData(t,n);return u.data.set(s),a.putImageData(u,0,0),o.toDataURL()}))}},{key:"activeTooltip",value:function(e){}},{key:"bindAnnotMouseEvents",value:function(){var e=this;if("widget"==this.annot.getType()){var t,n=this.annot.isGrouped&&this.annot.isGrouped()?this.annot.getGroupHeader():this.annot,i=this.eHandler;i.addEventListener("mousemove",this.mouseEnterListener=function(i){(e.pdfViewer.config.showAnnotTooltip&&"widget"!==n.getType()||e.pdfViewer.config.showFormFieldTooltip&&"widget"===n.getType())&&(t=e.pdfViewer.customs.AnnotTooltip?new e.pdfViewer.customs.AnnotTooltip(e.pdfViewer,n):new fi(n)).show(i.clientX,i.clientY)}),i.addEventListener("mouseout",this.mouseLeaveListener=function(e){t&&t.hide()}),this.addDestroyHook((function(){i.removeEventListener("mousemove",e.mouseEnterListener),i.removeEventListener("mouseout",e.mouseLeaveListener)}))}}},{key:"collaborate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yo.UPDATE_ANNOT;if(this.pdfViewer.customs.isCollaborationMode&&this.pdfViewer.customs.isCollaborationMode())return e===yo.UPDATE_ANNOT?this.pdfViewer.collaborate(e,{annots:[this.annot.exportToJSON()]}):void 0}},{key:"getPropertyOptions",value:function(){return{}}},{key:"isFormControl",value:function(){return!1}},{key:"updateOnPermissionChange",value:function(e){if(!this.isDestroyed&&j.Lazy.isPropertyIntialized(this,"shapeControl")){var t=!1;t=!!this.groupMoveDisabled()||(e.ignorable()?this.moveDisabled():this.moveDisabled()||!e.isAdjustable());var n=this.shapeControl;t?n.disable():n.enable()}}},{key:"bindDoubleTab",value:function(){var e=this,t=function(t){e.pdfViewer.eventEmitter.emit(de.doubleTapAnnotation,e.parent(),t),e.annotsRender.doubleTapAnnot(e.annot.id)};if(j.isTouchDevice&&(j.isSafari||j.isChrome)){var n=(0,j.onTap)({target:this.$handler[0],onDoubleTap:function(e){t(e)}});this.addDestroyHook(n)}else{var i=new Hammer.Manager(this.$handler[0]);i.add(new Hammer.Tap({event:"doubletap",taps:2})),i.add(new Hammer.Tap({event:"singletap"})),i.get("doubletap").recognizeWith("singletap"),i.get("singletap").requireFailure("doubletap"),i.on("doubletap",(function(e){t(e)})),this.addDestroyHook((function(e){return i.destroy()}))}}},{key:"needToggleView",value:function(){if(this.isDestroyed||!this.annot)return!1;var e=this.getAnnotFlag();return!(!e.checkToggleNoView()||e.checkHidden())}},{key:"shouldRenderByMouseEvent",value:function(){var e=this.getAnnotFlag();return this.renderAppearanceType===Ue.ROLLOVER?e.checkNoView():!e.checkNoView()}},{key:"mouseEnter",value:function(){this.needToggleView()&&(this.renderAppearanceType=Ue.ROLLOVER,this.redraw(!0))}},{key:"mouseLeave",value:function(){this.needToggleView()&&this.pdfViewer.currentPDFDoc&&(this.renderAppearanceType=Ue.NORMAL,this.redraw(!0))}},{key:"mouseMove",value:function(e,t){var n=this;e.forEach((function(e){var i=n.annotsRender._finAnnotRenderById(e.getId());if(i){var r=i.component;r.renderAppearanceType=t===Eo?Ue.ROLLOVER:Ue.NORMAL,r.redraw(!0)}}))}}]),n}(te);const To=Ro;var Fo=g(5779),Mo=g.n(Fo),Oo="delete-annotation",Lo="pdf-viewer-keyboard-event-binder",No="activation-annotation-keyboard-event-binder",Vo=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"pressEnter",value:function(e){if(e&&(0,D._)(e,Ho))switch(e.getPDFAnnot().getField().getType()){case gn.ComboBox:return this.pressEnterOnComboBox(e);case gn.ListBox:break;case gn.CheckBox:case gn.PushButton:case gn.RadioButton:return this.pressEnterOnPushButton(e);case gn.Sign:return this.pressEnterOnSignature(e);case gn.Text:return this.pressEnterOnText(e);case gn.Unknown:return}}},{key:"pressEnterOnText",value:function(e){var t=e.getPDFAnnot().getField(),n=e.formRender;vn.isMultiline(t.getFlags())||Promise.resolve(n.blurControl(!0)).finally((function(){e.parent("pdfPageRender").$ui.get(0).focus({preventScroll:!0})}))}},{key:"pressEnterOnSignature",value:function(e){var t=e.pdfViewer,n=e.getPDFAnnot();t.eventEmitter.emit(de.signatureFieldMouseLButtonUp,n)}},{key:"pressEnterOnComboBox",value:function(e){e.isActive?e.formRender.blurControl():e.getPDFAnnot().updateUI({type:"focus"})}},{key:"pressEnterOnPushButton",value:function(e){e.handleEvent(vo.AnnotMouseButtonReleased,{button:0})}}],[{key:"scope",value:function(){return j.IoCScope.SINGLETON}}]),e}(),Bo=document.createElement("div");Bo.classList.add("fv__ui-form-foreground");var jo="fv__select-annot-state-handler",Uo=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).$input=null,a.$border=null,a.scale=1,a.rotate=0,r=a.$handler,a.name="pdfControlRender",i.classList.add("fv__pdf-form-control-container"),a.formRender=a.parent("pdfDocRender").getFormRender();var s=e.getField(),u=a.$foreground=O()(Bo.cloneNode());if(!s)return(0,Lr._)(a);var c=!a.checkInvisible()&&a.pdfViewer.highlightControlsUI()?"block":"none",l="";a.checkReadOnly()&&7!==s.getType()&&(c="none",l+="form-field-readonly");var d=s.getType()==gn.PushButton?"0":"1";s&&vn.isRequired(s.getFlags())&&u.addClass("required"),u.addClass(l).css({display:c,position:"absolute",width:"100%",height:"100%",left:0,top:0,opacity:d}),(7!=s.info.type||7===s.info.type&&!s.info.isSigned)&&a.normalBackgroundColorHandler(),r.addClass("fv__pdf-form-control-handler-container").append(u).attr("fieldName",s&&s.getName()).attr("tabindex","-1"),e.getMKProperty("fillColor")||(7===e.info.fieldType?r.css("mix-blend-mode","multiply"):r.css("background-blend-mode","multiply")),e.setRenderNotifier((function(e){return a.updateUI(e)})),a.checkInvisible()&&r.hide(),a.bindControlEvent();var h=a.pdfViewer.i18n,f=function(e){return h.t(e)};Mo().i18n=f,a.addDestroyHook((function(){Mo().i18n===f&&(Mo().i18n=void 0)}));var g=function(t,n){if(e.getPDFPage()===t){var i=e.getId(),r=n.find((function(e){return e.info.id===i}));if(r&&r!==e){var o=e.render;r.setRenderNotifier(o),a.annot=r}}};"select-annotation"===a.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()&&u.hide();var v=function(){a.updateOnPermissionChange()},p=function(e){var t=a.pdfViewer.getPDFDocRender().$ui;e.getStateName()===dn.STATE_HANDLER_SELECT_ANNOTATION?t.addClass(jo):t.removeClass(jo)};return a.pdfViewer.eventEmitter.on(de.annotationLoaded,g),a.pdfViewer.eventEmitter.on(de.permissionChanged,v),a.pdfViewer.eventEmitter.on(de.switchStateHandler,p),a.addDestroyHook((function(){a.pdfViewer.eventEmitter.off(de.annotationLoaded,g),a.pdfViewer.eventEmitter.off(de.permissionChanged,v),a.pdfViewer.eventEmitter.off(de.switchStateHandler,p)})),a.addDestroyHook((0,j.attachKeypressEvent)(r.get(0),(function(){a.pdfViewer.getIoC().getInstanceByClass(Vo).pressEnter((0,w._)(a))}),j.Shortcut.from("Enter"))),a}return(0,A._)(n,[{key:"updateOnPermissionChange",value:function(){var e=this.$foreground;if(e){var t=this.checkReadOnly();if(e.toggleClass("form-field-readonly",t),!t)"select-annotation"===this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()?e.hide():(this.formRender.runtimeHighlight,e.show())}}},{key:"initPointerDownEvent",value:function(){}},{key:"updateSize",value:function(){arguments.length>0&&void 0!==arguments[0]||this.scale,arguments.length>1&&void 0!==arguments[1]||this.rotate}},{key:"shapeControlOnStart",value:function(){this.pdfViewer.config.highPerformance&&(this.editAreaDebouncePromise=new j.DebounceAsyncTaskExecutor(10))}},{key:"shapeControlOnUpdate",value:function(e,t){var n=this;this.pdfViewer.config.highPerformance&&this.editAreaDebouncePromise.exec((function(){return n.setRect(e)})),this.$selectedContainer.add(this.$handler).add(this.$handler.find(".fv__tiles-col")).css(e)}},{key:"shapeControlOnMoving",value:function(e,t){this.$selectedContainer.add(this.$handler).add(this.$handler.find(".fv__tiles-col")).css(e)}},{key:"shapeControlOnEnd",value:function(e,t){var n=this;return(this.pdfViewer.config.highPerformance?this.editAreaDebouncePromise.waitForLastTask():Promise.resolve()).then((function(){return n.setRect(e).then((function(){return n.render(n.scale,n.rotate,!0)}))}))}},{key:"updateRender",value:function(){return Promise.resolve()}},{key:"generateUI",value:function(){}},{key:"_hideUI",value:function(){this.$ui.hide()}},{key:"_showUI",value:function(){this.$ui.show()}},{key:"destroy",value:function(){this.$handler.off("mouseenter mouseleave mousedown focus blur"),this.addListenAnnotMouseEvent&&this.addListenAnnotMouseEvent(),this.rectHammer&&this.rectHammer.destroy(),this.$foreground.remove(),this.$foreground=null,this.annot.setRenderNotifier(null),this.formRender=null,(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.tileCanvas=null}},{key:"bindControlEvent",value:function(){var e=this,t=this.pdfViewer.getCurrentPDFDoc();if(!t.isDestroyed&&!t.isDynamicXFA()){var n,i,r=this.$handler,o=this,a=this;r.on("mouseleave",(function(t){return e.handleEvent(vo.AnnotCursorExit,t)})).on("mousedown",(i=(0,_._)((function(e){return(0,F.Jh)(this,(function(t){switch(t.label){case 0:return e.button?[2]:("textarea"===e.target.nodeName.toLowerCase()&&e.offsetX>=e.target.clientWidth||a.hasFocus||(6===a.annot.getField().getType()&&r.attr("contenteditable","true"),r.get(0).focus({preventScroll:!0})),(0,j.isEditable)(e.target)||e.preventDefault(),[4,o.pdfViewer.getCurrentPDFDoc().readonly()]);case 1:return t.sent()?(e.preventDefault(),[2]):(e&&e.stopPropagation(),n=e,2!=a.handleEvent(vo.AnnotMouseButtonPressed,e)&&e.preventDefault(),[2])}}))})),function(e){return i.apply(this,arguments)})).on("focus",(function(t){if(O()(t.target).hasClass("fv__pdf-form-control-handler-container"))return e.annot.updateUI&&e.annot.updateUI({type:"focus"}),void e.pdfViewer.eventEmitter.emit("tab-active",e.annot);e.handleEvent(vo.AnnotReceiveInputFocus,t)})).on("blur",(function(t){r.removeAttr("contenteditable"),O()(t.target).hasClass("fv__pdf-form-control-handler-container")||e.handleEvent(vo.AnnotLoseInputFocus,t)})).on("contextmenu",(function(t){e.checkReadOnly()?t.preventDefault():e.handleEvent("contextmenu",t)})).on("click",(function(t){e.pdfViewer.eventEmitter.emit("tap-field",e.annot)})).on("mouseenter",(function(t){return e.handleEvent(vo.AnnotCursorEnter,t)}));var s=this;this.addListenAnnotMouseEvent=this.pdfViewer.addListenAnnotMouseEvent(function(){var e=(0,_._)((function(e){var t;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return n?[3,2]:[3,3];case 1:if(i.sent())return[2];i.label=2;case 2:t=s.handleEvent(vo.AnnotMouseButtonReleased,e),i.label=3;case 3:return n=null,[2,t]}}))}));return function(t){return e.apply(this,arguments)}}())}}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;Math.ceil(c/r),Math.ceil(u/r);return[1,1,u,c,1e6,i,e,t,a.left,a.top,s]}},{key:"updateForgroundAndHandler",value:function(e,t){var n=this.annot.getDeviceRect(e,t),i={width:n.right-n.left+.5|0,height:n.bottom-n.top+.5|0,left:n.left,top:n.top};return this.$handler.addClass("active").css(i),i}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"normal";e||t||(e=this.annotsRender.scale,t=this.annotsRender.rotate),(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t,i);var o=this.annot,a=this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName();return this.checkInvisible()||o.isEmpty()||o.isDeleted()||o.rectIsEmpty()||!o.getField()?(this.checkInvisible()&&this.$handler.hide(),"select-annotation"==a?(this.updateForgroundAndHandler(e,t),this.redraw(e,t,i)):Promise.resolve()):(this.checkInvisible()||this.$handler.show(),this.updateForgroundAndHandler(e,t),this.redraw(e,t,i,r))}},{key:"redraw",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"normal",a=this.getTileConfig(n,i),s=this.annot,u=this.tileCanvas;return u||(u=this.tileCanvas=new fr((t=(0,_._)((function(e,t,n,i,r,o,a,c,l){var d,h,f,g,v,p,m,y,w,_,P,A,S,x,C,D,E,I;return(0,F.Jh)(this,(function(R){switch(R.label){case 0:return d=u.renderAppearanceType,h=function(){return s.getPDFPage().getAnnotBitmap(s.getId(),(0,U.F2)(o),l,{x:a*o+t*r,y:c*o+e*r,width:n,height:i},!0,d)},[4,s.getWidgetMkOption()];case 1:return f=R.sent().behavior,"down"!==d||"e_HighlightingPush"===f?[2,h()]:[4,h()];case 2:if(g=R.sent(),"e_HighlightingInvert"===f){for(v=new Uint8Array(g.buffer),p=0;p<v.length;p+=4)v[p]=255^v[p],v[p+1]=204^v[p+1],v[p+2]=142^v[p+2];return[2,(0,b._)((0,k._)({},g),{buffer:v.buffer})]}if("e_HighlightingOutline"===f){for(m=new Uint8Array(g.buffer),y=s.getBorderWidth()*o*4/3,w=s.getDeviceRect(o,l),_=a*o+t*r,P=c*o+e*r,A=w.left+y,S=w.top+y,x=w.right-y,C=w.bottom-y,D=0;D<m.length;D+=4)E=_+D/4%n,I=P+Math.floor(D/4/n),(E<=A||E>=x||I<=S||I>=C)&&(m[D]=255^m[D],m[D+1]=204^m[D+1],m[D+2]=142^m[D+2]);return[2,(0,b._)((0,k._)({},g),{buffer:m.buffer})]}return[2,g]}}))})),function(e,n,i,r,o,a,s,u,c){return t.apply(this,arguments)}),this.$handler)),u.renderAppearanceType=o,r&&u.clearCache(),(e=u).redraw.apply(e,(0,I._)(a))}},{key:"doubleTapAnnot",value:function(){}},{key:"checkReadOnly",value:function(){var e=this.annot.getField();if(!e)return!0;if(7==e.getType()&&e.isSigned())return!1;var t=!1;this.formRender.isReadOnly()&&(t=!0);this.getAnnotFlag();return vn.isReadOnly(e.getFlags())&&(t=!0),t}},{key:"getSignCNItem",value:function(){}},{key:"checkPagingSealByEsignCN",value:function(e){}},{key:"getMainPagingSealIdByEsignCN",value:function(){}},{key:"getPagingSealColorByEsignCN",value:function(e){}},{key:"checkReadOnlyByEsignCN",value:function(){return!1}},{key:"checkInvisibleByEsignCN",value:function(){return!1}},{key:"checkInvisible",value:function(){var e=this.getAnnotFlag();return!(!e.checkHidden()&&!e.checkNoView())}},{key:"handleEvent",value:function(e,t){var n=this;return(0,_._)((function(){var i,r,o,a,s,u;return(0,F.Jh)(this,(function(c){switch(c.label){case 0:if(i=n.annot,r=n.annot.getField(),0==t.button&&n.checkReadOnly())return e!=vo.AnnotMouseButtonReleased&&e!=vo.AnnotReceiveInputFocus||n.formRender.blurControl(),[2,!0];if(0!=t.button)return[3,6];switch(e){case vo.AnnotMouseButtonPressed:return[3,1];case vo.AnnotMouseButtonReleased:return[3,3]}return[3,5];case 1:return n.formRender.focusControl(n),[4,i.getWidgetMkOption()];case 2:return o=c.sent().behavior,1==r.getType()&&"e_HighlightingNone"!==o&&n.render(n.scale,n.rotate,!0,"down"),[3,5];case 3:return[4,i.getWidgetMkOption()];case 4:return a=c.sent().behavior,1==r.getType()&&"e_HighlightingNone"!==a&&n.render(n.scale,n.rotate,!0,"normal"),s=Promise.resolve(),2!=r.getType()&&3!=r.getType()||(s=n.annot.switchAS(),n.formRender.calculate(r)),u=n.formRender,setTimeout((function(){var e=i.getAction();s.then((function(t){return u.execAction("Field",e,r,r)}))}),0),[3,5];case 5:n.performAction(e),c.label=6;case 6:return[2]}}))}))()}},{key:"updateUI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=e.type,n=e.value;if(this.annot){var i=this.annot.getField(),r=this.$handler,o=this.$foreground,a=this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName();switch(t){case"readonly":n?(r.css("z-index",27),o.hide().addClass("form-field-readonly")):(!this.pdfViewer.highlightControlsUI()||"select-annotation"===a||1==i.getType()||this.checkReadOnly()||this.checkInvisible()||o.show(),o.removeClass("form-field-readonly"),r.css("z-index",29));break;case"required":var s=n?this.pdfViewer._runtimeColorOpacityRequired:this.pdfViewer._runtimeColorOpacity,u=n?this.pdfViewer._runtimeColorRequired:this.pdfViewer._runtimeColor,c=this.pdfViewer.getDisplayHighlightColor(u,s);n?o.addClass("required"):o.removeClass("required"),o.css({"background-color":c});break;case"hidden":if(n){if(r.hide(),6==i.getType())return;return void(this.$input&&this.$input.css("visibility","hidden"))}if(!this.pdfViewer.highlightControlsUI()||"select-annotation"===a||1==i.getType()||this.checkReadOnly()||this.checkInvisible()||o.show().removeClass("form-field-readonly"),r.show(),6==i.getType())return;this.$input&&this.$input.css("visibility","visible");var l=r.get(0).getBoundingClientRect(),d=l.width*l.height;if(!d&&d>0)return;break;case"focus":this.formRender.focusControl(this);break;case"display":var h=this.annot.getFlags();if(2&h||32&h)return void r.hide().addClass("fv__ui-field-show-in-select-annot-handler");!this.pdfViewer.highlightControlsUI()||"select-annotation"===a||1==i.getType()||this.checkReadOnly()||this.checkInvisible()||o.show().removeClass("form-field-readonly"),r.show();var f=r.get(0).getBoundingClientRect(),g=f.width*f.height;if(!g&&g>0)return;break;case"textColor":if(!this.$input)break;var v=this.$input.find("input[type=text]");v||(v=this.$input.find("textarea")),v.css("color",(0,j.colorConvertor)(n));break;case"textSize":if(!this.$input)break;var p=this.$input.find("input[type=text]");p||(p=this.$input.find("textarea")),n?p.css("font-size",2*n+"px"):this.autoFontSize(0);break;case"fillColor":n?this.$handler.css("background-blend-mode","unset"):this.$handler.css("background-blend-mode","multiply");break;case"orientation":if(!this.$input)break;var m=this.$input.find("input[type=text]");m||(m=this.$input.find("textarea"));var y=90*(n||0);m.css("transform","rotate("+y+"deg)"),this.updateSize(this.scale,this.rotate,!0);break;case"rename":return void this.render(this.scale,this.rotate,!0)}this.updateUIMore({type:t,value:n})}}},{key:"updateUIMore",value:function(e){e.type,e.value;this.render(this.scale,this.rotate,!0)}},{key:"focus",value:function(){var e=this,t=this.annot.getField();if(t&&t.doc&&!(t.getFlags()&vn.ReadOnly==vn.ReadOnly)){this.hasFocus=!0,setTimeout((function(){t&&t.doc&&e.hasFocus&&(e.$foreground.hide(),4!==t.getType()&&e.$handler.addClass("fv__control_focus"))}),50);var n=this.annot.getAdditionalAction(vo.AnnotReceiveInputFocus);try{return n&&this.formRender.execAction("Field",n,null,t)}finally{this.pdfViewer.eventEmitter.emit(de.focusOnControl,this)}}}},{key:"blur",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hasFocus=!1;var t=this.annot.getField();if(t){if(!this.checkReadOnly()&&this.pdfViewer.highlightControlsUI())"select-annotation"===this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()?this.$foreground.hide():this.$foreground.show();4!==t.getType()&&this.$handler.removeClass("fv__control_focus");var n=this.annot.getAdditionalAction(vo.AnnotLoseInputFocus);try{return n&&this.formRender.execAction("Field",n,null,t,"Blur")}finally{this.pdfViewer.eventEmitter.emit(de.blurFromObject,this,e)}}}},{key:"performAction",value:function(e,t){this.formRender&&this.formRender.execAction("Field",this.annot.getAdditionalAction(e),null,this.annot.getField(),e,t)}},{key:"autoFontSize",value:function(e){if(this.annot){var t=this.$textInput||this.$input,n=this.annot.getField();if(n){e||(e=n.getValue());var i=t.css("transform");i&&"none"!==i&&t.css({transform:"none",width:t.parent().width(),height:t.parent().height(),borderWidth:""});var r=this.annot.getDefaultAppearance(),o=4*(r?r.textSize:0)/3*this.scale;if(o)t.css("font-size",o+"px");else if(!vn.isMultiline(n.getFlags())){var a=parseInt(t.css("border-top-width"))+parseInt(t.css("border-bottom-width"));o=t.outerHeight()-a;var s=this.pdfViewer.$ui.find(".fwr-font-auto");0==s.length&&((s=O()('<div class="fwr-font-auto"></div>')).css({position:"absolute",top:0,width:"fit-content",opacity:0,"line-height":1}),s.appendTo(this.pdfViewer.$ui)),s.css({border:t.css("border"),fontFamily:t.css("font-family"),fontSize:o+"px",transform:"none"}).text(e);for(var u=t.parent().height(),c=t.parent().width(),l=12,d=u;d-l>=1;){var h=(l+d)/2;s.css("font-size",Math.max(12,h)+"px"),h<12&&s.css("transform","scale(".concat(h/12,")"));var f=s.outerHeight();s.outerWidth()<=c&&f<=u?l=h+1:d=h}if((o=l-1)<12){var g=o/12,v=t.css("transform");t.css({fontSize:12,transform:"".concat(v&&"none"!==v?v+" ":"","scale(").concat(g,")"),width:c/g,height:u/g,"border-width":parseFloat(t.css("border-width"))/g})}else t.css("font-size",o+"px")}}}}},{key:"bindKeyboardEvent",value:function(){var e=this;this.__off__delete__event__&&this.__off__delete__event__(),this.__off__delete__event__=this.pdfViewer&&this.pdfViewer.getKeyboardEventBinder(No).on(Oo,(function(t){e.removeAnnot()})),this.__off__esc__event__&&this.__off__esc__event__(),this.__off__esc__event__=this.pdfViewer&&this.pdfViewer.getKeyboardEventBinder(No).on("unactive-annotation",(function(t){e.unActiveEditing()})),this._undoSwitchKbBinder&&this._undoSwitchKbBinder(),this._undoSwitchKbBinder=this.pdfViewer.switchKeyboardEventBinder(No)}},{key:"unBindKeyboardEvent",value:function(){this._undoSwitchKbBinder&&this._undoSwitchKbBinder(),this.__off__delete__event__&&this.__off__delete__event__(),this.__off__delete__event__=qi,this.__off__esc__event__&&this.__off__esc__event__(),this.__off__esc__event__=qi}},{key:"removeAnnot",value:function(){var e=this;return this.deleteDisabled()?Promise.resolve():(this.hideFormPropertiesDialog&&this.hideFormPropertiesDialog(),this.unBindKeyboardEvent(),this.pdfViewer.getPDFDocRender().getPDFDoc().loadPDFForm().then((function(t){return t.removeControl(e.annot.getField().getName(),e.annot.getObjNum()).then((function(e){return e}))})))}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"normalBackgroundColorHandler",value:function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])this.$foreground.css({"background-color":"unset"});else{var e=this.annot.getField(),t=this.pdfViewer.getDisplayHighlightColor(this.pdfViewer._runtimeColor,this.pdfViewer._runtimeColorOpacity);e&&vn.isRequired(e.getFlags())&&(t=this.pdfViewer.getDisplayHighlightColor(this.pdfViewer._runtimeColorRequired,this.pdfViewer._runtimeColorOpacityRequired)),this.$foreground.css({"background-color":t})}}},{key:"isFormControl",value:function(){return!0}}]),n}(To);const Ho=Uo;var Wo;!function(e){e[e.FROM_NEXT=0]="FROM_NEXT",e[e.FROM_PREV=1]="FROM_PREV"}(Wo||(Wo={}));var Yo,qo={"aria-hidden":"true",style:"position: fixed;top: 50%;left:50%;width:0;height:0;opacity: 0;pointer-events:none",tabindex:0},Ko=(j.LoggerFactory.getLogger("AnnotTabManager"),function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;(0,P._)(this,n),i=t.call(this),(0,J._)((0,w._)(i),"pageRender",void 0),(0,J._)((0,w._)(i),"currentOrderedAnnotComponents",void 0),(0,J._)((0,w._)(i),"currentFocusOnAnnotComponent",void 0),(0,J._)((0,w._)(i),"index",void 0),(0,J._)((0,w._)(i),"jumpPrevElement",void 0),(0,J._)((0,w._)(i),"jumpNextElement",void 0),(0,J._)((0,w._)(i),"taskExecutor",void 0),i.pageRender=e,i.index=-1,i.jumpPrevElement=document.createElement("div"),i.jumpNextElement=document.createElement("div"),i.taskExecutor=new j.QueuedAsyncTaskExecutor;var r=(0,w._)(i);for(var o in j.Lazy.property((0,w._)(i),"currentOrderedAnnotComponents",(0,_._)((function(){return(0,F.Jh)(this,(function(e){switch(e.label){case 0:return[4,r.updateAnnots()];case 1:return[2,e.sent()]}}))}))),qo)i.jumpNextElement.setAttribute(o,qo[o]),i.jumpPrevElement.setAttribute(o,qo[o]);var a,s=function(e){i.currentFocusOnAnnotComponent&&e.preventDefault()};return i.addDOMEvent(i.pageRender.$element.get(0),"keydown",(function(e){if(!(0,j.isEditableElement)(e.target)){var t,n=j.matchers.ArrowLeft,r=j.matchers.ArrowRight,o=j.matchers.ArrowDown,a=j.matchers.ArrowUp,s=j.matchers.or;if((0,j.isMatch)(e,s(n,a)))t=0;else{if(!(0,j.isMatch)(e,s(r,o)))return;t=1}if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)){var u=i.currentFocusOnAnnotComponent;if(u&&(0,D._)(u,Ho)){var c=u.annot.getField().controls;if(!(c.length<2)){var l=c.map((function(e){return e.widget})),d=(0,w._)(i);i.taskExecutor.exec((0,_._)((function(){var e,n,i,r,o,a,s,h;return(0,F.Jh)(this,(function(f){switch(f.label){case 0:if(e=l.indexOf(u.annot),(n=0===t?e-1:e+1)>=l.length&&(n=0),n<0&&(n=l.length-1),i=l[n],r=d.pageRender.pagesRender,i)return[3,4];o=d.pageRender.index,a=d.pageRender.pagesRender.pageRenders.length,f.label=1;case 1:return i?[3,4]:((s=o+1)>=a&&(s=0),s<0&&(s=a-1),[4,r.getPDFPageRender(s).getPDFPage()]);case 2:return[4,f.sent().getAnnots()];case 3:return f.sent(),i=c[n].widget,(o=s)===d.pageRender.index?(i=l[0],[3,4]):[3,1];case 4:return(h=r.getPDFPageRender(i.page.getIndex())).isRendered?[3,6]:[4,d.pageRender.pdfViewer.goToPage(h.index)];case 5:f.sent(),f.label=6;case 6:return h.isRendered?[3,8]:[4,new Promise((function(e){return setTimeout(e,10)}))];case 7:return f.sent(),[3,6];case 8:return h.getAnnotRender(i.getObjectNumber()).component.$handler.focus(),[2]}}))}))),e.stopPropagation(),e.preventDefault()}}}}}),!0),i.addDOMEvent(i.jumpPrevElement,"focus",(function(){i.currentFocusOnAnnotComponent?i.jumpToPrev():i.jumpToNext()})),i.addDOMEvent(i.jumpPrevElement,"keydown",s),i.addDOMEvent(i.jumpNextElement,"focus",(function(){i.jumpToNext()})),i.addDOMEvent(i.jumpNextElement,"keydown",s),i.addViewerEvent(de.blurFromObject,(function(e,t){t||(clearTimeout(a),a=setTimeout((function(){i.taskExecutor.exec((function(){e===i.currentFocusOnAnnotComponent&&(i.currentFocusOnAnnotComponent=void 0,i.index=-1)}))}),100))})),i.addViewerEvent(de.focusOnControl,(function(e){(clearTimeout(a),i.isDestroyed)||e.parent("pdfPageRender")===i.pageRender&&i.taskExecutor.exec((function(){if(e!==i.currentFocusOnAnnotComponent)return i.currentOrderedAnnotComponents.then((function(t){var n=t.indexOf(e);-1!==n&&(i.currentFocusOnAnnotComponent=e,i.index=n)}))}))})),i.addViewerEvent(de.activeAnnotation,(function(e){var t=e.component;t!==i.currentFocusOnAnnotComponent&&t.getPDFPage().getIndex()===i.pageRender.index&&i.taskExecutor.exec((function(){return i.currentOrderedAnnotComponents.then((function(e){var n=e.indexOf(t);-1!==n&&(i.currentFocusOnAnnotComponent=t,i.index=n)}))}))})),i.addViewerEvent(le.docModified,(function(){j.Lazy.reset((0,w._)(i),"currentOrderedAnnotComponents")})),i.addViewerEvent(de.switchStateHandler,(function(){j.Lazy.reset((0,w._)(i),"currentOrderedAnnotComponents")})),i.addDestroyHook((function(){i.taskExecutor.cancel()})),i}return(0,A._)(n,[{key:"addDOMEvent",value:function(e,t,n,i){e.addEventListener(t,n,i),this.addDestroyHook((function(){e.removeEventListener(t,n,i)}))}},{key:"addViewerEvent",value:function(e,t){var n=this.pageRender.pdfViewer.eventEmitter;n.on(e,t),this.addDestroyHook((function(){n.off(e,t)}))}},{key:"updateAnnots",value:function(){var e,t=this,n=this.pageRender,i=null===(e=n.docRender.formRender)||void 0===e?void 0:e.getEditType();return(n.annotsRender?n.getPDFPage():n.render(n.pagesRender.getPageScaleSync(n.index,n.docRender.getScale())).then((function(){return n.getPDFPage()}))).then((function(e){return e.getAnnotIdArrayByOrder().then((function(t){return e.getAnnotsByObjectNumArray(t)})).then((function(e){return e.filter((function(e){return!(!(0,D._)(e,ho)||!e.getField())&&(8===i||i===e.getField().getType()||(e.getField().getFlags()&vn.ReadOnly)!=vn.ReadOnly)})).map((function(e){var n=t.pageRender.getAnnotRender(e.getObjectNumber());return n&&n.component})).filter((function(e){return e.$handler.is(":visible")})).filter((function(e){switch(i){case 0:case 8:return!0;case 1:return 1===e.annot.getField().getType();case 2:return 2===e.annot.getField().getType();case 3:return 3===e.annot.getField().getType();case 4:return 4===e.annot.getField().getType();case 5:return 5===e.annot.getField().getType();case 6:return 6===e.annot.getField().getType();case 7:return 7===e.annot.getField().getType()}}))}))}))}},{key:"jumpToNext",value:function(){var e=this;this.taskExecutor.exec((function(){return e.currentOrderedAnnotComponents.then((function(t){var n=t.length;if(!(n<1)){var i,r=e.pageRender.index,o=e.pageRender.docRender;if(e.currentFocusOnAnnotComponent){if(!(i=t[e.index+1])){var a=o.getPDFPageRender(r+1);if(a)return e.jumpToPage(a.index,1);var s=0;return 0!==r&&r!==o.doc.getPageCount()-1||(s=1),e.jumpToPage(0,s)}}else i=t[e.index>-1?e.index%n:0];i&&i.$handler.focus()}}))}))}},{key:"jumpToPrev",value:function(){var e=this;this.taskExecutor.exec((function(){return e.currentOrderedAnnotComponents.then((function(t){var n=t.length;if(!(n<1)){var i,r=e.pageRender.index,o=e.pageRender.docRender;if(e.currentFocusOnAnnotComponent){if(!(i=t[e.index-1])){var a=r-1;if(-1===a){var s=o.getPDFDoc().getPageCount()-1;return e.jumpToPage(s,0)}return e.jumpToPage(a,0)}}else i=t[e.index<=0?n-1:e.index-1];i&&i.$handler.focus()}}))}))}},{key:"jumpFromPrevPage",value:function(){return this.currentOrderedAnnotComponents.then((function(e){return!!e[0]&&(e[0].$handler.focus(),!0)}))}},{key:"jumpFromNextPage",value:function(){return this.currentOrderedAnnotComponents.then((function(e){var t=e[e.length-1];return!!t&&(t.$handler.focus(),!0)}))}},{key:"jumpToPage",value:function(e,t){var n=this;return(0,_._)((function(){var i,r,o,a,s,u,c;return(0,F.Jh)(this,(function(l){switch(l.label){case 0:i=n.pageRender.pdfViewer,r=n.pageRender.docRender,o=r.doc.getPageCount(),s=(a=0===t)?-1:1,u=e,l.label=1;case 1:return[4,(c=r.getPDFPageRender(u)).tabManager.currentOrderedAnnotComponents];case 2:return 0!==l.sent().length?[3,3]:(u=(u+s+o)%o)===e?(c=r.getPDFPageRender(u),[3,3]):[3,1];case 3:return u===r.getCurrentPageIndex()?[3,5]:[4,i.goToPage(u)];case 4:l.sent(),l.label=5;case 5:return a?[4,c.tabManager.jumpFromNextPage()]:[3,7];case 6:return l.sent(),[3,9];case 7:return[4,c.tabManager.jumpFromPrevPage()];case 8:l.sent(),l.label=9;case 9:return[2]}}))}))()}},{key:"render",value:function(){this.pageRender.$ui.prepend(this.jumpPrevElement),this.pageRender.$element.append(this.jumpNextElement)}}]),n}(j.Disposable));!function(e){e.viewport="viewport",e.page="offset-page",e.scroll="scroll",e.pdf="pdf"}(Yo||(Yo={}));var $o=function(){},zo=Math.min,Go=Math.max,Jo=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,o)).isRendered=!1,a.renderedDefered=(0,j.createDeferred)(),a.name=n.getDefaultName(),a.$ui=e,a.$element=e.parent(),a.index=i,a.renderCount=0,e.attr("data-index",i),a.pagesRender=o,a.docRender=o.docRender,a.viewerRender=a.docRender.viewerRender,a.unObserveIntersectionObserver=a.docRender.intersectionObserver.observe(a.$element.get(0),(function(e,t){a.docRender._updateVisiblePageIndex(a.index,t),e.classList.toggle("fv__pdf-invisible-page-item",!t)})),a.unObservePageLayoutIntersectionObserver=a.docRender.intersectionObserver.observe(a.$ui.get(0),(function(e,t){a.pageAreaIsVisible=t}));var s=e[0];a.$rendering=O()(s.querySelector(".fv__pdf-page-rendering")),a.$container=O()(s.querySelector(".fv__pdf-page-container")),a.$container[0].setAttribute("data-index",i),a.$annotsContainer=O()(s.querySelector(".fv__pdf-page-annots-container")),a.$customsContainer=O()(s.querySelector(".fv__pdf-page-customs-container"));var u=a.$handler=O()(s.querySelector(".fv__pdf-page-handler-container"));a.$invisible=O()(s.querySelector(".fv__pdf-invisible-page-container")),a.pageHandler=new kr(u,(0,w._)(a)),a.doc=r,a.scale=1,a.rotate=o.rotate;var c=a.pdfViewer.customs||{};return a.pdfPageRendering=new(c.PDFPageRendering||H)(a.$rendering[0],(0,w._)(a)),a.pageCustomRender=new(c.PageCustomRender||W)(s.querySelector(".fv__pdf-custom-page-container"),(0,w._)(a)),a.renderFlags=7,a.renderingDeferreds=[],a.followRenderDeferreds=[],a.watermarkConfig=null,a.excluedHighlights=[],a.annotsRenderDeferred=(0,j.createDeferred)(),a.$element.attr({tabindex:"-1","aria-busy":!0,role:"region","aria-label":a.pdfViewer.i18n.t("aria.pdf.page",{number:a.index+1})}),a.$ui.addClass("fv__pdf-page-not-rendered"),j.Lazy.property((0,w._)(a),"tabManager",(function(){var e=new Ko((0,w._)(a));return a.addDestroyHook(e),e})),a.$annotsContainer.on("pointerdown",a.pointerdownFn=function(e){var t=e.target.classList;(t.contains("fv__pdf-annot-line-point-item")||t.contains("fv__shape-control-move-area")||t.contains("fv__shape-controller"))&&(a.pdfViewer.getScrollWrap().disable(!0),a.pdfViewer.setEnableScale(!1),document.addEventListener("pointerup",a.pointerupFn=function(e){a.pdfViewer.getScrollWrap().disable(!1),a.pdfViewer.setEnableScale(!0)},{once:!0}))}),a}return(0,A._)(n,[{key:"getHandlerDOM",value:function(){return this.$handler.get(0)}},{key:"clearCanvasCache",value:function(e){this.pageContentTiles&&this.pageContentTiles.invisibleRender(e)}},{key:"updateRenderFlags",value:function(e){this.renderFlags=this.renderFlags|e}},{key:"updateRenderFlagsByScaleAndRotate",value:function(e,t){Math.abs(e-this.scale)>1e-6||t!==this.rotate?this.updateRenderFlags(7):this.updateRenderFlags(0)}},{key:"checkRenderLayoutFlags",value:function(){return 4==(4&this.renderFlags)}},{key:"resetRenderLayoutFlags",value:function(){this.renderFlags&=-5}},{key:"checkRenderContainerFlags",value:function(){return this.checkRenderContentFlags()||this.checkRenderAnnotFlags()||this.checkRebuildAnnotFlags()}},{key:"checkRenderContentFlags",value:function(){return 2==(2&this.renderFlags)}},{key:"resetRenderContentFlags",value:function(){this.renderFlags&=-3}},{key:"checkRenderAnnotFlags",value:function(){return 1==(1&this.renderFlags)}},{key:"resetRenderAnnotFlags",value:function(){this.renderFlags&=-2,this.resetRebuildAnnotFlags()}},{key:"checkRenderCustomFlags",value:function(){return 16==(16&this.renderFlags)}},{key:"resetRenderCustomFlags",value:function(){this.renderFlags&=-17,this.resetRebuildCustomFlags()}},{key:"checkRebuildAnnotFlags",value:function(){return 8==(8&this.renderFlags)}},{key:"resetRebuildAnnotFlags",value:function(){this.renderFlags&=-9}},{key:"checkRebuildCustomFlags",value:function(){return 32==(32&this.renderFlags)}},{key:"resetRebuildCustomFlags",value:function(){this.renderFlags&=-33}},{key:"setStateHandler",value:function(e){if(this.stateHandler){if(this.stateHandler.constructor.getStateName()===e.getStateName())return;this.stateHandler.destroyPageHandler()}(this.stateHandler=new e(this.pdfViewer)).pageHandler(this)}},{key:"updateIndex",value:function(e){this.index!==e&&(this.index=e,this.$ui.attr("data-index",e),this.$container.attr("data-index",e),this.$element.attr("aria-label",this.pdfViewer.i18n.t("aria.pdf.page",{number:this.index+1})))}},{key:"getPDFPage",value:function(){var e=this;return this.page?Promise.resolve(this.page):this.doc?this.doc.getPageByIndex(this.index).then((function(t){return e.page=t,t.isVirtual()&&e.handleVirtualPage(),t})):Promise.resolve(null)}},{key:"handleVirtualPage",value:function(){this.$ui.addClass("fv__virtual-pdf-page")}},{key:"getPDFDoc",value:function(){return this.doc}},{key:"getAnnotRender",value:function(e){try{return this.annotsRender&&this.annotsRender.getAnnotRender(e)}catch(e){return console.error(e),null}}},{key:"getAnnotRenderSafely",value:function(e){var t=this;return this.annotsRender?Promise.resolve(this.annotsRender.getAnnotRenderSafely(e)):this.getPDFPage().then((function(e){return e.getAnnots()})).then((function(e){return new ir(t.$annotsContainer,e,t)})).then((function(t){return t.getAnnotRenderSafely(e)}))}},{key:"getAnnotsRenderSafely",value:function(){var e=this;return this.getPDFPage().then((function(e){return e.getAnnots()})).then((function(t){return Promise.resolve(new ir(e.$annotsContainer,t,e))}))}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;if(this.endRender(),this.isDestroyed)return this.renderSerialPromise?this.renderSerialPromise.end():Promise.resolve();var i=this.renderSerialPromise;0===this.renderCount&&this.rendering(t),this.updateRenderFlagsByScaleAndRotate(t,n);var r=this.scale;this.scale=t,this.rotate=n;var o=!this.renderCount;return this.renderCount++,this.pdfViewer.eventEmitter.emit(de.beforeRenderPage,this,o),Promise.resolve(this.pageCustomRender.render(this.scale,n)).then((function(t){if(!1!==t)return(i=e.renderSerialPromise=new ge(0)).push((function(){var t;if(e.checkRenderLayoutFlags()){e.resetRenderLayoutFlags();var i=e.pageTileConfigPromise=e.getPageTileConfig(e.scale,n);e.pageTileConfig=null;var o=null;if(e.pageContentTiles)"continuous-view-mode"===e.pagesRender.viewMode.constructor.getName()||e.doc.isPageSameSize()||(o=e.computePageSize(e.scale,n).then((function(t){var i=(0,E._)(t,2),r=i[0],o=i[1];return e.pagesRender.viewMode.renderViewMode(e,e.scale,n,r,o)}))),r!==e.scale&&(o=e.renderLayout(e.scale,n));else o=e.renderLayout(e.scale,n);t=Promise.all([i,o]).then((function(t){var n=(0,E._)(t,1)[0];return e.pageTileConfigPromise=null,e.pageTileConfig=n,n}))}else t=e.getPageTileConfig(e.scale,n);return t.then((function(t){var n=(0,E._)(t,8),i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],d=e.pageContentTiles;if(!d){e.pageContentTiles=d=new fr((function(t,n,i,r,o,a){return e.getContentImageDataByTile(t,n,i,r,o,a)}),null,e,e.pdfViewer.tileCache),e.pdfViewer.webPDFSRPromise||(d.getRectBitmap=function(t,n,i,r){return e.getRectBitmap((0,U.F2)(n),t,i,r)});var h=d.$container;h.addClass("fv__pdf-page-content-container"),e.$container.append(h)}d.setRenderViewWatermark(!1);var f=e.containerVisibleRect=e.getContainerVisibleRect();d.setVisibleRect(f),e.checkRenderContentFlags()&&(d.clearCache(),e.resetRenderContentFlags());var g,v,p,m=(g=[],v=e.getWatermarkConfig(),p=e.docRender.getWatermarkConfig(),Array.isArray(v)&&v.length>0?g=v:v&&v.content&&v.type?g=[v]:Array.isArray(p)&&p.length>0?g=p:p&&p.content&&p.type&&((0,j.isInCloseRange)(e.index,p.pageStart,p.pageEnd),g=[p]),g.filter((function(t){var n=t.pageStart,i=t.pageEnd,r="number"==typeof n&&n>0,o="number"==typeof i&&i>0;return r&&o?(0,j.isInCloseRange)(e.index,n,i):r?e.index>=n:!o||e.index<i}))),y=[];return m.length>0?(m.forEach((function(t){if(t.content&&t.type){var n=e.watermark=new Rr(o,a,s,u,t);y.push(n.getWatermarkRenderer(t))}})),Promise.all(y).then((function(t){return d.setRenderViewWatermark(t.length>0),d.setUpdateCanvasMore((function(n,i,r,o,a,s,u,c,l,d,h){t.forEach((function(e){var t=o<0?d*c:i,h=a<0?l*c:r,f=Math.min(c,s),g=Math.min(c,u),v=e.render(t,h,f,g);n.drawImage(v,i-o,r-a)})),e.renderLayoutGrid(n,i,r,o,a,s,u)})),d.redraw(i,r,o,a,s,u,c,l)}))):(e.pdfViewer.getLayoutGrid()&&d.setUpdateCanvasMore((function(t,n,i,r,o,a,s,u){e.renderLayoutGrid(t,n,i,r,o,a,s)})),d.redraw(i,r,o,a,s,u,c,l))}))})),i.push((function(){return e.checkRebuildAnnotFlags()?(e.resetRebuildAnnotFlags(),e.rebuildAnnots(e.scale,n,e.containerVisibleRect)):e.renderAnnots(e.scale,n,e.containerVisibleRect)})),i.push((function(){e.rendered(),e.renderSerialPromise=null,e.pdfViewer.eventEmitter.emit(de.renderPageSuccess,e),e.tabManager.render()})),i.push((function(){if(!e.stateHandler){var t=e.pdfViewer;(e.stateHandler=new(t.stateHandlerManager.getCurrentStates())(t)).pageHandler(e)}return Promise.resolve()})),i.exec();e.rendered()}))}},{key:"setShowWidth",value:function(e){this.showWidth=Math.max(e,.01)}},{key:"getShowWidth",value:function(){return this.showWidth}},{key:"setShowHeight",value:function(e){this.showHeight=Math.max(e,.01)}},{key:"getShowHeight",value:function(){return this.showHeight}},{key:"computePageSize",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.getPDFPage().then((function(i){var r,o=function(t){var r=(0,U.ke)(i.getPxWidth(),i.getPxHeight(),t,n);return e.showWidth=r[0],e.showHeight=r[1],r};return"fitVisible"!==t?(r=e.pagesRender.getPageScaleSync(e.index,t,n),o(r)):e.pagesRender.getPageScale(e.index,t,n).then((function(e){return o(e)}))}))}},{key:"renderLayout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.docRender.getScale(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=function(i){return e.updateRenderFlagsByScaleAndRotate(i,n),e.scale=i,e.rotate=n,e.computePageSize(i,n).then((function(t){var r=(0,E._)(t,2),o=r[0],a=r[1];return e.pagesRender.viewMode.renderViewMode(e,i,n,o,a)})).then((function(){var r=e.$ui;if(r.css({width:e.showWidth,height:e.showHeight}),e.annotsRender&&e.annotsRender.updateSize(i,n),e.pageContentTiles){var o=r.find(".fv__pdf-page-content-container"),a=i/e.pageContentTiles.scale;o.css("transform","scale("+a+")")}e.pdfViewer.eventEmitter.emit(de.pageLayoutRedraw,e,t,n)}))};if("fitVisible"!==t){var r=this.pagesRender.getPageScaleSync(this.index,t,n);return i(r)}return this.pagesRender.getPageScale(this.index,t,n).then((function(e){return i(e)}))}},{key:"getPageTileConfig",value:function(e,t){var n=this;return this.getPDFPage().then((function(i){var r=n.getSmartScale(e),o=n.pdfViewer.config,a=o.tileSize;o.getTileSize&&(a=o.getTileSize(n.doc,n.page));var s=i.getPxWidth(),u=i.getPxHeight(),c=(0,E._)((0,U.ke)(s,u,r,t),2),l=c[0],d=c[1];return[Math.ceil(d/a),Math.ceil(l/a),l,d,a,r,e,t]}))}},{key:"updateSize",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.getPageTileConfig(t,n).then((function(t){var n=(0,E._)(t,8),i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],d=e.pageContentTiles;d&&d.updateDom(i,r,o,a,s,u,c,l)}))}},{key:"renderContentImage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.getPageTileConfig(t,n).then((function(t){var n=(0,E._)(t,8),i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],d=e.pageContentTiles;return d?d.redraw(i,r,o,a,s,u,c,l):Promise.resolve()}))}},{key:"adjustHighlightInContentImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if([].concat(this.excluedHighlights).sort().join()!==[].concat(e).sort().join())return this.excluedHighlights=e,this.redrawContent(!0)}},{key:"adjustHighlightAnnots",value:function(){return Promise.resolve()}},{key:"getRotatedRowAndCols",value:function(e,t,n,i,r){switch(r){case 0:return[e,t];case 90:return[t,i-e];case 180:return[n-e,i-t];case 270:return[t,e]}}},{key:"renderContentImageByTileCanvas",value:function(e,t,n,i,r,o,a,s){var u=this,c=this.pageContentTiles;if(!c){this.pageContentTiles=c=new fr((function(e,t,n,i,r,o,a,s,c,l){return u.getContentImageDataByTile(e,t,n,i,r,o)}),null,!0);var l=c.$container;l.addClass("fv__pdf-page-content-container"),this.$container.append(l)}var d=this.getWatermarkConfig()||this.docRender.getWatermarkConfig();d&&d.content&&d.type&&(this.watermark=new Rr(n,i,r,o,d.watermarkSettings,d.watermarkTextProperties)).exportDataURL({content:d.content,type:d.type}).then((function(e){var t=new Image;t.src=e,c.setUpdateCanvasMore((function(e,n,i,r,o,a){e.drawImage(t,i*a,n*a,r,o,0,0,r,o)}))}));return c.redraw(e,t,n,i,r,o,a)}},{key:"getActiveAnnotInfo",value:function(e,t){var n=this.page.annots.map((function(e){return e.info})).filter((function(t){if(-1===["popup","unknown","watermark","widget"].indexOf(t.type))return e[0]>=t.rect.left&&e[0]<=t.rect.right&&e[1]>=t.rect.bottom&&e[1]<=t.rect.top?t:void 0}));if(t){for(var i=n[n.length-1],r=n.length-1;r>=0;r--)if("link"===n[r].type){i=n[r];break}return i}return n}},{key:"renderAnnots",value:function(e,t,n){var i=this,r=function(r){return i.annotsRender?i.annotsRender.render(e,t,n):Promise.resolve().then((function(e){return i.annotsRender||(i.annotsRender=new ir(i.$annotsContainer,e,i),i.annotsRenderDeferred.resolve(i.annotsRender)),i.annotsRender})).then((function(i){return i.render(e,t,n)}))};return this.parent("pdfDocRender").getFormRender()&&this.doc.getPDFForm()?this.doc.getPDFForm().addTask(r):Promise.resolve(r())}},{key:"rebuildAnnots",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.containerVisibleRect,r=function(){var r;r=n.page.getAnnots(1),n.docRender.setRebuildAnnotsFlag(!0);var o=n.annotsRender;return o&&o.removeUI(),r.then((function(e){return n.annotsRenderDeferred=(0,j.createDeferred)(),n.annotsRender=new ir(n.$annotsContainer,e,n),e.forEach((function(e){"3d"===e.getType()&&(n.annotsRender.annotRenders[e.getObjectNumber()]=o.annotRenders[e.getObjectNumber()],delete o.annotRenders[e.getObjectNumber()])})),n.annotsRenderDeferred&&n.annotsRenderDeferred.resolve(),n.annotsRender})).then((function(r){return i||(i=n.containerVisibleRect=n.getContainerVisibleRect()),r.render(e,t,i)})).then((function(e){return o&&o.destroy(),e}))},o=this.parent("pdfDocRender").getFormRender(),a=this.doc.getPDFForm();return o&&a?a.addTask(r):Promise.resolve(r())}},{key:"renderCustoms",value:function(e,t){var n=this;return this.customsRender?this.customsRender.render(e,t):this.getPDFPage().then((function(e){return n.pdfViewer.customRenderManager.getPageCustomData(e)})).then((function(e){return n.customsRender&&(n.customsRender.destroy(),n.customsRender=null),n.customsRender=n.customsRender||new Mr(n.$customsContainer,e,n)})).then((function(n){return n.render(e,t)}))}},{key:"rebuildCustoms",value:function(e,t){var n=this;return this.getPDFPage().then((function(e){return n.pdfViewer.customRenderManager.getPageCustomData(e)})).then((function(e){return n.customsRender=n.customsRender||new Mr(n.$customsContainer,e,n)})).then((function(n){return n.render(e,t)}))}},{key:"renderAnnot",value:function(e,t,n){return new(this.pdfViewer.annotManager.get(e.getType()))(e,this).render(t,n)}},{key:"updatePageDOMRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.doc.getPageSize(this.index);if((n||(-1===e&&(e=this.pagesRender.getEstimatedPageScaleSync(this.index,this.scale,this.rotate)),(n=this.doc.getEstimatedPageSize(this.index))&&-1!==e))&&e!=this.scale&&n){switch((t%360+360)%360){case 90:case 270:var i=n.width;n.width=n.height,n.height=i}n.width*=(0,U.F2)(1)*e,n.height*=(0,U.F2)(1)*e;var r=n;this.$ui.height()!=n.width&&(r.minHeight=40);var o=this.$ui.get(0),a=o.classList,s="fv__pdf-page-not-rendered";a.contains(s)&&a.remove(s),(0,j.cssText)(o,{width:Math.ceil(r.width)+"px",height:Math.ceil(r.height)+"px","min-height":r.minHeight+"px"})}}},{key:"rendering",value:function(){arguments.length>0&&void 0!==arguments[0]||this.scale,arguments.length>1&&void 0!==arguments[1]||this.rotate;this.$ui.addClass("fv__rendering"),this.pdfPageRendering.rendering()}},{key:"rendered",value:function(){var e=this;this.isDestroyed||(this.isRendered=!0,this.$ui.removeClass("fv__rendering"),this.pdfPageRendering.rendered(),this.pdfViewer.isWisWebPDFSR||this.openActionTrigged||!this.pdfViewer.enableOpenAction||this.getPDFPage().then((function(t){var n=t.getAction("open");n&&e.pdfViewer.actionManager.get(n,e).active(),e.openActionTrigged=!0})),this.renderedDefered.resolve())}},{key:"isRendering",value:function(){return this.$ui.hasClass("fv__rendering")}},{key:"waitRendered",value:function(){return this.isRendered?Promise.resolve():this.renderedDefered.promise}},{key:"destroy",value:function(){this.isDestroyed||(this.unObserveIntersectionObserver(),this.unObservePageLayoutIntersectionObserver(),this.pointerdownFn&&(this.$annotsContainer.off("pointerdown",this.pointerdownFn),this.pointerdownFn=null),this.pointerupFn&&(document.removeEventListener("pointerup",this.pointerupFn),this.pointerupFn=null),(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.invisibleRender(),this.pageContentTiles&&this.pageContentTiles.destroy(),this.stateHandler&&this.stateHandler.out(),this.annotsRender&&this.annotsRender.destroy(),this.annotsRenderDeferred=null,this.pageHandler.destroy(),this.$ui.parent().remove().next(".fv__pdf-view-mode-item-split").remove(),this.eLayoutContainerTransitionStyle&&document.body.removeChild(this.eLayoutContainerTransitionStyle),this.pdfPageRendering.destroy(),this.pageCustomRender&&this.pageCustomRender.destroy(),this.pageCustomRender=null,this.pdfPageRendering=null,this.pageHammer=null,this.pageHandler=null,this.$ui=null,this.eLayoutContainerTransitionStyle=null,this.doc=null,this.page=null,this.pageContentTiles=null,this.stateHandler=null)}},{key:"getSmartScale",value:function(e){return this.pdfViewer.getSmartScale(e)}},{key:"getScale",value:function(){return this.scale}},{key:"getRotation",value:function(){return this.rotate}},{key:"getRectBitmap",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rotate,r=this.page,o=this.docRender.getUserPermission();o.checkAnnotForm()||o.checkFillForm();return r.getPageBitmap(e,i,t,["page"],"view",n)}},{key:"previewRectBitmap",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.rotate;return this.getRectBitmap(e,t,n,i).then((function(r){var o=document.createElement("canvas"),a=o.getContext("2d"),s=r.buffer,u=r.width,c=r.height,l=r.x,d=r.y,h=new(Uint8ClampedArray||Uint8Array)(s),f=a.createImageData(u,c);f.data.set(h),o.width=u+l,o.height=c+d,a.putImageData(f,0,0);var g={scale:e,rect:t,id:n,rotate:i,url:o.toDataURL()};return console.log(g),g}))}},{key:"getContentImageDataByTile",value:function(e,t,n,i,r,o){return this.getRectBitmap((0,U.F2)(o),{x:t*r,y:e*r,width:n,height:i})}},{key:"getTextContinueRectAtDeviceRect",value:function(e){var t,n=this;return this.getPDFPage().then((function(i){return(t=i).reverseDeviceRect(e,n.scale,n.rotate)})).then((function(e){return t.getTextContinuousRectsAtRect(e)}))}},{key:"getTextContinueRectAtDevicePoints",value:function(e,t,n,i){return Promise.all([this.getPDFPage(),this.reverseDevicePoint(e),this.reverseDevicePoint(t)]).then((function(e){var t=(0,E._)(e,3),r=t[0],o=t[1],a=t[2];return r.getTextContinuousRectsAtPoints(o,a,8,n,i)}))}},{key:"getDoubleClickTextRectAtPoint",value:function(e){return Promise.all([this.getPDFPage(),this.reverseDevicePoint(e)]).then((function(e){var t=(0,E._)(e,2),n=t[0],i=t[1];return n.getDoubleClickTextRectAtPoint(i,8)}))}},{key:"getTextContinuousCharAtDeviceRect",value:function(e){var t,n=this;return this.getPDFPage().then((function(i){return(t=i).reverseDeviceRect(e,n.scale,n.rotate)})).then((function(e){return t.getTextContinuousCharsAtRect(e)}))}},{key:"getAllTextRect",value:function(){return this.getPDFPage().then((function(e){return e.getTextContinuousRectsAtRect(e.info.cropBox)}))}},{key:"getAllTextChar",value:function(){return this.getPDFPage().then((function(e){return e.getTextContinuousCharsAtRect(e.info.cropBox,!0)}))}},{key:"transformPoint",value:function(e){var t=this;return(0,_._)((function(){var n,i,r,o,a,s;return(0,F.Jh)(this,(function(u){switch(u.label){case 0:if(n=e.point,i=e.srcType,r=e.destType,o=t.scale,a=t.rotate,!n)throw new Error("[transformPoint] options.point is not a valid point object: ".concat(JSON.stringify(n),"."));if(!(0,j.isValidNumber)(n.x))throw new TypeError("[transformPoint] options.point.x: ".concat(n.x," is not a valid number"));if(!(0,j.isValidNumber)(n.y))throw new TypeError("[transformPoint] options.point.y: ".concat(n.y," is not a valid number"));if(i===r)return[2,Object.assign({},n)];if(!i)throw new Error("[transformPoint] options.srcType is not type of ViewerConstants.PagePointType");if(!r)throw new Error("[transformPoint] options.destType is not type of ViewerConstants.PagePointType");return[4,t.transformPointIntoPDFPoint({point:n,type:i,scale:o,rotate:a})];case 1:return s=u.sent(),[2,t.transformPDFPointToDestType({point:s,type:r,scale:o,rotate:a})]}}))}))()}},{key:"transformPDFPointToDestType",value:function(e){var t=this;return(0,_._)((function(){var n,i,r,o,a,s,u,c,l,d,h,f,g,v,p,m,y,k,b,w,_,P;return(0,F.Jh)(this,(function(A){switch(A.label){case 0:return n=e.point,i=e.type,r=e.scale,o=e.rotate,isFinite(r)||(r=t.scale),isFinite(o)||(o=t.rotate),[4,t.getPDFPage()];case 1:switch(a=A.sent(),i){case Yo.scroll:return s=t.getPagePositionOffsetViewerContainer(),u=(0,E._)(a.getDevicePoint([n.x,n.y],r,o),2),c=u[0],l=u[1],[2,{x:s.x+c,y:s.y+l}];case Yo.page:return d=(0,E._)(a.getDevicePoint([n.x,n.y],r,o),2),h=d[0],f=d[1],[2,{x:h,y:f}];case Yo.viewport:return g=(0,E._)(a.getDevicePoint([n.x,n.y],r,o),2),v=g[0],p=g[1],[2,{x:(m=t.$ui[0].getBoundingClientRect()).left+v,y:m.top+p}];case"PDFViewerPort":return y=(0,E._)(a.getDevicePoint([n.x,n.y],r,o),2),k=y[0],b=y[1],w=t.viewerRender.scrollWrap.getScrollHost(),((0,j.isWindowObject)(w)||(0,j.isDocument)(w))&&(w=document.body),_=t.$ui[0].getBoundingClientRect(),P=w.getBoundingClientRect(),[2,{x:k+_.left-P.left,y:b+_.top-P.top}];case Yo.pdf:return[2,n];default:throw new Error("[transformPDFPointToDestType] options.type is not type of ViewerConstants.PagePointType")}return[2]}}))}))()}},{key:"transformPointIntoPDFPoint",value:function(e){var t=this;return(0,_._)((function(){var n,i,r,o,a,s,u,c,l,d,h,f,g,v,p,m;return(0,F.Jh)(this,(function(y){switch(y.label){case 0:return n=e.point,i=e.type,r=e.scale,o=e.rotate,isFinite(r)||(r=t.scale),isFinite(o)||(o=t.rotate),[4,t.getPDFPage()];case 1:switch(a=y.sent(),i){case Yo.scroll:return s=t.getPagePositionOffsetViewerContainer(),u=[n.x-s.x,n.y-s.y],c=(0,E._)(a.reverseDevicePoint(u,r,o),2),l=c[0],d=c[1],[2,{x:l,y:d}];case Yo.viewport:h=t.$ui[0].getBoundingClientRect(),f=h.left,g=h.top,n={x:n.x-f,y:n.y-g};case Yo.page:return v=(0,E._)(a.reverseDevicePoint([n.x,n.y],r,o),2),p=v[0],m=v[1],[2,{x:p,y:m}];case Yo.pdf:return[2,n];default:throw new Error("[transformPointIntoPDFPoint] options.type is not type of ViewerConstants.PagePointType")}return[2]}}))}))()}},{key:"getPagePositionOffsetViewerContainer",value:function(){var e=this.pdfViewer.getPDFViewerRender().$ui[0],t=e.parentElement,n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=this.$ui[0].getBoundingClientRect(),o=i.top-n.top,a=i.left-n.left;return{x:r.left+t.scrollLeft-i.left+a,y:r.top+t.scrollTop-i.top+o}}},{key:"reverseDeviceRect",value:function(e){var t=this;return this.getPDFPage().then((function(n){return n.reverseDeviceRect(e,t.scale,t.rotate)}))}},{key:"reverseDevicePoint",value:function(e){var t=(0,E._)(e,2),n=t[0],i=t[1],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotate;return this.getPDFPage().then((function(e){return e.reverseDevicePoint([n,i],r,o)}))}},{key:"getDeviceRect",value:function(e){var t=this;return this.getPDFPage().then((function(n){return n.getDeviceRect(e,t.scale,t.rotate)}))}},{key:"transformRectArray",value:function(e,t){for(var n=[],i=this.scale,r=t.length;r--;){var o=t[r];n[r]=e.getDeviceRect(o,i,this.rotate)}return n}},{key:"getClientPoint",value:function(e,t){var n=this.$ui[0].getBoundingClientRect();return[e+n.left,t+n.top]}},{key:"redraw",value:function(e){return e&&(this.updateRenderFlags(7),this.annotsRender&&this.annotsRender.adjustHighlightsRender()),this.render()}},{key:"redrawContent",value:function(e){var t,n=this;return(e?((t=n.pageContentTiles)&&t.clearCache(),Promise.resolve()):Promise.resolve()).then((function(){return n.renderContentImage(n.scale,n.rotate)})).then((function(){return n.adjustHighlightAnnots()}))}},{key:"getDevicePointFromEvent",value:function(e){var t=this.$ui.offset();return[e.pageX-t.left,e.pageY-t.top]}},{key:"removeAnnotRenders",value:function(e){return this.annotsRender&&this.annotsRender.removeAnnotRenders(e)}},{key:"redrawAnnotRenders",value:function(e){if("canvas"===this.pdfViewer.config.annotRenderingMode.highlight)return this.annotsRender.redrawAnnotRenders(e);for(var t=[],n=[],i=0,r=e.length;i<r;i++){var o=e[i];"highlight"===o.getType()?t.push(o):n.push(o)}return t.length&&this.renderContentImage(),this.annotsRender.redrawAnnotRenders(n)}},{key:"movedAnnotRenders",value:function(e,t){return this.annotsRender.movedAnnotRenders(e,t)}},{key:"addAnnotRenders",value:function(e){var t=this;if(!this.annotsRender)return this.annotsRenderDeferred.promise.then((function(){return t.addAnnotRenders(e)}));return this.annotsRender.addAnnotRenders(e)}},{key:"getPageAreaRenderer",value:function(e,t){return new br(this,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3&&void 0!==arguments[3]&&arguments[3])}},{key:"getSnapshot",value:function(e,t,n,i){var r=1,o=window.localStorage.getItem("PREFERENCES-GENNERAL");if(o){var a=JSON.parse(o),s=a.resolution;a.fixedResolution&&(r=s/96)}var u=this.getPageAreaRenderer(n*r,i*r,r,!0);return u.setPosition(e+n/2,t+i/2),u.update().then((function(e){var t=(0,j.createDeferred)();return e.toBlob((function(e){return t.resolve(e)}),"image/png"),t.promise}))}},{key:"unActiveAnnotRender",value:function(){try{this.annotsRender.unActiveAnnot()}catch(e){}}},{key:"activeGraphicsObject",value:function(e){}},{key:"addCustomRenders",value:function(e){this.customsRender.addCustomRenders(e)}},{key:"removeCustomRenders",value:function(e){this.customsRender.removeCustomRenders(e)}},{key:"updateCustomRenders",value:function(e){this.customsRender.updateCustomRenders(e)}},{key:"setWatermarkConfig",value:function(e){this.watermarkConfig=e}},{key:"getWatermarkConfig",value:function(){return this.page&&this.page.isVirtual()?{content:"VIRTUAL PAGE",type:"text",watermarkSettings:void 0,watermarkTextProperties:{font:"Microsoft Yahei",fontSize:40,color:"#000000",fontStyle:"normal",lineSpace:10,alignment:"center"}}:this.watermarkConfig}},{key:"endRender",value:function(){var e=this.renderSerialPromise;e&&e.end().catch($o);var t=this.annotsRender;t&&t.endRender()}},{key:"invisibleRender",value:function(e){var t=this;return(0,_._)((function(){var n,i,r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return t.endRender(),n=t.pageContentTiles,i=t.annotsRender,e?(n&&(n.destroy(),delete t.pageContentTiles),(r=t.stateHandler)&&(r.destroyPageHandler(),delete t.stateHandler),t.page?(t.page.clearRenderCache(),[4,t.page.clearCacheObjects()]):[3,2]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,4];case 3:n&&n.invisibleRender(),i&&i.invisibleRender(),o.label=4;case 4:return[2]}}))}))()}},{key:"move",value:function(){}},{key:"renderingFollowPromise",value:function(){}},{key:"triggerAction",value:function(e){var t=this;setTimeout((function(){if(t.page&&!t.page.isDestroyed&&t.annotsRender)return!t.annotsRender.widgetsDone&&t.page.annots.length?t.triggerAction(e):void t.page.annots.forEach((function(n){n.getAdditionalAction&&t.docRender.formRender.execAction("annot",n.getAdditionalAction(e),n,n,vo[e])}))}),200)}},{key:"getContainerVisibleRect",value:function(){var e=this.docRender,t=this.$ui[0].getBoundingClientRect(),n=e.getContainerVisibleRect(),i=(n.right-n.left)/2|0,r=(n.bottom-n.top)/2|0,o=Math.max(t.left,n.left)-t.left-i,a=Math.min(t.right,n.right)-t.left+i,s=Math.max(t.top,n.top)-t.top-r,u=Math.min(t.bottom,n.bottom)-t.top+r;return o<0&&(o=0),s<0&&(s=0),a>this.getShowWidth()&&(a=this.getShowWidth()),u>this.getShowHeight()&&(u=this.getShowHeight()),{left:o,right:Math.max(o,a),top:s,bottom:Math.max(s,u)}}},{key:"getCurrentVisibleRect",value:function(){var e=this.docRender,t=this.$ui[0].getBoundingClientRect(),n=e.getContainerVisibleRect(),i=n.right-n.left,r=n.bottom-n.top,o=Go(0,n.left-t.left),a=Go(0,n.top-t.top),s=zo(Go(0,t.width-o),i),u=zo(Go(0,t.height-a-Go(0,t.bottom-n.bottom)),r);return{left:o,top:a,width:s,height:u,right:o+s,bottom:a+u}}},{key:"getContainerFullRect",value:function(){var e=this.docRender,t=this.$ui[0].getBoundingClientRect(),n=e.getContainerVisibleRect();return{left:n.left-t.left,right:n.right-t.right,top:n.top-t.top,bottom:n.bottom-t.bottom}}},{key:"getPDFRectFromClientRect",value:function(e){var t=this.$ui[0].getBoundingClientRect(),n=e.left-t.left,i=e.top-t.top,r={left:n,top:i,right:n+e.width,bottom:i+e.height};return this.page.reverseDeviceRect(r,this.scale,this.rotate)}},{key:"getPDFPointFromClientPoint",value:function(e,t,n){var i=this.$ui[0].getBoundingClientRect();return n?[e-i.left,t-i.top]:this.page.reverseDevicePoint([e-i.left,t-i.top],this.scale,this.rotate)}},{key:"formatGridOptions",value:function(e){if(e){var t=Oi(e.unit);if(t){var n=this.getScale(),i=t.convertTo(e.width*n,Ti),r=t.convertTo(e.height*n,Fi),o=t.convertTo(e.offsetLeft*n,Ti),a=t.convertTo(e.offsetTop*n,Fi),s=e.subdivisions;return{lineWidth:i,lineHeight:r,offsetLeft:o,offsetTop:a,subLineWidth:i/s,subLineHeight:r/s,maxWidth:this.getShowWidth(),maxHeight:this.getShowHeight()}}}}},{key:"renderLayoutGrid",value:function(e,t,n,i,r,o,a){var s=this.pdfViewer.getLayoutGrid();if(s&&Oi(s.unit)){var u=e.canvas.width,c=e.canvas.height;e.getImageData(0,0,1,1);var l=s.color,d=l.match(/rgba?\((\d*),\s*(\d*),\s*(\d*),?\s*([\.0-9]*)?\)/)||[l,127,127,255],h=+d[1],f=+d[2],g=+d[3],v=.67,p="rgba("+(h+(255-h)*v)+","+(f+(255-f)*v)+","+(g+(255-g)*v)+","+(+d[4]||1)+")",m=this.formatGridOptions(s),y=m.lineWidth,k=m.lineHeight,b=m.offsetLeft,w=m.offsetTop,_=m.subLineWidth,P=m.subLineHeight,A=Math.abs((i-b)%y-y)%y,S=Math.abs((r-w)%k-k)%k,x=Math.abs((i-b)%_-_)%_,C=Math.abs((r-w)%P-P)%P,D=u,E=c;for(i=Math.max(0,i),r=Math.max(0,r),e.beginPath(),e.strokeStyle=p,e.lineWidth=1;x<D;)e.moveTo(x,0),e.lineTo(x,E),x+=_;for(;C<E;)e.moveTo(0,C),e.lineTo(D,C),C+=P;for(e.stroke(),e.beginPath(),e.strokeStyle=l;A<D;)e.moveTo(A,0),e.lineTo(A,E),A+=y;for(;S<E;)e.moveTo(0,S),e.lineTo(D,S),S+=k;e.stroke()}}},{key:"getTextRectsAtRect",value:function(e){var t,n=this;return this.getPDFPage().then((function(i){return(t=i).reverseDeviceRect(e,n.scale,n.rotate)})).then((function(e){return t.getTextRectsAtRect(e)}))}},{key:"renderArticles",value:function(e){var t=this;this.doc&&this.doc.hasArticle()&&(e&&e.length>0?Promise.resolve(e):this.doc.getPdfArticle().getArticleList()).then((function(e){e.forEach((function(e){(e.children||[]).forEach((function(n){t.renderArticle(e,n)}))}))}))}},{key:"renderArticle",value:function(e,t){var n=this.articleBeads.hasOwnProperty(t.objNum);t.pageIndex===this.index&&(n?this.articleBeads[t.objNum].updateRender(e,t):this.articleBeads[t.objNum]=new go(this,e,t))}},{key:"getSignaturePDFRect",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getRotation(),o=this.getScale(),a={},s=this.$handler.find("#".concat(e));if(!s.length)return Promise.resolve();var u=s.find("canvas")[0].width+2,c=s.find("canvas")[0].height+2;90===r||270===r?(n=u,t=c):(t=u,n=c),a.top=parseFloat(s.css("top")),a.left=parseFloat(s.css("left")),a.right=a.left+t,a.bottom=a.top+n;var l="".concat(a.top,"_").concat(a.left,"_").concat(a.right,"_").concat(a.bottom),d=JSON.parse(localStorage.getItem("device_rect_map")||"{}"),h=(0,k._)({},d,i);return Object.keys(h).length&&l in h?Promise.resolve(h[l]):this.getPDFPage().then((function(e){var t=e.reverseDeviceRect(a,o,r);i[l]=t;var n=(0,k._)({},d,i);return localStorage.setItem("device_rect_map",JSON.stringify(n)),t}),(function(){return Promise.resolve()}))}}],[{key:"getDefaultName",value:function(){return"pdfPageRender"}}]),n}(te);const Xo=Jo;function Zo(e){return JSON.parse(JSON.stringify(e)).reduce((function(e,t){if(2===t.length){for(var n=[],i=t[0];i<t[1];i++)n.push(i);t=n}return e.concat(t)}),[])}var Qo=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"viewMode",void 0),(0,J._)(this,"executor",void 0),this.viewMode=t,j.Lazy.property(this,"executor",(function(){return new j.ThrottleAsyncTaskExecutor(80)}))}return(0,A._)(e,[{key:"getPageCount",value:function(){var e=this.getPDFDocRender();if(!e)return 0;var t=e.getPDFDoc();return t?t.getPageCount():0}},{key:"getPDFDocRender",value:function(){return this.viewMode.docRender}},{key:"onKeyReleased",value:function(e){return!1}}]),e}(),ea=function(){function e(t){(0,P._)(this,e),this.docRender=t,t.$ui.addClass("fv__view-mode"),this.pageDOMs=[],this.shortcutEventHandler=this.generateShortcutEventHandler()}return(0,A._)(e,[{key:"getItems",value:function(){return this.pageDOMs}},{key:"into",value:function(e,t){this.pageDOMs=t;var n=document.createDocumentFragment();"function"==typeof n.append?n.append.apply(n,t):t.forEach((function(e){n.appendChild(e)})),e.innerHTML="",e.appendChild(n)}},{key:"updatePageDOMs",value:function(e){this.pageDOMs=e}},{key:"renderViewMode",value:function(e,t,n,i,r){}},{key:"afterRenderVisiblePages",value:function(){}},{key:"jumpToPage",value:function(e,t){t.x,t.y}},{key:"getFitHeight",value:function(e){}},{key:"getFitWidth",value:function(e){}},{key:"getVisibleIndexes",value:function(){return this.docRender.getVisiblePageIndexes()}},{key:"getCurrentPageIndex",value:function(){return 0}},{key:"getPrevPageIndex",value:function(){return Math.max(0,this.getCurrentPageIndex()-1)}},{key:"getNextPageIndex",value:function(){var e=this.docRender.getPDFDoc().getPageCount();return Math.min(e-1,this.getCurrentPageIndex()+1)}},{key:"out",value:function(){this.docRender=null,this.pageDOMs=[]}},{key:"generateShortcutEventHandler",value:function(){}},{key:"getShortcutEventHandler",value:function(){return this.shortcutEventHandler}}],[{key:"getName",value:function(){}}]),e}();const ta=ea;function na(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"string"==typeof e&&(e=parseFloat(e)),isFinite(e)?e:t}var ia=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"onKeyPressed",value:function(e){var t=this,n=this.viewMode,i=n.fixedVerticalPosition;switch(e.command){case ko.JUMP_TO_FIRST_PAGE:return this.executor.exec((function(){return t.jumpToFirstPage()})),!0;case ko.JUMP_TO_LAST_PAGE:return this.executor.exec((function(){return t.jumpToLastPage()})),!0;case ko.JUMP_TO_PREVIOUS_PAGE:return this.executor.exec((function(){return n.jumpToPrevPage()})),!0;case ko.JUMP_TO_NEXT_PAGE:return this.executor.exec((function(){return n.jumpToNextPage()})),!0}if(i)switch(e.command){case ko.SCROLL_TO_PREVIOUS_VISIBLE_AREA:case ko.ARROW_UP:return this.executor.exec((function(){return n.jumpToPrevPage()})),!0;case ko.SCROLL_TO_NEXT_VISIBLE_AREA:case ko.ARROW_DOWN:return this.executor.exec((function(){return n.jumpToNextPage()})),!0}else{var r=n.computePageMetadata(n.currentPageIndex);if(!r)return!1;var o=n.scrollWrap,a=r.pageHeight,s=r.visibleBoxHeight,u=r.visibleBoxWidth,c=r.scrollTop,l=n.scrollWrap.getScrollTop(),d=80;switch(e.command){case ko.SCROLL_TO_PREVIOUS_VISIBLE_AREA:case ko.SCROLL_VIEWER_SCROLLBAR_UP:d=s;case ko.ARROW_UP:return this.executor.exec((function(){if(l>c){var e=l-c;return e=Math.min(d,e),o.scrollBy(0,-e,"smooth"),Promise.resolve()}return n.jumpToPrevPage()})),!0;case ko.SCROLL_TO_NEXT_VISIBLE_AREA:case ko.SCROLL_VIEWER_SCROLLBAR_DOWN:d=s;case ko.ARROW_DOWN:return this.executor.exec((function(){if(l>=c+(a-s))return n.jumpToNextPage();if(l>=c){var e=a-(l-c)-s;e=Math.min(e,d),o.scrollBy(0,e,"smooth")}return Promise.resolve()})),!0;case ko.SCROLL_VIEWER_SCROLLBAR_LEFT:return o.scrollBy(-u,0,"smooth"),!0;case ko.SCROLL_VIEWER_SCROLLBAR_RIGHT:return o.scrollBy(u,0,"smooth"),!0}}return!1}},{key:"jumpToFirstPage",value:function(){return this.viewMode.jumpToPage(0,{x:0,y:0})}},{key:"jumpToLastPage",value:function(){var e=this.getPageCount();return this.viewMode.jumpToPage(e-1,{x:0,y:0})}}]),n}(Qo),ra="up",oa="down",aa="left-top",sa="left-bottom",ua=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;(0,P._)(this,n),(i=t.call(this,e)).currentPageIndex=0,i.scrollWrap=i.docRender.viewerRender.scrollWrap,i.lastScale=null,i.isZoomin=!1,i.fixedVerticalPosition=!1,i.currentPageOffset=0,i.rerenderViewExecutor=new j.DebounceAsyncTaskExecutor(100),i.rerenderPageExecutor=new j.DebounceAsyncTaskExecutor(10),i.scrollEventExecutor=new j.DebounceAsyncTaskExecutor(100),i.dragScrollbarEventExecutor=new j.ThrottleAsyncTaskExecutor(50,!0),i.queuedDragScrollbarEventExecutor=new j.QueuedAsyncTaskExecutor,i.mouseWheelExecutor=new j.QueuedAsyncTaskExecutor,i.jumpPageExecutor=new j.DebounceAsyncTaskExecutor,i.unbindScrollEvent=qi,i.unbindMouseEvent=qi,i.unbindWheelEvent=qi,i.allowHandleScrollOnWheel=!1,i.isMouseDownOnScrollbar=!1,i.handledWheel=!1,i.instanceId=rr(),i.diffJumpPage=i.diffJumpPage.bind((0,w._)(i)),i.forceUpdatePageContainer=i.forceUpdatePageContainer.bind((0,w._)(i)),i.currentScrollDirection;var r=i.scrollWrap.getScrollHost();r===window&&(r=document.documentElement);var o=function(e){var t=e.clientX,n=i.getCurrentVisibleBoxRect(),o=getComputedStyle(r),a=(parseInt(o.borderLeftWidth)||0)+(parseInt(o.borderRightWidth)||0),s=r.offsetWidth,u=s-r.clientWidth-a;i.isMouseDownOnScrollbar=t>=s-u+n.left},a=function(e){i.isMouseDownOnScrollbar=!1};return r.addEventListener("mousedown",o,{capture:!0}),window.addEventListener("mouseup",a,{capture:!0}),i.unbindMouseEvent=function(){r.removeEventListener("mousedown",o,{capture:!0}),window.removeEventListener("mouseup",a,{capture:!0})},i}return(0,A._)(n,[{key:"diffJumpPage",value:function(){var e=(new Date).getTime(),t=e;return isNaN(this.countNum)?(this.countNum=0,this.lastCountDateTime=e):(this.countNum++,t=e-this.lastCountDateTime,this.lastCountDateTime=e),t}},{key:"getPDFPageRender",value:function(e){return this.docRender.pagesRender.pageRenders[e]}},{key:"into",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.currentPageIndex;this.docContainer=e,this.pageDOMs=t,e.classList.add("fv__viewer-single-view-mode");var i=this.pageDOMs[n],r=e.childNodes;if(r.length>1){if(j.isIE)for(var o=r.length-1;o>=0;o--)e.removeChild(r[o]);else e.innerHTML="";e.appendChild(i)}else 1===r.length?e.contains(i)||e.replaceChild(i,r[0]):e.contains(i)||e.appendChild(i);this.renderPageContainer(),this.scrolledToPage(n),this.bindScrollEvent(),this.bindWheelEvent(),this.docRender.pdfViewer.eventEmitter.on(de.pageAdded,this.forceUpdatePageContainer),this.docRender.pdfViewer.eventEmitter.on(de.pageRemoved,this.forceUpdatePageContainer),this.docRender.pdfViewer.eventEmitter.on(de.pagesInserted,this.forceUpdatePageContainer)}},{key:"out",value:function(){this.pageDOMs.forEach((function(e){e.style.top&&(e.style.top="")})),this.docRender.pdfViewer.eventEmitter.off(de.pageAdded,this.forceUpdatePageContainer),this.docRender.pdfViewer.eventEmitter.off(de.pageRemoved,this.forceUpdatePageContainer),this.docRender.pdfViewer.eventEmitter.off(de.pagesInserted,this.forceUpdatePageContainer),this.unbindScrollEvent(),this.unbindWheelEvent(),this.unbindMouseEvent(),this.rerenderViewExecutor.cancel(),this.rerenderPageExecutor.cancel(),this.jumpPageExecutor.cancel(),this.scrollEventExecutor.cancel(),this.mouseWheelExecutor.cancel(),this.dragScrollbarEventExecutor.cancel(),this.queuedDragScrollbarEventExecutor.cancel(),this.resetCurrentPageDom(),this.enableScroll(),this.docContainer.classList.remove("fv__viewer-single-view-mode"),this.isMouseDownOnScrollbar=!1,this.docContainer.style.height=""}},{key:"rebindScrollEvent",value:function(){this.bindScrollEvent()}},{key:"forceUpdatePageContainer",value:function(){this.renderPageContainer(!0)}},{key:"updateScrollPosition",value:function(){var e=this,t=this.currentPageIndex,n=this.pageDOMs[t],i=function(t){var i=e.scrollWrap.getScrollTop();n.style.cssText+="top: ".concat(t.pageOffset+i,"px")};if(!this.isPageRendered(t))return this.computePageMetadataAsync(t).then(i);i(this.computePageMetadata(t))}},{key:"keepPagePosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.fixedVerticalPosition||e)return this.updateScrollPosition()}},{key:"isValidCurrentPageIndex",value:function(){var e=this.docRender;if(!e)return!1;var t=e.pagesRender;if(!t)return!1;var n=t.pageRenders;if(!n)return!1;var i=this.currentPageIndex;return i>=0&&i<n.length}},{key:"bindScrollEvent",value:function(){var e=this;this.unbindScrollEvent();var t=this.scrollWrap.getScrollTop();this.unbindScrollEvent=this.scrollWrap.addScrollEventListener((function(n){if((e.allowHandleScrollOnWheel||(e.allowHandleScrollOnWheel=!0,e.isMouseDownOnScrollbar||!j.isChrome&&!j.isChromiumEdge))&&e.isValidCurrentPageIndex()){var i=e.keepPagePosition(),r=function(){var n=e.scrollWrap.getScrollTop(),i=t;if(n>i?e.currentScrollDirection=oa:n<i&&(e.currentScrollDirection=ra),e.isMouseDownOnScrollbar)e.queuedDragScrollbarEventExecutor.exec((function(){return t=n,e.handleDragScrollbar(e.scrollWrap.getScrollTop(),e.currentScrollDirection)}));else{var r=!1;switch(e.currentScrollDirection){case oa:r=e.isBottomOutOfBoundsOnWheel();break;case ra:r=e.isTopOutOfBoundsOnWheel()}if(!r)return t=n,e.handleWheel(e.scrollWrap.getScrollTop(),e.currentScrollDirection);var o=e.handleWheel(n,e.currentScrollDirection);e.scrollEventExecutor.exec((function(){return o}))}};(0,D._)(i,Promise)?i.then(r):r()}}))}},{key:"bindWheelEvent",value:function(){var e=this;this.unbindWheelEvent();var t=function(t){if(!j.keyboardStatus.isCtrlDown){e.allowHandleScrollOnWheel=!1;var n,i=t.deltaY;if(i<0)n=ra;else{if(!(i>0))return;n=oa}e.currentScrollDirection=n,e.fixedVerticalPosition?(t.preventDefault(),e.keepPagePosition(),e.mouseWheelExecutor.exec((function(){switch(n){case oa:return e.jumpToNextPage();case ra:return e.jumpToPrevPage()}return Ie}))):j.keyboardStatus.isShiftDown||!j.isChrome&&!j.isChromiumEdge||(e.allowHandleScrollOnWheel=!0)}},n=this.scrollWrap.getScrollHost();n.addEventListener("wheel",t,{passive:!1}),this.unbindWheelEvent=function(){n.removeEventListener("wheel",t,{passive:!1})}}},{key:"handleDragScrollbar",value:function(e,t){if(this.fixedVerticalPosition){var n=this.computePageIndex(e);if(n!==this.currentPageIndex)return this.scrolledToPage(n,t)}else{if(t===ra)return this.handleDragUp(e);if(t===oa)return this.handleDragDown(e)}return Ie}},{key:"handleWheel",value:function(e,t){if(this.fixedVerticalPosition){var n=this.computePageIndex(e);if(n!==this.currentPageIndex)return this.scrolledToPage(n,t)}else{if(t===ra)return this.handleWheelUp(e);if(t===oa)return this.handleWheelDown(e)}return Ie}},{key:"handleWheelUp",value:function(e){this.handledWheel=!0;var t=this.getPDFPageRender(this.currentPageIndex),n=this.getCurrentVisibleBoxRect();if(t.$element[0].getBoundingClientRect().top>=n.top)return this.jumpToPrevPage()}},{key:"handleWheelDown",value:function(e){this.handledWheel=!0;var t=this.getPDFPageRender(this.currentPageIndex),n=this.getCurrentVisibleBoxRect();if(t.$element[0].getBoundingClientRect().bottom<n.bottom)return this.jumpToNextPage()}},{key:"isBottomOutOfBoundsOnWheel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentPageIndex,t=this.getPDFPageRender(e),n=this.getCurrentVisibleBoxRect();return t.$element[0].getBoundingClientRect().bottom<n.bottom}},{key:"isTopOutOfBoundsOnWheel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentPageIndex,t=this.getPDFPageRender(e),n=this.getCurrentVisibleBoxRect();return t.$element[0].getBoundingClientRect().top>n.top}},{key:"handleDragUp",value:function(e){var t=this.computePageMetadata(this.currentPageIndex);if(t){var n=t.pageTop,i=t.visibleBoxHeight,r=this.pageDOMs[this.currentPageIndex],o=n-i;if(e>o&&e<n)r.style.cssText+="top: ".concat(e,"px");else if(e<o){var a=this.computePageIndex(e);return this.jumpToPage(a,ra)}return Ie}}},{key:"handleDragDown",value:function(e){var t=this.computePageIndex(e);if(t!==this.currentPageIndex)return this.jumpToPage(t,oa);var n=this.currentPageIndex,i=this.scrollWrap.getScrollTop(),r=this.computePageMetadata(n);if(r){var o=r.scrollTop,a=r.pageHeight,s=r.visibleBoxHeight;if(i>o+a-s&&this.pageDOMs.length>1){var u=i+s-a;this.pageDOMs[n].style.cssText+="top: ".concat(u,"px")}return Ie}}},{key:"doJumpOnScroll",value:function(e){var t=this,n=function(n){var i=n.pageHeight-n.visibleBoxHeight;return t.jumpToPage(e,{y:i},!1).then((function(){t.docRender.getPDFPageRender(n.pageIndex).renderLayout()}))};return this.isPageRendered(e)?n(this.computePageMetadata(e)):this.computePageMetadataAsync(e).then(n)}},{key:"jumpToPage",value:function(e,t){var n=this,i=this.docRender.getPDFDoc().getPageCount();if(e<0||e>=i)throw new Error("Illegal page index value: "+e);var r=function(){return n.unbindScrollEvent(),n.computePageMetadataAsync(e).then((function(i){n.currentPageIndex=e;var r=n.waitForScrollEnd();try{n.rerenderPage(i),n.scrollToPage(i,t),n.docRender.setCurrentPageIndex(e)}finally{return r.finally((function(){n.currentPageIndex=e,n.rebindScrollEvent()}))}}))};return e===this.currentPageIndex?r():this.jumpPageExecutor.exec(r)}},{key:"waitForScrollEnd",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=(0,j.createDeferred)(),r=this.scrollWrap.addScrollEventListener((function(n){n.isMock||(clearTimeout(e),e=setTimeout((function(){r(),i.resolve(),clearTimeout(e)}),t))}));return n&&(e=setTimeout((function(){r(),i.resolve(),clearTimeout(e)}),t)),i.promise}},{key:"jumpPageByWheelOnFixedPosition",value:function(e){var t=this;if(this.fixedVerticalPosition)return this.mouseWheelExecutor.exec((function(){var n,i;switch(e){case oa:n=t.getNextPageIndex(),i=aa;break;case ra:n=t.getPreviousPageIndex(),i=sa;break;default:return}if(n!==t.currentPageIndex)return t.unbindScrollEvent(),t.computePageMetadataAsync(index).then((function(e){t.currentPageIndex=index;var n=t.waitForScrollEnd(0,!1);try{t.rerenderPage(e),t.scrollToPage(e,i),t.docRender.setCurrentPageIndex(index)}finally{return n.finally((function(){t.currentPageIndex=index,t.rebindScrollEvent()}))}}))}))}},{key:"jumpToNextPage",value:function(){var e=this.getNextPageIndex();return e===this.currentPageIndex?Ie:this.jumpToPage(e)}},{key:"jumpToPrevPage",value:function(){var e=this.getPrevPageIndex();return e===this.currentPageIndex?Ie:this.jumpToPage(e,sa,!1)}},{key:"formatPosition",value:function(e,t){var n=Math.max(0,e.pageHeight-e.visibleBoxHeight),i=Math.max(0,e.pageWidth-e.visibleBoxWidth);switch(t){case sa:return{y:n};case aa:return{};case"right-top":return{x:i};case"right-bottom":return{x:i,y:n}}return t}},{key:"scrolledToPage",value:function(e,t){var n=this;this.currentPageIndex=e;var i=function(i){i&&(n.rerenderPage(i),n.renderPagePosition(i,t),n.docRender.setCurrentPageIndex(e))};return this.isPageRendered(e)?(i(this.computePageMetadata(e)),Ie):this.computePageMetadataAsync(e).then(i)}},{key:"resetCurrentPageDom",value:function(){this.currentPageOffset=0;var e=this.pageDOMs[this.currentPageIndex];e&&(e.style.top="")}},{key:"rerenderPage",value:function(e){var t=this;if(e){var n=e.pageIndex,i=e.pageWidth,r=e.pageHeight,o=e.pageTop,a=e.visibleBoxHeight,s=e.visibleBoxWidth,u=e.refresh,c=this.pageDOMs[n],l=this.docContainer;if(n!==this.currentPageIndex||u||!c.parentElement){var d=l.childNodes;if(d.length>1){if(j.isIE)for(var h=d.length-1;h>=0;h--)l.removeChild(d[h]);else l.innerHTML="";l.appendChild(c)}else 1===d.length?l.contains(c)||l.replaceChild(c,d[0]):l.contains(c)||l.appendChild(c);this.resetCurrentPageDom(),this.currentPageIndex=n}var f=i<=s,g=r<=a;this.fixedVerticalPosition=r<=a,c.style.cssText+="top: ".concat(o,"px;"),c.children[0].style.cssText+="width:".concat(i,"px;height:").concat(r,"px");var v=this.docRender,p=this.docRender.getPDFPageRender(n).pagesRender,m=v.rotation;return p.getPageScale(n,v.scale,m).then((function(e){t.docRender.pdfViewer.eventEmitter.emit(de.updateScrollableStatus,{disableHorizontal:f,disableVertical:g})}))}}},{key:"renderPagePosition",value:function(e,t){if(e){var n=e.pageHeight,i=e.pageTop,r=e.scrollTop,o=e.visibleBoxHeight,a=this.pageDOMs[e.pageIndex];if(this.fixedVerticalPosition)this.keepPagePosition();else{a.style.cssText+="top: ".concat(i,"px;");var s=this.scrollWrap.getScrollTop();if(t===oa){if(s>r+n-o){var u=s+o-n;a.style.cssText+="top: ".concat(u,"px")}}else if(t===ra){s>i-o&&s<i&&(a.style.cssText+="top: ".concat(s,"px"))}else{var c=a.offsetTop;c>s?a.style.cssText+="top: ".concat(s,"px"):c+n<s+o&&(a.style.cssText+="top: ".concat(s+o-n,"px"))}}}}},{key:"scrollToPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.visibleBoxHeight,r=e.visibleBoxWidth,o=e.pageHeight,a=e.pageWidth,s=e.scrollTop,u=e.pageTop,c=this.formatPosition(e,t),l=c.x,d=void 0===l?this.scrollWrap.getScrollLeft():l,h=c.y,f=void 0===h?0:h;o<=i&&(f=0),a<r&&(d=0);var g,v,p=d;v=o>=i?u+(o-i):s,g=Math.min(s+Math.max(0,f),v),this.scrollWrap.scrollTo(p,g,n?"smooth":"auto")}},{key:"computePageMetadataAsync",value:function(e){var t=this,n=this.docRender,i=n.pagesRender.pageRenders[e],r=n.scale,o=n.rotation;return this.isPageRendered(e)?i.computePageSize(r,o).then((function(n){return t.computePageMetadata(e)})):i?i.computePageSize(r,o).then((function(){var n=t.computePageMetadata(e);return t.docContainer.style.cssText+="height: ".concat(n.containerHeight,"px"),n})):Promise.resolve()}},{key:"isPageRendered",value:function(e){var t=this.docRender.pagesRender.pageRenders[e];if(!t)return!1;var n=t.getShowHeight();return"number"==typeof n&&!isNaN(n)&&isFinite(n)}},{key:"computePageMetadata",value:function(e){var t,n,i=null===(n=this.docRender)||void 0===n||null===(t=n.pagesRender)||void 0===t?void 0:t.pageRenders[e];if(i){var r=this.scrollWrap.getHeight(),o=this.scrollWrap.getWidth(),a=i.getShowHeight(),s=i.getShowWidth(),u=this.computeScrollTop(e),c=this.computeContainerHeight(e,u),l=.5*Math.max(0,r-a);return{visibleBoxHeight:r,visibleBoxWidth:o,pageIndex:e,pageHeight:a,pageWidth:s,containerHeight:c,pageTop:u+l,scrollTop:u,pageOffset:l,occupiedHeight:Math.max(r,a)}}}},{key:"computeScrollTop",value:function(e){for(var t=this.scrollWrap.getHeight(),n=this.docRender.pagesRender.pageRenders,i=0,r=0,o=0;o<e;o++){var a=n[o].getShowHeight();("number"!=typeof a||isNaN(a))&&(a=o>0?r/o:t),r+=a,i+=Math.max(t,a)}return i}},{key:"computePageIndex",value:function(e){for(var t=this.docRender.pagesRender.pageRenders,n=this.scrollWrap.getHeight(),i=0,r=0,o=0;o<t.length;o++){var a=t[o].getShowHeight();this.isPageRendered(o)||(a=o>0?r/o:n);var s=Math.max(a,n);if(e>=i&&e<i+s)return o;r+=a,i+=s}return-1}},{key:"computeContainerHeight",value:function(e,t){var n=this.scrollWrap.getHeight(),i=this.docRender.pagesRender&&this.docRender.pagesRender.pageRenders,r=t;if(i)for(var o=e;o<i.length;o++){var a=i[o].getShowHeight();("number"!=typeof a||isNaN(a))&&(a=o>0?r/o:r),r+=Math.max(n,a)}return j.isMobile&&(r+=10),r}},{key:"renderViewMode",value:function(e){var t=this;if(e.index===this.currentPageIndex){var n=this.computePageMetadata(e.index),i=e.getScale();null==this.lastScale?this.isZoomin=!1:this.isZoomin=this.lastScale<i,this.lastScale=i,n.refresh=!0,this.rerenderPage(n),this.renderPagePosition(n)}this.rerenderViewExecutor.exec((function(){t.renderPageContainer()}))}},{key:"renderPageContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.computeContainerHeight(0,0);this.docContainer.style.cssText+="height: ".concat(t,"px"),this.keepPagePosition(e)}},{key:"disableScroll",value:function(e){this.docRender.pdfViewer.eventEmitter.emit(de.disableScroll,e)}},{key:"enableScroll",value:function(e){this.docRender.pdfViewer.eventEmitter.emit(de.enableScroll,e)}},{key:"getFitWidth",value:function(e){var t=this.scrollWrap,n=getComputedStyle(this.pageDOMs[e]);return t.getWidth()-na(n.marginLeft)-na(n.marginRight)}},{key:"getFitHeight",value:function(e){return this.scrollWrap.getHeight()}},{key:"getVisibleIndexes",value:function(){return[this.currentPageIndex]}},{key:"getCurrentPageIndex",value:function(){return this.currentPageIndex}},{key:"getScrollHostElement",value:function(){var e=this.scrollWrap.getScrollHost();return e===window?document.body:e}},{key:"getCurrentVisibleBoxRect",value:function(){var e=this.scrollWrap.getScrollHost();if(e===window||e===document.body||e===document.documentElement){var t=document.documentElement.clientWidth,n=document.documentElement.clientHeight;return{x:0,y:0,width:t,height:n,left:0,right:t,top:0,bottom:n}}return e.getBoundingClientRect()}},{key:"generateShortcutEventHandler",value:function(){return new ia(this)}}],[{key:"getName",value:function(){return"single-page-view-mode"}}]),n}(ta),ca=(j.LoggerFactory.getLogger("PDFPagesRender"),function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;(0,P._)(this,n),(o=t.call(this,r)).name=n.getDefaultName(),o.$element=e.parent(),o.$ui=e,o.pageDOMs=[],o.doc=i,o.docRender=r;var a=r.viewerRender.ViewMode;return o.viewMode=new a(r),o.viewerRender=r.viewerRender,o.pdfViewer=o.viewerRender.pdfViewer,o.pageRenders=[],o.scale=1,o.rotate=0,o.neverRendered=!0,o.minScale=+o.pdfViewer.config.minScale,o.maxScale=+o.pdfViewer.config.maxScale,o.isPageDOMsLoaded=!1,o.pdfViewer.eventEmitter.on(de.layerVisibleChange,o.layerVisibleChange=function(e){o.doc===e&&(o.setRenderFlags(2),o.renderVisiblePages().catch((function(e){0})),o.pageRenders.forEach((function(e){e.page&&e.rebuildAnnots(e.scale,e.rotate)})))}),o.pdfViewer.eventEmitter.on(de.imageAdded,o.imageAdded=function(e){var t=o.viewMode.getVisibleIndexes(),n=e.getIndex();if(-1!==t.indexOf(n)){var i=o.pageRenders[n];i&&i.redrawContent(!0).then((function(e){o.setRenderFlags(2),o.renderVisiblePages()}))}}),o.pdfViewer.eventEmitter.on(de.watermarkAdded,o.watermarkAdded=o.imageAdded),o.pdfViewer.eventEmitter.on(de.watermarkRemoved,o.watermarkRemoved=function(e){o.viewMode.getVisibleIndexes().forEach((function(e){var t=o.pageRenders[e];t&&t.redrawContent(!0).then((function(e){o.setRenderFlags(2),o.renderVisiblePages()}))}))}),o.pdfViewer.eventEmitter.on(de.graphicsUpdated,o.graphicsUpdated=function(e){var t=o.viewMode.getVisibleIndexes(),n=e.getIndex();-1!==t.indexOf(n)&&(o.setRenderFlags(2),o.renderVisiblePages())}),o.pdfViewer.eventEmitter.on(de.pageAdded,o.pageAdded=function(e){var t=e.getIndex();o.addNewPageByIndex(t)}),o.pdfViewer.eventEmitter.on(de.pageMoved,o.pageMoved=function(e,t){o.movePageRender(e,t)}),o.pdfViewer.eventEmitter.on(de.pagesMoved,o.pagesMoved=function(e,t,n){o.movePagesRender(e,t,n)}),o.pdfViewer.eventEmitter.on(de.pageRemoved,o.pageRemoved=function(e){o.removePageByIndex(e);var t=o.pageRenders.length,n=o.viewMode.getCurrentPageIndex();if(n===e){var i=Math.min(n,t-1);o.docRender.goToPage(i),o.viewMode.currentPageIndex=i}}),o.pdfViewer.eventEmitter.on(de.pagesRemoved,o.pagesRemoved=function(e){var t=Zo(e).sort((function(e,t){return t-e})),n=o.viewMode.getCurrentPageIndex();t.forEach((function(e){var t=o.pageRenders[e];t&&(t.destroy(),o.pageRenders.splice(e,1),e<n&&n--)})),o.pageRenders.forEach((function(e,t){e.updateIndex(t)})),o.updatePageDOMs();var i=o.doc.getPageCount();n=Math.max(0,Math.min(n,i-1)),o.docRender.goToPage(n),o.viewMode.currentPageIndex=n}),o.pdfViewer.eventEmitter.on(de.importPages,o.importPages=function(e){o.importPagesByArray(e)}),o.pdfViewer.eventEmitter.on(de.pagesReplace,o.pagesReplace=function(e){var t=e.delPageRange,n=e.pages;t.sort((function(e,t){return t-e})).forEach((function(e){o.removePageByIndex(e)})),o.importPagesByArray(n)}),o.pdfViewer.eventEmitter.on(de.applyRedaction,o.applyRedaction=function(e){var t=o.pdfViewer;if(!1!==e){var n=t.getPDFDocRender(),i=n.pagesRender;if(!i)return;e.forEach((function(e){var t=e.pageIndex,i=e.removedAnnots;if(0!==i.length){var r=n.pagesRender.pageRenders[t];if(r&&r.annotsRender)for(var o=r.page.annots,a=o.length-1;a>=0;a--){var s=o[a];-1!==i.indexOf(s.objectNumber)&&(s.info.isDeleted=!0,o.splice(a,1))}}})),i.setRenderFlags(10),i.renderVisiblePages(),t.eventEmitter.emit(de.redactAnnotApplyed,(0,w._)(o))}}),o.pdfViewer.eventEmitter.on(de.flattened,o.flattened=function(e){o.setRenderFlags(10),o.renderVisiblePages()}),o.pdfViewer.eventEmitter.on(de.headerFooterUpdated,o.headerFooterUpdated=o.flattened),o.pdfViewer.eventEmitter.on(de.headerFooterAdded,o.headerFooterAdded=o.flattened),o}return(0,A._)(n,[{key:"setViewMode",value:function(e){var t=this;return(0,_._)((function(){var n,i,r,o,a,s,u,c;return(0,F.Jh)(this,(function(l){switch(l.label){case 0:return n=t.viewMode,i=n.getCurrentPageIndex(),r=t.scale,[4,t.docRender.getViewBoxCenter(!0,"topLeft")];case 1:if(o=E._.apply(void 0,[l.sent(),2]),a=o[0],s=o[1],n.out(),"fitVisible"==r&&-1!==["facing-page-view-mode"].indexOf(e.getName())&&(t.scale=r=1),t.docRender.isDestroyed)return[2];t.viewMode=new e(t.docRender),t.viewMode.into(t.$ui.get(0),t.pageDOMs,i),t.setRenderFlags(4),u=Object.keys(t.doc.getPageSizesSync()),l.label=2;case 2:return l.trys.push([2,5,,6]),c={pageIndex:a?a.getIndex():i,x:s[0],y:s[1]},[4,Promise.all([t.docRender.zoomTo(t.scale,c),t.loadPageSize(u,0)])];case 3:return l.sent(),[4,t.docRender.goToPage(i,{x:0,y:0})];case 4:return l.sent(),[3,6];case 5:return l.sent(),[3,6];case 6:return[2]}}))}))()}},{key:"getViewMode",value:function(){return this.viewMode}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.scale=t,this.rotate=n,this.createPagesStructure(),this.viewMode.pageDOMs.length||this.viewMode.into(this.$ui.get(0),this.pageDOMs),this.docRender.rendered(),Promise.resolve().then((function(t){return e.docRender.move()}))}},{key:"getScaleSyncOrNot",value:function(e,t,n,i){"fitVisible"!==n?e(this.getPageScaleSync(t,n,i)):this.getPageScale(t,n,i).then((function(t){e(t)}))}},{key:"movePageRender",value:function(e,t){var n=this,i=this.pageRenders[e];if(i){var r=i.$ui.parent(),o=this.pageRenders[t];if(o){var a=o.$ui.parent();e<t?r.insertAfter(a):r.insertBefore(a),this.pageRenders.splice(e,1),this.pageRenders.splice(t,0,i);for(var s=Math.min(e,t),u=Math.max(e,t),c=s;c<=u;c++)this.pageRenders[c].updateIndex(c);this.updatePageDOMs(),this.getScaleRatio().then((function(e){return n.renderVisiblePages(e).catch((function(e){0}))}))}}}},{key:"movePagesRenderBAK",value:function(e,t){var n=this,i=e.filter((function(e){return e<t})),r=e.filter((function(e){return e>=t})),o=this.pageRenders.length,a=t===o,s=function(e,t){var i=n.pageRenders[e];if(i){var r=i.$ui.parent(),o=n.pageRenders[t];if(o){var a=o.$ui.parent();r.insertBefore(a)}}};i.reverse().forEach((function(e,i){var r=n.pageRenders[e];s(e,t-i),n.pageRenders.splice(e,1),n.pageRenders.splice(t-i-1,0,r)})),r.forEach((function(e,i){var r=n.pageRenders[e];s(e,t+i),n.pageRenders.splice(e,1),n.pageRenders.splice(t+i,0,r)}));for(var u=a?t-1:t,c=Math.min(Math.min.apply(null,e),u),l=Math.max(Math.max.apply(null,e),u),d=c;d<=l;d++)this.pageRenders[d].updateIndex(d);this.updatePageDOMs(),this.getScaleRatio().then((function(e){return n.renderVisiblePages(e).catch((function(e){0}))}))}},{key:"movePagesRender",value:function(e,t,n){var i=this,r=this.pageRenders.length;e.reduce((function(e,n){var o=i.pageRenders[n].$ui.parent();return e?o.insertAfter(e):""===e&&(t===r?o.insertAfter(i.pageRenders[r-1].$ui.parent()):o.insertBefore(i.pageRenders[t].$ui.parent())),o}),"");var o,a=this.pageRenders;e.map((function(e){return a[e]})).forEach((function(e,n){var i=a.indexOf(e);if(a.splice(i,1),0===n)i<t?a.splice(t-1,0,e):a.splice(t,0,e);else{var r=a.indexOf(o);a.splice(r+1,0,e)}o=e})),a.forEach((function(e,t){e.updateIndex(t)})),this.updatePageDOMs(),this.getScaleRatio().then((function(e){return i.renderVisiblePages(e).catch((function(e){0}))}))}},{key:"_updatePageRenders",value:function(e,t){var n=O()(B),i=n.get(0);if(this.pageRenders[e]){if(!t){var r=this.pageRenders[e].$ui.parent();n.insertBefore(r)}this.pageDOMs.splice(e,0,i)}else t||this.$ui.append(n),this.pageDOMs.push(i);var o=n.find(".fv__pdf-page-layout"),a=new Xo(o,e,this.doc,this);this.pageRenders.splice(e,0,a);for(var s=e+1;s<this.pageRenders.length;s++)this.pageRenders[s].updateIndex(s)}},{key:"addNewPageByIndex",value:function(e){var t=this,n=(0,D._)(this.viewMode,ua);return this._updatePageRenders(e,n),this.updatePageDOMs(),this.getScaleRatio().then((function(n){var i=t.pageRenders[e];if(i)return t.getScaleSyncOrNot((function(e){return i.updatePageDOMRect(e,t.rotate)}),e,n,t.rotate),t.renderVisiblePages(n).catch((function(e){0}))}))}},{key:"importPagesByArray",value:function(e){var t=this,n=(0,j.createDeferred)(),i=this.importPagesByArrayPromises=this.importPagesByArrayPromises||Promise.resolve();return this.importPagesByArrayPromises=i.finally((function(){var i=(0,D._)(t.viewMode,ua);return e.forEach((function(e){var n=e.getIndex();t._updatePageRenders(n,i);var r=t.pageRenders[n];r&&t.getScaleSyncOrNot((function(e){return r.updatePageDOMRect(e,t.rotate)}),n,t.scale,t.rotate)})),t.updatePageDOMs(),t.docRender.loadFormRender(!0).then((function(e){return t.setRenderFlags(8),t.renderVisiblePages(t.scale)})).then((function(){return n.resolve()})).catch((function(e){return n.reject()}))})),n.promise}},{key:"removePageByIndex",value:function(e){if(this.pageRenders[e]){var t=this.pageRenders.splice(e,1)[0];t.$ui.parent().remove().next(".fv__pdf-view-mode-item-split").remove(),t.destroy();for(var n=e;n<this.pageRenders.length;n++)this.pageRenders[n].updateIndex(n);this.pageDOMs.splice(e,1)}this.updatePageDOMs(),this.renderVisiblePages(this.scale).catch((function(e){0}))}},{key:"updatePageDOMs",value:function(){this.pageDOMs=this.pageRenders.map((function(e){return e.$element.get(0)})),this.viewMode.updatePageDOMs(this.pageDOMs)}},{key:"setRenderFlags",value:function(e){for(var t=this.pageRenders,n=0,i=t.length;n<i;n++)t[n].updateRenderFlags(e)}},{key:"loadPageSize",value:function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=0;this.doc.getPageSize(e[i]);)i++;if(i==e.length)t=Promise.resolve();else{var r=e[i];t=this.doc.getPageSizes(r+n,7)}return t}},{key:"renderVisiblePages",value:function(){var e=this;arguments.length>0&&void 0!==arguments[0]||this.docRender.getScale(),arguments.length>1&&void 0!==arguments[1]||this.rotate;if(this.isDestroyed)return Promise.resolve();var t;return this.renderingTask=(t=e.viewMode.getVisibleIndexes(),e.loadPageSize(t,-3).then((function(){return e.adjustRenderVisiblePages(e.scale,e.rotate)})).then((function(){e.viewMode&&(e.viewMode.afterRenderVisiblePages(),e.pdfViewer.eventEmitter.emit(de.visiblePagesRenderCompleted),e.renderingTask=null)})))}},{key:"adjustRenderVisiblePages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.docRender.getScale(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=this.viewMode,r=i.getVisibleIndexes();return this.renderPages(r,t,n).then((function(){if(i.docRender&&0!==i.pageDOMs.length)return i.getVisibleIndexes().filter((function(e){return-1===r.indexOf(e)})).length>0?e.adjustRenderVisiblePages(t,n):void 0}))}},{key:"renderPages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.docRender.getScale(),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotate;if(this.isDestroyed)return Promise.resolve();var r=this.docRender.doc,o=this.renderPagesSerial;o&&o.end().catch((function(e){0})),o=this.renderPagesSerial=new ge;for(var a=0;t[a]>=0&&r.getPageSize(t[a]);)a++;var s=[];a<t.length&&s.push((function(e){return r.getPageSizes(t[a],t.length)}));for(var u=0,c=t.length;u<c;u++){var l=t[u];s.push(function(t,n){return function(){return e.getPageScale("fitVisible"===n?0:t,n,i).then((function(n){var r=e.pageRenders[t];if(!r)return Promise.resolve();var o=r.render(n,i).then((function(e){var t=r.$annotsContainer.get(0),n="fv__viewer-annot-container-hide";t.classList.contains(n)&&t.classList.remove(n)}));return e.pdfViewer.asyncRender?Promise.resolve():o})).catch((function(e){return Promise.resolve()}))}}(l,n))}return o.serial(s)}},{key:"renderPagesLayout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;if(this.isDestroyed)return Promise.resolve();var i=this.renderPagesSerial;i&&i.end().catch((function(e){0})),i=this.renderPagesSerial=new ge;for(var r=0;this.doc.getPageSize(t[r++]););for(var o=[function(n){return e.doc.getPageSizes(t[r],t.length-r)}],a=0,s=t.length;a<s;a++){var u=t[a];o.push(function(t,n){return function(){return e.getPageScale(t,n).then((function(n){if(e.pageRenders[t])return e.pageRenders[t].renderLayout(n)}))}}(u,n))}return i.serial(o)}},{key:"destroy",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"destroy",this).call(this);for(var t=this.pageRenders.length;t--;)this.pageRenders[t].destroy();this.pageRenders=[],this.renderPagesSerial&&this.renderPagesSerial.end().catch((function(e){0})),this.viewMode.out(),this.viewMode=null,this.$ui.empty(),this.pageDOMs.length=0;var i=this.pdfViewer.eventEmitter;["actionAdd","actionRemove","layerVisibleChange","imageAdded","watermarkAdded","watermarkRemoved","graphicsUpdated","pageAdded","pagesInserted","pageMoved","pagesMoved","pageRemoved","pagesRemoved","importPages","applyRedaction","flattened","headerFooterUpdated","headerFooterAdded","pagesReplace","articleThreadUpdated","articleBeadAdded","articleBeadUpdated","updateZoomMode"].forEach((function(t){e[t]&&i.off(de[t],e[t]),e[t]=null})),this.renderPagesSerial&&this.renderPagesSerial.end(),this.renderPagesSerial=null}},{key:"renderViewMode",value:function(e){this.viewMode.renderViewMode(e)}},{key:"goToPage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(this.getPDFPageRender(e))return this.viewMode.jumpToPage(e,{x:n,y:i})}},{key:"updatePagesDomSize",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.isDestroyed)return Promise.resolve();var o=this.pdfViewer.getScrollWrap(),a=o.getHeight(),s=o.getWidth(),u=[],c=this.doc.isPageSameSize();this.pageRenders.forEach((function(t,n){var r=t.pageContentTiles;t.updateRenderFlags(7),t.page&&(t.page.clearDesignerAssitCache(),r&&r.clearCache());var l=i.getPageScale("fitVisible"===e||c?0:n,e,i.rotate),d=t.annotsRender;u.push(l.then((function(e){var u=4*e/3,c=i.doc,l=c.getPageSize(n);l||(l=c.getEstimatedPageSize(n));var h=l.width,f=l.height;switch(i.rotate/90){case 1:case 3:var g=h;h=f,f=g}t.scale=e,t.rotate=i.rotate;var v,p=r?r.renderedScale:1,m=u*j.dpr/p;if(v="scale("+m+")",!n&&i.viewMode.fixMargin){var y=c.getPageSizesSync(),k=Object.keys(y).reduce((function(e,t){return t=y[t],e.height=Math.max(t.height,e.height),e.width=Math.max(t.width,e.width),e}),{width:0,height:0}),b=k.width*u,w=k.height*u;switch(i.rotate/90){case 1:case 3:var _=b;b=w,w=_}i.viewMode.fixMargin(b,w),a==o.getHeight()&&s==o.getWidth()||i.viewMode.fixMargin(h*u,f*u)}t.setShowWidth(h*u),t.setShowHeight(f*u);t.$container.parent().css({width:h*u,height:f*u}).find(".fv__pdf-page-content-container").css("transform",v),d&&d.updateSize(e,i.rotate)})))}));var l,d=this;return Promise.all(u).then((l=(0,_._)((function(i){var u,c;return(0,F.Jh)(this,(function(l){switch(l.label){case 0:return r?[2,i]:!isNaN(e)||a==o.getHeight()&&s==o.getWidth()?[3,3]:(u=d.pdfViewer.customs.isFullScreen,(c=u)?[4,u()]:[3,2]);case 1:c=l.sent(),l.label=2;case 2:if(!(u=c))return[2,d.updatePagesDomSize(e,t,n,!0)];l.label=3;case 3:return[2,i]}}))})),function(e){return l.apply(this,arguments)}))}},{key:"zoomTo",value:function(e,t){var n=this;if(this.isDestroyed)return Promise.resolve();this.scale=e,this.doc.clearAllDesignerAssistCache();var i,r,o=[],a=t.pageIndex;if("device"==t.type)i=t;else{this.pageRenders[a];var s=this;o.push(this.getPageScale("fitVisible"===e?0:a,e,this.rotate).then((r=(0,_._)((function(e){var n,r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return[4,s.doc.getPageByIndex(a)];case 1:return n=o.sent(),r=n.getDevicePoint([t.x,t.y],e,s.rotate),i={x:r[0],y:r[1]},[2]}}))})),function(e){return r.apply(this,arguments)})))}return this.doc.isPageSameSize()?o.push(this.updatePagesDomSize(e,!1,this.viewMode.pageDOMs)):this.pageRenders.forEach((function(t){t.page?o.push(t.renderLayout(e,n.rotate)):(t.scale=e,t.rotate=n.rotate);var i=t.pageContentTiles;i&&i.clearCache()})),Promise.all(o).then((function(e){if(!n.isDestroyed){var r=t.pageIndex,o=n.getPDFPageRender(r);if(n.renderViewMode(o),n.pdfViewer.getScrollWrap().disabled)return n.pdfViewer.store.getCurrentValue("force-redraw")||n.pdfViewer.getScrollWrap().disable(0),Promise.resolve(n.viewMode.jumpToPage(r,i));var a=n.viewerRender.scrollWrap;return new Promise((function(e){n.pdfViewer.eventEmitter.once(de.afterRenderingVisiblePages,e);var t=a.getScrollTop(),o=a.getScrollLeft();n.viewMode.jumpToPage(r,i),requestAnimationFrame((function(){var n=a.getScrollTop(),i=a.getScrollLeft();n===t&&i===o&&e()}))}))}}))}},{key:"getScaleRatio",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.docRender.getScale(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.viewMode.getCurrentPageIndex();return n>=this.docRender.getPDFDoc().getPageCount()&&(n=this.docRender.getPDFDoc().getPageCount()-1),this.getPageScale(n,e,t)}},{key:"rotateTo",value:function(e){var t=this;(0,j.assertThat)((0,j.isValidRotationAngle)(e),"Illegal rotation angle: ".concat(e,", it should be 0,90,180 or 270")),this.rotate=(e%360+360)%360;var n=this.viewMode.getVisibleIndexes();return Promise.all(n.map((function(e){var n=t.pageRenders[e];return n.$annotsContainer.addClass("fv__viewer-annot-container-hide"),n.clearCanvasCache(!0),n.renderLayout(void 0,t.rotate)}))).then((function(e){t.setRenderFlags(7)})).then((function(e){return Promise.all(t.pageRenders.map((function(e){if(-1===n.indexOf(e.index))return e.renderLayout(void 0,t.rotate)})))})).finally((function(e){t.pdfViewer.eventEmitter.emit(de.fitWidthResizeViewport)}))}},{key:"adjustFitPage",value:function(e){var t,n,i=this.doc.getPageSize(e);return i&&(t=i.height,n=i.width),t||(t=(i=this.doc.getPageSize(0)).height,n=i.width),t/n>this.viewMode.getFitHeight(e)/this.viewMode.getFitWidth(e)?"fitHeight":"fitWidth"}},{key:"getPageScaleSync",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._getPageScaleSync(e,t,n)}},{key:"_getPageScaleSync",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return n.doc.getPageSize(e)};if(i=(i%360+360)%360,"fitHeight"===t&&(t=this.adjustFitPage(e)),+t>this.minScale)return Math.min(+t,this.maxScale);if(+t<=this.minScale)return this.minScale;if("fitWidth"===t){var o=r();if(o||(o=this.doc.getEstimatedPageSize(e)),o){if(!this.viewMode)return this.resolveScaleValue(1);var a=this.viewMode.getFitWidth(e),s=90===i||270===i?o.height:o.width;return this.resolveScaleValue(a/(s*(0,U.F2)(1)))}}else if("fitHeight"===t){var u=r();if(u||(u=this.doc.getEstimatedPageSize(e)),u){var c=90===i||270===i?u.width:u.height;return this.resolveScaleValue(this.viewMode.getFitHeight(e)/(c*(0,U.F2)(1)))}}return-1}},{key:"getEstimatedPageScaleSync",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this._getPageScaleSync(e,t,i,(function(){return n.doc.getEstimatedPageSize(e)}))}},{key:"getPageScale",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotate;return this.viewMode&&this.doc?("fitHeight"===t&&(t=this.adjustFitPage(e)),+t>this.minScale?Promise.resolve(Math.min(+t,this.maxScale)):+t<=this.minScale?Promise.resolve(this.minScale):"fitWidth"===t?this.doc.getPageByIndex(e).then((function(t){if(!n.viewMode)return Promise.resolve(1);var r=n.viewMode.getFitWidth(e),o=90===i||270===i?t.getPxHeight():t.getPxWidth();return n.resolveScaleValue(r/o)})):"fitVisible"===t?this.doc.getPageByIndex(e).then((function(t){return t.calcPageContentBBox(xt.CalcContentsBox).then((function(r){if(!n.viewMode)return Promise.resolve(1);var o=1,a=t.getRotation(),s=n.viewMode.getFitWidth(e);r&&void 0!==r.left&&r.left!==r.right&&r.top!==r.bottom&&(o=(o=1===a||3===a?t.info.mediaHeight/Math.abs(r.top-r.bottom):t.info.mediaWidth/Math.abs(r.right-r.left))>1.5?1.5:o);var u=90===i||270===i?t.getPxHeight():t.getPxWidth();return n.resolveScaleValue(s*o/u)}))})):"fitHeight"===t?Promise.all([this.viewMode.getFitHeight(e),this.pageRenders[e].getPDFPage().then((function(e){return 90===i||270===i?e.getPxWidth():e.getPxHeight()}))]).then((function(e){var t=(0,E._)(e,2),i=t[0],r=t[1];return n.resolveScaleValue(i/r)})):Promise.resolve(1)):Promise.resolve(1)}},{key:"resolveScaleValue",value:function(e){if(e=+e,!isFinite(e))throw new Error("The scale value must be valid number, but actual: ".concat(e));return Math.max(this.minScale,Math.min(this.maxScale,e))}},{key:"createPagesStructure",value:function(){var e=this;if(!this.pageDOMs.length){var t=this.doc.getPageCount(),n=function(){var e=document.createElement("div");e.innerHTML=B;var t=e.firstElementChild;return e.removeChild(t),t}(),i=Array(t).fill(0).map((function(e){return n.cloneNode(!0)}));i.forEach((function(t,n){var i=t.firstElementChild;e.pageRenders[n]||(e.pageRenders[n]=new Xo(O()(i),n,e.doc,e))})),this.pageDOMs=i,this.isPageDOMsLoaded=!0}}},{key:"getPDFPageRender",value:function(e){try{return this.pageRenders[e]}catch(e){return null}}},{key:"unActiveAnnotRender",value:function(){for(var e=this.pageRenders||[],t=e.length;t--;){e[t].unActiveAnnotRender()}}},{key:"moveTo",value:function(e){var t=this;return this.pagesEndRender(e),this.pdfViewer.eventEmitter.emit(de.beforeRenderingVisiblePages,e),this.renderPages(e).finally((function(){t.pdfViewer.eventEmitter.emit(de.afterRenderingVisiblePages,e)}))}},{key:"pagesEndRender",value:function(e){var t=this.pageRenders||[],n=t.length;if(!this.pdfViewer.keepCache){var i=this.pdfViewer.tileCache,r=e[0]||0,o=r-i;if(--r>-1)for(var a=r;a>=0;a--){var s=t[a];s&&s.invisibleRender(a<=o)}var u=e[e.length-1]||0,c=u+i;if(++u<n)for(var l=u;l<n;l++){var d=t[l];d&&d.invisibleRender(l>=c)}}}}],[{key:"getDefaultName",value:function(){return"pdfPagesRender"}}]),n}(te));const la=ca;const da=function(){function e(t,n){(0,P._)(this,e),this.$ui=O()(t),this.docRender=n,this.viewerRender=n.viewerRender,this.pdfViewer=this.viewerRender.pdfViewer}return(0,A._)(e,[{key:"rendering",value:function(){this.closeLoadingFn=this.pdfViewer.viewerUI.loading(this.$ui.get(0))}},{key:"rendered",value:function(){this.closeLoadingFn&&this.closeLoadingFn(),this.$ui.empty()}},{key:"destroy",value:function(){this.$ui=null}}]),e}();var ha=function(){function e(t,n){(0,P._)(this,e),this.eCustom=t,this.pdfDocRender=n,this.doc=n.doc}return(0,A._)(e,[{key:"render",value:function(e){}},{key:"destroy",value:function(){this.pdfDocRender=null,this.doc=null}}]),e}(),fa=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4294967292;(0,P._)(this,e),this.permissions=t}return(0,A._)(e,[{key:"getValue",value:function(){return this.permissions}},{key:"checkPrint",value:function(){return this.permissions&Qt.print}},{key:"checkModify",value:function(){return this.permissions&Qt.modify}},{key:"checkExtract",value:function(){return this.permissions&Qt.extract}},{key:"checkAnnotForm",value:function(){return this.permissions&Qt.annotForm}},{key:"checkFillForm",value:function(){return this.permissions&Qt.fillForm}},{key:"checkExtractAccess",value:function(){return this.permissions&Qt.extractAccess}},{key:"checkAssemble",value:function(){return this.permissions&Qt.assemble}},{key:"checkPrintHigh",value:function(){return this.permissions&Qt.printHigh}},{key:"checkCannotModifyAny",value:function(){return 0==(1323&this.permissions)}},{key:"putCannotModifyAny",value:function(){return this.or(-1324)}},{key:"checkCannotModifyExcludeAssemble",value:function(){return 0==(299&this.permissions)}},{key:"putCannotModifyExcludeAssemble",value:function(){return this.or(-300)}},{key:"and",value:function(e){return this.permissions=this.permissions&e,this}},{key:"or",value:function(e){return this.permissions=this.permissions|e,this}}]),e}(),ga=["Jan","Feb","Mar","Apr","May","Jun","Ju","Aug","Sep","Oct","Nov","Dec"],va=["January","February","March","April","May","June","July","August","September","October","November","December"],pa=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,null,[{key:"MakeFixed",value:function(e,t){return(Array(t).join("0")+e).slice(-t)}},{key:"FormatDateTimeString",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,r=e.GetDate(t,i);n&&""!=n||(r=new Date),"Invalid Date"==r.toString()&&(r=new Date);for(var o="",a="",s=r.getFullYear(),u=r.getMonth()+1,c=r.getDate(),l=r.getHours(),d=r.getMinutes(),h=r.getSeconds(),f=0,g=0;f<n.length;){switch(a="",g=n[f]){case"y":case"m":case"d":case"H":case"h":case"M":case"s":case"t":if(n[f+1]!=g){switch(g){case"y":a+=g;break;case"m":a=u;break;case"d":a=c;break;case"H":a=l;break;case"h":a=l>12?l-12:l;break;case"M":a=d;break;case"s":a=h;break;case"t":a+=l>=12?"p":"a"}f++}else if(n[f+1]==g&&n[f+2]!=g){switch(g){case"y":a=this.MakeFixed(s-100*parseInt(s/100),2);break;case"m":a=this.MakeFixed(u,2);break;case"d":a=this.MakeFixed(c,2);break;case"H":a=this.MakeFixed(l,2);break;case"h":a=this.MakeFixed(l>12?l-12:l,2);break;case"M":a=this.MakeFixed(d,2);break;case"s":a=this.MakeFixed(h,2);break;case"t":a=l>=12?"pm":"am"}f+=2}else if(n[f+1]==g&&n[f+2]==g&&n[f+3]!=g)if("m"===g)f+=3,a+=ga[u-1];else f+=3,a+=g,a+=g,a+=g;else if(n[f+1]==g&&n[f+2]==g&&n[f+3]==g&&n[f+4]!=g)switch(g){case"y":a=s,f+=4;break;case"m":f+=4,a+=va[u-1];break;default:f+=4,a+=g,a+=g,a+=g,a+=g}else f++,a+=g;break;default:f++,a+=g}o+=a}return o}},{key:"GetDate",value:function(e,t,n){t=(t=(t=t.replace("MM","ii")).replace("M","i")).toLowerCase();for(var i=new Date(e),r=new Date,o=r.getFullYear(),a=r.getMonth(),s=r.getDate(),u=0,c=0;c<t.length&&u<e.length;){switch(t[c]){case"y":for(var l="";"0"<=e[u]&&e[u]<="9";)l+=e[u],u++;for(;"y"==t[c];)c++;if(2===l.length)l="20"+l;o=parseInt(l);break;case"m":var d="";if("A"<=e[u]&&e[u]<="Z")for(;u<e.length&&e[u].match(/[a-zA-Z]/);)d+=e[u],u++;else for(;"0"<=e[u]&&e[u]<="9";)d+=e[u],u++;for(;"m"==t[c];)c++;switch(d.length){case 1:case 2:a=parseInt(d)-1;break;case 3:a=ga.indexOf(d);break;case 4:a=va.indexOf(d)}break;case"d":for(var h="";"0"<=e[u]&&e[u]<="9";)h+=e[u],u++;for(;"d"==t[c];)c++;s=parseInt(h);break;case"i":for(var f="";"0"<=e[u]&&e[u]<="9";)f+=e[u],u++;for(;"i"==t[c];)c++;r.setMinutes(parseInt(f));break;case"h":for(var g="";"0"<=e[u]&&e[u]<="9";)g+=e[u],u++;for(;"h"==t[c];)c++;r.setHours(parseInt(g));break;case"s":for(var v="";"0"<=e[u]&&e[u]<="9";)v+=e[u],u++;for(;"s"==t[c];)c++;r.setSeconds(parseInt(v));break;case"t":for(var p="";e[u]&&e[u].match(/[AaPpMm]/);)p+=e[u],u++;for(;"t"==t[c];)c++;if("pm"==p.toLowerCase()){var m=r.getHours();m<12&&(m+=12),r.setHours(m)}else{12==r.getHours()&&r.setHours(0)}break;default:u++,c++}}1==a&&29==s&&o%4!=0&&(o&=4294967292),r.setFullYear(o),r.setMonth(a),r.setDate(s);var y=new Date;return Math.abs(i.getFullYear()-y.getFullYear())<Math.abs(r.getFullYear()-y.getFullYear())||Math.abs(i.getMonth()-y.getMonth())<Math.abs(r.getMonth()-y.getMonth())||Math.abs(i.getDate()-y.getDate())<Math.abs(r.getDate()-y.getDate())?i:r}},{key:"getMonth",value:function(e,t){switch(t){case"m":return e;case"F":return va[e];case"M":return ga[e]}}},{key:"switchFormat",value:function(e,t){return"toLib"==t?e.replace("yyyy","Y").replace("yy","y").replace("dd","d").replace("HH","H").replace("hh","h").replace("MM","i").replace("M","i").replace("mmmm","F").replace("mmm","M").replace("mm","m").replace("ss","S").replace("tt","K"):e.replace("Y","yyyy").replace("y","yy").replace("d","dd").replace("H","HH").replace("h","hh").replace("i","MM").replace("F","mmmm").replace("M","mmm").replace("m","mm").replace("S","ss").replace("K","tt")}}]),e}(),ma=g(4953),ya=g.n(ma),ka=(g(799),g(7821),g(401),g(6741),g(2805),g(969),g(1844),g(6679),g(9088),["CreatePushButtonStateHandler","CreateCheckBoxStateHandler","CreateRadioButtonStateHandler","CreateComboBoxStateHandler","CreateListBoxStateHandler","CreateTextStateHandler","CreateSignStateHandler","CreateDateStateHandler","CreateImageStateHandler"]);!function(){function e(){(0,P._)(this,e),this.tasks=[]}(0,A._)(e,[{key:"appendTask",value:function(e,t){var n=this;this.tasks.push(e.bind(t)),this.runner||(setTimeout((function(){n.execute()}),10),this.runner=setInterval((function(e){n.execute()}),30))}},{key:"execute",value:function(){this.tasks.pop()(),0==this.tasks.length&&(clearInterval(this.runner),this.runner=0)}},{key:"destroy",value:function(){clearInterval(this.runner),delete this.tasks,this.dt&&this.dt.destroy()}}])}();var ba=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;(0,P._)(this,n),(r=t.call(this,i)).doc=e,r.docRender=i,r.$docContainer=i.$container,r.isRunningAction=!1;var o,a=e.getPDFForm();if(!a)return(0,Lr._)(r);a.setActionHandler((function(e,t,n,i){return r.execAction("Field",e,t,n,i)}));var s=r.viewerEvents=(o={},(0,J._)(o,de.switchStateHandler,(function(e,t){r.blurControl()})),(0,J._)(o,de.tapPage,(function(){r.blurControl(),r.initTabParams()})),(0,J._)(o,de.tapAnnotation,(function(){r.blurControl()})),(0,J._)(o,de.openFileSuccess,(function(){r.control=null,r.initTabParams()})),(0,J._)(o,de.renderPageSuccess,(function(e){r.currentDocId!==e.doc.id&&r.initTabParams(),r.currentDocId=e.doc.id,r.afterPageRender&&(r.afterPageRender(),r.afterPageRender=null)})),(0,J._)(o,de.activeAnnotation,(function(e){var t=e.getAnnot();r.initTabParams(t)})),(0,J._)(o,de.tapField,(function(e){r.initTabParams(e)})),(0,J._)(o,de.spawnPageSuccess,(function(e){e.setActionHandler((function(e,t,n,i){return r.execAction("Field",e,t,n,i)}))})),(0,J._)(o,"change-language-success",(function(e){if(r.dt&&r.dt.isOpen){var t=r.switchToFlatpickrLocale(e),n=r.dt.input,i=Object.assign(r.dt.config,{locale:t}),o=r.dt.timeContainer.style;r.dt.close(),r.dt&&r.dt.calendarContainer&&r.dt.calendarContainer.remove(),r.dt=Object.assign(r.dt,ya()(n,i)),r.dt.timeContainer.style.cssText=o.cssText,r.dt.redraw(),r.dt.open(null,n),delete n._flatpickr}})),o);for(var u in s)r.pdfViewer.eventEmitter.on(u,s[u]);return r.runtimeHighlight=!0,r}return(0,A._)(n,[{key:"getEditType",value:function(){switch(this.pdfViewer.getStateHandlerManager().currentStateHandler.getStateName()){case"select-annotation":return 8;case"CreatePushButtonStateHandler":case"CreateImageStateHandler":return 1;case"CreateCheckBoxStateHandler":return 2;case"CreateRadioButtonStateHandler":return 3;case"CreateComboBoxStateHandler":return 4;case"CreateListBoxStateHandler":return 5;case"CreateTextStateHandler":case"CreateDateStateHandler":return 6;case"CreateSignStateHandler":return 7;default:return 0}}},{key:"usingHTML",value:function(e){var t,n=(t={},(0,J._)(t,gn.Unknown,""),(0,J._)(t,gn.PushButton,"pushButton"),(0,J._)(t,gn.CheckBox,""),(0,J._)(t,gn.RadioButton,"radioButton"),(0,J._)(t,gn.Text,"textField"),(0,J._)(t,gn.ListBox,"listBox"),(0,J._)(t,gn.ComboBox,"comboBox"),(0,J._)(t,gn.Sign,""),t)[e];return"canvas"===this.pdfViewer.config.annotRenderingMode[n]}},{key:"addTask",value:function(e,t){return this.doc.getPDFForm()?this.doc.getPDFForm().addTask(e,t):Promise.resolve(e())}},{key:"initJS",value:function(){var e=this.doc.getJsNameTree(),t="";for(var n in e)"!ADBE::0200_VersChkCode_XFACheck"!==n&&(t+=e[n]+"\n");var i=this.doc.action;i&&i.getScript&&(t+=i.getScript());var r=this.pdfViewer.JSEngine;r.initEvent(13,null,null,"Init",{doc:this.doc}),r.resetClosure(t);var o=this.doc.getPDFForm();if(o&&!o.isEmpty())return o.addTask().then((function(e){return o.setState("jsInited")}));o&&o.setState("jsInited")}},{key:"goPreviousOrNextWidget",value:function(e){var t=this,n=this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName(),i=this.pdfViewer.getPDFPageRender(this.currentPageNumber).page;i&&i.getAnnotIdArrayByOrder().then((function(n){if(t.tabIndex+="previous"===e?-1:1,!(t.tabIndex<0||t.tabIndex>n.length-1)){var r=n[t.tabIndex];return i.getAnnotsByObjectNumArray([r])}t.goToPreviousOrNextPage(e)})).then((function(i){if(i){var r=i[0];if(r&&"widget"===r.getType())if("hand"===n){var o=r.getField();if(!o)return;var a=1===vn.isReadOnly(o.getFlags()),s=t.checkWidgetVisibleType(r);a||"hidden"===s||"hiddenButPrintable"===s?t.goPreviousOrNextWidget(e):(r.updateUI&&r.updateUI({type:"focus"}),t.pdfViewer.eventEmitter.emit("tab-active",r))}else"hand"!==n&&t.pdfViewer.eventEmitter.emit("tab-active",r);else t.goPreviousOrNextWidget(e)}}))}},{key:"goToPreviousOrNextPage",value:function(e){var t=this,n=this.doc.getPageCount(),i=this.currentPageNumber,r="previous"===e?i-1:i+1;r<0?r=n-1:r>=n&&(r=0),this.doc.getPageByIndex(r).then((function(e){return e.getAnnotIdArrayByOrder().then((function(t){var n=!1,i=!0,r=!1,o=void 0;try{for(var a,s=e.annots[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){if("widget"===a.value.getType()){n=!0;break}}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return[t,n]}))})).then((function(i){var o=(0,E._)(i,2),a=o[0],s=o[1];if(t.currentPageNumber=r,s){if(t.tabIndex="previous"===e?a.length:-1,t.docRender.currentPageNumber===r)return void t.goPreviousOrNextWidget(e);t.docRender.goToPage(r,0,0,!1).then((function(){1===n?t.goPreviousOrNextWidget(e):t.afterPageRender=function(){return t.goPreviousOrNextWidget(e)}}))}else t.goToPreviousOrNextPage(e)}))}},{key:"setTabIndexByAnnotId",value:function(e){}},{key:"initTabParams",value:function(e){if(this.tabIndex=-1,this.currentPageNumber=this.docRender.currentPageNumber,e){var t=this,n=e.objectNumber,i=e.getPage();this.currentPageNumber=i.getIndex(),i.getAnnotIdArrayByOrder().then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.tabIndex=e.indexOf(n)}))}}},{key:"checkWidgetVisibleType",value:function(e){var t=e.getFlags(),n=t&tn.print,i=t&tn.noView,r="".concat(t&tn.hidden,"_").concat(n,"_").concat(i);switch(r){case"0_4_0":r="visible";break;case"2_4_0":r="hidden";break;case"0_0_0":r="visibleButUnprintable";break;case"0_4_32":r="hiddenButPrintable"}return r}},{key:"showWigetInArea",value:function(e,t){var n=document.getElementsByClassName("fv__ui-pdfviewer")[0],i=e.annotsRender.getAnnotRender(t.getId()).component.$handler[0],r=i.getBoundingClientRect(),o=document.body.clientWidth,a=document.body.clientHeight;(o-r.x<r.width||r.x<r.width)&&(n.scrollLeft=i.offsetLeft),(a-r.y<r.height||r.y<r.height)&&(n.scrollTop=i.offsetTop)}},{key:"getNextStepWidget",value:function(e,t){var n=this.pageIndex;return t?this.getPreviousWidget(e,n):this.getNextWidget(e,n)}},{key:"getFilterAnnot",value:function(){var e=this,t={},n={},i=this.pdfViewer.currentPDFDoc.getPDFForm().fields,r=[];return i.map((function(e){return e.controls.map((function(e){return e.getWidgetAnnot()}))})).forEach((function(e){r=r.concat(e)})),Promise.all(r).then((function(i){return(i=i.sort((function(e,t){return e.getPage().getIndex()<t.getPage().getIndex()?-1:1}))).forEach((function(e,t){null==n[e.getPage().getIndex()]&&(n[e.getPage().getIndex()]=[]),n[e.getPage().getIndex()].push(e)})),Object.keys(n).forEach((function(i){var r=e.filterWidgets(n[i]);r.length>0&&(t[i]=r)})),t}))}},{key:"filterWidgets",value:function(e){var t=e.filter((function(e){return"widget"==e.getType()&&261!==e.getField().getFlags()}));return t=t.filter((function(e){var t=e.getFlags()&tn.hidden,n=e.getFlags()&tn.print,i=e.getFlags()&tn.noView;return!(vn.isReadOnly(e.getField().getFlags())||2==t&&4==n&&0==i||0==t&&4==n&&32==i)})),t=t.sort((function(e,t){return e.info.index<t.info.index?-1:1}))}},{key:"getPreviousWidget",value:function(e,t){var n=this,i={},r=Object.keys(e),o=e[t].findIndex((function(e){e.getField().getControlById(n.widget.getObjNum());return n.widget.getObjNum()==e.getObjNum()}));if(0==o){var a=r[r.length-1];if(t>0){var s=r.findIndex((function(e){return e==t}));t=r[s-=1]}else t=a;i=e[t][e[t].length-1]}else o>0&&o<=e[t].length-1&&--o,i=e[t][o];return i}},{key:"getNextWidget",value:function(e,t){var n=this,i={},r=Object.keys(e),o=e[t].findIndex((function(e){return n.widget.getObjNum()==e.getObjNum()}));if(o==e[t].length-1){var a=r[r.length-1];if(t<a){var s=r.findIndex((function(e){return e==t}));t=r[s+=1]}else t=0;i=e[t][0]}else o>=0&&o<e[t].length-1&&++o,i=e[t][o];return i}},{key:"destroy",value:function(){var e=this.viewerEvents;for(var t in e)this.pdfViewer.eventEmitter.off(t,e[t]),e[t]=null;this.viewerEvents=null,this.msgQueue&&(this.msgQueue.destroy(),delete this.msgQueue)}},{key:"setRuntimeHighlight",value:function(e){var t=".fv__ui-form-foreground:not(.form-field-readonly)";e&&this.pdfViewer.highlightControlsUI()?this.$docContainer.find(t).show():this.$docContainer.find(t).hide(),this.runtimeHighlight=!1}},{key:"setRuntimeHighlightColor",value:function(e,t,n,i){var r=this;[t,i].forEach((function(t,i){var o=".fv__ui-form-foreground"+(0==i?":not(.required)":".required");r.$docContainer.find(o).css("background-color",(0,j.colorConvertor)(0==i?e:n,"HTML",t))}))}},{key:"isReadOnly",value:function(){var e=this.docRender.getUserPermission().getValue();return!(32&e||256&e)}},{key:"isSameTarget",value:function(e){return this.control==e}},{key:"focusControl",value:function(e,t){var n=this;if(this.control!=e){if(e&&function(e){var t=e.getBoundingClientRect(),n=Math.max(document.documentElement.clientHeight,window.innerHeight);return t.bottom<100||t.top>n}(e.$handler[0])){var i=e.annot,r=i.getPage().getIndex(),o=i.getRect();this.pdfViewer.getPDFDocRender().goToPage(r,{x:o.left,y:o.bottom,width:o.right-o.left,height:o.top-o.bottom},!0)}return(this.control&&this.control.annot?Promise.resolve(this.blurControl()):Promise.resolve(!1)).then((function(i){i&&!t||(n.control=e,e&&e.focus(t))}))}}},{key:"blurControl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!(this.isRunningAction||this.control&&this.control.isOnFocus)){this.dt&&this.dt.close();var t=this.pdfViewer,n=t.getStateHandlerManager().getCurrentStates().getStateName();ka.indexOf(n)>-1?t.setHighlightControlsUI(!1):t.setHighlightControlsUI(t.highlightControls());var i=this.control;return this.control=null,i&&i.annot?(t.unActiveElement(i),i.blur(e,e)):void 0}}},{key:"setValue",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.getField(),r=i.getValue();i.setValueWithoutAction(t);var o={rc:!0},a=!0;t===r&&(a=!1);var s=!1,u=i.getAction(vo.FieldKeyStroke);if(a&&u){if(o=this.execAction("Field",u,null,i,vo.FieldKeyStroke,{change:t,willCommit:n}),!i.form||!i.doc)return Promise.resolve(!1);o&&-1!==o&&(o.rc?(o.changed||(o.change=t),i.setValueWithoutAction(o.change)):(s=!0,t=r))}if(s)return i.setValue(r).then((function(){return Promise.resolve(o.rc)}));if(u=i.getAction(vo.FieldValueChanged),a&&u){if(o=this.execAction("Field",u,null,i,vo.FieldValueChanged),!i.form||!i.doc)return Promise.resolve(!1);-1!==o&&(o.rc?(void 0===o.value&&(o.value=t),i.setValueWithoutAction(o.value)):s=!0)}return i.form&&i.doc?s?i.setValue(r).then((function(){return Promise.resolve(o.rc)})):a?i.syncValue(i.getValue(),this).then((function(){return i.form?(i.form.calculate(i),Promise.resolve(o&&o.rc||-1===o)):Promise.resolve(!1)})):(u=i.getAction(vo.FieldWillFormat),i.getValue()&&u&&(o=this.execAction("Field",u,null,i,vo.FieldWillFormat)),i.form?o&&!o.rc?i.setValue(r).then((function(){return Promise.resolve(o.rc)})):Promise.resolve(o&&o.rc):Promise.resolve(!1)):Promise.resolve(!1)}},{key:"calculate",value:function(e){this.doc.getPDFForm().calculate(e)}},{key:"execAction",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(!t)return!0;var s=this.pdfViewer.actionManager.get(t,this);switch(s.setSourceTarget(i,r),t.getType()){case"TypeJavaScript":return s.setTypeName(e,o),s.setParam(a),s.active();case"TypeURI":return this.isRunningAction=!0,s.active((function(e){if(n.isRunningAction=!1,n.control){var t=n.control.$textInput;t&&t.focus()}}));default:s.active()}return-1}},{key:"getFormatedData",value:function(e){var t=this,n={},i=this.doc.getPDFForm();return i.enumFields([],0,(function(r,o,a){var s=i.getField(o),u=s.getAction(vo.FieldWillFormat);if(6==r&&u){var c=a;if("display"==e)if(s.getDisplayValue())n[o]=s.getDisplayValue();else{var l=a.length>0&&u&&t.execAction("Field",u,null,s,vo.FieldWillFormat);!1!==l&&l&&l.rc&&(c=l.value),n[o]=c}else n[o]=c}})),n}},{key:"reshowDTPicker",value:function(e){this.dt._input||(this.dt._input=this.dt._inputTemp),this.dt.open(null,e)}},{key:"showDateTimePicker",value:function(e,t,n,i){var r=this,o=-1!==t.indexOf("H"),a=-1!==t.indexOf("s")||-1!==t.indexOf("S"),s=this.pdfViewer.getCurrentLanguage();s=this.switchToFlatpickrLocale(s);var u={onOpen:[function(){r.dt&&(r.dt.isOpen=!0)}],onClose:[i,function(){r.dt&&(r.dt.isOpen=!1)}],onMonthChange:[function(e,n,o){var a=new Date(e[0].getTime());a.setMonth(o.currentMonth),a.setFullYear(o.currentYear);var s=o.formatDate(a,t),u=new Date(s);"Invalid Date"===u.toString()&&(u=a),r.dt.setDate(u,!1,t),i("",s)}],onYearChange:[function(e,n,o){if(t.match(/y|Y/)){var a=new Date(e[0].getTime());a.setMonth(o.currentMonth),a.setFullYear(o.currentYear);var s=o.formatDate(a,t),u=new Date(s);"Invalid Date"===u.toString()&&(u=a),r.dt.setDate(u,!1,t),i("",s)}}],parseDate:function(e,t){var n=ya().parseDate(e,t);if(n&&t.indexOf("K")>0){var i=e.split(" "),r=i[i.length-1].toLowerCase();if(["am","pm"].includes(r)>-1){var o=e.split(":");("pm"==r&&o[0]<12||"am"==r&&o[0]>12)&&n.setHours(o[0])}}return n},clickOpens:!1,now:new Date,allowInput:!0,dateFormat:t,enableTime:!0,time_24hr:o,enableSeconds:a,locale:s};this.dt&&this.dt.destroy();var c=this.dt=Object.assign(this.dt||{},ya()(n,u));this.dt._input||(this.dt._input=this.dt._inputTemp),O()(c.timeContainer).toggle(!!t.match(/h|H|i/));var l=!!t.match(/m|d|y|F|M|Y/);O()(c.monthNav).toggle(l),O()(c.innerContainer).toggle(l),o?c.amPMTemp||(c.amPMTemp=c.amPM,delete c.amPM):c.amPM||(c.amPM=c.amPMTemp,delete c.amPMTemp),O()(c.amPM||c.amPMTemp).toggle(!o),o?(O()(c.hourElement).attr("min",0),O()(c.hourElement).attr("max",23)):(O()(c.hourElement).attr("min",0),O()(c.hourElement).attr("max",12)),c.element=c.input=n;var d=e,h=t;if(e.length>0&&-1===t.indexOf("d")){var f=new Date,g=e.indexOf("/");d=-1!==g?e.slice(0,g)+"/"+f.getDate()+e.slice(g):e+"/"+f.getDate(),h=-1!==(g=t.indexOf("/"))?t.slice(0,g)+"/d"+t.slice(g):t+"/d"}var v=d?new Date(d):new Date;"Invalid Date"===v.toString()&&(v=d),c.setDate(v,!1,h),O()(c).find(".flatpickr-time .flatpickr-time-separator").toggle(!!t.match(/d/));var p=O()(c.timeContainer).find(".flatpickr-second").parent();p.toggle(a),p.prev().toggle(a),setTimeout((function(){c.close(),c.redraw(),c.open(null,n)}),10),delete n._flatpickr}},{key:"switchToFlatpickrLocale",value:function(e){var t=flatpickr.l10ns.en;switch(e){case"zh-CN":t=flatpickr.l10ns.zh;break;case"zh-TW":t=flatpickr.l10ns.zh_tw;break;case"en-US":t=flatpickr.l10ns.en;break;case"ja-JP":t=flatpickr.l10ns.ja;break;case"ko-KR":t=flatpickr.l10ns.ko;break;case"de-DE":t=flatpickr.l10ns.de;break;case"fr-FR":t=flatpickr.l10ns.fr;break;case"it-IT":t=flatpickr.l10ns.it;break;case"es-ES":t=flatpickr.l10ns.es;break;case"nl-NL":t=flatpickr.l10ns.nl}return t}},{key:"_bindTabEvent",value:function(e){var t=this;this.doc.getAnnots().then((function(n){n.some((function(e){return e.some((function(e){return"widget"!==e.getType}))}))&&t.goPreviousOrNextWidget(e)}))}},{key:"_stopInterceptor",value:function(e,t){var n=e.native.target;(!!n.closest(".fv__pdf-form-control-handler-container")||"BODY"===n.nodeName)&&t(e)}}]),n}(te);const wa=ba;var _a=function(){function e(t,n){(0,P._)(this,e),this.pdfviewer=t,this.docRender=n,this.$ui=O()('<canvas class="fv_shapes_ui"></canvas>')}return(0,A._)(e,[{key:"initPageShapes",value:function(e){this.pdfviewer.getAllActiveElements();return this.targetPage&&this.targetPage.index==e||((this.targetPage=this.docRender.pagesRender.pageRenders[e]).$ui.append(this.$ui.show()),this.drawShape()),!0}},{key:"setOffset",value:function(e,t){var n=1e6,i=1e6,r=0,o=0,a=this.path={},s=this.pdfviewer.getAllActiveElements(),u=(s[0].pageRender?s[0].pageRender:s[0].annotsRender.pageRender).$ui[0].getBoundingClientRect();for(var c in s.forEach((function(e){var t;e.getRect?((t=e.getRect()).width=t.right-t.left,t.height=t.bottom-t.top,t.left=u.left+t.left,t.right=u.left+t.right,t.bottom=u.top+t.bottom,t.top=u.top+t.top):t=e.$label[0].getBoundingClientRect(),t.left<n&&(n=t.left),t.top<i&&(i=t.top),t.right>r&&(r=t.right),t.bottom>o&&(o=t.bottom),a[e.annot.getId()]={left:t.left,top:t.top,width:t.width,height:t.height}})),this.path){var l=this.path[c];l.left-=n,l.top-=i}this.deltaX=e-n,this.deltaY=t-i;var d={width:r-n+2,height:o-i+2};this.$ui.css(d).attr(d)}},{key:"drawShape",value:function(){var e=this.$ui[0],t=e.getContext("2d");for(var n in t.clearRect(0,0,e.offsetWidth,e.offsetHeight),t.save(),t.beginPath(),t.strokeStyle="#5aa",t.lineWidth=2,this.path){var i=this.path[n];t.rect(i.left+1,i.top+1,i.width,i.height)}t.stroke(),t.restore()}},{key:"update",value:function(e,t){if(this.targetPage){var n=this.targetPage.$ui[0].getBoundingClientRect(),i=Math.max(n.left,e-this.deltaX),r=Math.max(n.top,t-this.deltaY),o=this.$ui[0];i+o.offsetWidth>n.right&&(i=n.right-o.offsetWidth),r+o.offsetHeight>n.bottom&&(r=n.bottom-o.offsetHeight),this.$ui.css({left:i-n.left,top:r-n.top})}}},{key:"hide",value:function(){return this.targetPage=null,this.$ui&&this.$ui.hide(),!1}},{key:"destroy",value:function(){this.pdfviewer=null,this.docRender=null,this.$ui&&(this.$ui.remove(),this.$ui=null)}},{key:"moveAnnot",value:function(e){var t=this,n=e[0].annot.getPDFPage(),i=this.targetPage;if(!i)return Promise.resolve(this.hide());var r=i.page,o=n.getIndex(),a=i.index;if(a==o)return Promise.resolve(this.hide());var s=n.doc,u=e.reduce((function(e,t){return t.getRelevanceRenders?(0,I._)(e).concat((0,I._)(t.getRelevanceRenders(!0))):(0,I._)(e).concat([t.annot.getId()])}),[]).reduce((function(e,r){var a=n.annotIdMap[r],s={},u={},c=t.path[r];if(c){var l=t.pdfviewer.getAnnotRender(o,r);l=l.component,s="FreeTextCallout"==a.getIntent()?l.backupProperty.rect:a.getRect();var d=c.left,h=c.top,f=t.$ui[0].getBoundingClientRect(),g=l.getRect();f={width:g.right-g.left,height:g.bottom-g.top,left:f.left+d,top:f.top+h},u=i.getPDFRectFromClientRect(f)}return e[r]={rect:u,oldRect:s},e}),{});return this.pdfviewer.killFocus().then((function(e){var i=Object.keys(u).map((function(e){return Number(e)}));return n.getAnnotsByObjectNumArray(i).then((function(e){var i=e.reduce((function(e,t){return e[t.getUniqueID()]=u[t.getObjectNumber()],e}),{});return s.moveAnnotsToPage(n,r,u).then((function(e){return t.pdfviewer.collaborate(yo.MOVE_ANNOTS_BETWEEN_PAGES,{fromPageIndex:o,toPageIndex:a,annots:i}),e}))}))})).then((function(e){return t.hide(),e}))}}]),e}();const Pa=_a;var Aa=["movingstart","movingend","movingcancel"],Sa=["mousemove"],xa=function(){function e(t,n){(0,P._)(this,e),this.pdfviewer=t,this.docRender=n,this.state=0,this.initHammer(t,n)}return(0,A._)(e,[{key:"initHammer",value:function(e,t){var n=this;if("JR"===e.config.engineMode){var i=t.$doc;this.movingstart=function(r){r.deltaX,r.deltaY;var o=r.srcEvent;if(0==n.state){var a=n.shapeManager=new Pa(e,t);n.mousemove=function(e){if(!(n.state<2)){var t,i,r=(t=e.target,(i=O()(t).parents(".fv__pdf-page-layout")).length?i.attr("data-index"):-1);if(-1!=r){n.state=2;var o=n.getEnableMoveElement();if(o&&o.length)if(!n.toggleShapeControl(o,+r))a.initPageShapes(r)?(a.update(e.clientX,e.clientY),n.state=3):(n.state=1,n.getEnableMoveElement().forEach((function(e){var t=e.shapeControl;t&&(t.show(),t.enable())})))}}},Sa.forEach((function(e){return i.on(e,n[e])}))}n.shapeManager&&(n.shapeManager.setOffset(o.clientX,o.clientY),n.state=2)},this.movingend=function(e){n.shapeManager&&(3==n.state&&n.shapeManager&&n.shapeManager.moveAnnot(n.getEnableMoveElement()).then((function(e){n.getEnableMoveElement().forEach((function(e){var t=e.shapeControl;t&&((0,D._)(e,To)?(e._applyShapeChange(),t.show(),t.enable()):e.shapeControlOnEnd())})),n.pdfviewer.initializers[2].selectAllAnnotOrWidget(n.pdfviewer,e.filter((function(e){return"popup"!==e.getType()})))})),n.state=1)},this.movingcancel=function(e){n.shapeManager&&(n.shapeManager.hide(),n.state=1)},Aa.forEach((function(t){return e.eventEmitter.on(t,n[t])}))}}},{key:"toggleShapeControl",value:function(e,t){var n=this,i=e[0].annot.getPDFPage().getIndex(),r=!1,o=this.pdfviewer.customs.isCollaborationMode&&this.pdfviewer.customs.isCollaborationMode();return e.forEach((function(e){if(o&&n.pdfviewer.customs.getAnnotPermissionsSync(e.annot).indexOf("fully")<0)return;var a=e.shapeControl;-1==t||t==i?(a&&(a.show(),a.enable()),(0,D._)(e,To)||e.$label.show(),n.shapeManager.hide(),r=!0):(a&&a.hide(),(0,D._)(e,To)||e.$label.hide())})),r}},{key:"getActiveElement",value:function(){return this.pdfviewer.getAllActiveElements()}},{key:"getEnableMoveElement",value:function(){var e=this.getActiveElement(),t=-1===e.findIndex((function(e){return e.shapeControl&&e.shapeControl.isDisabled}));return t?e:[]}},{key:"destroy",value:function(){var e=this,t=this.pdfviewer;Aa.forEach((function(n){t.eventEmitter.off(n,e[n]),e[n]=null}));var n=this.docRender.$doc;Sa.forEach((function(t){n.off(t,e[t]),e[t]=null})),this.pdfviewer=null,this.docRender=null,this.shapeManager&&this.shapeManager.destroy()}}]),e}();const Ca=xa;var Da=[{background:"#ffffff",foreground:"#000000",componentName:"white"},{background:"#faf9de",foreground:"#1f1f00",componentName:"yellowish"},{background:"#fff2e2",foreground:"#381f00",componentName:"lightOrange"},{background:"#dce2f1",foreground:"#232a3c",componentName:"lightBlue"},{background:"#3b3537",foreground:"#b0afac",componentName:"lightBlack"},{background:"#333333",foreground:"#838383",type:"moon",componentName:"moon"}],Ea=function(){var e={background:null,foreground:null},t=localStorage.getItem("change-color-user-choice");return t&&Da[Number(t)]&&(e=function(e){for(var t in delete(e=JSON.parse(JSON.stringify(e))).type,e)e.hasOwnProperty(t)&&(e[t]=Number(e[t].replace("#","0xff")));return e}(Da[Number(t)])),e},Ia=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;(0,P._)(this,e),this.top=t,this.left=n,this.bottom=i,this.right=r},Ra=function(){function e(t){(0,P._)(this,e),this.offsetLeft=0,this.offsetTop=0,this.offsetRight=0,this.offsetBottom=0,this.target=t}return(0,A._)(e,[{key:"moveLeft",value:function(e){return this.offsetLeft+=e,this.offsetRight+=e,this}},{key:"moveTop",value:function(e){return this.offsetTop+=e,this.offsetBottom+=e,this}},{key:"move",value:function(e,t){return this.moveLeft(e).moveTop(t)}},{key:"moveTo",value:function(e,t){return this.offsetLeft=this.offsetRight=this.target.left-e,this.offsetTop=this.offsetBottom=this.target.top-t,this}},{key:"shrink",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;return this.add(new Ia(e,t,-n,-i))}},{key:"expand",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;return this.add(new Ia(-e,-t,n,i))}},{key:"zoom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"center",i=this.target.right+this.offsetRight-(this.target.left+this.offsetLeft),r=this.target.bottom+this.offsetBottom-(this.target.top+this.offsetTop),o=i*e-i,a=r*e-r,s=0,u=0,c=0,l=0;switch(t){case"right":s=-o;break;case"center":s=-o/2,u=o/2;break;default:u=o}switch(n){case"bottom":c=-a;break;case"center":c=-a/2,l=a/2;break;default:l=a}return this.add(new Ia(c,s,l,u))}},{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.top,n=void 0===t?0:t,i=e.left,r=void 0===i?n:i,o=e.bottom,a=void 0===o?n:o,s=e.right,u=void 0===s?r:s;return this.offsetLeft+=r,this.offsetRight+=u,this.offsetBottom+=a,this.offsetTop+=n,this}},{key:"extract",value:function(){var e=this.target.left+this.offsetLeft,t=this.target.right+this.offsetRight;return{left:e,top:this.target.top+this.offsetTop,right:t,bottom:this.target.bottom+this.offsetBottom}}},{key:"boundary",value:function(){var e=this.target.left+this.offsetLeft,t=this.target.right+this.offsetRight,n=this.target.top+this.offsetTop;return{left:e,top:n,width:t-e,height:this.target.bottom+this.offsetBottom-n}}},{key:"intersect",value:function(t){(0,D._)(t,e)||(t=e.on(t));var n=this.toPlainObject(),i=t.toPlainObject(),r={left:Math.max(n.left,i.left),right:Math.min(n.right,i.right),top:Math.max(n.top,i.top),bottom:Math.min(n.bottom,i.bottom)};return e.on(r)}},{key:"toPlainObject",value:function(){return{left:this.target.left+this.offsetLeft,right:this.target.right+this.offsetRight,top:this.target.top+this.offsetTop,bottom:this.target.bottom+this.offsetBottom}}}],[{key:"isOverlap",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.max(e.left,t.left),r=Math[n?"min":"max"](e.top,t.top),o=Math[n?"max":"min"](e.bottom,t.bottom),a=Math.min(e.right,t.right);if(i<=a)if(n){if(r>=o)return(a-i)*(r-o)}else if(r<=o)return(a-i)*(o-r);return 0}},{key:"isInRect",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e>=n.left&&e<=n.right)if(i){if(t>=n.bottom&&t<=n.top)return!0}else if(t<=n.bottom&&t>=n.top)return!0;return!1}},{key:"rectInRect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!!(e.left>=t.left&&e.right<=t.right)&&(n?e.top<=t.top&&e.bottom>=t.bottom:e.top>=t.top&&e.bottom<=t.bottom)}},{key:"isSimilar",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;return Math.abs(e.top-t.top)<n&&Math.abs(e.bottom-t.bottom)<n&&Math.abs(e.left-t.left)<n&&Math.abs(e.right-t.right)<n}},{key:"on",value:function(t){return new e(t)}},{key:"subtract",value:function(e,t){return new Ia(e.top-t.top,e.left-t.left,e.bottom-t.bottom,e.right-t.right)}},{key:"expandOffset",value:function(e,t){return new Ia(e.top-t.top,e.left-t.left,t.bottom-e.bottom,t.right-e.right)}},{key:"copyTo",value:function(e,t){t.left=e.left,t.top=e.top,t.right=e.right,t.bottom=e.bottom}}]),e}(),Ta=g(1276);function Fa(e,t,n){if(j.isMobile&&j.isSafari&&(new RegExp(/\sversion\/(.*?)\s/i).test(navigator.userAgent.toLowerCase())&&Number(RegExp.$1)<13))return window.pdfui.pdfViewer.viewerUI.alert("alert.browserNotSupportDownload");void 0===n&&(n="application/octet-stream");var i=(0,D._)(e,Blob)?e:new Blob(e,{type:n});(0,Ta.saveAs)(i,t)}var Ma=Va("hand"),Oa=(Va("annot"),"fv__hidden"),La=j.LoggerFactory.getLogger("PDFDocRender"),Na=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;(0,P._)(this,n),(o=t.call(this,r)).name="pdfDocRender",o.$ui=e,o.rotation=0,o.doc=i,o.lastPageNumber=0,o.currentPageNumber=0,o.currentAnnot=null,o.viewerRender=r;var a=r.scrollWrap.getScrollHost();((0,D._)(a,Window)||a===document.body||a==document.documentElement)&&(a=document),o.intersectionObserver=new j.BuiltinIntersectionObserver(a),o.visiblePageIndexesStore=new j.ValueStore,o.visiblePageIndexesStore.reduce((function(e){return e.slice(0)}));var s=[0];"facing-continuous-page-view-mode"==o.viewerRender.ViewMode.getName()&&s.push(1),o.visiblePageIndexesStore.dispatch(s);var u=o.pdfViewer=r.pdfViewer,c=O()('<div class="fv__pdf-doc-layout"> <div class="fv__pdf-doc-rendering"></div> <div class="fv__pdf-doc-custom-container"></div> <div class="fv__pdf-doc-container"></div> <div class="fv__pdf-doc-handler-container"></div> </div>');c[0].id=i.id,e.append(c),o.$doc=c,o.$rendering=c.find(".fv__pdf-doc-rendering"),o.$container=c.find(".fv__pdf-doc-container"),o.pdfDocRendering=new(u.customs.PDFDocRendering||da)(o.$rendering[0],(0,w._)(o)),o.docCustomRender=new(u.customs.DocCustomRender||ha)(c.find(".fv__pdf-doc-custom-container")[0],(0,w._)(o)),o.zoomToTaskExecutor=new j.DebounceAsyncTaskExecutor,o.bindEvent(),o.controlStateClass=Ma,o.$container.addClass(Ma),o.handlerInit(c.find(".fv__pdf-doc-handler-container")),o.initTransparencyGridChecked(),o.watermarkConfig=u.config.watermarkConfig;var l=o.customPermission_=u.customs.getDocPermissions||function(){return-1};i.setCustomPermission("standard",l),l=u.customs.getAdditionalPerm||function(){return-1},i.setCustomPermission("additional",l),i.setCustomPermission("replaceStandard",u.customs.getStandardPermissions);var d=u.eventEmitter;return d.on(de.annotationAppearanceUpdated,o.annotationAppearanceUpdatedBind=function(e,t){if(t.getPDFDoc()===o.doc)try{var n=e[0];if(7===(n&&n.info.fieldType)){var i=t.getIndex(),r=o.getPDFPageRender(i),a=r.scale,s=r.rotate,u=r.containerVisibleRect,c=n.objectNumber;o.getAnnotRender(i,c).render(a,s,u)}else o.getPDFPageRender(t.getIndex()).redrawAnnotRenders(e)}catch(e){}}),d.on(de.annotationMovedPosition,o.annotationMovedPositionBind=function(e,t,n){if(t.getPDFDoc()===o.doc)try{o.getPDFPageRender(t.getIndex()).movedAnnotRenders(e,n)}catch(e){}}),d.on(de.annotationRemoved,o.annotationRemovedBind=function(e,t){if(t.getPDFDoc()===o.doc)try{o.getPDFPageRender(t.getIndex()).removeAnnotRenders(e)}catch(e){}}),d.on(de.annotationImported,o.updateImportedAnnotsBind=function(e,t){if(e===i&&o.pagesRender)try{o.pagesRender.setRenderFlags(1),o.setRebuildAnnotsFlag(!1),o.pagesRender.renderVisiblePages().catch((function(e){0}))}catch(e){La.warn(e)}}),d.on(de.pageRotationChange,o.rotationPageBind=function(e,t,n){if(e.getPDFDoc()===o.doc)try{var i=o.pagesRender.pageRenders[e.getIndex()];i.$annotsContainer.addClass("fv__viewer-annot-container-hide"),i.clearCanvasCache(!0),i.renderLayout().then((function(e){o.pagesRender.setRenderFlags(7),o.pagesRender.renderVisiblePages()}))}catch(e){console.error(e)}}),d.on(de.pagesRotated,o.rotationPagesBind=function(e,t,n){e.forEach((function(e,i){o.rotationPageBind(e,t,n[i])}))}),d.on(de.customDataAdd,o.customDataAddBind=function(e,t,n){if(o.doc.getId()===n)try{o.getPDFPageRender(t).addCustomRenders(e)}catch(e){}}),d.on(de.customDataImported,o.customDataImportedBind=function(e){if(o.doc.getId()===e)try{o.pagesRender.setRenderFlags(32),o.pagesRender.renderVisiblePages().catch((function(e){0}))}catch(e){}}),d.on(de.customDataRemoved,o.customDataRemovedBind=function(e,t,n){if(o.doc.getId()===n)try{o.getPDFPageRender(t).removeCustomRenders(e)}catch(e){}}),d.on(de.customDataUpdated,o.customDataUpdatedBind=function(e,t,n){if(o.doc.getId()===n)try{o.getPDFPageRender(t).updateCustomRenders(e)}catch(e){}}),d.on(de.pagesBoxChange,o.pagesBoxChangeEventListener=function(e){o.pagesRender&&o.pagesRender.setRenderFlags(8),o.pdfViewer.redraw(!0)}),d.on(de.pageRemoved,o.pageRemovedListener=function(e){var t=o.visiblePageIndexesStore.getCurrentValue([]),n=t.indexOf(e);n>-1&&t.splice(n,1);for(var i=o.doc.getPageCount(),r=0;r<t.length;r++)t[r]>e&&t[r]<=i&&(t[r]-=1);o.visiblePageIndexesStore.dispatch(t)}),d.on(de.pagesRemoved,o.pagesRemovedListener=function(e){var t=e.reduce((function(e,t){return 1===t.length?e.concat(t[0]):t.length>1?e.concat(function(e,t,n){n||(n=e>t?-1:1);for(var i=[],r=e;r<t;r+=n)i.push(r);return i.push(t),i}(t[0],t[1]-1)):e}),[]),n=o.visiblePageIndexesStore.getCurrentValue([]);t.forEach((function(e){var t=n.indexOf(e);t>-1&&n.splice(t,1)}));var i=o.doc.getPageCount();t.forEach((function(e){for(var t=0;t<n.length;t++)n[t]>e&&n[t]<=i?n[t]-=1:n[t]>i&&n.splice(t,1)})),o.visiblePageIndexesStore.dispatch(n)}),o.noInteraction=o.getUserPermission().checkCannotModifyExcludeAssemble()&&!o.doc.hasSignature(),d.on(de.permissionChanged,o.permissionChangedBind=function(){var e=o.getUserPermission().checkCannotModifyExcludeAssemble();o.noInteraction=e&&!o.doc.hasSignature();o.getUserPermission();o.loadFormRender().then((function(e){o.pdfViewer.redraw(!0)}))}),d.on(de.switchStateHandler,o.switchStateHandlerBind=function(e,t){e.getStateName()!==mn&&o.resetReadModeData&&o.quitReadMode(!1)}),o.docHandler=new Ca(u,(0,w._)(o)),o.allCommentVisible=!0,o.rebuildAnnotsFlag=!0,d.on("annot-filter",o.filterAnnot=function(e){"start"==e&&(o.forceLoadAnnot=1)}),o.isDocRendered=!1,o}return(0,A._)(n,[{key:"setRebuildAnnotsFlag",value:function(e){this.rebuildAnnotsFlag=e}},{key:"getRebuildAnnotsFlag",value:function(){return this.rebuildAnnotsFlag}},{key:"_updateVisiblePageIndex",value:function(e,t){var n=this.visiblePageIndexesStore.getCurrentValue(),i=n.indexOf(e);if(t){if(i>-1)return;n.push(e)}else i>-1&&n.splice(i,1);this.visiblePageIndexesStore.dispatch(n)}},{key:"getVisiblePageIndexes",value:function(){return this.visiblePageIndexesStore.getCurrentValue().sort((function(e,t){return e-t}))}},{key:"initTransparencyGridChecked",value:function(){var e=localStorage.getItem("PAGE_DISPLAY_DATA");if(e){var t=JSON.parse(e);this.doc.pageDisplayPreferences=t,this.doc.setPageDisplayPreferences(t)}}},{key:"getHandlerDOM",value:function(){return this.$doc.get(0)}},{key:"getBoundingClientRects",value:function(){var e=this.$container.find(".fv__pdf-view-mode-item"),t=this.viewerRender.scrollWrap.getScrollHost();t==window&&(t=document.body);for(var n="single-page-view-mode"===this.viewerRender.getViewMode().getName(),i=t.getBoundingClientRect(),r=[],o=0;o<e.length;o++){var a=e[o],s=O()(a).find(".fv__pdf-page-layout")[0].getBoundingClientRect();if(s.bottom>i.top&&s.top<i.bottom&&s.left<i.right&&s.right>i.left){var u={index:n?this.getCurrentPageIndex():o,scale:this.getPDFPageRender(o).scale,left:Math.max(i.left,s.left)-s.left,right:Math.min(i.right,s.right)-s.left,top:Math.max(i.top,s.top)-s.top,bottom:Math.min(i.bottom,s.bottom)-s.top};u.x=u.left,u.y=u.top,u.height=u.bottom-u.top,u.width=u.right-u.left,r.push(u)}}return r}},{key:"handlerInit",value:function(e){var t=this;e.on("click",(function(){t.unActiveAnnotRender()}))}},{key:"getFormRender",value:function(){return this.formRender}},{key:"setStateHandler",value:function(e){if(this.stateHandler){if(this.stateHandler.constructor.getStateName()===e.getStateName())return;this.stateHandler.destroyDocHandler()}(this.stateHandler=new e(this.pdfViewer)).docHandler(this)}},{key:"setViewMode",value:function(e){return this.pagesRender?this.pagesRender.setViewMode(e):Promise.resolve()}},{key:"getViewMode",value:function(){return this.pagesRender?this.pagesRender.getViewMode():void 0}},{key:"prevPage",value:function(){var e=this.getCurrentViewMode().getPrevPageIndex();return this.goToPage(e,{x:0,y:0})}},{key:"nextPage",value:function(){var e=this.getCurrentViewMode().getNextPageIndex();return this.goToPage(e,{x:0,y:0})}},{key:"goToPage",value:function(e){var t,n,i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.x,a=void 0===o?0:o,s=r.y,u=void 0===s?0:s,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments[1];l&&(t=l.width,n=l.height),this.isGoto=!0,e>=this.doc.getPageCount()?e=this.doc.getPageCount()-1:e<0&&(e=0);var d=this.pagesRender,h=d.getPDFPageRender(e);if(h)return h.getPDFPage().then((function(r){return d.getPageScale(e,i.scale).then((function(e){if(c){if(void 0!==t){var o=r.getDeviceRect({left:a,right:a+t,top:u+n,bottom:u},e,i.rotation);a=o.left,u=o.top,o.right<a&&(a=o.right),o.bottom<u&&(u=o.bottom)}else{var s=(0,E._)(r.getDevicePoint([a,u],e,i.rotation),2),l=s[0],d=s[1],h=r.info.height;(u>h||d<0)&&(d=0),a=l,u=d}return[e,a,u]}return[e,a,u]}))})).then((function(t){var n=(0,E._)(t,3),r=n[0],o=n[1],a=n[2],s=d.goToPage(e,r,o,a);if("fitVisible"!==i.scale||!s)return s})).catch((function(e){0})).finally((function(){i.moveDebounce()}));this.isGoto=!1}},{key:"setCurrentPageIndex",value:function(e){void 0!==e&&this.pageNumberChange(e)}},{key:"getCurrentPageIndex",value:function(){var e=this.getCurrentViewMode();return e&&"function"==typeof e.getCurrentPageIndex?e.getCurrentPageIndex():0}},{key:"pageNumberChange",value:function(e){if(e>=0&&this.currentPageNumber!==e){var t=0!=this.pdfViewer.enablePageAction;if(this.lastVIs&&t){var n=this.getPDFPageRender(this.currentPageNumber);n&&n.triggerAction(18),this.getPDFPageRender(e).triggerAction(17)}this.lastPageNumber=this.currentPageNumber,this.currentPageNumber=e,this.pdfViewer.eventEmitter.emit(de.pageNumberChange,e+1)}}},{key:"bindEvent",value:function(){}},{key:"destroy",value:function(e){if(!this.isDestroyed){var t=this.pdfViewer.eventEmitter;this.pagesRender&&this.pagesRender.destroy(),this.visiblePageIndexesStore.destroy(),(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.$doc.addClass("fv__destroying"),this.stateHandler&&this.stateHandler.destroyDocHandler(),this.docCustomRender.destroy(),this.$doc.remove(),this.zoomToTaskExecutor.destroy(),this.zoomToTaskExecutor=null,t.off(de.annotationAppearanceUpdated,this.annotationAppearanceUpdatedBind),t.off(de.annotationMovedPosition,this.annotationMovedPositionBind),t.off(de.annotationRemoved,this.annotationRemovedBind),t.off(de.annotationImported,this.updateImportedAnnotsBind),t.off(de.pageRotationChange,this.rotationPageBind),t.off(de.pagesRotated,this.rotationPagesBind),t.off(de.customDataAdd,this.customDataAddBind),t.off(de.customDataImported,this.customDataImportedBind),t.off(de.customDataRemoved,this.customDataRemovedBind),t.off(de.customDataUpdated,this.customDataUpdatedBind),t.off(de.permissionChanged,this.permissionChangedBind),t.off(de.pagesBoxChange,this.pagesBoxChangeEventListener),t.off(de.pageRemoved,this.pageRemovedListener),t.off(de.pagesRemoved,this.pagesRemovedListener),t.off("annot-filter",this.filterAnnot),t.off(de.switchStateHandler,this.switchStateHandlerBind),this.formRender&&this.formRender.destroy(),this.formRender=null;var i=null;if(e&&e.destroyCurrentDoc){var r=this.doc.id;this.pdfViewer.getWebPDFJR().then((function(e){e.pdfDocCacheMap.delete(r)})),i=this.doc.destroy()}return this.pdfDocRendering.destroy(),this.pdfDocRendering=null,this.pagesRender=this.docCustomRender=this.stateHandler=null,this.annotationAppearanceUpdatedBind=null,this.annotationMovedPositionBind=null,this.annotationRemovedBind=null,this.updateImportedAnnotsBind=null,this.updateAddAnnotsBind=null,this.rotationPageBind=null,this.rotationPagesBind=null,this.customDataAddBind=null,this.customDataImportedBind=null,this.customDataRemovedBind=null,this.customDataUpdatedBind=null,this.permissionChangedBind=null,this.pagesBoxChangeEventListener=null,this.pageRemovedListener=null,this.pagesRemovedListener=null,this.switchStateHandlerBind=null,this.docHandler.destroy(),i}}},{key:"rendering",value:function(){this.$doc.addClass("fv__doc-rendering"),this.pdfDocRendering.rendering()}},{key:"rendered",value:function(){this.$doc.removeClass("fv__doc-rendering"),this.pdfDocRendering.rendered(),this.isDocRendered=!0}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"fitWidth",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotation;return this.scale=t,this.rotation=n,this.rendering(),this.doc&&this.doc.setColors(Ea()),Promise.resolve(this.docCustomRender.render(t,n)).then((function(t){if(!1!==t)return e.doc.getPageSizes(0,e.pdfViewer.config.sizeCount).then((function(t){return e.doc.getRootLayerNodeChildrenCount()})).then((function(t){if(!(t>8e3))return e.doc.getLayerNodesJson()})).then((function(t){return e.doc.getTemplates()})).then((function(t){if(e.doc&&!e.doc.isDestroyed){var i=e.pagesRender=e.pagesRender||new la(e.$container,e.doc,e),r=e.loadFormRender(),o=Promise.resolve();if(e.pdfViewer.enableOpenAction){var a=localStorage.getItem("PAGE_DISPLAY_DATA"),s=e.doc.getViewerPreference().then((function(t){var n=t.uiLayout;if(a){var i=JSON.parse(a);i.navigation&&"useInitialView"!==i.navigation&&(n=e.transfUiLayoutKey(i.navigation))}e.executeNavigationAction(n),"FullScreen"===n&&(n=t.viewerPreference.NonFullScreenPageMode,e.executeNavigationAction(n))})),u=e.doc.getViewerPreference().then((function(t){var n=a?JSON.parse(a):void 0;e.executeLayeroutAction(t.pageLayout,n);var r=e.executeScaleAction(e.doc.action,n),o=r.pageIndex,s=r.scale;if(o>0){i.createPagesStructure();var u=i.viewMode;u.into(i.$ui.get(0),i.pageDOMs),u.jumpToPage(o,{x:0,y:0})}if(null!=s&&(e.scale=s),n){var c=n.customMarginChecked,l=n.margin,d=n.customFacingChecked,h=n.facingPages;c||(l=10),e.pdfViewer.setCustomMargin(l);["facing-page-view-mode","multipage-view-mode","facing-continuous-page-view-mode"].forEach((function(t){var n="multipage-"+e.pdfViewer.viewModeManager.ViewModes[t].getName();d?e.pdfViewer.store.dispatch(n,h):e.pdfViewer.store.dispatch(n,2)}))}return Promise.resolve()}));o=s.then((function(){return u}))}return o.then((function(t){return i.render(e.scale,n)})).then((function(e){return r})).then((function(){if(!e.stateHandler){var t=e.pdfViewer;(e.stateHandler=new(t.stateHandlerManager.getCurrentStates())(t)).docHandler(e)}Object.keys(e.doc.metadata).length<2&&e.doc.getMetadata(),"fitWidth"!=e.scale&&e.pdfViewer.eventEmitter.emit(de.updateZoomMode,e.scale)}))}}));e.rendered()}))}},{key:"loadFormRender",value:function(){var e=this;return(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.doc.reloadPDFForm():this.doc.loadPDFForm()).then((function(t){return(e.formRender=new wa(e.doc,e)).initJS()}))}},{key:"hidden",value:function(){this.$doc.addClass(Oa)}},{key:"show",value:function(){this.$doc.removeClass(Oa)}},{key:"zoomTo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;this.lastScale=this.scale;var r=this.scale;this.scale=t;var o=Promise.resolve(n);return n?"fitVisible"==t&&(o=this.getPDFPageRender(n.pageIndex).getPDFPage().then((function(e){return e.calcPageContentBBox(0)})).then((function(e){return n.x=e.left,n}))):o="fitVisible"!==t?this.getViewBoxCenter(!0,"topLeft").then((function(e){var t=(0,E._)(e,2),n=t[0],i=t[1];if(n)return{pageIndex:n.getIndex(),x:i[0],y:i[1]}})):this.getViewerStartPosition(),o.then((function(t){if(t)return Promise.all([e.pagesRender.getPageScale(0,r,e.rotation),e.getScaleRatio(1)]).then((function(n){var o=(0,E._)(n,2),a=o[0],s=o[1],u=function(t,n,i){return n.eventEmitter.emit(de.beforeZoomTo,t,a),e.pagesRender.zoomTo(e.scale,i).then((function(){return n.eventEmitter.emit(de.zoomToSuccess,e.scale,r,s,a),t}),(function(i){return e.scale=r,n.eventEmitter.emit(de.zoomToFailed,t,e.scale),Promise.reject(i)}))};return i?e.zoomToTaskExecutor.exec(u,[s,e.pdfViewer,t],e):u(s,e.pdfViewer,t)}))}))}},{key:"getScaleRatio",value:function(e){var t=this,n=function(){switch((0,R._)(t.scale)){case"number":return t.scale;case"string":return t.pagesRender?t.pagesRender.getScaleRatio(t.scale,t.rotate):1;default:return 1}};return e?Promise.resolve(n()):this.zoomToTaskExecutor.waitForLastTask().then(n,n)}},{key:"getScale",value:function(){return this.scale}},{key:"getRotation",value:function(){return this.rotation}},{key:"rotateTo",value:function(e,t){var n=this.rotation;return this.rotation=(e%360+360)%360,this.applyRotation(n,this.rotation,t)}},{key:"applyRotation",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this;return(0,_._)((function(){var r,o,a,s,u,c,l,d,h,f,g;return(0,F.Jh)(this,(function(v){switch(v.label){case 0:return 0===((t-e)%360+360)%360?[2]:((r=i.pdfViewer.eventEmitter).emit(de.beforeDocumentRotation,t,e),o=(0,j.isValidNumber)(n.pageIndex)?n.pageIndex:i.getCurrentPageIndex(),a=i.getPDFPageRender(o),s=0,u=0,null==n.offsetX||null==n.offsetY?[3,4]:(s=(0,j.isValidNumber)(n.offsetX)?n.offsetX:0,u=(0,j.isValidNumber)(n.offsetY)?n.offsetY:0,[4,i.pagesRender.rotateTo(t)]));case 1:return v.sent(),[4,a.transformPoint({point:{x:s,y:u},srcType:Yo.page,destType:Yo.pdf})];case 2:return c=v.sent(),[4,i.goToPage(o,c,!0)];case 3:return v.sent(),[3,9];case 4:return null==n.baseX||null==n.baseY?[3,9]:(u=(0,j.isValidNumber)(n.baseX)?n.baseX:0,u=(0,j.isValidNumber)(n.baseY)?n.baseY:0,[4,a.transformPoint({point:{x:s,y:u},srcType:Yo.page,destType:Yo.pdf})]);case 5:return l=v.sent(),[4,i.pagesRender.rotateTo(t)];case 6:return v.sent(),[4,a.transformPoint({point:l,srcType:Yo.pdf,destType:Yo.page})];case 7:return d=v.sent(),h=i.getValidContainerVisibleRect(),f=d.x-(h.left/2+h.right/2),g=d.y-(h.top/2+h.bottom/2),[4,i.goToPage(o,{x:Math.max(0,f),y:Math.max(0,g)})];case 8:v.sent(),v.label=9;case 9:return r.emit(de.afterDocumentRotation,t,e),[2]}}))}))()}},{key:"getPDFDoc",value:function(){return this.doc}},{key:"getPDFPageRender",value:function(e){try{return this.pagesRender.getPDFPageRender(e)}catch(e){return null}}},{key:"getCurrentViewMode",value:function(){try{return this.pagesRender.viewMode}catch(e){return null}}},{key:"getAnnotRender",value:function(e,t){try{return this.getPDFPageRender(e).getAnnotRender(t)}catch(e){return null}}},{key:"getAllAnnotRender",value:function(){for(var e=this.doc.getPageCount(),t=[],n=0;n<e;n++)t=t.concat(this.getPDFPageRender(n).getAllAnnotRender());return t}},{key:"unActiveAnnotRender",value:function(e){if(e)return e.unActive();try{this.pagesRender.unActiveAnnotRender()}catch(e){}}},{key:"setCurrentAnnotHandler",value:function(){var e=this.pdfViewer.stateHandlerManager.currentStateHandler.getStateName(),t=this.pdfViewer.getAllActiveElements().reverse();try{t.sort((function(e,t){return e.annot.getId()>t.annot.getId()?1:-1}))}catch(e){}"edit-all"!==e&&t.length?(t.forEach((function(e){e.shapeControl&&O()(e.shapeControl.ui).removeClass("current-annot")})),this.pdfViewer.isMultiSelectActive()?this.currentAnnot=t[t.length-1]:this.currentAnnot=t[0],this.currentAnnot.shapeControl&&O()(this.currentAnnot.shapeControl.ui).addClass("current-annot")):this.currentAnnot=null}},{key:"setWatermarkConfig",value:function(e){this.watermarkConfig=e}},{key:"getWatermarkConfig",value:function(){return this.watermarkConfig}},{key:"getUserPermission",value:function(){var e=this.doc,t=this.customPermission_(e),n=e.getPermissionsSync();return new fa(t&n)}},{key:"getOffsetInfo",value:function(){var e,t=0,n=0,i=0,r=this.pagesRender;if(!r)return(e=r.getPDFPageRender(t)).reverseDevicePoint([n,i]).then((function(n){var i=(0,E._)(n,2),r=i[0],o=i[1];return{index:t,left:r,top:o,scale:e.getScale(),rotate:e.getRotation()}}));for(var o=this.pdfViewer.$ui,a=o.parent()[0].getBoundingClientRect(),s=r.viewMode.getVisibleIndexes(),u=0,c=s.length;u<c;u++){t=s[u];var l=this.getCurrentViewMode().constructor.getName(),d=t;"single-page-view-mode"===l&&(d=0);var h=o.find(".fv__pdf-page-layout").eq(d)[0].getBoundingClientRect();if(!(h.bottom<=a.top)){(n=a.left-h.left)<0&&(n=0),(i=a.top-h.top)<0&&(i=0);break}}return(e=r.getPDFPageRender(t)).reverseDevicePoint([n,i]).then((function(n){var i=(0,E._)(n,2),r=i[0],o=i[1];return{index:t,left:r,top:o,scale:e.getScale(),rotation:e.getRotation()}}))}},{key:"getViewerStartPosition",value:function(e){return void 0===e&&(e=this.getCurrentPageIndex()),this.doc.getPageByIndex(e).then((function(t){return t.calcPageContentBBox(xt.CalcContentsBox).then((function(n){n&&void 0!==n.left&&n.left!==n.right&&n.top!==n.bottom||(n={left:0,right:t.info.mediaWidth,top:t.info.mediaHeight,bottom:0});var i=t.getRotation(),r=[n.left,n.top];switch(i){case 0:r=[n.left,n.top];break;case 1:r=[n.left,n.bottom];break;case 2:r=[n.right,n.bottom];break;case 3:r=[n.right,n.top]}return{pageIndex:e,x:r[0],y:r[1],rotation:i}}))}))}},{key:"getViewBoxCenter",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center",i=this.getCurrentPageIndex(),r=this.viewerRender.scrollWrap.getScrollHost(),o=(e=r===window?{x:0,y:0,width:window.innerWidth,height:window.innerHeight}:r.getBoundingClientRect()).x+e.width/2,a=e.y+e.height/2,s={left:o-20,right:o+20,top:a-20,bottom:a+20},u=function(e){if(!e)return Promise.resolve();var n=e.$ui.get(0).getBoundingClientRect(),i=n.x,r=n.y,u=r+n.height,c=n.right;return Ra.isOverlap(s,{left:i,right:c,bottom:u,top:r},!1)?e.getPDFPage().then((function(n){if(t){var s=Math.max(0,o-i),u=Math.max(0,a-r);return Promise.all([n,n.reverseDevicePoint([s,u],e.getScale(),e.getRotation())])}return Promise.all([n,[o-i,a-r]])})):void 0};if("topLeft"==n){if(!this.pagesRender)return Promise.resolve([0,[0,0]]);var c=this.pagesRender.viewMode.getVisibleIndexes(),l=c.length>0&&(-1===c.indexOf(i)||j.isMobile)?c[0]:i,d=this.getPDFPageRender(l);if(!d)return Promise.resolve([null,[0,0]]);var h=d.page,f=d.$ui.get(0).getBoundingClientRect();o=Math.max(e.x,f.x),a=Math.max(e.y,f.y);var g=Math.max(0,o-f.x),v=Math.max(0,a-f.y);return h?Promise.all([h,h.reverseDevicePoint([g,v],d.getScale(),d.getRotation())]):d.getPDFPage().then((function(e){return Promise.all([e,e.reverseDevicePoint([g,v],d.getScale(),d.getRotation())])}))}for(var p=i;p<this.doc.getPageCount();p++){var m=u(this.getPDFPageRender(p));if(m)return m}for(var y=i-1;y>-1;y--){var k=u(this.getPDFPageRender(y));if(k)return k}return this.doc.getPageByIndex(i).then((function(e){return Promise.all([e,[0,0]])}))}},{key:"renderPages",value:function(e,t){return this.pagesRender.renderPages(e,t).catch((function(e){0}))}},{key:"moveDebounce",value:function(){var e=this;this._moveDebounce||(this._moveDebounce=(0,j.debounce)((function(){e.move()}),j.isChromiumEdge||j.isChrome||j.isFirefox||j.isSafari?20:50,!1)),this._moveDebounce()}},{key:"move",value:function(){var e=this,t=this;if(this.isDestroyed||!this.pagesRender)return Promise.resolve();var n=this.getCurrentViewMode(),i=this.pagesRender.pageRenders,r=this.getCurrentPageIndex();if(r>=i.length)return this.goToPage(r-1);var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t.isDestroyed?[]:t.visiblePageIndexesStore.takeWhile().then((function(t){return 0===t.length&&e<10?new Promise((function(e){return setTimeout(e,0)})).then((function(){return o(e+1)})):t.sort((function(e,t){return e-t}))}))};return o().then((function(t){var i=e.currentPageNumber;i!==r&&e.setCurrentPageIndex(r);var a,s=e,u=(a=(0,_._)((function(e){var t,n,i;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return[4,s.pagesRender.moveTo(e)];case 1:r.sent(),t=5,r.label=2;case 2:return t>=0?[4,o()]:[3,7];case 3:return n=r.sent(),i=n.filter((function(t){return-1===e.indexOf(t)})),i.length>0?[4,s.pagesRender.moveTo((0,I._)(new Set((0,I._)(e).concat((0,I._)(i)))))]:[3,5];case 4:return r.sent(),[3,6];case 5:return[3,7];case 6:return e=n,t--,[3,2];case 7:return[2]}}))})),function(e){return a.apply(this,arguments)});return u(t).then((function(){var r=e,o=e.currentPageNumber,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:19;e.forEach((function(e){r.getPDFPageRender(e)&&r.getPDFPageRender(e).triggerAction(t)}))};if(e.lastVIs){var s=e.lastVIs.filter((function(e){return-1==t.indexOf(e)}));a(s,20),a(s=t.filter((function(t){return-1==e.lastVIs.indexOf(t)})))}else a(t),a(t,17);(e.lastVIs=t,"fitVisible"===e.scale&&n&&o!==i)&&("single-page-view-mode"===n.constructor.getName()&&e.zoomTo("fitVisible"))}))}))}},{key:"getContainerOffsetLeftTop",value:function(){var e=this._offsetTop;if("number"==typeof e)return{left:this._offsetLeft,top:e};e=0;for(var t=0,n=this.$container[0],i=this.viewerRender.scrollWrap.getScrollHost();n&&(e+=n.offsetTop,t+=n.offsetLeft,(n=n.offsetParent)!==i););return{left:t,top:e}}},{key:"getContainerVisibleRect",value:function(){var e=document.documentElement,t=e.clientWidth,n=e.clientHeight,i=this.viewerRender.scrollWrap.getScrollHost(),r=0,o=t,a=0,s=n;if((0,D._)(i,HTMLElement)){var u=i.getBoundingClientRect();r=Math.max(r,u.left),o=Math.min(o,u.right),a=Math.max(a,u.top),s=Math.min(s,u.bottom)}return{left:r,right:o,top:a,bottom:s}}},{key:"getValidContainerVisibleRect",value:function(){var e,t,n,i,r=document.documentElement,o=(r.clientWidth,r.clientHeight,this.viewerRender.scrollWrap.getScrollHost());if((0,j.isHTMLElement)(o)){var a=o.getBoundingClientRect();e=a.left,t=a.left+o.clientWidth,n=a.top,i=a.top+o.clientHeight}else((0,j.isWindowObject)(o)||(0,j.isDocument)(o))&&(e=0,n=0,t=document.body.clientWidth,i=document.body.clientHeight);return e=Math.max(0,e),n=Math.max(0,n),{left:e,right:t=Math.min(t,document.body.clientWidth),top:n,bottom:i=Math.min(i,document.body.clientHeight)}}},{key:"getContainerVisiblePageIndexes",value:function(){if(!this.viewerRender||!this.getViewMode())return[];switch(this.viewerRender.getViewMode().getName()){case"single-page-view-mode":case"facing-continuous-page-view-mode":case"facing-page-view-mode":case"continuous-view-mode":return this.getViewMode().getVisibleIndexes()}for(var e,t,n,i,r=this.getCurrentPageIndex(),o=O()(this.pagesRender.pageDOMs),a=o.length,s=r-1,u=r,c=[],l=this.getContainerVisibleRect(),d=l.left,h=l.right,f=l.top,g=l.bottom;;){if(!i&&u<a){var v=o[u],p=O()(v).find(".fv__pdf-page-container"),m=p.length>0?p[0].getBoundingClientRect():v.getBoundingClientRect();m.right>d&&m.left<h&&m.bottom>f&&m.top<g?(c.push(O()(v).index()),n=!0):n&&(i=!0),u++}else!i&&u>=a&&(i=!0);if(!t&&s>-1){var y=o[s],k=O()(y).find(".fv__pdf-page-container"),b=k.length>0?k[0].getBoundingClientRect():y.getBoundingClientRect();b.right>d&&b.left<h&&b.bottom>f&&b.top<g?(c.unshift(O()(y).index()),e=!0):e&&(t=!0),s--}else!t&&s<=-1&&(t=!0);if(i&&t)break}return c}},{key:"downloadFileSpec",value:function(e,t){this.doc.getFileSpecStream(e).then((function(e){Fa(e,t,"application/octet-stream")}))}},{key:"downloadFileSpecByName",value:function(e,t){this.doc.getFileSpecStreamByName(e).then((function(e){Fa(e,t,"application/octet-stream")}))}},{key:"performAction",value:function(e){var t=this.doc.getAdditionalAction(e);this.pdfViewer.actionManager.get(t,this).active(!0)}},{key:"setPrintState",value:function(e){this._isPrinting=e}},{key:"isPrinting",value:function(){return this._isPrinting}},{key:"transfUiLayoutKey",value:function(e){var t="";switch(e){case"pageOnly":t="PageOnly";break;case"bookmarksPanelAndPage":t="UseOutlines";break;case"pagesPanelAndPage":t="UseThumbs";break;case"attachmentsPanelAndPage":t="UseAttachments";break;case"layersPanelAndPage":t="UseOC"}return t}},{key:"executeNavigationAction",value:function(e){this.pdfViewer.customs.executeNavigationAction(e,this.pdfViewer)}},{key:"executeLayeroutAction",value:function(e,t){if(1!=this.doc.getPageCount()){var n=e;if("Default"===n&&t&&t.defaultPageLayout)switch(t.defaultPageLayout){case"continuous":n="OneColumn";break;case"singlePage":n="SinglePage";break;case"facing":n="TwoPageLeft";break;case"continuous-Facing":n="TwoColumnLeft"}var i="";switch(n){case"SinglePage":i="single-page-view-mode";break;case"OneColumn":i="continuous-view-mode";break;case"TwoPageLeft":i="facing-page-view-mode";break;case"TwoColumnLeft":i="facing-continuous-page-view-mode"}i&&this.pdfViewer.viewModeManager.set(i)}}},{key:"executeScaleAction",value:function(e,t){var n,i,r={pageIndex:void 0,scale:void 0};if(!(e&&"TypeGoto"===e.getType()||t))return r;if(e&&e.getDestination&&(r={pageIndex:i=(n=e.getDestination()).pageIndex}),n&&void 0!==n.zoomMode&&"ZoomXYZ"!==n.zoomMode||n&&n.zoomFactor>0){var o=n.zoomFactor;switch(n.zoomMode){case"actualSize":o=1;break;case"ZoomFitPage":case"ZoomFitVert":o="fitHeight";break;case"ZoomFitHorz":o="fitWidth";break;case"ZoomFitBHorz":o="fitVisible"}r={pageIndex:i,scale:o}}else if(t){var a=t.zoom;switch(Number.isNaN(parseFloat(a))||(a/=100),t.zoom){case"autoMatic":case"fitWidth":a="fitWidth";break;case"actualSize":a=1;break;case"fitPage":a="fitHeight";break;case"fitVisible":a="fitVisible"}a&&(r={pageIndex:i,scale:a})}return r}},{key:"isHandReadArticles",value:function(){var e=window.localStorage.getItem("PREFERENCES-GENNERAL");return!e||JSON.parse(e).handReadArticles}},{key:"startReadMode",value:function(e){var t=this,n=this.pdfViewer,i=this.$doc,r=i.get(0),o=n.stateHandlerManager,a=o.currentStateHandler.getStateName(),s=this.scale,u=e.children,c=u[0].pageIndex,l=0,d=function(){var e=u[l],n=e.objNum,i=e.pageIndex;t.pagesRender.pageRenders[i].articleBeads[n].read(),l+=1};o.switchTo(mn),n.goToPage(c,0,0,!1).then(d),i.get(0).addEventListener("click",this.readArticle=function(e){t.isHandReadArticles()&&(O()(e.target).closest(".fv__pdf-page-annots-container").length>0||(l>=u.length?t.quitReadMode():d()))},{capture:!0}),this.readArticleCursor&&r.removeEventListener("mouseover",this.readArticleCursor),r.addEventListener("mouseover",this.readArticleCursor=function(e){var n=t.isHandReadArticles(),r=!!t.resetReadModeData;i.toggleClass("fv__cursor-frame",n&&r),i.find(".fv__pdf-page-handler-container").toggleClass("fv__cursor-frame",n&&r)}),this.isHandReadArticles()&&(i.addClass("fv__cursor-frame"),i.find(".fv__pdf-page-handler-container").addClass("fv__cursor-frame")),this.resetReadModeData={pageIndex:c,scale:s,statesName:a,thread:e},n.eventEmitter.emit(de.articleEnterReadMode,e.objNum)}},{key:"quitReadMode",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.pdfViewer,n=this.$doc,i=t.getStateHandlerManager();n.get(0).removeEventListener("click",this.readArticle,{capture:!0}),n.get(0).removeEventListener("mouseover",this.readArticleCursor),n.removeClass("fv__cursor-frame"),n.find(".fv__pdf-page-handler-container").removeClass("fv__cursor-frame");var r=this.resetReadModeData,o=r.pageIndex,a=r.scale,s=r.statesName,u=r.thread;t.getPDFPageRender(o).$handler.find(".fv__mark-selection-blank").remove(),e&&i.switchTo(s),t.goToPage(o,0,0,!1).then((function(){t.zoomTo(a)})),t.eventEmitter.emit(de.articleOutReadMode,u.objNum),this.resetReadModeData=null,this.readArticle=null,this.readArticleCursor=null}},{key:"fullscreen",value:function(){this.pdfViewer.viewerUI.rootComponent.querySelector("float-bar").controller.fullScreen()}},{key:"disableDragToScroll",value:function(){this.viewerRender.disableDragToScroll()}},{key:"enableDragToScroll",value:function(){this.viewerRender.enableDragToScroll()}},{key:"hideMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.hideMarkupFlag=e;var n=this.pagesRender;n.viewMode.getVisibleIndexes();n.pageRenders.forEach((function(n){var i,r=n.annotsRender;r&&(t?(i=r).render.apply(i,(0,I._)(r.renderParams)):e?(r.backAnnots=r.showAnnots,r.showAnnots=new Set,r.annotFiltered=1):(Array.from(r.showAnnots).map((function(e){return r.backAnnots.add(e)})),r.showAnnots=r.backAnnots,r.backAnnots=new Set))}))}}]),n}(te);function Va(e){return"state-"+e}const Ba=Na;var ja=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this)).viewerRender=e,i}return(0,A._)(n,[{key:"getScrollHost",value:function(){return window}},{key:"scrollBy",value:function(e,t){this.getScrollHost().scrollBy(e,t)}},{key:"scrollTo",value:function(e,t){this.getScrollHost().scrollTo(e,t)}},{key:"getScrollOffsetTop",value:function(){return this.viewerRender.$ui[0].offsetTop}},{key:"getScrollOffsetLeft",value:function(){return this.viewerRender.$ui[0].offsetLeft}},{key:"getScrollY",value:function(){return this.getScrollTop()}},{key:"getScrollX",value:function(){return this.getScrollLeft()}},{key:"getWidth",value:function(){var e=this.getScrollHost();return Ua(e)?document.documentElement.clientWidth:e.clientWidth}},{key:"getHeight",value:function(){var e=this.getScrollHost();return Ua(e)?document.documentElement.clientHeight:e.clientHeight}},{key:"getScrollTop",value:function(){var e=this.getScrollHost();return Ua(e)?document.scrollingElement?document.scrollingElement.scrollTop:e.scrollY||e.pageYOffset||0:e.scrollTop}},{key:"getScrollLeft",value:function(){var e=this.getScrollHost();return Ua(e)?document.scrollingElement?document.scrollingElement.scrollLeft:window.scrollX||window.pageXOffset||0:e.scrollLeft}},{key:"disable",value:function(e){if(this.disabled=e,e){var t=this.getScrollHost();t===document.body&&(t=document),this.scrollPosition={top:t.scrollTop,left:t.scrollLeft}}else this.scrollPosition=null}},{key:"addScrollEventListener",value:function(e){var t=this,n=this.getScrollHost();n===document.body&&(n=document);var i=function(i){var r,o;t.disabled?n.scrollTo(null===(r=t.scrollPosition)||void 0===r?void 0:r.left,null===(o=t.scrollPosition)||void 0===o?void 0:o.top):e(i,n)};n.addEventListener("scroll",i);var r=qi,o=function(){n.removeEventListener("scroll",i),r()};return r=this.addDestroyHook(o),o}},{key:"getOffsetOfPageElement",value:function(e){var t=this.viewerRender.$ui[0].getBoundingClientRect(),n=e.getBoundingClientRect();return{left:n.left-t.left,top:n.top-t.top}}}]),n}(j.Disposable);function Ua(e){return(0,D._)(e,Window)||(0,D._)(e,Document)}const Ha=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t}return(0,A._)(e,[{key:"docHandler",value:function(e){if(this.pdfViewer){var t=this.pdfViewer.getPDFViewerRender();t&&t.disableDragToScroll()}}},{key:"destroyDocHandler",value:function(){}},{key:"pageHandler",value:function(e){}},{key:"destroyPageHandler",value:function(){}},{key:"out",value:function(){this.pdfViewer.keyboard.activeDefaultBinde&&this.pdfViewer.keyboard.activeDefaultBinder()}}],[{key:"getStateName",value:function(){(0,j.notImplemented)()}},{key:"getKeyboardBinderName",value:function(){return null}},{key:"setParams",value:function(e,t){}}]),e}();function Wa(e,t,n){var i=e.getBoundingClientRect();return[t-i.left,n-i.top]}function Ya(e,t,n){var i,r=e[0],o=e[1],a=r+t,s=o+n;return a<r&&(i=r,r=a,a=i),s<o&&(i=o,o=s,s=i),{left:r,right:a,top:o,bottom:s}}var qa="fv__mark-selection-blank",Ka="."+qa;function $a(e){e.find(Ka).remove()}function za(e){var t,n,i=e[e.length-1],r={};switch(i.rotation){case 0:n=2*(t=i.top-i.bottom)/5,r.left=i.right-n,r.right=i.right+n,r.top=(i.top+i.bottom)/2,r.bottom=r.top-t;break;case 3:t=4*(n=i.right-i.left)/5,r.left=(i.right+i.left)/2,r.right=r.left+n,r.top=i.top+t/2,r.bottom=r.top-t;break;case 2:n=2*(t=i.top-i.bottom)/5,r.left=i.left-n,r.right=i.left+n,r.bottom=(i.top+i.bottom)/2,r.top=r.bottom+t;break;case 1:t=4*(n=i.right-i.left)/5,r.right=(i.right+i.left)/2,r.left=r.right-n,r.top=i.bottom+t/2,r.bottom=r.top-t}return{rect:r,rotate:i.rotation*Math.PI/2}}function Ga(e,t){(t||e.$handler).find(".fv__mark-text-selection-range").remove()}function Ja(e,t,n){var i=e.$handler;i.find(".fv__mark-selection-blank.rectangle").remove(),Ga(e,i);var r={top:Math.min(t[1],n[1]),left:Math.min(t[0],n[0]),width:Math.abs(t[0]-n[0]),height:Math.abs(t[1]-n[1])};i.append(O()('<div class="fv__mark-text-selection-range"></div>').css(r))}function Xa(e){if("clientX"in e)return e.clientX;switch(e.type){case"touchstart":case"touchmove":return e.touches[0].clientX;case"touchend":case"touchcancel":return e.changedTouches[0].clientX}}function Za(e){if("clientY"in e)return e.clientY;switch(e.type){case"touchstart":case"touchmove":return e.touches[0].clientY;case"touchend":case"touchcancel":return e.changedTouches[0].clientY}}const Qa=function(e,t){var n=e.getBoundingClientRect(),i=t.srcEvent,r=Xa(i),o=Za(i);return{x:r-n.left-t.deltaX,y:o-n.top-t.deltaY}};var es="update-dbl-click-data",ts=function(){function e(){(0,P._)(this,e),(0,J._)(this,"store",new j.Store)}return(0,A._)(e,[{key:"dispatchDblClickData",value:function(e){var t=this;this.store.dispatch(es,e).finally((function(){t.store.dispatch(es,null)}))}},{key:"takeWhileDblClickDataReturn",value:function(e){var t=this.store.subscribe(es,(function(n){n&&(e(n),t())}))}}]),e}();var ns,is,rs,os,as=(ns=function(e,t){t&&(Object.values(t).forEach((function(e){var t=e.target;"-1"===t.getAttribute("tabindex")&&t.removeAttribute("tabindex")})),function(e){!e.getAttribute("tabindex")&&e.setAttribute("tabindex",-1)}(e))},is=500,rs=!0,function(){var e=this,t=arguments,n=rs&&!os;clearTimeout(os),os=setTimeout((function(){os=null,rs||ns.apply(e,t)}),is),n&&ns.apply(e,t)}),ss=function(){function e(){(0,P._)(this,e),this.eventObject={},this._addKeyEvent()}return(0,A._)(e,[{key:"setDebugger",value:function(e){this.debugger=e}},{key:"_cwarn",value:function(){if(this.debugger)return console.warn.apply(this,arguments)}},{key:"_addTabindexEvent",value:function(e){var t=this;if(!e._hasmousedownevent_){var n=e._mousedown_=function(n){as(e,t.eventObject)};e.addEventListener("mousedown",n),e._hasmousedownevent_=!0}}},{key:"_addEventObject",value:function(e,t,n){if(!t)throw Error("keys arguments is required.");var i,r=e._stctid||(i=(new Date).getTime(),window.performance&&"function"==typeof window.performance.now&&(i+=performance.now()),"xxyy-4xxx-yxxx-xx-sc".replace(/[xy]/g,(function(e){var t=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"==e?t:3&t|8).toString(16)})));t=(t+"").toLocaleLowerCase().replace(/ /g,""),this._addTabindexEvent(e);var o=this.eventObject[r];o||(o={}),o.target=o.target||e,o[t]&&this._cwarn("重复绑定快捷键：",e,t),o[t]=n,e._stctid=r,this.eventObject[r]=o}},{key:"_addKeyEvent",value:function(){var e=this,t=[],n=[],i=function(r,o){var a=o||r.target,s=a._stctid,u=e.eventObject[s];if(o=a.parentNode,s&&u){var c=t.concat([]),l=n.concat([]);do{var d=c.join("+"),h=l.join("+"),f=u[d],g=u[h];if(f||g)return t=c,n=l,void(f||g)(r);c.shift(),l.shift()}while(c.length+l.length)}o&&"HTML"!==o.nodeName&&i(r,o)};document.addEventListener("keydown",(function(r){var o=r.key,a=r.keyCode;if(o){o="Control"===o?"ctrl":"Escape"===o?"esc":o.toLocaleLowerCase();var s=t.indexOf(o),u=n.indexOf(a);s>-1&&t.splice(s,1),u>-1&&n.splice(u,1),t.push(o),n.push(a);var c=function(){var t=document.activeElement;if(["INPUT","TEXTAREA"].includes(t.nodeName)||t.hasAttribute("contenteditable")||t.hasAttribute("tabindex"))return t;var n=Object.values(e.eventObject).find((function(e){return e.target.hasAttribute("tabindex")}));return n&&n.target}();i(r,c)}})),document.addEventListener("keyup",(function(e){var i=e.keyCode,r=e.altKey,o=e.ctrlKey,a=e.metaKey,s=e.shiftKey;if(r||o||a||s){var u=n.indexOf(i);u>-1&&(t.splice(u,1),n.splice(u,1))}else t=[],n=[]}))}},{key:"register",value:function(e,t,n){var i=this;if(e||(e=document),!(0,D._)(e,Node))throw Error("first arguments is not a node.");return(0,D._)(t,Array)?t.forEach((function(t){i._addEventObject(e,t,n)})):this._addEventObject(e,t,n),this}},{key:"unregister",value:function(e,t){var n=this,i=e._stctid;t?((0,D._)(t,Array)?t:[t]).forEach((function(e){delete n.eventObject[i][e]})):(e.removeEventListener("mousedown",e._mousedown_),delete this.eventObject[i],delete e._stctid,delete e._hasmousedownevent_,delete e._mousedown_)}}],[{key:"getInstance",value:function(){return window.Shortcut?window.Shortcut:window.Shortcut=new e}}]),e}();const us=ss.getInstance();var cs="rectangle",ls=function(e,t,n){var i=e.$handler;i.find(".fv__mark-selection-blank:not(.rectangle)").remove();for(var r=O()(document.createDocumentFragment()),o=i.get(0).getBoundingClientRect(),a=0,s=t.length;a<s;a++){var u=t[a],c={top:u.top/o.height*100+"%",left:u.left/o.width*100+"%",width:(u.right-u.left)/o.width*100+"%",height:(u.bottom-u.top)/o.height*100+"%"};r.append(O()('<mark class="fv__mark-selection-blank" type="'+n+'"></mark>').css(c))}i.append(r)},ds=function(e,t,n,i){var r=Ya(t,n,i);return e.getTextRectsAtRect(r).then((function(t){return Promise.all([e.getPDFPage(),t]).then((function(t){var n=(0,E._)(t,2),i=n[0],r=n[1],o=e.transformRectArray(i,r);return ls(e,o,Mt.Text),{page:i,rectArray:r,rectArrayInPixel:o}}))}))},hs=function(e,t,n){var i=e.$handler;i.find(".fv__mark-selection-blank.rectangle").remove();var r=i.get(0).getBoundingClientRect(),o={top:Math.min(t[1],n[1])/r.height*100+"%",left:Math.min(t[0],n[0])/r.width*100+"%",width:Math.abs(t[0]-n[0])/r.width*100+"%",height:Math.abs(t[1]-n[1])/r.height*100+"%"};i.append(O()('<mark class="fv__mark-selection-blank rectangle" type="rectangle"></mark>').css(o))},fs=function(e,t,n,i){var r=e.point,o=e.rectArray,a=e.isReadSelectText,s=void 0===a||a,u=e.characterIndexStart,c=void 0===u?-1:u,l=e.characterIndexEnd,d=void 0===l?-1:l,h=e.panStartEvent,f=e.panMoveArr,g=e.overrideText,v=n.pdfViewer,p=n.doc;return(o||[])[0]?Promise.all([n.getPDFPage(),o]).then((function(e){var o=(0,E._)(e,2),a=o[0],u=o[1];Ya(r,t.deltaX,t.deltaY);return Promise.all(u.map((function(e){return a.getTextContinuousCharsAtRect(e,!0)}))).then((function(e){return e.join("\n")})).then((function(e){p.addTextSelectedInfo(n,c,d,u,e,t,h,f),v.getStore().dispatch(xe.SELECTION_INFO,{page:a,text:g||e,rectArray:u,isReadSelectText:s,e:t,panStartEvent:h,panMoveArr:f}),v.eventEmitter.emit(de.selectText,{page:a,text:g||e,rectArray:u,e:t,panStartEvent:h,panMoveArr:f});var r=n.transformRectArray(a,u);ls(n,r,Mt.Text);var o=r[0];return!!o&&(i&&i.showAt((o.left+o.right)/2,o.top,e,r),!0)}))})):Promise.resolve(!1)},gs=function(e){e.currentPDFDoc&&e.currentPDFDoc.setSelectedInfo(null),e.getStore().dispatch(xe.SELECTION_INFO,null),e.getPDFDocRender().pagesRender.pageRenders.forEach((function(e){e.$handler.find(".fv__mark-selection-blank").remove()}))},vs=function(){function e(t,n,i,r){var o=this;if((0,P._)(this,e),[mn,Jn].includes(r)){var a,s,u=-1,c=-1,l="unknown",d=n.$handler.addClass("fv__select-text-image-state-handler"),h=d[0],f=n.pdfViewer,g=(f.viewerUI,f.eventEmitter),v=null,p=null,m=[],y=n.doc;this.pdfDoc=y,this.pdfViewer=f,this.pageRender=n,this.tooltip=i,this.stateName=r,this.altEnter=!1,this.altSwitch=!1,this.disposor=new j.Disposable,this.isEnable=!0,this.addAltEvent(d);var k,b,w,A,S=y.isDynamicXFA();0;var x,C=!1,D=!1;if(j.isTouchDevice){var I,R,T=null,M=this;t.on("press",(x=(0,_._)((function(e){var t;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return S?[2]:[4,n.annotsRender.findAnnot(e.srcEvent)];case 1:return r.sent()||(gs(f),i&&i.hide(),t=Qa(h,e),n.getTextContinueRectAtDevicePoints([t.x,t.y],[t.x+5,t.y+5],-1,-1).then((function(e){T=e,n.getPDFPage().then((function(t){var i=n.transformRectArray(t,e);ls(n,i,Mt.Text)})),(e||[])[0]&&(C=!0,M.setEnable(!0),M.pdfViewer.eventEmitter.emit(de.togglePageContextMenu,!1))}))),[2]}}))})),I=function(e){return x.apply(this,arguments)})),t.on("hammer.input",R=function(e){if("pointerup"===e.srcEvent.type){if(D)return T=null,void(C=!1);if(C&&T){var t=Qa(h,e);fs({point:[t.x,t.y],rectArray:T,characterIndexStart:u,characterIndexEnd:c,panStartEvent:p,panMoveArr:m},e,n,i)}else gs(f),i&&i.hide();T=null,C=!1,o.pdfViewer.eventEmitter.emit(de.togglePageContextMenu,!0)}else"pointerdown"===e.srcEvent.type&&(D=!1)}),this.disposor.addDestroyHook((function(){t.off("press",I),t.off("hammer.input",R)}))}t.on("doubletap",k=function(e){S||o.isEnable&&(gs(f),i&&i.hide(),o.isTextSelectionToolEnabledInHandState()&&function(e,t,n,i){var r=Qa(t,e),o=[r.x,r.y];n.getDoubleClickTextRectAtPoint(o).then((function(t){var r=n.pdfViewer.getIoC().getInstanceByClass(ts);fs({point:o,rectArray:t,isReadSelectText:!1},e,n,i).then((function(e){r.dispatchDblClickData({isTextSelected:e})}))}))}(e,h,n,i))}),t.on("panstart",b=function(e){if(o.isEnable&&(r!==mn||!j.isTouchDevice||C)){D=!0;var t=Qa(h,e);n.getTextContinueRectAtDevicePoints([t.x,t.y],[t.x+5,t.y+5],-1,-1).then((function(n){var d=(n||[])[0];if(l=!d,r===mn){if(l)return;var h=f.customs.isCollaborationMod&&f.customs.isCollaborationMode(),v=f.customs.getCommentPermission&&f.customs.getCommentPermission();if(h&&!v)return;g.emit("can-scroll",!1)}o.pdfDoc.textSelecting=!0,p=e,m=[],u=d&&"string"==typeof d.text?d.start:-1,c=-1,void 0,a=[t.x,t.y],s=new fe,y.clearSelectedInfo(f),i&&i.hide(),f.killFocus(),o.altSwitch=o.altEnter}))}}),t.on("panmove",w=function(e){if(o.isEnable){if(r===mn){if(j.isTouchDevice&&!C)return;if("unknown"===l||!o.pdfDoc.textSelecting)return}else if("unknown"===l)return;var t=Qa(h,e);s||(s=new fe),s.push((function(){var i=o;m.push(e);var s=[a[0]+e.deltaX,t.y+e.deltaY];if(r===mn){if(o.altSwitch)return Ja(n,a,s),ds(n,a,e.deltaX,e.deltaY);if(l)return v={type:cs,pageRender:n},y.setSelectedInfo(v),hs(n,a,s),Promise.resolve()}var d=function(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Promise.all([t.getPDFPage(),n?Promise.resolve(r):t.reverseDevicePoint(r)]).then((function(n){var r=(0,E._)(n,2),a=r[0],s=r[1];return a.getTextIndexAtPoint(s).then((function(n){if(-1==n)return Promise.resolve();var r=o?n:0,s=o?-1:n;return a.getTextRectsByIndexes(r,s).then((function(n){var o=t.transformRectArray(a,n);ls(t,o,Mt.Text),i.pdfDoc.addTextSelectedInfo(t,r,s,n,"",e,p,m)}))}))}))};return f.convertClientCoordToPDFCoord({clientX:e.srcEvent.clientX,clientY:e.srcEvent.clientY}).then((function(t){var i=t.index;return i!=n.index?d(n,!1,a,i>n.index).then((function(){c=i>n.index?-1:0;var e=f.getPDFPageRender(i),r=[t.left,t.top];return d(e,!0,r,i<n.index)})):n.getTextContinueRectAtDevicePoints(a,s,u,c).then((function(t){var i=(t||[])[0];if(i&&("string"==typeof i.text&&(u=i.start,c=i.end),-1!==u))return Promise.all([n.getPDFPage(),t]).then((function(t){var i=(0,E._)(t,2),r=i[0],a=i[1],s=n.transformRectArray(r,a);ls(n,s,Mt.Text),o.pdfDoc.addTextSelectedInfo(n,u,c,a,"",e,p,m)}))}))}))}))}}),t.on("panend",A=function(e){if(o.isEnable&&!f.asyncRender){if(r===mn){if(!o.pdfDoc.textSelecting||"unknown"===l)return;o.pdfDoc.textSelecting=!1,o.pdfViewer.eventEmitter.emit("can-scroll",!0)}else if(o.pdfDoc.textSelecting=!1,"unknown"===l)return;s&&(s.end(),s=null);var t=Qa(h,e),u=[a[0]+e.deltaX,t.y+e.deltaY];if(o.altSwitch&&r===mn)return o.altSwitch=!1,Ga(n),ds(n,a,e.deltaX,e.deltaY).then((function(t){var r=t.page,o=t.rectArray,a=t.rectArrayInPixel,s=o[0].texts||"";y.addTextSelectedInfo(n,0,0,o,s,e,p,m),f.getStore().dispatch(xe.SELECTION_INFO,{page:r,text:s,rectArray:o,e,panStartEvent:p,panMoveArr:m}),g.emit(de.selectText,{page:r,text:s,rectArray:o,e,panStartEvent:p,panMoveArr:m});var u=a[0];u&&i&&i.showAt((u.left+u.right)/2,u.top,v.getText(),a)}));if(!l||r!==mn)return o.pdfDoc.updateTextSelectInfo().then((function(){o.pdfDoc.selectedInfo&&function(e,t){var n=e.selectedPages;if(n.length){var i=e.e,r=e.panStartEvent,o=e.panMoveArr,a=n[0].pageRender,s=a.pdfViewer,u=(a.doc,n[0].rectArray),c=e.getText(),l=c;a.getPDFPage().then((function(n){s.getStore().dispatch(xe.SELECTION_INFO,{selectedInfo:e,page:n,text:l||c,rectArray:u,isReadSelectText:!1,e:i,panStartEvent:r,panMoveArr:o}),s.eventEmitter.emit(de.selectText,{selectedInfo:e,page:n,text:l||c,rectArray:u,e:i,panStartEvent:r,panMoveArr:o});var d=a.transformRectArray(n,u),h=d[0];return!!h&&(t&&t.showAt((h.left+h.right)/2,h.top,c,d),!0)}))}}(o.pdfDoc.selectedInfo,i)}));v={type:cs,pageRender:n,e,panStartEvent:p,panMoveArr:m},y.setSelectedInfo(v),hs(n,a,u),l="unknown"}});var O=function(){i&&i.hide()};g.on(de.activeElementChanged,O),g.on(de.switchStateHandler,O),this.disposor.addDestroyHook((function(){i&&i.destroy(),g.off(de.activeElementChanged,O),g.off(de.switchStateHandler,O),t.off("doubletap",k),t.off("panstart",b),t.off("panmove",w),t.off("panend",A)}))}}return(0,A._)(e,[{key:"destroy",value:function(){us.unregister(this.pageRender.$element.get(0)),this.pdfViewer.viewerUI.loadContextPromise=null,this.disposor.destroy(),this.removeAltEvent()}},{key:"doTextCopy",value:function(e){var t=this,n=e.getText();void 0!==n&&(0,j.copyText)(n).then((function(e){t.pdfViewer.eventEmitter.emit(e?de.copyTextSuccess:de.copyTextFailed,n)}))}},{key:"doExportSelectionText",value:function(e){var t=this.pdfViewer.viewerUI.rootComponent.pdfUI;if(!(t.customs&&t.customs.isAccountExpired&&t.customs.isAccountExpired(!0,{btnName:"fv--contextmenu-item-exportSelectionAs",tabName:"convert_tab"}))){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e.selectedPages[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value,c=u.rectArray.map((function(e){return{left:e.left,right:e.right,top:e.top,bottom:e.bottom}}));n.push({pageIndex:u.pageRender.index,rectArray:c})}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}t.customs&&t.customs.showSaveAsDialog&&t.customs.showSaveAsDialog("convert-pdf-to-word",JSON.stringify(n))}}},{key:"createTextMarkupAnnot",value:function(e,t){var n=this,i=t.selectedPages,r=function(t,i){return t.getPDFPage().then((function(t){if("replace"===e){var r=za(i),o=r.rect,a=r.rotate;return t.addAnnotGroup([{flags:4,type:"strikeout",rect:{left:0,right:0,top:0,bottom:0},coords:i,noPopup:!0,typeAlias:"Replace",intent:"StrikeOutTextEdit",subject:n.pdfViewer.i18n.t("viewer_:annotSubjects.Replace")},{type:"caret",flags:4,rect:o,typeAlias:"Replace",intent:"Replace",rotation:a,subject:n.pdfViewer.i18n.t("viewer_:annotSubjects.Replace")}],1)}return t.addAnnot({type:e,rect:{left:0,right:0,top:0,bottom:0},flags:4,coords:i,subject:n.pdfViewer.i18n.t("viewer_:annotSubjects."+e[0].toUpperCase()+e.substr(1))})})).then((function(e){var i=e[0];n.pdfViewer.eventEmitter.emit(de.addAnnotSuccess,i),t.annotsRender.activeAnnot(i.getId())}))},o=[],a=!0,s=!1,u=void 0;try{for(var c,l=i[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var d=c.value;o.push(r(d.pageRender,d.rectArray))}}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}Promise.all(o).then((function(){gs(n.pdfViewer),n.tooltip&&n.tooltip.hide()}))}},{key:"doTextSelectAll",value:function(e,t){var n=this,i=this.pdfViewer;gs(i),this.tooltip&&this.tooltip.hide();var r=[];if(t){var o=!0,a=!1,s=void 0;try{for(var u,c=t.selectedPages[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r.push(l.pageRender)}}catch(e){a=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}}else e&&r.push(e);var d=!0,h=!1,f=void 0;try{for(var g,v=function(){var e=g.value;Promise.all([e.getAllTextRect(),e.getAllTextChar(),e.getPDFPage()]).then((function(t){var r=(0,E._)(t,3),o=r[0],a=r[1],s=r[2];i.getStore().dispatch(xe.SELECTION_INFO,{page:s,text:a,rectArray:o}),i.eventEmitter.emit(de.selectText,{page:s,text:a,rectArray:o});var u=e.transformRectArray(s,o);ls(e,u,Mt.Text);var c=n.pdfViewer.currentPDFDoc;e.getAllTextChar().then((function(t){c.addTextSelectedInfo(e,0,-1,o,t)}))}))},p=r[Symbol.iterator]();!(d=(g=p.next()).done);d=!0)v()}catch(e){h=!0,f=e}finally{try{d||null==p.return||p.return()}finally{if(h)throw f}}}},{key:"createBookmark",value:function(e,t){var n=this;if(!e){var i=!0,r=!1,o=void 0;try{for(var a,s=t.selectedPages[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){e=a.value.pageRender;break}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}}var u=this.pdfViewer.viewerUI.rootComponent;if(u.getComponentByName("sidebar-bookmark").active(),t){var c,l,d=t.type,h=t.graphicsObject;d==Mt.Text&&(c=t.getText(),l=t.selectedPages[0].rectArray),e.getPDFPage().then((function(e){var t=d===Mt.Text?l[0]:h.getRect(),i=t.left,r=t.top,o=d===Mt.Text?c:n.pdfViewer.i18n.t("sidebar.bookmark.untitled"),a=e.getIndex(),s=u.getComponentByName("fv-bookmark-sidebar-panel");n.pdfViewer.eventEmitter.emit("bookmark-create-current-view",{bookmarkId:s.currentBookmarkId,left:i,top:r,title:o,relationship:3,pageIndex:a})}))}else this.pdfViewer.eventEmitter.emit("bookmark-create-current-view")}},{key:"doEditText",value:function(e){}},{key:"createLink",value:function(e){var t,n=this,i=!0,r=!1,o=void 0;try{for(var a,s=e.selectedPages[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;t=u.pageRender;break}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}if(t){var c=t.doc;t.getPDFPage().then((function(e){var i=0;if(c.selectedInfo){var r=c.selectedInfo.selectedPages[0].rectArray,o=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=-Number.MAX_VALUE,u=Number.MAX_VALUE;r.forEach((function(e){o=Math.min(o,e.left),a=Math.max(a,e.right),s=Math.max(s,e.top),u=Math.min(u,e.bottom)})),i&&(c.selectedInfo=null),e.addAnnot({type:"link",rect:{left:o,right:a,top:s,bottom:u},color:"0000FF"}).then((function(e){var i=t.getAnnotRender(e[0].getId()).component;i.showCreateDialog(),j.isMobile&&n.pdfViewer.getStateHandlerManager().switchTo(mn),t.pdfViewer.eventEmitter.emit(de.addAnnotSuccess,i.annot),gs(n.pdfViewer),n.tooltip&&n.tooltip.hide()}))}else i=1}))}}},{key:"doWordCount",value:function(e){}},{key:"getLoopUpText",value:function(){var e=!1,t=this.pageRender.doc;if(t.selectedInfo){var n=t.selectedInfo.getText();return n=n.trim(),j.isWindows&&(n=n.substr(n.lastIndexOf(" ")+1)),t.selectedInfo.lookUpText=n,e&&(t.selectedInfo=null),n}e=!0}},{key:"doLookUp",value:function(e){var t=e.lookUpText;this.dictionaryWindow&&this.dictionaryWindow.close(),this.dictionaryWindow=window.open("https://www.dictionary.com/browse/".concat(t,"?utm_source=foxit&utm_medium=referral&utm_campaign=foxit"))}},{key:"isTextSelectionToolEnabledInHandState",value:function(){if(this.stateName===mn){var e=this.pdfViewer.getStateHandlerManager().getStateHandlerConfig(mn);if(e&&!e.enableTextSelectionTool)return!1}return!0}},{key:"hasModifyPermissions",value:function(e){var t=e.doc.getPermissions();return 8&t&&32&t}},{key:"checkPerm",value:function(e){return this.pageRender.docRender.getUserPermission()[e]()}},{key:"addAltEvent",value:function(e){var t=this;this.keydownUpEvent=function(e){"keyup"===e.type&&t.altEnter?(e.stopPropagation(),e.preventDefault(),t.altEnter=!1):e.altKey&&(e.stopPropagation(),e.preventDefault(),t.altEnter=!0)},O()(window).on("keydown keyup",this.keydownUpEvent)}},{key:"removeAltEvent",value:function(){O()(window).off("keydown keyup",this.keydownUpEvent)}},{key:"isTextSelecting",value:function(){return!!this.pdfDoc.textSelecting}},{key:"setEnable",value:function(e){this.isEnable=e}}]),e}(),ps=function e(){(0,P._)(this,e),this.scrollValid=!0},ms=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).isDestroyed=!1,i.cursorStyle="fv__cursor-grab",i.isOnText=!1,i.timeStamp=0,i.pdfViewer=e,i.service=e.getIoC().getInstanceByClass(ps),i.throttleTaskExecutor=new j.ThrottleAsyncTaskExecutor(100,!0),i}return(0,A._)(n,[{key:"docHandler",value:function(e){e.viewerRender.enableDragToScroll()}},{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e;e.$ui.addClass("fv__annot-container-zindex-up fv__allow-modify-form-control");var i=n.$handler;i.addClass("fv__hand-state-handler"),i.addClass(this.cursorStyle);var r=i[0],o=e.pdfViewer,a=o.getCurrentPDFDoc();a||(a=e.docRender.doc);var s=a.isDynamicXFA(),u=this.eventEmitter=o.eventEmitter;u.emit("can-scroll",!0);var c=this.hammer=new(vr().Manager)(r,{recognizers:[[vr().Pan,{direction:vr().DIRECTION_ALL}]]});c.add(new(vr().Tap)({event:"doubletap",taps:2})),c.add(new(vr().Tap)({event:"singletap"})),c.add(new(vr().Press)),c.get("doubletap").recognizeWith("singletap"),c.get("singletap").requireFailure("doubletap"),c.on("panstart",(function(t){if(!s){var n=e.annotsRender;n&&n.panStart(t.srcEvent)}}));var l,d=this,h=(l=(0,_._)((function(t){var n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return gs(d.pdfViewer),s?(u.emit(de.tapPage,t),[2]):(n=e.annotsRender)?[4,n.tapPage(t.srcEvent)]:(u.emit(de.tapPage,t),[2]);case 1:return i.sent()||(t.srcEvent.ctrlKey||n.unActiveAnnot(),u.emit(de.tapPage,t)),[2]}}))})),function(e){return l.apply(this,arguments)}),f=this,g=function(){var t=(0,_._)((function(t){var n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return s?(u.emit(de.doubleTapPage,t,e),[2]):(n=e.annotsRender)?[4,n.doubleTapPage(t.srcEvent)]:(u.emit(de.doubleTapPage,t,e),[2]);case 1:return i.sent()||(n.unActiveAnnot(),j.isTouchDevice&&e.pdfViewer.getIoC().getInstanceByClass(ts).dispatchDblClickData({isTextSelected:f.isOnText}),u.emit(de.doubleTapPage,t,e)),[2]}}))}));return function(e){return t.apply(this,arguments)}}();j.isTouchDevice&&(j.isSafari||j.isChrome||j.isHuaweiBrowser)?this.offDoubleTapEvent=(0,j.onTap)({target:r,onDoubleTap:g,onSingleTap:h}):(c.on("singletap",h),c.on("doubletap",g));var v=this;if(c.on("press",function(){var t=(0,_._)((function(t){var n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return s?(u.emit(de.pressPage,t),[2]):(n=e.annotsRender,v.eventEmitter.emit("can-scroll",!0),n?(n.unActiveAnnot(),[4,n.pressPage(t.srcEvent)]):(u.emit(de.pressPage,t),[2]));case 1:return i.sent()?(t.srcEvent.preventDefault(),t.srcEvent.stopPropagation(),[2]):(u.emit(de.pressPage,t),[2])}}))}));return function(e){return t.apply(this,arguments)}}()),j.isTouchDevice){var p=e.docRender;c.on("press",(function(t){var n=Qa(r,t);e.getTextContinueRectAtDevicePoints([n.x,n.y],[n.x+5,n.y+5],-1,-1).then((function(e){!!(e||[])[0]&&p.viewerRender.disableDragToScroll()}))})),c.on("hammer.input",(function(e){"pointerup"===e.srcEvent.type&&p.viewerRender.enableDragToScroll()}))}i.on("mousedown",this.mousedown=function(e){j.isTouchDevice||(t.isOnText?gs(t.pdfViewer):(t.textSelectionHandler&&t.textSelectionHandler.setEnable(!1),i.removeClass(t.cursorStyle),t.cursorStyle="fv__cursor-grabbing",i.addClass(t.cursorStyle),t.textSelectionHandler&&t.textSelectionHandler.isTextSelecting()&&t.eventEmitter.emit("can-scroll",!1)))}),j.isTouchDevice&&j.isIOS&&j.isChrome||i.on("mousemove",this.mousemove.bind(this)),i.on("mouseup",this.mouseup=function(n){if(!t.isOnText&&(i.removeClass(t.cursorStyle),t.textSelectionHandler&&!t.textSelectionHandler.isTextSelecting()&&t.emitCanScroll(),t.cursorStyle="fv__cursor-grab",i.addClass(t.cursorStyle),3===n.which))if(s)u.emit(de.rightClickPage,n);else{var r=e.annotsRender;r?(r.unActiveAnnot(),u.emit(de.rightClickPage,n)):u.emit(de.rightClickPage,n)}});var m=O()('<div class="fv__hand-state-contextmenu-container fv__contextmenu-container"></div>'),y=i.find(".fv__mark-selection-blank");y&&y.length>0?m.insertBefore(y[0]):i.append(m),m.data("hand-state",this),setTimeout((function(){if(t.textSelectionToolEnabled()&&!t.isDestroyed&&!e.isDestroyed){var n=t.tooltip=o.viewerUI&&o.viewerUI.createTextSelectionTooltip(e);t.textSelectionHandler=new vs(t.hammer,e,n,mn),n&&n.on("blur",(function(e){!e&&gs(t.pdfViewer),n.hide()}))}}),200)}},{key:"mousemove",value:function(e){var t=this;if(this.textSelectionHandler&&this.textSelectionHandler.isTextSelecting())return this.cursorStyle="fv__cursor-text",void this.pageRender.$handler.removeClass("fv__cursor-grab").addClass(this.cursorStyle);clearTimeout(this.timer),this.throttleTaskExecutor.exec((function(){if(t.pageRender&&t.textSelectionToolEnabled())return t.mousemoveHandler(e)}))}},{key:"textSelectionToolEnabled",value:function(){if(!this.pdfViewer)return!1;var e=this.pdfViewer.getStateHandlerManager().getStateHandlerConfig(mn);return!e||!!e.enableTextSelectionTool}},{key:"mousemoveHandler",value:function(e){var t=this,n=this.pageRender,i={x:e.originalEvent.layerX,y:e.originalEvent.layerY};return n.getTextContinueRectAtDevicePoints([i.x,i.y],[i.x+5,i.y+5],-1,-1).then((function(e){e[0]?(t.cursorStyle="fv__cursor-text",t.eventEmitter.emit("can-scroll",!1),t.isOnText=!0,t.textSelectionHandler&&t.textSelectionHandler.setEnable(!0),n.$handler.removeClass("fv__cursor-grab").addClass(t.cursorStyle)):(n.$handler.removeClass("fv__cursor-text").addClass("fv__cursor-grab"),t.isOnText=!1)}))}},{key:"emitCanScroll",value:function(){var e=this;this.service.scrollValid&&(this.service.scrollValid=!1,this.scrollTimer=setTimeout((function(){e.eventEmitter.emit("can-scroll",!0),e.service.scrollValid=!0}),30))}},{key:"destroyPageHandler",value:function(){this.isDestroyed=!0,this.offDoubleTapEvent&&this.offDoubleTapEvent(),this.hammer&&this.hammer.destroy(),this.pageRender.$ui.removeClass("fv__annot-container-zindex-up fv__allow-modify-form-control"),this.pageRender.$handler.off("mousedown",this.mousedown).off("mouseup",this.mouseup).off("mousemove").removeClass("fv__hand-state-handler").removeClass(this.cursorStyle).find(".fv__hand-state-contextmenu-container").remove(),this.pageRender.annotsRender&&this.pageRender.annotsRender.unActiveAnnot(),this.pageRender.$handler.removeClass("fv__cursor-grab").removeClass("fv__cursor-grabbing"),this._destroyTouchScrollEvent&&this._destroyTouchScrollEvent(),this.textSelectionHandler&&this.textSelectionHandler.destroy()}},{key:"out",value:function(){this.destroyPageHandler(),this.destroyDocHandler(),this.pageRender=null}},{key:"allowZoomIn",value:function(){var e=this.pageRender,t=e.pdfViewer,n=e.getScale();return(n=Math.ceil(4*n+1)/4)<t.config.maxScale}},{key:"zoomIn",value:function(){var e=this.pageRender,t=e.getScale();t=Math.ceil(4*t+1)/4,e.pdfViewer.zoomTo(t).catch((function(){}))}},{key:"allowZoomOut",value:function(){var e=this.pageRender,t=e.pdfViewer,n=e.getScale();return(n=Math.floor(4*n-1)/4)>t.config.minScale}},{key:"zoomOut",value:function(){var e=this.pageRender,t=e.getScale();t=Math.floor(4*t-1)/4,e.pdfViewer.zoomTo(t).catch((function(){}))}},{key:"clockwiseRoataion",value:function(){this.pageRender.getPDFPage().then((function(e){var t=(e.getRotation()+1)%4;e.setRotation(t)}))}},{key:"contrarotate",value:function(){this.pageRender.getPDFPage().then((function(e){var t=(e.getRotation()+3)%4;e.setRotation(t)}))}}],[{key:"getStateName",value:function(){return mn}},{key:"getDefaultContextMenuConfig",value:function(){var e="hand-state";return{selector:".fv__hand-state-contextmenu-container",items:{zoomin:{name:"zoomin",nameI18nKey:"viewer_:contextmenu.hand.zoomin",callback:function(t,n,i){this.data(e).zoomIn()},visible:function(){return this.data(e).allowZoomIn()}},zoomout:{name:"zoomout",nameI18nKey:"viewer_:contextmenu.hand.zoomout",callback:function(t,n,i){this.data(e).zoomOut()},visible:function(){return this.data(e).allowZoomOut()}}}}}}]),n}(Ha);const ys=ms;var ks=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).pdfViewer=e,r.scrollHost=i,r.prepare(),r.canScroll=!0,r.scrollable=!0,r}return(0,A._)(n,[{key:"disable",value:function(){this.scrollable=!1}},{key:"enable",value:function(){this.scrollable=!0}},{key:"addViewerEventListener",value:function(e,t){var n=this;this.pdfViewer.eventEmitter.on(e,t),this.addDestroyHook((function(){n.pdfViewer.eventEmitter.off(e,t)}))}},{key:"prepare",value:function(){var e,t,n=this;this.taskExecutor=new j.DebounceAsyncTaskExecutor(66);var i=!1,r=this.pdfViewer,o=r.getStateHandlerManager();this.addViewerEventListener("can-scroll",(function(e){n.canScroll=e})),this.addViewerEventListener(de.updateScrollableStatus,(function(n){var i=n.disableHorizontal,r=n.disableVertical;e=i,t=r})),this.addViewerEventListener(de.changeViewModeSuccess,(function(n){n!==ua&&(e=!1,t=!1)}));var a=this.scrollHost,s=function(e,t){a.scrollBy?a.scrollBy(e,t):(a.scrollLeft=a.scrollLeft+e,a.scrollTop=a.scrollTop+t)},u=new Hammer.Manager(a,{inputClass:j.TrustedPointerEventInput});u.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL}));var c,l=0,d=0,h=0,f=0,g=0,v=function(e){l=0,d=0,g=0},p=function(i,o,a){if(n.scrollable&&"hand"===r.getStateHandlerManager().currentStateHandler.getStateName()){var u=i-l,c=o-d;if(e&&(u=0),t){var v=o-g;if(a===Hammer.DIRECTION_UP||a===Hammer.DIRECTION_DOWN)return n.scrollSinglePage(v),void(g=o);c=0}s(-u,-c),r.eventEmitter.emit(de.scrollingPage,{touched:!0,distanceX:h,distanceY:f}),l=i,d=o,h=i,f=o}},m=!1,y=!0,k=!1,b=function(e){var t,n,i,r=e.clientX;if((0,D._)(a,Window))t=0,n=0,i=0;else{t=a.getBoundingClientRect().left;var o=getComputedStyle(a);n=parseInt(o.borderLeftWidth)||0,i=parseInt(o.borderRightWidth)||0}var s=n+i,u=a.offsetWidth,c=u-a.clientWidth-s;k=r>=u-c+t},w=function(){k=!1};a.addEventListener("mousedown",b),a.addEventListener("touchstart",b),a.addEventListener("mouseup",w),a.addEventListener("touchend",w),a.addEventListener("touchcancel",w);var _=function(e){var t=(0,j.eventPath)(e).some((function(e){return!!e.classList&&e.classList.contains("fv__pdf-page-annots-container")}));i=t};window.addEventListener("mousedown",_,!0),window.addEventListener("touchstart",_,!0);var P=["fv__pdf-page-handler-container","fv__hand-state-contextmenu-container","fv__rendering-container"],A=function(e){var t=e.classList;return o.getCurrentStates()===ys||P.some((function(e){return t.contains(e)}))},S=!1,x=!1;u.on("panstart",(function(e){S=!1,!n.scrollable||i||k||(x?x=!1:(A(e.srcEvent.srcElement)&&(S=!0,r.eventEmitter.emit(de.startScrollingPage,{})),h=0,f=0,m=!1,y=!0,cancelAnimationFrame(c),e.pointers.length>1||n.canScroll&&p(e.deltaX,e.deltaY,e.direction)))})),u.on("panmove",(function(e){S&&A(e.srcEvent.srcElement)?m||!n.scrollable||i||e.pointers.length>1||n.canScroll&&p(e.deltaX,e.deltaY,e.direction):S=!1})),u.on("panend",(function(o){if(S&&A(o.srcEvent.srcElement)){if(!(o.pointers.length>1||!n.scrollable||i)){S=!1;var a=o.velocityX*(1e3/60),u=o.velocityY*(1e3/60);e&&(a=0),t&&(u=0),v();var l=.8,d=a<0?-.8:l,g=u<0?-.8:l;y=!1,c=requestAnimationFrame((function e(){var t=Math.abs(a),n=Math.abs(u);t<l&&n<l||y?r.eventEmitter.emit(de.endScrollingPage,{distanceX:h,distanceY:f}):(c=requestAnimationFrame(e),s(-a,-u),t>=l&&(a-=d),n>=l&&(u-=g),h+=a,f+=u,r.eventEmitter.emit(de.scrollingPage,{touched:!1,distanceX:h,distanceY:f}))}))}}else S=!1})),u.on("pancancel",v);var C=function(){m=!0,v()};window.addEventListener("touchend",C),window.addEventListener("touchcancel",C),window.addEventListener("mouseup",C);var E=function(e){var t=window[e];return window[e]=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=t.apply(window,n);return x=!0,r},function(){window[e]=t}};this.addDestroyHook(E("alert"),E("confirm"),E("prompt")),this.addDestroyHook((function(){u.destroy(),c&&cancelAnimationFrame(c),a.removeEventListener("mousedown",b),a.removeEventListener("touchstart",b),a.removeEventListener("mouseup",w),a.removeEventListener("touchend",w),a.removeEventListener("touchcancel",w),window.removeEventListener("touchend",C),window.removeEventListener("mouseup",C),window.removeEventListener("touchcancel",C),window.removeEventListener("mousedown",_,!0),window.removeEventListener("touchstart",_,!0)}))}},{key:"scrollSinglePage",value:function(e){var t=this;0!==e&&this.taskExecutor.exec((function(){return Promise.resolve().then((function(){var n=t.pdfViewer.getPDFDocRender().getViewMode();if((0,D._)(n,ua))return e>0?n.jumpToPrevPage():n.jumpToNextPage()}))}))}}]),n}(j.Disposable),bs=N()(),ws="scroll",_s=j.LoggerFactory.getLogger("PDFViewerRender"),Ps=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;(0,P._)(this,n),(o=t.call(this)).name=n.getDefaultName(),o.pdfViewer=r,o.ViewMode=i,o.$ui=e;var a=o.scrollWrap=new(o.pdfViewer.customs.ScrollWrap||ja)((0,w._)(o)),s=100;(j.isChromiumEdge||j.isChrome||j.isFirefox||j.isSafari)&&(s=30),o.unBindScrollEvent=a.addScrollEventListener((function(){o.pdfDocRender&&(o.pdfDocRender.isDestroyed||o.pdfDocRender.moveDebounce())}));var u,c="fv__pdf-view-mode-item";e.on(ws,"."+c,o._scrollPageBind=function(e){clearTimeout(u);var t,n=e.currentTarget;try{if(!(t=o.pdfDocRender.pagesRender).length)return}catch(e){return}u=setTimeout((function(){for(var e=n.previousSibling,i=0;e;)e.classList.contains(c)&&i++,e=e.previousSibling;var r=t[i];if(r)try{r.move()}catch(e){}}),s)});o.addDestroyHook((function(){clearTimeout(u)})),e.addClass("fv__pdf-viewer").html(bs),o.$rendering=e.find(".fv__pdf-viewer-rendering"),o.$container=e.find(".fv__pdf-viewer-container"),o.pdfViewerRendering=new(r.customs.PDFViewerRendering||V)(o.$rendering[0],(0,w._)(o)),(o.handler=new(r.customs.PDFViewerHandler||pr)(e.find(".fv__pdf-viewer-handler-container"),(0,w._)(o))).active(),o.oldPdfDocRenders=[],o.touchToScrollViewer=new ks(r,a.getScrollHost());var l,d=r.getKeyboard(),h=function(e){var t=o.pdfDocRender;if(t){var n=t.getViewMode();if(l=n.getShortcutEventHandler())l.onKeyPressed(e)&&e.native.preventDefault()}},f={interceptors:[function(e,t){"input"!=e.native.target.tagName.toLowerCase()&&(0===r.getAllActiveElements().length&&t(e))}]},g=function(e){l&&(l.onKeyReleased(e)&&e.native.preventDefault(),l=void 0)},v=[ko.ARROW_UP,ko.ARROW_DOWN,ko.JUMP_TO_FIRST_PAGE,ko.JUMP_TO_LAST_PAGE,ko.JUMP_TO_NEXT_PAGE,ko.JUMP_TO_PREVIOUS_PAGE,ko.SCROLL_TO_NEXT_VISIBLE_AREA,ko.SCROLL_TO_PREVIOUS_VISIBLE_AREA,ko.SCROLL_VIEWER_SCROLLBAR_LEFT,ko.SCROLL_VIEWER_SCROLLBAR_RIGHT,ko.SCROLL_VIEWER_SCROLLBAR_UP,ko.SCROLL_VIEWER_SCROLLBAR_DOWN];o.addDestroyHook.apply(o,(0,I._)(v.map((function(e){return d.keydown(e,h,f)}))).concat((0,I._)(v.map((function(e){return d.keyup(e,g,f)}))))),o.allowScrollOnMouseWheel=!0;var p=o.scrollWrap.getScrollHost();p.hasAttribute&&!p.hasAttribute("tabIndex")&&p.setAttribute("tabIndex",-1);var m=function(e){o.allowScrollOnMouseWheel||e.preventDefault()};p.addEventListener("wheel",m),o.addDestroyHook((function(){p.removeEventListener("wheel",m)}));var y=p;((0,j.isWindowObject)(y)||(0,j.isDocument)(y)||y===document.body)&&(y=window);var k=(0,j.debounce)((function(){var e=o.pdfViewer,t=o.pdfDocRender;if(t){e.eventEmitter.emit(de.fitWidthResizeViewport);var n=t.getScale();switch(n){case"fitVisible":case"fitWidth":case"fitHeight":return e.zoomTo(n,null,0);default:return e.redraw(!0,!1)}}}),100);return o.addDestroyHook((0,j.observeResize)(y,(function(){var e=o.pdfDocRender;e&&e.isDocRendered&&k()}))),o}return(0,A._)(n,[{key:"setAllowScrollOnMouseWheel",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.allowScrollOnMouseWheel=e}},{key:"setViewMode",value:function(e){var t=this;if(e!==this.ViewMode){var n=this.ViewMode;this.ViewMode=e;var i=this.pdfDocRender;if(i){this.pdfViewer.eventEmitter.emit(de.startChangeViewMode,e,n);var r=i.getViewMode(),o=r?r.getVisibleIndexes():[];return i.setViewMode(e).then((function(){if(!i.isDestroyed){var r=i.getViewMode();t.pdfViewer.eventEmitter.emit(de.changeViewModeSuccess,e,n,r);var a=i.pagesRender;if(a){var s=r&&r.docRender?r.getVisibleIndexes():[];if(!function(e,t){if(e.length!==t.length)return!1;return!e.some((function(e){return-1===t.indexOf(e)}))}(o,s))return a.renderVisiblePages()}}}),(function(r){t.ViewMode=n,t.pdfViewer.eventEmitter.emit(de.changeViewModeFailed,e,n,i.getViewMode(),r),_s.warn("change view mode fail",r)}))}}return Promise.resolve()}},{key:"getViewMode",value:function(){return this.ViewMode}},{key:"rendering",value:function(){this.$ui.addClass("fv__view-rendering"),this.pdfViewerRendering.rendering()}},{key:"rendered",value:function(){this.$ui.removeClass("fv__view-rendering"),this.pdfViewerRendering.rendered()}},{key:"renderDoc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pdfViewer.config.defaultScale,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=new Ba(this.$container,e,this);return this.pdfDocRender=i,this.oldPdfDocRenders.push(i),this.rendered(),i.render(t,n)}},{key:"rotateTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.assertThat)((0,j.isValidRotationAngle)(e),"Incorrect rotation degree: ".concat(e)),this.pdfDocRender?this.pdfDocRender.rotateTo(e,t):Promise.reject(new Error("Cannot perform rotation without document opening!"))}},{key:"getRotation",value:function(){return this.pdfDocRender?this.pdfDocRender.getRotation():0}},{key:"closeOldDocRender",value:function(e){for(var t,n=[],i=this.oldPdfDocRenders,r=i.length;r--;)n[r]=((t=i[r]).hidden(),t.destroy(e)),this.pdfDocRender==i[r]&&(this.pdfDocRender=null),i.splice(r,1);return Promise.all(n)}},{key:"bindEvent",value:function(){}},{key:"zoomTo",value:function(e,t){if(!this.pdfDocRender)return Promise.reject(new Error("doc renderer has not been initialized!"));"number"==typeof e&&(e<this.pdfViewer.config.minScale&&(e=this.pdfViewer.config.minScale),e>this.pdfViewer.config.maxScale&&(e=this.pdfViewer.config.maxScale));try{return this.pdfDocRender.zoomTo(e,t)}catch(e){return Promise.reject(e)}}},{key:"goToPage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this.pdfDocRender.goToPage(e,{x:n,y:t},i)}},{key:"zoomAt",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=this;return(0,_._)((function(){var i,r,o,a,s,u,c,l,d,h,f,g;return(0,F.Jh)(this,(function(v){switch(v.label){case 0:if(!n.pdfDocRender)throw new Error("No PDF files are currently open");if(!t)return[2,n.zoomTo(e)];if(!(0,j.isValidNumber)(t.x))throw new TypeError("fixedPoint.x: ".concat(t.x," is not a valid number"));if(!(0,j.isValidNumber)(t.y))throw new TypeError("fixedPoint.y: ".concat(t.y," is not a valid number"));return-1===(i=n.getPageIndexByClientPosition(t.x,t.y))&&(i=t.pageIndex),r=n.pdfDocRender.doc.getPageCount(),(0,j.isNumberInRange)(i,0,r,!0,!1)?(o=n.pdfDocRender.getPDFPageRender(i),a=o.scale,s=n.getViewBoxRect(),[4,o.transformPoint({point:{x:t.x,y:t.y},srcType:Yo.viewport,destType:Yo.page})]):[2,n.zoomTo(e)];case 1:return u=v.sent(),c=e/a,l=u.x*c,d=u.y*c,h=t.x-s.left,f=t.y-s.top,g={type:"device",x:l-h,y:d-f,pageIndex:i,offsetY:0},[2,n.zoomTo(e,g)]}}))}))()}},{key:"getPageIndexByClientPosition",value:function(e,t){var n=this,i=-1;return this.pdfDocRender?(document.elementsFromPoint(e,t).some((function(e){if(e.classList.contains("fv__pdf-page-layout")){var t=+e.getAttribute("data-index"),r=n.pdfDocRender.getPDFPageRender(t);if(r&&r.$ui[0]===e)return i=t,!0}return!1})),i):i}},{key:"setLayerNodeVisible",value:function(e,t){return this.pdfDocRender?this.pdfDocRender.setLayerNodeVisible(e,t):Promise.reject(new Error("doc renderer has not been initialized!"))}},{key:"getScaleRatio",value:function(){return this.pdfDocRender?this.pdfDocRender.getScaleRatio():Promise.reject(new Error("doc renderer has not been initialized!"))}},{key:"disableDragToScroll",value:function(){this.touchToScrollViewer.disable()}},{key:"enableDragToScroll",value:function(){this.touchToScrollViewer.enable()}},{key:"getViewBoxRect",value:function(){var e=this.scrollWrap.getScrollHost();if(e===window)return{left:0,top:0,right:window.innerWidth,height:window.innerHeight};var t=e.getBoundingClientRect();return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.scrollWrap.destroy(),this.touchToScrollViewer.destroy(),this.pdfDocRender&&this.closeOldDocRender(),this.unBindScrollEvent(),this.$ui.off(ws)}}],[{key:"getDefaultName",value:function(){return"pdfViewerRender"}}]),n}(j.Disposable);const As=Ps;var Ss=g(1543),xs=g.n(Ss),Cs=g(9903),Ds=g.n(Cs),Es=g(1821),Is=g.n(Es),Rs=g(1416),Ts=g.n(Rs);const Fs={hash:.5966844677869312};function Ms(e,t){var n=Os(e);return{loadPath:function(e,i){var r;try{r=n.versions[e.join(" ")][i.join(" ")]||n.versions.defaultVersion}catch(e){r=n.hash||n.version||""}return t+"/{{lng}}/{{ns}}.json?v="+r}}}function Os(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},Fs,e)}const Ls=function(e){var t,n,i=xs().createInstance();return i.use(Ds()).init(Object.assign({},{load:"currentOnly",fallbackLng:"en-US",backend:{backends:[Is(),Ts()],backendOptions:e.backendOptions||[(t=e.version,n=Os(t),{prefix:"foxit_pdf_sdk_for_web_i18next_",expirationTime:6048e6,versions:n.versions||{},defaultVersion:n.hash}),Ms(e.version,e.absolutePath)]}},e.initOption)),i};function Ns(e){return new Promise((function(t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="arraybuffer",i.onreadystatechange=function(){4===i.readyState&&(i.status>=200&&i.status<300||304===i.status?t(i.response):n(new Error("Could not load image!")))},i.onerror=function(){n(new Error("Could not load image!"))},i.send()}))}var Vs=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t}return(0,A._)(e,[{key:"getPassword",value:function(){var e=this,t=(0,j.createDeferred)();return setTimeout((function(){var n=prompt(e.pdfViewer.i18n.t("viewer_:tip.inputPassword"),"");if(null===n)return t.reject(new Error("User has been cancelled the prompt dialog"));t.resolve(n)}),0),t.promise}}]),e}(),Bs=g(8189),js=g.n(Bs);function Us(){if(document.baseURI)return document.baseURI;var e=document.head.querySelector("base");if(!e)return location.href;var t=e.href,n=location.pathname;return t?/^\w+?:\/+/.test(t)?t:location.origin+$s(n,t):location.href}var Hs="/";function Ws(e){if("string"!=typeof e)throw new Error("invalid url type: (".concat(void 0===e?"undefined":(0,R._)(e),")!"));return 0===(e=e.trim()).indexOf("file:")?new qs(e):new Ys(e)}var Ys=function(){function e(t){(0,P._)(this,e);var n=e.REGEX.exec(t);if(!n)throw new Error('Illegal argument: incorrect url: "'.concat(t,'"'));this.protocol=n[1],this.port=parseInt(n[5]),isNaN(this.port)&&(this.port=""),this.pathname=n[6]||"/",this.pathname=this.pathname.replace(/(\/|\\)+/g,Hs);var i=(0,E._)(/(.*[\/\\]+)[^\/\\]+$/.exec(this.pathname)||[this.pathname,this.pathname],2)[1];this.dirname=i,this.hostname=n[3]||"",this.host=this.hostname+(this.port?":"+this.port:""),this.query=n[7]||"",this.hash=n[8]||""}return(0,A._)(e,[{key:"join",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=$s.apply(void 0,[this.dirname].concat((0,I._)(n)));return new e("".concat(this.protocol,"://").concat(this.host).concat(r).concat(this.query).concat(this.hash))}},{key:"absolute",value:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?"".concat(this.protocol,"://").concat(this.host).concat(this.pathname).concat(this.query).concat(this.hash):"".concat(this.protocol,"://").concat(this.host).concat(this.pathname)}},{key:"absoluteDir",value:function(){return"".concat(this.protocol,"://").concat(this.host).concat(this.dirname)}}],[{key:"REGEX",get:function(){return/^([a-z]+):\/\/(([\w\-\.:\[\]]+)(:(\d+))?(\/[^?#]*)?(\?[^#]*)?(#.*)?)$/}},{key:"isValid",value:function(t){return e.REGEX.test(t)}}]),e}(),qs=function(){function e(t){(0,P._)(this,e),this.protocol="file";var n=e.REGEX.exec(t);if(!n)throw new Error('Illegal argument: incorrect URL: "'.concat(t,'"'));this.path=(n[3]||"").replace(/[\\/]+/g,"/");var i=(0,E._)(/(.*[\/\\]+)[^\/\\]+$/.exec(this.path)||[this.path,this.path],2)[1];this.dir=i,this.disk=n[2],this.disk||("/"===this.path[0]&&(this.path=this.path.slice(1)),this.disk=""),this.hash=n[5]||"",this.query=n[4]||""}return(0,A._)(e,[{key:"join",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var r=$s.apply(void 0,[this.dir].concat((0,I._)(n)));return new e("file:///".concat(this.disk).concat(r).concat(this.query).concat(this.hash))}},{key:"absolute",value:function(){return!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?"file:///".concat(this.disk).concat(this.path).concat(this.query).concat(this.hash):"file:///".concat(this.disk).concat(this.path)}},{key:"absoluteDir",value:function(){return"file:///".concat(this.disk).concat(this.dir)}}],[{key:"REGEX",get:function(){return/^(file:\/\/\/)([a-z]\:)?(.+?)(\?([^?#]*))?(#([^#]*))?$/i}},{key:"isValid",value:function(t){return e.REGEX.test(t)}}]),e}();function Ks(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;return(r=Ws(e)).join.apply(r,(0,I._)(n)).absolute()}function $s(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i,r=t[0];if(r.match(/^\w+?:\/\//)){var o=r.match(/^(\w+?:\/\/[^\/]+)(\/?.*)/);o&&(i=o[1],t[0]=o[2]||"/")}var a=t.filter((function(e){return"string"==typeof e&&e.length>0})),s=a.map((function(e){return e.replace(/[\/\\]+/,"/").split("/").filter((function(e,t,n){return""!==e||0===t}))})).reduce((function(e,t){return t.forEach((function(t,n){switch(t){case".":break;case"..":e.pop();break;case"":e=[""];break;default:e.push(t)}})),e}),[]).join("/");return a.length>0&&(/[\/\\\\]/.test(a[0][0])||0===a[0].indexOf(".."))&&"/"!==s[0]&&(s="/"+s),i?i+s:s}function zs(e){return Ys.isValid(e)||qs.isValid(e)}window.createURL=Ws;var Gs=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"onKeyPressed",value:function(e){var t=this.getPDFDocRender(),n=t.viewerRender.scrollWrap,i=n.getWidth(),r=n.getHeight();switch(e.command){case ko.JUMP_TO_PREVIOUS_PAGE:return this.executor.exec((function(){return t.prevPage()})),!0;case ko.JUMP_TO_NEXT_PAGE:return this.executor.exec((function(){return t.nextPage()})),!0;case ko.JUMP_TO_LAST_PAGE:var o=this.getPageCount();return t.goToPage(o-1,{x:0,y:0}),!0;case ko.JUMP_TO_FIRST_PAGE:return t.goToPage(0),!0;case ko.SCROLL_VIEWER_SCROLLBAR_LEFT:return n.scrollBy(-i,0,"smooth"),!0;case ko.SCROLL_VIEWER_SCROLLBAR_RIGHT:return n.scrollBy(i,0,"smooth"),!0;case ko.SCROLL_VIEWER_SCROLLBAR_UP:return n.scrollBy(0,-r,"smooth"),!0;case ko.SCROLL_VIEWER_SCROLLBAR_DOWN:return n.scrollBy(0,r,"smooth"),!0}return!1}}]),n}(Qo),Js=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return n}(Gs),Xs=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).scrollCurrentPageIntoView_debounced=(0,j.debounce)((function(){i.docRender&&i.scrollCurrentPageIntoView()}),20),i}return(0,A._)(n,[{key:"into",value:function(e,t){var i=this;(0,S._)((0,x._)(n.prototype),"into",this).call(this,e,t),this.updatePageDOMs(t),this.docRender.$container.addClass(n.getName());var r=this.docRender.viewerRender.scrollWrap;this._triggerScrollCount=0,this._unwatchScrollEvent=r.addScrollEventListener((function(e){e.isTrusted&&i._triggerScrollCount++,i._triggerScrollCount>2&&delete i.lastJumpPageIndex})),this.onPageNumberChange=function(){i.scrollCurrentPageIntoView_debounced()},this.docRender.pdfViewer.eventEmitter.on(de.pageNumberChange,this.onPageNumberChange)}},{key:"updatePageDOMs",value:function(e){(0,S._)((0,x._)(n.prototype),"updatePageDOMs",this).call(this,e),j.Lazy.property(this,"pageElements",(function(){return e.map((function(e){return e.querySelector(".fv__pdf-page-layout")}))}))}},{key:"getDocLayoutWidth",value:function(){var e=this.docRender.doc.pageCache,t=0;return e.forEach((function(e){t=Math.max(e.getPxWidth(),t)})),t}},{key:"getFitHeight",value:function(e){return this.docRender.viewerRender.scrollWrap.getHeight()}},{key:"getFitWidth",value:function(e){var t=this.docRender.viewerRender.scrollWrap,n=getComputedStyle(this.pageDOMs[e]);return t.getWidth()-na(n.marginLeft)-na(n.marginRight)}},{key:"jumpToPage",value:function(e,t){var n=t.x,i=void 0===n?0:n,r=t.y,o=void 0===r?0:r;this.lastJumpPageIndex=e;var a=this.getItems();e>=a.length?e=a.length-1:e<0&&(e=0);var s=a[e],u=this.docRender.viewerRender.scrollWrap.getOffsetOfPageElement(s),c=u.left+i,l=u.top+o;if("fitVisible"===this.docRender.scale){var d=s.offsetWidth,h=this.docRender.viewerRender.scrollWrap.getWidth();d>h&&(c=(d-h)/2)}this._triggerScrollCount=0;var f=s.firstElementChild;this.docRender.viewerRender.scrollWrap.scrollTo(c+f.offsetLeft,l)}},{key:"out",value:function(){this.docRender&&this.docRender.$container.removeClass(n.getName()),this._triggerScrollCount=0,this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.docRender.pdfViewer.eventEmitter.off(de.pageNumberChange,this.onPageNumberChange),(0,S._)((0,x._)(n.prototype),"out",this).call(this)}},{key:"getCurrentPageIndex",value:function(){if(!isNaN(this.lastJumpPageIndex))return this.lastJumpPageIndex;if(!this.pageDOMs.length)return 0;var e=this.docRender.getContainerVisibleRect(),t=this.getVisibleIndexes();if(t.length){var n,i=this.pageDOMs,r=t.map((function(t){var n=i[t].getBoundingClientRect();return Math.round(n.right-n.left-Math.max(e.left-n.left,0)-Math.max(n.right-e.right,0))*Math.round(n.bottom-n.top-Math.max(e.top-n.top,0)-Math.max(n.bottom-e.bottom,0))})),o=(n=Math).max.apply(n,(0,I._)(r));return t[r.indexOf(o)]}var a,s=this.getItems(),u=this.docRender.viewerRender.scrollWrap.getScrollHost(),c=(a=u===window?{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight}:u.getBoundingClientRect()).left+(a.right-a.left)/2,l=a.top+(a.bottom-a.top)/2,d=this.pageElements,h=this.lastJumpPageIndex;if(void 0!==h){var f=d[h];if(f){var g=f.getBoundingClientRect();if(g.left<c&&g.right>=c){if(this.getVisibleIndexes().length>2&&g.top<a.bottom&&g.bottom>a.top)return h;var v=getComputedStyle(f.parentElement),p=parseInt(v.marginTop)||0;if(g.top-p<l&&g.bottom>=l)return h;if(g.top>=a.bottom&&g.bottom<=a.top)return h}}}for(var m=0;m<s.length;m++)if(d[m]){var y=d[m].getBoundingClientRect();if(y&&y.left<c&&y.right>=c){var k=getComputedStyle(d[m].parentElement),b=parseInt(k.marginTop)||0;if(y.top-b<l&&y.bottom>=l)return this.lastJumpPageIndex=m,m;if(y.top>=a.bottom&&y.bottom<=a.top)return this.lastJumpPageIndex=m,m}}return 0}},{key:"getNextPageIndex",value:function(){var e=this.docRender.doc.getPageCount(),t=this.getCurrentPageIndex();return t<e-1&&t++,t}},{key:"getPrevPageIndex",value:function(){var e=this.getCurrentPageIndex();return e>0&&e--,e}},{key:"generateShortcutEventHandler",value:function(){return new Js(this)}},{key:"scrollCurrentPageIntoView",value:function(){if(this.docRender){var e=this.docRender.getCurrentPageIndex(),t=this.docRender.getPDFPageRender(e);t&&!t.pageAreaIsVisible&&t.$ui.get(0).scrollIntoViewIfNeeded(!0)}}}],[{key:"getName",value:function(){return"continuous-view-mode"}}]),n}(ta);const Zs=Xs;const Qs=function(){function e(t){(0,P._)(this,e),this.ViewModes={},this.pdfViewer=t,this.register(Zs),this.register(ua)}return(0,A._)(e,[{key:"register",value:function(e){return this.ViewModes[e.getName()]=e}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zs.getName();return this.ViewModes[e]||Zs}},{key:"set",value:function(e){var t=this.get(e),n=this.currentViewMode;this.currentViewMode=t,this.pdfViewer.eventEmitter.emit(de.startChangeViewMode,t,n);var i=this.pdfViewer.pdfViewerRender;if(i){i.ViewMode=t;var r=i.pdfDocRender;if(r){var o=r.pagesRender;o&&(o.viewMode=new t(r),this.pdfViewer.eventEmitter.emit(de.changeViewModeSuccess,t,n,o.viewMode))}}}},{key:"switchTo",value:function(e){var t=this.currentViewMode,n=this.get(e);if(t!==n){this.currentViewMode=n;var i=this.pdfViewer,r=i.pdfViewerRender;if(r)return i.activeElement(null),r.setViewMode(n)}}},{key:"getCurrentViewMode",value:function(){return this.currentViewMode||Zs}},{key:"getAll",value:function(){return this.ViewModes}}]),e}();var eu="annotComponent",tu={reply:{name:"reply",nameI18nKey:"viewer_:contextmenu.annot.reply",callback:function(){this.data(eu).showReplyDialog("reply")},disabled:function(){return this.data(eu).replyDisabled()}},properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n,i){this.data(eu).showPropertiesDialog(e,t,n,i)}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(eu).removeAnnot()},disabled:function(){return this.data(eu).deleteDisabled()}}};function nu(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:tu,events:{show:function(){return this.data(eu).updateDeleteStatus(!0),!0},hide:function(){return this.data(eu).updateDeleteStatus(!1),!0}}}}var iu,ru=g(8717),ou=g.n(ru),au=g(5100),su=g.n(au),uu=function(){function e(t,n,i){(0,P._)(this,e),this.viewerComponent=t;var r=this.viewerComponent.getModel();i=i||this.viewerComponent.getPropertyOptions();var o=su()(i);n&&n!==document.body||(o='<dialog class="fv__dialog fv__annot-properties-dialog">'.concat(o,"</dialog>"));var a=O()(o);this.$propertiesDialog=a,this.$fillColor=a.find("#fillcolor-input"),this.$txThickness=a.find("#thickness-input-tx"),this.updateBorderInfo(r,i),this.bindChangeEvent();var s=n||document.body;if(a.appendTo(s),!n||n===document.body){var u=a[0];ou().registerDialog(u),u.showModal()}}return(0,A._)(e,[{key:"toggle",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.$propertiesDialog.find("input,select").removeAttr("disabled"):this.$propertiesDialog.find("input,select").attr("disabled","true")}},{key:"updateBorderInfo",value:function(e,t){var n=this.$propertiesDialog;if(t.lineEndStyle&&n.find("#endstyle-select [value="+e.getEndingStyle()+"]").attr("selected",!0),t.lineStartStyle)if("freetext"===e.getType())n.find("#startstyle-select [value="+e.getCalloutLineEndingStyle()+"]").attr("selected",!0);else n.find("#startstyle-select [value="+e.getStartStyle()+"]").attr("selected",!0);if(void 0!==t.highlightingMode&&n.find("#highlighting-select [value="+e.getHighlightingMode()+"]").attr("selected",!0),void 0!==t.rotation&&n.find("#rotation-select [value="+e.getRotation()+"]").attr("selected",!0),!1!==t.borderStyle){var i=e.getBorderDashes();if(1==e.getBorderStyle()&&i.length>0){var r=Math.max.apply(Math,i),o=Math.min.apply(Math,i);o==r?o>3?n.find("#borderStyle-select [value=3]").attr("selected",!0):o>2?n.find("#borderStyle-select [value=2]").attr("selected",!0):o<2||2==o?n.find("#borderStyle-select [value=1]").attr("selected",!0):n.find("#borderStyle-select [value=3]").attr("selected",!0):r>8?n.find("#borderStyle-select [value=6]").attr("selected",!0):r>4?n.find("#borderStyle-select [value=5]").attr("selected",!0):n.find("#borderStyle-select [value=4]").attr("selected",!0)}else if(e.getBorderStyle()==me.CLOUDY){switch(e.getCloudIntensity()){case 1:n.find("#borderStyle-select [value=7]").attr("selected",!0);break;case 2:n.find("#borderStyle-select [value=8]").attr("selected",!0)}}}}},{key:"bindChangeEvent",value:function(){var e=this;this.$propertiesDialog.on("click",".fv__btn-close",(function(){e.viewerComponent.hidePropertiesDialog?e.viewerComponent.hidePropertiesDialog():e.close()})).on("change","#color-input",(function(t){var n=t.target,i=parseInt(n.value.replace("#",""),16);e.viewerComponent.setColor(i)})).on("change","#opacity-input",(function(t){var n=t.target.value;e.viewerComponent.setOpacity(+n)})).on("change","#thickness-input",(function(e){return i("#thickness-input","#thickness-input-tx")})).on("blur","#thickness-input",(function(e){return i("#thickness-input","#thickness-input-tx")})).on("blur","#thickness-input-tx",(function(e){return i("#thickness-input-tx","#thickness-input")})).on("change","#thickness-input-tx",(function(e){return i("#thickness-input-tx","#thickness-input")})).on("change","#borderStyle-select",(function(t){var n=t.target.value,i=me.DASHED;switch(n){case"0":n=[],i=me.SOLID;break;case"1":n=[2,2,2,2];break;case"2":n=[3,3,3,3];break;case"3":n=[4,4,4,4];break;case"4":n=[4,3,2,3];break;case"5":n=[8,4,4,4];break;case"6":n=[4,3,16,3];break;case"7":n=1,i=me.CLOUDY;break;case"8":n=2,i=me.CLOUDY}e.viewerComponent.setBorderStyle(i,n)})).on("change","#fillcolor-input",(function(t){var n=t.target,i=parseInt(n.value.replace("#",""),16);e.viewerComponent.setFillColor(i)})).on("change","#fillColor-transparent-input",(function(t){t.target.checked?(e.$fillColor.val("#ffffff"),e.$fillColor.attr("disabled",!0),e.viewerComponent.setFillColor(0)):e.$fillColor.removeAttr("disabled")})).on("change","#startstyle-select",(function(t){var n=t.target.value;e.viewerComponent.setEndingStyle(!0,n)})).on("change","#endstyle-select",(function(t){var n=t.target.value;e.viewerComponent.setEndingStyle(!1,n)})).on("change","#hasCap-input",(function(t){var n=t.target.checked;e.viewerComponent.enableCaption(n)})).on("change","#highlighting-select",(function(t){var n=t.target.value;e.viewerComponent.setHighlightingMode(n)})).on("change","#rotation-select",(function(t){var n=t.target.value;e.viewerComponent.setRotation(90*+n)}));var t=this,n=!1;function i(e,i){if(!n){n=!0;var r=t.$propertiesDialog,o=r.find(e).val();t.viewerComponent.getModel().getBorderWidth()!=o?(t.viewerComponent.setBorderWidth(+o),n=!1,r.find(i).val(o)):n=!1}}}},{key:"close",value:function(){var e=this.$propertiesDialog;e&&(e[0].close(),e.remove(),this.$propertiesDialog=null)}}]),e}(),cu=g(6912),lu=g.n(cu),du=g(4252),hu=g.n(du),fu=g(4210),gu=g.n(fu),vu=eu,pu=nu(".fv__pdf-page-annot-handler-rect"),mu="px",yu=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="markup",a.eUi=i,a.$ui.addClass("pdf-page-markup-annot-container"),a.$handler.addClass("pdf-page-markup-annot-handler-container");var s=a.pdfViewer.i18n,u=Mo().i18n=function(e){return s.t(e)};a.addDestroyHook((function(){Mo().i18n===u&&(Mo().i18n=void 0)})),a.currentRenderDefer=(0,j.createDeferred)(),a.currentRenderDefer.isPending=!0,j.Lazy.property((0,w._)(a),"contextMenu",(function(){if(a.contextMenuIsEnable())return a.pdfViewer.viewerUI.createContextMenu((0,w._)(a),r,a.getContextMenuConfig())}));var c=a.pdfViewer.getAnnotAuthorityManager();a.addDestroyHook(c.subscribe(a.annot,(function(e){a.updateOnPermissionChange(e)})));var l=a.pdfViewer.eventEmitter,d=function(){a.isDestroyed||a.annot.isDestroyed||c.getPermission(a.annot).then((function(e){a.updateOnPermissionChange(e)}))};l.on(de.permissionChanged,d),a.addDestroyHook((function(){l.off(de.permissionChanged,d)}));var h=j.Lazy.onInitialized((0,w._)(a),"shapeControl",(function(e){e.ui.addEventListener("click",(function(e){a.isActive&&e.isTrusted&&0===e.button&&!e.shiftKey&&e.ctrlKey&&a.pdfViewer.unActiveElement((0,w._)(a))})),e.ownsTo&&e.ownsTo(a.disposor)}));return a.addDestroyHook(h),a.addDestroyHook(a.pdfViewer.getCustomOptionsUpdater().onGetAnnotComponentConfigUpdated((function(){if(j.Lazy.hasProperty((0,w._)(a),"shapeControl")&&j.Lazy.isPropertyIntialized((0,w._)(a),"shapeControl")){var e=a.shapeControl.isActive,t=a.shapeControl;j.Lazy.reset((0,w._)(a),"shapeControl"),e&&a._applyShapeChange(),t.destroy()}}))),a}return(0,A._)(n,[{key:"getInnerRect",value:function(){return{left:0,right:0,top:0,bottom:0}}},{key:"getModifiedRect",value:function(e,t){var n={left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},i=Ra.on(n).extract(),r=i.left,o=i.top,a=i.right,s=i.bottom,u=this.scale,c=this.rotate;return this.getPDFPage().reverseDeviceRect({left:r,top:o,right:a,bottom:s},u,c)}},{key:"updateCollabOp",value:function(e){}},{key:"updateOnPermissionChange",value:function(e){if(!this.isDestroyed&&j.Lazy.isPropertyIntialized(this,"shapeControl")){var t=!1;t=!!this.groupMoveDisabled()||(e.ignorable()?this.moveDisabled():this.moveDisabled()||!e.isAdjustable());var n=this.shapeControl;t?n.disable():n.enable()}}},{key:"isHTMLSimulate",value:function(e){return"canvas"===this.pdfViewer.config.annotRenderingMode[e||this.name]}},{key:"getRenderPromise",value:function(){return this.currentRenderDefer.promise}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;return this.getAnnotFlag().checkNoZoom()&&(u=a.right-a.left,c=a.bottom-a.top),[Math.ceil(c/r),Math.ceil(u/r),u+=1,c+=1,r,i,e,t,a.left,a.top]}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)}},{key:"afterRender",value:function(e){e.transformed&&this.isActive&&this.active()}},{key:"redraw",value:function(e){return this.activeRect(),this.render()}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.$handler.addClass("active")}},{key:"activeMore",value:function(e,t){}},{key:"activeMoreItem",value:function(){}},{key:"unActive",value:function(){var e=this;if(this.isActive){var t=this.pdfViewer;(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),t.unActiveElement(this),t.eventEmitter.emit(de.unActiveAnnotation,this),!this.delayRemoveActive&&this.$handler.removeClass("active"),this.getGroupRenders().map((function(t){t.component!=e&&t.component.unActive()}))}}},{key:"unActiveMore",value:function(){}},{key:"renderDestroy",value:function(){this.$handler.remove()}},{key:"showReplyDialog",value:function(){var e=this;this.updateDeleteStatus(!0);var t=this.annot,n={},i=t.getGroupHeader()||t,r=n.content=i.getContent(),o=n.replies=[];this.iterationGetRepliesInfo(i,o);var a=o.length,s=lu()(n),u=O()(s);this.$replyDialog=u;var c=u[0],l=u.find(".fv__btn-reply")[0],d=u.find(".reply-textarea")[0],h=!1;t.hasModifyPermission()?u.find(".content-textarea").prop({disabled:!1}):u.find(".content-textarea").prop({disabled:!0}),this.updateReplyDialog(),u.on("click",".fv__btn-close",(function(){e.hideReplyDialog()})).on("change",".content-textarea",(function(t){var n=t.target,i=n.value;e.setContent(i).then((function(t){if(t)return(0===i.length||u.find(".reply-textarea").prop("disabled"))&&e.updateReplyDialog(),r=i;n.value=r}))})).on("input",".reply-textarea",(function(e){l.disabled=!d.value})).on("click",".fv__btn-reply",(function(t){if(!e.replyDisabled()&&!h){l.disabled=!0,h=!0;var n=d.value;e.addReply(n).then((function(t){var n={content:t.getContent()},i=n.replies=[];e.iterationGetRepliesInfo(t,i),a?u.find(".fv__replies_list").first().append(gu()(n)):u.find(".fv__dialog-replies-block").first().html(hu()([n])),a=!0,d.value="",l.disabled=!1,h=!1}),(function(){l.disabled=!1}))}})),u.appendTo(document.body),ou().registerDialog(c),c.showModal()}},{key:"updateReplyDialog",value:function(){var e=this.$replyDialog;e&&(this.replyDisabled()?(e.find(".fv__btn-reply").addClass("fv__btn-replay-disabled"),e.find(".reply-textarea").prop({disabled:!0})):(e.find(".fv__btn-reply").removeClass("fv__btn-replay-disabled"),e.find(".reply-textarea").prop({disabled:!1})))}},{key:"hideReplyDialog",value:function(){var e=this.$replyDialog;e&&(e[0].close(),e.remove(),this.$replyDialog=null),this.updateDeleteStatus(!1)}},{key:"addReply",value:function(e){var t=this;return this.annot.addReply(e).then((function(e){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e}))}},{key:"showContextMenu",value:function(e,t){return!!this.contextMenu&&(this.contextMenu.setCurrentTarget(this),this.contextMenu.showAt(e,t))}},{key:"hideContextMenu",value:function(){}},{key:"getPropertyOptions",value:function(){var e=this.annot;return{color:(0,j.colorConvertor)(e.getBorderColor(),"#"),opacity:e.getOpacity(),borderStyle:!1,disabled:this.propertyDisabled(),isLocked:this.isLocked()}}},{key:"showPropertiesDialog",value:function(){this.$propertiesControl=new uu(this),this.updateDeleteStatus(!0)}},{key:"hidePropertiesDialog",value:function(){this.$propertiesControl&&this.$propertiesControl.close(),this.bindEvent(),this.updateDeleteStatus(!1)}},{key:"updateRender",value:function(){return Promise.resolve()}},{key:"setContent",value:function(e){var t=this;return this.annot.setContent(e).then((function(e){return e&&t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e}))}},{key:"setColor",value:function(e){return this.annot.setBorderColor(e)}},{key:"setOpacity",value:function(e){var t=this;return e==this.annot.getOpacity()?Promise.resolve(!0):this.annot.setOpacity(e).then((function(e){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e}))}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.hidePopup(),this.hidePropertiesDialog(),this.unBindEvent(),this.$propertiesControl=null,this.hideReplyDialog(),j.Lazy.isPropertyIntialized(this,"contextMenu")&&this.contextMenu&&this.contextMenu.destroy(),this.blankHammar&&this.blankHammar.destroy(),this.pdfViewer.deactivateElement(this),this.unActiveMore(),this.eUi&&this.eUi.removeEventListener("mouseenter",this.annotTooltipMouseover),this.eUi=null,this.tooltip=null}},{key:"remove",value:function(){this.destroy()}},{key:"iterationGetRepliesInfo",value:function(e,t){for(var n=e.getReplies(),i=0,r=n.length;i<r;i++){var o=n[i];if(!o.isDeleted()){var a={content:o.getContent(),replies:[]};this.iterationGetRepliesInfo(o,a.replies),t.push(a)}}}},{key:"removeAnnot",value:function(){var e=this;return this.getAppPermission().then((function(t){return t.ignorable()&&e.deleteDisabled()?Promise.resolve():t.isDeletable()&&!e.deleteDisabled()?e.doRemoveAnnot():void 0})).then((function(t){var n=e.pdfViewer.getCurrentActivatable();return n&&n.remove&&n.remove(e),t}))}},{key:"doRemoveAnnot",value:function(){var e=this,t=this.pdfViewer,n=t.eventEmitter,i=this.annot;return Promise.resolve((t.customs.removeAnnotBefore||j.noop)(this)).then((function(t){if(n.emit(de.removeActionAnnotationBefore,e),!1!==t)return i.getPDFPage().removeAnnot(i).then((function(t){return n.emit(de[t?"removeActionAnnotationSuccess":"removeActionAnnotationFailed"],e,i),t}),(function(){n.emit(de.removeActionAnnotationFailed,e)}))}))}},{key:"removeAnnotRender",value:function(){this.renderDestroy(),this.parent().remove()}},{key:"willRedraw",value:function(){(0,S._)((0,x._)(n.prototype),"willRedraw",this).call(this),(this.$rect=this.$rect||this.rectInit()).get(0).willChange="left, top, width, height"}},{key:"afterRedraw",value:function(){(0,S._)((0,x._)(n.prototype),"afterRedraw",this).call(this),(this.$rect=this.$rect||this.rectInit()).get(0).willChange="auto"}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceRect(n,i);t.css({left:r.left+mu,top:r.top+mu,width:r.right-r.left+mu,height:r.bottom-r.top+mu})}},{key:"_applyShapeChange",value:function(){}},{key:"rectInit",value:function(){var e=this.$handler,t=O()(this.createRectDom());return e.append(t),this.contextMenuIsEnable()&&t.data(vu,this),t}},{key:"rectSingleTap",value:function(){}},{key:"rectDoubleTap",value:function(e){var t=this;this.getAppPermission().then((function(e){e.isEditable()&&t.showReplyDialog("comment")}))}},{key:"createRectDom",value:function(){return O()('<div class="fv__pdf-page-annot-handler-rect">')}},{key:"doubleTapAnnot",value:function(){var e=this;this.getAppPermission().then((function(t){t.isEditable()&&e.showReplyDialog("comment")}))}},{key:"getContextMenuConfig",value:function(){if(iu)return iu;var e=this.constructor.getDefaultContextMenuConfig();for(var t in e)if("items"===t){var n=e[t],i=this.pdfViewer.i18n;for(var r in n){var o=n[r];o.nameI18nKey&&(o.name=i.t(o.nameI18nKey))}}return e}},{key:"getRelevanceRenders",value:function(){var e,t,n,i,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=this.parent("annotsRender"),a=this.annot.getGroupHeader()||this.annot,s=[],u=a.getPopup(),c=[],l=[],d=[];!function(e,t){bu(e,"getReplies",t)}(a,c),wu(a,l),_u(a,d),u&&s.push(u.getId()),(e=s).push.apply(e,(0,I._)(c)),(t=s).push.apply(t,(0,I._)(l)),(n=s).push.apply(n,(0,I._)(d));var h=a.isGrouped()?a.getGroupElements():[a];return(i=s).push.apply(i,(0,I._)(h.map((function(e){return e.getId()})))),r?s:s.map((function(e){return o.getAnnotRender(e)})).filter((function(e){return!!e}))}},{key:"getGroupRenders",value:function(){var e=this.parent("annotsRender"),t=this.annot;return((t=t.getGroupHeader()||t).isGrouped()?t.getGroupElements():[t]).map((function(t){return e.getAnnotRender(t.getId())}))}},{key:"getGroupRect",value:function(){var e=this.getGroupRenders();if(e.length>1){var t,n,i,r,o=e.map((function(e){return e.component.getRect()}));return{left:(t=Math).min.apply(t,(0,I._)(o.map((function(e){return e.left})))),right:(n=Math).max.apply(n,(0,I._)(o.map((function(e){return e.right})))),top:(i=Math).min.apply(i,(0,I._)(o.map((function(e){return e.top})))),bottom:(r=Math).max.apply(r,(0,I._)(o.map((function(e){return e.bottom}))))}}if(!e[0])return Object.assign({},{});var a=e[0].component.getRect();return Object.assign({},a)}},{key:"showPopup",value:function(){}},{key:"hidePopup",value:function(){}},{key:"onDoubleTap",value:function(e){}},{key:"invisibleRender",value:function(){}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{opacity:this.annot.getOpacity(),tileConfig:this.getTileConfig(e,t)})}},{key:"processShapeControlPermissionCtrl",value:function(){var e=this;this.isDestroyed||this.annot.isDestroyed||this.pdfViewer.getAnnotAuthorityManager().getPermission(this.annot).then((function(t){e.updateOnPermissionChange(t)}))}}],[{key:"getDefaultContextMenuConfig",value:function(){return pu}},{key:"setContextMenuConfig",value:function(e){iu=e}}]),n}(To);const ku=yu;function bu(e,t,n){var i=e[t](),r=i.length;if(!r)return n;for(var o=0;o<r;o++){var a=i[o];bu(a,t,n),wu(a,n),_u(a,n),n.push(a.getId())}return n}function wu(e,t){return bu(e,"getMarkedStates",t)}function _u(e,t){return bu(e,"getReviewStates",t)}var Pu="annotComponent";var Au=g(5322),Su=g.n(Au),xu=g(8012),Cu=g.n(xu),Du="north",Eu="south",Iu="east",Ru="west",Tu="north-west",Fu="north-east",Mu="south-west",Ou="south-east",Lu=(g(3279),g(8446)),Nu=g.n(Lu),Vu="__auxiliary-line";var Bu=function(){function e(t,n,i,r){(0,P._)(this,e),this.x0=t,this.y0=n,this.x1=i,this.y1=r}return(0,A._)(e,[{key:"slope",value:function(){return this.x1-this.x0!=0?(this.y1-this.y0)/(this.x1-this.x0):1/0}},{key:"isParallel",value:function(e){return Math.abs(this.slope()-e.slope())<1e-9||this.slope()==e.slope()}},{key:"distanceFromPoint",value:function(e,t){var n=this.y1-this.y0,i=this.x0-this.x1,r=this.x1*this.y0-this.x0*this.y1;return Math.abs(n*e+i*t+r)/Math.sqrt(n*n+i*i)}}]),e}();function ju(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document.body,r=[],o={top:null,left:null,right:null,bottom:null};t.forEach((function(t){if(Math.abs(t.left-e.left)<=n||Math.abs(t.right-e.left)<=n){var i=Math.abs(t.left-e.left)<Math.abs(t.right-e.left)?t.left:t.right;t.top>e.top?r.push(new Bu(i,e.top,i,t.bottom)):r.push(new Bu(i,t.top,i,Math.max(t.bottom,e.bottom))),null===o.left?o.left=i:o.left=Math.abs(o.left-e.left)<Math.abs(i-e.left)?o.left:i}if(Math.abs(t.right-e.right)<=n||Math.abs(t.left-e.right)<=n){var a=Math.abs(t.right-e.right)<Math.abs(t.left-e.right)?t.right:t.left;t.top>e.top?r.push(new Bu(a,e.top,a,t.bottom)):r.push(new Bu(a,t.top,a,Math.max(t.bottom,e.bottom))),null===o.right?o.right=a:o.right=Math.abs(o.right-e.right)<Math.abs(a-e.right)?o.right:a}if(Math.abs(t.top-e.top)<=n||Math.abs(t.bottom-e.top)<=n){var s=Math.abs(t.top-e.top)<Math.abs(t.bottom-e.top)?t.top:t.bottom;t.left>e.left?r.push(new Bu(e.left,s,t.right,s)):r.push(new Bu(t.left,s,Math.max(e.right,t.right),s)),null===o.top?o.top=s:o.top=Math.abs(o.top-e.top)<Math.abs(s-e.top)?o.top:s}if(Math.abs(t.bottom-e.bottom)<=n||Math.abs(t.top-e.bottom)<=n){var u=Math.abs(t.bottom-e.bottom)<Math.abs(t.top-e.bottom)?t.bottom:t.top;t.left>e.left?r.push(new Bu(e.left,u,t.right,u)):r.push(new Bu(t.left,u,Math.max(e.right,t.right),u)),null===o.bottom?o.bottom=u:o.bottom=Math.abs(o.bottom-e.bottom)<Math.abs(u-e.bottom)?o.bottom:u}}));var a=function(e,t,n){var i=new Bu(e.left,e.top,e.right,e.top),r=new Bu(e.left,e.bottom,e.right,e.bottom),o=new Bu(e.left,e.top,e.left,e.bottom),a=new Bu(e.right,e.top,e.right,e.bottom),s=null,u=null,c=null,l=null,d=1/0,h=1/0,f=1/0,g=1/0;return t.forEach((function(t){if(i.isParallel(t)){var v=t.distanceFromPoint(e.left,e.top);v<d&&v<=n&&(d=v,s=t)}if(r.isParallel(t)){var p=t.distanceFromPoint(e.left,e.bottom);p<h&&p<=n&&(h=p,u=t)}if(o.isParallel(t)){var m=t.distanceFromPoint(e.left,e.top);m<f&&m<=n&&(f=m,c=t)}if(a.isParallel(t)){var y=t.distanceFromPoint(e.right,e.top);y<g&&y<=n&&(g=y,l=t)}})),{closestTop:s,closestBottom:u,closestLeft:c,closestRight:l}}(e,r,n),s=[a.closestBottom,a.closestLeft,a.closestRight,a.closestTop].filter((function(e){return e}));return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#777",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:document.body,r=Array.from(i.getElementsByClassName(Vu));if(r.length<e.length)for(var o=e.length-r.length;o-- >0;){var a=document.createElement("div");a.className=Vu+" "+n,r.push(a),i.appendChild(a)}for(var s=0;s<r.length;s++){var u=r[s];if(s>=e.length)u.style.display="none";else{u.style.display="";var c=e[s];if(c.y0===c.y1){var l="\n                width: ".concat(Math.abs(c.x1-c.x0),"px;\n                height: 1px;\n                position: absolute;\n                top: ").concat(c.y0-.5,"px;\n                left: ").concat(c.x0,"px;\n                z-index: 10;\n                background: linear-gradient(to right, transparent 50%, ").concat(t," 50%);\n                background-size: 5px 5px;");u.style.cssText+=l}else if(c.x0===c.x1){var d="\n                width: 1px;\n                height: ".concat(Math.abs(c.y1-c.y0),"px;\n                position: absolute;\n                top: ").concat(c.y0,"px;\n                left: ").concat(c.x0-.5,"px;\n                z-index: 10;\n                background: linear-gradient(to bottom, transparent 50%, ").concat(t," 50%);\n                background-size: 5px 5px;");u.style.cssText+=d}}}}(s,void 0,"",i),o}function Uu(){!function(){for(var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body).getElementsByClassName(Vu),t=e.length-1;t>=0;t--)e[t].remove()}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body)}var Hu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=void 0===n?0:n,r=t.right,o=void 0===r?0:r,a=t.bottom,s=void 0===a?0:a,u=t.top,c=void 0===u?0:u,l=t.box,d=t.marginBox,h=void 0===d?{left:0,top:0,right:0,bottom:0}:d,f=t.expansion,g=void 0===f?{left:0,top:0,right:0,bottom:0}:f;(0,P._)(this,e),this.processing=!1,this.boundary={left:i,right:o,bottom:s,top:c},this.freeBoundary=null,this.marginBox=h,this.shape=this.calculateShape(),this.setBoundaryBox(l),this.tasks=[],this.expansion=g,this.drawAuxiliaryLine=ju,this.clearAuxiliaryLine=Uu}return(0,A._)(e,[{key:"process",value:function(){this.tasks=[],this.processing=!0,this.freeBoundary=Object.assign({},this.boundary)}},{key:"end",value:function(){this.tasks=[],this.processing=!1,this.boundary=this.squareBoundary||this.freeBoundary,this.freeBoundary=null,this.squareBoundary=null,this.shape=this.calculateShape()}},{key:"cancel",value:function(){this.tasks=[],this.processing=!1,this.freeBoundary=null,this.squareBoundary=null}},{key:"setBoundaryBox",value:function(e){var t=this;this.box=e,this.boxStrict=e?function(n,i){return t._adjustBoundaryByBox(e,n,i)}:j.noop}},{key:"undo",value:function(){var e=this.tasks.pop();"function"==typeof e&&e()}},{key:"addTask",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.tasks.push((function(){return e.apply(void 0,(0,I._)(n))}))}},{key:"recordFreeBoundary",value:function(){var e=this,t=this.freeBoundary?Object.assign({},this.freeBoundary):null;this.addTask((function(t){e.freeBoundary=t}),t)}},{key:"recordSquareBoundary",value:function(){var e=this,t=this.squareBoundary?Object.assign({},this.squareBoundary):null;this.addTask((function(t){e.squareBoundary=t}),t)}},{key:"adjustWest",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ADJUST_MODE_FREE;this.recordFreeBoundary();var i=this.freeBoundary,r=(0,k._)({},i),o=this.freeBoundary.left+t,a=this.freeBoundary.right;switch(i.left=Math.min(o,a),i.right=Math.max(o,a),n){case e.ADJUST_MODE_SQUARE:this._adjustToSquareH();case e.ADJUST_MODE_UNIFORM:}return this.boxStrict(this.freeBoundary,r),a<o?Iu:Ru}},{key:"adjustEast",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ADJUST_MODE_FREE;this.recordFreeBoundary();var i=(0,k._)({},this.freeBoundary),r=this.freeBoundary.right+t,o=this.freeBoundary.left;switch(this.freeBoundary.left=Math.min(o,r),this.freeBoundary.right=Math.max(o,r),n){case e.ADJUST_MODE_SQUARE:this._adjustToSquareH();case e.ADJUST_MODE_UNIFORM:}return this.boxStrict(this.freeBoundary,i),r<o?Ru:Iu}},{key:"_adjustToSquareH",value:function(){var e=this.freeBoundary,t=e.right-e.left,n=e.bottom-e.top,i=e.top+n/2-t/2,r=i+t;e.top=i,e.bottom=r}},{key:"adjustNorth",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ADJUST_MODE_FREE;this.recordFreeBoundary();var i=(0,k._)({},this.freeBoundary),r=this.freeBoundary.top+t,o=this.freeBoundary.bottom;switch(this.freeBoundary.top=Math.min(r,o),this.freeBoundary.bottom=Math.max(r,o),n){case e.ADJUST_MODE_SQUARE:this._adjustToSquareV();case e.ADJUST_MODE_UNIFORM:}return this.boxStrict(this.freeBoundary,i),o<r?Eu:Du}},{key:"adjustSouth",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.ADJUST_MODE_FREE;this.recordFreeBoundary();var i=(0,k._)({},this.freeBoundary),r=this.freeBoundary.bottom+t,o=this.freeBoundary.top;switch(this.freeBoundary.top=Math.min(o,r),this.freeBoundary.bottom=Math.max(o,r),n){case e.ADJUST_MODE_SQUARE:this._adjustToSquareV();case e.ADJUST_MODE_UNIFORM:}return this.boxStrict(this.freeBoundary,i),r<o?Du:Eu}},{key:"_adjustToSquareV",value:function(){var e=this.freeBoundary,t=e.right-e.left,n=e.bottom-e.top,i=e.left+t/2-n/2,r=i+n;e.left=i,e.right=r}},{key:"_adjustToSquare",value:function(e,t){var n=this.freeBoundary.right-this.freeBoundary.left,i=this.freeBoundary.bottom-this.freeBoundary.top,r=Math.min(n,i);this.squareBoundary=Object.assign({},this.freeBoundary),t==Ru?this.squareBoundary.left=this.freeBoundary.right-r:this.squareBoundary.right=this.freeBoundary.left+r,e==Eu?this.squareBoundary.bottom=this.freeBoundary.top+r:this.squareBoundary.top=this.freeBoundary.bottom-r}},{key:"adjustNorthWest",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ADJUST_MODE_FREE,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.recordFreeBoundary(),this.recordSquareBoundary();var o=(0,k._)({},this.freeBoundary);switch(this.squareBoundary=null,i){case e.ADJUST_MODE_UNIFORM:return this._adjustNorthWestUniform(t,n,r),this.boxStrict(this.freeBoundary,o),Tu;case e.ADJUST_MODE_FREE:case e.ADJUST_MODE_SQUARE:var a=this.adjustNorth(n),s=this.adjustWest(t);return i==e.ADJUST_MODE_SQUARE&&(this._adjustToSquare(a,s),this.boxStrict(this.squareBoundary,o)),"".concat(a,"-").concat(s)}}},{key:"_adjustNorthWestUniform",value:function(e,t,n){var i=this.freeBoundary,r=i.right,o=i.bottom,a=i.left,s=i.top,u=r-(a+e),c=o-(s+t),l=r-a,d=o-s,h=Math.min(u,c);h>=n&&(h===u?c=h/l*d:u=h/d*l,this.freeBoundary.left=r-u,this.freeBoundary.top=o-c)}},{key:"adjustNorthEast",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ADJUST_MODE_FREE,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.recordFreeBoundary(),this.recordSquareBoundary();var o=(0,k._)({},this.freeBoundary);switch(i){case e.ADJUST_MODE_UNIFORM:return this._adjustNorthEastUniform(t,n,r),this.boxStrict(this.freeBoundary,o),Fu;case e.ADJUST_MODE_FREE:case e.ADJUST_MODE_SQUARE:var a=this.adjustNorth(n),s=this.adjustEast(t);return this.squareBoundary=null,i==e.ADJUST_MODE_SQUARE&&(this._adjustToSquare(a,s),this.boxStrict(this.squareBoundary,o)),"".concat(a,"-").concat(s)}}},{key:"_adjustNorthEastUniform",value:function(e,t,n){var i=this.freeBoundary,r=i.right,o=i.bottom,a=i.left,s=i.top,u=r+e-a,c=o-(s+t),l=r-a,d=o-s,h=Math.min(u,c);h>=n&&(h===u?c=h/l*d:u=h/d*l,this.freeBoundary.right=a+u,this.freeBoundary.top=o-c)}},{key:"adjustSouthWest",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ADJUST_MODE_FREE,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.recordFreeBoundary(),this.recordSquareBoundary();var o=(0,k._)({},this.freeBoundary);switch(i){case e.ADJUST_MODE_UNIFORM:return this._adjustSouthWestUniform(t,n,r),this.boxStrict(this.freeBoundary,o),Mu;case e.ADJUST_MODE_FREE:case e.ADJUST_MODE_SQUARE:var a=this.adjustSouth(n),s=this.adjustWest(t);return this.squareBoundary=null,i==e.ADJUST_MODE_SQUARE&&(this._adjustToSquare(a,s),this.boxStrict(this.squareBoundary,o)),"".concat(a,"-").concat(s)}}},{key:"_adjustSouthWestUniform",value:function(e,t,n){var i=this.freeBoundary,r=i.right,o=i.bottom,a=i.left,s=i.top,u=r-(a+e),c=o+t-s,l=r-a,d=o-s,h=Math.min(u,c);h>=n&&(h===u?c=h/l*d:u=h/d*l,this.freeBoundary.left=r-u,this.freeBoundary.bottom=s+c)}},{key:"adjustSouthEast",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ADJUST_MODE_FREE,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.recordFreeBoundary(),this.recordSquareBoundary();var o=(0,k._)({},this.freeBoundary);switch(i){case e.ADJUST_MODE_UNIFORM:return this._adjustSouthEastUniform(t,n,r),this.boxStrict(this.freeBoundary,o),Ou;case e.ADJUST_MODE_FREE:case e.ADJUST_MODE_SQUARE:var a=this.adjustSouth(n),s=this.adjustEast(t);return this.squareBoundary=null,i==e.ADJUST_MODE_SQUARE&&(this._adjustToSquare(a,s),this.boxStrict(this.squareBoundary,o)),"".concat(a,"-").concat(s)}}},{key:"_adjustSouthEastUniform",value:function(e,t,n){var i=this.freeBoundary,r=i.right,o=i.bottom,a=i.left,s=i.top,u=r+e-a,c=o+t-s,l=r-a,d=o-s,h=Math.min(u,c);h>=n&&(h===u?c=h/l*d:u=h/d*l,this.freeBoundary.right=a+u,this.freeBoundary.bottom=s+c)}},{key:"adjustPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.recordFreeBoundary(),this.freeBoundary){this.freeBoundary.left+=e,this.freeBoundary.right+=e,this.freeBoundary.top+=t,this.freeBoundary.bottom+=t;var n=(0,k._)({},this.freeBoundary);this.boxStrict(this.freeBoundary,n)}}},{key:"adjustPositionTo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.freeBoundary.left,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.freeBoundary.top;this.adjustPosition(e-this.freeBoundary.left,t-this.freeBoundary.top)}},{key:"_adjustMovingBoundaryByBox",value:function(e,t){var n=t.right-t.left,i=t.bottom-t.top;this.boundary.right>e.right&&(this.boundary.right=e.right,this.boundary.left=e.right-n),this.boundary.bottom>e.bottom&&(this.boundary.bottom=e.bottom,this.boundary.top=e.bottom-i),this.boundary.left<e.left&&(this.boundary.left=e.left,this.boundary.right=e.left+n),this.boundary.top<e.top&&(this.boundary.top=e.top,this.boundary.bottom,e.top)}},{key:"_adjustBoundaryByBox",value:function(e,t,n){var i=this.marginBox;i||(i={}),i.left=i.left||0,i.top=i.top||0,i.bottom=i.bottom||0,i.right=i.right||0;var r=Ra.on(t).expand(i.top,i.left,i.bottom,i.right).extract(),o=r.right-r.left,a=r.bottom-r.top;Nu()(t,n)||(a=Math.min(e.bottom-e.top,n.bottom-n.top),o=Math.min(e.right-e.left,n.right-n.left)),r.right>e.right&&(r.right=e.right,r.left=e.right-o),r.bottom>e.bottom&&(r.bottom=e.bottom,r.top=e.bottom-a),r.left<e.left&&(r.left=e.left,r.right=e.left+o),r.top<e.top&&(r.top=e.top,r.bottom=e.top+a);var s=Ra.on(r).shrink(i.top,i.left,i.bottom,i.right).extract();Ra.copyTo(s,t)}},{key:"setMargin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.marginBox,t=e.left,n=void 0===t?0:t,i=e.top,r=void 0===i?0:i,o=e.right,a=void 0===o?0:o,s=e.bottom,u=void 0===s?0:s;this.marginBox={left:n,top:r,right:a,bottom:u}}},{key:"getAdjustRect",value:function(){var e=this.squareBoundary||this.freeBoundary;return e?Object.assign({},e):null}},{key:"getAdjustShape",value:function(){var e=this.squareBoundary||this.freeBoundary;return e?{left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top}:null}},{key:"getRect",value:function(){return Object.assign({},this.boundary)}},{key:"getShape",value:function(){return Object.assign({},this.shape)}},{key:"calculateShape",value:function(){var e=this.boundary;return{left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top}}},{key:"applyToDom",value:function(e,t){t=t||this.getShape();var n=this.expansion;e.style.cssText+="\n                left: ".concat(t.left-n.left,"px;\n                top: ").concat(t.top-n.top,"px;\n                width: ").concat(t.width+(n.left+n.right),"px;\n                height: ").concat(t.height+(n.top+n.bottom),"px;\n                ")}},{key:"applyAdjustingToDom",value:function(e,t){t=t||this.getAdjustShape();var n=this.expansion;e.style.cssText+="\n                left: ".concat(t.left-n.left,"px;\n                top: ").concat(t.top-n.top,"px;\n                width: ").concat(t.width+(n.left+n.right),"px;\n                height: ").concat(t.height+(n.top+n.bottom),"px;\n                ")}}],[{key:"ADJUST_MODE_FREE",get:function(){return"free"}},{key:"ADJUST_MODE_UNIFORM",get:function(){return"uniform"}},{key:"ADJUST_MODE_SQUARE",get:function(){return"square"}}]),e}(),Wu=ue,Yu="move",qu=["square","widget","polygon","line","polyline","circle","stamp","freetext","fileattachment","text"],Ku=j.LoggerFactory.getLogger("ShapeControl"),$u={};var zu=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.emitter,o=i.prestart,a=void 0===o?j.noop:o,s=i.start,u=void 0===s?j.noop:s,c=i.update,l=void 0===c?j.noop:c,d=i.interceptor,h=void 0===d?Wu:d,f=i.moving,g=void 0===f?j.noop:f,v=i.end,p=void 0===v?j.noop:v,m=i.afterEnd,y=void 0===m?j.noop:m,k=i.rotate,b=void 0===k?j.noop:k,w=i.beforeRotateStart,_=void 0===w?j.noop:w,A=i.rotateStart,S=void 0===A?j.noop:A,x=i.rotateEnd,C=void 0===x?j.noop:x,D=i.afterRotateEnd,E=void 0===D?j.noop:D,I=i.enableDiagonally,R=void 0!==I&&I,T=i.enableFrame,F=void 0===T||T,M=i.enableSizeBox,O=void 0!==M&&M,L=i.resizable,N=void 0===L||L,V=i.moveable,B=void 0===V||V,U=i.rotatable,H=void 0!==U&&U,W=i.previewer,Y=void 0!==W&&W,q=i.enableUniform,K=void 0!==q&&q,$=i.minUniformSize,z=void 0===$?15:$,G=i.annotRender,J=void 0===G?null:G,X=i.expansion,Z=void 0===X?{left:1,top:1,right:1,bottom:1}:X,Q=i.degreeInitVisibility,ee=void 0===Q||Q,te=i.resizeCompanions,ne=void 0!==te&&te,ie=i.onStatusChange,re=void 0===ie?j.noop:ie,oe=i.degree,ae=void 0===oe?0:oe,se=i.auxiliaryLine,ue=void 0===se?null:se;return(0,P._)(this,n),(e=t.call(this)).ui=function(e){var t=Object.keys(e).sort().map((function(t){return e[t]?1:0})).join("");if(t in $u)return $u[t].cloneNode(!0);var n=(new DOMParser).parseFromString(Cu()(e),"text/html").body.firstChild;return $u[t]=n,n.cloneNode(!0)}({enableDiagonally:R,resizable:N,enableFrame:F,rotatable:H,moveable:B,previewer:Y,enableSizeBox:O,degreeInitVisibility:ee}),e.emitter=r,e.onPrestart=a,e.onStart=u,e.onUpdate=l,e.onMoving=g,e.interceptor=h,e.onEnd=p,e.onAfterEnd=y,e.onBeforeRotateStart=_,e.onAfterRotateEnd=E,e.rotate=b,e.onRotateStart=S,e.onRotateEnd=C,e.enableUniform=K,e.minUniformSize=z,e.rotatable=H,e.moveable=B,e.enablePreviewer=Y,e.isDisabled=!1,e.isMoveDisabled=!1,e.enableDiagonally=R,e.enableFrame=F,e.enableSizeBox=O,e.resizable=N,e.annotRender=J,e.rotateCursorStyle="fv__cursor-rotation",e.rotateDegree=ae,e.isRotateStarted=!1,e.auxiliaryLine=ue,e.expansion=Z,e.resizeCompanions=ne,e.companions=[],e.degreeInitVisibility=ee,e.isActive=!1,e.onStatusChange=re,e}return(0,A._)(n,[{key:"init",value:function(){if(!this._isInitted){this._isInitted=!0;var e=this.ui.querySelector(".fv__shape-control-previewer");this.rotatingRod=this.ui.querySelector(".fv__shape-rotate"),this.shapeSizeBox=this.ui.querySelector(".fv__shape-size"),this.context=e.getContext("2d"),this.companionMargin={left:0,right:0,top:0,bottom:0},this.rotateDegreeBox=this.ui.querySelector(".fv-shape-rotate-degree"),this.updateRotateDegreeBox(this.rotateDegree),this.resizableWrap=this.ui.querySelector(".fv__shape-controller-resizable-wrap"),this.bindEvents()}}},{key:"companion",value:function(e){var t=this;if(e===this)return j.noop;var n="function"==typeof e.getCompanionObject?e.getCompanionObject():void 0;return n?-1!==this.companions.indexOf(n)||n.companions.indexOf(this)>-1?j.noop:(this.companions.push(n),this.updateMargin(),function(){var e=t.companions.indexOf(n);e>-1&&t.companions.splice(e,1)}):j.noop}},{key:"getCompanionObject",value:function(){return this}},{key:"updateMargin",value:function(){if(0===this.companions.length)return this.setMargin(this.originMargin),void(this.companionMargin={left:0,right:0,top:0,bottom:0});var e=this.shape.getRect(),t=e.left,n=e.right,i=e.top,r=e.bottom;this.companions.forEach((function(e){var o=e.shape.getRect();t=Math.min(o.left,t),i=Math.min(o.top,i),n=Math.max(o.right,n),r=Math.max(o.bottom,r)}));var o=e.left-t,a=n-e.right,s=e.top-i,u=r-e.bottom;this.companionMargin={left:o,right:a,top:s,bottom:u},this.originMargin=this.shape.marginBox;var c={left:Math.max(this.companionMargin.left,this.originMargin.left),right:Math.max(this.companionMargin.right,this.originMargin.right),top:Math.max(this.companionMargin.top,this.originMargin.top),bottom:Math.max(this.companionMargin.bottom,this.originMargin.bottom)};this.setMargin(c)}},{key:"clearCompanions",value:function(){this.companions.length=0,this.updateMargin()}},{key:"getPreviewerContext",value:function(){return this.context}},{key:"bindEvents",value:function(){var e=this,t=this.ui.querySelectorAll(".fv__shape-controller");Array.prototype.slice.call(t).forEach((function(t){return e._bindControllerEvents(t)})),this.moveable&&this._bindMoveAreaEvents(),this.rotatable&&this._bindRotateEvents()}},{key:"_resolveOffset",value:function(e,t,n){var i=this.ui.getBoundingClientRect();return n<0&&e.y>i.bottom&&(n=0),n>0&&e.y<i.top&&(n=0),t>0&&e.x<i.left&&(t=0),t<0&&e.x>i.right&&(t=0),{offsetX:t,offsetY:n}}},{key:"_bindControllerEvents",value:function(e){var t,i,r=this,o=new gr.Manager(e);o.add(new gr.Pan({direction:gr.DIRECTION_ALL})),o.on("panmove",(function(n){var o=n.deltaX,a=n.deltaY,s=n.center;if(!r.isDisabled&&r.isActive){var u=r._resolveOffset(s,o-t,a-i),c=u.offsetX,l=u.offsetY;t=o,i=a,r.resize(e.getAttribute("direction"),c,l),r._resizeSizeBox()}})),o.on("panstart",(function(n){var o=n.deltaX,a=n.deltaY,s=n.center;if(!r.isDisabled&&r.isActive){var u=r._resolveOffset(s,o,a),c=u.offsetX,l=u.offsetY;t=c,i=l,r.start(),r.resizeCompanions||r.setMargin({left:0,right:0,top:0,bottom:0}),r.resize(e.getAttribute("direction"),c,l,!0)}})),o.on("panend",(function(e){!r.isDisabled&&r.isActive&&r.end(n.ACTION_RESIZE)})),o.on("pancancel",(function(e){!r.isDisabled&&r.isActive&&r.cancel(n.ACTION_RESIZE)})),this.addDestroyHook((function(){o.destroy()}))}},{key:"_resizeSizeBox",value:function(){if(this.shapeSizeBox){var e=this.shape.getAdjustShape();e||(e=this.shape.shape);var t=parseInt(e.width),n=parseInt(e.height);this.shapeSizeBox.innerHTML=t<120?t+"px*"+n+"px":t<170?"W: "+t+"px, H: "+n+"px":"Width: "+t+"px, Height: "+n+"px",this.shapeSizeBox.style.top=n>100?"1px":"-22px"}}},{key:"_bindMoveAreaEvents",value:function(){var e,t,i=this,r=this.ui,o=new gr.Manager(r.querySelector(".fv__shape-control-move-area"),{domEvents:!0});o.add(new gr.Pan({direction:gr.DIRECTION_ALL})),o.on("panstart",(function(n){var r=n.deltaX,a=n.deltaY,s=n.center,u=n.srcEvent;if(!i.isDisabled&&!i.isMoveDisabled&&i.isActive){var c=o.element.getBoundingClientRect(),l=c.width,d=c.height;(l||d)&&(e=r,t=a,i.start(),i.trigger("movingstart",{deltaX:s.x+r,deltaY:s.y+a,srcEvent:u}),i.move(e,t,!0))}})),o.on("panend",(function(e){if(i.trigger("movingend",e),!i.isDisabled&&!i.isMoveDisabled&&i.isActive){var t=o.element.getBoundingClientRect(),r=t.width,a=t.height;(r||a)&&(i.end(n.ACTION_MOVE),i.auxiliaryLine&&i.shape.clearAuxiliaryLine(i.auxiliaryLine.container))}})),o.on("pancancel",(function(e){if(i.trigger("movingcancel"),!i.isDisabled&&!i.isMoveDisabled&&i.isActive){var t=o.element.getBoundingClientRect(),r=t.width,a=t.height;(r||a)&&(i.cancel(n.ACTION_MOVE),i.auxiliaryLine&&i.shape.clearAuxiliaryLine(i.auxiliaryLine.container))}})),o.on("panmove",(function(n){var r=n.deltaX,a=n.deltaY,s=n.center,u=n.direction;if(!i.isDisabled&&!i.isMoveDisabled&&i.isActive){var c=o.element.getBoundingClientRect(),l=c.width,d=c.height;if(l||d){var h=r-e,f=a-t;e=r,t=a;var g=i.ui.getBoundingClientRect(),v=g.left,p=g.right,m=g.top,y=g.bottom;s.x<v&&u&Hammer.DIRECTION_RIGHT&&(h=0),s.x>p&&u&Hammer.DIRECTION_LEFT&&(h=0),s.y<m&&u&Hammer.DIRECTION_DOWN&&(f=0),s.y>y&&u&Hammer.DIRECTION_UP&&(f=0),i.move(h,f,void 0,!0)}}})),this.addDestroyHook((function(){o.destroy()}))}},{key:"disable",value:function(){this.isDisabled=!0,this.ui.classList.add("disabled"),this.onStatusChange()}},{key:"enable",value:function(){this.isDisabled=!1,this.ui.classList.remove("disabled"),this.onStatusChange()}},{key:"moveDisable",value:function(){this.isMoveDisabled=!0,this.ui.classList.add("move-disabled"),this.onStatusChange()}},{key:"moveEnable",value:function(){this.moveable&&(this.isMoveDisabled=!1,this.ui.classList.remove("move-disabled"),this.onStatusChange())}},{key:"start",value:function(){this.isDisabled||(this.doStart(),this.onPrestart(),this.companions.forEach((function(e){return e.doStart()})))}},{key:"doStart",value:function(){this.ui.style.willChange="left, top, width, height",this.shape.process()}},{key:"move",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.isDisabled&&!this.isMoveDisabled){var o=this.shape.getAdjustRect();this.shape.adjustPosition(e,t);var a=this.getSnapRect(this.shape.getAdjustRect());if(a){var s=a.left-o.left,u=a.top-o.top;if(this.interceptor(this.shape.getAdjustShape())){if(this.auxiliaryLine&&r){var c=this.auxiliaryLine.getPageAnnots(),l=Object.assign({},a),d=this.auxiliaryLine.gap,h=this.auxiliaryLine.container,f=[this.shape.boundary],g={};g[this.shape.boundary.top+this.shape.boundary.left+this.shape.boundary.right+this.shape.boundary.bottom]=!0,this.companions.length&&this.companions.forEach((function(e){var t=e.getSnapRect(e.shape.getAdjustRect());l.left=Math.min(l.left,t.left),l.top=Math.min(l.top,t.top),l.right=Math.max(l.right,t.right),l.bottom=Math.max(l.bottom,t.bottom),f.push(e.shape.boundary),g[e.shape.boundary.top+e.shape.boundary.left+e.shape.boundary.right+e.shape.boundary.bottom]=!0}));var v=(c=c.filter((function(e){var t=e.rect;if(qu.indexOf(e.type)<0)return!1;if(!g[t.top+t.left+t.right+t.bottom])return!0;var n=!0,i=!1,r=void 0;try{for(var o,a=f[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.top==t.top&&s.left==t.left&&s.right==t.right&&s.bottom==t.bottom)return!1}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return!0}))).map((function(e){return e.rect})),p=this.shape.drawAuxiliaryLine(l,v,d,h),m=a.right-a.left,y=a.bottom-a.top;!this.companions.length&&p.top&&(a.top=p.top,a.bottom=a.top+y),!this.companions.length&&p.left&&(a.left=p.left,a.right=a.left+m),!this.companions.length&&p.right&&(a.right=p.right,a.left=a.right-m),!this.companions.length&&p.bottom&&(a.bottom=p.bottom,a.top=a.bottom-y),s=a.left-o.left,u=a.top-o.top}var k=this.getShapeFromRect(a);this.shape.applyAdjustingToDom(this.ui,k),i&&this.onStart(k,this.context,n.ACTION_MOVE),this.onMoving(k,this.context,{offsetLeft:s,offsetTop:u}),this.companions.forEach((function(e){return e.move(s,u,i)}))}else this.shape.undo()}}}},{key:"resize",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.isDisabled){switch(e){case Iu:case Ru:case Du:case Eu:case Fu:case Tu:case Ou:case Mu:break;default:throw new Error("Incorrect direction: ".concat(e))}if(this._resize(e,t,i),this.interceptor(this.shape.getAdjustShape())){var o=this.getShapeFromRect(this.getDirectionSnapRect(this.shape.getAdjustRect(),e));this.shape.applyAdjustingToDom(this.ui,o),this._updatePreviewer(),r&&this.onStart(o,this.context,n.ACTION_RESIZE),this.onUpdate(o,this.context,{offsetLeft:t,offsetTop:i,direction:e}),this.resizeCompanions&&this.companions.forEach((function(n){return n.resize(e,t,i,r)}))}else this.shape.undo()}}},{key:"end",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(this.isDisabled||e===Yu&&this.isMoveDisabled)){t=t==this.companions.length,this.ui.style.willChange="auto";var i=this.shape.getAdjustRect();if(i){var r=this.getShapeFromRect(e===n.ACTION_MOVE?this.getSnapRect(i):this.getDirectionSnapRect(i));this.onEnd(r,this.context,e,t),this.shape.end(),this.shape.applyToDom(this.ui,r),(e!=n.ACTION_RESIZE||this.resizeCompanions)&&this.companions.forEach((function(t,n){return t.end(e,n)}))}this.onAfterEnd(e)}}},{key:"cancel",value:function(e){this.isDisabled||(this.shape.cancel(),this.shape.applyToDom(this.ui),this.onEnd(this.shape.getShape(),this.context,e),this.companions.forEach((function(t){return t.cancel(e)})),this.onAfterEnd(e))}},{key:"rotateStart",value:function(e,t){var n=this.ui.getBoundingClientRect(),i={x:n.left+.5*n.width,y:n.top+.5*n.height};this.rotateStartPoint={x:e,y:t},this.rotationOffsetCenter=i,this.onRotateStart(this.rotateDegree,this.shape,this.context),this.companions.forEach((function(n){n.isRotateStarted=!0,n.rotateStart(e,t)}))}},{key:"rotating",value:function(e,t){if(this.isRotateStarted){var n=this.rotateStartPoint,i=n.x,r=n.y,o=this.offsetDegree=this.getAngle(i,r,e,t);this.ui.style.transform="rotate(".concat(o,"deg)"),this.updateRotateDegreeBox(o),this.rotate(o,this.rotateDegree),this.companions.forEach((function(e){e.ui.style.transform="rotate(".concat(o,"deg)"),e.updateRotateDegreeBox(o),e.rotate(o,e.rotateDegree)}))}}},{key:"getAngle",value:function(e,t,n,i){var r,o=this.rotationOffsetCenter,a=o.x,s=o.y,u=180*Math.atan2(t-s,e-a)/Math.PI,c=180*Math.atan2(i-s,n-a)/Math.PI;return u=u<=-90?360+u:u,c=c<=-90?360+c:c,r=(r=Math.floor(c-u))<0?r+360:r}},{key:"rotateEnd",value:function(){var e=this;this.isRotateStarted&&(this.isRotateStarted=!1,this.rotateDegree+=this.offsetDegree,this.onRotateEnd(this.rotateDegree,this.offsetDegree,this.shape,this.context).then((function(t){e.rotatingRod.style.transform="rotate(".concat(t,"deg)")})),this.companions.forEach((function(e){e.rotateEnd()})))}},{key:"moveDirectly",value:function(e,t){if(!this.isDisabled){this.start();try{this.move(e,t,!0)}catch(e){throw this.cancel(),e}this.end()}}},{key:"resizeDirectly",value:function(e,t,n){if(!this.isDisabled){this.start();try{this.resize(e,t,n,!0)}catch(e){throw this.cancel(),e}this.end()}}},{key:"_updatePreviewer",value:function(){if(this.enablePreviewer){var e=this.ui.querySelector(".fv__shape-control-previewer");e.setAttribute("width",this.ui.offsetWidth),e.setAttribute("height",this.ui.offsetHeight)}}},{key:"hidePreviewer",value:function(){}},{key:"showPreviewer",value:function(){}},{key:"hide",value:function(){this.ui.style.display="none"}},{key:"show",value:function(){this.ui.style.display="block"}},{key:"_resize",value:function(e,t,n){var i,r=this.ui;switch(i=this.enableUniform?Hu.ADJUST_MODE_UNIFORM:j.keyboardStatus.isShift?Hu.ADJUST_MODE_SQUARE:Hu.ADJUST_MODE_FREE,e){case Du:o(e,this.shape.adjustNorth(n,i));break;case Eu:o(e,this.shape.adjustSouth(n,i));break;case Iu:o(e,this.shape.adjustEast(t,i));break;case Ru:o(e,this.shape.adjustWest(t,i));break;case Tu:o(e,this.shape.adjustNorthWest(t,n,i,this.minUniformSize));break;case Fu:o(e,this.shape.adjustNorthEast(t,n,i,this.minUniformSize));break;case Mu:o(e,this.shape.adjustSouthWest(t,n,i,this.minUniformSize));break;case Ou:o(e,this.shape.adjustSouthEast(t,n,i,this.minUniformSize));break;default:throw new Error("Incorrect direction: "+e)}function o(e,t){if(e!==t){var n=r.querySelector("[direction=".concat(t,"]")),i=r.querySelector("[direction=".concat(e,"]"));n.setAttribute("direction",e),i.setAttribute("direction",t)}}}},{key:"active",value:function(e,t,n){if(this.init(),this._applyAnnotBoundary(t),e){var i=(0,D._)(e,Element)?e:e.get(0);this.ui.parentElement!==i&&i.appendChild(this.ui)}var r=!!this.shape&&this.shape.processing;this.shape=new Hu({left:t.left,top:t.top,right:t.left+t.width,bottom:t.top+t.height,box:n,expansion:this.expansion}),r&&this.shape.process(),this.originMargin=this.shape.marginBox,this._updatePreviewer(),this._resizeSizeBox(),this.updateRotateDegreeBox(this.rotateDegree),this.rotatingRod&&(this.rotatingRod.style.transform="rotate(".concat(this.rotateDegree,"deg)")),this.isActive=!0}},{key:"updateRotateDegreeBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(e=parseInt(e))>180&&(e-=360),e*=-1,this.rotateDegreeBox&&(this.rotateDegreeBox.innerHTML=e+"°",this.rotateDegreeBox.style.transform="rotate(".concat(e,"deg)"))}},{key:"updateBoundary",value:function(e,t){Object.assign(this.shape.boundary,e),this._applyAnnotBoundary(this.shape.boundary),t&&this.updateBoundaryBox(t),this._updatePreviewer()}},{key:"setMargin",value:function(e){e&&this.shape&&this.shape.setMargin(e)}},{key:"updateBoundaryBox",value:function(e){this.shape.setBoundaryBox(e)}},{key:"getCurrentShape",value:function(){return this.shape.getShape()}},{key:"getAdjustingShape",value:function(){return this.shape.getAdjustShape()}},{key:"getAdjustedOffset",value:function(){var e=this.getAdjustedRectDiff();return{offsetLeft:e.left,offsetTop:e.top}}},{key:"getAdjustedRectDiff",value:function(){return Ra.subtract(this.shape.getAdjustRect(),this.shape.getRect())}},{key:"deactive",value:function(){this.ui.parentNode&&this.ui.parentNode.removeChild(this.ui),this.isActive=!1}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.disable(),this.ui.parentNode&&this.ui.parentNode.removeChild(this.ui)}},{key:"_applyAnnotBoundary",value:function(e){var t=e.left,n=e.top,i=e.width,r=e.height,o=this.expansion;this.ui.style.cssText+="\n            width: ".concat(i+(o.left+o.right),"px;\n            height: ").concat(r+(o.top+o.bottom),"px;\n            left: ").concat(t-o.left,"px;\n            top: ").concat(n-o.top,"px;\n            ")}},{key:"_bindRotateEvents",value:function(){var e=this,t=this.ui.querySelector(".fv-shape-rotate-handle"),n=new gr.Manager(t);n.add(new gr.Pan({direction:gr.DIRECTION_ALL}));n.on("panstart",(function(t){var n=t.center;!e.isDisabled&&e.isActive&&(e.onBeforeRotateStart(),e.isRotateStarted=!0,e.companions.forEach((function(e){return e.isRotateStarted=!0})),e.rotateStart(n.x,n.y))})),n.on("panend",(function(t){t.deltaX,t.deltaY;!e.isDisabled&&e.isRotateStarted&&(e.rotateEnd(),e.onAfterRotateEnd())})),n.on("pancancel",(function(e){Ku.debug("rotate c")})),n.on("panmove",(function(t){t.deltaX,t.deltaY;var n=t.center;!e.isDisabled&&e.isRotateStarted&&e.rotating(n.x,n.y)}))}},{key:"trigger",value:function(e,t){var n=this.emitter;n&&n.emit(e,t)}},{key:"setSnapGrid",value:function(e){this.snapGrid=e}},{key:"getSnapGrid",value:function(){return this.snapGrid}},{key:"getSnapMaxRect",value:function(e){if(!e)return e;var t=this.getSnapGrid();if(!t)return e;var n=e.left,i=e.right,r=e.top,o=e.bottom,a=t.offsetLeft,s=t.offsetTop,u=t.subLineWidth,c=t.subLineHeight,l=t.maxWidth,d=t.maxHeight,h=(n-a)%u,f=(r-s)%c;return h<0&&(h+=a),i+=Math.abs((i-a)%u-u)%u,f<0&&(f+=s),o+=Math.abs((o-s)%c-c)%c,{left:n-=h,right:i=Math.min(l,i),top:r-=f,bottom:o=Math.min(d,o)}}},{key:"getSnapRect",value:function(e){if(!e)return e;var t=this.getSnapGrid();if(!t)return e;var n=t.maxWidth,i=t.maxHeight,r=e.left,o=e.right,a=e.top,s=e.bottom;if(r<=0||a<=0||o>=n||s>=i)return e;var u=t.offsetLeft,c=t.offsetTop,l=t.subLineWidth,d=t.subLineHeight,h=(r-u)%l,f=Math.abs(h-l)%l,g=(o-u)%l,v=Math.abs(g-l)%l,p=(a-c)%d,m=Math.abs(p-d)%d,y=(s-c)%d,k=Math.abs(y-d)%d,b=Math.min(h,g),w=Math.min(f,v),_=Math.min(p,y),P=Math.min(m,k);return b<w?(r-=b,o-=b):(r+=w,o+=w),_<P?(a-=_,s-=_):(a+=P,s+=P),{left:r,right:o,top:a,bottom:s}}},{key:"getDirectionSnapRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastDirection;if(this.lastDirection=t,!e)return e;var n=this.getSnapGrid();if(!n)return e;var i=n.offsetLeft,r=n.offsetTop,o=n.subLineWidth,a=n.subLineHeight,s=n.maxWidth,u=n.maxHeight,c=e.left,l=e.right,d=e.top,h=e.bottom;if(c<=0||d<=0||l>=s||h>=u)return e.left=Math.max(0,c),e.right=Math.min(s,l),e.top=Math.max(0,d),e.bottom=Math.min(u,h),e;var f=(c-i)%o,g=Math.abs((l-i)%o-o)%o,v=(d-r)%a,p=Math.abs((h-r)%a-a)%a;switch(t){case Du:d-=v;break;case Eu:h+=p;break;case Iu:l+=g;break;case Ru:c-=f;break;case Tu:c-=f,d-=v;break;case Fu:l+=g,d-=v;break;case Mu:c-=f,h+=p;break;case Ou:l+=g,h+=p;break;default:throw new Error("Incorrect direction: "+t)}return{left:c,right:l,top:d,bottom:h}}},{key:"getShapeFromRect",value:function(e){if(e){var t=e.left,n=e.top;return{left:t,top:n,width:e.right-t,height:e.bottom-n}}}},{key:"updateResizable",value:function(e){this.resizableWrap.style.visibility=e?"visible":"hidden"}}],[{key:"ACTION_RESIZE",get:function(){return"resize"}},{key:"ACTION_MOVE",get:function(){return Yu}}]),n}(j.Disposable),Gu=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pu;return{selector:arguments.length>1&&void 0!==arguments[1]?arguments[1]:".fv__pdf-page-annot-handler-rect",items:{copy:{name:"copy",nameI18nKey:"viewer_:contextmenu.annot.copy",callback:function(t,n,i){this.data(e).copyText()},visible:function(){var t=this.data(e);if(!t.annot.isArea())return!t.annot.isReplace||!t.annot.isReplace()}},reply:{name:"reply",nameI18nKey:"viewer_:contextmenu.annot.reply",callback:function(){this.data(e).showReplyDialog("reply")},disabled:function(){return this.data(e).replyDisabled()}},properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(t,n,i){this.data(e).showPropertiesDialog(t,n,i)}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(e).removeAnnot()},disabled:function(){return this.data(Pu).deleteDisabled()}}},events:{show:function(){return this.data(Pu).updateDeleteStatus(!0),!0},hide:function(){return this.data(Pu).updateDeleteStatus(!1),!0}}}}(Pu,".fv__pdf-page-annot-handler-rect"),Ju=Su()({direction:"left"}),Xu=Su()({direction:"right"}),Zu="px",Qu=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;if((0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="textmarkup",a.$ui.addClass("fv__pdf-page-textmarkup-annot-container"),a.$handler.addClass("fv__pdf-page-textmarkup-annot-handler-container"),a.annot.isArea())a.createShapeControl();else{var s=function(e,t,n){n===en.flagsUpdated?a.getAppPermission().then((function(e){(e.ignorable()||e.isAdjustable())&&!a.moveDisabled()?a.boundaryEnabled():a.boundaryDisabled()})):n===en.quadPointsUpdated&&a.activeRect(e[0])};a.pdfViewer.eventEmitter.on(de.annotationUpdated,s),a.addDestroyHook((function(){a.pdfViewer.eventEmitter.off(de.annotationUpdated,s)}))}return a}return(0,A._)(n,[{key:"redraw",value:function(e){var t=this;return this.getAppPermission().then((function(e){(e.ignorable()||e.isAdjustable())&&!t.moveDisabled()?t.boundaryEnabled():t.boundaryDisabled()})),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"createShapeControl",value:function(){var e=this;j.Lazy.property(this,"shapeControl",(function(){var t={moveable:!1,resizable:!0,enableDiagonally:!0},n=e.pdfViewer.customs.getAnnotComponentConfig(e,Object.keys(t)),i={start:function(){return e.onStartUpdateShape()},update:function(t,n){return e.onShapeUpdating(t,n)},moving:function(t,n){return e.onShapeMoving(t,n)},end:function(t,n,i){return e.onShapeUpdateEnd(t,n,i)},auxiliaryLine:void 0};e.annot.isReplace()&&(i.moveable=!1),e.annot.isArea()&&(i.emitter=e.pdfViewer.eventEmitter,i=Object.assign(t,n,i));var r=new zu(i);return e.processShapeControlPermissionCtrl(r),e.addDestroyHook((function(){r.destroy()})),r}))}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.annot.isArea()&&!this.shapeControl&&this.createShapeControl(),this.shapeControl.active(this.$handler,this.getBoundary(),e)}},{key:"active",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"active",this).call(this);var t=this.annot.isArea();this.$rect&&(this.$rect.remove(),this.$rect=null),this.getAppPermission().then((function(n){var i=!0;i=(n.ignorable()||n.isAdjustable())&&!e.moveDisabled(),t?(e.activeRect(),e.$rect.addClass("active"),e._applyShapeChange(),e.boundaryRemove(),i?e.shapeControl.enable():e.shapeControl.disable()):(e.activeTextBoundary(),i?e.boundaryEnabled():e.boundaryDisabled())}))}},{key:"unActive",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.annot.isArea()&&this.$rect&&this.$rect.removeClass("active"),this.annot.isGrouped()&&this.annot.groupElements.map((function(t){var n=e.pdfViewer.getAnnotRender(t.getPDFPage().getIndex(),t.getId()),i=n&&n.component;i&&i.isActive&&i.unActive&&i.unActive(),i&&i.deactive&&i.deactive()}))}},{key:"afterRender",value:function(e){var t=e.transformed;(this.$ui.find("canvas").css({width:"",height:""}),t&&this.isActive)&&(this.annot.isArea()?(this.activeRect(),this._applyShapeChange()):this.activeTextBoundary())}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"createRectDom",value:function(){return this.annot.isArea()?(!this.shapeControl&&this.createShapeControl(),this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui):(0,S._)((0,x._)(n.prototype),"createRectDom",this).call(this)}},{key:"copyText",value:function(){var e=this,t=this.annot.getContinuousText();return(0,j.copyText)(t).then((function(n){return n?e.pdfViewer.eventEmitter.emit(de.copyTextSuccess,t):e.pdfViewer.eventEmitter.emit(de.copyTextFailed,t),n}))}},{key:"getBoundaryCss_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.getCharQuadPoints_(e),i=this.getCssTransform_(e),r=(0,U.F2)(this.getQuadPointsHeight_(n))/j.dpr,o=this.getPDFPage(),a=this.scale,s=this.rotate,u=o.getDeviceMatrix(s);u.scale(a,a);var c=[Math.min,Math.max][t](n[0].x,n[1].x,n[2].x,n[3].x),l=[Math.max,Math.min][t](n[0].y,n[1].y,n[2].y,n[3].y),d=u.transformPoint(c,l);return{transform:i,height:r,left:d[0],top:d[1]}}},{key:"getCssTransform_",value:function(e){return"rotate("+(90*(e.rotation+this.annot.getPDFPage().getRotation())+this.rotate)+"deg)"}},{key:"getCharQuadPoints_",value:function(e){return(0,this.annot.engine.getUtils().getQuadPointsFromRect)(e,e.rotation)}},{key:"getQuadPointsHeight_",value:function(e){return Math.sqrt(Math.pow(e[2].x-e[0].x,2)+Math.pow(e[2].y-e[0].y,2))}},{key:"activeTextBoundary",value:function(){var e=this,t=this.annot,n=t.getStartCharInfo(),i=t.getEndCharInfo();if(n&&i){var r=this.$leftTextBoundary=this.$leftTextBoundary||this.leftTextBoundaryInit(),o=this.$rightTextBoundary=this.$rightTextBoundary||this.rightTextBoundaryInit(),a=this.getBoundaryCss_(n),s=0;1!=n.rotation&&3!=n.rotation||(s=a.height),r.css({height:a.height+Zu,transform:a.transform,top:a.top+Zu,left:a.left+s+Zu});var u=this.getBoundaryCss_(i,1);s=0,1!=i.rotation&&3!=i.rotation||(s=u.height),o.css({height:u.height+Zu,transform:u.transform,top:u.top-u.height+Zu,left:u.left-s+Zu})}this.activeRect(t),this.$rect.on("click.unactive",(function(t){e.isActive&&t.originalEvent.isTrusted&&0===t.button&&!t.shiftKey&&t.ctrlKey&&e.unActive()}))}},{key:"leftTextBoundaryInit",value:function(){var e,t,n,i,r,o=this,a=this.$handler,s=O()(Ju),u=s[0],c=new(vr())(u);c.get("pan").set({direction:vr().DIRECTION_ALL});var l=function(){n&&s.css({left:n.left+Zu,top:n.top+Zu,height:n.height+Zu,transform:n.transform})};return c.on("panstart",(function(t){!1!==o.onLeftPanStart(t)&&(i=o.scale,r=o.rotate,e={left:parseFloat(s.css("left")),top:parseFloat(s.css("top")),height:parseFloat(s.css("height")),transform:s.css("transform")},n=e,o.textBoundaryStart())})),c.on("panmove",(function(a){if(!1!==o.onLeftPanMove(a)){var u=a.deltaX,c=a.deltaY;if(o.pdfViewer.config.highPerformance){var d=e.height;c+=d/2;var h=o.getPDFPage().reverseDevicePoint([e.left+u,e.top+c],i,r),f=o.annot,g=o.editDebouncePromise=o.editDebouncePromise||new fe;g.push((function(){return o.getPDFPage().getCharInfoAtPoint(h,d/2/(0,U.F2)(i)).then((function(e){if(!e)return l(),[!1];var n=e.charIndex,i=f.getEndCharIndex();if(n>i)return l(),Promise.resolve([!1]);t=o.getBoundaryCss_(e);var r=0;1!=e.rotation&&3!=e.rotation||(r=t.height);var a={left:t.left+r+Zu,top:t.top+Zu,height:t.height+Zu,transform:t.transform};return Promise.all([f.updateQuadPointsByCharIndex(n,i),e,a])})).then((function(e){var i=(0,E._)(e,3),r=i[0],a=i[1],u=i[2];if(r)return s.css(u),t&&(n=t),o.updateRender().then((function(){return o.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,o),o.onLeftChangeSuccess(a)}));l()}),(function(){l()}))})),g.exec()}else s.css({left:n.left+u+Zu,top:n.top+c+Zu})}})),c.on("panend",(function(a){if(!1!==o.onLeftPanEnd(a)){var u=a.deltaX,c=a.deltaY,d=e.height;c+=d/2;var h=o.getPDFPage().reverseDevicePoint([e.left+u,e.top+c],i,r),f=o.annot,g=o.editDebouncePromise=o.editDebouncePromise||new fe;g.push((function(){return o.getPDFPage().getCharInfoAtPoint(h,d/2/(0,U.F2)(i)).then((function(e){if(!e)return l(),[!1];var n=e.charIndex,i=f.getEndCharIndex();if(n>i)return Promise.resolve([!1]);t=o.getBoundaryCss_(e);var r=0;return 1!=e.rotation&&3!=e.rotation||(r=t.height),s.css({left:t.left+r+Zu,top:t.top+Zu,height:t.height+Zu,transform:t.transform}),Promise.all([f.updateQuadPointsByCharIndex(n,i),e])})).then((function(e){var i=(0,E._)(e,2),r=i[0],a=i[1];if(r)return t&&(n=t),o.updateRender().then((function(){return o.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,o),o.textBoundaryEnd(),o.onLeftChangeSuccess(a)}));l()}),(function(){l()}))})),g.exec()}})),this.leftHammer=c,a.append(s),this.addDestroyHook((function(){c.destroy()})),s}},{key:"rightTextBoundaryInit",value:function(){var e,t,n,i,r,o=this,a=this.$handler,s=O()(Xu),u=s[0],c=new(vr())(u);c.get("pan").set({direction:vr().DIRECTION_ALL});var l=function(){n&&s.css({left:n.left+Zu,top:n.top-t.height+Zu,height:n.height+Zu,transform:t.transform})};return c.on("panstart",(function(t){!1!==o.onRightPanStart(t)&&(i=o.scale,r=o.rotate,e={left:parseFloat(s.css("left")),top:parseFloat(s.css("top")),height:parseFloat(s.css("height")),transform:s.css("transform")},n=e,o.textBoundaryStart())})),c.on("panmove",(function(a){if(!1!==o.onRightPanMove(a)){var u=a.deltaX,c=a.deltaY;if(o.pdfViewer.config.highPerformance)s.css({left:n.left+u+Zu,top:n.top+c+Zu});else{var d=e.height;c+=d/2;var h=o.getPDFPage().reverseDevicePoint([e.left+u,e.top+d+c],i,r),f=o.annot,g=o.editDebouncePromise=o.editDebouncePromise||new fe;g.push((function(){return o.getPDFPage().getCharInfoAtPoint(h,d/2/(0,U.F2)(i)).then((function(e){if(!e)return l(),[!1];var n=f.getStartCharIndex(),i=e.charIndex;if(n>i)return l(),Promise.resolve([!1]);t=o.getBoundaryCss_(e,1);var r=0;return 1!=e.rotation&&3!=e.rotation||(r=t.height),s.css({left:t.left-r+Zu,top:t.top-t.height+Zu,height:t.height+Zu,transform:t.transform}),Promise.all([f.updateQuadPointsByCharIndex(n,i),e])})).then((function(e){var i=(0,E._)(e,2),r=i[0],a=i[1];if(r)return t&&(n=t),o.updateRender().then((function(){return o.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,o),o.onRightChangeSuccess(a)}));l()}),(function(){l()}))})),g.exec()}}})),c.on("panend",(function(a){if(!1!==o.onRightPanEnd(a)){var u=a.deltaX,c=a.deltaY,d=e.height;c-=d/2;var h=o.getPDFPage().reverseDevicePoint([e.left+u,e.top+d+c],i,r),f=o.annot,g=o.editDebouncePromise=o.editDebouncePromise||new fe;g.push((function(){return o.getPDFPage().getCharInfoAtPoint(h,d/2/(0,U.F2)(i)).then((function(e){if(!e)return o.textBoundaryEnd(),l(),[!1];var n=f.getStartCharIndex(),i=e.charIndex;if(n>i)return l(),Promise.resolve([!1]);t=o.getBoundaryCss_(e,1);var r=0;return 1!=e.rotation&&3!=e.rotation||(r=t.height),s.css({left:t.left-r+Zu,top:t.top-t.height+Zu,height:t.height+Zu,transform:t.transform}),Promise.all([f.updateQuadPointsByCharIndex(n,i),e])})).then((function(e){var i=(0,E._)(e,2),r=i[0],a=i[1];if(r)return t&&(n=t),o.updateRender().then((function(){return o.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,o),o.textBoundaryEnd(),o.onRightChangeSuccess(a)}));l()}),(function(){l()}))})),g.exec()}})),this.rightHammer=c,a.append(s),this.addDestroyHook((function(){c.destroy()})),s}},{key:"textBoundaryStart",value:function(){}},{key:"textBoundaryEnd",value:function(){}},{key:"boundaryDisabled",value:function(){this.toggleBoundary(!1)}},{key:"boundaryEnabled",value:function(){this.toggleBoundary(!0)}},{key:"toggleBoundary",value:function(e){this.$leftTextBoundary&&(this.$leftTextBoundary.toggleClass("ban",!e),this.$rightTextBoundary.toggleClass("ban",!e),this.leftHammer.get("pan").set({enable:e}),this.rightHammer.get("pan").set({enable:e}))}},{key:"onStartUpdateShape",value:function(){this.pdfViewer.config.highPerformance&&this.annot.isArea()&&(this.editAreaDebouncePromise=new j.DebounceAsyncTaskExecutor(10))}},{key:"onShapeUpdating",value:function(e,t){var n=this;this.updateCollabOp(e),this.pdfViewer.config.highPerformance&&this.annot.isArea()&&this.editAreaDebouncePromise.exec((function(){return n.setRect(e)}))}},{key:"onShapeMoving",value:function(e,t){this.updateCollabOp(e)}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editAreaDebouncePromise?this.editAreaDebouncePromise.waitForLastTask().then((function(){return i.setRect(e).then((function(e){"move"==n&&i.pdfViewer.eventEmitter.emit(de.annotationMovedPosition,[i.annot],i.getPDFPage(),i.annot)}))})):this.setRect(e).then((function(e){"move"==n&&i.pdfViewer.eventEmitter.emit(de.annotationMovedPosition,[i.annot],i.getPDFPage(),i.annot)}))}},{key:"onLeftPanStart",value:function(e){}},{key:"onLeftPanMove",value:function(e){}},{key:"onLeftChangeSuccess",value:function(){this.updateCollabOp()}},{key:"onLeftPanEnd",value:function(e){}},{key:"onRightPanStart",value:function(e){}},{key:"onRightPanMove",value:function(e){}},{key:"updateCollabOp",value:function(e){}},{key:"onRightChangeSuccess",value:function(){return this.updateCollabOp(),Promise.resolve()}},{key:"onRightPanEnd",value:function(e){}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{quadPoints:this.annot.getQuadPoints()})}},{key:"boundaryRemove",value:function(){this.$leftTextBoundary&&(this.$leftTextBoundary.remove(),this.$leftTextBoundary=null,this.leftHammer.destroy(),this.leftHammer=null),this.$rightTextBoundary&&(this.$rightTextBoundary.remove(),this.$rightTextBoundary=null,this.rightHammer.destroy(),this.rightHammer=null)}}],[{key:"getDefaultContextMenuConfig",value:function(){return Gu}}]),n}(ku);const ec=Qu;var tc=function(){function e(t){(0,P._)(this,e),this.component=t,this.prepared=!1}return(0,A._)(e,[{key:"prepare",value:function(){this.prepared||(this.prepared=!0,this.doPrepare())}},{key:"doPrepare",value:function(){}},{key:"show",value:function(){this.prepared&&this.doShow()}},{key:"doShow",value:function(){}},{key:"hide",value:function(){this.prepared&&this.doHide()}},{key:"doHide",value:function(){}},{key:"destroy",value:function(){this.component=null,this.prepared=!1}},{key:"willRender",value:function(){}},{key:"afterRender",value:function(){}},{key:"render",value:function(e,t,n){return this.prepared||this.prepare(),this.doRender(e,t,n)}},{key:"doRender",value:function(e,t){return Promise.resolve()}},{key:"numberToRGBAString",value:function(e){var t=(0,j.convertFromNumberToRGBA)(e);return"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}},{key:"invisibleRender",value:function(){}}]),e}(),nc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,A._)(n,[{key:"prepare",value:function(){this.prepared||(this.canvas=document.createElement("canvas"),this.container=this.component.getContainerElement(),this.container.appendChild(this.canvas),(0,S._)((0,x._)(n.prototype),"prepare",this).call(this))}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.prepared&&this.canvas.remove()}},{key:"doShow",value:function(){this.canvas.classList.remove("fv__ui-hide")}},{key:"doHide",value:function(){this.canvas.classList.add("fv__ui-hide")}},{key:"convertPointToPixel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Ai.convertTo(e,Ti)*t}},{key:"willRender",value:function(){this.canvas.style.willChange="left, top, width, height",this.container.style.willChange="left; top"}},{key:"afterRender",value:function(){this.canvas.style.willChange="auto",this.container.style.willChange="auto"}},{key:"render",value:function(e,t){this.prepared||this.prepare();var n=this.component.getRenderingData(e,t);if(!n)return Promise.resolve();var i=n.annotInfo,r=i.borderInfo||{},o=this.convertPointToPixel(r.width,e),a=n.smartScale;!n.annotFlag.checkNoZoom()||(e=1);var s=n.rect,u=n.outerDeviceRect,c=n.innerDeviceRect;Object.assign(c,{width:c.right-c.left,height:c.bottom-c.top}),Object.assign(u,{width:u.right-u.left,height:u.bottom-u.top}),this.resetCanvasSize(u.width,u.height),this.container.style.cssText+="\n            left: ".concat(s.left,"px;\n            top: ").concat(s.top,"px;\n        ");var l=this.canvas.style;if(0===o&&0===i.borderColor&&!i.fillColor)return l.visibility="hidden",Promise.resolve();if(0===i.opacity)return l.visibility="hidden",Promise.resolve();l.visibility="unset";try{return Promise.resolve(this.doRender({outerRect:u,innerRect:c,deviceRect:s,scale:e,smartScale:a,rotate:t,renderingData:n}))}catch(e){return console.error(e),Promise.resolve()}}},{key:"doRender",value:function(e){e.outerRect,e.innerRect,e.deviceRect,e.scale,e.rotate}},{key:"resetCanvasSize",value:function(e,t){this.canvas.width=Math.ceil(e),this.canvas.height=Math.ceil(t),this.canvas.style.width=null,this.canvas.style.height=null}},{key:"invisibleRender",value:function(){this.canvas&&(this.canvas.width=0)}}]),n}(tc),ic=(function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).lastRenderPromise=Promise.resolve(),i.lastX=0,i.lastY=0,i}(0,A._)(n,[{key:"resetCanvasSize",value:function(){}},{key:"closeTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-4;return Math.abs(e-t)<n}},{key:"render",value:function(e,t){var i=this;this.prepared||this.prepare();var r=this.component,o=r.getRenderingData(e,t),a=(o.page,this.canvas.getContext("2d",{willReadFrequently:!0}));if(this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()){var s=this.canvas.getContext("2d");return s.clearRect(0,0,this.canvas.width,this.canvas.height),void s.save()}var u=(0,E._)(o.tileConfig,10),c=(u[0],u[1],u[2],u[3],u[4],u[5]),l=(u[6],u[7],u[8]),d=u[9],h=(o.rect,o.engineRenderingRect),f=o.outerDeviceRect,g=f.right-f.left,v=f.bottom-f.top,p=h.right-h.left,m=h.bottom-h.top;if((!this.closeTo(h.left,this.lastX)||!this.closeTo(h.top,this.lastY))&&this.canvas.width){var y=h.left-this.lastX,k=h.top-this.lastY,b=a.getImageData(0,0,this.canvas.width,this.canvas.height);(0,S._)((0,x._)(n.prototype),"resetCanvasSize",this).call(this,p,m),this.canvas.style.cssText+="width: ".concat(g,"px;height: ").concat(v,"px;"),this.container.style.cssText+="\n                left: ".concat(f.left,"px;\n                top: ").concat(f.top,"px;\n            "),a.putImageData(b,-y,-k)}return this.lastX=h.left,this.lastY=h.top,r.getPDFPage().getPageAndHighlightBitmap((0,U.F2)(c),t,{x:Math.ceil(l*c),y:Math.ceil(d*c),width:p,height:m}).then((function(e){var t=e.buffer,r=e.width,o=e.height,s=e.image;if(s){var u=new Image;u.onload=function(){a.drawImage(u,0,0,r,o),URL.revokeObjectURL(u.src)},u.src=URL.createObjectURL(s)}else{var c=new(Uint8ClampedArray||Uint8Array)(t),l=a.createImageData(r,o);l.data.set(c),(0,S._)((0,x._)(n.prototype),"resetCanvasSize",i).call(i,r,o),i.container.style.cssText+="\n                    left: ".concat(f.left,"px;\n                    top: ").concat(f.top,"px;\n                "),i.canvas.style.cssText+="width: ".concat(g,"px;height: ").concat(v,"px;"),a.putImageData(l,0,0)}}))}}])}(nc),function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"convertToCanvasBasedPoint",value:function(e,t,n,i,r,o){var a=(0,E._)(r.getDevicePoint([e,t],i,o),2),s=a[0],u=a[1];return{x:s-n.left,y:u-n.top}}},{key:"doRender",value:function(e){var t=this,n=e.scale,i=e.renderingData,r=e.rotate,o=i.page,a=i.annotInfo,s=a.startCharInfo,u=a.endCharInfo,c=i.quadPoints,l=i.outerDeviceRect;if(!s){var d=c[0];s={left:d[0].x,top:d[0].y,right:d[1].x,bottom:d[2].y}}if(!u){var h=c[c.length-1];u={left:h[0].x,top:h[0].y,right:h[1].x,bottom:h[2].y}}var f=c.map((function(e,i){var a,s,u,c,d=e.map((function(e){return t.convertToCanvasBasedPoint(e.x,e.y,l,n,o,r)})),h=d.map((function(e){return e.x})),f=d.map((function(e){return e.y})),g=(a=Math).min.apply(a,(0,I._)(h)),v=(s=Math).max.apply(s,(0,I._)(h)),p=(u=Math).max.apply(u,(0,I._)(f)),m=(c=Math).min.apply(c,(0,I._)(f));return{left:g,right:v,bottom:p,top:m,width:v-g,height:p-m,textBlockHeight:p-m}}));e.quadRects=f}}]),n}(nc)),rc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).lastX=0,i.lastY=0,i}return(0,A._)(n,[{key:"prepare",value:function(){(0,S._)((0,x._)(n.prototype),"prepare",this).call(this),j.isChrome||j.isFirefox||j.isSafari||j.isChromiumEdge||(this.canvas.style.cssText+='\n            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";\n            -ms-filter: alpha(opacity=50);\n            filter: alpha(opacity=50);\n            -moz-opacity: 0.5;\n            -khtml-opacity: 0.5;\n            opacity: 0.5;\n        ')}},{key:"doRender",value:function(e){e.smartScale,e.scale,this.component;var t=e.renderingData,i=t.annotInfo;if(this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()){var r=this.canvas.getContext("2d");return r.clearRect(0,0,this.canvas.width,this.canvas.height),void r.save()}if(0!=i.hasBorderColor){var o=this.canvas.getContext("2d"),a=t.outerDeviceRect,s=a.right-a.left,u=a.bottom-a.top;if(this.container.style.cssText+="\n                left: ".concat(a.left,"px;\n                top: ").concat(a.top,"px;\n            "),this.canvas.style.cssText+="width: ".concat(s,"px;height: ").concat(u,"px;"),o.save(),o.fillStyle=this.numberToRGBAString(i.color),o.globalAlpha=t.opacity,t.isArea)o.fillRect(0,0,this.canvas.width,this.canvas.height);else(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e),e.quadRects.forEach((function(e){o.fillRect(e.left,e.top,e.width,e.textBlockHeight)}));o.restore()}}}]),n}(ic),oc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="highlight",a.$ui.addClass("fv__pdf-page-highlight-annot-container"),a.$handler.addClass("fv__pdf-page-highlight-annot-handler-container"),a}return(0,A._)(n,[{key:"onShapeUpdating",value:function(e){if(this.checkRenderingModeIs("canvas"))return(0,S._)((0,x._)(n.prototype),"onShapeUpdating",this).call(this,e)}},{key:"onShapeMoving",value:function(e){if(this.checkRenderingModeIs("canvas"))return(0,S._)((0,x._)(n.prototype),"onShapeMoving",this).call(this,e)}},{key:"updateRender",value:function(){return this.redraw()}},{key:"checkRenderingModeIs",value:function(e){return this.pdfViewer.config.annotRenderingMode.highlight===e}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{isArea:this.annot.isArea()})}}]),n}(ec);const ac=oc;!function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,A._)(n,[{key:"doRender",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e);var i=e.renderingData,r=i.annotInfo,o=i.rotate,a=e.quadRects,s=this.canvas.getContext("2d");s.clearRect(0,0,this.canvas.width,this.canvas.height),s.save(),this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()||(s.globalAlpha=r.opacity,a.forEach((function(e){s.beginPath();var n=90==o||270==o?.12568*e.width:.12568*e.height;0===n||!1===r.hasBorderColor?s.strokeStyle="transparent":s.strokeStyle=t.numberToRGBAString(r.color),s.lineWidth=Math.max(1,n);var i=e.left,a=e.right,u=e.top+e.textBlockHeight/2;switch(o){case 90:s.moveTo(a-e.width/2,0),s.lineTo(a-e.width/2,e.textBlockHeight);break;case 180:s.moveTo(e.right,e.top+e.height/2),s.lineTo(e.left,e.top+e.height/2);break;case 270:s.moveTo(a-e.width/2,e.bottom),s.lineTo(a-e.width/2,e.bottom-e.textBlockHeight);break;default:s.moveTo(i,u),s.lineTo(a,u)}s.stroke()})),s.restore())}}])}(ic);var sc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="strikeout",a.$ui.addClass("fv__pdf-page-strikeout-annot-container"),a.$handler.addClass("fv__pdf-page-strikeout-annot-handler-container"),a}return(0,A._)(n,[{key:"updateRender",value:function(){var e=this.annot,t=[],n=[],i=this.parent("annotsRender");if(e.isGrouped())for(var r=e.getGroupElements(),o=r.length;o--;){var a=r[o];n[o]=i.getAnnotRender(a.getId()).component,t[o]=a.update()}else n=[this],t=[e.update()];return Promise.all(t).then((function(){for(var e=[],t=n.length;t--;)e[t]=n[t].render();return Promise.all(e)}))}},{key:"checkRenderingModeIs",value:function(e){return this.pdfViewer.config.annotRenderingMode.strikeout===e}}]),n}(ec);const uc=sc;!function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,A._)(n,[{key:"doRender",value:function(e){(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e);var t=e.renderingData,i=t.annotInfo,r=t.rotate,o=e.quadRects,a=this.canvas.getContext("2d");(a.clearRect(0,0,this.canvas.width,this.canvas.height),a.save(),this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent())||(a.globalAlpha=i.opacity,0===Math.max(1,.12568*o[0].height)||!1===i.hasBorderColor?a.strokeStyle="transparent":a.strokeStyle=this.numberToRGBAString(i.color),o.forEach((function(e){a.beginPath();var t=e.left,n=e.right,i=90==r||270==r?.22568*o[0].width:.12568*o[0].height,s=e.top+e.textBlockHeight-i/2;switch(r){case 90:a.moveTo(t+i/2,e.bottom),a.lineTo(t+i/2,e.top);break;case 180:a.moveTo(e.right,e.top+i/2),a.lineTo(e.left,e.top+i/2);break;case 270:a.moveTo(n,e.bottom),a.lineTo(n,e.bottom-e.textBlockHeight);break;default:a.moveTo(t,s),a.lineTo(n,s)}a.lineWidth=i,a.stroke()})),a.restore())}}])}(ic);var cc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="Underline",a.$ui.addClass("fv__pdf-page-Underline-annot-container"),a.$handler.addClass("fv__pdf-page-Underline-annot-handler-container"),a}return(0,A._)(n,[{key:"checkRenderingModeIs",value:function(e){return this.pdfViewer.config.annotRenderingMode.underline===e}}]),n}(ec);const lc=cc;!function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,A._)(n,[{key:"doRender",value:function(e){(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e);var t=this.component.annot.info,i=e.renderingData.page.getRotationAngle(),r=e.renderingData.rotate+i,o=e.quadRects,a=this.canvas.getContext("2d");if(a.clearRect(0,0,this.canvas.width,this.canvas.height),a.save(),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){a.globalAlpha=t.opacity;var s=this.numberToRGBAString(t.color);o.forEach((function(e){var n=r;switch(r){case 0:case 180:2*e.width<e.height&&(n+=90);break;case 90:case 270:2*e.height<e.width&&(n+=90)}var i=90==(n%=360)||270==n?o[0].width:o[0].height;0===i||!1===t.hasBorderColor?a.strokeStyle="transparent":a.strokeStyle=s,a.lineWidth=Math.max(1,.12568*i),a.beginPath();var u=0,c=0,l=0,d=0;switch(n){case 90:u=.2504*e.width,c=Math.ceil(e.height/u),l=e.right-u,d=e.right,a.moveTo(e.left,e.bottom);for(var h=1;h<=c;h++){var f=h%2==0?0:u;a.lineTo(e.left+f,e.bottom-h*u)}break;case 180:u=.2504*e.height,c=Math.ceil(e.width/u),l=e.bottom-u,d=e.bottom,a.moveTo(e.left,e.top);for(var g=1;g<=c;g++){var v=g%2==0?0:u;a.lineTo(e.left+g*u,e.top+v)}break;case 270:u=.2504*e.width,c=Math.ceil(e.height/u),l=e.right-u,d=e.right,a.moveTo(e.right,e.bottom);for(var p=1;p<=c;p++){var m=p%2==0?0:u,y=e.bottom-p*u;y=y<=0?0:y,a.lineTo(e.right-m,y)}break;default:u=.2504*e.height,c=Math.ceil(e.width/u),l=e.bottom-u,d=e.bottom,a.moveTo(e.left,l);for(var k=1;k<=c;k++)a.lineTo(e.left+k*u,k%2==0?l:d)}a.stroke()})),a.restore()}}}])}(ic);var dc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="strikeout",a.$ui.addClass("fv__pdf-page-squiggly-annot-container"),a.$handler.addClass("fv__pdf-page-squiggly-annot-handler-container"),a}return(0,A._)(n,[{key:"checkRenderingModeIs",value:function(e){return this.pdfViewer.config.annotRenderingMode.squiggly===e}}]),n}(ec);const hc=dc;var fc,gc=g(1160),vc=g.n(gc),pc=function(){function e(t,n){(0,P._)(this,e),this.x=t,this.y=n}return(0,A._)(e,[{key:"add",value:function(t,n){return new e(this.x+t,this.y+n)}},{key:"addp",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"subtractp",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"subtract",value:function(t,n){return new e(this.x-t,this.y-n)}},{key:"move",value:function(t,n){var i=n.x-this.x,r=n.y-this.y,o=t/Math.sqrt(i*i+r*r);return new e(this.x+i*o,this.y+r*o)}},{key:"rotate",value:function(t,n){var i=this.x-n.x,r=this.y-n.y,o=Math.sqrt(i*i+r*r),a=Math.atan2(r,i)-t,s=o*Math.cos(a),u=o*Math.sin(a);return new e(n.x+s,n.y+u)}},{key:"distanceTo",value:function(e){var t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)}},{key:"slope",value:function(e){var t=this._dot(e);return Math.acos(t/(this._disp()*e._disp()))}},{key:"_dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"_disp",value:function(){return Math.sqrt(this._dot(this))}},{key:"equalTo",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n=Math.abs(n),(0,D._)(t,e)&&Math.abs(this.x-t.x)<=n&&Math.abs(this.y-t.y)<=n}},{key:"clone",value:function(){return new e(this.x,this.y)}}]),e}(),mc=4.396,yc=function(){function e(t){(0,P._)(this,e),this.component=t}return(0,A._)(e,[{key:"numberToRGBAString",value:function(e){if("string"==typeof e)return e;var t=(0,j.convertFromNumberToRGBA)(e);return"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(t.a,")")}},{key:"renderLineEnd",value:function(e,t,n,i,r,o){if(0!==i){var a=n.renderingData,s=a.fillColor;"line"===a.annotInfo.type&&(s=a.annotInfo.styleFillColor);var u=n.scale,c=Math.atan2(o.y-r.y,o.x-r.x);switch(e.save(),e.lineJoin="miter",e.beginPath(),i){case we.Square:this.renderSquareEnding(e,o,c,u,t);break;case we.Circle:this.renderCircleEnding(e,o,c,u,t);break;case we.Diamond:this.renderDiamondEnding(e,o,c,u,t);break;case we.OpenArrow:o=o.move(t/2,r),this.renderOpenArrowEnding(e,o,c,u,t);break;case we.ClosedArrow:o=o.move(t/2,r),this.renderClosedArrowEnding(e,o,c,u,t);break;case we.Butt:this.renderButtEnding(e,o,c,u,t);break;case we.ROpenArrow:this.renderROpenArrowEnding(e,o,c,u,t);break;case we.RClosedArrow:this.renderRClosedArrowEnding(e,o,c,u,t);break;case we.Slash:this.renderSlashEnding(e,o,c,u,t)}switch(i){case we.ClosedArrow:case we.RClosedArrow:case we.Diamond:case we.Square:case we.Circle:s&&(e.fillStyle=this.numberToRGBAString(s),e.fill())}e.stroke(),e.restore()}}},{key:"renderSquareEnding",value:function(e,t,n,i,r){var o=mc*i+3.1*r,a=o/2;e.translate(t.x,t.y),e.rotate(n),e.moveTo(-a,-a),e.rect(-a,-a,o,o)}},{key:"renderCircleEnding",value:function(e,t,n,i,r){var o=1.75862*i+2*r;e.translate(t.x,t.y),e.rotate(n),e.moveTo(o,0),e.arc(0,0,o,0,2*Math.PI)}},{key:"renderDiamondEnding",value:function(e,t,n,i,r){var o=mc*i+3.1*r,a=o/2;e.translate(t.x,t.y),e.rotate(n+Math.PI/4),e.moveTo(-a,-a),e.rect(-a,-a,o,o)}},{key:"renderOpenArrowEnding",value:function(e,t,n,i,r){var o=30/180*Math.PI;this.renderArrow(e,t,n,i,r,o,!1)}},{key:"renderClosedArrowEnding",value:function(e,t,n,i,r){var o=30/180*Math.PI;this.renderArrow(e,t,n,i,r,o,!0)}},{key:"renderButtEnding",value:function(e,t,n,i,r){var o=Math.PI/2,a=mc*i+3.1*r,s=new pc(t.x+a/2,t.y).rotate(Math.PI-n+o,t),u=s.rotate(Math.PI,t);e.moveTo(s.x,s.y),e.lineTo(u.x,u.y)}},{key:"renderROpenArrowEnding",value:function(e,t,n,i,r){var o=150/180*Math.PI;this.renderArrow(e,t,n,i,r,o,!1)}},{key:"renderRClosedArrowEnding",value:function(e,t,n,i,r){var o=150/180*Math.PI;this.renderArrow(e,t,n,i,r,o,!0)}},{key:"renderArrow",value:function(e,t,n,i,r,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=mc*i+3.1*r,u=new pc(t.x+s,t.y),c=u.rotate(Math.PI-n+o,t),l=u.rotate(Math.PI-n-o,t);e.moveTo(c.x,c.y),e.lineTo(t.x,t.y),e.lineTo(l.x,l.y),a&&e.closePath()}},{key:"renderSlashEnding",value:function(e,t,n,i,r){var o=60/180*Math.PI,a=mc*i+3.1*r,s=new pc(t.x+a/2,t.y).rotate(Math.PI-n+o,t),u=s.rotate(Math.PI,t);e.moveTo(s.x,s.y),e.lineTo(u.x,u.y)}}]),e}(),kc=function(e){var t=e.getIoC().getInstanceByClass(Gi).getMeasurementInfo();return t.markup&&t.caption?t.caption+"\n":""},bc=function(e,t,n){var i=e.getRenderingData(t,n);!i.annotFlag.checkNoZoom()||(t=1);var r=i.outerDeviceRect,o=i.innerDeviceRect;return Object.assign(o,{width:o.right-o.left,height:o.bottom-o.top}),Object.assign(r,{width:r.right-r.left,height:r.bottom-r.top}),{renderingData:i,innerRect:o,outerRect:r,scale:t,rotate:n}},wc=function(e,t){var n=e.canvas,i=n.width,r=n.height,o=t.x,a=t.y;o-=4,a-=4,(o=Math.max(o,2))+8>i&&(o=i-8-2),(a=Math.max(a,2))+8>r&&(a=r-8-2),e.rotate(0),e.fillStyle="#ffffff",e.rect(o,a,8,8),e.stroke(),e.fill()},_c=Math.log(2),Pc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).helper=new yc(e),i}return(0,A._)(n,[{key:"doRender",value:function(e){var t=this,n=e.renderingData,i=n.page,r=n.annotInfo,o=r.borderInfo||{},a=e.scale,s=e.rotate,u=this.convertPointToPixel(o.width,a);if(0!=u||-1!=r.borderColor||r.fillColor){var c=this.canvas.getContext("2d");if(c.clearRect(0,0,this.canvas.width,this.canvas.height),c.save(),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){e.lineWidth=u,c.globalAlpha=r.opacity,c.lineWidth=u,0===u||!1===r.hasBorderColor?c.strokeStyle="transparent":c.strokeStyle=this.numberToRGBAString(r.color);var l=e.outerRect,d=this.convertToPathPoint(n.startPoint,a,l,i,s),h=this.convertToPathPoint(n.endPoint,a,l,i,s),f=n.leaderLinePoints,g=this.convertToPathPoint(f.start,a,l,i,s),v=this.convertToPathPoint(f.end,a,l,i,s);if(n.leaderLineOffset>0){var p=n.annotInfo.leaderLineLength>0?1:-1,m=this.convertPointToPixel(n.leaderLineOffset,a),y=d.move(m,h).rotate(p*Math.PI/2,d);h=h.move(m,d).rotate(p*-Math.PI/2,h),d=y,y=g.move(m,v).rotate(p*Math.PI/2,g),v=v.move(m,g).rotate(p*-Math.PI/2,v),g=y}var k=n.captionOffset,b=new pc(this.convertPointToPixel(k.x,a),-this.convertPointToPixel(k.y,a)),w=this.convertPointToPixel(n.leaderLineExtend,a);try{if(o.style===me.DASHED){var _=o.dashes||[],P=o.dashPhase||0;c.setLineDash&&c.setLineDash(_.map((function(e){return t.convertPointToPixel(e,a)}))),c.lineDashOffset=this.convertPointToPixel(P,a)}c.beginPath(),this.renderLine(c,d,h,g,v,w),c.closePath(),c.stroke(),this.helper.renderLineEnd(c,u,e,n.startStyle,v,g),this.helper.renderLineEnd(c,u,e,n.endingStyle,g,v),this.renderLineCaption(c,e,u,g,v,b)}finally{c.restore()}}}}},{key:"convertToPathPoint",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=(0,E._)(i.getDevicePoint([e.x,e.y],t,r),2),a=o[0],s=o[1];return new pc(a-n.left,s-n.top)}},{key:"renderLine",value:function(e,t,n,i,r,o){if(e.moveTo(i.x,i.y),e.lineTo(r.x,r.y),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.moveTo(n.x,n.y),e.lineTo(r.x,r.y),o>0){var a=i.move(-o,t),s=r.move(-o,n);e.moveTo(i.x,i.y),e.lineTo(a.x,a.y),e.moveTo(r.x,r.y),e.lineTo(s.x,s.y),e.moveTo(s.x,s.y)}}},{key:"renderLineCaption",value:function(e,t,n,i,r,o){var a=t.renderingData,s=t.scale,u=a.annotInfo,c=u.content;if("string"==typeof c&&!((c=c.trim()).length<1)){if(r.x<i.x){var l=i;i=r,r=l}var d,h,f=Math.atan2(r.y-i.y,r.x-i.x),g=i.distanceTo(r),v=i.move(.5*g,r),p=16*(d=s+1,Math.log(d)/_c),m=16777215-(16777215&u.borderColor^10855845);e.save(),e.fillStyle=this.numberToRGBAString(m),e.font=p+"px bold Arial",e.textBaseline="middle",e.textAlign="center";var y=e.measureText(c),k=y.actualBoundingBoxAscent+y.actualBoundingBoxDescent,b=v.move(o.y,i).rotate(Math.PI/2,v),w=Math.PI/2;switch(w=o.y>0?-Math.PI/2:Math.PI/2,a.captionPos){case _e.POS_INLINE:if(0!=o.y&&0!=o.x){h=b.move(o.x,v).rotate(w,b);break}h=b;break;case _e.POS_TOP:var _=v.move(.5*(n+k)-o.y,r).rotate(Math.PI/2,v);h=0!=o.x?_.move(o.x,v).rotate(w,b):_}if(a.hasCaption&&(e.translate(h.x,h.y),e.rotate(f),e.fillText(c,0,0),e.restore()),e.beginPath(),!(Math.abs(o.x)<g/2+y.width/2&&Math.abs(o.y)<k)){var P=o.x>0?-1:1,A=o.x+P*y.width/2;if(Math.abs(o.x)<=y.width/2){A=0;var S=k/2+4,x=o.y>0?1:-1,C=0;Math.abs(o.y)>k&&(C=o.y-x*S),b=v.move(C,i).rotate(Math.PI/2,v)}var D=b.move(A,v).rotate(w,b),E=D.move(Math.abs(A)+n/2,b);e.moveTo(v.x,v.y),e.lineTo(b.x,b.y),e.moveTo(E.x,E.y),e.lineTo(D.x,D.y),e.moveTo(D.x,D.y),e.closePath(),e.stroke()}}}},{key:"setMarkUp",value:function(e,t){var n=bc(this.component,e,t),i=n.renderingData,r=n.outerRect;e=n.scale,t=n.rotate;var o=i.page,a=i.annotInfo,s=a.borderInfo||{},u=this.convertPointToPixel(s.width,e),c=this.canvas.getContext("2d");c.clearRect(0,0,this.canvas.width,this.canvas.height),c.save(),c.lineWidth=u,c.strokeStyle=this.numberToRGBAString(a.color);var l=this.convertToPathPoint(i.startPoint,e,r,o,t),d=this.convertToPathPoint(i.endPoint,e,r,o,t),h=i.leaderLinePoints,f=this.convertToPathPoint(h.start,e,r,o,t),g=this.convertToPathPoint(h.end,e,r,o,t);if(i.leaderLineOffset>0){var v=i.annotInfo.leaderLineLength>0?1:-1,p=this.convertPointToPixel(i.leaderLineOffset,e),m=l.move(p,d).rotate(v*Math.PI/2,l);d=d.move(p,l).rotate(v*-Math.PI/2,d),l=m,m=f.move(p,g).rotate(v*Math.PI/2,f),g=g.move(p,f).rotate(v*-Math.PI/2,g),f=m}var y=this.convertPointToPixel(i.leaderLineExtend,e);c.beginPath(),this.renderLine(c,l,d,f,g,y),c.closePath(),wc(c,l),wc(c,d)}}]),n}(nc);!function(e){e.EndPoint="end-point",e.MidPoint="mid-point",e.IntersectionPoint="intersection-point",e.NearestPoint="nearest-point"}(fc||(fc={}));var Ac=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"render",value:function(e){var t=e.canvas,n=t.width;t.height=t.height,e.clearRect(0,0,n,n),e.strokeStyle="red",e.arc(n/2,n/2,2*Math.PI,0,360),e.stroke()}}]),e}(),Sc=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"render",value:function(e){var t=e.canvas,n=t.width;t.height=t.height,e.clearRect(0,0,n,n),e.strokeStyle="red",e.moveTo(n/2,0),e.lineTo(0,n),e.lineTo(n,n),e.closePath(),e.stroke()}}]),e}(),xc=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"render",value:function(e){var t=e.canvas,n=t.width;t.height=t.height,e.clearRect(0,0,n,n),e.strokeStyle="red",e.rect(0,0,n,n),e.stroke()}}]),e}(),Cc=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"render",value:function(e){var t=e.canvas,n=t.width;t.height=t.height,e.clearRect(0,0,n,n),e.strokeStyle="red",e.moveTo(0,0),e.lineTo(n,n),e.moveTo(0,n),e.lineTo(n,0),e.stroke()}}]),e}(),Dc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,J._)((0,w._)(i),"container",void 0),(0,J._)((0,w._)(i),"canvas",void 0),(0,J._)((0,w._)(i),"size",void 0),(0,J._)((0,w._)(i),"renderer",void 0),i.container=e,i.size=16,i.renderer=new Ac,i.canvas=document.createElement("canvas"),i.canvas.classList.add("fv__viewer-snapped-point"),i.addDestroyHook((function(){i.canvas.parentElement===i.container&&i.container.removeChild(i.canvas)})),i.canvas.width=i.size,i.canvas.height=i.size,i}return(0,A._)(n,[{key:"setRenderer",value:function(e){this.renderer=new e,this.redraw()}},{key:"setSize",value:function(e){this.size=e,this.canvas.width=e,this.canvas.height=e,this.redraw()}},{key:"setPosition",value:function(e,t){(0,j.cssText)(this.canvas,{left:e+"px",top:t+"px",margin:"".concat(.5*-this.size,"px ").concat(.5*-this.size,"px")})}},{key:"show",value:function(e){switch(this.container.appendChild(this.canvas),e){case fc.MidPoint:this.setRenderer(Sc);break;case fc.IntersectionPoint:this.setRenderer(Cc);break;case fc.NearestPoint:this.setRenderer(xc);break;default:this.setRenderer(Ac)}}},{key:"hide",value:function(){this.canvas.parentElement===this.container&&this.container.removeChild(this.canvas)}},{key:"redraw",value:function(){if(this.renderer){var e=this.canvas.getContext("2d");e&&this.renderer.render(e)}}}]),n}(j.Disposable),Ec="px",Ic=Math.log(2),Rc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="line",j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e=new zu({emitter:a.pdfViewer.eventEmitter,start:function(){return a.onStartUpdateShape()},update:function(e,t){return a.onShapeUpdating&&a.onShapeUpdating(e,t)},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},resizable:!1,onStatusChange:function(){a.updateHandlerPointStatus()},auxiliaryLine:void 0});return a.processShapeControlPermissionCtrl(e),e})),a}return(0,A._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.activeMore();var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e),this.setMargin(),this.updateHandlerPosition()}},{key:"movedByOther",value:function(){if(this.isActive){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e),this.setMargin(),this.updateHandlerPosition()}}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),j.Lazy.isPropertyIntialized(this,"shapeControl")&&this.shapeControl.deactive()}},{key:"afterRender",value:function(e){if(e.transformed&&this.isActive){this.activeRect(),this.activeMore();var t=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),t),this.setMargin(),this.updateHandlerPosition()}}},{key:"activeMore",value:function(){this.$handler.addClass("fv__annot-line-container");var e=2;0!==this.annot.getLeaderLineLength()&&(e=4),this.hammerInited=this.hammerInited||this.initHammer(e)}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"onStartUpdateShape",value:function(e,t){this.editDebouncePromise||(this.editDebouncePromise=new j.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e){this.updateCollabOp(e)}},{key:"onShapeMoving",value:function(e,t){this.updateCollabOp(e)}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editDebouncePromise?this.editDebouncePromise.waitForLastTask().then((function(){return i.moveTo(e.left,e.top,n).then((function(t){return i._setRect(e,!1)})).then((function(e){return i._applyShapeChange()}))})):Promise.resolve()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e)}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,j.colorConvertor)(e.getBorderColor(),"#"),n=e.getOpacity(),i=e.getBorderWidth(),r=e.getStyleFillColor(),o=this.propertyDisabled(),a=this.isLocked();return{color:t,opacity:n,borderWidth:i,lineStartStyle:e.getStartStyle(),lineEndStyle:e.getEndingStyle(),hasCap:e.hasCaption(),fillColor:r,isLocked:a,disabled:o,borderStyle:!0}}},{key:"redraw",value:function(e){var t=this;return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e).then((function(){"line"==t.name&&t.annot.calculateLeaderLine(),t.updateHandlerPosition(),t.setMargin()}))}},{key:"updateRender",value:function(){return this.redraw()}},{key:"initHammer",value:function(e){var t=this,n=this.$handler,i=vc()({anchorCount:e,isLineDimension:this.annot.getIntent()==ke.LINE_DIMENSION,captionText:this.annot.getContent()}),r=O()(i);n.append(r);var o=this.annot.getType(),a=n.find(".fv__pdf-annot-line-point"),s=function(){return t.moveDisabled()};return this.addDestroyHook(this.pdfViewer.getAnnotAuthorityManager().subscribe(this.annot,(function(e){s=function(){return e.ignorable()?t.moveDisabled():!e.isAdjustable()}}))),a.each((function(e,i){var r,u,c=function(t,n){if("line"!==o||!j.keyboardStatus.isShift)return[t,n];var i=a.eq(1^e),s=parseFloat(i.css("left")),u=parseFloat(i.css("top")),c=r.x+t,l=r.y+n,d=Math.sqrt(Math.pow(c-s,2)+Math.pow(l-u,2)),h=Math.atan2(l-u,c-s),f=.25*Math.PI,g=Math.round(h/f)*f,v=d*Math.cos(g),p=u+d*Math.sin(g);return[s+v-r.x,p-r.y]},l=new Hammer.Manager(i,{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});t.addDestroyHook((function(){l.destroy()}));var d,h=!1;l.on("panstart",(function(e){s()?h=!1:(h=!0,"fv__pdf-annot-line-point-item"==(u=O()(e.target)).attr("class")&&(u=u.parent()),r={x:parseFloat(u.css("left")),y:parseFloat(u.css("top"))},t.backupProperty(i),t.boundaryChangeStart(e),t.snappedPointAssistant=new Dc(n.get(0)))})).on("panmove",(function(n){if(h){var i=(0,E._)(c(n.deltaX,n.deltaY),2),o=i[0],a=i[1];if(t.pdfViewer.config.highPerformance)t.updatePoint(o,a,e);else if(u.css({left:r.x+o+Ec,top:r.y+a+Ec}),t.annot.getIntent()!==ke.LINE_DIMENSION||![2,3].includes(e)){var s={x:r.x+o,y:r.y+a};t.getSnappedPoint(s).then((function(e){(0,j.isSamePoint)(s,e)?(t.snappedPointAssistant.hide(),d=null):(t.snappedPointAssistant.show(e.type),t.snappedPointAssistant.setPosition(e.x,e.y),d=e)}))}}})).on("panend",(function(n){if(h){t.snappedPointAssistant&&(t.snappedPointAssistant.destroy(),t.snappedPointAssistant=null);var i=(0,E._)(c(n.deltaX,n.deltaY),2),o=i[0],a=i[1];d&&(o=d.x-r.x,a=d.y-r.y,u.css({left:r.x+o+Ec,top:r.y+a+Ec}),d=null),t.updatePoint(o,a,e).then((function(e){t.boundaryChangeEnd(n)}))}}))})),this.captionHammerHandler(),!0}},{key:"updateCollabPoint",value:function(e,t,n){if(!(n>1)&&this.pdfViewer.customs.isCollaborationMode()){var i=(0,E._)(this.annot.page.reverseDeviceOffset([e,t],this.scale,this.rotate),2),r=i[0],o=i[1],a=Object.assign({},this.annot.getStartPoint()),s=Object.assign({},this.annot.getEndPoint());0==n?a={x:a.x+r,y:a.y+o}:1==n&&(s={x:s.x+r,y:s.y+o}),this.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,this,{points:[a,s],rect:{left:Math.min(a.x-2,s.x-2),right:Math.max(a.x+2,s.x+2),top:Math.max(a.y+2,s.y+2),bottom:Math.min(a.y-2,s.y-2)}})}}},{key:"captionHammerHandler",value:function(){var e=this,t=function(){return e.moveDisabled()};this.addDestroyHook(this.pdfViewer.getAnnotAuthorityManager().subscribe(this.annot,(function(n){t=function(){return n.ignorable()?e.moveDisabled():!n.isAdjustable()}})));var n=this.$handler.find(".fv__pdf-annot-line-caption");if(n[0]){var i=new Hammer.Manager(n[0],{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});this.addDestroyHook((function(){i.destroy()}));var r,o,a=!1;i.on("panstart",(function(n){t()?a=!1:(a=!0,o=O()(n.target),r={x:parseFloat(o.css("left")),y:parseFloat(o.css("top"))},o.css("border","1px solid #5aa"),e.boundaryChangeStart(n))})).on("panmove",(function(t){a&&(e.pdfViewer.config.highPerformance?e.updatePoint(t.deltaX,t.deltaY,4):o.css({left:r.x+t.deltaX+Ec,top:r.y+t.deltaY+Ec}))})).on("panend",(function(t){a&&(O()(t.target).css("border","none"),e.updatePoint(t.deltaX,t.deltaY,4).then((function(n){e.boundaryChangeEnd(t)})))}))}}},{key:"boundaryChangeStart",value:function(e){}},{key:"boundaryChangeEnd",value:function(e){}},{key:"updateHandlerPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.$handler,n=this.scale,i=this.rotate,r=[],o=this.annot.getStartPoint();r.push(this.annot.page.getDevicePoint([o.x,o.y],n,i));var a=this.annot.getEndPoint();if(r.push(this.annot.page.getDevicePoint([a.x,a.y],n,i)),0!=this.annot.getLeaderLineLength()){e&&this.annot.calculateLeaderLine();var s=this.annot.getLeaderLinePoints();r.push(this.annot.page.getDevicePoint([s.start.x,s.start.y],n,i)),r.push(this.annot.page.getDevicePoint([s.end.x,s.end.y],n,i))}for(var u=t.get(0).querySelectorAll("[data-index]"),c=0;c<r.length;c++){var l=u[c];l&&(l.style.cssText+="\n                left: ".concat(r[c][0],"px;\n                top: ").concat(r[c][1],"px;\n            "))}this.updateCaptionPosition()}},{key:"updateCaptionPosition",value:function(){if(this.annot.hasCaption()){var e=this.$handler.find(".fv__pdf-annot-line-caption"),t=this.scale,n=this.rotate,i=e.width(),r=e.height(),o=this.annot.getLeaderLinePoints(),a=o.start,s=o.end,u=this.annot.getCaptionPoint(),c=this.annot.page.getDevicePoint([u.x,u.y],t,n),l=c[0]-i/2,d=c[1]-r/2,h=-Math.atan2(s.y-a.y,s.x-a.x)*(180/Math.PI),f=16*(g=t+1,Math.log(g)/Ic);e.css({left:"".concat(l).concat(Ec),top:"".concat(d).concat(Ec),transform:"rotate(".concat(h,"deg)"),"font-size":"".concat(f).concat(Ec)})}var g}},{key:"updateHandlerPointStatus",value:function(){if(this.$handler){var e=this.$handler.get(0).querySelectorAll("[data-index]");if(e){var t=this.shapeControl.isDisabled;e.forEach((function(e){e.style.display=t?"none":"block"}))}}}},{key:"moved",value:function(){(0,S._)((0,x._)(n.prototype),"moved",this).call(this),this.updateHandlerPosition(),this.setMargin()}},{key:"setContent",value:function(e){return e===this.annot.getContent()?Promise.resolve(!0):this.annot.setContent(e)}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.annot.update().then((function(e){return!0})):e})).then((function(e){return e?t.updateRender().then((function(){var n=t._getShapeControllerBoundaryBox();return t.shapeControl.active(t.$handler,t.getBoundary(),n),t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setFillColor",value:function(e){var t=this,n=this.annot.setStyleFillColor;return n||(n=this.annot.setFillColor),n.call(this.annot,e).then((function(e){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e}))}},{key:"setEndingStyle",value:function(e,t){var n=this;return this.annot.setEndingStyle(e,t).then((function(){var e=n._getShapeControllerBoundaryBox();n.shapeControl.active(n.$handler,n.getBoundary(),e),n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n)}))}},{key:"setMeasureUnit",value:function(e){var t=this;return(0,D._)(e,mi)&&(e=e.name),this.annot.setMeasureUnit(e).then((function(){return t.updateRender()})).then((function(){t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t)}))}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?wi.name:r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?wi.name:u;return(0,D._)(o,mi)&&(o=o.name),(0,D._)(c,mi)&&(c=c.name),this.annot.setMeasureRatio({userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.updateRender()})).then((function(){e.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,e)}))}},{key:"getMeasureRatio",value:function(){var e=this.annot.info.measureRatio,t=(0,E._)(/(\d+(\.\d+)?)(?:\s+)(\w+)(?:\s+\=\s+)(\d+(\.\d+)?)(?:\s+)(\w+)/.exec(e),7),n=t[1],i=t[3],r=t[4],o=t[6];return{userSpaceValue:Number(n),userSpaceUnit:i,realValue:Number(r),realUnit:o}}},{key:"enableCaption",value:function(e){var t=this;return this.annot.enableCaption(e).then((function(){return t.redraw().then((function(){t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t)}))}))}},{key:"hasCaption",value:function(){return this.annot.hasCaption()}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(){return n.updateRender()})).then((function(){n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n)}))}},{key:"backupProperty",value:function(e){switch(e?O()(e).data("index"):""){default:return this.oldRect=Object.assign({},this.annot.getRect());case 1:return this.oldEndPoint=Object.assign({},this.annot.getEndPoint());case 0:return this.oldStartPoint=Object.assign({},this.annot.getStartPoint());case 3:case 2:return this.oldLeaderEndPoint=Object.assign({},this.annot.leaderEndPoint)}}},{key:"updateLeaderLineLength",value:function(e,t,n){var i=this.oldLeaderEndPoint,r=this.annot.getEndPoint(),o=this.annot.getStartPoint(),a=this.annot.Eb,s=this.annot.k;n&&(i=this.oldLeaderEndPoint,r=this.annot.getEndPoint(),o=this.annot.getStartPoint(),a=this.annot.Eb);var u,c,l=i.x+e,d=i.y+t,h=!0;if((r.x-o.x)*(d-r.y)-(l-r.x)*(r.y-o.y)>0&&(h=!1),isFinite(s)){var f=(s*(d-a)+l)/(s*s+1),g={x:f,y:s*f+a};u=g.x-r.x,c=g.y-r.y}else u=0,c=d-r.y;var v=Math.sqrt(u*u+c*c);return h&&(v=-v),this.annot.setLeaderLineLength(v)}},{key:"updatePoint",value:function(e,t,n){var i,r=this,o=(0,E._)(this.annot.page.reverseDeviceOffset([e,t],this.scale,this.rotate),2),a=o[0],s=o[1];switch(n){case 1:i=this.annot.setEndPoint({x:this.oldEndPoint.x+a,y:this.oldEndPoint.y+s});break;case 0:i=this.annot.setStartPoint({x:this.oldStartPoint.x+a,y:this.oldStartPoint.y+s});break;case 2:i=this.updateLeaderLineLength(a,s,!1);break;case 3:i=this.updateLeaderLineLength(a,s,!0);break;case 4:i=this.updateCaptionOffset(a,s)}return i.then((function(){var e=r._getShapeControllerBoundaryBox();r.shapeControl.active(r.$handler,r.getBoundary(),e),r.updateHandlerPosition(),r.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,r)}))}},{key:"updateCaptionOffset",value:function(e,t){var n=this.annot,i=n.getCaptionPoint(),r=n.getLeaderLinePoints(),o=r.start,a=r.end,s=new pc(o.x,o.y),u=new pc(a.x,a.y),c=n.getLeaderLineOffset();if(c>0){var l=s.move(c,u),d=u.move(c,s);s=l.rotate(-Math.PI/2,s),u=d.rotate(Math.PI/2,u)}var h,f,g=s.distanceTo(u),v=s.move(g/2,u),p=i.x+e,m=i.y+t,y=m-v.y,k=p-v.x,b=Math.sqrt(Math.pow(k,2)+Math.pow(y,2)),w=this.annot.k;if(isFinite(w)){var _=m-w*p,P=1,A=1,S=-1/w;if(isFinite(S)){var x=S*p+(s.y-S*s.x)<=m,C=w*p+(v.y-w*v.x)<=m;s.x<=u.x?(A=x?1:-1,P=S>0?C?1:-1:C?-1:1):(A=x?-1:1,P=S>0?C?-1:1:C?1:-1)}else s.y>=u.y?(P=y>0?-1:1,A=k>0?1:-1):(P=y>0?1:-1,A=k>0?-1:1);h=P*Math.abs(w*v.x-v.y+_)/Math.sqrt(Math.pow(w,2)+1),f=A*Math.sqrt(Math.pow(b,2)-Math.pow(h,2))}else{var D=s.x>u.x?-1:1;h=D*k,f=D*y}return n.setCaptionOffset(h,f)}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(Ra.expandOffset(t,e))}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t),r=this.annot;return Object.assign(i,{leaderLineExtend:r.getLeaderLineExtend?r.getLeaderLineExtend():void 0,startPoint:r.getStartPoint?r.getStartPoint():void 0,endPoint:r.getEndPoint?r.getEndPoint():void 0,leaderLinePoints:r.getLeaderLinePoints?r.getLeaderLinePoints():void 0,leaderLineOffset:r.getLeaderLineOffset?r.getLeaderLineOffset():void 0,captionOffset:r.getCaptionOffset?r.getCaptionOffset():void 0,startStyle:r.getStartStyle?r.getStartStyle():void 0,endingStyle:r.getEndingStyle?r.getEndingStyle():void 0,hasCaption:r.hasCaption?r.hasCaption():void 0,captionPos:r.getCaptionPos?r.getCaptionPos():void 0,fillColor:r.getFillColor()||(r.getStyleFillColor?r.getStyleFillColor():void 0),content:r.info.content})}},{key:"getSnappedPoint",value:function(e){var t,n=this,i=this.annot.getIntent(),r=(t={},(0,J._)(t,ke.LINE_DIMENSION,In),(0,J._)(t,ke.POLYLINE_DIMENSION,Rn),(0,J._)(t,ke.POLYGON_DIMENSION,Tn),(0,J._)(t,ke.CIRCLE_DIMENSION,Fn),t)[i],o=this.pdfViewer.getSnapMode(r),a=this.getPDFPage();if(o&&o.length>0){var s=(0,E._)(a.reverseDevicePoint([e.x,e.y],this.scale,this.rotate),2),u=s[0],c=s[1];return a.getSnappedPoint({x:u,y:c},o).then((function(e){var t=(0,E._)(a.getDevicePoint([e.x,e.y],n.scale,n.rotate),2);return{x:t[0],y:t[1],type:e.type}}))}return Promise.resolve(e)}}]),n}(ku);const Tc=Rc;var Fc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="lineMeasurement",a}return(0,A._)(n,[{key:"getLengthInInchUnit",value:function(){var e=this.getDimension(),t=e.width,n=e.height;return this._getLengthInInchUnit(t,n)}},{key:"_getLengthInInchUnit",value:function(e,t){var n=Ti.convertTo(e,wi),i=Fi.convertTo(t,wi);return Math.round(100*Math.sqrt(n*n+i*i))/100}}]),n}(Tc),Mc=function(){function e(){(0,P._)(this,e),this.segments=[]}return(0,A._)(e,[{key:"addSegment",value:function(e){(0,D._)(e,Oc)&&this.segments.push(e)}},{key:"render",value:function(e){e.beginPath(),this.segments.forEach((function(t){t.render(e)})),e.closePath()}}]),e}(),Oc=function(){function e(t,n){(0,P._)(this,e),this.from=t,this.to=n}return(0,A._)(e,[{key:"render",value:function(e){(0,j.notImplemented)()}},{key:"isJoinedBefore",value:function(e){return this.to.equalTo(e.from)}},{key:"isJoinedAfter",value:function(e){return e.to.equalTo(this.from)}},{key:"isJoinedWith",value:function(e){return this.isJoinedBefore(e)||this.isJoinedAfter(e)}}]),e}(),Lc=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"generate",value:function(){(0,j.notImplemented)()}}]),e}(),Nc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,P._)(this,n),(i=t.call(this)).closing=r,e.length>1&&e.reduce((function(e,t,n){return i.addSegment(new Vc(e,t,1===n)),t})),i}return(0,A._)(n,[{key:"render",value:function(e){e.beginPath(),this.segments.forEach((function(t){t.render(e)})),this.closing&&e.closePath()}}]),n}(Mc),Vc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,P._)(this,n),(r=t.call(this,e,i)).atTheStart=o,r}return(0,A._)(n,[{key:"render",value:function(e){this.atTheStart&&e.moveTo(this.from.x,this.from.y),e.lineTo(this.to.x,this.to.y)}}]),n}(Oc);function Bc(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;e.fillStyle="#fff",t.forEach((function(t){e.beginPath(),e.arc(t.x,t.y,n,0,360),e.stroke(),e.fill()}))}var jc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).helper=new yc(e),i}return(0,A._)(n,[{key:"doPrepare",value:function(){(0,S._)((0,x._)(n.prototype),"doPrepare",this).call(this),this.canvas.classList.add("fv__viewer-render-polyline")}},{key:"doRender",value:function(e){var t=e.renderingData,n=t.annotInfo,i=n.borderInfo||{},r=e.scale,o=e.rotate,a=this.canvas.getContext("2d"),s=this.convertPointToPixel(0==i.width?.5:i.width,r);if((0!=s||-1!=n.borderColor||n.fillColor)&&(a.clearRect(0,0,this.canvas.width,this.canvas.height),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent())){var u=t.page,c=e.innerRect,l=t.vertexes.map((function(e){var t=(0,E._)(u.getDevicePoint([e.x,e.y],r,o),2),n=t[0],i=t[1];return new pc(n-c.left,i-c.top)}));e.vertexes=l,a.save(),e.lineWidth=s,a.globalAlpha=n.opacity,a.lineWidth=s,0===s||!1===n.hasBorderColor?a.strokeStyle="transparent":a.strokeStyle=this.numberToRGBAString(n.color);try{switch(i.style){case me.DASHED:case me.SOLID:this.renderSolid(a,n,e);case me.BEVELED:}var d=l[l.length-1],h=l[l.length-2],f=l[0],g=l[1];this.helper.renderLineEnd(a,s,e,t.startStyle,g,f),this.helper.renderLineEnd(a,s,e,t.endingStyle,h,d),this.setContents(a,n.contents,l)}finally{a.restore()}}}},{key:"renderSolid",value:function(e,t,n){var i=this,r=n.scale,o=t.borderInfo,a=o.dashes||[],s=o.dashPhase||0;o.style===me.DASHED&&(e.setLineDash&&e.setLineDash(a.map((function(e){return i.convertPointToPixel(e,r)}))),e.lineDashOffset=this.convertPointToPixel(s,r)),new Nc(n.vertexes,!1,5).render(e),e.stroke();try{if(!j.isTouchDevice)return;void 0===n.renderingData.annotInfo.id&&Bc(e,n.vertexes)}catch(e){}}},{key:"setMarkUp",value:function(e,t){var n=bc(this.component,e,t),i=n.renderingData,r=n.innerRect;e=n.scale,t=n.rotate;var o=i.annotInfo,a=this.canvas.getContext("2d"),s=i.page;a.strokeStyle=this.numberToRGBAString(o.color),i.vertexes.map((function(n){var i=(0,E._)(s.getDevicePoint([n.x,n.y],e,t),2),o=i[0],a=i[1];return new pc(o-r.left,a-r.top)})).forEach((function(e){return wc(a,e)})),a.restore()}},{key:"setContents",value:function(e,t,n){var i,r;if(void 0!==t&&n&&!(n.length<3)){var o=n[n.length-1],a=e;a.beginPath(),a.font="14px Verdana",a.textAlign="left",a.textBaseline="top",a.direction="ltr";var s=a.measureText(t).width;a.fillStyle="#AF6B6B";var u=n.map((function(e){return e.x})),c=(i=Math).min.apply(i,(0,I._)(u));(r=Math).max.apply(r,(0,I._)(u));Math.abs(o.x-c)>=s&&o.x>c?a.fillText(t,o.x-s,o.y,s):a.fillText(t,o.x,o.y,s),a.closePath()}}}]),n}(nc),Uc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="polyline",a}return(0,A._)(n,[{key:"activeMore",value:function(){var e=this.annot.getVertexes(),t=this.annot.getPathVertexes();this.$handler.addClass("fv__pdf-annot-polyLine-container");var n=e.length;t.length>0&&(n=t.length),this.hammerInited=this.hammerInited||this.initHammer(n)}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,j.colorConvertor)(e.getBorderColor(),"#"),n=e.getOpacity(),i=e.getBorderWidth(),r=e.getStyleFillColor(),o=this.propertyDisabled(),a=this.isLocked();return{color:t,opacity:n,fillColor:r,borderWidth:i,lineStartStyle:e.getStartStyle(),lineEndStyle:e.getEndingStyle(),disabled:o,borderStyle:!0,isLocked:a}}},{key:"backupProperty",value:function(e){if(!e)return this.oldRect=Object.assign({},this.annot.getRect());this.oldVertex=Object.assign({},this.annot.getVertexes())}},{key:"updatePoint",value:function(e,t,n){var i=this;return this.movePointAt(n,{offsetX:e,offsetY:t}).then((function(){i.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,i)}))}},{key:"movePointAt",value:function(e){var t,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.offsetX,o=void 0===r?0:r,a=i.offsetY,s=void 0===a?0:a,u=this.annot.getPathVertexes();if(u.length>0){var c=u[e],l=this.resolveMovedPoint(c,o,s);t=this.annot.updatePathVertex(e,l)}else{var d=(this.oldVertex||this.annot.getVertexes())[e],h=this.resolveMovedPoint(d,o,s);t=this.annot.updateVertexes(e,h)}return t.then((function(){n.shapeControl.active(n.$handler,n.getBoundary(),n._getShapeControllerBoundaryBox())}))}},{key:"resolveMovedPoint",value:function(e,t,n){var i=(0,E._)(this.annot.page.reverseDeviceOffset([t,n],this.scale,this.rotate),2),r=i[0],o=i[1],a={x:e.x+r,y:e.y+o},s=this.getPDFPage(),u=s.getWidth(),c=s.getHeight(),l=s.getRotationAngle(),d=0==(l/90&1)?u:c,h=0==(l/90&1)?c:u;return a.x=Math.max(a.x,0),a.y=Math.max(a.y,0),a.x=Math.min(a.x,d),a.y=Math.min(a.y,h),a}},{key:"setLastPoint",value:function(e,t){var n=this.rotate,i=this.scale,r=this.annot.getVertexes().slice(0),o=r[r.length-1],a=(0,E._)(this.annot.page.getDevicePoint([o.x,o.y],i,n),2),s=a[0],u=a[1];e="number"==typeof e?e:s,t="number"==typeof t?t:u;var c=(0,E._)(this.annot.page.reverseDevicePoint([e,t],i,n),2),l=c[0],d=c[1];return o.x=l,o.y=d,this.setVertexes(r)}},{key:"addPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,E._)(this.annot.page.reverseDevicePoint([e,t],this.scale,this.rotate),2),i=n[0],r=n[1],o=this.annot.getVertexes().concat({x:i,y:r});return this.setVertexes(o)}},{key:"setVertexes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot.getVertexes();return this.annot.setVertexes(t).then((function(){return e.updateRender()})).then((function(){e.shapeControl.active(e.$handler,e.getBoundary(),e._getShapeControllerBoundaryBox())}))}},{key:"getVertexes",value:function(){return this.annot.getVertexes()}},{key:"getPathVertexes",value:function(){return this.annot.getPathVertexes()}},{key:"deleteVertex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot.getVertexes().length-1,t=this.annot.getVertexes().filter((function(t,n){return n!==e}));return this.setVertexes(t)}},{key:"updateHandlerPosition",value:function(){var e=this.$handler,t=this.scale,n=this.rotate,i=this.annot.getVertexes(),r=this.annot.getPathVertexes();r.length>0&&(i=r);for(var o=0;o<i.length;o++){var a=e.find("[data-index=".concat(o,"]")),s=i[o];s=this.annot.page.getDevicePoint([s.x,s.y],t,n),a.css({left:s[0]+"px",top:s[1]+"px",display:this.shapeControl.isDisabled?"none":"block"})}}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t),r=this.getVertexes(),o=this.getPathVertexes();return Object.assign(i,{vertexes:o.length>0?o:r})}},{key:"updateCollabPoint",value:function(e,t,n){if(this.pdfViewer.customs.isCollaborationMode()){var i=(0,E._)(this.annot.page.reverseDeviceOffset([e,t],this.scale,this.rotate),2),r=i[0],o=i[1],a=Object.assign({},this.getVertexes());a[n]={x:a[n].x+r,y:a[n].y+o};var s=this.annot.getRect();this.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,this,{points:Object.values(a),rect:{left:Math.min(s.left,a[n].x-2),right:Math.max(s.right,a[n].x+2),top:Math.max(s.top,a[n].y+2),bottom:Math.min(s.bottom,a[n].y+2)}})}}}]),n}(Tc);const Hc=Uc;var Wc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"render",value:function(e){try{e.save(),e.beginPath(),this.segments.filter((function(e){return e.isOn})).forEach((function(t){t.render(e)})),e.closePath()}finally{e.restore()}}}]),n}(Mc),Yc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,P._)(this,n),(r=t.call(this,e,i)).isOn=o,r}return(0,A._)(n,[{key:"render",value:function(e){this.isOn&&(e.moveTo(this.from.x,this.from.y),e.lineTo(this.to.x,this.to.y))}}]),n}(Oc),qc=(function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,P._)(this,n),(r=t.call(this)).contour=e,r.dashes=i,r.phase=o,r.continuous=a,r.dashSum=i.reduce((function(e,t){return e+t}),0),r}(0,A._)(n,[{key:"generate",value:function(){var e=this,t=new Wc;if(0==this.dashes.length)this.contour.reduce((function(e,n){t.addSegment(new Yc(e,n))}));else{var n=this.phase<this.dashSum?this.phase:this.phase%this.dashSum,i=0,r=0,o=!0;n>0&&this.dashes.reduce((function(e,t,a){var s=e+t;return s>n&&(r=s-n,i=a,o=a%2==0),s}),0);var a=function(){return(i+1)%e.dashes.length};this.contour.reduce((function(s,u){var c=s.distanceTo(u),l=s;for(r>0&&(t.addSegment(new Yc(l,l=l.move(r,u),o)),o=!o,c-=r,i=a());;){var d=e.dashes[i];if(!(c>=d)){t.addSegment(new Yc(l,u,o)),e.continuous?(r=d-c,c=0):(r=n,i=0,o=!0);break}t.addSegment(new Yc(l,l=l.move(d,u),o)),c-=d,i=a(),o=!o}return u}))}return t}}])}(Lc),function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,null,r)).controlPoint1=e,o.controlPoint2=i,o}return(0,A._)(n,[{key:"render",value:function(e){e.bezierCurveTo(this.controlPoint1.x,this.controlPoint1.y,this.controlPoint2.x,this.controlPoint2.y,this.to.x,this.to.y)}}]),n}(Oc)),Kc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,A._)(n,[{key:"render",value:function(e){e.moveTo(this.from.x,this.from.y)}}]),n}(Oc),$c=.5522847498308,zc=3.14159265358979,Gc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this)).points=e,o.innerRect=i,o.outerRect=r,o}return(0,A._)(n,[{key:"generate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,n=arguments.length>2?arguments[2]:void 0,i=new Mc,r=this.points.map((function(t){var n=e.innerRect.height-t.y;return new pc(t.x,n)})),o=r.length;n||(n=o*t);var a=r.map((function(e,t){return e.distanceTo(r[(t+1)%o])})).reduce((function(e,t){return e+t})),s={left:r[0].x,right:r[0].x,top:r[0].y,bottom:r[0].y},u=a/n;if(0==u)return i;for(var c=[],l=0,d=r[0],h=r[1],f=d.distanceTo(h),g=0,v=1;g<n;g++){for(;l>f;)l-=f,v++,d=h,h=r[v%o],f=d.distanceTo(h);c.push(d.move(l,h)),l+=u}var p=c.length,m=!0,y=5*u/8;return c.forEach((function(t,n){var r=function(e,t,n){var i,r,o=e.subtractp(t),a=n.subtractp(t),s=[],u=Math.atan2(o.y,o.x),c=Math.atan2(a.y,a.x);u+=Math.acos(e.distanceTo(t)/(2*y))-zc/9,c-=Math.acos(n.distanceTo(t)/(2*y)),c<u&&(c+=2*zc);var l={left:t.x-y,right:t.x+y,bottom:t.y-y,top:t.y+y},d=Jc(l,u,c,m);(i=s).push.apply(i,(0,I._)(d.arrAp)),m=!1;var h=t.subtractp(n);return u=Math.atan2(h.y,h.x),u+=Math.acos(n.distanceTo(t)/(2*y)),c=u-zc/9,l={left:n.x-y,right:n.x+y,bottom:n.y-y,top:n.y+y},d=Jc(l,u,c,m),(r=s).push.apply(r,(0,I._)(d.arrAp)),s}(c[0==n?p-1:n-1],t,c[(n+1)%p]);r.forEach((function(t){var n=function(t){if(t)return new pc(t.x+e.innerRect.left-e.outerRect.left,e.innerRect.height-t.y+(e.innerRect.top-e.outerRect.top))};t.from=n(t.from),t.to=n(t.to),t.controlPoint1=n(t.controlPoint1),t.controlPoint2=n(t.controlPoint2),i.addSegment(t)}))})),i.rect=s,i}}]),n}(Lc);function Jc(e,t,n,i){var r,o,a,s,u,c,l,d,h,f,g,v,p,m,y,k,b,w,_,P,A,S,x,C,D={};if(e.left>=e.right||e.bottom>=e.top)return{arrAp:[],pdfRect:D};if(Math.abs(n-t)<=1e-4)return{arrAp:[],pdfRect:D};var E=[];r=(e.right+e.left)/2,o=(e.top+e.bottom)/2,a=Math.abs(e.right-e.left)/2,s=Math.abs(e.top-e.bottom)/2,x=t,A=r+(g=a*Math.cos(x)),S=o+(v=s*Math.sin(x)),D.left=D.right=A,D.bottom=D.top=S,i&&E.push(new Kc(new pc(A,S)));var I=1;n<t&&(I=-1);var R=Math.floor(2*t/zc);I>0&&(R+=1),R*=zc/2;for(var T=!1;C=R,I>0?n<=R&&(C=n,T=!0):n>=R&&(C=n,T=!0),g=a*Math.cos(x),v=s*Math.sin(x),b=a*Math.cos(C),h=f=-a*a*s*s,p=g+(A=(_=((l=a*a*v)*f-(d=a*a*(w=s*Math.sin(C)))*h)/((u=s*s*g)*d-(c=s*s*b)*l))-g)*$c,m=v+(S=(P=(c*h-u*f)/(u*d-c*l))-v)*$c,y=b+(A=_-b)*$c,k=w+(S=P-w)*$c,p=A=r+p,m=S=o+m,D.left>p&&(D.left=p),D.bottom>m&&(D.bottom=m),D.right<p&&(D.right=p),D.top<m&&(D.top=m),y=A=r+y,k=S=o+k,D.left>y&&(D.left=y),D.bottom>k&&(D.bottom=k),D.right<y&&(D.right=y),D.top<k&&(D.top=k),b=A=r+b,w=S=o+w,D.left>b&&(D.left=b),D.bottom>w&&(D.bottom=w),D.right<b&&(D.right=b),D.top<w&&(D.top=w),E.push(new qc(new pc(p,m),new pc(y,k),new pc(b,w))),!T;)x=C,R+=I*zc/2;return{arrAp:E,pdfRect:D}}var Xc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,P._)(this,n),(i=t.call(this,e)).closing=r,i.showText=!0,i}return(0,A._)(n,[{key:"setFlag",value:function(e,t){this.closing=e,this.showText=t}},{key:"doPrepare",value:function(){(0,S._)((0,x._)(n.prototype),"doPrepare",this).call(this),this.canvas.classList.add("fv__viewer-render-polygon")}},{key:"doRender",value:function(e){var t=e.renderingData,n=t.annotInfo,i=n.borderInfo||{},r=e.scale,o=e.rotate,a=this.convertPointToPixel(0==i.width?.5:i.width,r);if(0!=a||-1!=n.borderColor||n.fillColor){var s=this.canvas.getContext("2d");if(s.clearRect(0,0,this.canvas.width,this.canvas.height),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){var u=t.page,c=e.innerRect,l=e.outerRect,d=t.vertexes.map((function(e){var t=(0,E._)(u.getDevicePoint([e.x,e.y],r,o),2),n=t[0],i=t[1];return new pc(n-c.left,i-c.top)})),h=t.vertexes.map((function(e){var t=(0,E._)(u.getDevicePoint([e.x,e.y],r,o),2),n=t[0],i=t[1];return new pc(n-l.left,i-l.top)}));e.vertexes=d,s.save(),e.lineWidth=a,s.globalAlpha=n.opacity,0===a||!1===n.hasBorderColor?s.strokeStyle="transparent":s.strokeStyle=this.numberToRGBAString(n.color),s.lineWidth=a;try{switch(i.style){case me.DASHED:case me.SOLID:case me.UNDERLINE:case me.BEVELED:this.renderSolid(s,n,e),this.setContents(s,n.contents,d);break;case me.CLOUDY:0==a?this.renderSolid(s,n,e):this.renderCloud(s,n,e),this.setContents(s,n.contents,h)}}finally{s.restore()}}}}},{key:"renderCloud",value:function(e,t,n){var i=t.fillColor,r=t.borderInfo.cloudIntensity,o=n.innerRect,a=n.outerRect,s=new Gc(n.vertexes,o,a),u=n.renderingData.vertexes,c=u.length;(c=c*=2==r?8:16,u.length>=2)&&(c=function(e,t){var n=2,i=Math.abs(e.right-e.left),r=Math.abs(e.bottom-e.top);n=1===t?parseInt((i+r)/4):parseInt((i+r)/6);return n<2&&(n=2),n%2!=0&&(n+=1),n}(this.calculateRect(u),r));s.generate(16/r,e,c).render(e),i&&(e.fillStyle=this.numberToRGBAString(i),e.fill()),e.stroke();try{if(!j.isTouchDevice)return;var l=o.left-a.left,d=o.top-a.top,h=n.vertexes.map((function(e){return{x:e.x+l,y:e.y+d}}));void 0===n.renderingData.annotInfo.id&&Bc(e,h)}catch(e){}}},{key:"renderSolid",value:function(e,t,n){var i=this,r=n.scale,o=t.borderInfo,a=o.dashes||[],s=o.dashPhase||0,u=t.fillColor;o.style===me.DASHED&&(e.setLineDash&&e.setLineDash(a.map((function(e){return i.convertPointToPixel(e,r)}))),e.lineDashOffset=this.convertPointToPixel(s,r)),new Nc(n.vertexes,this.closing).render(e),u&&(e.fillStyle=this.numberToRGBAString(u),e.fill()),e.stroke();try{if(!j.isTouchDevice)return;void 0===n.renderingData.annotInfo.id&&Bc(e,n.vertexes)}catch(e){}}},{key:"setMarkUp",value:function(e,t){var n=bc(this.component,e,t),i=n.renderingData,r=n.innerRect;e=n.scale,t=n.rotate;var o=i.annotInfo,a=o.borderInfo||{},s=this.convertPointToPixel(a.width,e),u=this.canvas.getContext("2d");u.clearRect(0,0,this.canvas.width,this.canvas.height);var c=i.page,l=i.vertexes.map((function(n){var i=(0,E._)(c.getDevicePoint([n.x,n.y],e,t),2),o=i[0],a=i[1];return new pc(o-r.left,a-r.top)}));u.save(),u.strokeStyle=this.numberToRGBAString(o.color),u.lineWidth=s;var d=this.closing;this.closing=!0,this.renderSolid(u,o,{vertexes:l}),u.beginPath(),l.forEach((function(e){return wc(u,e)})),this.closing=d}},{key:"setContents",value:function(e,t,n){var i;if(void 0!==t&&n&&!(n.length<3)&&this.showText){var r=n[n.length-1],o=e;o.beginPath(),o.font="14px Verdana",o.textAlign="left",o.textBaseline="top",o.direction="ltr";var a=o.measureText(t).width;o.fillStyle="#AF6B6B";var s=n.map((function(e){return e.x})),u=(i=Math).min.apply(i,(0,I._)(s));Math.abs(r.x-u)>=a&&r.x>u?o.fillText(t,r.x-a,r.y,a):o.fillText(t,r.x,r.y,a),o.closePath()}}},{key:"calculateRect",value:function(e){var t={},n={x:0,y:0};t.left=t.right=e[0].x,t.bottom=t.top=e[0].y;for(var i=e.length,r=1;r<=i;r++)n=e[r%i],t.left>n.x&&(t.left=n.x),t.bottom>n.y&&(t.bottom=n.y),t.right<n.x&&(t.right=n.x),t.top<n.y&&(t.top=n.y);return t}}]),n}(nc),Zc=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="polygon",a}return(0,A._)(n,[{key:"activeMore",value:function(){var e=this.annot.getVertexes(),t=this.annot.getPathVertexes();this.$handler.addClass("fv__pdf-annot-polygon-container");var n=e.length;t.length>0&&(n=t.length),this.hammerInited=this.hammerInited||this.initHammer(n)}},{key:"updateRender",value:function(){var e=this;return this.annot.update().then((function(){var t=e._getShapeControllerBoundaryBox();e.shapeControl.active(e.$handler,e.getBoundary(),t)})).then((function(t){return(0,S._)((0,x._)(n.prototype),"updateRender",e).call(e)}))}},{key:"getPropertyOptions",value:function(){var e=this.annot;return{color:(0,j.colorConvertor)(e.getBorderColor(),"#"),opacity:e.getOpacity(),borderWidth:e.getBorderWidth(),cloudy:!0,fillColor:e.getFillColor(),disabled:this.propertyDisabled(),borderStyle:!0,isLocked:this.isLocked()}}},{key:"updateBorderProperty",value:function(e){switch(this.annot.getCloudIntensity()){case 1:e.find("#borderStyle-select [value=6]").attr("selected",!0);break;case 2:e.find("#borderStyle-select [value=7]").attr("selected",!0)}}},{key:"backupProperty",value:function(e){if(!e)return this.oldRect=Object.assign({},this.annot.getRect());this.oldVertex=Object.assign({},this.annot.getVertexes())}},{key:"setCloudyIntensity",value:function(e){var t=this;this.annot.setBorderStyle(me.CLOUDY,e).then((function(){return t.updateRender().then((function(){t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t)}))}))}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{})}}]),n}(Hc);const Qc=Zc;var el="annotComponent",tl={properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n){this.data(el).showPropertiesDialog(e,t,n)}},actions:{name:"actions",nameI18nKey:"viewer_:contextmenu.annot.actions",callback:function(){this.data(el).showActionsDialog()},disabled:function(){return this.data(el).actionsDisabled()}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(el).removeAnnot()},disabled:function(){return this.data(el).deleteDisabled()}}};var nl=g(9059),il=g.n(nl),rl=function(){function e(t,n,i){var r=this;(0,P._)(this,e),this.annotRender=t,this.annot=this.annotRender.annot,this.pdfViewer=this.annotRender.pdfViewer;var o={};if(i)switch(o.type=i.getType(),o.type){case"TypeURI":o.uri=i.getURI();break;case"TypeGoto":o.destination=i.getDestination()}var a=il()(o);n||(a='<dialog class="fv__dialog fv__annot-properties-dialog">'.concat(a,"</dialog>"));var s=O()(a);this.$actionsDialog=s;var u=n||document.body;if(s.appendTo(u),this.bindChangeEvent(),this.update(o),!n||n===document.body){var c=s[0];ou().registerDialog(c),c.showModal()}this.$gotoInput=s.find("#goto-input"),this.$gotoLeftValue=s.find(".fv__action-dialog-goto-left-value"),this.$gotoTopValue=s.find(".fv__action-dialog-goto-top-value"),this.$urlInput=s.find("#url-input");var l=this.pdfViewer.getPDFDocRender().getPDFDoc().getPageCount();if(this.$gotoInput.attr({max:l}),o&&o.type)switch(o.type){case"TypeURI":this.$urlInput.val(o.uri);break;case"TypeGoto":this.$gotoInput.val(o.destination.pageIndex+1);var d=this.pdfViewer.getPDFPageRender(o.destination.pageIndex);d&&d.getPDFPage().then((function(e){var t=(0,E._)(e.getDevicePoint([o.destination.left,o.destination.top],d.getScale(),d.getRotation()),2),n=t[0],i=t[1];r.$gotoLeftValue.html(n.toFixed(2)),r.$gotoTopValue.html(i.toFixed(2))}))}}return(0,A._)(e,[{key:"update",value:function(e){var t=this.$actionsDialog;e&&e.type&&(t.find("#select-action [value="+e.type+"]").attr("selected",!0),t.find(".fv__action-dialog-box").css("display","none"),t.find("[data-type="+e.type+"]").css("display","block"))}},{key:"bindChangeEvent",value:function(){var e=this,t=this.$actionsDialog,n=this.pdfViewer.getPDFDocRender(),i=n.viewerRender.scrollWrap;this.pdfViewer.eventEmitter.on(de.zoomToSuccess,(function(e,t){o()})),this._unwatchScrollEvent=i.addScrollEventListener(o);var r=this;function o(){var e=function(e){for(var t=e.$container.find(".fv__pdf-view-mode-item"),n=e.viewerRender.scrollWrap,i=n.getScrollTop(),r=(n.getHeight(),n.getScrollLeft()),o=(n.getWidth(),0),a=0,s=0,u=0;u<t.length;u++){var c=t[u],l=O()(c).width(),d=O()(c).height(),h=c.offsetTop,f=h+d,g=c.offsetLeft;if(f>i&&g+l>r){o=u,s=i-h,a=r-g;break}}return{pageIndex:o,left:a,top:s}}(n);r.$gotoInput.val(e.pageIndex+1),r.$gotoLeftValue.html(e.left.toFixed(2)),r.$gotoTopValue.html(e.top.toFixed(2))}t.on("click",".fv__action-btn-cancel",(function(){e.annotRender.hideActionsDialog()})).on("click",".fv__action-dialog-close-icon",(function(){e.annotRender.hideActionsDialog()})).on("change","#select-action",(function(e){var n=e.target.value;t.find(".fv__action-dialog-box").css("display","none"),t.find("[data-type="+n+"]").css("display","block")})).on("click",".fv__action-btn-ok",(function(n){var i=t.find("#select-action").val();if("TypeURI"===i){var o=t.find("#url-input").val(),a=new Nr;e.annot.setAction(-1,a).then((function(){var t=e.annot.getAction();e.annot.setActionData(t,{uri:o}).then((function(){e.annotRender.hideActionsDialog()}))}))}else if("TypeGoto"===i){var s=e.pdfViewer.getPDFDocRender().getScale(),u=new Zr;e.annot.setAction(-1,u).then((function(){var t={};t.pageIndex=e.$gotoInput.val()-1;var n=r.pdfViewer.getPDFPageRender(t.pageIndex),i=n.getScale();n.getPDFPage().then((function(r){var o=(0,E._)(r.reverseDevicePoint([Number(e.$gotoLeftValue.html()),Number(e.$gotoTopValue.html())],i,n.getRotation()),2),a=o[0],u=o[1];t.left=a,t.top=u,"fitWidth"===s?t.type="ZoomFitHorz":"fitHeight"===s?t.type="ZoomFitPage":(t.type="ZoomXYZ",t.zoomFactor=i);var c=e.annot.getAction();e.annot.setActionData(c,t).then((function(){e.annotRender.hideActionsDialog()}))}))}))}})).on("input","#goto-input",(function(t){var n=t.target.value;e.pdfViewer.getPDFDocRender().goToPage(n-1,{x:0,y:0})}))}},{key:"close",value:function(){var e=this.$actionsDialog;this._unwatchScrollEvent&&this._unwatchScrollEvent(),e&&(e[0].close(),e.remove(),this.$actionsDialog=null)}}]),e}();var ol,al=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"doPrepare",value:function(){(0,S._)((0,x._)(n.prototype),"doPrepare",this).call(this),this.canvas.classList.add("fv__viewer-render-square-canvas")}},{key:"doRender",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.renderingData.annotInfo,i=n.borderInfo||{},r=this.convertPointToPixel(i.width||1,e.scale),o=this.canvas.getContext("2d");if(o.clearRect(0,0,this.canvas.width,this.canvas.height),o.save(),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){e.lineWidth=r,t&&(o.globalAlpha=n.opacity),0===r||!1===n.hasBorderColor?o.strokeStyle="transparent":o.strokeStyle=this.numberToRGBAString(n.color),o.lineWidth=r;try{switch(i.style){case me.BEVELED:case me.UNDERLINE:case me.SOLID:this.renderSolid(o,n,e);break;case me.DASHED:this.renderDashed(o,n,e);break;case me.CLOUDY:this.renderCloud(o,n,e)}var a=n.fillColor;a&&(o.fillStyle=this.numberToRGBAString(a),o.fill()),o.stroke()}finally{o.restore()}}}},{key:"shrinkRect",value:function(e,t){var n=Ra.on(e).shrink(t).extract();return Object.assign(n,{width:n.right-n.left,height:n.bottom-n.top})}},{key:"renderCloud",value:function(e,t,n){t.fillColor;var i=t.borderInfo.cloudIntensity,r=this.shrinkRect(n.innerRect,0),o=this.shrinkRect(n.outerRect,0),a=r.width,s=r.height;new Gc([new pc(0,s),new pc(a,s),new pc(a,0),new pc(0,0)],r,o).generate(32/3/i).render(e)}},{key:"renderDashed",value:function(e,t,n){var i=this,r=t.borderInfo,o=r.dashes||[],a=r.dashPhase||0,s=n.scale;e.save(),e.setLineDash&&e.setLineDash(o.map((function(e){return i.convertPointToPixel(e,s)}))),e.lineDashOffset=this.convertPointToPixel(a,s),this.renderSolid(e,t,n)}},{key:"renderSolid",value:function(e,t,n){var i=n.lineWidth,r=n.innerRect,o=n.outerRect,a=r.width,s=r.height,u=.5*i,c=r.left-o.left,l=r.top-o.top;e.beginPath(),e.rect(u+c,u+l,a-i,s-i),e.closePath()}}]),n}(nc),sl=(function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,A._)(n,[{key:"doPrepare",value:function(){(0,S._)((0,x._)(n.prototype),"doPrepare",this).call(this),this.canvas.style.cssText+="box-sizing: content-box;"}},{key:"doRender",value:function(e){var t=e.renderingData;if(this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()){var n=this.canvas.getContext("2d");return n.clearRect(0,0,this.canvas.width,this.canvas.height),void n.save()}return t.highlightModeIsActive?this.doRenderHighlightMode(e):(t.highlightingMode===Ee.PUSH&&(this.canvas.style.cssText+="border: none; border-color: none;"),this.doRenderNormal(e))}},{key:"doRenderHighlightMode",value:function(e){switch(e.renderingData.highlightingMode){case Ee.NONE:return this.doRenderNormal(e);case Ee.OUTLINE:return this.renderOutline(e);case Ee.INVERT:return this.renderInvert(e);case Ee.PUSH:return this.renderPush(e);case Ee.TOGGLE:return this.renderToggle(e)}}},{key:"doRenderNormal",value:function(e){this.renderSquare(e)}},{key:"getLineWidth",value:function(e,t){return this.convertPointToPixel(e,t)/2}},{key:"renderSquare",value:function(e){var t=e.renderingData.annotInfo,n=t.borderInfo,i=this.getLineWidth(n.width,e.scale);if(0!=i||-1!=t.borderColor||t.fillColor){var r=this.canvas.getContext("2d");if(r.clearRect(0,0,this.canvas.width,this.canvas.height),r.save(),e.lineWidth=i,r.globalAlpha=t.opacity,0===i||!1===t.hasBorderColor?r.strokeStyle="transparent":r.strokeStyle=this.numberToRGBAString(t.color),r.lineWidth=i,n.style===me.DASHED)this.renderDashed(r,t,e);else this.renderSolid(r,t,e);r.stroke()}}},{key:"renderInvert",value:function(e){var t=this,n=this.canvas.getContext("2d"),i=e.renderingData,r=i.page,o=i.annotInfo.borderInfo||{},a=(this.getLineWidth(o.width||0,e.scale),e.outerRect),s={x:a.left,y:a.top,width:a.width,height:a.height};r.getPageBitmap(4*e.scale/3,e.rotate,s,["page","annot"]).then((function(e){var i=e.width,r=e.height,o=e.buffer;n.clearRect(0,0,t.canvas.width,t.canvas.height);var a=new(Uint8ClampedArray||Uint8Array)(o),s=n.createImageData(i,r);s.data.set(a),n.save();for(var u=s.data,c=0;c<u.length;c+=4)u[c]^=255,u[c+1]^=255,u[c+2]^=0;n.putImageData(s,0,0),n.restore()}))}},{key:"renderToggle",value:function(e){}},{key:"renderPush",value:function(e){var t=this,n=this.canvas.getContext("2d");n.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.style.cssText+="\n            border: 1px solid;\n            border-color: black #aaa #aaa black;\n        ";var i=e.renderingData.page,r=e.outerRect,o={x:r.left,y:r.top,width:r.width,height:r.height};i.getPageBitmap(4*e.scale/3,e.rotate,o,["page","annot"]).then((function(i){var r=i.width,o=i.height,a=i.buffer;n.clearRect(0,0,t.canvas.width,t.canvas.height);var s=new(Uint8ClampedArray||Uint8Array)(a),u=n.createImageData(r,o);u.data.set(s),n.putImageData(u,0,0),t.renderSquare(e)}))}},{key:"renderOutline",value:function(e){var t=this.canvas.getContext("2d");t.clearRect(0,0,this.canvas.width,this.canvas.height);var n=e.renderingData.annotInfo.borderInfo||{};this.renderSquare(e);var i=5*this.getLineWidth(n.width||0,e.scale)/6,r=.5*i,o=e.outerRect;t.save(),t.lineWidth=i,t.strokeStyle="black",t.strokeRect(r,r,o.width-i,o.height-i),t.restore()}}])}(al),el),ul=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:tl,events:{show:function(){return this.data(el).updateDeleteStatus(!0),!0},hide:function(){return this.data(el).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),cl="px",ll=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),a=t.call(this,e,i,r,o),j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e={moveable:!0,resizable:!0,enableDiagonally:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,w._)(a),Object.keys(e)),n=new zu(Object.assign(e,t,{emitter:a.pdfViewer.eventEmitter,start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t){return a.onShapeMoving(e,t)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotatable:!1,auxiliaryLine:void 0}));a.moveDisabled()&&n.disable(),n.ownsTo(a.disposor);var i=a.pdfViewer.getAnnotAuthorityManager();a.addDestroyHook(i.subscribe(a.annot,(function(e){a.updateOnPermissionChange(e)})));var r=a.pdfViewer.eventEmitter,o=function(){a.isDestroyed||a.annot.isDestroyed||i.getPermission(a.annot).then((function(e){a.updateOnPermissionChange(e)}))};return r.on(de.permissionChanged,o),a.addDestroyHook((function(){r.off(de.permissionChanged,o)})),n})),a.addDestroyHook(a.pdfViewer.getCustomOptionsUpdater().onGetAnnotComponentConfigUpdated((function(){if(j.Lazy.hasProperty((0,w._)(a),"shapeControl")&&j.Lazy.isPropertyIntialized((0,w._)(a),"shapeControl")){var e=a.shapeControl.isActive,t=a.shapeControl;j.Lazy.reset((0,w._)(a),"shapeControl"),e&&a._applyShapeChange(),t.destroy()}}))),a.name="link",a.highlightModeIsActive=!1,a.$ui.addClass("pdf-page-link-annot-container"),a.$handler.addClass("pdf-page-link-annot-handler-container");var s=a.pdfViewer.i18n,u=Mo().i18n=function(e){return s.t(e)};a.addDestroyHook((function(){Mo().i18n===u&&(Mo().i18n=void 0)}));var c=j.isTouchDevice?"touchstart":"mousedown";return a.$ui.on(c,(function(e){a.highlightModeIsActive=!0,a.render();var t=j.isTouchDevice?"touchend":"mouseup";window.addEventListener(t,(function(){a.highlightModeIsActive=!1,a.render()}),{capture:!0,once:!0})})),a.pdfViewer.eventEmitter.on(de.pageRemoved,a.pageRemoved=function(e){var t=a.annot&&"TypeGoto"==a.annot.action.info.type&&a.annot.action.info.destination&&a.annot.action.info.destination.pageIndex;if(a.annot&&"number"==typeof t&&t==e){var n=a.annot;n.hasPA().then((function(e){e&&n.resetAByPA()}))}}),a}return(0,A._)(n,[{key:"actionsDisabled",value:function(){return!(32&this.docRender.getUserPermission().getValue())}},{key:"onStartUpdateShape",value:function(e,t,n){}},{key:"onShapeUpdating",value:function(e){e.width<1||e.height<1||this.setRect(e)}},{key:"onShapeMoving",value:function(e,t){this.$ui.css({left:e.left,top:e.top})}},{key:"onShapeUpdateEnd",value:function(e,t,n){switch(n){case zu.ACTION_MOVE:return this.moveTo(e.left,e.top,n);case zu.ACTION_RESIZE:return e.width<1||e.height<1?Promise.resolve():this.setRect(e)}}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;return[Math.ceil(c/r),Math.ceil(u/r),u,c,r,i,e,t,a.left,a.top]}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)}},{key:"movedByOther",value:function(){this.isActive&&(this.activeRect(),this.shapeControl.updateBoundary(this.getBoundary()))}},{key:"doAction",value:function(){this.pdfViewer.actionManager.get(this.annot.action,this).active()}},{key:"afterRender",value:function(e){if(e.transformed&&this.isActive){this.activeRect();var t=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),t)}}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"activeMore",value:function(e,t){}},{key:"activeMoreItem",value:function(){}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.$handler.removeClass("active"),this.shapeControl.deactive()}},{key:"unActiveMore",value:function(){}},{key:"renderDestroy",value:function(){this.tileCanvas&&this.tileCanvas.destroy(),this.$handler.remove()}},{key:"updateBorderProperty",value:function(){}},{key:"getPropertyOptions",value:function(){var e=this.annot;return{color:(0,j.colorConvertor)(e.getBorderColor(),"#"),borderWidth:e.getBorderWidth(),highlightingMode:e.getHighlightingMode(),actionType:this.$action&&this.$action.getType(),disabled:this.propertyDisabled(),minBorderWidth:0,borderStyle:!0,isLocked:this.isLocked()}}},{key:"showPropertiesDialog",value:function(){this.$propertiesControl=new uu(this,document.body),this.updateDeleteStatus(!0)}},{key:"hidePropertiesDialog",value:function(){this.$propertiesControl&&this.$propertiesControl.close(),this.updateDeleteStatus(!1)}},{key:"showActionsDialog",value:function(){this.$actionsControl=new rl(this,document.body,this.annot.action),this.updateDeleteStatus(!0)}},{key:"hideActionsDialog",value:function(){this.$actionsControl.close(),this.updateDeleteStatus(!1)}},{key:"setColor",value:function(e){var t=this;return this.annot.setBorderColor(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(){return n.updateRender().then((function(){n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n)}))}))}},{key:"setHighlightingMode",value:function(e){var t=this;return this.annot.setHighlightingMode(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"redraw",value:function(){return this.activeRect(),this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),this.render()}},{key:"updateRender",value:function(){return Promise.resolve()}},{key:"destroy",value:function(){this.$propertiesControl=null,this.contextMenu&&this.contextMenu.destroy(),this.pageRemoved&&this.pdfViewer.eventEmitter.off(de.pageRemoved,this.pageRemoved),this.pageRemoved=null,(0,S._)((0,x._)(n.prototype),"destroy",this).call(this)}},{key:"showContextMenu",value:function(e,t){if(this.contextMenu){if(j.isDesktop&&this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()===mn)return;return this.contextMenu.setCurrentTarget(this),this.contextMenu.showAt(e,t)}return!1}},{key:"removeAnnot",value:function(){var e=this;return this.getAppPermission().then((function(t){return t.ignorable()&&e.deleteDisabled()?Promise.resolve():t.isDeletable()?e.doRemoveAnnot():void 0})).then((function(t){var n=e.pdfViewer.getCurrentActivatable();return n&&n.remove&&n.remove(e),t}))}},{key:"doRemoveAnnot",value:function(){var e=this,t=this.pdfViewer,n=t.eventEmitter,i=this.annot;return Promise.resolve((t.customs.removeAnnotBefore||j.noop)(this)).then((function(t){if(n.emit(de.removeActionAnnotationBefore,e),!1!==t)return i.getPDFPage().removeAnnot(i).then((function(t){return n.emit(de[t?"removeActionAnnotationSuccess":"removeActionAnnotationFailed"],e,i),t}),(function(){n.emit(de.removeActionAnnotationFailed,e)}))}))}},{key:"removeAnnotRender",value:function(){this.renderDestroy(),this.parent().remove()}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceRect(n,i);t.css({left:r.left+cl,top:r.top+cl,width:r.right-r.left+cl,height:r.bottom-r.top+cl})}},{key:"rectInit",value:function(){var e=this.$handler,t=O()(this.createRectDom());e.append(t);var n=t[0],i=this.rectHammer=new Hammer.Manager(n,{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});return i.add(new Hammer.Tap({event:"doubletap",taps:2})),i.add(new Hammer.Tap({event:"singletap"})),i.get("doubletap").recognizeWith("singletap"),i.get("singletap").requireFailure("doubletap"),this.contextMenuIsEnable()&&(e.on("contextmenu",(function(e){e.preventDefault()})),e.on("mouseup",(function(e){e.stopPropagation()})),this.contextMenu=this.pdfViewer.viewerUI.createContextMenu(this,e.get(0),this.getContextMenuConfig()),t.data(sl,this)),this.addDestroyHook((function(){i.destroy()})),t}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"getContextMenuConfig",value:function(){if(ol)return ol;var e=this.constructor.getDefaultContextMenuConfig();for(var t in this.updateContextMenuConfig(e),e)if("items"===t){var n=e[t],i=this.pdfViewer.i18n;for(var r in n){var o=n[r];o.nameI18nKey&&(o.name=i.t(o.nameI18nKey))}}return e}},{key:"doubleTapAnnot",value:function(){}},{key:"updateContextMenuConfig",value:function(e){}},{key:"active",value:function(e){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.$handler.addClass("active"),this.activeRect(),this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e)}},{key:"tapAnnot",value:function(e){if(this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()!==mn)return(0,S._)((0,x._)(n.prototype),"tapAnnot",this).call(this,e);e&&0==e.button&&this.doAction()}},{key:"invisibleRender",value:function(){}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{highlightingMode:this.annot.getHighlightingMode(),highlightModeIsActive:this.highlightModeIsActive})}}],[{key:"getDefaultContextMenuConfig",value:function(){return ul}},{key:"setContextMenuConfig",value:function(e){ol=e}}]),n}(To);const dl=ll;var hl=2*Math.PI;var fl=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"doRender",value:function(e){var t=e.renderingData.annotInfo,n=t.borderInfo||{},i=this.convertPointToPixel(n.width||1,e.scale);if(0!=i||-1!=t.borderColor||t.fillColor){var r=this.canvas.getContext("2d");if(r.clearRect(0,0,this.canvas.width,this.canvas.height),r.save(),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){e.lineWidth=i,r.globalAlpha=t.opacity,0===i||!1===t.hasBorderColor?r.strokeStyle="transparent":r.strokeStyle=this.numberToRGBAString(t.color),r.lineWidth=i;try{switch(n.style){case me.SOLID:this.renderSolid(r,t,e);break;case me.BEVELED:break;case me.DASHED:this.renderDashed(r,t,e);break;case me.CLOUDY:0==n.cloudIntensity?this.renderSolid(r,t,e):this.renderCloud(r,t,e)}var o=t.fillColor;o&&(r.fillStyle=this.numberToRGBAString(o),r.fill()),r.stroke(),this.setContents(r,t.contents,e)}finally{r.restore()}}}}},{key:"renderSolid",value:function(e,t,n){this.renderDashed(e,t,n)}},{key:"renderDashed",value:function(e,t,n){var i=t.borderInfo,r=n.lineWidth,o=n.innerRect,a=n.outerRect,s=i.dashes||[],u=i.dashPhase||0,c=.5*r,l=new pc(.5*(o.left+o.right)-a.left,.5*(o.top+o.bottom)-a.top),d=Math.abs(.5*o.height-c),h=Math.abs(.5*o.width-c);e.lineDashOffset=u,e.setLineDash&&e.setLineDash(s),e.beginPath(),function(e,t,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI,u=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];e.ellipse?e.ellipse(t,n,i,r,o,a,s,u):(e.save(),e.translate(t,n),e.rotate(o),e.scale(i,r),e.arc(0,0,1,a,s,u),e.restore())}(e,l.x,l.y,h,d),e.closePath()}},{key:"renderCloud",value:function(e,t,n){var i=t.borderInfo.cloudIntensity,r=.5*n.lineWidth,o=this.shrinkRect(n.innerRect,r),a=this.shrinkRect(n.outerRect,r),s=new pc(.5*(a.right-a.left)-(o.left-a.left),.5*(a.bottom-a.top)-(o.top-a.top)),u=.5*o.height-r,c=.5*o.width-r,l=16/i,d=Math.PI/l,h=2*Math.PI,f=Array(Math.floor(h/d)-1).fill(0).map((function(e,t){return t*d%h})).map((function(e){var t=c*Math.cos(h-e),n=u*Math.sin(h-e);return s.add(t,n)}));new Gc(f,o,a).generate(1,e).render(e)}},{key:"shrinkRect",value:function(e,t){var n=Ra.on(e).shrink(t).extract();return Object.assign(n,{width:n.right-n.left,height:n.bottom-n.top})}},{key:"setContents",value:function(e,t,n){if(void 0!==t){var i=n.innerRect,r=n.outerRect,o=.5*(i.left+i.right)-r.left,a=.5*(i.top+i.bottom)-r.top,s=e;s.beginPath(),s.font="14px Verdana",s.textAlign="left",s.textBaseline="top",s.direction="ltr";var u=s.measureText(t).width;s.fillStyle="#AF6B6B",s.fillText(t,o-u/2,a-7,u),s.closePath()}}}]),n}(nc);var gl=function(){return nu(arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect")}(),vl=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),a=t.call(this,e,i,r,o),j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e={moveable:!0,resizable:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,w._)(a),Object.keys(e)),n=new zu(Object.assign(e,t,{emitter:a.pdfViewer.eventEmitter,start:function(){return a.onStartUpdateShape()},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t){return a.onShapeMoving(e,t)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotatable:!1,auxiliaryLine:void 0}));return a.processShapeControlPermissionCtrl(n),n})),a.$ui.addClass("circle-ui"),a}return(0,A._)(n,[{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox(),t=this.getInnerBoundary();this.shapeControl.active(this.$handler,t,e),this._updateShapeControlMargin()}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(this.annot),this._applyShapeChange();var e=this.shapeControl.getPreviewerContext();this._previewUpdatedShape(this.shapeControl.getCurrentShape(),e)}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceInnerRect(n,i),o="px";t.css({left:r.left+o,top:r.top+o,width:r.right-r.left+o,height:r.bottom-r.top+o})}},{key:"_updateShapeControllerBoundaryBox",value:function(){this.shapeControl.updateBoundaryBox(this._getShapeControllerBoundaryBox()),this._updateShapeControlMargin()}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2),n=t[0],i=t[1],r=this.getInnerRect(),o=this.getRect(),a=Ra.subtract(r,o);return Ra.on({left:0,top:0,right:n,bottom:i}).add(a).extract()}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive()}},{key:"onStartUpdateShape",value:function(e,t){this.editDebouncePromise||(this.editDebouncePromise=new j.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e,t){var n=this;this.updateCollabOp(e),this.pdfViewer.config.highPerformance&&(this._previewUpdatedShape(e,t),this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return n.setRect(n._transformShapeOfInnerRectToOuterRect(e)).then((function(e){n._updateShapeControllerBoundaryBox()}))})))}},{key:"onShapeMoving",value:function(e,t){var n=this;this.updateCollabOp(e),this.justMoved=!0,this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){var t=n.getRect(),i=n.getInnerRect(),r=t.left-i.left,o=t.top-i.top;return n.moveTo(e.left+r,e.top+o).then((function(e){n._updateShapeControllerBoundaryBox()}))}))}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;this._previewUpdatedShape(e,t);var r=this.getRect(),o=this.getInnerRect(),a=r.left-o.left,s=r.top-o.top;return this.editDebouncePromise?this.editDebouncePromise.waitForLastTask().then((function(){var t=!!i.justMoved;return i.moveTo(e.left+a,e.top+s,n,!0,!1,t).then((function(t){!i.justMoved&&i._setRect(i._transformShapeOfInnerRectToOuterRect(e),!0),i.justMoved=!1})).then((function(e){i._updateShapeControllerBoundaryBox()}))})):Promise.resolve()}},{key:"_transformShapeOfInnerRectToOuterRect",value:function(e){var t={left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},n=Ra.subtract(this.getRect(),this.getInnerRect()),i=Ra.on(t).add(n).extract();return{left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top}}},{key:"_previewUpdatedShape",value:function(e,t){t.clearRect(0,0,e.width,e.height);var n=e.width/2,i=e.height/2,r=n,o=i;t.strokeStyle="#759DB8",t.lineWidth=1,function(e,t,n,i,r){var o=Math.max(i,r),a=i/o,s=r/o;e.save(),e.scale(a,s),e.beginPath(),e.arc(t/a,n/s,o,0,hl,!1),e.closePath(),e.restore()}(t,n,i,r,o),t.stroke()}},{key:"getPropertyOptions",value:function(){var e=this.annot;return{color:(0,j.colorConvertor)(e.getBorderColor(),"#"),opacity:e.getOpacity(),borderWidth:e.getBorderWidth(),cloudy:!0,fillColor:e.getFillColor(),disabled:this.propertyDisabled(),borderStyle:!0,isLocked:this.isLocked()}}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return t._handlerRerender(e)}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(e){return n._handlerRerender(e)}))}},{key:"setCloudIntencity",value:function(e){return this.setBorderStyle(me.CLOUDY,e)}},{key:"setFillColor",value:function(e){var t=this;return this.annot.setFillColor(e).then((function(e){return t._handlerRerender(e)}))}},{key:"getInnerRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.getPDFPage(),i=this.annot.getInnerRect(),r=n.getDeviceRect(i,e,t);return{left:r.left,top:r.top,right:r.right,bottom:r.bottom}}},{key:"getInnerBoundary",value:function(){var e=this.getPDFPage(),t=this.annot.getInnerRect(),n=e.getDeviceRect(t,this.scale,this.rotate);return{left:n.left,top:n.top,width:n.right-n.left,height:n.bottom-n.top}}},{key:"_handlerRerender",value:function(e){var t=this;return e?this.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}},{key:"_updateShapeControlMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(Ra.expandOffset(t,e))}}],[{key:"getDefaultContextMenuConfig",value:function(){return gl}}]),n}(ku),pl=g(3110),ml=g.n(pl),yl=g(7308),kl=g.n(yl),bl=g(3856),wl=g.n(bl),_l=g(4814),Pl=g.n(_l),Al=g(9797),Sl=g.n(Al),xl=g(4739),Cl=g.n(xl),Dl=g(1158),El=g.n(Dl),Il=g(2186),Rl=g.n(Il),Tl=g(927),Fl=g.n(Tl),Ml=g(5984),Ol=g.n(Ml),Ll=g(1490),Nl=g.n(Ll),Vl=g(9856),Bl=g.n(Vl),jl=g(7156),Ul=g.n(jl),Hl=g(9649),Wl=g.n(Hl),Yl=g(7283),ql=g.n(Yl);const Kl={Check:ml(),Circle:kl(),Comment:wl(),Cross:Pl(),Help:Sl(),Insert:Cl(),Key:El(),NewParagraph:Rl(),Note:Fl(),Paragraph:Ol(),RightArrow:Nl(),RightPointer:Bl(),Star:Ul(),UpArrow:Wl(),UpLeftArrow:ql()};var $l=g(1583),zl=g.n($l),Gl=g(6283),Jl=g.n(Gl),Xl=g(6852),Zl=g.n(Xl),Ql=g(8807),ed=g.n(Ql);const td={Graph:zl(),Paperclip:Jl(),PushPin:Zl(),Tag:ed()};var nd=g(8998),id=g.n(nd),rd=g(7697),od=g.n(rd),ad=g(9291),sd=g.n(ad);const ud={Ear:id(),Mic:od(),Speaker:sd()};var cd={};var ld;!function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).annot=e.annot,i}(0,A._)(n,[{key:"render",value:function(e,t){var n=this.annot,i=n.getFlags(),r=n.getDeviceRect(e,t);r.width=r.right-r.left,r.height=r.bottom-r.top,8&i&&(r.width/=4*e/3,r.height/=4*e/3);var o=function(e,t,n){if(!e||!t)return"";var i,r=e+t+n;if(r in cd)return cd[r];if("text"===e?i=Kl:"fileattachment"===e?i=td:"sound"===e&&(i=ud),!i)return"";var o=i[t]({fillColor:n});return cd[r]=o}(n.getType(),n.getIconName(),(0,j.colorConvertor)(n.getBorderColor(),"#")),a="unset";return this.component.needToggleView&&this.component.needToggleView()&&(this.component.shouldRenderByMouseEvent()||(a="hidden")),this.component.$ui.css({left:r.left,top:r.top,width:r.width,height:r.height,opacity:n.getOpacity(),visibility:a}).empty().html(o),Promise.resolve()}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.annot=null}}])}(tc);!function(e){e.fully="fully",e.playable="playable",e.adjustable="adjustable",e.deletable="deletable",e.modifiable="modifiable",e.attachmentDownloadable="attachmentDownloadable",e.replyable="replyable",e.editable="editable"}(ld||(ld={}));var dd=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="note",a.$ui.addClass("fv__pdf-page-note-annot-container"),a.$handler.addClass("fv__pdf-page-note-annot-handler-container"),j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e=new zu({emitter:a.pdfViewer.eventEmitter,start:function(){return a.onStartUpdateShape()},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},resizable:!1,rotatable:!1,auxiliaryLine:void 0});return e.ui.classList.add("fv__pdf-page-annot-handler-rect"),a.processShapeControlPermissionCtrl(e),e})),a}return(0,A._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e),this.setMargin()}},{key:"activeRect",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,i=this.$rect=this.$rect||this.rectInit(),r=this.scale,o=this.rotate,a=n.getDeviceRect(r,o);if(8&this.annot.getFlags()){var s=this.annot.getRect();e=s.right-s.left,t=s.top-s.bottom}else{var u=this.annot.getDeviceRect(1,o);e=u.right-u.left,t=u.bottom-u.top}i.css({left:a.left,top:a.top,width:e,height:t})}},{key:"movedByOther",value:function(){this.isActive&&(this.activeRect(),this._applyShapeChange())}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive()}},{key:"setIconName",value:function(e){return this.annot.setIconName(e).then((function(e){return e}))}},{key:"createRectDom",value:function(){return this.shapeControl.ui}},{key:"onStartUpdateShape",value:function(){this.editDebouncePromiseQueue||(this.editDebouncePromiseQueue=new j.DebounceAsyncTaskExecutor(0))}},{key:"onShapeMoving",value:function(e,t,n){var i=this;if(this.updateCollabOp(e,!0),this.pdfViewer.config.highPerformance)this.editDebouncePromiseQueue.exec((function(){return i.moveTo(e.left,e.top).then((function(e){i.setMargin(),i._applyShapeChange()}))}));else{var r=this._moveOffset||{},o=r.offsetLeft||0,a=r.offsetTop||0;this._moveOffset={offsetLeft:o+n.offsetLeft,offsetTop:a+n.offsetTop}}}},{key:"onShapeUpdateEnd",value:function(e,t){var n=this;return this.editDebouncePromiseQueue.waitForLastTask().then((function(){return n.moveTo(e.left,e.top,"move").then((function(e){n.setMargin(),n._applyShapeChange()}))}))}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(Ra.expandOffset(t,e))}},{key:"redraw",value:function(e){return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=this.annot.info;if("R"==i.RT&&(0!=i.IRT||null!=i.RT))return Promise.resolve();if((0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t),1!=j.dpr&&this.tileCanvas){var r=this.getTileConfig(e,t),o=Math.max(.5,e*j.dpr/r[5]);this.tileCanvas.$container.css({transform:"scale("+o+")"})}}}]),n}(ku);const hd=dd;var fd=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"prepare",value:function(){var e=this,t=this.component,n=t.annot;this.tileCanvas=this.tileCanvas||new fr((function(i,r,o,a,s,u,c,l,d){return t.isDestroyed?Promise.resolve():t.getPDFPage().getAnnotBitmap(n.getId(),(0,U.F2)(u),d,{x:c*u+r*s,y:l*u+i*s,width:o,height:a},!0,t.renderAppearanceType,e.component.getAnnotFlag().flag)}),t.$ui)}},{key:"doHide",value:function(){this.tileCanvas.hideContainer()}},{key:"doShow",value:function(){this.tileCanvas.showContainer()}},{key:"doRender",value:function(e,t,n){var i=this;this.tileCanvas.setVisibleRect(n);var r=!0;if(n){var o=this.component.getRect(),a={left:Math.max(o.left,n.left),top:Math.max(o.top,n.top),right:Math.min(o.right,n.right),bottom:Math.min(o.bottom,n.bottom)};r=a.right>=a.left&&a.bottom>=a.top}var s,u,c=this.component.getTileConfig(e,t);return r?(s=this.tileCanvas).redraw.apply(s,(0,I._)(c)).then((function(e){if(!i.component.isDestroyed)return i.component.needToggleView&&i.component.needToggleView()&&!i.component.shouldRenderByMouseEvent()?(i.tileCanvas.clearCanvasContent(),Promise.resolve()):Promise.resolve()})):((u=this.tileCanvas).updateDom.apply(u,(0,I._)(c)),this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()?(this.tileCanvas.clearCanvasContent(),Promise.resolve()):Promise.resolve())}},{key:"willRender",value:function(){this.tileCanvas.$container.get(0).style.willChange="left, top, width, height"}},{key:"afterRender",value:function(){this.tileCanvas.$container.get(0).style.willChange="auto"}},{key:"destroy",value:function(){this.prepared&&((0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.tileCanvas.destroy(),this.tileCanvas=null)}},{key:"clearCache",value:function(){this.tileCanvas.clearCache()}},{key:"invisibleRender",value:function(){try{this.tileCanvas.invisibleRender()}catch(e){}}}]),n}(tc),gd=(function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,A._)(n,[{key:"doRender",value:function(e,t,i){var r=this;return(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e,t,i).then((function(){r.tileCanvas.$container.get(0).style.cssText+="\n                transform-origin: center;\n                transform: rotate(-".concat(t,"deg);\n            ")}))}}])}(fd),function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="file",a.$ui.addClass("fv__pdf-page-file-annot-container"),a.$handler.addClass("fv__pdf-page-file-annot-handler-container"),j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e=new zu({emitter:a.pdfViewer.eventEmitter,start:function(){return a.onStartUpdateShape()},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},resizable:!1,auxiliaryLine:void 0});return e.ui.classList.add("fv__pdf-page-annot-handler-rect"),(a.groupMoveDisabled()||a.moveDisabled())&&e.disable(),a.getAppPermission().then((function(t){t.isAdjustable()||t.isEditable()||e.disable()})),e})),a}return(0,A._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this._applyShapeChange()}},{key:"activeRect",value:function(){arguments.length>0&&void 0!==arguments[0]||this.annot;var e=this.$rect=this.$rect||this.rectInit(),t=this.scale,n=this.rotate,i=this.getRect(t,n);e.css({left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top})}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e),this.setMargin()}},{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive()}},{key:"setIconName",value:function(e){var t=this;return this.annot.setIconName(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"createRectDom",value:function(){return this.shapeControl.ui}},{key:"onStartUpdateShape",value:function(e,t){this.editDebouncePromise||(this.editDebouncePromise=new j.DebounceAsyncTaskExecutor(0))}},{key:"onShapeMoving",value:function(e,t,n){var i=this;this.updateCollabOp(e),this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return i.moveTo(e.left,e.top).then((function(e){i.setMargin(),i._applyShapeChange()}))}))}},{key:"onShapeUpdateEnd",value:function(e,t){var n=this;return this.editDebouncePromise?this.editDebouncePromise.waitForLastTask().then((function(){return n.moveTo(e.left,e.top,"move").then((function(e){n.setMargin(),n._applyShapeChange()}))})):Promise.resolve()}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(Ra.expandOffset(t,e))}},{key:"onDoubleTap",value:function(){return!1}},{key:"doubleTapAnnot",value:function(e){var t=this;if("comment"===e)return this.getAppPermission().then((function(e){e.isEditable()&&t.showReplyDialog("comment")}));this.rectDoubleTap()}},{key:"rectDoubleTap",value:function(){this.download()}},{key:"download",value:function(){var e=this;this.getAppPermission().then((function(t){t.isAttachmentDownloadable()&&e.doDownload()}))}},{key:"doDownload",value:function(){var e=this,t=this.pdfViewer;if(!this.annot.getFileSpec())return t.viewerUI.alert({message:"sidebar.attachment.emptyFile",level:"warning"});var n=Promise.resolve();t.getSafeReadingMode()&&(n=t.viewerUI.confirm({message:"sidebar.attachment.safeModeDownload",level:"warning"})),n.then((function(){e.annot.getFileattachmentStream().then((function(t){Fa(t,e.annot.getFileSpec().getFileName(),"application/octet-stream")}))}),qi)}},{key:"redraw",value:function(e){return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"getRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.getPDFPage(),i=this.annot.getRect(),r=n.getDeviceRect(i,e,t),o=n.getDeviceRect(i,e,0),a=o.right-o.left,s=o.bottom-o.top;return 8&this.annot.getFlags()&&(a=i.right-i.left,s=i.top-i.bottom),{left:r.left,top:r.top,right:r.left+a,bottom:r.top+s}}},{key:"getBoundary",value:function(){var e=this.annot.getDeviceRect(this.scale,this.rotate),t=this.annot.getDeviceRect(this.scale,0),n=this.annot.getRect(),i=t.right-t.left,r=t.bottom-t.top;return 8&this.annot.getFlags()&&(i=n.right-n.left,r=n.top-n.bottom),{left:e.left,top:e.top,width:i,height:r}}}]),n}(ku));const vd=gd;!function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,A._)(n,[{key:"doRender",value:function(e){var t=this.component.annot.info,n=e.outerRect,i=(e.rotate%360+360)%360;if(-1!=t.borderColor){var r=this.canvas.getContext("2d");if(r.clearRect(0,0,this.canvas.width,this.canvas.height),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){r.save(),r.globalAlpha=t.opacity;var o=.2*n.width;0===o||!1===t.hasBorderColor?r.strokeStyle="transparent":r.strokeStyle=this.numberToRGBAString(t.color);var a=.5*o,s=a,u=n.width-a,c=n.height-2*a/3,l=Math.atan2(c,n.width/2),d=o/Math.sin(l)+.3*a,h=new Nc([new pc(s,c),new pc(n.width/2,d),new pc(u,c)],!1);r.lineWidth=o;var f=i/180*Math.PI,g=0,v=0;switch(i){case 90:g=-s,v=-(c+d);break;case 270:g=-u;break;case 180:g=-(s+u),v=-c}r.rotate(f),r.translate(g,v),h.render(r),r.stroke(),r.restore()}}}}])}(nc);var pd=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="caret",a.$ui.addClass("fv__pdf-page-caret-annot-container"),a.$handler.addClass("fv__pdf-page-caret-annot-handler-container"),a}return(0,A._)(n,[{key:"updateOnPermissionChange",value:function(e){if(!this.isDestroyed){!!this.readOnlyDisabled()||!e.ignorable()&&!e.isModifiable()?this.$handler.addClass("disabled"):this.$handler.removeClass("disabled")}}},{key:"checkRenderingModeIs",value:function(e){return this.pdfViewer.config.annotRenderingMode.caret===e}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.$rect.addClass("active")}},{key:"afterRender",value:function(e){e.transformed&&this.isActive&&this.activeRect()}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this);var e=this.$rect;e&&e.removeClass("active")}},{key:"isReplace",value:function(){return this.annot.isGrouped()&&"replace"===(this.annot.getIntent()||"").toLowerCase()}},{key:"showUI",value:function(){var e=this;if(this.isReplace()){var t=this.annot.getGroupElements().filter((function(t){return t!==e.annot}))[0];if(t&&t.isDeleted())return(0,S._)((0,x._)(n.prototype),"showUI",this).call(this);var i=this.parent("annotsRender").getAnnotRender(t.getId());return(0,S._)((0,x._)(n.prototype),"showUI",this).call(this).then((function(){return i.component.showUI()}))}return(0,S._)((0,x._)(n.prototype),"showUI",this).call(this)}},{key:"hideUI",value:function(){var e=this;if(this.isReplace()){var t=this.annot.getGroupElements().filter((function(t){return t!==e.annot}))[0];if(t&&t.isDeleted())return(0,S._)((0,x._)(n.prototype),"hideUI",this).call(this);var i=this.parent("annotsRender").getAnnotRender(t.getId());return(0,S._)((0,x._)(n.prototype),"hideUI",this).call(this).then((function(){return i.component.hideUI()}))}return(0,S._)((0,x._)(n.prototype),"hideUI",this).call(this)}}]),n}(ku);const md=pd;var yd=nu(),kd=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),a=t.call(this,e,i,r,o),j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e={moveable:!0,resizable:!0,enableDiagonally:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,w._)(a),Object.keys(e)),n=new zu(Object.assign(e,t,{emitter:a.pdfViewer.eventEmitter,start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},moving:function(e,t){return a.onShapeMoving(e,t)},update:function(e,t){return a.onShapeUpdating(e,t)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotatable:!1,auxiliaryLine:void 0}));return a.processShapeControlPermissionCtrl(n),n})),a}return(0,A._)(n,[{key:"onStartUpdateShape",value:function(e,t,n){this.editDebouncePromise||(this.editDebouncePromise=new j.DebounceAsyncTaskExecutor(0))}},{key:"onShapeMoving",value:function(e,t){this.updateCollabOp(e),this.pdfViewer.config.highPerformance}},{key:"onShapeUpdating",value:function(e,t){var n=this;this.updateCollabOp(e),this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return n.setRect(n._transformShapeOfInnerRectToOuterRect(e)).then((function(e){n._updateShapeControlMargin(),n._updateShapeControllerBoundaryBox()}))}))}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editDebouncePromise?this.editDebouncePromise.exec((function(){var t=i.getRect(),r=i.getInnerRect(),o=t.left-r.left,a=t.top-r.top;return i.moveTo(e.left+o,e.top+a,n,!0,!1,!1).then((function(t){return i._setRect(i._transformShapeOfInnerRectToOuterRect(e),!0)})).then((function(e){i._updateShapeControlMargin(),i._updateShapeControllerBoundaryBox()}))})):Promise.resolve()}},{key:"_transformShapeOfInnerRectToOuterRect",value:function(e){var t={left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},n=Ra.subtract(this.getRect(),this.getInnerRect()),i=Ra.on(t).add(n).extract();return{left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top}}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(this.annot),this._applyShapeChange();var e=this.shapeControl.getPreviewerContext();this._previewUpdatedShape(this.shapeControl.getCurrentShape(),e)}},{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this.getInnerBoundary(),t=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,e,t),this._updateShapeControlMargin()}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceInnerRect(n,i),o="px";t.css({left:r.left+o,top:r.top+o,width:r.right-r.left+o,height:r.bottom-r.top+o})}},{key:"_updateShapeControllerBoundaryBox",value:function(){this.shapeControl.updateBoundaryBox(this._getShapeControllerBoundaryBox())}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2),n=t[0],i=t[1],r=this.getInnerRect(),o=this.getRect(),a=Ra.subtract(r,o);return Ra.on({left:0,top:0,right:n,bottom:i}).add(a).extract()}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive()}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"getPropertyOptions",value:function(){var e=this.annot;return{color:(0,j.colorConvertor)(e.getBorderColor(),"#"),opacity:e.getOpacity(),borderWidth:e.getBorderWidth(),cloudy:!0,fillColor:e.getFillColor(),disabled:this.propertyDisabled(),borderStyle:!0,isLocked:this.isLocked()}}},{key:"_previewUpdatedShape",value:function(e,t){t.clearRect(0,0,e.width,e.height),t.strokeStyle="#759DB8",t.lineWidth=1,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;e.save(),e.beginPath(),e.rect(t,n,i,r),e.closePath(),e.restore()}(t,0,0,e.width,e.height),t.stroke()}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return t._handlerRerender(e)}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(e){return n._handlerRerender(e)}))}},{key:"setFillColor",value:function(e){var t=this;return this.annot.setFillColor(e).then((function(e){return t._handlerRerender(e)}))}},{key:"getInnerRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.getPDFPage(),i=this.annot.getInnerRect(),r=n.getDeviceRect(i,e,t);return{left:r.left,top:r.top,right:r.right,bottom:r.bottom}}},{key:"getInnerBoundary",value:function(){var e=this.getPDFPage(),t=this.annot.getInnerRect(),n=e.getDeviceRect(t,this.scale,this.rotate);return{left:n.left,top:n.top,width:n.right-n.left,height:n.bottom-n.top}}},{key:"_handlerRerender",value:function(e){var t=this;return e?this.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}},{key:"_updateShapeControlMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(Ra.expandOffset(t,e))}}],[{key:"getDefaultContextMenuConfig",value:function(){return yd}}]),n}(ku),bd=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),a=t.call(this,e,i,r,o),j.Lazy.release((0,w._)(a),"shapeControl",!0),j.Lazy.property((0,w._)(a),"shapeControl",(function(){var t={moveable:!0,resizable:!0,rotatable:!0,enableFrame:!1},n=a.pdfViewer.customs.getAnnotComponentConfig((0,w._)(a),Object.keys(t)),i=new zu(Object.assign(t,n,{emitter:a.pdfViewer.eventEmitter,start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},moving:function(e,t){return a.onShapeMoving(e,t)},update:function(e,t){return a.onShapeUpdating(e,t)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotateEnd:function(e,t,n,i){return a.onRotateEnd(t)},afterRotateEnd:function(){return a.onAfterRotateEnd()},rotateStart:function(){return a.onRotateStart()},degree:e.info.rotation,enableDiagonally:!0,previewer:!1,enableUniform:!0,degreeInitVisibility:!1,auxiliaryLine:void 0}));a.processShapeControlPermissionCtrl(i);var r=function(t,n,r){if(i&&r===en.rotationUpdated){var o=a.getInnerBoundary(),s=a._getShapeControllerBoundaryBox();a.shapeControl.rotateDegree=e.getRotation(),i.active(a.$handler,o,s)}};return i.addDestroyHook((function(){a.pdfViewer.eventEmitter.off(de.annotationUpdated,r)})),a.pdfViewer.eventEmitter.on(de.annotationUpdated,r),i})),a}return(0,A._)(n,[{key:"getInnerRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.getRect(e,t)}},{key:"getPropertyOptions",value:function(){var e=this.annot;(0,j.colorConvertor)(e.getBorderColor(),"#");return{opacity:e.getOpacity(),borderStyle:!1,disabled:this.propertyDisabled(),rotationFree:(this.annot.getRotation()+360)%360,isLocked:this.isLocked()}}},{key:"setBitmap",value:function(e,t){var n=this;return this.annot.setBitmap(e,t).then((function(e){return n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n),n.render(n.scale,n.rotate)}))}},{key:"updateRender",value:function(){return this.render()}},{key:"redraw",value:function(e){return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"onRotateStart",value:function(){this.shapeControl.rotateDegreeBox.style.visibility="visible"}},{key:"onRotateEnd",value:function(e){var t=this;e=this.getStandardizedRotation(e);var n=this.annot.getRotation();return n=this.getStandardizedRotation(n),e+=Math.abs(n),e=this.getStandardizedRotation(e),this.setRotation(e).then((function(n){return t.updateShapeControl(e),e}))}},{key:"onAfterRotateEnd",value:function(){this.shapeControl.clearCompanions(),this.shapeControl.rotateDegreeBox.style.visibility="hidden"}},{key:"setRotation",value:function(e){var t=this;return this.annot.setRotation(e).then((function(e){return e?t.updateRender().then((function(){var n=t.getInnerBoundary(),i=t._getShapeControllerBoundaryBox();return t.shapeControl.active(t.$handler,n,i),t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"updateShapeControl",value:function(e){this.shapeControl.ui.style.transform=""}},{key:"getStandardizedRotation",value:function(e){return(e=parseInt(e))<0?e=360-Math.abs(e):e>360&&(e-=360),e}},{key:"onShapeUpdateEnd",value:function(e,t,i){var r=this,o=this;return(0,_._)((function(){var a,s,u,c,l,d,h,f,g,v,p,m,y,k;return(0,F.Jh)(this,(function(b){switch(b.label){case 0:return(0,S._)((0,x._)(n.prototype),"onShapeUpdateEnd",r).call(o,e,t,i),[3,14];case 1:return c<u?[4,s.getPageByIndex(c)]:[3,14];case 2:return[4,b.sent().getAnnots()];case 3:l=b.sent(),d=!0,h=!1,f=void 0,b.label=4;case 4:b.trys.push([4,11,12,13]),g=l[Symbol.iterator](),b.label=5;case 5:return(d=(v=g.next()).done)?[3,10]:(p=v.value,m=p.getId(),a.includes(m)&&m!==o.annot.getId()?(y=o.pdfViewer.getAnnotRender(c,m))&&y.component?[3,7]:[4,o.pdfViewer.getPDFPageRender(c).getAnnotRenderSafely(m)]:[3,9]);case 6:y=b.sent(),b.label=7;case 7:return[4,y.component._esignCnMultiMove(e,i)];case 8:b.sent(),b.label=9;case 9:return d=!0,[3,5];case 10:return[3,13];case 11:return k=b.sent(),h=!0,f=k,[3,13];case 12:try{d||null==g.return||g.return()}finally{if(h)throw f}return[7];case 13:return c++,[3,1];case 14:return[2]}}))}))()}},{key:"_esignCnMultiMove",value:function(e,t){}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.shapeControl&&this.shapeControl.destroy()}},{key:"showContextMenu",value:function(e,t){var i=this,r=this;return(0,_._)((function(){var o,a,s,u,c,l;return(0,F.Jh)(this,(function(d){switch(d.label){case 0:return[3,2];case 1:if(l=d.sent(),r.annot.info.iconName&&"sign-china-stamp"===r.annot.info.iconName.split("_")[0]){if(r.annot.info.iconName.includes("_date"))return[2];setTimeout((function(){c.forEach((function(e,t){return 0!==t&&3!==t&&e.hide()})),u.doHidden();var e=o.getComponentByName("fv--contextmenu-item-group");l&&l.length>1?e.doShown():e.doHidden()}),100),a.doHidden(),s.doHidden()}else a.doShown(),s.doShown(),u.doShown();d.label=2;case 2:return[2,(0,S._)((0,x._)(n.prototype),"showContextMenu",i).call(r,e,t)]}}))}))()}},{key:"doubleTapAnnot",value:function(){this.annot.info.iconName&&"sign-china-stamp"===this.annot.info.iconName.split("_")[0]||(0,S._)((0,x._)(n.prototype),"doubleTapAnnot",this).call(this)}}]),n}(kd);const wd=bd;var _d=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="ink",a.$ui.addClass("pdf-page-ink-annot-container"),a.$handler.addClass("pdf-page-ink-annot-handler-container"),j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e={moveable:!0,resizable:!0,enableDiagonally:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,w._)(a),Object.keys(e)),n=new zu(Object.assign(e,t,{emitter:a.pdfViewer.eventEmitter,interceptor:function(e){return a.checkSize(e)},start:function(){return a.onStartUpdateShape()},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},auxiliaryLine:void 0}));return a.processShapeControlPermissionCtrl(n),a.addDestroyHook((function(){n.destroy()})),n})),a}return(0,A._)(n,[{key:"checkSize",value:function(e){return!(e.width<10||e.height<10)}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e),this.setMargin()}},{key:"movedByOther",value:function(){this.isActive&&(this.activeRect(),this.shapeControl.updateBoundary(this.getBoundary()),this.setMargin())}},{key:"afterRender",value:function(e){if(e.transformed&&this.isActive){this.activeRect();var t=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),t),this.setMargin()}}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2),n=t[0],i=t[1];return Ra.on({left:0,top:0,right:n,bottom:i}).extract()}},{key:"onStartUpdateShape",value:function(){this.editDebouncePromise||(this.editDebouncePromise=new j.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e,t){this.pdfViewer.config.highPerformance&&(e.width<10&&(e.width=10),this.setRect(e),this.setMargin())}},{key:"onShapeMoving",value:function(e,t,n){var i=this;this.updateCollabOp(e),this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return i.moveTo(e.left,e.top).then((function(){i.setMargin()}))}))}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return e.width<10&&(e.width=10),"resize"!==n||this.pdfViewer.config.highPerformance?this.editDebouncePromise?this.editDebouncePromise.waitForLastTask().then((function(){return i.moveTo(e.left,e.top,n).then((function(e){i.setMargin()}))})):Promise.resolve():this.editDebouncePromise?this.editDebouncePromise.waitForLastTask().then((function(){return i.setRect(e)})).then((function(e){i.setMargin()})):Promise.resolve()}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,j.colorConvertor)(e.getBorderColor(),"#"),n=e.getOpacity(),i=e.getBorderWidth(),r=this.propertyDisabled();return{color:t,opacity:n,borderWidth:i,borderStyle:!1,isLocked:this.isLocked(),disabled:r}}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"getInkList",value:function(){return this.annot.getInkList()}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(Ra.expandOffset(t,e)),this.shapeControl.updateBoundaryBox(this._getShapeControllerBoundaryBox())}},{key:"redraw",value:function(e){return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t),r=this.getInkList();return Object.assign(i,{inkList:r})}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),j.Lazy.get(this,"shapeControl",(function(e){e.deactive()}))}}]),n}(ku);const Pd=_d;var Ad=g(875),Sd=g.n(Ad),xd=function(){function e(t,n,i){(0,P._)(this,e),this.viewerComponent=t,this.docPageCount=i;var r="max page: "+i,o=Sd()(r);n||(o='<dialog class="fv__dialog fv__annot-properties-dialog">'.concat(o,"</dialog>"));var a=this.$dialog=O()(o);this.bindChangeEvent();var s=n||document.body;if(a.appendTo(s),!n){var u=a[0];ou().registerDialog(u),u.showModal()}}return(0,A._)(e,[{key:"bindChangeEvent",value:function(){var e=this,t=this.$dialog;t.on("click",".fv__redaction-cancel",(function(){e.close()})).on("click",".fv__place-redaction-dialog-close-icon",(function(){e.close()})).on("click",".fv__redaction-btn",(function(t){e.submit()})).on("change",".redaction-page-radio",(function(n){n.target.checked&&(e.hideError(),"1"==n.target.value?t.find(".fv__redaction-page-range").attr("disabled",""):t.find(".fv__redaction-page-range").removeAttr("disabled"))})).on("keydown",".fv__redaction-page-range",(function(t){e.hideError()}))}},{key:"submit",value:function(){var e=this,t=this.docPageCount,n=[];if("1"==this.$dialog.find(".redaction-page-radio:checked").val())for(var i=0;i<t;i++)n.push(i);else{var r=this.$dialog.find(".fv__redaction-page-range").val();if(new RegExp(/[^\d\-,]/).test(r))return void this.showError();for(var o=r.split(","),a=0;a<o.length;a++){var s=o[a];if(s.indexOf("-")>-1){var u=s.split("-");if(u.length>2)return void this.showError();if(u[0]<1||u[0]>t||u[1]<1||u[1]>t)return void this.showError();for(var c=Math.min(u[0],u[1]),l=Math.max(u[0],u[1]),d=c;d<=l;d++)-1===n.indexOf(d)&&n.push(d-1)}else{if(s<1||s>t)return void this.showError();-1===n.indexOf(n)&&n.push(s-1)}}}this.viewerComponent.placeRedact(n).then((function(t){e.close()}))}},{key:"reset",value:function(){this.hideError(),this.element.querySelector(".redaction-page-radio").checked=!0,this.element.querySelector(".fv__redaction-page-range").value=""}},{key:"showError",value:function(){this.$dialog[0].querySelector(".fv__redaction-page-range").classList.add("fv__redaction-error")}},{key:"hideError",value:function(){this.$dialog[0].querySelector(".fv__redaction-page-range").classList.remove("fv__redaction-error")}},{key:"close",value:function(){var e=this.$dialog;e&&(e[0].close(),e.remove(),this.$dialog=null)}}]),e}(),Cd="annotComponent",Dd={reply:{name:"reply",nameI18nKey:"viewer_:contextmenu.annot.reply",callback:function(){this.data(Cd).showReplyDialog("reply")},disabled:function(){return this.data(Cd).replyDisabled()}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(Cd).removeAnnot()},disabled:function(){return this.data(Cd).deleteDisabled()}},apply:{name:"apply",nameI18nKey:"viewer_:contextmenu.annot.apply",callback:function(){return this.data(Cd).apply()},disabled:function(){return this.data(Cd).assembleDocDisabled()}},applyAll:{name:"applyAll",nameI18nKey:"viewer_:contextmenu.annot.applyAll",callback:function(){return this.data(Cd).applyAll()},disabled:function(){return this.data(Cd).assembleDocDisabled()}},place:{name:"place",nameI18nKey:"viewer_:contextmenu.annot.place",callback:function(e,t,n){this.data(Cd).showPlaceMarkDialog(e,t,n)},disabled:function(){return this.data(Cd).moveDisabled()}},properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n){this.data(Cd).showPropertiesDialog(e,t,n)}}};!function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,A._)(n,[{key:"doRender",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.component.renderAppearanceType;if(this.component.needToggleView&&this.component.needToggleView()&&!this.component.shouldRenderByMouseEvent()){var r=this.canvas.getContext("2d");return r.clearRect(0,0,this.canvas.width,this.canvas.height),void r.save()}if("rollover"!==i)return(0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e,t);var o=this.canvas.getContext("2d");o.save(),o.fillStyle="black",o.fillRect(0,0,this.canvas.width,this.canvas.height),o.restore()}}])}(al);var Ed=[{name:"U.S. FOIA",children:["(b) (1) (A)","(b) (1) (B)","(b) (2)","(b) (3) (A)","(b) (3) (B)","(b) (4)","(b) (5)","(b) (6)","(b) (7)(A)","(b) (7)(B)","(b) (7)(C)","(b) (7)(D)","(b) (7)(E)","(b) (7)(F)","(b) (8)","(b) (9)"]},{name:"U.S. Privacy Act",children:["(b)","(d)(5)","(j)(1)","(j)(2)","(k)(1)","(k)(2)","(k)(3)","(k)(4)","(k)(5)","(k)(6)","(k)(7)"]}];var Id=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Dd,events:{show:function(){return this.data(Cd).updateDeleteStatus(!0),!0},hide:function(){return this.data(Cd).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),Rd=function(){},Td=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a,s;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="redact",a.$ui.addClass("fv__pdf-page-redact-annot-container"),a.$handler.addClass("fv__pdf-page-redact-annot-handler-container"),a.$ui.css("z-index",99),a.$handler.css("z-index",99),a._isEditting=!1,s=!!e.isArea(),j.Lazy.property((0,w._)(a),"shapeControl",(function(){var t={moveable:!0,resizable:s,enableDiagonally:!0},n=a.pdfViewer.customs.getAnnotComponentConfig((0,w._)(a),Object.keys(t)),i=new zu(Object.assign(t,n,{emitter:a.pdfViewer.eventEmitter,start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t){return a.onShapeMoving(e,t)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotatable:!1}));return e.isArea()?a.processShapeControlPermissionCtrl(i):i.disable(),i})),a}return(0,A._)(n,[{key:"assembleDocDisabled",value:function(){return 40!=(40&this.docRender.getUserPermission().getValue())}},{key:"onStartUpdateShape",value:function(e,t,n){this.editDebouncePromise||(this.editDebouncePromise=new j.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e,t){this._edittingRect=this.transformToPDFRect(e),this._isEditting=!0;try{this._updateShapeControlMargin(),this._updateShapeControllerBoundaryBox()}finally{this._isEditting=!1}}},{key:"onShapeMoving",value:function(e,t){this._edittingRect=this.transformToPDFRect(e),this._isEditting=!0;try{this._updateShapeControlMargin(),this._updateShapeControllerBoundaryBox()}finally{this._isEditting=!1}}},{key:"getRect",value:function(){return this._isEditting?this._edittingRect:(0,S._)((0,x._)(n.prototype),"getRect",this).call(this)}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editDebouncePromise?this.editDebouncePromise.exec((function(){return i.setRect(e)})):Promise.resolve()}},{key:"transformToPDFRect",value:function(e){var t=e.left,n=e.top,i=e.width,r=e.height;i=Math.max(.001,i),r=Math.max(.001,r);var o=this.scale,a=this.rotate;return this.getPDFPage().reverseDeviceRect({left:t,top:n,right:t+i,bottom:n+r},o,a)}},{key:"_updateShapeControllerBoundaryBox",value:function(){this.shapeControl.updateBoundaryBox(this._getShapeControllerBoundaryBox())}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"_updateShapeControlMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(Ra.expandOffset(t,e))}},{key:"_transformShapeOfInnerRectToOuterRect",value:function(e){var t={left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},n=Ra.subtract(this.getRect(),this.getInnerRect()),i=Ra.on(t).add(n).extract();return{left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top}}},{key:"active",value:function(){var e,t=this.annot,i=t.info.overlayCode;if(i.length){var r,o=(e=localStorage.getItem("modifiedUSCodes"))?JSON.parse(e):(0,I._)(Ed),a="";i.forEach((function(e,t){t%2?a+=1!=t?","+r[e]:r[e]:r=o[e].children})),a!=t.info.overlayText&&t.setRedactAppearance({overlayText:t.info.overlayText,redactionCode:[]})}(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.$handler.addClass("active"),this._applyShapeChange()}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox(),t={left:e.left,top:e.top,width:e.width+2,height:e.height+2};this.shapeControl.active(this.$handler,this.getBoundary(),t)}},{key:"redraw",value:function(e){return this.render()}},{key:"updateRender",value:function(){return Promise.resolve()}},{key:"showPlaceMarkDialog",value:function(){if(this.$placeRedactionControl&&this.$placeRedactionControl.$dialog);else{var e=this.pdfViewer.currentPDFDoc.info.pageCount;this.$placeRedactionControl=new xd(this,document.body,e)}}},{key:"hidePlaceMarkDialog",value:function(){this.$actionsControl.close()}},{key:"placeRedact",value:function(e){var t=this,n=function(n){var i=n.getRects(),r=e.map((function(e){return t.pdfViewer.currentPDFDoc.getPageByIndex(e).then((function(e){if(!e.isVirtual()){var t=Object.assign({color:n.getBorderColor()},n.getRedactAppearance());return e.markRedactAnnot(i,t).then((function(e){var t=[];return n.replies.map((function(n){t.push(e[0].addReply(n.info))})),Promise.all(t).then((function(){return e}))}))}}))}));return Promise.all(r).then((function(e){return e.filter(Boolean)}))},i=this.pdfViewer.getAllActiveElements();return i.every((function(e){return"redact"===e.annot.getType()}))?Promise.all(i.map((function(e){return n(e.annot)}))):n(this.annot)}},{key:"apply",value:function(){var e=this,t=this.pdfViewer;if(t)return t.viewerUI.confirm({message:"viewer_:contextmenu.annot.applyConfirm",level:"warning"}).then((function(){return e.annot.apply()}),Rd)}},{key:"applyAll",value:function(){var e=this.pdfViewer;if(e)return e.viewerUI.confirm({message:"viewer_:contextmenu.annot.applyConfirm",level:"warning"}).then((function(){var t=e.getCurrentPDFDoc();return t.redacted=!0,t.applyRedaction()}),Rd)}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,j.colorConvertor)(e.getBorderColor(),"#"),n=e.getApplyFillColor()||4278190080,i=this.propertyDisabled(),r=this.isLocked(),o=e.info,a=o.overlayText,s=o.fontName,u=o.isAutoFontSize,c=o.justification,l=o.isRepeat,d=o.isOverlayCode,h=o.defaultAppearance;return{color:t,applyFillColor:n,borderStyle:!1,disabled:i,isLocked:r,overlayText:a,fontName:s,isAutoFontSize:u,justification:c,isRepeat:l,isOverlayCode:d,textSize:h.textSize,textColor:h.textColor,overlayCode:o.overlayCode}}},{key:"setApplyFillColor",value:function(e){return this.annot.setRedactApplyFillColor(e)}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;this.getAnnotFlag().checkNoZoom()&&(u=a.right-a.left,c=a.bottom-a.top);var l=Math.ceil(c/r),d=Math.ceil(u/r),h=(0,U.F2)(1)*e*2;return[l,d,u+=h,c+=h,r,i,e,t,a.left,a.top]}},{key:"mouseEnter",value:function(){this.renderAppearanceType=Ue.ROLLOVER,this.redraw(!0)}},{key:"mouseLeave",value:function(){this.renderAppearanceType=Ue.NORMAL,this.redraw(!0)}}],[{key:"getDefaultContextMenuConfig",value:function(){return Id}}]),n}(ku);const Fd=Td;var Md=nu(),Od=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="polygonCloud",a}return(0,A._)(n,null,[{key:"getDefaultContextMenuConfig",value:function(){return Md}}]),n}(Qc),Ld={};"function"==typeof FontFace?function(e,t){return Ld[e]?Ld[e]:Ld[e]=new Promise((function(n,i){t().then((function(t){if(!t)return i(),void Ld[e];var r=new FontFace(e,t.buffer||t.url);r.load().then((function(){document.fonts.add(r),n(r)}),(function(){i(),delete Ld[e]}))}),(function(){i(),delete Ld[e]}))}))}:function(e,t){return Ld[e]?Ld[e]:Ld[e]=new Promise((function(n,i){t().then((function(t){return t?t.buffer?URL.createObjectURL(new Blob([t.buffer],"application/x-font-woff")):t.url:(i("woff is invalid"),void delete Ld[e])})).then((function(t){if(!t)return i();var r=document.createElement("style");r.innerHTML='@font-face{font-family:"'+e+'"; src:url("'+t+'");}',document.head.appendChild(r),n(r)}))}))};var Nd="annotComponent",Vd={properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n){this.data(Nd).showPropertiesDialog(e,t,n)}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(Nd).removeAnnot()},disabled:function(){return this.data(Nd).deleteDisabled()}}};var Bd="editDiv",jd=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,null,[{key:"formatHtmlStr",value:function(e){var t=e,n={split:"split",remove:"remove",removeSelf:"removeTag"};[{startStr:"\x3c!--StartFragment--\x3e",endStr:"\x3c!--EndFragment--\x3e",operate:n.split},{startStr:"\x3c!--[if",endStr:"<![endif]--\x3e",operate:n.remove},{startStr:"<![if",endStr:"<![endif]>",operate:n.remove},{startStr:"<o:p>",endStr:"</o:p>",operate:n.remove},{startStr:"<w:Sdt",endStr:"</w:Sdt>",operate:n.removeTag},{startStr:"<w:sdtPr>",endStr:"</w:sdtPr>",operate:n.remove}].forEach((function(e){for(var i=t.indexOf(e.startStr);i>-1;){switch(e.operate){case n.split:var r=t.indexOf(e.endStr);t=t.slice(i+e.startStr.length,r>-1?r:t.length);break;case n.remove:var o=t.indexOf(e.endStr),a=t.substring(0,i),s=t.substring(o+e.endStr.length);t=a+s;break;case n.removeTag:var u=t.substring(i),c=u.indexOf(">");t=(t=t.substring(0,i)+u.substring(c+1)).split(e.endStr).join("")}i=t.indexOf(e.startStr)}}));var i=document.createElement("div");return i.contentEditable=!0,i.id=Bd,i.style.display="none",document.body.appendChild(i),i.innerHTML=t.replaceAll("\n","").replaceAll("\r",""),this.addTagClassName(i)}},{key:"getFont",value:function(e){var t=e[0],n=new RegExp("^\\s*".concat(t,"\\b")),i=["-apple-system","system-ui"," BlinkMacSystemFont"," Segoe UI"," Roboto"," Oxygen"," Ubuntu"," Fira Sans"," Droid Sans"," Helvetica Neue"," sans-serif"].some((function(e){return n.test(e)}));return i?(j.DeviceInfo.isWindows?t="DengXian Light":j.DeviceInfo.isMacOS||j.DeviceInfo.isIOS?t="PingFangSC":j.DeviceInfo.isAndroid?t="Roboto":j.DeviceInfo.isLinux&&(t="Noto Sans"),t):t}},{key:"formatRichText",value:function(e){var t=this,n=this.formatHtmlStr(e),i=document.getElementById("".concat(Bd)),r=n.map((function(e){var n,r,o,a,s=i.getElementsByClassName("".concat(e))[0],u=getComputedStyle(s),c=u.fontFamily.replaceAll('"',"").split(","),l=t.getFont(c);return{content:s.textContent,richTextStyle:{font:{name:l},textSize:parseInt(u.fontSize),textAlignment:it[u.textAlign],textColor:(0,j.colorConvertor)(u.color,"int"),isBold:(o=u.fontWeight,a=parseFloat(o),isNaN(a)?o.includes("bold"):a>400),isItalic:(r=u.fontStyle,r.includes("italic")||r.includes("oblique")),isUnderline:u.textDecoration.includes("underline"),isStrikethrough:u.textDecoration.includes("line-through"),cornerMarkStyle:(n=u.verticalAlign,{sub:Bt.subscript,super:Bt.superscript}[n]||Bt.none)}}}));return i.remove(),r}},{key:"addTagClassName",value:function(e){var t=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.childNodes.length;(["block","flex"].includes(getComputedStyle(e).display)&&e.nextElementSibling&&(e.innerHTML+="\n"),r>0)&&Array.from(e.childNodes).forEach((function(r){if("#text"===r.nodeName){var o=document.createElement("span");o.innerHTML="".concat(r.textContent),o.style.textDecoration="".concat(n.underline?"underline":""," ").concat(n.lineThrough?"line-through":""),o.style.verticalAlign=n.verticalAlign;var a="foxitwebsdk-".concat(Date.now(),"-").concat(parseInt(1e3*Math.random()));i.push(a),o.classList.add(a),e.replaceChild(o,r)}else{var s=getComputedStyle(r).textDecoration,u={};s.includes("underline")&&(u.underline=!0),s.includes("line-through")&&(u.lineThrough=!0);var c=getComputedStyle(r).verticalAlign;["sub","super"].includes(c)&&(u.verticalAlign=c),t.addTagClassName(r,i,Object.assign({},n,u))}}));return i}}]),e}(),Ud=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Vd,events:{show:function(){return this.data(Nd).updateDeleteStatus(!0),!0},hide:function(){return this.data(Nd).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),Hd=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a,s;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="freetext",a.removeAllEventsUsedByEditingMode=j.noop,a.$ui.addClass("fv__pdf-page-freetext-annot-container"),a.$handler.addClass("fv__pdf-page-freetext-annot-handler-container"),a.$textInput=O()("<textarea class='fv__ui-freetext-editor ".concat(a.annot.getIntent(),"'></textarea>")),s=a.$textInput,a.$handler.append(s),a.bindTextInputEvent(s),a.resizeTaskExecutor=new j.QueuedAsyncTaskExecutor,a.addDestroyHook((function(){a.removeAllEventsUsedByEditingMode()}),a.pdfViewer.addEventListener("before-clear-pageCache",(function(e){e===a.annot.page.getIndex()&&"editing"===a.status&&a.$textInput.trigger("blur")}))),a}return(0,A._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.$rect&&this.$rect.show()}},{key:"setContent",value:function(e){var t=this;return this.annot.setContent(e).then((function(e){return t.collaborate(),e}))}},{key:"getInnerBoundary",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=this.getPDFPage(),r=this.annot.getInnerRect(),o=this.annot.getRect(),a=r.right-r.left,s=o.right-o.left,u=this.annot.getBorderWidth();this.annot.getIntent()===ke.FREETEXT_CALLOUT?(e=r,t&&(e={left:r.left+u,right:r.right-u,top:r.top-u,bottom:r.bottom+u})):this.annot.getIntent()===ke.FREETEXT_TYPEWRITER?e=o:s-a>=u?e=r:t&&(e={left:o.left+u,right:o.right-u,top:o.top-u,bottom:o.bottom+u});var c=i.getDeviceRect(e,this.scale,n);return{left:c.left,top:c.top,width:c.right-c.left,height:c.bottom-c.top}}},{key:"setInnerRect",value:function(e){return this.annot.setInnerRectNoAction(e)}},{key:"setCalloutLinePoints",value:function(e){return this.annot.setCalloutLinePoints(e)}},{key:"showReplyDialog",value:function(){var e=this.getAnnotFlag();try{return this.annot.checkModidyPerm(),!(e.checkLockedContents()||e.checkReadOnly()||e.checkLocked())&&(this.backup(),this.enableEditMode(),!0)}catch(e){return!1}}},{key:"backup",value:function(){this.backupProperty={rect:Object.assign({},this.annot.getRect()),innerRect:Object.assign({},this.annot.getInnerRect())}}},{key:"computeFontSizePx",value:function(){var e=this.annot.getDefaultAppearance();return Math.max(4*e.textSize/3*this.scale,9.5)}},{key:"computeFontSizeScale",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.computeFontSizePx())/12;return Math.min(e,1)}},{key:"computeLineHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.computeFontSizePx();return 1.1*e/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.computeFontSizeScale(e))}},{key:"computeCurrentMinMaxHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.inputRect,n=void 0===t?this.$textInput[0].getBoundingClientRect():t,i=e.pageRect,r=void 0===i?this.parent("pdfPageRender").$ui[0].getBoundingClientRect():i,o=e.rotate,a=void 0===o?this.getFinalRotateAngle():o,s=e.padding,u=void 0===s?this.getPadding():s,c=this.pdfViewer.getSmartScale(this.scale),l=n.height;return{minHeight:Math.min(20*c*2/3*2,l),maxHeight:function(){switch(a){case 90:return n.right-r.left;case 180:return n.bottom-r.top;case 270:return r.right-n.left;default:return r.bottom-n.top}}()-u}}},{key:"getStyle",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.annot.getRotation(),i=this.annot.page.getRotationAngle(),r=this.getRect(),o=this.getRect(this.scale,n+i),a=o.right-o.left,s=o.bottom-o.top,u=this.annot,c=u.getFillColor(),l=u.getDefaultAppearance(),d=l.textColor,h=this.computeFontSizePx(),f=this.fontSizeScale=h/12;f>1&&(f=this.fontSizeScale=1);var g=this.computeLineHeight(h,f),v=(0,j.colorConvertor)(16777215&c,"#");0==c&&(v=t?"white":"transparent");var p=(0,j.colorConvertor)(16777215&d,"#");0==d&&(p="black");var m=l.font||{},y=this.annot.getAlignment();switch(y){case 0:y="left";break;case 1:y="center";break;case 2:y="right"}var k="center";switch((this.rotate+n+i)%360){case 0:case 180:k="center";break;case 90:k="".concat(s/2,"px center");break;case 270:k="".concat(a/2,"px ").concat(a/2,"px")}return g+="px",Object.assign({"text-align":y,color:p,background:v,display:"block","font-size":h,fontFamily:'"'+[m.baseName,m.familyName,m.nameKey,m.name,"FoxitPDFSDKForWeb"].join('","')+'"',lineHeight:g},e?{left:r.left,top:r.top,width:a,height:s,"transform-origin":k,transform:"rotate(".concat(n+this.rotate+i,"deg)")}:{})}},{key:"setDomRect",value:function(e){var t=this.annot.getRotation()+this.annot.page.getRotationAngle()+this.rotate,n=!0;(this.isCallout()||this.isTextBox())&&(this.annot.getBorderStyle()===me.CLOUDY&&(n=!1));var i=this.getInnerBoundary(n),r=i.left,o=i.top,a=i.width,s=i.height,u=new nn.Z,c=a,l=s,d=r,h=o;switch(t%360){case 90:c=-a,d=r+a;break;case 180:c=-a,d=r+a,l=-s,h=o+s;break;case 270:l=-s,h=o+s}u.rotate((360-t)*Math.PI/180);var f=u.transformRect(0,0,c,l);e.left=f[0]+d,e.top=f[1]+h,e.width=f[2]-f[0],e.height=f[3]-f[1],e["max-height"]="initial",e["max-width"]="initial",e["min-width"]="initial",e["min-height"]="initial",e["transform-origin"]="0 0",e.transform="rotate(".concat(t,"deg)")}},{key:"showContextMenu",value:function(e,t){return"editing"!==this.status&&(0,S._)((0,x._)(n.prototype),"showContextMenu",this).call(this,e,t)}},{key:"enableEditMode",value:function(){var e=this;if("editing"!==this.status){this.shapeControl&&this.shapeControl.deactive();var t=(0,E._)(this.docRender.pdfViewer.getGroupCount(),3),n=(t[0],t[1],t[2]);if(this.annot.isGrouped()){var i=this.annot.getGroupHeader().getId(),r=n[i];for(var o in delete n[i],n[-1].forEach((function(t){return e.docRender.pdfViewer.unActiveElement(t)})),n)n[o].forEach((function(t){return e.docRender.pdfViewer.unActiveElement(t)}));r.forEach((function(t){t.getId()!=e.getId()&&e.docRender.pdfViewer.unActiveElement(t)}))}else for(var a in n)n[a].forEach((function(t){t.getId()!=e.getId()&&e.docRender.pdfViewer.unActiveElement(t)}));this.status="editing";var s=this.annot;this.$handler.addClass("active"),this.updateTextInputStyle();var u=s.getContent();this.$textInput.val(u);var c=this.$textInput.get(0);if(s.getIntent()===ke.FREETEXT_TYPEWRITER)this.setHeight(this.$textInput);(0,j.moveCursorToEnd)(c,{preventScroll:!0}),this.pdfViewer.eventEmitter.emit("editingFreeText",this);var l=function(t){e.annotsRender&&t===e.annotsRender.pageRender&&"editing"===e.status&&e.updateTextInputStyle()};this.pdfViewer.eventEmitter.on(de.renderPageSuccess,l),this.removeAllEventsUsedByEditingMode=function(){e.pdfViewer.eventEmitter.off(de.renderPageSuccess,l)}}}},{key:"updateTextInputStyle",value:function(){var e=this.getStyle(!1,!0);this.setDomRect(e);var t=e.transform||"";this.fontSizeScale>=1?t+=" scale(1)":(t+="scale(".concat(this.fontSizeScale,")"),e.width/=this.fontSizeScale,e.height/=this.fontSizeScale,e.lineHeight="12px"),e.transform=t,this.$textInput.css(e)}},{key:"bindEvent",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"bindEvent",this).call(this);var t=function(t){(0,j.match)(t).when(j.matchers.Escape,(function(){t.preventDefault(),e.$textInput.blur()}))};this.$textInput.on("keyup",t).on("keydown",t),this.$textInput.on("mousemove",(function(e){e.stopPropagation()}))}},{key:"unActive",value:function(){this.$textInput.trigger("blur"),(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl&&this.shapeControl.deactive(),this.$rect&&this.$rect.hide(),clearInterval(this.pressInterval)}},{key:"getInnerRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.getPDFPage(),i=this.annot.getInnerRect();return n.getDeviceRect(i,e,t)}},{key:"bindTextInputEvent",value:function(e){var t,n,i=this,r=!1;e.on("focus",(function(e){i.oldInnerRect=i.annot.getInnerRect(),i.oldRect=i.annot.getRect(),i.oldCalloutLinePoints=i.annot.getCalloutLinePoints&&i.annot.getCalloutLinePoints(),i.annot.setIsEditting(!0)})).on("paste",(function(e){n=null;var t=e.originalEvent.clipboardData.getData("text/html");if(0!==t.length){var i=jd.formatRichText(t);0!==i.length&&(n=i[0].richTextStyle.font)}})).on("input",(function(e){r=!0,i.handleInputEvent(e)})).on("keydown",(function(e){t=i.$textInput.val(),27!==e.keyCode&&e.ctrlKey&&65===e.keyCode&&i.$textInput.trigger("select")})).on("keyup",(function(e){t!==i.$textInput.val()&&(r=!0)})).on("blur",(function(e){var t=r;if(r=!1,"editing"!=i.status)return i.updateTextInputScale(1),void i.annot.setIsEditting(!1);var o=i.parent("pdfPageRender");i.removeAllEventsUsedByEditingMode();var a=i.$textInput;i.delayRemoveActive=!0;var s=function(){var e=a[0].getBoundingClientRect();return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}(),u=!1;switch(i.annot.getIntent()){case ke.FREETEXT_TEXTBOX:case ke.FREETEXT_TYPEWRITER:var c=i.getRect(),l=i.getInnerRect(),d=(c.bottom-c.top-(l.bottom-l.top))/2,h=i.getFinalRotateAngle(),f=a[0].scrollHeight,g=i.computeLineHeight(),v=o.$ui[0].getBoundingClientRect();if(f-s.height>=g){u=!0;var p=v.height-2*d,m=v.width-2*d;switch(h){case 0:s.height=Math.min(f,p),s.top=s.bottom-s.height;break;case 90:s.width=Math.min(f,m),s.right=s.left+s.height;break;case 180:s.height=Math.min(f,p),s.bottom=s.top+s.height;break;case 270:s.width=Math.min(f,m),s.left=s.right-s.height}}case ke.FREETEXT_CALLOUT:}i.status="viewing";var y=i.parent("pdfPageRender").getPDFRectFromClientRect(s);if(!i.beforeBlur(e,y)){var k=Promise.resolve();if(t)switch(i.annot.getIntent()){case ke.FREETEXT_TYPEWRITER:u&&(k=i.setRectInPDF(y,!1));break;case ke.FREETEXT_TEXTBOX:u&&(k=i.setInnerRectHeight(y));break;default:k=i.setInnerRectHeight(y)}k.then((function(t){var r=i.annot.getContent();if(e.target.value!==r)return n?i.setDefaultAppearance("font",n).then((function(t){return i.setContent(e.target.value)})):i.setContent(e.target.value)})).then((function(t){i.pdfViewer.activeElement(),O()(e.target).css({display:"none"}).removeAttr("contenteditable")})).then((function(e){return i.$textInput.css("display","none"),i.oldInnerRect=null,i.oldRect=null,i.oldCalloutLinePoints=null,i.updateTextInputScale(1),i.$handler&&i.$handler.removeClass("active"),i.postBlur()})).then((function(e){return i.redraw()})).finally((function(){i.annot.setIsEditting(!1),i.delayRemoveActive=!1}))}}))}},{key:"isTypeWriter",value:function(){var e;return(null===(e=this.annot)||void 0===e?void 0:e.getIntent())===ke.FREETEXT_TYPEWRITER}},{key:"isCallout",value:function(){var e;return(null===(e=this.annot)||void 0===e?void 0:e.getIntent())===ke.FREETEXT_CALLOUT}},{key:"isTextBox",value:function(){var e;return(null===(e=this.annot)||void 0===e?void 0:e.getIntent())===ke.FREETEXT_TEXTBOX}},{key:"handleInputEvent",value:function(){var e=this;this.resizeTaskExecutor.exec((function(){var t=e.$textInput[0],n=t.scrollHeight,i=t.scrollWidth,r=t.clientHeight,o=t.clientWidth;if(n>r||i>o)return e.setHeight(e.$textInput)}))}},{key:"updateCalloutFigure",value:function(e,t,n){var i=this;return this.annot.updateCalloutFigure(e,t,n).then((function(){return i.updateRender().then((function(){i.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,i)}))}))}},{key:"updateTextInputScale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.$textInput[0].style.transform||"";this.$textInput[0].style.transform=t.replace(/scale\(\d+(\.\d+)?\)/,"scale(".concat(e,")"))}},{key:"beforeBlur",value:function(){return!1}},{key:"postBlur",value:function(){0}},{key:"setHeight",value:function(e,t,n){}},{key:"getPadding",value:function(){var e=this.annot,t=e.getRect(),n=e.getBorderInfo(),i=0;if(5!=n.style){var r=n.width||1;i=1.5*r,this.isHTMLSimulate("freetext")?i=2*r:t.top-t.bottom<2*i&&(i=r)}else i=e.getInnerRect().left-t.left;return i}},{key:"setDefaultAppearance",value:function(e,t){var n=this;"textColor"==e&&(t=(0,j.colorConvertor)(t,"int",1));var i=this.annot.getDefaultAppearance();return Object.assign(i,(0,J._)({},e,t)),(["textSize","textColor"].includes(e)?this.annot.setAppearanceWithoutFontFamily(i):this.annot.setDefaultAppearance(i)).then((function(e){n.activeRect(),n.shapeControl.adjustPointControl&&n.shapeControl.adjustPointControl(),n._applyShapeChange&&n._applyShapeChange(),n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n)}))}},{key:"getFinalRotateAngle",value:function(){var e=this.annot.page.getRotationAngle();return((this.annot.getRotation()+e+this.rotate)%360+360)%360}},{key:"getMaxSize",value:function(e){this.getPDFPage();var t=this.getFinalRotateAngle(),n=this.parent("pdfPageRender").$ui[0].getBoundingClientRect(),i=e.getBoundingClientRect(),r=n.bottom-i.top,o=n.right-i.left,a=this.annot.getInnerRect(),s=this.annot.getRect(),u=(s.top-s.bottom-(a.top-a.bottom))/2,c=(s.right-s.left-(a.right-a.left))/2,l=this.pdfViewer.getSmartScale(this.scale),d=4*u/3*l,h=4*c/3*l;switch(t){case 0:return{width:o-h,height:r-d};case 180:return{width:o-h,height:i.bottom-n.top-d};case 90:return{width:r-h,height:i.right-n.left-d};case 270:return{width:r-h,height:n.right-i.left-d}}}}],[{key:"getDefaultContextMenuConfig",value:function(){return Ud}}]),n}(ku);const Wd=Hd;function Yd(e,t){var n=getComputedStyle(e),i=n.overflow,r=n.whiteSpace,o=e.clientWidth;e.style.cssText+="\n        min-width: ".concat(t.minWidth,"px;\n        min-height: ").concat(t.minHeight,"px;\n        max-width: ").concat(t.maxWidth,"px;\n        max-height: ").concat(t.maxHeight,"px;\n        overflow: hidden;\n        white-space: ").concat(o>=t.maxWidth?"pre-line":"nowrap",";\n        word-break: break-word;\n    ");var a=e.scrollWidth,s=Math.max(Math.min(a,t.maxWidth),t.minWidth);e.style.cssText+="\n        width: ".concat(s,"px;\n    ");var u=e.scrollHeight,c=Math.max(Math.min(u,t.maxHeight),t.minHeight);e.style.cssText+="\n        overflow: ".concat(i,";\n        width: ").concat(s,"px;\n        height: ").concat(c,"px;\n        white-space: ").concat(r,";\n    "),delete e.style.whiteSpace}var qd=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="typewritter",j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e=new zu((0,b._)((0,k._)({},a.getShapeOptions()),{auxiliaryLine:void 0}));return a.processShapeControlPermissionCtrl(e),e})),a.$ui.addClass("fv__pdf-page-typewritter-annot-container"),a.$handler.addClass("fv__pdf-page-typewritter-annot-handler-container");var s=O()("<div class='fv__ftui-container'><pre class='fv__typewriter_ui'></pre></div>");return a.$pre=s.find("pre"),a.$ui.append(s),a}return(0,A._)(n,[{key:"computeLineHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.computeFontSizePx();return 1.158*e/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.computeFontSizeScale(e))}},{key:"handleInputEvent",value:function(){var e=this;this.resizeTaskExecutor.exec((0,_._)((function(){var t,n,i,r,o,a,s,u,c,l,d,h,f,g;return(0,F.Jh)(this,(function(v){return t=e.getFinalRotateAngle(),n=e.$textInput[0],i=n.getBoundingClientRect(),r=e.parent("pdfPageRender"),o=r.$ui[0].getBoundingClientRect(),a=e.getPadding(),s=e.getMaxSize(n),u=s.width,c=e.computeCurrentMinMaxHeight({inputRect:i,padding:a,rotate:t,pageRect:o}),l=c.minHeight,d=c.maxHeight,h=n.clientHeight,Yd(n,{maxWidth:u,maxHeight:d,minHeight:l,minWidth:1}),f=n.getBoundingClientRect(),f.height>d?(n.style.height=d+"px",g=!0):g=n.clientHeight!==h,g?[2,e.setHeight(e.$textInput)]:[2]}))})))}},{key:"getShapeOptions",value:function(){var e=this;return{emitter:this.pdfViewer.eventEmitter,resizable:!1,start:function(){return e.onStartUpdateShape()},update:function(t,n){return e.onShapeUpdating(t,n)},moving:function(t,n,i){return e.onShapeMoving(t,n,i)},end:function(t,n,i){return e.onShapeUpdateEnd(t,n,i)},enableDiagonally:!0}}},{key:"afterRender",value:function(e){e.transformed&&this.isActive&&(this.activeRect(),this.$rect&&this.$rect.show())}},{key:"onStartUpdateShape",value:function(e,t,n){}},{key:"onShapeUpdating",value:function(e,t){this.updateCollabOp(e)}},{key:"onShapeMoving",value:function(e,t,n){this.updateCollabOp(e),this.annot.isGrouped()&&this.pdfViewer.eventEmitter.emit("freetextGroupMoving")}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this,r=Promise.resolve();switch(n){case"move":r=this.moveTo(e.left,e.top,n);break;case"resize":r=this.setRect(e),this.render()}return this.annot.isGrouped()&&this.pdfViewer.eventEmitter.emit("freetextGroupMovingEnd"),r.then((function(){return i.updateToobarPostion()}))}},{key:"updateToobarPostion",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.$toolbar){var t=this.$toolbar,n=this.annot.getRect(),i=this.annotsRender.pageRender,r=i.page,o=r.getDeviceRect(n,i.getScale(),i.getRotation());if(t.css({top:o.top+"px",left:o.left-5+"px"}),o.top<30){var a=o.bottom-o.top;t.css({transform:"translatey(".concat(a+5,"px)")})}var s=i.getScale(),u=r.getPxWidth()*s,c=O()(".fv__ui-sidebar")[0].getBoundingClientRect(),l=t[0].getBoundingClientRect();if(l.right-c.right>u){var d=l.right-c.right-u;e?t.css({left:-5-d-5+"px"}):t.css({left:o.left-d-5+"px"})}}}},{key:"showToolbar",value:function(e){var t=this;this.$toolbar&&this.$toolbar.remove();var n=O()('<div class="fv__text-fill-sign-toolbar">\n                                            <div class="fv__text-fill-sign-toolbar-base">\n                                                <div class="fv__text-fill-sign-toolbar-icon fv__text-fill-sign-toolbar-decrease"></div>\n                                                <div class="fv__text-fill-sign-toolbar-icon fv__text-fill-sign-toolbar-increase"></div>\n                                            </div>\n                                        </div>');e.after(n),this.$toolbar=n,this.updateToobarPostion(),this.$toolbar.find(".fv__text-fill-sign-toolbar-decrease").on("click",(function(e){var n=t.annot.getDefaultAppearance().textSize;n<7||t.annot.setDefaultAppearance({textSize:n-1})})),this.$toolbar.find(".fv__text-fill-sign-toolbar-increase").on("click",(function(e){var n=t.annot.getDefaultAppearance().textSize;n>20||t.annot.setDefaultAppearance({textSize:n+1})}))}},{key:"hideToolbar",value:function(){this.$toolbar&&this.$toolbar.remove()}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this._applyShapeChange()}},{key:"_applyShapeChange",value:function(){var e,t=this,n=this._getShapeControllerBoundaryBox();e=this.getBoundary(),this.getAppPermission().then((function(i){if(!t.isDestroyed){!!t.groupMoveDisabled()||(i.ignorable()?t.moveDisabled():!i.isAdjustable()||t.moveDisabled())?t.shapeControl.disable():t.shapeControl.enable(),t.shapeControl.active(t.$handler,e,n),t.setMargin()}}))}},{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"getPropertyOptions",value:function(){(0,S._)((0,x._)(n.prototype),"getPropertyOptions",this).call(this);var e=this.annot,t=e.getOpacity(),i=this.propertyDisabled(),r=this.isLocked();return{opacity:t,borderStyle:!1,disabled:i,fontColor:e.getFontColor(),fontSize:e.getDefaultAppearance().textSize,font:e.getDefaultAppearance().font,isLocked:r}}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive(),this.hideToolbar()}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(Ra.expandOffset(t,e))}},{key:"redraw",value:function(e){if(!this.isDestroyed)return this.moveDisabled()||this.groupMoveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"setHeight",value:function(e,t){var i,r=this.annot.page.getRotationAngle(),o=((this.annot.getRotation()+r+this.rotate)%360+360)%360,a=this.parent("pdfPageRender").$ui[0].getBoundingClientRect(),s=e[0],u=s.getBoundingClientRect(),c=u.left,l=u.top,d=u.bottom,h=u.right,f=u.width,g=u.height;switch((j.isMobile||j.isMiPad||j.isIPAD||j.isTablet)&&(f=e.width(),g=e.height()),o){case 0:c+(i=1.2*f)>a.right&&(i=a.right-c);break;case 90:l+(i=1.2*g)>a.bottom&&(i=a.bottom-l);break;case 270:d-(i=1.2*g)<a.top&&(i=d-a.top);break;case 180:h-(i=1.2*f)<a.left&&(i=h-a.left)}this.isTypeWriter()&&(e.width(i),e.height(s.scrollHeight)),u=s.getBoundingClientRect();var v=this.annotsRender.pageRender,p=v.rotate,m=v.scale,y={left:u.left-a.left,right:u.right-a.left,top:u.top-a.top,bottom:u.bottom-a.top};y=this.annot.page.reverseDeviceRect(y,m,p),(0,S._)((0,x._)(n.prototype),"setHeight",this).call(this,e,y,y)}},{key:"beforeBlur",value:function(e,t){if(this.$textInput.val().length<1)return this.$ui.hide(),this.removeAnnot(),!0;var n=this.annot,i=this.annot.getContent();if(!this.isHTMLSimulate("freetext"))return this.$ui.show(),!1;if(i==e.target.value)return this.$pre.html(i).show(),!0;i=e.target.value,n.info.content=i,n.info.RC="",n.info.rect=t;var r=this.getInnerBoundary(!1);this.$ui.css(r),this.$pre.html(i).show();var o=this.$ui.get(0).style,a=parseFloat(o.left)*this.fontSizeScale,s=parseFloat(o.top)*this.fontSizeScale,u=this.$ui.get(0).getBoundingClientRect(),c={left:a,top:s,right:a+u.width*this.fontSizeScale,bottom:s+u.height*this.fontSizeScale};return t=this.annot.page.reverseDeviceRect(c,this.scale,this.rotate),n._setRect(t),n._setContent(i),!0}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;if(this.scale=e,this.rotate=t,!this.isHTMLSimulate("freetext")||"typewritter"!=this.name)return this.isHTMLSimulate("freetext")&&"textbox"==this.name?(this.$ui.css({overflow:"hidden"}),(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)):(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t);var i=this.getStyle();i["word-break"]="keep-all",i["white-space"]="nowrap",i.opacity=this.annot.getOpacity();var r=this.$ui.find(".fv__ftui-container"),o=this.fontSizeScale;r.css({transform:"scale(".concat(o,")"),width:100/o+"%"}),this.$ui.css(i),this.$pre.text(this.annot.getContent())}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.isHTMLSimulate("freetext")?this.render(e,t):(0,S._)((0,x._)(n.prototype),"updateSize",this).call(this,e,t)}},{key:"enableEditMode",value:function(){"editing"!==this.status&&(this.isHTMLSimulate("freetext")?this.$pre.hide():"typewritter"==this.name&&this.$ui.hide(),(0,S._)((0,x._)(n.prototype),"enableEditMode",this).call(this))}}]),n}(Wd);const Kd=qd;var $d=g(1885),zd=g.n($d),Gd=function(){function e(){(0,P._)(this,e),this.drawAuxiliaryLine=ju,this.clearAuxiliaryLine=Uu}return(0,A._)(e,[{key:"init",value:function(e,t){this.calloutRender=e,this.$ui=O()(t),this.$ui.hide()}},{key:"draw",value:function(e,t,n){var i=this.$ui[0];i.width=t.right-t.left,i.height=t.bottom-t.top;var r=i.getContext("2d");r.save(),r.clearRect(0,0,this.$ui.width(),this.$ui.height()),r.beginPath(),e.length>1&&(r.moveTo(e[0][0]-t.left,e[0][1]-t.top),r.lineTo(e[1][0]-t.left,e[1][1]-t.top)),e.length>2&&r.lineTo(e[2][0]-t.left,e[2][1]-t.top),r.strokeStyle="#5aa",r.lineWidth=2,r.stroke(),r.save();var o=n.width||n.right-n.left,a=n.height||Math.abs(n.top-n.bottom);r.rect(n.left-t.left,n.top-t.top,o,a),r.fillStyle="rgba(88, 176, 176, 0.5)",r.stroke(),r.fillRect(n.left-t.left,n.top-t.top,o,a),r.restore()}},{key:"show",value:function(e,t,n){e&&this.draw(e,t,n),this.$ui.show()}},{key:"hide",value:function(){this.$ui&&this.$ui.hide()}}]),e}();const Jd=Gd;var Xd="resize",Zd="area",Qd="text";var eh=function(){function e(t){var n=this;(0,P._)(this,e),this.control=t,this.annot=t.annot,this.companions=[],this.shape={getRect:function(){return n.annot.getRect()}},this.deltaX=0,this.deltaY=0,this.companionMargin={left:0,top:0,bottom:0,right:0}}return(0,A._)(e,[{key:"companion",value:function(e){this!==e&&(this.companions.indexOf(e)>-1||(this.companions.push(e),this.updateMargin()))}},{key:"updateMargin",value:function(){if(0!==this.companions.length){var e=this.shape.getRect(),t=e.left,n=e.right,i=e.top,r=e.bottom;this.companions.forEach((function(e){var o=e.shape.getRect();t=Math.min(o.left,t),i=Math.min(o.top,i),n=Math.max(o.right,n),r=Math.max(o.bottom,r)}));var o=e.left-t,a=n-e.right,s=e.top-i,u=r-e.bottom;this.companionMargin={left:o,right:a,top:s,bottom:u}}else this.companionMargin={left:0,top:0,bottom:0,right:0}}},{key:"doStart",value:function(){this.deltaX=0,this.deltaY=0,this.control.showShape(),this.control.start(Zd)}},{key:"move",value:function(e,t,n){var i=this;this.deltaX+=e,this.deltaY+=t,this.control.move(Zd,-1,this.deltaX,this.deltaY).then((function(e){if(e){var t=e.rect,n=e.innerRect,r=e.points;O()(i.control.calloutController).css(i.annot.getBoundary()),i.control.showShape(r,t,n)}}))}},{key:"resize",value:function(e,t,n,i){}},{key:"end",value:function(e,t){this.control.calloutShape.hide(),"move"===e&&this.control.end(Zd)}},{key:"cancel",value:function(e){}},{key:"rotateStart",value:function(){}},{key:"updateRotateDegreeBox",value:function(e){}},{key:"rotate",value:function(e,t){}},{key:"rotateEnd",value:function(){}},{key:"clearCompanions",value:function(){this.companions.length=0,this.companionMargin={left:0,top:0,bottom:0,right:0}}}]),e}(),th=ue,nh=function(){function e(t){(0,P._)(this,e);var n=new DOMParser;this.whole=n.parseFromString(zd()({}),"text/html").body.firstChild,this.calloutController=this.ui=this.whole.querySelector(".fv__shape-control"),this.moveable=!0,this.isMoveDisabled=!1,this.bindMovingEvent(),this.calloutShape=new Jd,this.emitter=t}return(0,A._)(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.start,n=void 0===t?j.noop:t,i=e.update,r=void 0===i?j.noop:i,o=e.interceptor,a=void 0===o?th:o,s=e.moving,u=void 0===s?j.noop:s,c=e.end,l=void 0===c?j.noop:c,d=e.cancel,h=void 0===d?j.noop:d,f=e.auxiliaryLine,g=void 0===f?null:f,v=arguments.length>1?arguments[1]:void 0;this.start=n,this.update=r,this.move=u,this.interceptor=a,this.end=l,this.cancel=h,this.annot=v,this.isActive=!1,this.calloutShape.init(v,this.calloutController.querySelector(".fv__shape-control-previewer")),this.companionObject=new eh(this),this.isActive=!1,this.auxiliaryLine=g}},{key:"getCompanionObject",value:function(){return this.companionObject}},{key:"companion",value:function(e){"function"==typeof e.getCompanionObject&&this.companionObject.companion(e.getCompanionObject())}},{key:"clearCompanions",value:function(){this.companionObject.clearCompanions()}},{key:"getMargin",value:function(){return this.companionObject.companionMargin}},{key:"active",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.annot.getBoundary(),n=arguments.length>2?arguments[2]:void 0;this.isActive=!0,e.append(this.calloutController),O()(this.calloutController).css(t),this.box=n,this.adjustPointControl(),this.calloutController.style.display="block"}},{key:"show",value:function(){O()(this.calloutController).show()}},{key:"hide",value:function(){O()(this.calloutController).hide()}},{key:"disable",value:function(){this.isDisabled=!0,this.calloutController.classList.add("disabled")}},{key:"enable",value:function(){this.isDisabled=!1,this.calloutController.classList.remove("disabled")}},{key:"moveDisable",value:function(){this.isMoveDisabled=!0,this.calloutController.classList.add("move-disabled")}},{key:"moveEnable",value:function(){this.isMoveDisabled=!1,this.calloutController.classList.remove("move-disabled")}},{key:"deactive",value:function(){this.calloutController.style.display="none",this.isActive=!1}},{key:"destroy",value:function(){this.calloutController.parentNode&&this.calloutController.parentNode.removeChild(this.calloutController)}},{key:"bindMovingEvent",value:function(){var e=this;this._bindMoveAreaEvents(Zd),this._bindMoveAreaEvents(Qd);var t=this.ui.querySelectorAll(".fv__shape-controller");Array.prototype.slice.call(t).forEach((function(t){return e._bindMovePointEvents(t)})),(0,j.attachContextMenuEvent)(this.calloutController,(function(t){e.annot.showContextMenu(t.clientX,t.clientY),t.preventDefault()}));this.ui}},{key:"isEditHandle",value:function(e){var t=O()(e.element).parent().prev().find("textarea");t.length||(t=O()(e.element).parent().prev());var n=!1;return t&&(n=t.is(":visible")),O()(".fv__groupAnnotBorder").is(":visible")&&(n=!1),n}},{key:"_bindMoveAreaEvents",value:function(e){var t=this,n=this.ui,i=".fv__shape-control-move-area";e==Qd&&(i=".fv__shape-control-text-area");var r,o,a=new gr.Manager(n.querySelector(i));a.add(new gr.Pan({direction:gr.DIRECTION_ALL}));var s=!1;a.on("panstart",(function(n){var i=n.deltaX,u=n.deltaY,c=n.srcEvent,l=n.center;s=t.isEditHandle(a),t.isDisabled||!t.isActive||e==Zd&&t.isMoveDisabled||s||(r=i,o=u,e===Zd&&(t.onPrestart&&t.onPrestart(),t.companionObject.companions.forEach((function(e){e.doStart(),e.move(i,u,!0)}))),t.showShape(),t.start(e),e==Zd&&t.trigger("movingstart",{deltaX:l.x+i,deltaY:l.y+u,srcEvent:c}))})),a.on("panend",(function(n){e==Zd&&t.trigger("movingend"),t.isDisabled||!t.isActive||e==Zd&&t.isMoveDisabled||s?s=!1:(e===Zd&&t.companionObject.companions.forEach((function(e){e.end("move")})),t.calloutShape.hide(),t.end(e),e===Zd&&t.onAfterEnd&&t.onAfterEnd("move"),t.auxiliaryLine&&t.calloutShape.clearAuxiliaryLine(t.auxiliaryLine.container))})),a.on("pancancel",(function(n){e==Zd&&t.trigger("movingcancel"),t.isDisabled||!t.isActive||e==Zd&&t.isMoveDisabled||s?s=!1:(t.cancel(e),e===Zd&&t.onAfterEnd&&t.onAfterEnd("move"),t.auxiliaryLine&&t.calloutShape.clearAuxiliaryLine(t.auxiliaryLine.container))})),a.on("panmove",(function(n){var i=n.deltaX,a=n.deltaY,u=(n.center,n.direction,t);if(!(t.isDisabled||!t.isActive||e==Zd&&t.isMoveDisabled||s)){var c=i-r,l=a-o,d=t.annot.getRect();t.move(e,-1,c,l).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t){var n=u.annot.getRect();if(e===Zd){var i=n.left-d.left,r=n.top-d.top;u.companionObject.companions.forEach((function(e){e.move(i,r)}))}O()(u.calloutController).css(u.annot.getBoundary());var o=t.rect,a=t.innerRect,s=t.points;if(e==Qd&&u.adjustPointControl(s,o,a),u.showShape(s,o,a),e===Zd&&u.auxiliaryLine){var c=u.auxiliaryLine.getPageAnnots(),l=n,h=u.auxiliaryLine.gap,f=u.auxiliaryLine.container,g=u.annot.getBoundary(),v=[g],p={};g.right=g.left+g.width,g.bottom=g.top+g.height,p[g.top+g.left+g.right+g.bottom]=!0,u.companionObject.companions.length&&u.companionObject.companions.forEach((function(e){var t=e.shape.getRect();l.left=Math.min(l.left,t.left),l.top=Math.min(l.top,t.top),l.right=Math.max(l.right,t.right),l.bottom=Math.max(l.bottom,t.bottom),v.push(t),p[t.top+t.left+t.right+t.bottom]=!0})),c=c.filter((function(e){var t=e.rect;if(qu.indexOf(e.type)<0)return!1;if(!p[t.top+t.left+t.right+t.bottom])return!0;var n=!0,i=!1,r=void 0;try{for(var o,a=v[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.top==t.top&&s.left==t.left&&s.right==t.right&&s.bottom==t.bottom)return!1}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return!0}));var m=c.map((function(e){return e.rect}));u.calloutShape.drawAuxiliaryLine(l,m,h,f)}}}))}}))}},{key:"_bindMovePointEvents",value:function(e){var t,n,i=this,r=new gr.Manager(e);r.add(new gr.Pan({direction:gr.DIRECTION_ALL})),r.on("panmove",(function(r){var o=r.deltaX,a=r.deltaY;r.center,r.direction,r.target;if(!i.isDisabled&&i.isActive){var s=o-t,u=a-n;return i.move(Xd,e.classList[2],s,u).then((function(e){if(e){O()(i.calloutController).css(i.annot.getBoundary());var t=e.rect,n=e.innerRect,r=e.points;i.adjustPointControl(r,t,n),i.showShape(r,t,n)}})),!1}})),r.on("panstart",(function(e){var r=e.deltaX,o=e.deltaY;e.center;if(!i.isDisabled&&i.isActive)return t=r,n=o,i.showShape(),i.start(Xd),!1})),r.on("pancancel",(function(e){if(!i.isDisabled&&i.isActive)return i.cancel(Xd),!1})),r.on("panend",(function(e){if(!i.isDisabled&&i.isActive)return i.calloutShape.hide(),i.end(Xd),!1}))}},{key:"showShape",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot.getCalloutPointers(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.annot.getRect(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.annot.getInnerBoundary();this.calloutShape.show(e,t,n)}},{key:"adjustPointControl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot.getCalloutPointers(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.annot.getRect(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.annot.getInnerBoundary(),i=this.ui,r={left:n.left-t.left,top:n.top-t.top,width:n.width,height:n.height},o=i.querySelector(".fv__shape-control-text-area");O()(o).css(r);var a=i.querySelector(".fv__shape-control-inner-area");if(O()(a).css(r),e.length>1){var s=i.querySelector(".fv__shape-controller.calloutStart");O()(s).css({display:"block",left:e[0][0]-t.left-4,top:e[0][1]-t.top-4}),s=i.querySelector(".fv__shape-controller.calloutKnee"),O()(s).css({display:"block",left:e[1][0]-t.left-4,top:e[1][1]-t.top-4})}else{var u=i.querySelector(".fv__shape-controller.calloutStart");O()(u).css({display:"none"}),u=i.querySelector(".fv__shape-controller.calloutKnee"),O()(u).css({display:"none"})}}},{key:"trigger",value:function(e,t){var n=this.emitter;n&&n.emit(e,t)}},{key:"setSnapGrid",value:function(e){this.snapGrid=e}}]),e}(),ih=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,null,[{key:"calcCalloutPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.start,i=t.end,r=t.page,o=t.width,a=void 0===o?i[0]+110:o,s=t.height,u=void 0===s?i[1]+30:s,c=t.borderStyle,l=t.endingStyle,d=t.scale,h=t.rotate;i[0]=Math.max(i[0],2),i[1]=Math.max(i[1],12);var f=100*d*4/3,g=20*d*2/3,v=r.getOriginX(),p=r.getOriginY(),m=r.reverseDeviceRect({left:i[0],right:i[0]+f,top:i[1]-g,bottom:i[1]+g},d,h);n=r.reverseDevicePoint(n,d,h),i=r.reverseDevicePoint(i,d,h),m.left<v&&(m.left=v),m.bottom<p&&(m.bottom=p);var y=[{x:n[0],y:n[1]},{x:m.left-15,y:m.top+10},{x:m.left-.1,y:m.top+10}];if(!(y=e.checkKneePoint(0,y,m))||rh(y[0],y[1])<15||rh(y[2],y[1])<15)return{invalid:!0};var k=e.recalculateRect({points:y,innerRect:m,width:a,height:u,borderStyle:c,endingStyle:l});return k.left<v+5||k.right>a||k.bottom<p+5||k.top>u?{invalid:!0}:{calloutLinePoints:y,rect:k,innerRect:m}}},{key:"calcKneeLength",value:function(e){var t=e[1],n=e[2];return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}},{key:"checkKneePoint",value:function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.kneeLength;if(t>3||n.length<2)return null;var o=JSON.parse(JSON.stringify(n));switch(t){case 0:o[2]={x:i.left-.1,y:(i.top+i.bottom)/2-.1},o[1]={x:o[2].x-r,y:o[2].y};break;case 1:o[1]={x:(i.left+i.right)/2,y:i.bottom-r},o[2]={x:o[1].x-.1,y:i.bottom-.1};break;case 2:o[1]={x:i.right+r,y:(i.top+i.bottom)/2},o[2]={x:i.right-.1,y:o[1].y};break;case 3:o[1]={x:(i.left+i.right)/2,y:i.top+r},o[2]={x:o[1].x-.1,y:i.top-.1}}var a=rh(o[2],o[0]);if(a<20)return o;var s=rh(o[2],o[1]),u=rh(o[1],o[0]),c=Math.acos((a-s-u)/(2*Math.sqrt(s)*Math.sqrt(u)));return Math.PI>c&&c>Math.PI/2?e.checkKneePoint(t+1,n,i,r):o}},{key:"recalculateRect",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.points,n=e.innerRect,i=e.width,r=void 0===i?1e4:i,o=e.height,a=void 0===o?1e4:o,s=e.rotate,u=e.borderInfo,c=e.endingStyle,l=1/0,d=l,h=-1/0,f=-1/0,g=l,v=0;v<3;v++)t[v].x<d&&(d=t[v].x),t[v].x>h&&(h=t[v].x),t[v].y>f&&(f=t[v].y),t[v].y<g&&(g=t[v].y);s%2&&(r^=a,r^=a^=r);var p=0;u&&5==u.style&&(p=1==u.cloudIntensity?6:9);var m={left:Math.max(Math.min(d,n.left)-1,0),top:Math.max(f,n.top)+1,right:Math.min(Math.max(h,n.right)+1,r),bottom:Math.min(g,n.bottom)-1};0!==p&&(Math.abs(m.left-n.left)<2&&(m.left-=p),Math.abs(m.right-n.right)<2&&(m.right+=p),Math.abs(m.top-n.top)<2&&(m.top+=p),Math.abs(m.bottom-n.bottom)<2&&(m.bottom-=p));var y=0;switch(c){case 7:case 8:y=8;break;case 2:case 1:case 3:case 6:case 9:y=6}return 0!=y&&(m.left-=y,m.right+=y,m.top+=y,m.bottom-=y),n.left<m.left&&(n.left=m.left+1),n.right>m.right&&(n.right=m.right-1),n.top>m.top&&(n.top=m.top-1),n.bottom<m.bottom&&(n.bottom=m.bottom+1),m}}]),e}();ih.kneeLength=15;var rh=function(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)};const oh=ih;!function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).helper=new yc(e),i}(0,A._)(n,[{key:"doPrepare",value:function(){(0,S._)((0,x._)(n.prototype),"doPrepare",this).call(this),this.canvas.classList.add("fv__viewer-render-square-canvas")}},{key:"doRender",value:function(e){e.renderingData;var t=this.component.annot,n=t.info,i=n.borderInfo||{},r=e.scale,o=e.rotate,a=this.convertPointToPixel(i.width||1,r),s=t.page,u=e.outerRect,c=t.getCalloutLinePoints().map((function(e){var t=s.getDevicePoint([e.x,e.y],r,o);return[t[0]-u.left,t[1]-u.top]})),l=this.canvas.getContext("2d");if(l.clearRect(0,0,this.canvas.width,this.canvas.height),!this.component.needToggleView||!this.component.needToggleView()||this.component.shouldRenderByMouseEvent()){l.save(),e.lineWidth=a,0===a||!1===n.hasBorderColor?l.strokeStyle="transparent":l.strokeStyle=this.numberToRGBAString(n.color),l.lineWidth=a;try{switch(i.style){case me.BEVELED:case me.UNDERLINE:case me.SOLID:this.renderSolid(l,n,e);break;case me.DASHED:this.renderDashed(l,n,e);break;case me.CLOUDY:this.renderCloud(l,n,e)}var d=n.fillColor;d?(d=this.numberToRGBAString(d),l.fillStyle=d,l.fill()):d="transparent",e.renderingData.fillColor=d,this.renderCallout(l,e,n.borderColor,t.getCalloutLineEndingStyle(),c,a),this.component.$pre.css({height:e.innerRect.height,overflow:"hidden"}),l.stroke()}finally{l.restore()}this.afterRender(e)}}},{key:"convertToPathPoint",value:function(e,t,n,i){var r=(0,E._)(i.getDevicePoint([e.x,e.y],t),2),o=r[0],a=r[1];return new pc(o-n.left,a-n.top)}},{key:"shrinkRect",value:function(e,t){var n=Ra.on(e).shrink(t).extract();return Object.assign(n,{width:n.right-n.left,height:n.bottom-n.top})}},{key:"renderCloud",value:function(e,t,n){t.fillColor;var i=t.borderInfo.cloudIntensity,r=this.shrinkRect(n.innerRect,0),o=this.shrinkRect(n.outerRect,0),a=r.width,s=r.height;new Gc([new pc(0,s),new pc(a,s),new pc(a,0),new pc(0,0)],r,o).generate(32/3/i).render(e)}},{key:"renderDashed",value:function(e,t,n){var i=this,r=t.borderInfo,o=r.dashes||[],a=r.dashPhase||0,s=n.scale;e.save(),e.setLineDash&&e.setLineDash(o.map((function(e){return i.convertPointToPixel(e,s)}))),e.lineDashOffset=this.convertPointToPixel(a,s),this.renderSolid(e,t,n)}},{key:"renderSolid",value:function(e,t,n){var i=n.outerRect,r=n.innerRect,o=n.lineWidth,a=r.width,s=r.height,u=r.left-i.left,c=r.top-i.top,l=.5*o;e.beginPath(),e.rect(u+l,c+l,a-o,s-o),e.closePath()}},{key:"renderCallout",value:function(e,t,n,i,r,o){e.save();e.lineWidth=o,e.strokeStyle=this.numberToRGBAString(n),e.moveTo(r[0][0],r[0][1]),r.map((function(t){e.lineTo(t[0],t[1])})),e.stroke();var a=new pc(r[1][0],r[1][1]),s=new pc(r[0][0],r[0][1]);this.helper.renderLineEnd(e,o,t,i,a,s),e.restore()}},{key:"afterRender",value:function(e){var t=e.outerRect,i=e.innerRect;(0,S._)((0,x._)(n.prototype),"afterRender",this).call(this);var r=this.component,o=r.annot,a=r.$pre;a.html(o.getContent());var s=r.getStyle(!1);delete s.background;var u=4*o.getBorderWidth()/3*r.scale;5===o.getBorderInfo().style&&(u=0);var c=r.fontSizeScale;s.margin=[(i.top-t.top+u)/c,(t.right-i.right+u)/c,(t.bottom-i.bottom+u)/c,(i.left-t.left+u)/c].join("px ")+"px",r.$ui.find(".fv__ftui-container").css({transform:"scale(".concat(c,")"),width:100/c+"%"}),a.css(s),r.$ui.css("opacity",o.getOpacity())}}])}(nc);var ah=["left","bottom","right","top"],sh=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).annot=e,a.name="callout",a.$ui.removeClass("fv__pdf-page-textbox-annot-container"),a.$handler.removeClass("fv__pdf-page-textbox-annot-handler-container"),a.$ui.addClass("fv__pdf-page-callout-annot-container"),a.$handler.addClass("fv__pdf-page-callout-annot-handler-container"),j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e=new nh(a.pdfViewer.eventEmitter);return a.processShapeControlPermissionCtrl(e),e})),a.editDebouncePromiseQueue=new fe;var s=O()("<div class='fv__ftui-container'><pre class='fv__textbox_ui'></pre></div>");return a.$pre=s.find("pre"),a.$ui.append(s),a}return(0,A._)(n,[{key:"getPadding",value:function(){return this.annot.getBorderWidth()*this.pdfViewer.getSmartScale(this.scale)}},{key:"computeLineHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.computeFontSizePx();return 1.18*e/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.computeFontSizeScale(e))}},{key:"handleInputEvent",value:function(){var e=this;this.resizeTaskExecutor.exec((0,_._)((function(){var t,n,i,r,o,a,s,u,c,l,d,h,f;return(0,F.Jh)(this,(function(g){switch(t=e.getFinalRotateAngle(),n=e.$textInput[0],i=n.getBoundingClientRect(),r=e.parent("pdfPageRender"),o=r.$ui[0].getBoundingClientRect(),a=e.getPadding(),s=e.computeCurrentMinMaxHeight({inputRect:i,padding:a,rotate:t,pageRect:o}),u=s.minHeight,c=s.maxHeight,l=n.clientHeight,t){case 0:case 180:Yd(n,{maxWidth:n.clientWidth,minWidth:n.clientWidth,maxHeight:o.height-2*a,minHeight:u});break;case 90:case 270:Yd(n,{maxWidth:n.clientWidth,minWidth:n.clientWidth,maxHeight:o.width-2*a,minHeight:u})}if((h=n.clientHeight)>c){switch(f=function(){switch(t){case 0:return o.bottom-h-o.top-2*a;case 90:case 180:return h+2*a;case 270:return o.right-h-o.left-2*a}}(),t){case 90:case 270:n.style.left=f+"px";break;default:n.style.top=f+"px"}d=!0}else d=n.clientHeight!==l;return d?[2,e.setHeight(e.$textInput)]:[2]}))})))}},{key:"updateOnPermissionChange",value:function(e){if(!this.isDestroyed&&(j.Lazy.isPropertyIntialized(this,"shapeControl")&&!this.isDestroyed)){var t=!1;t=!!this.groupMoveDisabled()||(e.ignorable()?this.moveDisabled():!e.isAdjustable()||this.moveDisabled());var n=this.shapeControl;t?n.disable():n.enable()}}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.shapeControl.deactive()}},{key:"active",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.shapeControl.init({start:function(t){return e.onStartUpdateShape(t)},moving:function(t,n,i,r){return e.onShapeMoving(t,n,i,r)},end:function(t){return e.onShapeUpdateEnd(null,null,t)},auxiliaryLine:void 0},this),this.rerenderShapeControl()}},{key:"rerenderShapeControl",value:function(){var e=this,t=this._getShapeControllerBoundaryBox(),n=this.getBoundary();this.getAppPermission().then((function(i){!!e.groupMoveDisabled()||(i.ignorable()?e.moveDisabled():!i.isAdjustable()||e.moveDisabled())?e.shapeControl.disable():e.shapeControl.enable(),e.shapeControl.active(e.$handler,n,t)}))}},{key:"movedByOther",value:function(){if(this.isActive){this.activeRect();var e=this._getShapeControllerBoundaryBox(),t=this.getBoundary();this.shapeControl.active(this.$handler,t,e),this.shapeControl.adjustPointControl()}}},{key:"afterRender",value:function(e){e.transformed&&this.isActive&&this.movedByOther()}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"backup",value:function(){var e=this,t=this.annot.getCalloutLinePoints();if(this.backupProperty={points:JSON.parse(JSON.stringify(t)),rect:Object.assign({},this.annot.getRect()),innerRect:Object.assign({},this.annot.getInnerRect())},t.length<3){var n=this.annot.getBorderStyle(),i=oh.calcCalloutPosition({start:[0,0],end:[this.backupProperty.innerRect.left,(this.backupProperty.innerRect.top+this.backupProperty.innerRect.bottom)/2],width:this.getPDFPage().getWidth(),height:this.getPDFPage().getHeight(),rotate:this.getPDFPage().getRotation()-this.rotate,borderStyle:n,endingStyle:this.annot.getCalloutLineEndingStyle()});this.setCalloutLinePoints(i.calloutLinePoints).then((function(t){var n,i=e._getShapeControllerBoundaryBox();n=e.getBoundary(),e.shapeControl.active(e.$rect,n,i)}))}}},{key:"onStartUpdateShape",value:function(e){this.backup()}},{key:"onShapeMoving",value:function(e,t,n,i){var r=this,o=(0,E._)(this.annot.page.reverseDeviceOffset([n,i],this.scale,this.rotate),2),a=o[0],s=o[1];return this.updatePromise=this.updatePromise||Promise.resolve(),this.updatePromise=this.updatePromise.then((function(){switch(e){case Qd:return r.updateTextRect(a,s);case Zd:return r.updateRect(a,s);case Xd:return r.updatePoint(t,a,s)}})).then((function(e){return r.annot.isGrouped(),e}))}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this,r=this.annot.info.rect,o=this.annot.info.innerRect,a=this.annot.info.calloutLinePoints;return this._flushEdit(r,o,a).then((function(e){i.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,i),n==Zd&&i.pdfViewer.eventEmitter.emit(de.annotationMovedPosition,[i.annot],i.annot.page,i.annot)})).then((function(e){return i.rerenderShapeControl(),e}))}},{key:"_flushEdit",value:function(e,t,n){var i=this,r=Promise.resolve();return this.annot.isGrouped()&&(r=this.annot.moveTo({left:e.left,top:e.top})),r.then((function(){return i.updateCalloutFigure(e,t,n)})).then((function(){return i.annot.oldRect=i.backupProperty.rect,i.redraw()})).then((function(){i.isActive&&i.rerenderShapeControl()}))}},{key:"updateRect",value:function(e,t){var n=Object.assign({},this.backupProperty.rect);if(n.left+=e,n.right+=e,n.bottom+=t,n.top+=t,!this.checkRect(n,!0))return Promise.resolve(!1);if(e=n.left-this.backupProperty.rect.left,t=n.top-this.backupProperty.rect.top,0==e&&0==t)return Promise.resolve();var i=Object.assign({},this.backupProperty.innerRect);i.left+=e,i.right+=e,i.top+=t,i.bottom+=t;var r=JSON.parse(JSON.stringify(this.backupProperty.points));return r[0].x+=e,r[0].y+=t,r[1].x+=e,r[1].y+=t,r[2].x+=e,r[2].y+=t,this.annot.info.rect=n,this.annot.info.innerRect=i,this.annot.info.calloutLinePoints=r,Promise.resolve({rect:this.getRect(),innerRect:this.getInnerBoundary(),points:this.getCalloutPointers()})}},{key:"updateTextRect",value:function(e,t){var n=Object.assign({},this.backupProperty.innerRect),i=this.annot.getCalloutLinePoints();if(n.left+=e,n.right+=e,n.top+=t,n.bottom+=t,!this.checkRect(n,!0))return Promise.resolve(!1);if(!(i=oh.checkKneePoint(0,i,n)))return Promise.resolve(!1);var r=this.getPDFPage(),o=oh.recalculateRect({points:i,innerRect:n,width:r.getWidth(),height:r.getHeight(),rotate:r.getRotation(),borderInfo:this.annot.getBorderInfo(),endingStyle:this.annot.getCalloutLineEndingStyle()});return this.annot.info.rect=o,this.annot.info.innerRect=n,this.annot.info.calloutLinePoints=i,Promise.resolve({rect:this.getRect(),innerRect:this.getInnerBoundary(),points:this.getCalloutPointers()})}},{key:"updatePoint",value:function(e,t,n){var i=this.annot.page,r=this.annot.page.getRotation(),o=i.getWidth(),a=i.getHeight(),s=(0,E._)(1==r||3==r?[a,o]:[o,a],2),u=s[0],c=s[1],l=this.annot.getBorderWidth(),d=this.backupProperty.points,h=JSON.parse(JSON.stringify(this.annot.getCalloutLinePoints())),f=!0,g=Object.assign({},this.backupProperty.innerRect);switch(e){case"calloutStart":h[0].x=d[0].x+t,h[0].y=d[0].y+n;if(g.left-20<h[0].x&&h[0].x<g.right+20&&g.bottom-20<h[0].y&&h[0].y<g.top+20)return Promise.resolve();break;case"calloutKnee":if(h[1].x==h[2].x){if(t=0,d[1].y<d[2].y&&d[1].y+n>=d[2].y)return Promise.resolve();if(d[1].y>d[2].y&&d[1].y+n<=d[2].y)return Promise.resolve()}else if(h[1].y==h[2].y){if(n=0,d[1].x<d[2].x&&d[1].x+t>=d[2].x)return Promise.resolve();if(d[1].x>d[2].x&&d[1].x+t<=d[2].x)return Promise.resolve()}if(d[1].x+t<0||d[1].y+n<0)return Promise.resolve();f=!1,h[1].x=d[1].x+t,h[1].y=d[1].y+n;break;default:for(var v=[].concat(ah),p=0;p<this.rotate/90+this.annot.page.getRotation();p++){var m=v.shift();v.push(m)}switch(e){case"left":g[v[0]]+=uh(v[0],t,n);break;case"bottom":g[v[1]]+=uh(v[1],t,n);break;case"right":g[v[2]]+=uh(v[2],t,n);break;case"top":g[v[3]]+=uh(v[3],t,n)}}if(g.bottom<l&&(g.bottom=l),g.left<l&&(g.left=l),g.top>c-l&&(g.top=c-l),g.right>u-l&&(g.right=u-l),f&&!(h=oh.checkKneePoint(0,h,g)))return Promise.resolve(!1);var y=oh.recalculateRect({points:h,innerRect:g,width:i.getWidth(),height:i.getHeight(),rotate:i.getRotation(),borderStyle:this.annot.getBorderInfo(),endingStyle:this.annot.getCalloutLineEndingStyle()});return this.checkRect(y)?(this.annot.info.rect=y,this.annot.info.innerRect=g,this.annot.info.calloutLinePoints=h,Promise.resolve({rect:this.getRect(),innerRect:this.getInnerBoundary(),points:this.getCalloutPointers()})):Promise.resolve()}},{key:"setEndingStyle",value:function(e,t){var n=this;return this.annot.setCalloutLineEndingStyle(+t).then((function(){return n.annot.update()})).then((function(){n.activeRect(),n.redraw(),n.rerenderShapeControl()}))}},{key:"setColor",value:function(e){var t=this;return this.annot.setBorderColor(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setFillColor",value:function(e){var t=this;return this.annot.setFillColor(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.updateRender().then((function(){return t.rerenderShapeControl(),t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(){return n.updateRender().then((function(){n.rerenderShapeControl(),n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n)}))}))}},{key:"getPropertyOptions",value:function(){(0,S._)((0,x._)(n.prototype),"getPropertyOptions",this).call(this);var e=this.annot,t=(0,j.colorConvertor)(e.getBorderColor(),"#"),i=e.getOpacity(),r=this.annot.getFillColor(),o=e.getBorderWidth(),a=this.propertyDisabled(),s=e.getFontColor(),u=e.getDefaultAppearance().textSize,c=e.getDefaultAppearance().font,l=this.isLocked();return{color:t,opacity:i,fillColor:r,lineStartStyle:e.getCalloutLineEndingStyle(),borderWidth:o,cloudy:!0,disabled:a,fontColor:s,fontSize:u,borderStyle:!0,font:c,isLocked:l}}},{key:"getCalloutPointers",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot.getCalloutLinePoints(),t=[],n=0;n<e.length;n++){var i=this.annot.page.getDevicePoint([e[n].x,e[n].y],this.scale,this.rotate);t.push(i)}return t}},{key:"setInnerRectHeight",value:function(e){var t=Object.assign({},this.backupProperty.innerRect),n=this.annot.getBorderWidth();5===this.annot.getBorderInfo().style&&(n=0);var i={left:e.left-t.left-n,right:e.right-t.right+n,top:e.top-t.top+n,bottom:e.bottom-t.bottom-n},r=0;if(Math.abs(i.left)<3&&(r++,i.left=0),Math.abs(i.right)<3&&(r++,i.right=0),Math.abs(i.top)<3&&(r++,i.top=0),Math.abs(i.bottom)<3&&(r++,i.bottom=0),4==r)return Promise.resolve(!1);var o=t.left+i.left,a=t.bottom+i.bottom,s=t.top+i.top,u=t.right+i.right;if(o>=u||s<=a)return Promise.resolve(!1);var c=this.annot.getBorderWidth(),l=this.annot.page.getHeight(),d=this.annot.page.getWidth();return o=Math.max(c,o),a=Math.max(c,a),s=Math.min(s,l-c),u=Math.min(u,d-c),this.setInnerRectProperty({left:o,bottom:a,top:s,right:u})}},{key:"enableSyncTextScaling",value:function(){return this.pdfViewer.customs.syncTextScaling}},{key:"setInnerRectProperty",value:function(e){var t=JSON.parse(JSON.stringify(this.backupProperty.points)),n=this.backupProperty.innerRect,i=this.annot.page.getHeight();if(this.enableSyncTextScaling()&&t[2].y<=n.bottom+this.annot.getBorderWidth()){var r=t[2];if(e.bottom<r.y){var o=r.y-e.bottom+1;e.bottom+=o,e.top=Math.min(i,e.top+o)}}var a=oh.calcKneeLength(this.backupProperty.points,n);e:if(!(t=oh.checkKneePoint(0,t,e,a))){if(this.enableSyncTextScaling()){var s=this.backupProperty.points;if(j.isAllSimilar.apply(void 0,[1].concat((0,I._)(s.map((function(e){return e.y})))))){var u=s[0].x<e.left,c=u?{x:e.left-.1,y:.5*(e.top+e.bottom)-.1}:{x:e.right+.1,y:.5*(e.top+e.bottom)-.1},l=u?{x:c.x-oh.kneeLength,y:c.y}:{x:c.x+oh.kneeLength,y:c.y};t=[s[0],l,c];break e}}return Promise.resolve(!1)}var d=this.annot.page,h=oh.recalculateRect({points:t,innerRect:e,width:d.getWidth(),height:d.getHeight(),rotate:d.getRotation(),borderStyle:this.annot.getBorderInfo(),endingStyle:this.annot.getCalloutLineEndingStyle()});Promise.resolve(),this.annot.getRect();return this.updateCalloutFigure(h,e,t)}},{key:"checkRect",value:function(e,t){var n=this.annot.page,i=this.shapeControl.getMargin(),r=(0,E._)(n.reverseDeviceOffset([i.left,i.top],this.scale,this.rotate),2),o=r[0],a=r[1],s=(0,E._)(n.reverseDeviceOffset([i.right,i.bottom],this.scale,this.rotate),2),u=s[0],c=s[1],l=Math.abs(o),d=Math.abs(c),h=Math.abs(u),f=Math.abs(a),g=n.getOriginX()+l,v=n.getOriginX()+n.getMediaWidth()-h,p=n.getOriginY()+d,m=n.getOriginY()+n.getMediaHeight()-f;if(t){if(e.left<g+2){var y=l+2-e.left;e.left+=y,e.right+=y}else if(e.right>v-1){var k=v-1-e.right;e.left+=k,e.right+=k}if(e.bottom<p+2){var b=d+2-e.bottom;e.bottom+=b,e.top+=b}else if(e.top>m-2){var w=m-2-e.top;e.bottom+=w,e.top+=w}return!0}return!(e.left<g||e.bottom<p||e.top>m||e.right>v)}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"redraw",value:function(e){if(!this.isDestroyed)return this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),(0,S._)((0,x._)(n.prototype),"redraw",this).call(this,e)}},{key:"setHeight",value:function(e,t){var i=this,r=(this.annot.page.getRotationAngle(),this.annot.getRotation(),this.getStyle(!1,!0));this.setDomRect(r);var o=e[0].getBoundingClientRect(),a=this.parent("pdfPageRender").getPDFRectFromClientRect(o),s=this.annotsRender,u=s.getRerenderMode();return s.setRerenderMode(Wi.debounce),this.setInnerRectHeight(a).then((function(t){return(0,S._)((0,x._)(n.prototype),"setHeight",i).call(i,e)})).finally((function(){i.setDomRect(r),e.css(r),s.setRerenderMode(u)}))}}]),n}(Wd),uh=function(e,t,n){return"left"===e||"right"==e?t:n};const ch=sh;!function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}(0,A._)(n,[{key:"doRender",value:function(e){isNaN(e.innerRect.left)||((0,S._)((0,x._)(n.prototype),"doRender",this).call(this,e,!1),this.afterRender())}},{key:"afterRender",value:function(){(0,S._)((0,x._)(n.prototype),"afterRender",this).call(this);var e=this.component,t=e.annot,i=e.$pre;i.html(t.getContent());var r=e.getStyle(!0);delete r.background,delete r.left,delete r.top,r.padding=4*e.getPadding()/3*e.scale,i.css(r);var o=e.$ui.find(".fv__ftui-container"),a=e.fontSizeScale;o.css({transform:"scale(".concat(a,")"),width:100/a+"%"}),e.$ui.css("opacity",t.getOpacity())}}])}(al);var lh=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="textbox",a.$ui.removeClass("fv__pdf-page-typewritter-annot-container"),a.$handler.removeClass("fv__pdf-page-typewritter-annot-handler-container"),a.$ui.addClass("fv__pdf-page-textbox-annot-container"),a.$handler.addClass("fv__pdf-page-textbox-annot-handler-container"),a.$pre.addClass("fv__textbox_ui"),a}return(0,A._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.fontSizeScale<1&&this.$handler.css("transform","scale(1)")}},{key:"getShapeOptions",value:function(){var e=(0,S._)((0,x._)(n.prototype),"getShapeOptions",this).call(this);return e.resizable=!0,e}},{key:"getPropertyOptions",value:function(){(0,S._)((0,x._)(n.prototype),"getPropertyOptions",this).call(this);var e=this.annot,t=(0,j.colorConvertor)(e.getBorderColor(),"#"),i=e.getOpacity(),r=e.getBorderWidth();return{color:t,opacity:i,fillColor:e.getFillColor(),borderWidth:r,cloudy:!0,disabled:this.propertyDisabled(),fontColor:e.getFontColor(),fontSize:e.getDefaultAppearance().textSize,borderStyle:!0,font:e.getDefaultAppearance().font,isLocked:this.isLocked()}}},{key:"setHeight",value:function(e,t){var n=this.parent("pdfPageRender");if(!n.isDestroyed&&n.$ui){var i=this.getMaxSize(e[0]).height;e[0].style.cssText+="\n            max-height: ".concat(i,"px;\n            height: ").concat(Math.min(e[0].scrollTop+e[0].scrollHeight,i),"px;\n        ");var r=e[0].getBoundingClientRect(),o=this.parent("pdfPageRender").getPDFRectFromClientRect(r);return this.setInnerRectHeight(o)}}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e}))}},{key:"setColor",value:function(e){var t=this;return this.annot.setBorderColor(e).then((function(e){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e}))}},{key:"setFillColor",value:function(e){var t=this;return this.annot.setFillColor(e).then((function(e){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(e){return n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n),e}))}},{key:"setInnerRectHeight",value:function(e){var t,n=this,i=this.annot.getBorderInfo(),r=Object.assign({},this.backupProperty.rect);t=i.style===me.CLOUDY?Object.assign({},this.backupProperty.innerRect):Object.assign({},r);var o={left:e.left-t.left,right:e.right-t.right,top:e.top-t.top,bottom:e.bottom-t.bottom},a=0;return Math.abs(o.left)<3&&(a++,o.left=0),Math.abs(o.right)<3&&(a++,o.right=0),Math.abs(o.top)<3&&(a++,o.top=0),Math.abs(o.bottom)<3&&(a++,o.bottom=0),4===a?Promise.resolve():(r={left:r.left+o.left,right:r.right+o.right,top:r.top+o.top,bottom:r.bottom+o.bottom},this.updateRectFigure(r,e).then((function(){n.backup()})))}},{key:"setInnerRect",value:function(e){var t=this;return(0,S._)((0,x._)(n.prototype),"setInnerRect",this).call(this,e).then((function(){return t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),!0}))}))}},{key:"updateRectFigure",value:function(e,t){var n=this;return this.annot.updateRectFigure(e,t).then((function(e){return e?n.updateRender().then((function(){return n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n),e})):e}))}},{key:"backup",value:function(){this.backupProperty={rect:Object.assign({},this.annot.getRect()),innerRect:Object.assign({},this.annot.getInnerRect())}}},{key:"onStartUpdateShape",value:function(e,t,n){this.backup()}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this,r=Promise.resolve();switch(n){case"move":r=this.moveTo(e.left,e.top,n);break;case"resize":var o=this.backupProperty.rect,a=this.backupProperty.innerRect,s={left:a.left-o.left,right:o.right-a.right,bottom:a.bottom-o.bottom,top:o.top-a.top},u=this.getPDFPage(),c=u.reverseDeviceRect({left:e.left,top:e.top,right:e.left+e.width,bottom:e.top+e.height},this.scale,this.rotate),l={left:c.left-s.left,right:c.right+s.right,bottom:c.bottom-s.bottom,top:c.top+s.top};r=this.setRectInPDF(l,!1).then((function(e){return i.setInnerRect(c)})).then((function(){i.activeRect()})).finally((function(){i.pdfViewer.eventEmitter.emit(de.annotationUpdated,[i.annot],u)}))}return this.annot.isGrouped()&&this.pdfViewer.eventEmitter.emit("freetextGroupMovingEnd"),r}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceInnerRect(n,i),o="px";t.css({left:r.left+o,top:r.top+o,width:r.right-r.left+o,height:r.bottom-r.top+o}),"editing"===this.status&&this.updateTextInputStyle()}},{key:"getBoundary",value:function(){var e=this.annot.getDeviceInnerRect(this.scale,this.rotate),t=this.annot.getInnerRect(),n=e.right-e.left,i=e.bottom-e.top;return 8&this.annot.getFlags()&&(n=t.right-t.left,i=t.top-t.bottom),{left:e.left,top:e.top,width:n,height:i}}},{key:"beforeBlur",value:function(){return!1}},{key:"handleInputEvent",value:function(){Wd.prototype.handleInputEvent.call(this)}}]),n}(Kd);const dh=lh;var hh=g(9194),fh=g.n(hh),gh="object"==typeof window?window:"function"==typeof importScripts?self:{},vh=gh.indexedDB||gh.mozIndexedDB||gh.webkitIndexedDB||gh.msIndexedDB,ph=gh.IDBTransaction||gh.webkitIDBTransaction||gh.msIDBTransaction,mh={},yh=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];(0,P._)(this,e),this.dbName=n,this.storeName=t,this.keyPath="id",this.version=i,this.indexArr=r}return(0,A._)(e,[{key:"_getDB",value:function(){var e=this,t=this.dbName,n=mh[t];if(n)return n;var i=(0,j.createDeferred)(),r=mh[t]=i.promise,o=vh.open(t,this.version),a=this.keyPath;return o.onerror=function(e){i.reject(e)},o.onupgradeneeded=function(t){var n=t.target.result;if(!n.objectStoreNames.contains(e.storeName)){var i=n.createObjectStore(e.storeName,{keyPath:a});e.indexArr.length&&e.indexArr.forEach((function(e){var t=e.indexKey,n=e.unique,r=void 0!==n&&n;i.createIndex(t,t,{unique:r})}))}},o.onsuccess=function(e){i.resolve(e.target.result)},r}},{key:"set",value:function(e,t){var n=this;return vh?this._getDB().then((function(i){var r=n.storeName,o=n.keyPath,a=i.transaction([r],ph.READ_WRITE||"readwrite").objectStore(r),s={value:t};s[o]=e.toString();var u=a.put(s),c=(0,j.createDeferred)();return u.onsuccess=function(e){c.resolve()},u.onerror=function(e){c.reject(e)},c.promise})):Promise.resolve()}},{key:"get",value:function(e){var t=this;return vh?this._getDB().then((function(n){var i=(0,j.createDeferred)(),r=t.storeName;if(!n.objectStoreNames.contains(r))return i.resolve();var o=n.transaction([r]).objectStore(r).get(e);return o.onsuccess=function(e){var t=e.target.result;if(!t)return i.resolve();i.resolve(t.value)},o.onerror=function(e){i.reject(e)},o.oncomplete=function(e){},i.promise})):Promise.resolve(null)}},{key:"getByIndex",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return vh&&this.indexArr.some((function(t){return t.indexKey===e}))?this._getDB().then((function(r){var o=(0,j.createDeferred)(),a=n.storeName;if(!r.objectStoreNames.contains(a))return o.resolve();var s=r.transaction([a]).objectStore(a).index(e).openCursor(null,"next"),u=[];return s.onsuccess=function(n){var r=n.target.result;if(r){var a=r.value[e];return i?a.toLowerCase().indexOf(t.toLowerCase())>-1&&u.push(r.value):a===t&&u.push(r.value),void r.continue()}o.resolve(u)},s.onerror=function(e){o.reject(e)},s.oncomplete=function(e){},o.promise})):Promise.resolve(null)}},{key:"remove",value:function(e){var t=this;return vh?this._getDB().then((function(n){var i=t.storeName;if(n.objectStoreNames.contains(i)){var r=n.transaction([i],ph.READ_WRITE||"readwrite").objectStore(i).delete(e),o=(0,j.createDeferred)();return r.onsuccess=function(e){o.resolve()},r.onerror=function(e){o.reject()},o.promise}})):Promise.resolve()}},{key:"clear",value:function(){var e=this;return vh?this._getDB().then((function(t){var n=e.storeName;if(t.objectStoreNames.contains(n)){var i=t.transaction([n],ph.READ_WRITE||"readwrite").objectStore(n).clear(),r=(0,j.createDeferred)();return i.onsuccess=function(e){r.resolve()},i.onerror=function(e){r.reject()},r.promise}})):Promise.resolve()}},{key:"destroy",value:function(){var e=this.dbName;delete mh[e],vh&&vh.deleteDatabase(e)}}]),e}(),kh=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"id",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return(0,P._)(this,n),(r=t.call(this,e,i,o,s)).keyPath=a,r}return(0,A._)(n,[{key:"set",value:function(){throw new Error('This method is duplicated, please use "add" instead.')}},{key:"add",value:function(e){var t=this;return vh?this._getDB().then((function(n){var i=t.storeName,r=(t.keyPath,n.transaction([i],ph.READ_WRITE||"readwrite").objectStore(i).put(e)),o=(0,j.createDeferred)();return r.onsuccess=function(e){o.resolve()},r.onerror=function(e){o.reject(e)},o.promise})):Promise.resolve()}},{key:"addItems",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)&&t.length&&vh?this._getDB().then((function(n){for(var i=function(e){var n=t[e],i=o.put(n),r=(0,j.createDeferred)();i.onsuccess=function(e){r.resolve()},i.onerror=function(e){r.reject(e)},s.push(r.promise)},r=e.storeName,o=(e.keyPath,n.transaction([r],ph.READ_WRITE||"readwrite").objectStore(r)),a=t.length,s=[],u=0;u<a;u++)i(u);return Promise.all(s)})):Promise.resolve()}},{key:"update",value:function(e,t,n){var i=this;return vh?this.get(e).then((function(e){return e[t]=n,i.add(e)})):Promise.resolve()}},{key:"get",value:function(e){var t=this;return vh?this._getDB().then((function(n){var i=(0,j.createDeferred)(),r=t.storeName;if(!n.objectStoreNames.contains(r))return i.resolve();var o=n.transaction([r]).objectStore(r).get(e);return o.onsuccess=function(e){var t=e.target.result;if(!t)return i.resolve();i.resolve(t)},o.onerror=function(e){i.reject(e)},o.oncomplete=function(e){},i.promise})):Promise.resolve(null)}},{key:"getAll",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return vh?this._getDB().then((function(i){var r=(0,j.createDeferred)(),o=e.storeName;if(!i.objectStoreNames.contains(o))return r.resolve();var a=i.transaction([o]).objectStore(o);if(IDBObjectStore.prototype.getAll){var s=a.getAll(t,n);return s.onsuccess=function(e){var t=e.target.result;if(!t)return r.resolve();r.resolve(t)},s.onerror=function(e){r.reject(e)},r.promise}var u=a.openCursor(t),c=[];return u.onsuccess=function(e){var t=e.target.result;t&&(c.push(t.value),void 0===n||c.length<n)?t.continue():r.resolve(c)},u.onerror=function(e){r.reject(e)},r.promise})):Promise.resolve(null)}},{key:"getAllKeys",value:function(e){var t=this;return vh?this._getDB().then((function(n){var i=(0,j.createDeferred)(),r=t.storeName;if(!n.objectStoreNames.contains(r))return i.resolve();var o=n.transaction([r]).objectStore(r);if(IDBObjectStore.prototype.getAllKeys){var a=o.getAllKeys(null,e);return a.onsuccess=function(e){var t=e.target.result;if(!t)return i.resolve();i.resolve(t)},a.onerror=function(e){i.reject(e)},i.promise}var s=o.openCursor(key),u=[];return s.onsuccess=function(t){var n=t.target.result;n&&(u.push(n.key),void 0===e||u.length<e)?n.continue():i.resolve(u)},s.onerror=function(e){i.reject(e)},i.promise})):Promise.resolve(null)}}]),n}(yh);function bh(e){return/^[\d\(\)\.\-\s]*\d+[\d\(\)\.\-\s]*$/.test(e)}function wh(e){var t=e.getFlags();return e.getType()===gn.Text&&!vn.isPassword(t)&&!vn.isHidden(t)&&!vn.isReadOnly(t)}function _h(e){return{text:e}}var Ph=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,P._)(this,e);var n=this.dbName="autocomplete",i=this.primaryName="text";this.db=new kh(n,Me+n,1,i),this.pdfViewer=t}return(0,A._)(e,[{key:"getFormEntries",value:function(){var e=this;return this.pdfViewer?this.pdfViewer.getCurrentPDFDoc().loadPDFForm().then((function(t){var n=[],i=t.fields,r=e.pdfViewer.getAutoCompleteSetting().rememberNumericalData,o=!0,a=!1,s=void 0;try{for(var u,c=i[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;if(wh(l)){var d=l.getValue();if(!r&&bh(d))continue;n.push(_h(l.getValue()))}}}catch(e){a=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return n})):Promise.resolve([])}},{key:"getDbEntries",value:function(){return this.db.getAll()}},{key:"getAllEntries",value:function(){var e=this;return Promise.all([this.getFormEntries(),this.getDbEntries()]).then((function(t){var n=(0,E._)(t,2),i=n[0],r=n[1];i=i||[],r=r||[];var o={},a=!0,s=!1,u=void 0;try{for(var c,l=i[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var d=c.value;o[d[e.primaryName]]=d}}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}var h=!0,f=!1,g=void 0;try{for(var v,p=r[Symbol.iterator]();!(h=(v=p.next()).done);h=!0){var m=v.value;o[m[e.primaryName]]=m}}catch(e){f=!0,g=e}finally{try{h||null==p.return||p.return()}finally{if(f)throw g}}return Object.values(o)}))}},{key:"saveDbEntry",value:function(e){!this.pdfViewer.getAutoCompleteSetting().rememberNumericalData&&bh(e)||this.db.add(_h(e))}},{key:"clearDbEntries",value:function(){return this.db.clear()}},{key:"deleteEntry",value:function(e){return this.db.remove(e)}}]),e}(),Ah="fv__autocomp-li",Sh="fv__autocomp-open",xh="fv__autocomp-close";var Ch=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r,o=i.bindInputEvent,a=void 0===o||o,s=i.entryGetter,u=i.entryMatcher,c=void 0===u?n.defaultMatcher:u,l=i.entrySorter,d=void 0===l?n.defaultSorter:l,h=i.parent,f=void 0===h?"body":h;return(0,P._)(this,n),(r=t.call(this)).bindInputEvent=a,r.entryGetter=s,r.entryMatcher=c,r.entrySorter=d,r.isOpen=!1,r.focusIndex=0,r.$input="string"==typeof e?O()(e):e,r.parent="string"==typeof f?O()(f):f,r._initData(),r._initUI(),r._initEvent(),r}return(0,A._)(n,[{key:"_initData",value:function(){this.entries=this.entryGetter()}},{key:"_initUI",value:function(){var e=this.$input.offset(),t=e.top,n=e.left,i=this.parent.offset(),r=i.top,o=i.left,a=this.$input.outerHeight(),s="top: ".concat(t-r+a,"px; left: ").concat(n-o,"px");this.$ul=O()('\n            <ul class="'.concat("fv__autocomp-ul"," ").concat(xh,'" style="').concat(s,'"></ul>\n        ')),this.parent.append(this.$ul)}},{key:"_initEvent",value:function(){this.bindInputEvent&&(this._unbindInputEvent=this._bindInputEvent()),this._unbindUlEvent=this._bindUlEvent()}},{key:"_bindInputEvent",value:function(){}},{key:"_bindUlEvent",value:function(){var e=this,t=function(t){e.$input.val(O()(t.target).data("text")),e.emit("select"),e.close()};return this.$ul.on("click","li",t),function(){return e.$ul.off("click","li",t)}}},{key:"evaluate",value:function(){var e=this;this.$ul.empty(),this.focusIndex=0;var t=this.entries;(0,D._)(t,Promise)?t.then((function(t){e.entries=t,e._displayEntries(t)})):this._displayEntries(t)}},{key:"_displayEntries",value:function(e){if((e=this.entrySorter(this.entryMatcher(e,this.$input.val()))).length>0){var t=[];for(var n in e){var i=e[n],r=this.focusIndex==n?"active":"";t.push(O()('<li class="'.concat(Ah," ").concat(r,'" data-text="').concat(i.text,'">').concat(i.text,"</li>")))}this.$ul.append(t),this.open()}else this.close()}},{key:"open",value:function(){this.$ul.removeClass(xh),this.$ul.addClass(Sh),this.isOpen=!0}},{key:"close",value:function(){this.$ul.removeClass(Sh),this.$ul.addClass(xh),this.focusIndex=0,this.isOpen=!1}},{key:"goto",value:function(e){if(this.isOpen){this.$ul.children().eq(this.focusIndex).removeClass("active");var t=this.$ul.children().eq(e);t.addClass("active"),this.focusIndex=e;var n=this.$ul,i=n.height(),r=n.scrollTop(),o=t.outerHeight(),a=t.position().top-n.children().first().position().top;a+o>i+r&&n.scrollTop(a+o-i),a<r&&n.scrollTop(a)}}},{key:"next",value:function(){var e=this.$ul.find("li.".concat(Ah)).length;if(this.isOpen&&this.entries&&0!==e){var t=(this.focusIndex+1)%e;this.goto(t)}}},{key:"previous",value:function(){var e=this.$ul.find("li.".concat(Ah)).length;if(this.isOpen&&this.entries&&0!==e){var t=(this.focusIndex-1)%e;t<0&&(t=e-1),this.goto(t)}}},{key:"select",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.focusIndex;this.$input.val(this.$ul.children().eq(e).data("text"))}},{key:"destroy",value:function(){this._unbindInputEvent&&this._unbindInputEvent(),this._unbindUlEvent&&this._unbindUlEvent(),this.$ul.remove()}},{key:"setMatcher",value:function(e){this.entryMatcher=e}}],[{key:"defaultMatcher",value:function(e,t){return e.filter((function(e){return e.text.startsWith(t)&&t!==e.text}))}},{key:"defaultSorter",value:function(e){return e}}]),n}(js()),Dh=g(5143),Eh=g.n(Dh),Ih=(g(7187),"100%"),Rh="transparent",Th=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).engineForm=a.parent("pdfDocRender").doc.getPDFForm(),a.$ui.addClass("form_text_field"),e.setRenderNotifier((function(e){return a.updateUI(e)})),a.defaultEvnet=!1,a.mousewheel(),a.generateHandler(1)&&a.bindInputEvent(),a.isOnFocus=!1,a}return(0,A._)(n,[{key:"genLabelUI",value:function(){arguments.length>1&&void 0!==arguments[1]||this.rotate;if(!this.annot.getField())return!1;var e=Eh()();return this.$foreground.after(O()(e)),!0}},{key:"mousewheel",value:function(){var e=this,t=this.parent("pdfViewerRender");this.disposor.addDestroyHook(t.scrollWrap.addScrollEventListener((function(){var t=e.formRender.dt;t&&t._positionCalendar&&e.isActive&&t.isOpen&&t._positionCalendar(e.$handler.get(0))})))}},{key:"updateOnPermissionChange",value:function(){if(this.$textInput){(0,S._)((0,x._)(n.prototype),"updateOnPermissionChange",this).call(this);var e=this.checkReadOnly();this.$textInput[0].readOnly=e}}},{key:"destroy",value:function(){this.$textInput.off("change keydown keyup blur dblclick input"),this.$input.remove(),this.$input=null,this.$textInput=null,(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.engineForm=null,this.destroyAutocomplete()}},{key:"generateHandler",value:function(e){var t=this.annot,n=t.getField();if(!n)return!1;var i=90*(4-this.annot.getRotation()+t.getPage().getRotation()),r=Ih,o=Ih,a=this.checkReadOnly(),s=4*t.getBorderWidth()/3*e,u=(0,j.getTransparentOrColor)(t.getMKProperty("borderColor"));j.isSafari&&"transparent"===u&&(u="rgba(255,255,255,0.01)");var c=(0,j.getTransparentOrColor)(t.getMKProperty("fillColor"));this.$handler.css("background-color",c);var l=t.getAlignment(),d=vn.isMultiline(n.getFlags()),h=vn.isPassword(n.getFlags()),f=vn.isNoScroll(n.getFlags()),g=vn.isNoSpellCheck(n.getFlags()),v=vn.isComb(n.getFlags())&&n.getMaxLength()>0,p=!this.checkInvisible(),m=(0,j.colorConvertor)(16777215&t.getDAFontColor(),"#"),y=this.getFontSize(n,t);y?y+="px":y=d?"16px":"xx-large";var k=n.getValue(),b=fh()({borderWidth:s,borderColor:u,background:Rh,isSafari:j.isSafari,isMultiline:d,isPassword:h,isNoScroll:f,isNoSpellCheck:g,comb:v,readonly:a,align:l,value:k,maxLength:n.getMaxLength(),visible:p,color:m,fontSize:y,rotation:i+this.rotate,left:"0",top:"0",width:r,height:o}),w=this.$input=O()(b),_=this.$textInput=w.find("input");if(this.isTextarea=0==_.length,this.isTextarea&&(_=this.$textInput=w.find("textarea")),this.$foreground.before(w),v&&_.hide(),this.formRender.usingHTML(6)){this.$input.hide();var P=this.annotsRender.pageRender;this.render(P.getScale(),P.getRotation())}else this.$input.css("visibility","hidden");return!0}},{key:"getFontSize",value:function(e,t){var n=t.getDefaultAppearance(),i=e.getDAFontSize();return n&&n.textSize&&(i=n.textSize),4*i/3}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.render(e,t,n)}},{key:"updateForgroundAndHandler",value:function(e,t){(0,S._)((0,x._)(n.prototype),"updateForgroundAndHandler",this).call(this,e,t),this.$textInput.css(this.$handler.css(["width","height"]))}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.annot)return Promise.resolve();var r=this.annot,o=r.getField();this.scale=e,this.rotate=t;var a=this.updateForgroundAndHandler(e,t);if(o&&this.formRender.usingHTML(6)){var s=this.getFontSize(o,r)*e;if(s)s+="px";else if(vn.isMultiline(o.getFlags()))s=16*e+"px";else{clearTimeout(this.autoFontSizeTimeout);var u=this;this.autoFontSizeTimeout=setTimeout((function(){u.annot&&u.formRender&&(u.autoFontSize(),u.formRender.usingHTML(6)&&u.$input.show())}),20)}var c,l,d=((this.getPDFPage().getRotationAngle()+t-90*r.getRotation())%360+360)%360,h="center";switch(d){case 90:case 270:c=a.height,l=a.width,h=270===d?"".concat(c/2,"px ").concat(c/2,"px"):"".concat(l/2,"px");break;default:c=a.width,l=a.height}vn.isComb(o.getFlags())&&o.getMaxLength()>0&&this.$input.find(".textComb").css({width:a.width/o.getMaxLength(),height:a.height,"line-height":a.height+"px",fontSize:s});var f=4*r.getBorderWidth()/3*e,g={"font-size":s,"border-width":f+"px",transform:"rotate(".concat(d,"deg)"),"transform-origin":h,width:c+"px",height:l+"px","line-height":vn.isMultiline(o.getFlags())?"1":l-2*f+"px"};this.$input.show(),this.$textInput.css(g)}return this.formRender.usingHTML(6)?Promise.resolve():(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t,i)}},{key:"focus",value:function(e){var t=this;this.autoFontSize(),this.hasFocus=!0,this.$handler.find("canvas").hide(),this.$input.css("visibility","visible");var n=this.annot.getDefaultAppearance();this.$input.find("input").css("fontFamily",n.fontName||n.fullName);var i=this.annot.getField(),r=this.$textInput;e||(this.lastAvailableValue=i.getValue()),this.isOnFocus=!0,setTimeout((function(){t.$foreground.hide(),t.isOnFocus=!1;var e=!!t.getDateTimeFormat();j.isIOS&&e||document.activeElement!=r[0]&&r[0].focus()}),50),this.$input.find(".textCombContainer").hide(),r.show();var o,a=i.getAction(vo.FieldWillFormat),s=this.getDateTimeFormat();if(s){if(0==(s=pa.switchFormat(s,"toLib")).length&&(s="m-d-y"),this.isTextarea&&Object.defineProperty(r[0],"type",{value:"text",writable:!0}),0!==this.formRender.getEditType())return;this.formRender.showDateTimePicker(r.val(),s,r[0],(function(e,n,i){r.val(n),t.valueChanged=!0}))}if("basic"===this.pdfViewer.getAutoCompleteSetting().level&&wh(i)&&!this.isDate){var u=new Ph(this.pdfViewer),c=i.getMaxLength(),l=this.$autocomplete=new Ch(this.$textInput,{entryGetter:u.getAllEntries.bind(u),parent:this.parent("pdfPageRender").$annotsContainer});c&&l.setMatcher((o=c,function(e,t){return e.filter((function(e){var n=e.text;return n.startsWith(t)&&n!==t&&n.length<=o}))})),l.on("select",(function(){t.valueChanged=!0,t.formRender.blurControl()}))}i&&r.val(i.getValue()||""),a=this.annot.getAdditionalAction(vo.AnnotReceiveInputFocus);try{return a&&this.formRender.execAction("Field",a,null,i)}finally{this.isActive=!0,this.pdfViewer.eventEmitter.emit(de.focusOnControl,this)}}},{key:"handleEvent",value:function(e,t){if(!this.$ui.hasClass("selected")&&!this.$ui.hasClass("editing")){0;var n=this.formRender;if(this.checkReadOnly()||this.checkInvisible())e!=vo.AnnotMouseButtonReleased&&e!=vo.AnnotReceiveInputFocus||n.blurControl();else{switch(e){case vo.AnnotMouseButtonPressed:if(n.control==this)return this.performAction(e),2;n.focusControl(this);break;case vo.AnnotMouseButtonReleased:if(!n.isSameTarget(this))return;var i=this.annot.action;i&&n.execAction("Field",i,null,this.annot.getField());var r=this.$textInput;j.isIOS||(setTimeout((function(){document.activeElement!=r[0]&&r.focus()}),50),this.$input.find(".textCombContainer").hide(),r.show()),this.getDateTimeFormat()&&this.formRender.reshowDTPicker(r[0])}this.performAction(e)}}}},{key:"bindInputEvent",value:function(){var e=this;this.$textInput.on("keydown",(function(t){27==t.keyCode&&t.preventDefault();var n=e.$autocomplete;n&&(38===t.keyCode&&n.isOpen&&(n.previous(),t.preventDefault()),40===t.keyCode&&(n.isOpen?n.next():n.evaluate(),t.preventDefault()),13===t.keyCode&&n.isOpen&&(n.select(),t.preventDefault(),t.stopPropagation()))})).on("keyup",(function(t){if((0,j.isMatch)(t,j.matchers.Escape)&&t.preventDefault(),!e.checkReadOnly())if(setTimeout((function(){e.autoFontSize(e.$textInput.val())}),0),(0,j.isMatch)(t,j.matchers.Enter)){var n=e.annot.getField();!vn.isMultiline(n.getFlags())&&e.blur()}else if(!(0,j.isMatch)(t,j.matchers.Tab)){var i=e.formRender.dt;i&&(i._inputTemp||(i._inputTemp=i._input),i._input=i._input.cloneNode(),i.close())}})).on("dblclick",(function(t){e.$autocomplete&&e.$autocomplete.evaluate()})).on("paste",(function(t){e.pasteFont=null;var n=t.originalEvent.clipboardData.getData("text/html");if(0!==n.length){var i=jd.formatRichText(n);0!==i.length&&(e.pasteFont=i[0].richTextStyle.font)}})).on("input",(function(t){t.target.value=(0,j.replaceInvalidXMLCharacters)(t.target.value," "),e.valueChanged=!0,e.$autocomplete&&(t.target.value.length>0?e.$autocomplete.evaluate():e.$autocomplete.close())})).on("blur",(function(t){e.getDateTimeFormat()||e.$autocomplete||e.formRender.blurControl()}))}},{key:"updateUIMore",value:function(e){var t=this,i=e.type,r=e.value,o=this.annot,a=this.$input,s=this.$textInput,u=o.getField();if(u){var c=Promise.resolve();switch(i){case"value":var l=u.getAction(vo.FieldWillFormat),d=u.getAction(vo.FieldValueChanged);if(u.NeedExecuteValidateAction&&0!=u.getValue().length&&d)if(!this.formRender.execAction("Field",d,null,u,vo.FieldValueChanged).rc){u.setValue(this.lastAvailableValue,this.annot),this.valueChange(!1,u);break}c.then((function(e){if(0!=u.getValue().length&&l&&t.formRender){var n=t.formRender.execAction("Field",l,null,u,vo.FieldWillFormat);n&&-1!==n&&!n.rc&&(u.setValue(t.lastAvailableValue,t.annot),t.valueChange(!1,u))}0===u.getValue().length&&u.setDisplayValue(r)}));break;case"displayValue":if(vn.isComb(u.getFlags())&&u.getMaxLength()>0){var h=u.getMaxLength();if(2===u.getAlignment()){var f=a.find(".textComb").length,g=r.length,v=f-r.length-1,p=0;v<-1&&(v=-1),r.length>f&&(p=r.length-f);for(var m=f-1;m>v;m--)a.find(".textComb[data-index=".concat(m,"]")).html(r[m-f+g-p]);for(var y=v;y>-1;y--)a.find(".textComb[data-index=".concat(y,"]")).html("")}else{for(var k=0;k<r.length;k++)a.find(".textComb[data-index=".concat(k,"]")).html(r[k]);for(var b=r.length;b<h;b++)a.find(".textComb[data-index=".concat(b,"]")).html("")}}c=u.setDisplayValue(r),s.val(r);break;case"align":s.css("text-align",r);break;case"borderStyle":s.css("border-style",r);break;case"borderColor":r=(0,j.getTransparentOrColor)(r),a.find(".textComb").css("border-color",r),s.css("border-color",r);break;case"maxLength":void 0===r?s.removeAttr("maxlength"):(s.attr("maxlength",r),s.val(s.val().substr(0,r)));break;case"noSpellCheck":s.prop("spellcheck",!r);break;case"noScroll":case"comb":case"multiline":case"lineSpace":a.remove(),this.generateHandler(this.scale),this.bindInputEvent(),this.isActive&&this.focus(),this.render(this.scale,this.rotate,!0);break;case"fillColor":this.$handler.css("background-color",(0,j.getTransparentOrColor)(r));break;case"password":s.attr("type",r?"password":"text");break;case"readonly":r?(this.$foreground.addClass("form-field-readonly").css("visibility","hidden"),s.attr("readonly",!0)):(this.checkReadOnly()||this.checkInvisible()||this.$foreground.removeClass("form-field-readonly").css("visibility","visible"),s.removeAttr("readonly"));var w=(0,j.getTransparentOrColor)(o.getMKProperty("fillColor"));r&&(w=Rh),s.css("background-color",w);break;case"hidden":var _=this.$handler;r?_.hide():_.show();break;case"textColor":s.css("color",r)}this.formRender.usingHTML(6)||c.then((function(e){return t.annot&&(0,S._)((0,x._)(n.prototype),"render",t).call(t,t.scale,t.rotate,!0)}))}}},{key:"blur",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hasFocus=!1;var n=this.$textInput;setTimeout((function(){e.destroyAutocomplete()}),0),this.isActive=!1,this.$handler.find("canvas").show();try{var i=[];if(this.pasteFont)this.annot.getField().controls.forEach((function(t){i.push(t.setDefaultAppearance({fontName:e.pasteFont.name}))})),this.pasteFont=null;return Promise.all(i).then((function(i){return e.setValue(n.val(),t)})).finally((function(t){e.formRender.usingHTML(6)||e.$input.css("visibility","hidden")}))}finally{this.pdfViewer.eventEmitter.emit(de.blurFromObject,this,t)}}},{key:"setValue",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.annot.getField();i.setValueWithoutAction(e),e===this.lastAvailableValue&&(this.valueChanged=!1);var r=!1,o=i.getAction(vo.FieldKeyStroke);return this.valueChanged&&o&&-1!==(t=this.formRender.execAction("Field",o,null,i,vo.FieldKeyStroke,{change:e,willCommit:!0}))&&(t.rc?(void 0!==t.change&&null!==t.change||(t.change=e),i.setValueWithoutAction(t.change)):(r=!0,e=this.lastAvailableValue)),r?(i.setValue(this.lastAvailableValue,this.annot),this.valueChange(r,i,n)):(o=i.getAction(vo.FieldValueChanged),this.valueChanged&&o&&-1!==(t=this.formRender.execAction("Field",o,null,i,vo.FieldValueChanged))&&(t.rc?(void 0===t.value&&(t.value=e),i.setValueWithoutAction(t.value)):r=!0),r?i.setValue(this.lastAvailableValue,this.annot):this.valueChanged?i.syncValue(i.getValue()):(o=i.getAction(vo.FieldWillFormat),(t=i.getValue()&&o&&this.formRender.execAction("Field",o,null,i,vo.FieldWillFormat))&&!t.rc?(i.setValue(this.lastAvailableValue,this.annot),this.valueChange(!1,i,n)):this.valueChanged&&i.syncValue(i.getValue())),this.valueChange(r,i,n))}},{key:"valueChange",value:function(e,t,i){return this.valueChanged&&!e&&this.formRender.calculate(t),this.valueChanged=!1,!e&&"basic"===this.pdfViewer.getAutoCompleteSetting().level&&wh(t)&&new Ph(this.pdfViewer).saveDbEntry(t.getValue()),t&&vn.isComb(t.getFlags())&&t.getMaxLength()>0&&(this.$textInput.hide(),this.$input.find(".textCombContainer").show()),(0,S._)((0,x._)(n.prototype),"blur",this).call(this,i),e}},{key:"isComb",value:function(){var e=this.annot.getField();return vn.isComb(e.getFlags())&&e.getMaxLength()>0}},{key:"destroyAutocomplete",value:function(){this.$autocomplete&&this.$autocomplete.destroy(),this.$autocomplete=null}},{key:"getDateTimeFormat",value:function(){var e=this.annot.getField().getAction(vo.FieldWillFormat);if(e&&e.getScript){var t,n=e.getScript();if(-1!==n.indexOf("AFDate_Format")){t=/AFDate_Format(?:Ex)?\("([\s\S]*?)"\)/;var i=n.match(t);if(i&&2==i.length)return i[1].trim()}else if(-1!==n.indexOf("AFTime_Format")){t=/AFTime_Format(?:Ex)?\(([\s\S]*?)\)/;var r=n.match(t);if(r&&2==r.length)return Fh[r[1]]||r[1].replace(/"/g,"")}}}}]),n}(Ho),Fh=["HH:MM","h:MM tt","HH:MM:ss","h:MM:ss tt"];const Mh=Th;var Oh=g(6892),Lh=g.n(Oh),Nh=function(e){return String(e).replace(/[<>&"]/g,(function(e){return{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"}[e]}))},Vh=function(e){return String(e).replace(/[<>&"\s]/g,(function(e){return{" ":"&nbsp;","<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"}[e]}))},Bh=function(e){return String(e).replace(/([!\"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g,"\\$1")},jh=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).engineForm=a.parent("pdfDocRender").doc.getPDFForm(),a.$ui.addClass("form_listbox_field"),e.setRenderNotifier((function(e){return a.updateUI(e)})),a.generateHandler(1),a}return(0,A._)(n,[{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.$input.remove(),this.engineForm=null}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;this.scale=e,this.rotate=t,this.updateForgroundAndHandler(e,t);this.annot.getField();var n=this.getDAFontSize(),i=this.getDAFontName(),r=this.getFontStyle(i),o=this.getFontWeight(i),a=this.getFontFamily(i),s=4*this.annot.getBorderWidth()/3*e;"underline"=={0:"solid",1:"dashed",2:"underline",3:"beveled",4:"inset"}[this.annot.getBorderStyle()||0]?this.$input.css({"border-style":"solid","border-width":"0","border-bottom-width":s+"px"}):this.$input.css({"border-width":s+"px"}),this.$input.css({"font-size":n,"font-weight":o,"font-style":r,"font-family":a}),this.$input.find(".form-field-option").css({"font-size":n,"font-weight":o,"font-style":r,"font-family":a+", sans-serif"});var u,c,l=this.getRect(e,t),d=l.right-l.left,h=l.bottom-l.top,f=((this.getPDFPage().getRotationAngle()+t-90*this.annot.getRotation())%360+360)%360,g="center";switch(f){case 90:case 270:u=h,c=d,g=270===f?"".concat(u/2,"px ").concat(u/2,"px"):"".concat(c/2,"px");break;default:u=d,c=h}this.$input.css({width:u-1,height:c,transform:"rotate(".concat(f,"deg)"),"transform-origin":g});var v=this.$input.find(".selected");!this.scrollSet&&v.length>0&&(this.scrollSet=!0,this.$input[0].scrollTop=v[0].offsetTop)}},{key:"generateHandler",value:function(e){var t=this.annot.getField();if(t){var n=this.checkReadOnly(),i=4*this.annot.getBorderWidth()/3*e,r=this.annot.getMKProperty("borderColor"),o=(0,j.getTransparentOrColor)(r),a=this.annot.getMKProperty("fillColor"),s=(0,j.getTransparentOrColor)(a),u=t.getAlignment(),c=t.getOptions(),l=t.getOptions(),d=t.getValue();l.map((function(e){"object"==typeof e&&d===e.value&&(d=e.label)}));var h=this.annot.getDefaultAppearance()||{},f=(0,j.colorConvertor)(16777215&h.textColor,"#"),g=this.getDAFontSize(),v={0:"solid",1:"dashed",2:"underline",3:"beveled",4:"inset"}[this.annot.getBorderStyle()||0];"beveled"==v&&(v="outset");var p=Lh()({borderWidth:i,borderColor:o,background:s,options:c,align:u,readonly:n,value:d,color:f,fontSize:g,borderStyle:v});this.checkInvisible()&&this.$handler.hide();var m=this.$input=O()(p);this.$handler.append(m)}}},{key:"focus",value:function(){(0,S._)((0,x._)(n.prototype),"focus",this).call(this),this.lastAvailableValue=this.annot.getField().getValue()}},{key:"handleEvent",value:function(e,t){var n=this,i=this.formRender,r=this.annot;if(this.checkReadOnly())e!=vo.AnnotMouseButtonReleased&&e!=vo.AnnotReceiveInputFocus||i.blurControl();else{var o=r.getField();if(o){var a=Promise.resolve();switch(e){case vo.AnnotMouseButtonPressed:if(i.focusControl(this),O()(t.target).hasClass("form-field-option"))this._pressedTarget=t.target;else if(O()(t.target).hasClass("fv__ui-form-foreground")){var s=t.clientX,u=t.clientY;O()(t.target).next(".form-field-options").find(".form-field-option").each((function(e,t){var i=t.getBoundingClientRect();if(s>=i.left&&s<=i.right&&u>=i.top&&u<=i.bottom)return n._pressedTarget=t,!1}))}break;case vo.AnnotMouseButtonReleased:var c=t.target,l=!1;if(O()(t.target).hasClass("form-field-option")?l=!0:this._pressedTarget&&O()(this._pressedTarget).hasClass("form-field-option")&&(l=!0,c=this._pressedTarget),delete this._pressedTarget,l){var d=O()(c).index(),h=vn.isChoiceMultiSelect(o.getFlags())&&(j.isMac?j.keyboardStatus.isWinDown:j.keyboardStatus.isCtrlDown),f=o.getOptions(),g=f[d];h?g.selected?g.selected=!1:g.selected=!0:(f.forEach((function(e){return e.selected=!1})),g.selected=!0);var v=f.reduce((function(e,t){return t.selected&&e.push(t.value),e}),[]);h||(v=v[0]),o.setValueWithoutAction(""),a=i.setValue(r,v).then((function(e){o.setOptions(f,!0),n.lastAvailableValue=v}))}setTimeout((function(){var e=r.action;i.execAction("Field",e,null,r.getField())}),0)}a.then((function(t){n.performAction(e)}))}}}},{key:"updateUIMore",value:function(e){var t=this,n=e.type,i=e.value,r=this.$input,o=this.annot.getField(),a=Promise.resolve(),s=!1;switch(n){case"value":o.setValueEx(i,null,!1);var u=r.find(".form-field-option");if(!u.length)return;var c=r[0],l=c.getBoundingClientRect();o.getOptions().forEach((function(e,t){if(u.get(t)&&(O()(u.get(t)).toggleClass("selected",e.selected),e.selected)){var n=u.get(t).getBoundingClientRect();c.scrollTop=c.scrollTop+n.top-l.top}}));break;case"align":r.css("text-align",i);break;case"borderStyle":var d=4*this.annot.getBorderWidth()/3*this.scale;if(r.css("border-width",d),"underline"==i){r.css({"border-style":"solid","border-width":"0","border-bottom-width":d+"px"});break}"beveled"==i&&(i="outset"),r.css("border-style",i);break;case"clearItems":this.updateUIMore({type:"value",value:o.getValue()}),r.find(".form-field-option").remove(),s=!0;break;case"deleteItems":this.updateUIMore({type:"value",value:o.getValue()}),r.find(".form-field-option:nth-child("+(i+1)+")").remove(),this.updateUIMore({type:"value",value:o.getValue()}),s=!0;break;case"insertItemAt":var h=this.annot.getField().getOptions()[i],f='<div class="form-field-option" data-val="'.concat(h.value,'" data-index="').concat(i,'" style="white-space: nowrap; overflow-x: hidden;">').concat(Nh(h.label||""),"</div>");r.children().length<=i?r.append(f):r.find(".form-field-option:nth-child("+(i+1)+")").before(f),this.updateUIMore({type:"value",value:o.getValue()}),s=!0;break;case"borderColor":r.css("border-color",(0,j.getTransparentOrColor)(i));break;case"fillColor":r.css("background-color",(0,j.getTransparentOrColor)(i));break;case"setItems":var g=this.getDAFontSize(),v=this.annot.getField().getOptions().map((function(e){return'<div class="form-field-option '.concat(e.selected?"selected":"",'" data-val="').concat(e.value,'" data-index="').concat(i,'" style="white-space: nowrap; overflow-x: hidden; font-size: ').concat(g,'; ">').concat(Nh(e.label||""),"</div>")}));r.find(".form-field-option").remove(),r.append(v.join("")),s=!0;break;case"textColor":r.find(".form-field-option").css("color",(0,j.getTransparentOrColor)(i));break;case"choiceMultiSelect":break;case"DA":var p=i.fontName.toLowerCase()||"",m=this.getFontStyle(p),y=this.getFontWeight(p),k=this.getFontFamily(p),b=this.getDAFontSize();this.$input.find(".form-field-option").css({"font-size":b,"font-weight":y,"font-style":m,"font-family":k+", sans-serif"})}if(s){var w=this.$input.find(".selected");w.length>0&&(this.scrollSet=!0,this.$input[0].scrollTop=w[0].offsetTop)}this.formRender.usingHTML(gn.ListBox)||a.then((function(e){return t.annot&&t.render(t.scale,t.rotate,!0)}))}},{key:"getDAFontSize",value:function(){var e=this.scale,t=this.annot.getControl().getDefaultAppearance().textSize*e*4/3;return t||(t=12*e),t+="px"}},{key:"getDAFontName",value:function(){return this.annot.getControl().getDefaultAppearance().fontName||""}},{key:"getFontWeight",value:function(e){return e.includes("bold")?"bold":"normal"}},{key:"getFontStyle",value:function(e){return e.includes("italic")||e.includes("oblique")?"italic":"normal"}},{key:"getFontFamily",value:function(e){var t=e,n=e.indexOf("-");return n>0&&(t="times-roman"===e.toLowerCase()?"Times Roman":e.substring(0,n)),t}}]),n}(Ho);const Uh=jh;var Hh,Wh=g(1771),Yh=g.n(Wh),qh=g(7416),Kh=g.n(qh),$h=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).engineForm=a.parent("pdfDocRender").doc.getPDFForm(),a.$handler.addClass("fv_combobox_field"),a.available=!0,a.genDropDownUI(1),a.genLabelUI(),a.bindDropDownUIEvent(),a}return(0,A._)(n,[{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.$optionsList&&(this.$optionsList.off("click"),this.$optionsList.remove()),this.engineForm=null,this.$optionsList=null}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;if(this.annot&&(this.scale=t,this.rotate=i,this.available)){var r=this.updateForgroundAndHandler(t,i),o=(r.width,r.height);r.left<1&&(r.left=1);var a=this.annotsRender.pageRender.getShowHeight(),s=this.annotsRender.pageRender.getShowWidth(),u=1===this.annot.getDirectionRTL()?"right":"left";this.$optionsList.css({"text-align":u,"font-size":"16px","overflow-y":"auto"});var c=4*this.annot.getBorderWidth()/3*t,l=this.annot.getField();if(!l)return!1;var d,h,f,g,v,p,m=this.getRect(t,i),y=m.right-m.left,k=m.bottom-m.top,b=200,w=((this.getPDFPage().getRotationAngle()+i-90*this.annot.getRotation())%360+360)%360;switch(w){case 270:d=y,g=f="".concat((h=k)/2,"px ").concat(h/2,"px"),p=m.left+d,v=m.top,b+p>=s&&(b=s-p-1);break;case 90:h=k,f="".concat((d=y)/2,"px"),g="".concat(d/2,"px -").concat(d/2,"px"),p=m.left,v=m.top+d,p-b<=0&&(b=p-1);break;case 180:h=y,d=k,f="center",g="center top",p=m.left,(v=m.top)-b<=0&&(b=v-1);break;default:h=y,d=k,f="center",g="center",v=m.top+d,p=m.left,b+v>=a&&(b=a-v)}var _=4*l.getDAFontSize()/3,P={"text-align":u,"font-size":_=(_?2*_:.7*d)+"px","border-width":c+"px",padding:c+"px",height:d+"px",width:h+"px",transform:"rotate(".concat(w,"deg)"),"transform-origin":f},A=.3*o>20?20:.3*o;r.width<A+10?P.opacity=0:P.opacity=1,this.$textInput.css(P),this.formRender.usingHTML(gn.ComboBox)&&this.$handler.css({left:m.left,top:m.top,width:h,height:d,transform:"rotate(".concat(w,"deg)"),"transform-origin":f}),this.$optionsList.css({top:v,left:p,width:h,maxHeight:b,transform:"rotate(".concat(w,"deg)"),"transform-origin":g}),this.$handler.find(".fwr__ui-combo-dropdown").css({"border-width":"".concat(A,"px ").concat(.6*A,"px 0"),top:"".concat((d-A)/2,"px")}),this.arrowRender(c,h,d,w),!_&&this.formRender.usingHTML(gn.ComboBox)?(clearTimeout(this.autoFontSizeTimeout),this.autoFontSizeTimeout=setTimeout((function(){e.autoFontSize(e.$textInput.val(),2*A)}),200)):_+="px",this.formRender.usingHTML(gn.ComboBox)||(0,S._)((0,x._)(n.prototype),"render",this).call(this,t,i)}}},{key:"arrowRender",value:function(e,t,n,i){var r,o,a,s,u=this.annot.getDirectionRTL();switch(i){case 90:a=n-3*e,r=1===u?-(20-e):a+e,o=t-n+e,s="100% 100%";break;case 180:a=n-2*e,r=1===u?e:t-e-20,o=e,s="50% 50%";break;case 270:a=n-2*e,r=1===u?a+e:-(20-e),o=-(n+2*e-30),s="0 100%";break;default:a=n-2*e,r=1===u?t-e-20:e,o=e,s="0 0"}this.$arrow.css({right:r,top:o,height:a,width:20*this.scale,"max-width":20,transform:"rotate(".concat(i,"deg)"),"transform-origin":s}),this.$arrow.find(">span").css({transform:"scale(".concat(Math.min(this.scale,1),")"),"transform-origin":"-36% 0"})}},{key:"handleEvent",value:function(e,t){if(this.checkReadOnly())e!=vo.AnnotMouseButtonReleased&&e!=vo.AnnotReceiveInputFocus||this.formRender.blurControl();else{switch(e){case vo.AnnotMouseButtonPressed:this.optionsMounted=this.optionsMounted||this.$handler.after(this.$optionsList),this.$optionsList.show(),this.formRender.focusControl(this);break;case vo.AnnotMouseButtonReleased:O()(t.target).hasClass("form-field-option")&&(t.stopPropagation(),this.$optionsList.hide())}this.performAction(e)}}},{key:"genDropDownUI",value:function(e){var t=this.annot,n=this.annot.getField();if(n){var i=4*t.getBorderWidth()/3*e,r=t.getMKProperty("borderColor"),o=(0,j.colorConvertor)(r,"#");0===r&&(o="gray");var a=t.getMKProperty("fillColor"),s=(0,j.colorConvertor)(a,"#");0===a&&(s="white");var u=n.getOptions(),c=n.getValue(),l=Yh()({borderWidth:i,borderColorHex:o,fillColorHex:s,background:"white",options:u,value:c});this.$optionsList=O()(l),this.$optionsList.hide()}else this.available=!1}},{key:"bindDropDownUIEvent",value:function(){var e=this;if(this.available){var t=this.formRender,n=this.annot;this.$optionsList.on("click",(function(i){var r=n.getField(),o=r.getOptions();if(O()(i.target).hasClass("form-field-option")){var a=O()(i.target).data("val")+"";if(i.stopPropagation(),e.$optionsList.hide(),e.$optionsList.find(".selected").removeClass("selected"),O()(i.target).addClass("selected"),!r)return;o.forEach((function(e){e.selected=!1}));var s=O()(i.target).index();if(o[s].selected=!0,r.getFlags()&vn.CommitOnSelChange){if(r.getValue()===a)return;t.setValue(n,a,!1)}else e.$textInput.css("visibility","visible"),e.$handler.find("#pdfcanvas").hide(),s<o.length&&(a=o[s].label),e.$textInput.val(a),e.$textInput.focus()}setTimeout((function(){var e=n.action;t.execAction("Field",e,null,n.getField())}),150)}))}}},{key:"blur",value:function(){var e=this;this.hasFocus=!1;var t=function(){e.formRender.usingHTML(gn.ComboBox)||e.$input.css("visibility","hidden"),e.$arrow.css("visibility","visible")},i=this.formRender,r=this.annot;this.$optionsList.hide();var o=(0,j.createDeferred)();if(this.$textInput.length>0){var a=this.$textInput.val(),s=r.getField();if(!s)return void o.resolve();var u=a,c=s.getFlags();if(!(vn.ComboEdit&c))s.getOptions().forEach((function(e){e.label==a&&(u=e.value)}));i.setValue(r,u).then((function(){t(),e.$handler.find("#pdfcanvas").show(),o.resolve(!1)}),o.reject)}else t(),o.resolve();return o.promise.finally((function(){(0,S._)((0,x._)(n.prototype),"blur",e).call(e)}))}},{key:"focus",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"focus",this).call(this);var t=this.annot.getField();if(t){var i=t.getValue(),r=i;t.getOptions().forEach((function(e){i==e.value+""&&(r=e.label)})),this.$textInput.val(r),setTimeout((function(){vn.isComboEdit(t.getFlags())?(e.$textInput.css("visibility","visible").prop("readonly",!1),e.$handler.find("#pdfcanvas").hide(),e.$textInput.focus()):(e.$textInput.css("visibility","hidden").prop("readonly",!0),e.$handler.find("#pdfcanvas").show())}),10)}}},{key:"genLabelUI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;if(!this.annot.getField())return!1;var n=Kh()(this.getStyle(e,t)),i=this.$input=O()(n);return this.$foreground.after(i),this.$textInput=this.$handler.find("input"),this.formRender.usingHTML(gn.ComboBox)||this.$input.css("visibility","hidden"),this.$arrow=this.$handler.find(".fwr__ui-combo-arrow"),this.$arrow.css("visibility","visible"),!0}},{key:"updateUIMore",value:function(e){var t=this,i=e.type,r=e.value,o=this.$textInput,a=this.$optionsList,s=this.annot.getField();if(s&&2!=(2&this.annot.info.flag)){var u=1===this.annot.getDirectionRTL()?"right":"left",c=Promise.resolve();switch(i){case"value":c.then((function(e){var n=s.getAction(vo.FieldWillFormat);if(0!=s.getValue().length&&n)t.formRender.execAction("Field",n,null,s,vo.FieldWillFormat);0===s.getValue().length&&s.setDisplayValue(r)})),o.val(r),a.find(".selected").removeClass("selected"),a.find(".form-field-option").each((function(e,t){O()(t).css("text-align",u),O()(t).attr("data-val")===r&&O()(t).addClass("selected")}));break;case"displayValue":c=s.setDisplayValue(r),o.val(r);break;case"align":o.css("text-align",r),a.css("text-align",r),this.render(this.scale,this.rotate,!0);break;case"borderStyle":o.css("border-style",r);break;case"borderColor":o.css("border-color",(0,j.getTransparentOrColor)(r));break;case"borderWidth":case"orientation":case"rect":this.render(this.scale,this.rotate,!0);break;case"fillColor":this.$input.find(".textCombContainer").css("background-color",(0,j.getTransparentOrColor)(r)),o.css("background-color",(0,j.getTransparentOrColor)(r));break;case"readonly":r?(this.$foreground.hide().addClass("form-field-readonly").css("visibility","hidden"),o.attr("readonly",!0)):(this.$foreground.show().removeClass("form-field-readonly").css("visibility","visible"),o.removeAttr("readonly"));break;case"clearItems":a.find(".form-field-option").remove(),this.updateUIMore({type:"value",value:s.getValue()});break;case"deleteItems":a.find(".form-field-option:nth-child("+(r+1)+")").remove(),this.updateUIMore({type:"value",value:s.getValue()});break;case"insertItemAt":var l=this.annot.getField().getOptions(),d="";l.forEach((function(e,t){d+='<div class="form-field-option '.concat(e.selected?"selected":"",'" data-val="').concat(e.value,'" data-index="').concat(t,'" style="white-space: nowrap; overflow-x: hidden;">').concat(Nh(e.label||""),"</div>")})),a.empty().append(d),this.updateUIMore({type:"value",value:s.getValue()});break;case"setItems":var h=this.annot.getField().getOptions().map((function(e){return'<div class="form-field-option '.concat(e.selected?"selected":"",'" data-val="').concat(e.value,'" data-index="').concat(r,'" style="white-space: nowrap; overflow-x: hidden;">').concat(Nh(e.label||""),"</div>")}));a.find(".form-field-option").remove(),a.append(h.join(""));break;case"comboEdit":break;case"textColor":o.css("color",r)}this.formRender.usingHTML(gn.ComboBox)||c.then((function(e){return(0,S._)((0,x._)(n.prototype),"render",t).call(t,t.scale,t.rotate,!0)}))}}},{key:"getStyle",value:function(e,t){var n=this.annot,i=n.getField();if(!i)return!1;var r=this.checkReadOnly(),o=4*n.getBorderWidth()/3*e,a=n.getMKProperty("borderColor"),s=(0,j.getTransparentOrColor)(a),u=n.getMKProperty("fillColor"),c=(0,j.getTransparentOrColor)(u),l=i.getAlignment(),d=!this.checkInvisible(),h=(0,j.colorConvertor)(16777215&i.getDAFontColor(),"#"),f=4*i.getDAFontSize()/3;f=(f?2*f:16)+"px";var g=vn.isComboEdit(i.getFlags()),v=i.getOptions(),p=i.getValue();return v.map((function(e){"object"==typeof e&&p===e.value&&(p=e.label)})),{comboEditable:g,borderWidth:o,borderColor:s,background:c,readonly:r,align:l,value:p,maxLength:i.getMaxLength(),visible:d,color:h,fontSize:f,width:"100%",height:"100%"}}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return this.render(e,t)}}]),n}(Ho),zh="annotComponent",Gh={sign:{name:"Sign",nameI18nKey:"viewer_:contextmenu.annot.sign",callback:function(e,t,n,i){this.data(zh).sign(e,t,n,i)},show:function(){return this.data(zh).updateDeleteStatus(!0),!0},hide:function(){return this.data(zh).updateDeleteStatus(!1),!0}},properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n,i){this.data(zh).showPropertiesDialog(e,t,n,i)}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(zh).removeAnnot()},disabled:function(){return this.data(zh).deleteDisabled()}}};var Jh,Xh=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Gh,events:{show:function(){return this.data(zh).updateDeleteStatus(!0),!0},hide:function(){return this.data(zh).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),Zh=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).$esignChinaContainer=null,a.genLabelUI(),a}return(0,A._)(n,[{key:"genLabelUI",value:function(){arguments.length>1&&void 0!==arguments[1]||this.rotate;if(!this.annot.getField())return!1;var e=Eh()();return this.$foreground.after(O()(e)),!0}},{key:"getControlContext",value:function(){return this.contextMenu?this.contextMenu:this.contextMenu=this.pdfViewer.viewerUI.createContextMenu(this,this.$ui.get(0),this.getContextMenuConfig())}},{key:"getContextMenuConfig",value:function(){var e=this.constructor,t=e.getContextMenuConfig();if(t)return t;var n=e.getDefaultContextMenuConfig();for(var i in n)if("items"===i){var r=n[i],o=this.pdfViewer.i18n;for(var a in r){var s=r[a];s.nameI18nKey&&(s.name=o.t(s.nameI18nKey))}}return e.setContextMenuConfig(n),n}},{key:"showContextMenu",value:function(e,t){var n;(n=this.contextMenu)&&(n.setCurrentTarget(this),n.showAt(e,t))}},{key:"getContextMenuComponentName",value:function(){return"fv--field-signature-contextmenu"}},{key:"handleEvent",value:function(e,t){var i=this,r=this;return(0,_._)((function(){var o,a;return(0,F.Jh)(this,(function(s){switch(s.label){case 0:return[4,(0,S._)((0,x._)(n.prototype),"handleEvent",i).call(r,e,t)];case 1:if(o=s.sent())return[2,o];switch(e){case"contextmenu":return t.preventDefault(),r.checkReadOnly()?[2]:(r.contextMenu||(r.contextMenu=r.getControlContext(r)),(a=r.contextMenu)&&(a.setCurrentTarget(r),r.handleContextMenu(a),a.showAt(t.clientX,t.clientY)),[2,!1]);case vo.AnnotMouseButtonPressed:0==t.button&&r.pdfViewer.eventEmitter.emit(de.signatureFieldMouseLButtonDown,r.annot);break;case vo.AnnotMouseButtonReleased:0==t.button&&r.pdfViewer.eventEmitter.emit(de.signatureFieldMouseLButtonUp,r.annot,!1,r.$esignChinaContainer,r,t);break;case vo.AnnotCursorEnter:r.pdfViewer.eventEmitter.emit(de.signatureFieldMouseEnter,r.annot);break;case vo.AnnotCursorExit:r.pdfViewer.eventEmitter.emit(de.signatureFieldMouseExit,r.annot)}return[2]}}))}))()}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t,i)}},{key:"blur",value:function(){var e=this;return setTimeout((function(){e.$esignChinaContainer&&(e.$esignChinaContainer.parent().css({zIndex:""}),e.$esignChinaContainer.hide())}),50),(0,S._)((0,x._)(n.prototype),"blur",this).call(this)}},{key:"focus",value:function(){var e=this;this.hasFocus=!0,setTimeout((function(){e.$handler.addClass("fv__control_focus")}),50);var t=this.annot.getField(),n=this.annot.getAdditionalAction(vo.AnnotReceiveInputFocus);try{n&&this.formRender.execAction("Field",n,null,t)}finally{this.pdfViewer.eventEmitter.emit(de.focusOnControl,this)}}},{key:"handleContextMenu",value:function(e){if(e&&e.contextMenuComponent){var t=this.annot.getField().isSigned(),n=e.contextMenuComponent.$container.$children;t?n.forEach((function(e){return O()(e.element).show()})):n.forEach((function(e){var t=O()(e.element);"fv--contextmenu-item-form-sign"==t.attr("name")?t.show():t.hide()}))}}}],[{key:"getDefaultContextMenuConfig",value:function(){return Xh}},{key:"setContextMenuConfig",value:function(e){Hh=e}},{key:"getContextMenuConfig",value:function(){return Hh}}]),n}(Ho),Qh="normalCaption",ef="rolloverCaption",tf=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){return(0,P._)(this,n),t.call(this,e,i,r,o)}return(0,A._)(n,[{key:"generateUI",value:function(){var e=this.$input=O()("<div></div>"),t=this.annot,n=t.getDefaultAppearance(),i=(0,j.colorConvertor)(n.textColor||4278190080,"#"),r=t.getMKProperty(Qh),o=(0,j.getTransparentOrColor)(t.getMKProperty("fillColor")),a=(0,j.getTransparentOrColor)(this.annot.getMKProperty("borderColor")),s=0===this.annot.getBorderStyle()?"solid":"dashed";e.css({color:i,fontSize:5,"background-color":o,borderWidth:1,borderColor:a,textAlign:"center",borderStyle:s}).html(r),this.$foreground.before(e),e.hide()}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;this.render(e,t)}},{key:"updateUIMore",value:function(e){var t=e.type,i=e.value,r=this.$input;if(!r)return(0,S._)((0,x._)(n.prototype),"updateUIMore",this).call(this,{type:t,value:i});switch(t){case"borderStyle":r.css("border-style",i);break;case"borderColor":i=(0,j.getTransparentOrColor)(i),r.css("border-color",i);break;case"fillColor":r.css("background-color",(0,j.getTransparentOrColor)(i));break;case Qh:r.html(i);break;case"rect":var o=this.updateForgroundAndHandler(this.scale||this.parent("annotsRender").scale,this.rotate);r.css(o)}}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r&&t==this.scale&&i==this.rotate)return Promise.resolve();if(this.scale=t,this.rotate=i,!this.formRender.usingHTML(gn.PushButton))return(0,S._)((0,x._)(n.prototype),"render",this).call(this,t,i,r);this.$input||this.generateUI();var o=this.annot,a=this.updateForgroundAndHandler(t,i);a.borderWidth=4*o.getBorderWidth()/3*t,a.width="100%",a.height="100%",a.lineHeight="100%";var s=o.getDefaultAppearance();return s.textSize?(a.fontSize=4*s.textSize/3*t,this.$input.css(a).show()):setTimeout((function(){e.annot&&e.autoFontSize(e.annot.getMKProperty(Qh)+"pend"),e.$input&&e.$input.css(a).show()}),0),Promise.resolve()}},{key:"handleEvent",value:function(e,t){if(!this.checkReadOnly()){var i;switch(e){case vo.AnnotCursorEnter:0==(i=this.annot.getMKProperty(ef)).length&&(i=this.annot.getMKProperty(Qh));break;case vo.AnnotMouseButtonPressed:0==(i=this.annot.getMKProperty("downCaption")).length&&(i=this.annot.getMKProperty(ef)),0==i.length&&(i=this.annot.getMKProperty(Qh));break;case vo.AnnotMouseButtonReleased:0==(i=this.pdfViewer.getCurrentActivatable()==this?this.annot.getMKProperty(ef):this.annot.getMKProperty(Qh)).length&&(i=this.annot.getMKProperty(Qh));break;case vo.AnnotCursorExit:i=this.annot.getMKProperty(Qh)}this.$input&&this.$input.html(i)}return(0,S._)((0,x._)(n.prototype),"handleEvent",this).call(this,e,t)}}]),n}(Ho),nf="annotComponent",rf={properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n,i){this.data(nf).showPropertiesDialog(e,t,n,i)}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(nf).removeAnnot()},disabled:function(){return this.data(nf).deleteDisabled()}}};function of(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:rf,events:{show:function(){return this.data(nf).updateDeleteStatus(!0),!0},hide:function(){return this.data(nf).updateDeleteStatus(!1),!0}}}}var af,sf=of(".fv__pdf-page-annot-handler-rect"),uf="normalCaption",cf="rolloverCaption",lf=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).generateUI(),a}return(0,A._)(n,[{key:"generateUI",value:function(){var e=this.$input=O()("<div></div>"),t=this.annot,n=t.getDefaultAppearance();if(""==t.getMKProperty("normalCaption").trim()){var i=t.getField();2==i.getType()?i.setMKProperty("normalCaption","4"):i.setMKProperty("normalCaption","l")}var r=(0,j.colorConvertor)(n.textColor||4278190080,"#"),o=t.getMKProperty(uf),a=(0,j.getTransparentOrColor)(t.getMKProperty("fillColor")),s=(0,j.getTransparentOrColor)(this.annot.getMKProperty("borderColor")),u=0===this.annot.getBorderStyle()?"solid":"dashed";e.css({color:r,fontSize:5,"background-color":a,borderWidth:1,borderColor:s,textAlign:"center",borderStyle:u}).html(o),this.$foreground.before(e),e.hide()}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;this.render(e,t)}},{key:"updateUIMore",value:function(e){e.type,e.value;(0,S._)((0,x._)(n.prototype),"render",this).call(this,this.scale,this.rotate,!0)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;this.annot;return this.scale=e,this.rotate=t,this.formRender.usingHTML(gn.PushButton)?Promise.resolve():(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)}},{key:"handleEvent",value:function(e,t){var i;if(!this.checkReadOnly())switch(e){case vo.AnnotCursorEnter:0==(i=this.annot.getMKProperty(cf)).length&&(i=this.annot.getMKProperty(uf));break;case vo.AnnotMouseButtonPressed:0==(i=this.annot.getMKProperty("downCaption")).length&&(i=this.annot.getMKProperty(cf)),0==i.length&&(i=this.annot.getMKProperty(uf));break;case vo.AnnotMouseButtonReleased:0==(i=this.pdfViewer.getCurrentActivatable()==this?this.annot.getMKProperty(cf):this.annot.getMKProperty(uf)).length&&(i=this.annot.getMKProperty(uf));break;case vo.AnnotCursorExit:i=this.annot.getMKProperty(uf)}return(0,S._)((0,x._)(n.prototype),"handleEvent",this).call(this,e,t)}}],[{key:"getDefaultContextMenuConfig",value:function(){return sf}},{key:"setContextMenuConfig",value:function(e){Jh=e}},{key:"getContextMenuConfig",value:function(){return Jh}}]),n}(Ho),df=of(".fv__pdf-page-annot-handler-rect"),hf="normalCaption",ff="rolloverCaption",gf=document.createElement("div"),vf=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).generateUI(),a}return(0,A._)(n,[{key:"generateUI",value:function(){var e=this.$input=O()(gf.cloneNode()),t=this.annot,n=t.getDefaultAppearance();if(""==t.getMKProperty("normalCaption").trim()){var i=t.getField();2==i.getType()?i.setMKProperty("normalCaption","4"):i.setMKProperty("normalCaption","l")}var r=(0,j.colorConvertor)(n&&n.textColor||4278190080,"#"),o=t.getMKProperty(hf),a=(0,j.getTransparentOrColor)(t.getMKProperty("fillColor")),s=(0,j.getTransparentOrColor)(this.annot.getMKProperty("borderColor")),u=0===this.annot.getBorderStyle()?"solid":"dashed";return e.css({color:r,fontSize:5,"background-color":a,borderWidth:1,borderColor:s,textAlign:"center",borderStyle:u}).html(o),e.hide(),this.$foreground.before(e),!0}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;this.render(e,t)}},{key:"updateUIMore",value:function(e){e.type,e.value;(0,S._)((0,x._)(n.prototype),"render",this).call(this,this.scale,this.rotate,!0)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;this.annot;return this.scale=e,this.rotate=t,this.formRender.usingHTML(gn.PushButton)?Promise.resolve():(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)}},{key:"handleEvent",value:function(e,t){var i;if(!this.checkReadOnly())switch(e){case vo.AnnotCursorEnter:0==(i=this.annot.getMKProperty(ff)).length&&(i=this.annot.getMKProperty(hf));break;case vo.AnnotMouseButtonPressed:0==(i=this.annot.getMKProperty("downCaption")).length&&(i=this.annot.getMKProperty(ff)),0==i.length&&(i=this.annot.getMKProperty(hf));break;case vo.AnnotMouseButtonReleased:0==(i=this.pdfViewer.getCurrentActivatable()==this?this.annot.getMKProperty(ff):this.annot.getMKProperty(hf)).length&&(i=this.annot.getMKProperty(hf));break;case vo.AnnotCursorExit:i=this.annot.getMKProperty(hf)}return(0,S._)((0,x._)(n.prototype),"handleEvent",this).call(this,e,t)}}],[{key:"getDefaultContextMenuConfig",value:function(){return df}},{key:"setContextMenuConfig",value:function(e){af=e}},{key:"getContextMenuConfig",value:function(){return af}}]),n}(Ho),pf=g(2565),mf=g.n(pf),yf=g(2911),kf=g.n(yf),bf=g(5617),wf=g.n(bf),_f=g(781),Pf=g.n(_f),Af=g(5115),Sf=g.n(Af),xf=g(5133),Cf=g.n(xf),Df=g(342);function Ef(e,t,n){var i=Rf("8",t,n);e.attr("src",i)}var If={};function Rf(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e+t+i;if(r in If)return If[r];switch(e){default:case"4":n=mf()({fillColor:t});break;case"8":n=kf()({fillColor:t,small:i});break;case"u":n=wf()({fillColor:t});break;case"n":n=Pf()({fillColor:t});break;case"l":n=Sf()({fillColor:t});break;case"H":n=Cf()({fillColor:t})}return n=URL.createObjectURL(new Blob([n],{type:"image/svg+xml"})),If[r]=n}!function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),"canvas"==o.pdfViewer.config.annotRenderingMode.choiceButton?(a=t.call(this,e,i,r,o),(0,J._)((0,w._)(a),"$ui",void 0),(0,J._)((0,w._)(a),"$input",void 0),(0,J._)((0,w._)(a),"$border",void 0),a.generateUI()):(a=t.call(this,e,i,r,o),(0,J._)((0,w._)(a),"$ui",void 0),(0,J._)((0,w._)(a),"$input",void 0),(0,J._)((0,w._)(a),"$border",void 0)),(0,Lr._)(a)}(0,A._)(n,[{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.$input.attr("src",""),this.$input.remove()}},{key:"generateUI",value:function(){var e,t=this.$handler;this.$input?e=this.$input:(e=M("<div class='fv_choice_border'></div><img  class='fv_choice_icon'/>"),this.$foreground.before(e),this.$border=t.find(".fv_choice_border"),this.$input=t.find("img"),(e=this.$input).hide());var n=this.annot.getDefaultAppearance(),i=(0,Df.$j)(n.textColor||4278190080),r=this.annot.getMKProperty("normalCaption");r&&""!=r||(2==this.annot.getField().getType()?(this.annot.setMKProperty("normalCaption","4"),r="4"):(this.annot.setMKProperty("normalCaption","l"),r="l"));var o=Rf(r,i,0);e.attr("src",o);var a,s=this.annot.getMKProperty("fillColor"),u=this.annot.getMKProperty("borderColor");switch(u=0===u?"transparent":(0,Df.$j)(16777215&u,"#"),this.annot.getBorderInfo().style){default:case 0:a="solid";break;case 1:a="dashed"}this.$border.css({"border-color":u,"border-style":a,background:0==s?"transparent":(0,Df.$j)(s,"#")}),this.render(this.annotsRender.pageRender.scale,0)}},{key:"updateUIMore",value:function(e){var t=e.type,n=e.value,i=this.$border,r=this.$input;switch(t){case"value":"Off"==this.annot.getAS()?r.hide():r.show();break;case"borderStyle":i.css("border-style",n);break;case"borderColor":n=0===n?"transparent":(0,Df.$j)(16777215&n,"#"),i.css("border-color",n);break;case"fillColor":i.css("background-color",0===n?"transparent":(0,Df.$j)(16777215&n,"#"));break;case"display":this.render(this.scale,this.rotate,!0);break;case"hidden":n?this.$input.hide():this.$input.show()}}},{key:"updateSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;this.render(e,t)}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;this.scale=e,this.rotate=t;var n=this.annot;if(this.checkInvisible()||n.isEmpty()||n.isDeleted()||n.rectIsEmpty())return this.$handler.hide(),this.$input.hide(),Promise.resolve();var i=this.$input,r=this.updateForgroundAndHandler(e,t);"8"==n.getMKProperty("normalCaption")&&(r.width<20?Ef(this.$input,(0,Df.$j)(this.annot.info.DA.textColor||4278190080),1):Ef(this.$input,(0,Df.$j)(this.annot.info.DA.textColor||4278190080),0));var o=r.width-r.height;n.getField().getType()==gn.RadioButton&&"l"==this.annot.info.normalCaption?(r["border-radius"]="50%",o<0?(r.top+=o/-2,r.height=r.width,r["margin-top"]=o/-2,r["margin-left"]=0):(r.left+=o/2,r.width=r.height,r["margin-top"]=0,r["margin-left"]=o/2),o=0):(r["border-radius"]=0,r["margin-top"]=0,r["margin-left"]=0),r.borderWidth=4*this.annot.getBorderWidth()/3*e,this.$border.css(r),"Off"==this.annot.getAS()?i.hide():i.show();var a=((this.getPDFPage().getRotationAngle()+t-90*this.annot.getRotation())%360+360)%360;return i.css({transform:"rotate(".concat(a,"deg)")}),Promise.resolve()}}])}(Ho);const Tf=function(e,t){var n,i=t.page.doc.getPDFForm();if(!i||i.isEmpty()||!(n=t.getField()))return Ho;switch(n.getType()){case gn.Text:case gn.File:return Mh;case gn.ListBox:return Uh;case gn.ComboBox:return $h;case gn.Sign:return e.config.enableSignature?Zh:To;case gn.PushButton:return"canvas"==e.config.annotRenderingMode.pushButton?tf:Ho;case gn.CheckBox:return vf;case gn.RadioButton:return lf;default:return Ho}};var Ff="annotComponent",Mf={properties:{name:"properties",nameI18nKey:"viewer_:contextmenu.annot.properties",callback:function(e,t,n){this.data(Ff).showPropertiesDialog(e,t,n)}},actions:{name:"actions",nameI18nKey:"viewer_:contextmenu.annot.actions",callback:function(){this.data(Ff).showActionsDialog()},disabled:function(){return this.data(Ff).readOnlyDisabled()}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(Ff).removeAnnot()},disabled:function(){return this.data(Ff).deleteDisabled()}}},Of={properties:Mf.properties,download:{name:"download",nameI18nKey:"viewer_:contextmenu.annot.download",callback:function(){this.data(Ff).download()},disabled:function(){return this.data(Ff).readOnlyDisabled()}},remove:Mf.remove};const Lf={PDF_VIEWER_ALIVE:"PDF-VIEWER-ALIVE",PDF_DOCUMENT_CLOSING:"PDF-DOCUMENT-CLOSING",BROWSER_RELOAD:"BROWSER-RELOAD"};const Nf={OBJECT_URL:"object-url-creation"};g(7539),g(4637);var Vf,Bf,jf,Uf="px",Hf=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Mf,events:{show:function(){return this.data(Ff).updateDeleteStatus(!0),!0},hide:function(){return this.data(Ff).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),Wf=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Of,events:{show:function(){return this.data(Ff).updateDeleteStatus(!0),!0},hide:function(){return this.data(Ff).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),Yf="play",qf="pause",Kf="ended",$f="error",zf=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"_resize",value:function(e,t,i){this.enableUniform=e!=Du&&e!=Eu&&e!=Iu&&e!=Ru,(0,S._)((0,x._)(n.prototype),"_resize",this).call(this,e,t,i)}}]),n}(zu),Gf=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="screen",a.$ui.addClass("fv__pdf-page-screen-annot-container"),a.$handler.addClass("fv__pdf-page-screen-annot-handler-container"),a.isVideoAudio=e.info.isAudioVideo,a.$Dialog=null,j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e={moveable:!0,resizable:!0,enableDiagonally:!0},t=a.pdfViewer.customs.getAnnotComponentConfig((0,w._)(a),Object.keys(e)),n=new zf(Object.assign(e,t,{start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},rotatable:!1,annotRender:o}));return a.processShapeControlPermissionCtrl(n),n.ownsTo(a.disposor),n}));var s=j.Lazy.onInitialized((0,w._)(a),"shapeControl",(function(e){e.ui.addEventListener("click",(function(e){a.isActive&&e.isTrusted&&0===e.button&&!e.shiftKey&&e.ctrlKey&&a.pdfViewer.unActiveElement((0,w._)(a))})),e.ownsTo&&e.ownsTo(a.disposor)}));a.addDestroyHook(s),a.addDestroyHook(a.pdfViewer.getCustomOptionsUpdater().onGetAnnotComponentConfigUpdated((function(){if(j.Lazy.hasProperty((0,w._)(a),"shapeControl")&&j.Lazy.isPropertyIntialized((0,w._)(a),"shapeControl")){var e=a.shapeControl.isActive,t=a.shapeControl;j.Lazy.reset((0,w._)(a),"shapeControl"),e&&a._applyShapeChange(),t.destroy()}}))),j.Lazy.property((0,w._)(a),"contextMenu",(function(){if(a.contextMenuIsEnable())return a.pdfViewer.viewerUI.createContextMenu((0,w._)(a),r,a.getContextMenuConfig())}));var u=a.pdfViewer.i18n,c=Mo().i18n=function(e){return u.t(e)};a.addDestroyHook((function(){Mo().i18n===c&&(Mo().i18n=void 0)}));var l=a.pdfViewer.getAnnotAuthorityManager();a.addDestroyHook(l.subscribe(a.annot,(function(e){a.updateOnPermissionChange(e)})));var d=a.pdfViewer.eventEmitter,h=function(){a.isDestroyed||e.isDestroyed||l.getPermission(e).then((function(e){a.updateOnPermissionChange(e)}))},f=function(e){var t=(0,E._)(e,1)[0];if(t&&t.getId){var n="fv__screen-decorator-".concat(t.getId()),i=a.annotsRender.$ui.find("."+n);i&&i.remove()}};d.on(de.permissionChanged,h),d.on(de.annotationRemoved,f),a.addDestroyHook((function(){d.off(de.permissionChanged,h),d.off(de.annotationRemoved,f)}));var g="fv__screen-decorator-".concat(a.getId());return!(a.iconContainer=a.annotsRender.$ui.find("."+g)).length&&a.isVideoAudio&&(a.annotsRender.genScreenIcon(a.annotsRender.pageRender,a.annot.info),a.iconContainer=a.annotsRender.$ui.find("."+g)),a.render(),a}return(0,A._)(n,[{key:"updateOnPermissionChange",value:function(e){if(!this.isDestroyed){if(this.isMultiMedia()&&this.iconContainer)this.pdfViewer.getPDFDocRender().noInteraction?this.iconContainer.hide():this.iconContainer.show();if(j.Lazy.isPropertyIntialized(this,"shapeControl")){var t=!1;t=!!this.groupMoveDisabled()||(e.ignorable()?this.moveDisabled():!e.isAdjustable());var n=this.shapeControl;t?n.disable():n.enable()}}}},{key:"processShapeControlPermissionCtrl",value:function(e){var t=this;this.pdfViewer.getAnnotAuthorityManager().getPermission(this.annot).then((function(e){t.updateOnPermissionChange(e)}))}},{key:"isMultiMedia",value:function(){return this.isVideoAudio}},{key:"redraw",value:function(e){return this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()!==mn&&this.activeRect(),this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),e&&this.tileCanvas&&this.tileCanvas.clearCache(),this.render()}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;return[Math.ceil(c/r),Math.ceil(u/r),u,c,r,i,e,t,a.left,a.top]}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale;arguments.length>1&&void 0!==arguments[1]||this.rotate;if(this.isMultiMedia()){var t=4*this.annot.getBorderWidth()/3*j.dpr*e;this.iconContainer.css({padding:t})}}},{key:"afterRender",value:function(e){if(e.transformed&&(this.isActive&&(this.activeRect(),this._applyShapeChange()),this.isMultiMedia()&&this.$player&&this.$player.is(":visible"))){var t=this.annot.getDeviceRect(this.scale,this.rotate);this.$player.css({left:t.left+Uf,top:t.top+Uf,width:t.right-t.left+Uf,height:t.bottom-t.top+Uf})}}},{key:"onShapeRotated",value:function(e){e<0&&(e+=360),e<=45||e>315?e=0:e>45&&e<=135?e=270:e>135&&e<=225?e=180:e>225&&e<=315||e>-135&&e<=-45?e=90:console.warn("degree error: "+e);var t=this.annot.getRotation();return(t+=e)>=360&&(t-=360),this.setRotation(t)}},{key:"onStartUpdateShape",value:function(e,t,n){this.editDebouncePromise||(this.editDebouncePromise=new j.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e,t){var n=this;if(this.pdfViewer.config.highPerformance)return this.editDebouncePromise?this.editDebouncePromise.exec((function(){return n.setRect(e)})):Promise.resolve()}},{key:"onShapeMoving",value:function(e,t){var n=this;if(this.pdfViewer.config.highPerformance)return this.editDebouncePromise?this.editDebouncePromise.exec((function(){return n.moveTo(e.left,e.top)})):Promise.resolve()}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editDebouncePromise.exec((function(){return i.setRect(e).then((function(e){"move"==n&&i.pdfViewer.eventEmitter.emit(de.annotationMovedPosition,[i.annot],i.getPDFPage(),i.annot)}))}))}},{key:"activeHandleFuc",value:function(e){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.$handler.addClass("active"),this._applyShapeChange(),e&&this.play(),this.closeConfirmDia()}},{key:"closeConfirmDia",value:function(){this.$Dialog&&(this.$Dialog[0].close(),this.$Dialog.remove())}},{key:"active",value:function(e){var t=this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName(),n=this.annot.info.annotScreenDetailType;["create-multi-media-state","select-annotation","createImage"].includes(t)||n&&"screen_img"===n?this.activeHandleFuc(!1):this.activeHandleFuc(!(e&&"doubletap"===e.type))}},{key:"_applyShapeChange",value:function(){var e=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),e)}},{key:"movedByOther",value:function(){this.isActive&&this._applyShapeChange()}},{key:"getRelevantPlayer",value:function(e,t){var n=this;return(0,_._)((function(){var i,r,o,a,s,u,c,l;return(0,F.Jh)(this,(function(d){switch(d.label){case 0:i=n.pdfViewer.multimediaPlayers,r=!0,o=!1,a=void 0,d.label=1;case 1:d.trys.push([1,6,7,8]),s=i[Symbol.iterator](),d.label=2;case 2:return(r=(u=s.next()).done)?[3,5]:(c=u.value,[4,(new c).isSupport({buffer:t,fileName:e})]);case 3:if(d.sent())return[2,c];d.label=4;case 4:return r=!0,[3,2];case 5:return[3,8];case 6:return l=d.sent(),o=!0,a=l,[3,8];case 7:try{r||null==s.return||s.return()}finally{if(o)throw a}return[7];case 8:return[2,null]}}))}))()}},{key:"play",value:function(){var e=this,t=this.pdfViewer.getPDFDocRender();t&&!t.noInteraction&&this.getAppPermission().then((function(t){e.isPaused()?t.isPlayable()&&e.doAction():e.pause()}))}},{key:"pause",value:function(){this.customPlayer&&this.customPlayer.pause()}},{key:"isPaused",value:function(){return!this.customPlayer||this.customPlayer.isPaused}},{key:"updatePayerRect",value:function(){var e=this.annot.getDeviceRect(this.scale,this.rotate);return this.$player?(this.$player.css({left:e.left+Uf,top:e.top+Uf,width:e.right-e.left+Uf,height:e.bottom-e.top+Uf}),e):e}},{key:"getRendition",value:function(){var e=this;return this.annot.getActionPromise().then((function(t){var n=t.info;if(e.rendition)return e.rendition;if(n&&"TypeRendition"==n.type)for(var i=0;i<n.renditions.length;i++){var r=n.renditions[i];if(r.fileName)return e.rendition=r,r}}))}},{key:"doAction",value:function(){var e=this;this.isMultiMedia()?this.getRendition().then((function(t){if(t){if(!e.$playerContainer){var n=document.createElement("div");n.className="fv__pdf-player",e.$handler.append(n),e.$playerContainer=e.$handler.find(".fv__pdf-player")}return e.$handler.addClass("active"),e.$playerContainer&&e.$playerContainer.show(),e.customPlayer?e.customPlayer.isSupport({buffer:t.buffer,fileName:t.fileName})?void e.customPlayer.play():e.alertUnsupportMsg():e.createCustomPlayer().then((function(t){t&&(e.$rect&&e.$rect.css({left:"-100px",top:"-100px",width:0,height:0}),e.customPlayer.play())}))}e.alertUnsupportMsg()})):this.pdfViewer.actionManager.get(this.annot.action,this).active()}},{key:"createCustomPlayer",value:function(){var e=this;return(0,_._)((function(){var t,n,i,r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:return t=e.rendition,n=t.fileName,i=t.buffer,r=t.contentType,[4,e.getRelevantPlayer(n,i)];case 1:return(o=a.sent())?(e.customPlayer=new o(e.$playerContainer[0],e.annot,e.pdfViewer),[4,e.customPlayer.init({fileName:n,buffer:i,contentType:r})]):(e.alertUnsupportMsg(),[2,!1]);case 2:return a.sent(),e.addDestroyHook(e.customPlayer.on(Yf,(function(t){var n=e.getAnnotComponent(t);n&&(n.parent().parent().$ui.find(".fv__screen-decorator-".concat(t.getId())).find(".icon").removeClass("play pause").addClass("pause"),n.customPlayer&&(n.customPlayer.isPaused=!1))})),e.customPlayer.on(qf,(function(t){var n=e.getAnnotComponent(t);n&&(n.parent().parent().$ui.find(".fv__screen-decorator-".concat(t.getId())).find(".icon").removeClass("play pause").addClass("play"),e.customPlayer.isPaused=!0)})),e.customPlayer.on(Kf,(function(t){var n=e.getAnnotComponent(t);n&&(n.parent().parent().$ui.find(".fv__screen-decorator-".concat(t.getId())).find(".icon").removeClass("play pause").addClass("play"),e.customPlayer.isPaused=!0)})),e.customPlayer.on($f,(function(t){var n=e.getAnnotComponent(t);n&&(n.parent().parent().$ui.find(".fv__screen-decorator-".concat(t.getId())).find(".icon").removeClass("play pause").addClass("pause"),n.customPlayer&&(n.customPlayer.isPaused=!0))}))),[2,!0]}}))}))()}},{key:"getAnnotComponent",value:function(e){var t=e.getPage().getIndex(),n=e.getObjectNumber(),i=this.pdfViewer.getAnnotRender(t,n);return i?i.getComponent():null}},{key:"alertUnsupportMsg",value:function(){this.pdfViewer.viewerUI.alert({message:this.pdfViewer.i18n.t("viewer_:contextmenu.annot.noSptPlayPlsDownload_websdk"),level:"warning",isHTML:!0})}},{key:"getDataFormBlob",value:function(){var e=this.rendition,t=e.buffer,n=e.fileName,i=e.contentType;if(!t.length)return{fileName:n};var r=this.pdfViewer.resourceGenerator(Lf.PDF_DOCUMENT_CLOSING,Nf.OBJECT_URL).expose().URL,o=new Blob([t.buffer],{type:i});return{url:r.createObjectURL(o),blob:o}}},{key:"download",value:function(){var e=this;this.getAppPermission().then((function(t){if(t.isAttachmentDownloadable())return e.isMultiMedia()?e.getRendition().then((function(t){if(t){if(e.customPlayer&&e.customPlayer.download)return e.customPlayer.download();var n=e.getDataFormBlob();if("blob"in n)return Fa(n.blob,t.fileName,n.blob.type)}e.alertUnsupportMsg()})):void 0}))}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceRect(n,i);t.css({left:r.left+Uf,top:r.top+Uf,width:r.right-r.left+Uf,height:r.bottom-r.top+Uf})}},{key:"rectInit",value:function(){var e=this,t=this.$handler,n=O()(this.createRectDom());t.append(n);var i=n[0],r=this.rectHammer=new Hammer.Manager(i,{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});return r.add(new Hammer.Tap({event:"doubletap",taps:2})),r.add(new Hammer.Tap({event:"singletap"})),r.get("doubletap").recognizeWith("singletap"),r.get("singletap").requireFailure("doubletap"),r.on("singletap",(function(t){e.rectSingleTap(t)})),t.on("contextmenu",(function(e){e.preventDefault()})),t.on("mouseup",(function(e){e.stopPropagation()})),n.data(Ff,this),this.addDestroyHook((function(){r.destroy()})),n}},{key:"showContextMenu",value:function(e,t){return!!this.contextMenu&&(this.contextMenu.setCurrentTarget(this),this.contextMenu.showAt(e,t))}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"getContextMenuConfig",value:function(){var e;if(this.isMultiMedia()){if(Bf)return Bf;e=this.constructor.getMultiMediaContextMenuConfig()}else{if(Vf)return Vf;e=this.constructor.getDefaultContextMenuConfig()}for(var t in e)if("items"===t){var n=e[t],i=this.pdfViewer.i18n;for(var r in n){var o=n[r];o.nameI18nKey&&(o.name=i.t(o.nameI18nKey))}}return this.isMultiMedia()?this.constructor.setMultiMediaContextMenuConfig(e):this.constructor.setContextMenuConfig(e),e}},{key:"updateRender",value:function(){return this.updateSize(),Promise.resolve()}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.$handler&&this.$handler.removeClass("active")}},{key:"unActiveMore",value:function(){}},{key:"rectSingleTap",value:function(e){}},{key:"removeAnnot",value:function(){var e=this;return this.getAppPermission().then((function(t){return t.ignorable()&&e.deleteDisabled()?Promise.resolve():t.isDeletable()?e.doRemoveAnnot():void 0})).then((function(t){var n=e.pdfViewer.getCurrentActivatable();return n&&n.remove&&n.remove(e),t}))}},{key:"doRemoveAnnot",value:function(){var e=this,t=this.pdfViewer,n=t.eventEmitter,i=this.annot;return Promise.resolve((t.customs.removeAnnotBefore||j.noop)(this)).then((function(t){if(n.emit(de.removeActionAnnotationBefore,e),!1!==t)return i.getPDFPage().removeAnnot(i).then((function(t){return e.isMultiMedia()&&e.iconContainer&&e.iconContainer.remove(),n.emit(de[t?"removeActionAnnotationSuccess":"removeActionAnnotationFailed"],e,i),t}),(function(){n.emit(de.removeActionAnnotationFailed,e)}))}))}},{key:"removeAnnotRender",value:function(){this.renderDestroy(),this.parent().remove()}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,j.colorConvertor)(e.getBorderColor(),"#");-1==t&&(t=0);var n=e.getBorderWidth(),i=360-e.getRotation();return{color:t,opacity:e.getOpacity(),borderWidth:n,borderStyle:!0,disabled:this.propertyDisabled(),rotation:i,isLocked:this.isLocked()}}},{key:"updateContextMenu",value:function(){var e=this.getContextMenuConfig();this.isMultiMedia()&&(this.isPaused()?delete e.items.pause:delete e.items.play),this.$handler.contextMenu(e)}},{key:"showPropertiesDialog",value:function(){this.$propertiesControl=new uu(this,document.body),this.updateDeleteStatus(!0)}},{key:"hidePropertiesDialog",value:function(){this.$propertiesControl&&this.$propertiesControl.close(),this.updateDeleteStatus(!1)}},{key:"showActionsDialog",value:function(){this.$actionsControl=new rl(this,document.body,this.annot.action),this.updateDeleteStatus(!0)}},{key:"hideActionsDialog",value:function(){this.$actionsControl.close(),this.updateDeleteStatus(!1)}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setColor",value:function(e){var t=this;return this.annot.setBorderColor(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(e){return e?n.updateRender().then((function(){n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n)})):e}))}},{key:"setOpacity",value:function(e){var t=this;return e==this.annot.getOpacity()?Promise.resolve(!0):this.annot.setOpacity(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setRotation",value:function(e){var t=this,n=this.annot.getRotation(),i=Math.abs(e-n);if(0==i)return!0;var r=this.annot.getRect(),o=r.right-r.left,a=r.top-r.bottom;if(90==i||270==i){var s=(o-a)/2;r.left+=s,r.right-=s,r.top+=s,r.bottom-=s}return this.annot.setRect(r).then((function(n){return n?t.annot.setRotation(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e})):n}))}},{key:"renderDestroy",value:function(){this.tileCanvas&&this.tileCanvas.destroy(),this.tileCanvas&&this.$handler.remove()}},{key:"doubleTapAnnot",value:function(){return!1}},{key:"tapAnnot",value:function(e){if(!this.shapeControl.isActive)return this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()===mn?this.play():(0,S._)((0,x._)(n.prototype),"tapAnnot",this).call(this,e)}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),j.Lazy.isPropertyIntialized(this,"contextMenu")&&this.contextMenu&&this.contextMenu.destroy()}}],[{key:"getDefaultContextMenuConfig",value:function(){return Hf}},{key:"getMultiMediaContextMenuConfig",value:function(){return Wf}},{key:"setContextMenuConfig",value:function(e){Vf=e}},{key:"setMultiMediaContextMenuConfig",value:function(e){Bf=e}}]),n}(To),Jf=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),a=t.call(this,e,i,r,o);var s=e.getGroupHeader();return s&&"Replace"===s.getIntent()&&(a.isReplace=!0,a.caretAnnot=s),a}return(0,A._)(n,[{key:"onRightChangeSuccess",value:function(e){if(this.isReplace)return this.caretAnnot.moveRectByCharIndex(e.charIndex)}}]),n}(uc),Xf=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).$ui.addClass("fv__pdf-page-watermark-annot-container"),a}return(0,A._)(n,[{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;return[Math.ceil(c/r),Math.ceil(u/r),u,c,r,i,e,t,a.left,a.top]}},{key:"render",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,r=arguments.length>2?arguments[2]:void 0,o=this.annot;if(this.scale=n,this.rotate=i,o.isEmpty()||o.isDeleted()||o.rectIsEmpty())return this.renderDestroy(),Promise.resolve();var a=this.tileCanvas;if(!o.getBorderWidth())return a&&a.hideContainer(),Promise.resolve();var s=this.getTileConfig(n,i);return a||(a=this.tileCanvas=new fr((function(e,n,i,r,a,s,u,c){return t.getPDFPage().getAnnotBitmap(o.getId(),(0,U.F2)(s),t.rotate,{x:u*s+n*a,y:c*s+e*a,width:i,height:r},!0)}),this.$ui)),a.setVisibleRect(r),a.showContainer(),(e=a).redraw.apply(e,(0,I._)(s))}}]),n}(To),Zf="annotComponent",Qf={play:{name:"play",nameI18nKey:"viewer_:contextmenu.annot.play",callback:function(){this.data(Zf)},disabled:function(){return this.data(Zf).readOnlyDisabled()}},pause:{name:"pause",nameI18nKey:"viewer_:contextmenu.annot.pause",callback:function(){this.data(Zf)},disabled:function(){return this.data(Zf).readOnlyDisabled()}},remove:{name:"delete",nameI18nKey:"viewer_:contextmenu.annot.delete",callback:function(){this.data(Zf).removeAnnot()},disabled:function(){return this.data(Zf).deleteDisabled()}}};function eg(e,t,n){for(var i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))}var tg="px",ng=function(){return{selector:arguments.length>0&&void 0!==arguments[0]?arguments[0]:".fv__pdf-page-annot-handler-rect",items:Qf,events:{show:function(){return this.data(Zf).updateDeleteStatus(!0),!0},hide:function(){return this.data(Zf).updateDeleteStatus(!1),!0}}}}(".fv__pdf-page-annot-handler-rect"),ig=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"_resize",value:function(e,t,i){this.enableUniform=e!=Du&&e!=Eu&&e!=Iu&&e!=Ru,(0,S._)((0,x._)(n.prototype),"_resize",this).call(this,e,t,i)}}]),n}(zu),rg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;(0,P._)(this,n),(a=t.call(this,e,i,r,o)).name="sound",a.$ui.addClass("fv__pdf-page-sound-annot-container"),a.$handler.addClass("fv__pdf-page-sound-annot-handler-container"),e.action&&(a.actionViewer=a.pdfViewer.actionManager.get(e.action,(0,w._)(a))),a.isVideoAudio=e.info.isAudioVideo,a.audioUrl="",a.audioBlobData=null,a.multiMediaFilename="",j.Lazy.property((0,w._)(a),"shapeControl",(function(){var e=new ig({emitter:a.pdfViewer.eventEmitter,start:function(e,t,n){return a.onStartUpdateShape(e,t,n)},update:function(e,t){return a.onShapeUpdating(e,t)},moving:function(e,t,n){return a.onShapeMoving(e,t,n)},end:function(e,t,n){return a.onShapeUpdateEnd(e,t,n)},resizable:!1,enableDiagonally:!0,moveable:!1,rotatable:!1,annotRender:o,enableSizeBox:!a.isMultiMedia()});return a.processShapeControlPermissionCtrl(e),e})),j.Lazy.property((0,w._)(a),"contextMenu",(function(){if(a.contextMenuIsEnable())return a.pdfViewer.viewerUI.createContextMenu((0,w._)(a),r,a.getContextMenuConfig())}));var s=a.pdfViewer.i18n;Mo().i18n=function(e){return s.t(e)};var u=Mo().i18n=function(e){return s.t(e)};return a.addDestroyHook((function(){Mo().i18n===u&&(Mo().i18n=void 0)})),a}return(0,A._)(n,[{key:"isMultiMedia",value:function(){return this.isVideoAudio}},{key:"redraw",value:function(){return this.groupMoveDisabled()||this.moveDisabled()?this.shapeControl&&this.shapeControl.disable():this.shapeControl&&this.shapeControl.enable(),this.render()}},{key:"getTileConfig",value:function(e,t){var n=this.pdfViewer,i=n.getSmartScale(e),r=n.config.tileSize,o=this.annot,a=o.getDeviceRect(1,t),s=o.getDeviceRect(i,t),u=s.right-s.left,c=s.bottom-s.top;return[Math.ceil(c/r),Math.ceil(u/r),u,c,r,i,e,t,a.left,a.top]}},{key:"swapLowHighBit",value:function(e){for(var t=new Int8Array(e).length,n=new DataView(e),i=new Int8Array(t),r=0;r<t;r+=2)i[r]=r+1==t?0:n.getInt8(r+1),i[r+1]=n.getInt8(r);return i}},{key:"getMultiMediaUrl",value:function(){var e=this.annot;if(!this.audioBlobData){var t=e.info.soundObj,n=t.data;this.multiMediaFilename=e.info.title;var i=t.sampleRate,r=t.sampleBits,o=t.channel,a=this.swapLowHighBit(n),s=(a.length,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=new ArrayBuffer(44+e.length),o=new DataView(r);return eg(o,0,"RIFF"),o.setUint32(4,36+e.length,!0),eg(o,8,"WAVE"),eg(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,t,!0),o.setUint32(24,n,!0),o.setUint32(28,n*t,!0),o.setUint16(32,t,!0),o.setUint16(34,i,!0),eg(o,36,"data"),o.setUint32(40,e.length,!0),function(e,t,n){for(var i=0;i<n.length;i++,t++){var r=n[i];e.setInt8(t,r)}}(o,44,e),o}(a,o,i,r)),u=new Blob([new Int8Array(s.buffer)],{type:"audio/wav"});this.audioBlobData=u}var c=this.pdfViewer.resourceGenerator(Lf.PDF_DOCUMENT_CLOSING,Nf.OBJECT_URL).expose().URL;return this.audioUrl=c.createObjectURL(this.audioBlobData,{type:"audio/wav"}),this.audioUrl}},{key:"render",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate;return(0,S._)((0,x._)(n.prototype),"render",this).call(this,e,t)}},{key:"afterRender",value:function(e){if(e.transformed){if(this.isActive){this.activeRect();var t=this._getShapeControllerBoundaryBox();this.shapeControl.active(this.$handler,this.getBoundary(),t)}if(this.isMultiMedia()&&this.$player&&this.$player.is(":visible")){var n=this.annot.getDeviceRect(this.scale,this.rotate);this.$player.css({left:n.left+tg,top:n.top+tg,width:n.right-n.left+tg,height:n.bottom-n.top+tg})}}}},{key:"activeRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.annot,t=this.$rect=this.$rect||this.rectInit(),n=this.scale,i=this.rotate,r=e.getDeviceRect(n,i);t.css({left:r.left+tg,top:r.top+tg,width:r.right-r.left+tg,height:r.bottom-r.top+tg})}},{key:"rectInit",value:function(){var e=this,t=this.$handler,n=O()(this.createRectDom());t.append(n);var i=n[0],r=this.rectHammer=new Hammer.Manager(i,{recognizers:[[Hammer.Pan,{direction:Hammer.DIRECTION_ALL}]]});return r.add(new Hammer.Tap({event:"doubletap",taps:2})),r.add(new Hammer.Tap({event:"singletap"})),r.get("doubletap").recognizeWith("singletap"),r.get("singletap").requireFailure("doubletap"),r.on("doubletap",(function(t){!1!==e.onDoubleTap(t)&&e.rectDoubleTap()})),this.contextMenuIsEnable()&&n.data(Zf,this),this.addDestroyHook((function(){r.destroy()})),n}},{key:"getContextMenuConfig",value:function(){if(jf)return jf;var e=this.constructor.getDefaultContextMenuConfig();for(var t in e)if("items"===t){var n=e[t],i=this.pdfViewer.i18n;for(var r in n){var o=n[r];o.nameI18nKey&&(o.name=i.t(o.nameI18nKey))}}return this.constructor.setContextMenuConfig(e),e}},{key:"onShapeRotated",value:function(e){e<0&&(e+=360),e<=45||e>315?e=0:e>45&&e<=135?e=270:e>135&&e<=225?e=180:e>225&&e<=315||e>-135&&e<=-45?e=90:console.warn("degree error: "+e);var t=this.annot.getRotation();return(t+=e)>=360&&(t-=360),this.setRotation(t)}},{key:"onStartUpdateShape",value:function(e,t,n){this.editDebouncePromise||(this.editDebouncePromise=new j.DebounceAsyncTaskExecutor(0))}},{key:"onShapeUpdating",value:function(e,t){var n=this;this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return n.setRect(e)}))}},{key:"onShapeMoving",value:function(e,t){var n=this;this.pdfViewer.config.highPerformance&&this.editDebouncePromise&&this.editDebouncePromise.exec((function(){return n.moveTo(e.left,e.top).then((function(e){n.setMargin()}))}))}},{key:"onShapeUpdateEnd",value:function(e,t,n){var i=this;return this.editDebouncePromise?this.editDebouncePromise.exec((function(){return i.moveTo(e.left,e.top,n,!1).then((function(t){return i.setRect(e)})).then((function(e){i.setMargin()}))})):Promise.resolve()}},{key:"setMargin",value:function(){var e=this.getGroupRect(),t=this.getRect();this.shapeControl.setMargin(Ra.expandOffset(t,e))}},{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.activeRect(),this.$handler.addClass("active")}},{key:"play",value:function(){var e=this;this.getAppPermission().then((function(t){e.isPaused()?t.isPlayable()&&e.doAction():e.pause()}))}},{key:"pause",value:function(){this.player&&this.player.pause()}},{key:"isPaused",value:function(){return!this.player||this.player.paused}},{key:"doAction",value:function(){var e=this;if(this.isMultiMedia()){var t=this.getMultiMediaUrl();if(!t)return;if(this.$handler.addClass("active"),this.$player)this.$player.show();else{if(j.isIE&&!j.isEdge){return this.pdfViewer.viewerUI.alert({message:this.pdfViewer.i18n.t("viewer_:contextmenu.annot.noSptPlayPlsDownload_websdk"),level:"warning",isHTML:!0}),!1}this.$handler.append('<div class="fv__pdf-player fv__hide" style="position:absolute;" ><audio style="width: 200px" src="'+t+'" poster="#" width="100px" height="100%" controls="controls" controlsList="nodownload">Your browser does not support the video tag.</audio><button><i class="fv__close-video"></i></button></div>'),this.$player=this.$handler.find(".fv__pdf-player"),this.player=this.$handler[0].querySelector(".fv__pdf-player audio"),(j.isIE||j.isEdge)&&this.player.addClass("IE-player"),(j.isMobile||j.isTablet)&&this.player.removeAttribute("controls"),this.$handler[0].querySelector(".fv__close-video").addEventListener("click",(function(t){URL.revokeObjectURL(e.audioUrl),e.player&&e.player.pause&&e.player.pause(),e.$player.hide()}))}var n=this.annot.getDeviceRect(this.scale,this.rotate);if(this.$player.css({left:n.left+tg,top:n.top+tg,width:n.right-n.left+tg,height:n.bottom-n.top+tg}),this.$rect&&this.$rect.css({left:"-100px",top:"-100px",width:0,height:0}),!this.player)return;this.player.paused?this.player.play&&this.player.play():this.player.pause&&this.player.pause()}else this.actionViewer&&this.actionViewer.active()}},{key:"download",value:function(){var e=this;this.getAppPermission().then((function(t){if(t.isAttachmentDownloadable()){var n=e.audioBlobData;j.isIE&&!j.isEdge&&(e.multiMediaFilename=e.multiMediaFilename+".wav"),Fa(n,e.multiMediaFilename,{type:"audio/wav"})}}))}},{key:"addAction",value:function(e){this.actionViewer=this.pdfViewer.actionManager.get(e,this)}},{key:"showContextMenu",value:function(e,t){return!!this.contextMenu&&(this.contextMenu.setCurrentTarget(this),this.contextMenu.showAt(e,t))}},{key:"createRectDom",value:function(){return this.shapeControl.ui.classList.add("fv__pdf-page-annot-handler-rect"),this.shapeControl.ui}},{key:"_getShapeControllerBoundaryBox",value:function(){var e=this.getPDFPage(),t=(0,E._)((0,U.ke)(e.getPxWidth(),e.getPxHeight(),this.scale,this.rotate),2);return{left:0,top:0,right:t[0],bottom:t[1]}}},{key:"updateRender",value:function(){return Promise.resolve()}},{key:"unActive",value:function(){(0,S._)((0,x._)(n.prototype),"unActive",this).call(this),this.$handler.removeClass("active")}},{key:"removeAnnot",value:function(){var e=this;return this.getAppPermission().then((function(t){return t.ignorable()&&("function"==typeof e.deleteDisabled&&e.deleteDisabled()||!e.deleteDisabled)?Promise.resolve():t.isDeletable()?e.doRemoveAnnot():void 0})).then((function(t){var n=e.pdfViewer.getCurrentActivatable();return n&&n.remove&&n.remove(e),t}))}},{key:"doRemoveAnnot",value:function(){var e=this,t=this.pdfViewer,n=t.eventEmitter,i=this.annot;return Promise.resolve((t.customs.removeAnnotBefore||j.noop)(this)).then((function(t){if(n.emit(de.removeActionAnnotationBefore,e),!1!==t)return i.getPDFPage().removeAnnot(i).then((function(t){if(t)return n.emit(de.removeActionAnnotationSuccess,e,i);n.emit(de.removeActionAnnotationFailed,e)}),(function(){n.emit(de.removeActionAnnotationFailed,e)}))}))}},{key:"removeAnnotRender",value:function(){this.renderDestroy(),this.parent().remove()}},{key:"removeAction",value:function(){this.actionViewer=null}},{key:"getPropertyOptions",value:function(){var e=this.annot,t=(0,j.colorConvertor)(e.getBorderColor(),"#");-1==t&&(t=0);var n=e.getBorderWidth(),i=e.getBorderStyle();return{color:t,opacity:e.getOpacity(),borderWidth:n,borderStyle:i,disabled:this.propertyDisabled(),isLocked:this.isLocked()}}},{key:"updateContextMenu",value:function(){var e=this.getContextMenuConfig();this.isMultiMedia()&&(this.player.paused?delete e.items.pause:delete e.items.play),this.$handler.contextMenu(e)}},{key:"showPropertiesDialog",value:function(){this.$propertiesControl=new uu(this,document.body),this.updateDeleteStatus(!0)}},{key:"hidePropertiesDialog",value:function(){this.$propertiesControl&&this.$propertiesControl.close(),this.updateDeleteStatus(!1)}},{key:"showActionsDialog",value:function(){this.$actionsControl=new rl(this,document.body,this.annot.action),this.updateDeleteStatus(!0)}},{key:"hideActionsDialog",value:function(){this.$actionsControl.close(),this.updateDeleteStatus(!1)}},{key:"setBorderWidth",value:function(e){var t=this;return this.annot.setBorderWidth(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setColor",value:function(e){var t=this;return this.annot.setBorderColor(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setBorderStyle",value:function(e,t){var n=this;return this.annot.setBorderStyle(e,t).then((function(e){return e?n.updateRender().then((function(){n.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,n)})):e}))}},{key:"setOpacity",value:function(e){var t=this;return e==this.annot.getOpacity()?Promise.resolve(!0):this.annot.setOpacity(e).then((function(e){return e?t.updateRender().then((function(){return t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e}))}},{key:"setRotation",value:function(e){var t=this,n=this.annot.getRotation(),i=Math.abs(e-n);if(0==i)return!0;var r=this.annot.getRect(),o=r.right-r.left,a=r.top-r.bottom;if(90==i||270==i){var s=(o-a)/2;r.left+=s,r.right-=s,r.top+=s,r.bottom-=s}return this.annot.setRect(r).then((function(n){return n?t.annot.setRotation(e).then((function(e){return e?t.updateRender().then((function(){return t.active(),t.pdfViewer.eventEmitter.emit(de.updateActionAnnotation,t),e})):e})):n}))}},{key:"renderDestroy",value:function(){this.tileCanvas&&this.tileCanvas.destroy(),this.tileCanvas&&this.$handler.remove()}},{key:"doubleTapAnnot",value:function(){return!1}},{key:"tapAnnot",value:function(e){if(!this.shapeControl.isActive)return this.pdfViewer.getStateHandlerManager().getCurrentStates().getStateName()===mn?this.play():(0,S._)((0,x._)(n.prototype),"tapAnnot",this).call(this,e)}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),j.Lazy.isPropertyIntialized(this,"contextMenu")&&this.contextMenu&&this.contextMenu.destroy()}}],[{key:"getDefaultContextMenuConfig",value:function(){return ng}},{key:"setContextMenuConfig",value:function(e){jf=e}}]),n}(ku),og=function(){function e(){(0,P._)(this,e),this._queue=[]}return(0,A._)(e,[{key:"start",value:function(e){return this._queue.push(e),this._execIng&&this._execIng.end(),this._exec(),e.promise}},{key:"_exec",value:function(){var e=this;if(!this._execIng){var t=this._queue,n=t.pop();n?(this._execIng=n,t.forEach((function(e){e.end()})),this._queue=[],n.start().finally((function(){e._execIng=!1,e._exec()}))):this._execIng=!1}}},{key:"end",value:function(){var e=this._queue;return this._queue=[],Promise.all(e.map((function(e){return e.end()})).concat(this._execIng?[this._execIng.end()]:[]))}}]),e}();const ag=og;g(6537);var sg=function(){},ug=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,e,i,r,o)).$ui.addClass("fv__pdf-page-3d-annot-container"),a.$handler.addClass("fv__pdf-page-3d-annot-handler-container"),a.render3DPopSerialPromises=new ag,a.provider=a.pdfViewer.getIoC().getInstanceByClass(lg),a.provider.registerWorkflow(),a}return(0,A._)(n,[{key:"agreeActive3D",value:function(){return cg("agreeActive3D",this)}},{key:"active3DHandle",value:function(e){if(this.pdfViewer.isLoad3DModuleEnabled()){var t=this.loading();return cg("active3DHandle",this,e).finally(t)}}},{key:"render3D",value:function(e){return cg("render3D",this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.disable3DHandle()}},{key:"disable3DHandle",value:function(){return this.render3DPopSerialPromises&&this.render3DPopSerialPromises.end().catch(sg),this.isActived3DHandleLoaded&&cg("destroy3DInteraction",this)}},{key:"doubleTapAnnot",value:function(e){}},{key:"showToolbar",value:function(){}},{key:"hideToolbar",value:function(){}},{key:"setAnnot3DTool",value:function(e){return this.setAnnot3DToolApi(e)}},{key:"setAnnot3DToolApi",value:function(e){return cg("setAnnot3DTool",this,e)}},{key:"loading",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$handler.get(0);return this.pdfViewer.viewerUI.loading(e)}},{key:"setDefaultView",value:function(){return cg("setDefaultView",this)}}]),n}(To);function cg(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return Promise.resolve().then(g.bind(g,6537)).then((function(t){return t[e]}))}(e).then((function(e){return e.apply(void 0,(0,I._)(n))}))}var lg=function(){function e(){var t=this;(0,P._)(this,e),this.pdfDocArray=[],this.workflow=function(e){t[e.type]&&t[e.type](e.msg)}}return(0,A._)(e,[{key:"allInjected",value:function(){var e=this;this.pdfViewer.addEventListener(de.willCloseDocument,(function(){e.unregisterWorkflow()}))}},{key:"registerWorkflow",value:function(){var e=this.pdfViewer.getCurrentPDFDoc();-1===this.pdfDocArray.indexOf(e)&&(this.pdfDocArray.push(e),e.api.registerWorkflow("3D",this.workflow))}},{key:"unregisterWorkflow",value:function(){var e=this.pdfViewer.getCurrentPDFDoc();-1!==this.pdfDocArray.indexOf(e)&&(this.pdfDocArray=this.pdfDocArray.filter((function(t){return t!==e})),e.api.unregisterWorkflow("3D",this.workflow))}},{key:"notifyModelImportFailure",value:function(e){0===e.failReason?this.pdfViewer.viewerUI.alert("3d.failReason.otherUnspecifiedError"):1===e.failReason?this.pdfViewer.viewerUI.alert("3d.failReason.complexityLimitExceeded"):2===e.failReason&&this.pdfViewer.viewerUI.alert("3d.failReason.modelNotSupported")}}],[{key:"inject",value:function(){return{pdfViewer:RP}}}]),e}();const dg=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.matchRules=[]}return(0,A._)(e,[{key:"registerMatchRule",value:function(e){return this.matchRules.push(e),e}},{key:"unRegisterMatchRule",value:function(e){var t=this.matchRules.indexOf(e);-1!==t&&this.matchRules.splice(t,1)}},{key:"get",value:function(e){for(var t,n=this.matchRules,i=this.getDefault(e),r=0,o=n.length;r<o;r++){var a=n[r];if("function"==typeof a){var s=a(e,i);s&&(t=s,i=s)}}return t||i}},{key:"getDefault",value:function(e){switch(e.getType()){case"highlight":return ac;case"squiggly":return hc;case"strikeout":return e.getIntent()===ke.STRIKEOUT_TEXTEDIT?Jf:uc;case"underline":return lc;case"line":return e.getIntent()===ke.LINE_DIMENSION?Fc:Tc;case"polyline":return Hc;case"fileattachment":return vd;case"text":return hd;case"circle":return vl;case"caret":return md;case"freetext":switch(e.getIntent()){case ke.FREETEXT_TYPEWRITER:return Kd;case ke.FREETEXT_CALLOUT:return ch;default:return dh}case"ink":return Pd;case"polygon":switch(e.getIntent()){case ke.POLYGON_CLOUD:return Od;case ke.POLYGON_DIMENSION:default:return Qc}case"square":return kd;case"sound":return rg;case"stamp":return wd;case"link":return dl;case"widget":return Tf(this.pdfViewer,e);case"screen":return Gf;case"redact":return Fd;case"watermark":return Xf;case"3d":return ug;default:return To}}},{key:"getAnnotFlag",value:function(e){var t=new mo(e.getFlags());return this.getAnnotFlag_&&t.or(this.getAnnotFlag_(e)),t}},{key:"setViewerAnnotFlag",value:function(e){this.getAnnotFlag_=e,this.pdfViewer.eventEmitter.emit(de.globalAnnotFlagChanged)}}]),e}();var hg,fg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).action=e,r.annot=i,r.pdfViewer=i.pdfViewer,r.initSubAction(),r}return(0,A._)(n,[{key:"active",value:function(){this.subAction.forEach((function(e){e.active()}))}},{key:"setSourceTarget",value:function(e,t){var n=this;this.source=e,this.target=t,this.action&&this.subAction.forEach((function(e){e.setSourceTarget(n.source,n.target)}))}},{key:"initSubAction",value:function(){var e=this;this.subAction=[],this.action&&this.action.subAction.forEach((function(t){e.subAction.push(e.pdfViewer.actionManager.get(t,e.annot))}))}},{key:"updateAction",value:function(e){this.action=e,this.initSubAction()}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.action=null,this.subAction.length=0,this.source=null,this.target=null}}]),n}(j.Disposable),gg=2147483647,vg=36,pg=/^xn--/,mg=/[^\0-\x7F]/,yg=/[\x2E\u3002\uFF0E\uFF61]/g,kg={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},bg=Math.floor,wg=String.fromCharCode;function _g(e){throw new RangeError(kg[e])}function Pg(e,t){var n=e.split("@"),i="";n.length>1&&(i=n[0]+"@",e=n[1]);var r=function(e,t){for(var n=[],i=e.length;i--;)n[i]=t(e[i]);return n}((e=e.replace(yg,".")).split("."),t).join(".");return i+r}function Ag(e){for(var t=[],n=0,i=e.length;n<i;){var r=e.charCodeAt(n++);if(r>=55296&&r<=56319&&n<i){var o=e.charCodeAt(n++);56320==(64512&o)?t.push(((1023&r)<<10)+(1023&o)+65536):(t.push(r),n--)}else t.push(r)}return t}var Sg=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},xg=function(e,t,n){var i=0;for(e=n?bg(e/700):e>>1,e+=bg(e/t);e>455;i+=vg)e=bg(e/35);return bg(i+36*e/(e+38))},Cg=function(e){var t,n,i=[],r=e.length,o=0,a=128,s=72,u=e.lastIndexOf("-");u<0&&(u=0);for(var c=0;c<u;++c)e.charCodeAt(c)>=128&&_g("not-basic"),i.push(e.charCodeAt(c));for(var l=u>0?u+1:0;l<r;){for(var d=o,h=1,f=vg;;f+=vg){l>=r&&_g("invalid-input");var g=(n=e.charCodeAt(l++))>=48&&n<58?n-48+26:n>=65&&n<91?n-65:n>=97&&n<123?n-97:vg;g>=vg&&_g("invalid-input"),g>bg((gg-o)/h)&&_g("overflow"),o+=g*h;var v=f<=s?1:f>=s+26?26:f-s;if(g<v)break;var p=vg-v;h>bg(gg/p)&&_g("overflow"),h*=p}var m=i.length+1;s=xg(o-d,m,0==d),bg(o/m)>gg-a&&_g("overflow"),a+=bg(o/m),o%=m,i.splice(o++,0,a)}return(t=String).fromCodePoint.apply(t,(0,I._)(i))},Dg=function(e){var t=[],n=(e=Ag(e)).length,i=128,r=0,o=72,a=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var d=c.value;d<128&&t.push(wg(d))}}catch(e){s=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}var h=t.length,f=h;for(h&&t.push("-");f<n;){var g=gg,v=!0,p=!1,m=void 0;try{for(var y,k=e[Symbol.iterator]();!(v=(y=k.next()).done);v=!0){var b=y.value;b>=i&&b<g&&(g=b)}}catch(e){p=!0,m=e}finally{try{v||null==k.return||k.return()}finally{if(p)throw m}}var w=f+1;g-i>bg((gg-r)/w)&&_g("overflow"),r+=(g-i)*w,i=g;var _=!0,P=!1,A=void 0;try{for(var S,x=e[Symbol.iterator]();!(_=(S=x.next()).done);_=!0){var C=S.value;if(C<i&&++r>gg&&_g("overflow"),C===i){for(var D=r,E=vg;;E+=vg){var I=E<=o?1:E>=o+26?26:E-o;if(D<I)break;var R=D-I,T=vg-I;t.push(wg(Sg(I+R%T,0))),D=bg(R/T)}t.push(wg(Sg(D,0))),o=xg(r,w,f===h),r=0,++f}}}catch(e){P=!0,A=e}finally{try{_||null==x.return||x.return()}finally{if(P)throw A}}++r,++i}return t.join("")};const Eg={version:"2.3.1",ucs2:{decode:Ag,encode:function(e){return(hg=String).fromCodePoint.apply(hg,(0,I._)(e))}},decode:Cg,encode:Dg,toASCII:function(e){return Pg(e,(function(e){return mg.test(e)?"xn--"+Dg(e):e}))},toUnicode:function(e){return Pg(e,(function(e){return pg.test(e)?Cg(e.slice(4).toLowerCase()):e}))}};var Ig=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"active",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qi,i=this.annot.pdfViewer,r=i.customs;Promise.resolve((r.URIActionCallback||qi)(this.getURI())).then((function(n){if(!1!==n){var r=e.getURI(),o=!1;if(/\w*:\/\/[\s\S]*/.test(r)){if("file"===r.match(/(\w*):\/+[\s\S]*/)[0])return}else(o=r.toLowerCase().startsWith("mailto:"))||(r="http://"+r);if(i.getSafeReadingMode()){var a=r.lastIndexOf("@"),s=r;if(-1!=a&&!o){s=r.substr(a+1);var u=r.indexOf("//");-1!=u&&(s=r.substr(0,u+2)+s)}var c=i.i18n.t("viewer_:pdfjs.launchURLHint");return i.viewerUI.confirm(c+"\n"+Eg.toASCII(s)).then((function(){window.open(r),t(!0)}),(function(){return t(!1)}))}window.open(r)}})),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"getURI",value:function(){return this.action.getURI()}},{key:"setURI",value:function(e){return this.action.setURI(e)}}]),n}(fg),Rg=function(){function e(t){(0,P._)(this,e),this.fileSpec=t}return(0,A._)(e,[{key:"getChecksum",value:function(){return this.fileSpec.getChecksum()}},{key:"getCreationDateTime",value:function(){return this.fileSpec.getCreationDateTime()}},{key:"getDescription",value:function(){return this.fileSpec.getDescription()}},{key:"getDict",value:function(){return this.fileSpec.dict}},{key:"getFileData",value:function(){return this.fileSpec.fileData}},{key:"getFileName",value:function(){return this.fileSpec.getFileName()}},{key:"getFileSize",value:function(){return this.fileSpec.fileSize}},{key:"getModifiedDateTime",value:function(){return this.fileSpec.modifiedDateTime}},{key:"getSubtype",value:function(){return this.fileSpec.subtype}},{key:"isEmbedded",value:function(){return this.fileSpec.isEmbedded}}]),e}(),Tg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).fileSpec=r.getFileSpec()&&new Rg(r.getFileSpec())||null,r}return(0,A._)(n,[{key:"active",value:function(){this.annot.pdfViewer.customs;var e=this.annot.pdfViewer.i18n.t("ui_:dialog.actionDialog.selectAction.file"),t=this.annot.pdfViewer.i18n.t("alert.browserRestriction-actionTriggered-websdk");this.annot.pdfViewer.viewerUI.alert({message:'"'.concat(e,'" ').concat(t),level:"warning"}),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"getFileSpec",value:function(){return this.action.getFileSpec()}}]),n}(fg),Fg={HandMenuItem:"[icon-class=fv__icon-toolbar-hand]",FirstPage:"[icon-class=fv__icon-float-bar-first-page]",PrevPage:"[icon-class=fv__icon-float-bar-previous-page]",NextPage:"[icon-class=fv__icon-float-bar-next-page]",LastPage:"[icon-class=fv__icon-float-bar-last-page]",PrevView:"[icon-class=fv__icon-float-bar-previous-view]",NextView:"[icon-class=fv__icon-float-bar-next-view]",ZoomViewIn:"[icon-class=fv__icon-float-bar-zoom-in]",ZoomViewOut:"[icon-class=fv__icon-float-bar-zoom-out]",ActualSize:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(7)",FitPage:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(1)",FitVisible:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(3)",FitWidth:".float-bar .fv__ui-editable_zoom_dropdown .fv__ui-dropdown-list li:nth-child(2)",SinglePage:"[icon-class=fv__icon-toolbar-single-page]",OneColumn:"[icon-class=fv__icon-toolbar-continuous-page]",TwoPages:"[icon-class=fv__icon-toolbar-double-page]",TwoColumns:"[icon-class=fv__icon-toolbar-facing-continuous-page]",GeneralInfo:"[icon-class=fv__icon-properties]",GeneralPrefs:"[icon-class=fv__icon-toolbar-preferences]",AddFileAttachment:"[icon-class=fv__icon-toolbar-doc-attachment]",ExtractPages:"[icon-class=fv__icon-toolbar-extract-pages]",ReplacePages:"[icon-class=fv__icon-toolbar-replace-pages]",DeletePages:"[icon-class=fv__icon-toolbar-delete-pages]",CropPages:"[icon-class=fv__icon-toolbar-crop-pages]",RotatePages:"[icon-class=fv__icon-toolbar-rotate-multiple]","Annots:Tool:InkMenuItem":"[icon-class=fv__icon-toolbar-pencil]",SaveAs:"[icon-class=fv__icon-toolbar-download]",FullScreen:"[icon-class=fv__icon-float-bar-full-screen]"},Mg={ShowHideBookmarks:1,ShowHideThumbnailss:2,ShowHideAnnotManager:3,ShowHideOptCont:4,ShowHideFileAttachment:5},Og={GoToPage:".fv__ui-grouplist-item [name=gotopage-input]",ZoomViewTo:'[name="editable-zoom-dropdown"] .fv__ui-dropdown-editor'},Lg={Find:function(){var e=O()("[name=fv--search-choose-type-advanced]"),t=O()("[name=fv--search-bar-type-list-button]");if(e.length)e[0].click();else{var n=document.createElement("style");n.innerHTML='[component-name="fv--search-choose-search-type"] { opacity: 0; }',document.head.appendChild(n),t.length&&t[0].click(),setTimeout((function(){document.head.removeChild(n),(e=O()("[name=fv--search-choose-type-advanced]")).length&&e[0].click()}),0)}},Print:function(){var e=this,t=setInterval((function(){O()(".custom-bar-box .W_PRINT").length&&(clearInterval(t),e.pdfViewer.viewerUI.rootComponent.pdfUI.getComponentByName("print-button").then((function(e){e.controller.handle()})))}),100)}};function Ng(e){if(Fg[e]){var t=O()(Fg[e]);if(t.hasClass("active")||t.hasClass("disabled"))return;var n=t[0];setTimeout((function(){n&&n.click()}),200)}Og[e]&&O()(Og[e]).each((function(){O()(this).hasClass("disabled")||O()(this)[0].focus()}));if(Mg[e]){var i=O()(".fv__ui-sidebar-nav a").eq(Mg[e]-1);if(i.hasClass("active"))return;var r=i[0];r&&r.click()}Lg[e]&&(0,D._)(Lg[e],Function)&&Lg[e].apply(this,[])}var Vg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer.customs;Promise.resolve((t.namedActionCallback||qi)(this.getName())).then((function(t){!1!==t&&Ng.apply(e,[e.getName()])})),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"setActionData",value:function(e){return this.action.setActionData(e)}},{key:"getName",value:function(){return this.action.getName()}}]),n}(fg);const Bg=["exportToXFDF","exportAsFDF","activeDocs","persistentData","curDoc","execMenuItem","mailMsg","browseForDoc","newDoc","newConnection","csFuntionName","importAnFDF","importAnXFDF","removeDataObject","removeTemplate","importDataObject","importTextData","mailForm","print","saveAs","mailDoc","createDataObject","createIcon","createTemplate","getPageNthWord","extractPages","exportDataObject","newPage","insertPages","replacePages","addWatermarkFromFile","fileSelect","setLock","signatureSetSeedValue","signatureSign","query","addIndex","removeIndex","appearances","digitalIDs","isLoggedIn","loginName","loginPath","name","uiName","signAuthor","signVisible","signInvisible","signValidate","login","logout","newUser","getHandler","importFromFile"];var jg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).$Dialog=null,r.JsMap=Bg,r}return(0,A._)(n,[{key:"activeHandleFuc",value:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.annot.pdfViewer.JSEngine,o=this.annot.pdfViewer.customs;return r.getEnableJS()?i?Promise.resolve((o.javascriptActionCallback||qi)(this.getScript())).then((function(n){if(!1!==n){r.initEvent(t.getType(),t.source,t.target,t.name);var i=t.getScript();e=r.exec(i)}})):!1!==(e=(o.javascriptActionCallback||qi)(this.getScript()))&&(r.initEvent(this.getType(),this.source,this.target,this.name,this.param),e=r.exec(this.getScript())):((o.javascriptDisabledActionCallback||qi)(),e={rc:!0}),(0,S._)((0,x._)(n.prototype),"active",this).call(this),this.closeConfirmDia(),e}},{key:"closeConfirmDia",value:function(){this.$Dialog&&(this.$Dialog[0].close(),this.$Dialog.remove())}},{key:"active",value:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.annot.pdfViewer.JSEngine,o=this.annot.pdfViewer.customs;return r.getEnableJS()?i?Promise.resolve((o.javascriptActionCallback||qi)(this.getScript())).then((function(n){if(!1!==n){r.initEvent(t.getType(),t.source,t.target,t.name);var i=t.getScript();e=r.exec(i)}})):!1!==(e=(o.javascriptActionCallback||qi)(this.getScript()))&&(r.initEvent(this.getType(),this.source,this.target,this.name,this.param),e=r.exec(this.getScript())):((o.javascriptDisabledActionCallback||qi)(),e={rc:!0}),(0,S._)((0,x._)(n.prototype),"active",this).call(this),e}},{key:"setTypeName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.type=e,this.name=t}},{key:"getType",value:function(){return this.type}},{key:"executeScript",value:function(){var e=this.annot.pdfViewer.JSEngine,t=this.getScript();if("string"==typeof t&&t.trim().length>0)return e.exec(t)}},{key:"getScript",value:function(){return this.action.getScript()}},{key:"setScript",value:function(e){return this.action.setScript(e)}},{key:"setParam",value:function(e){this.param=e}}]),n}(fg),Ug=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"active",value:function(){var e=this,t=function(){var t=e.getURL();if(!!t&&["mailto:","ftp","file://"].some((function(e){return t.startsWith(e)}))){var n=e.annot.pdfViewer.i18n.t("ui_:dialog.actionDialog.selectAction.submit"),i=e.annot.pdfViewer.i18n.t("alert.browserRestriction-actionTriggered-websdk");return e.annot.pdfViewer.viewerUI.alert({message:'"'.concat(n,'" ').concat(i),level:"warning"}),Promise.resolve()}if(e.annot.pdfViewer.getSafeReadingMode()){var r=e.pdfViewer.i18n.t("viewer_:pdfjs.safeModeSubmit",{URL:e.getURL(),interpolation:{escapeValue:!1}});if(!confirm(r))return Promise.resolve()}return e.pdfViewer.getCurrentPDFDoc().getPDFForm().submitForm(e.getURL(),e.getFieldNames(),e.getFlags())},i=this.annot.pdfViewer.getActionCallbackManager();(i.getCallback(ot.submitForm)?i.getCallback(ot.submitForm)(this.action,t):t()).then((function(t){(0,S._)((0,x._)(n.prototype),"active",e).call(e)}))}},{key:"setActionData",value:function(e){return this.action.setActionData(e)}},{key:"getFlags",value:function(){return this.action.getFlags()}},{key:"getURL",value:function(){return this.action.getURL()}},{key:"getFieldNames",value:function(){return this.action.getFieldNames()}}]),n}(fg),Hg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer.customs;Promise.resolve((t.resetFormActionCallback||qi)(this.getFlags(),this.getFieldNames())).then((function(t){!1!==t&&e.annot.pdfViewer.pdfViewerRender.pdfDocRender.doc.getPDFForm().resetForm(e.getFieldNames(),e.getFlags(),e.source)})),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"setActionData",value:function(e){return this.action.setActionData(e)}},{key:"getFlags",value:function(){return this.action.getFlags()}},{key:"getFieldNames",value:function(){return this.action.getFieldNames()}}]),n}(fg),Wg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"active",value:function(){var e=this.annot.pdfViewer.i18n.t("ui_:dialog.actionDialog.selectAction.import"),t=this.annot.pdfViewer.i18n.t("alert.browserRestriction-actionTriggered-websdk");this.annot.pdfViewer.viewerUI.alert({message:'"'.concat(e,'" ').concat(t),level:"warning"}),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"getFileSpec",value:function(){return this.action.getFileSpec()}}]),n}(fg),Yg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer.customs;Promise.resolve((t.gotoActionCallback||qi)(this.getDestination())).then((function(t){if(!1!==t)return function(e,t){var n=t.getPDFDocRender();if(!e||e.pageIndex<0)return;return n.getPDFDoc().getPageByIndex(e.pageIndex).then((function(i){var r=e.zoomFactor,o=i.getWidth(),a=i.getHeight(),s=e.left>o?o:e.left,u=e.top>a?a:e.top;switch(e.zoomMode){case"ZoomFitHorz":return t.zoomTo("fitWidth",{x:s,y:u,pageIndex:e.pageIndex});case"ZoomFitPage":return t.zoomTo("fitHeight",{x:0,y:0,pageIndex:e.pageIndex,type:"device"});case"ZoomFitRect":var c=t.getPDFViewerRender().scrollWrap.getScrollHost(),l=c.clientWidth,d=c.clientHeight,h=t.getPDFPageRender(e.pageIndex);return h.getPDFPage().then((function(i){var r=i.getDeviceRect({left:e.left,top:e.top,bottom:e.bottom,right:e.right},1,h.getRotation()),o=r.right-r.left,a=r.bottom-r.top,c=Math.min(l/o,d/a);return isFinite(c)||(c=n.scale),t.zoomTo(c,{x:s,y:u,pageIndex:e.pageIndex})}));case"ZoomFitBHorz":return t.zoomTo("fitVisible",{x:s,y:u,pageIndex:e.pageIndex});default:return 0===r?t.getPDFDocRender().goToPage(e.pageIndex,{x:s,y:u},0!==u):t.zoomTo(r,{x:s,y:u,pageIndex:e.pageIndex})}}))}(e.getDestination(),e.pdfViewer)})).then((function(){(0,S._)((0,x._)(n.prototype),"active",e).call(e)}))}},{key:"getDestination",value:function(){return this.action.getDestination()}},{key:"setActionData",value:function(e){return this.action.setActionData(e)}}]),n}(fg);var qg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer.getPDFDocRender().getPDFDoc();this.getFieldNames().forEach((function(n){var i=t.getPDFForm().getField(n);i&&i.setHidden(e.getHideState())})),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"getFieldNames",value:function(){return this.action.getFieldNames()}},{key:"getHideState",value:function(){return this.action.getHideState()}},{key:"setActionData",value:function(e){return this.action.setActionData(e)}}]),n}(fg),Kg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"active",value:function(){var e=this,t=this.annot.pdfViewer,i=t.resourceGenerator(Lf.PDF_DOCUMENT_CLOSING,Nf.OBJECT_URL).expose().URL,r=this.annot.pdfViewer.customs,o=this;Promise.resolve((r.remoteGotoActionCallback||qi)(this.getDestination())).then((function(n){if(!1!==n){var r=e.action.getFileSpec();if(r.isEmbedded()){var a=e.getDestination();e.action.getFileSpecStream().then((function(t){var n=function(e){e.source!==window&&e.data.isReady&&e.source.postMessage(Object.assign({foxitSdkActionType:o.action.getType(),foxitSdkActionUrl:s,foxitSdkActionFileName:o.action.getFileSpec().getFileName()},a),window.location.origin)},r=new Blob(t,{type:"application/pdf"}),s=i.createObjectURL(r);window.open(ce("href",location)+"#FOXITPDFREMOTE");window.addEventListener("message",n,!1),e.addDestroyHook((function(){window.removeEventListener("message",n,!1)}))}))}else{var s=t.i18n.t("viewer_:dialog.action.remoteGoto.message");t.viewerUI.alert({message:s+"("+r.getFileName()+")",level:"warning"})}}})),(0,S._)((0,x._)(n.prototype),"active",this).call(this)}},{key:"getDestination",value:function(){return this.action.getDestination()}}]),n}(fg),$g=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"active",value:function(){(0,S._)((0,x._)(n.prototype),"active",this).call(this),this._doAction()}},{key:"_doAction",value:function(){var e=this;return(0,_._)((function(){var t,n,i,r,o,a;return(0,F.Jh)(this,(function(s){switch(s.label){case 0:return t=e.annot.pdfViewer.currentPDFDoc,n=e.action.info,i=n.hideLayerIds,r=n.visibleLayerIds,[4,t.getLayerNodesJson()];case 1:return o=s.sent(),a=e._objNumsToIds(o.children,{hideLayerObjNums:i,visibleLayerObjNums:r}),Object.keys(a).forEach((function(n){var i="visibleLayerIds"===n;a[n].map((function(n){n&&(t.setLayerNodeVisible(n,i),e.annot.pdfViewer.eventEmitter.emit("layer-action-actived",{id:n,visible:i}))}))})),[2]}}))}))()}},{key:"_objNumsToIds",value:function(e,t){var n=t.hideLayerObjNums,i=t.visibleLayerObjNums,r={};return function e(t){for(var n=0;n<t.length;n++){var i=t[n];i.children.length>0&&e(i.children);var o=i.objNum,a=i.id;o&&(r[o]=a)}}(e),{hideLayerIds:n?n.map((function(e){return r[e]})):[],visibleLayerIds:i?i.map((function(e){return r[e]})):[]}}}]),n}(fg),zg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"active",value:function(){var e=this;return(0,_._)((function(){var t,n,i;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return t=e.action.info.dest_thread_index,[4,e.getArticleThread(t)];case 1:return(n=r.sent())?(i=e.pdfViewer,i.getPDFDocRender().startReadMode(n),[2]):[2]}}))}))()}},{key:"collapseSidebar",value:function(){this.pdfViewer.viewerUI.rootComponent.getComponentByName("sidebar").collapse()}},{key:"getArTicleByIndex",value:function(e){var t=this;return(0,_._)((function(){var n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return n=t.pdfViewer.currentPDFDoc,[4,n.getPdfArticle().getArticleList()];case 1:return[2,i.sent()[e].children[0]]}}))}))()}},{key:"getArticleThread",value:function(e){var t=this;return(0,_._)((function(){var n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return n=t.pdfViewer.currentPDFDoc,[4,n.getPdfArticle().getArticleList()];case 1:return[2,i.sent()[e]]}}))}))()}}]),n}(fg),Gg=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"active",value:function(){var e=this,t=(this.annot.pdfViewer.customs,this.annot.pdfViewer.getActionCallbackManager()),i=Promise.resolve();t.getCallback(ot.gotoE)&&(i=t.getCallback(ot.gotoE)(this.action)),i.then((function(t){(0,S._)((0,x._)(n.prototype),"active",e).call(e)}))}},{key:"getDestination",value:function(){return this.action.getDestination()}}]),n}(fg),Jg=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.actionOptions=t.actionOptions;var n=this.actionOptions.remoteGotoActionInit;n&&n()}return(0,A._)(e,[{key:"get",value:function(e,t){switch(e&&e.getType()||null){case"TypeURI":return new Ig(e,t);case"TypeLaunch":return new Tg(e,t);case"TypeNamed":return new Vg(e,t);case"TypeJavaScript":return new jg(e,t);case"TypeSubmitForm":return new Ug(e,t);case"TypeResetForm":return new Hg(e,t);case"TypeImportData":return new Wg(e,t);case"TypeHide":return new qg(e,t);case"TypeGoto":return new Yg(e,t);case"TypeGoToR":return new Kg(e,t);case"TypeGoToE":return new Gg(e,t);case"TypeSetOCGState":return new $g(e,t);case"TypeThread":return new zg(e,t);default:return new fg(e,t)}}}]),e}();const Xg={error:"data:audio/mp3;base64,SUQzBAAAAAAAJ1RTU0UAAAATAAADVVBZVU4gVHJhbnNjb2RpbmcAAAAAAAAAAAAAAP/zwMAAAAAAAAAAAABJbmZvAAAADwAAAA4AABh8ACIiIiIiIiIzMzMzMzMzRERERERERFVVVVVVVVVmZmZmZmZmd3d3d3d3d4iIiIiIiIiZmZmZmZmZmaqqqqqqqqq7u7u7u7u7zMzMzMzMzN3d3d3d3d3u7u7u7u7u/////////wAAAABMYXZjNTguMzUAAAAAAAAAAAAAAAAkAuAAAAAAAAAYfNJCphkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/zwMQAUHwOTAdawAEmXGgLFAkxKU3Mk6dc6s04bESZmMQHJlnHdmnKhwOmpVby2ZccsgYQUY4kZIcAiDNS3ZhQoGDlrEAiRDEIpdfdh6p0AhdwtgWULIFmEADTKFYQv4WUMAAEBAAwSldtdiwipExEVEVFNISw8tgAAGARkIZiGQRdhkJjWfvH7RyUGAfUuuWTL5w0X/RTdeu6aX6Adf6NhrWaRo5y5yHcsV7fPwqRh2HcnJW1hYRQBIRIhYjXJ1212MQZZLOZ/hSRu/KIxYm3bh+1Dcbt/Xlcbn5Q1tr8Py/uGGG6TD+6lEYsStyHIhyWYfnTxt/IcpOf/1425DuP5GJZSWMMKent9lD+OQ7ksl+eqljn1H8Ym1+H6enjb/w/L+aqUlJYwqRhy4fn9UljCpSP+/7tuW5blv/fiDO2vw/flEMP5GLHf/CpSUgGAAZMWhiMZldMDSOMgUPABaGRbgnPqSmaoJnuYgms5DHh4SmrooGFwTFAImIADAYPDBQCRgIjRRg1g+OGRjM2gyxCOUKzJVA2lEMrQwgqMuAjAf/zwsRSbOQWeUGd2AAJMnIjSA8AAQUCBKCCqMa+YhcUHkwyMHNJBzBSk18QNKLTdAAwwtMDCACTmCghpQwr8UFCZEMoFTgx0FHAgLx0QMTHTC0ImUzDyUILSJOAwgYIJmjppiZ6JHQ8RG6EgWK14GzFxhDUY+BGKiBoIqAAEyozNFWzA1My0oLhg0XBIYBTQORC38lfZZbpmCCxjpwAScwYmIids6uyANMRATCyMwUqNcBjBykmBn+0MgVKYSEtqt1PRCgSD42iorG7bwS6XiqKWAuDUxwYAhAEGCcsZXSohN1xAgAJETkFUJJQkaDC4sPKTa2ls6z/xuKNYguWSGXxFnb9vxJZfAk9Xv0jxvbFlJS+H3NiEXjtDHIy9Lk3HYbu3yg8XiTuO5F4xBU3XiNSV2oHr34foJZar5Z4apO7vd4zClmH2fqSN1f2TWX8lcPPz8/R5Uk9pxJC9blTVO772xjCVReVU7y0NmtnScoAAFxgMgBGya0Gigx3CwsODHM9AoiMj105eUjQYmNvloyuEjVLUMagIBCIwGOjJoLMNir/88LEM2YsEpInnNAAHjOEBdACGejmgjKAzRgTfiDDHzBIQwalCRbkAaJpEVEC8LAQN4QACxwUCApqAhw9WCo4aJGQJBi8RhQ41NAUkZoOq0CA1jAwQRapoLiSySUpnBSUapGsGYKBQO4xpgxiCwcCLyGBGpymEFmZImFLgkE0kEjAQPSjNYGMsGCBwcER9hgwAxMF0tQwwpIhS5R0cIl9luRWlZ6+wwDAgcDBC4aZsmqrAl4xESWVVWysHIV5yuN33SpfMCIKAicW2dpcW1Y3vkawVPIgShUNlyTiSzNVaI/FI0vqG5uQOsxZyUe2JOomIw1O1AIwaGmJyqJNHymyUA3N2H0pWVtfo4+1l53YZRFXmVNJ5svDKm4sqZk48teliGLxXVKEPUQGGK2Kna8y1kTIl8yBEZ/WCzrKJe2lxrLLVZUTGPtYYm4sQhl9ZI56jL3uPm5fJmRI9tbeFdD2syVlhDYIMa4xZerFnOgqMSal7QAACYAQoNjKPfMFhwzHyTCQUMu6MwqvAULDVDOM2B85YrjKRDEiWYBBaCcYE5hQ//PCxC9fZA6J45zQAUxiQkmOMnWCgvgASR0kAS5MmcMEYMOdQBEQkcRGJJGjGoEysMBmQqbHugANgqiaUyEVBQQgBAx0InCM4a8EPIUhzaGxYaWYNWWEA8jbu8YUgGETAnTHEkmwoUDgRjEI4JL6mdbmPXmDELtK35gAoQPN0kM8WByIWWGYFiMCp8GnRCVRAV6FxRgDJpQ4AFPzCm5NUXGIxIIEiEaAiTK4feZVYKAhEISFMyiMABVroIBeNiKkUWlwNiT0QvWM2N1IKeJj8vCiRJaDVg21X8n9FHYmo889pAcPAFnLJUPgGCWgPZHJc06/Q15tu1IzidoZulppRUqTcTuT0alz8P7Vzk0hlGolK5uU3ex+OUUO0fY5QcmZu3SV6CmoKstksrr1LHfp4VP3Mr9/+xDKPR37duP1KWclMpl9/f2//T+ZvVdkEKkteWU0rwi9TDOtYtCFIABMP0Bs1BIVQCAghGTAngoBE4Dl4zD5HCXgzIwKQETA7AlMMkRUxuh90Uk3QcAmycxxT45FxY8/yJgLZlzL8TnXuYlEGf/zwsRGaTwOLAue6ACTSBmwTstKi9gFA2KAAHAAZbKmaFDeY2HaZ2tBVrQDSgYGBUAQ4AwcDYKkYx+Hsw6IUw2HQzPMatAMM0kdBgGBAKGEQGJSojmW6pAqCzS50wuKpnknZn0MJiUOcZj0fiMCuk4S/03wgCxIE2gJhhgBmEwtGeq3GSRwmGhDGPoRGFgkmFALmDgSiAN5e9UNV4Khq3U0lohQHAI7dSpVi+jJ40zLAgTAkDiULzJ5BzDUZjE0MDD8WjAUHjB0BBgAzA4NzDgI6aIwzSR2U83vn75Vl7lw04i1I/P09axIL4KBlHlghgiFw6BhheHBhaDBf0Kg4YZhoDQKDAeMFBFBIDGAoBA4AssvrZd//xx+rjzdJLP/+/3WFjPD8PMAwYDgaUWAAKmCgJmCgImAANmEgOlmFSp7MHLmkABAoEkvnmWBUyk8R/mv+tl3LXf/8cf3jz8cqSc7hf5nP8zv7zn+W7agYDSZHEcDgcDgZGJNsx9TDzafmvkAXAvhoKgUn8a7ybFSKBgBAEIWmA4AAJAEmGwMGYt4OKL/88LENmiD9sJfnvIDISAMmAsACAADzO8UMNxqCY3JDmC8RgCABAYBlKpRZSRlIh3mB6F+Yyoms2py3OlgaCTtUi6Nzpxo28kEDVzKXj8SvuQ0+G3zrGWWsebmaQ5kQBEmBkR0ZwhIUmcaeppDWW58M0Zx6ugmm+TOYYguBoelUmSiPaYLIVhlYiOQRk7TawmVW3Vhqdaky65TGWcTUYGAe5wVJRGEcL2YcoCphyA3GCuG+YWIGJmGmiy+OwXHL36uZy2GYpP4/3KoZAo9Zi0hEmHsGYYKAKZhnhJmDQEWYfYdphAgEmEaB+BQGzBVA3MNAHIwHABU5XfhEAO5D/ZHbr7orDMLm78k7LMedrY+WvSgScBwCBgXgShwD8ohpxIm5Lvv2AgBFLIEuY6r5y/9bu4freOf7s8ztawyyt/97vFTuO/6VjKGmLvZfU44cjQBsvtILqb0c01h+Kmdi3e7T5/jVynrNT9/v+0GpqJ53ebzv5Y2ZgUCAVAgMFIICEzHBkwUC0xYXU+0NYCBKYiGqa0D2AidIhBMbASSMRSL0uyF//PCxClfZAZ0Ad3YAUEDA4RDAkJK5lGBQXApHkyJJIZCgaA0EkLDBwBNMCwcTFBqm6kKloBogWgzJQIqh5ADgZQMMVyJjYgBDwWOjBilYUISjExswlsN6BwYCiEACCxlYhDBUPMaIzAREBBBWCMVOFCRgqfAwgMAJoHBhmomQlCIZyg474OCwdumFlCV5c4VIC8gVDWdP8ASYaDBI4QSI2jVkYmQAJhS4BAuEIwGL3ZkTSqaRuQz2wpg2NLgGiq2FmrjCpIMDrXYaDhtPSHqezChoRgJewJE2fKEOIm8lgrVDjQWmwLBzPMYQ0iflRICVZVAeFqkuyqgotTMYd7ll08FP3HhZ1I4FsbpatiWP9DMVci3Aj1XbV2HMoo/sc3Zcegn6fuo1K4s9N2vM5Uz72rzgcn8e7huTTkQqwfGY3KsJbDFyjrzNHepqSVRmMVKK9KaSWT2r1i7Lbuu16aeuLwKC04vkIzkPMk4zQrA9KDUw6CUwVNE/d8w5YGKDRDRwFKkY2xKbmkOtyFhJ/hyRDBD+ZyEcVggoMUyKBxn4BewiP/zwsRAVgQWfALfdCBLutIbiBeiQIQ0UsTSMUHMMCJpTzkMBq5mQyihEnGDxYmDYiGCoAIiDYGfFDMdYLQIogULFg+BUSYyCgyDTiBxUwBYVIA4Md9Wl8W+OqGLBomDJujo4eOFrIsx8KoU9FeqLCAYMDBlaVgk5S4AsbLUSi0/M18bbHJnHdNQguwvpoa5VZg7u97+rmaVGMnglQ0LhqbJAz9LMkaqTQFiw1ZVWi3wuWXoalmC0mhyaW26LVSilWNDjZgG/jCZVLqePt49N/PVNT09iEx/GV5RWVx2mrflM7k03N0tNS7lMbhOdqGt0VnOXw5U+L3a9PO5yimkUNcwuXZVvVDLsKty3G6T3hlb8VJe/Ev5Ny2SZVqSXzOfK+Wt473aEKGy6IVGEHHEYBgmYaPMcCEaYPBYBBLNVwDAwFkIIGKYBsHcVRZsEMiw9ICxIADF8P13IkmPYsCoKIklm3WRLJBRUcka+l9JrGEYRiQcA4ISAApgmnlSQGDlxjLQiGGeArAEQ4VUlioRXXbIAmTU1tjxoxYkGAhABR/V0Jz/88LEfVS0FnwE7pk8ERD2IlrguZKBphjr4Bhc4EJGwoRHAIkAgmVFUIsooirDR1iwYJTOFk7/vYHbQY7L5oREBoMBEgWHLzTrkHwxBsIhL4MdLPPwRC0piUSYMM3bSoXfbNSvRTlvIAlw6HgBTiGWMSFZUGU605VC2w9nobnLDlreder2XZUVNcpal6BXQlVd0oAZpGYahl2YftuZuD8XamESATLuLdcbgdctF3IulfVGVZn25V4uJOuHh9x080kdOVx0zqq3I4nF7+GpNJw2KZahYMC02nNzo8SMtNTmJJYhfkxBTUUzLjEwMKqqqqqqqqqqqqoluQ+g0VSaDiUIguK3g0KXwwRGDCkaHEymoJAYGIS27a3YAZAYUACSqqphIYS1iBlISjAEU8gpDaURkQL6Tji77xoAdrOFk22UxQSCsiAyqKiDyhNOsExccIJOChSUJtNCrqJusBCXaJmxUEgOC4qHF30gBxFfYOmWuXiM+dRJk4HWR2KClzthKyFVXjnB0x6UsnrHQQgNERC9khKc+SSUu3AtS1L5uQxZ8J1J//PCxKxQTBaIBuZe/NaPA0DNHIsJNBj/tju7Yj8E/SS+Fqbi0choMQ73i0arWtJy7tEy0Db1JSNT6cYGobVEV+HJPw0DiRBpBycFfN4bsrC62UauWEG1vXF+4zrhpcG5mT7ZGXTCulQpynZ/M3zk1gxUwwYzd+0vpCrQyO3Ipl20oTBc19/cuS8eJxHswahubA/mMNDmGDRzrHcJIMNitBs5VUxP0qAIiIQEwHQHDAaADMIUpw01Q3zAnBVBgnx2pUGJAEAR+Z6EA8DBYDAYDwGMg0CEskFIXAhiRaumGBw4OaiEbCwNBR2QgYcDGwm40GkS+pik6nSZ1MA5fMtBhCOs4NGCRYXNaAlLwSFkVAaINCAkKCsgVQDQDTioyKhQ0pgICEAmBkQKMyCcBKwAEkmSl2EYkEERCJgQZBy+bAECAtHisA1hgQ8Y6BnDDoVEg6LBAQSCossig5HB4MMFNQAImNAy2IbNtCjAXQqAgEBQKECzIRJj6Tia8NV2sQCjCX9TKfEGES2y7AwEpLGoCKtsNiw0pqrXcj7aGBhS8H5MIP/zwsT+ZMwWbAD3NlBVrhEIMRHQJHMcBKRbxe5ddAzp8oYaJF6dHkaAGCwFSx+7UkUAXIhEoFa4/cLchrb1y+IqxMyfiK9tRa9p22ZwtwNPZUm5yPbkER058pxh61C4egLNyYap3Esyycymm+g+jbDTbiee3RgqzEX7jkPWKO7WrNvWiE3Nv5ledl9oGf6kzq2KDCNQ7AM1I5RbnrNzeFnt/qoOkozAdDZAQXCoTAvA7NMcEwwhQKTBlAcMfAF9cZgZAMGDMBOOgGF8wCAIxwDAMGCqBkKANmBOBKYPITRgGALGBsBAYdAPIGA2L1gIpMJDUGjUkcx8dAwUOACPCKhm8cBlg0QEAQaTA5pIeYyugaQMIAjDzcDRhjYeABoSLzBkwwaUMrGRYDTLIlJAGyAygLCDoSPTOAQwIuBpGa4kGHFzQzBRAIABJvNHIQCVgYCC1KlWZWImxsgCGCh6Gh4VFzGQkiIwwAeUwYrQqMWCUcmeGsBAwpDRADgZSZEykREyCCVq1nOfOGEmVFFsCwUYCDBgIHDq7U+ha/c9h40AOIr/88LE/2b0FnADXtgATf+LKaAAR62UQjjxI0vtkRDaA5tY0hPaFArptpFWiW6j8kQK154L8Qnp2I/AvYYkbCs5Io5WV12KJmwO3sxSdkv5vw7cQpIAlboU83TxyRy/CET8teSYkV6YlbKs67XpZYq3Y6tnKYeGG6PdHYlL2UEhe+NRhtb0RiNufo7MnpXifqD5x06CbiF2LT85fnr0a07NeNz+Nmlpbcut6gEYQ43poHJHggGIw9wwIarm/+UcZKgPZhVDPiEFRmStxh4g5mCoHsYNoFhgRgsPfSGNxunCipAtMzCIKTCkbgwj8u6MLSiNWwMMfSWBIIDQJmAwF5d4aFI+YsDSaIDgabFGYDgwkOYChgYSid/47NHR8NgSeMXSiMNT1MQhdMLwDMQhRfwdAUwyF/lbK1VMZjnEkEMHBHMm26MymJMWTJBIlmBYVGF4XGHIjAUMDGMYDA8O3dx5r/35g2exlOLZiQbpkYboYUgYI4FA4wCGoIGwGgQCgKQZMFAlMKApZinyYAgwMgR+v////DjkMsQ9MOQUMBBaMWSH//PCxPhnw7ZQA57oATDMGy8piQGZgYFYVBwLBkTDKUAuYShQBgPUxSOFARQZMBgFSRoXVCoEJpL+///f////+FwCYACgTJAEGQIAIKlyQCBRVB0Kgk5ZYAQtegssoLgfDMNSuHXShTAX2kTAd7fWU0r6//////////+IQBL8l0QcDrzFQCCYEEvkx1yhQAVFIuRACs9SoCAWtjj+RtwXlYE0plymS8kimXTVO7OMqnppypFFTEFNRTMuMTAwqqqqqqqqqqqqqqqqAlZVvVpAgyZUZmWDoYCGKlBmZgZKJItAQdNXgjnaQ5lyMhAzQGc3h1NcMxAPGhrxoyaaEcmXD4QCGUohqKcZ6OEoqZcgmbMGPDA4E1sCBTEBwgC3AGggAFMIFBQFtC3RgwRfJ4y6pd5AMmFC1yoqrpljSlMUxVNYwgmLTIpOMxkCijJljJiE6zCEzMFzHA1WAUsZxmb6GbpSEFDOtDgvjYmC65lFpqWxu3Rs0QYPMwxN05NURHAxnVRnD5mCJiga6DBjjJkAUSSdMMNAQJ+qbcZf2W3I1GaWl//zwsTZW6P9CZXb0AEfyy3jVjMtwlT/S67GY1TU1reONa1NO0/1uGXJh25DUZjMts1qamy3Ko1Ls5S/strRqzrLL8asMxVuKQqYMUUyQeWtBqmK7nejVeGXdis0/0t53//VNaiTWmvUcMuTDtA/0trU3caWlpb0Ray12ifZyn6vxF2mdONTuCzl+Zp2pbzLv/ulszLku7YdpyoeoXZjVr4ooKpMQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqo=",warning:"data:audio/mp3;base64,SUQzBAAAAAADBVRDT04AAAAHAAADT3RoZXIAVElUMgAAACEAAAPDlcK+wrPCpMOLw5jCssOEKHNjLmNoaW5hei5jb20pAFRYWFgAAAApAAADY29tbWVudADDlcK+wrPCpMOLw5jCssOEKHNjLmNoaW5hei5jb20pAFRBTEIAAAAhAAADw5XCvsKzwqTDi8OYwrLDhChzYy5jaGluYXouY29tKQBUWFhYAAAAJgAAA1RZRVIAw5XCvsKzwqTDi8OYwrLDhChzYy5jaGluYXouY29tKQBUWFhYAAAALAAAA2x5cmljcy1jaGkAw5XCvsKzwqTDi8OYwrLDhChzYy5jaGluYXouY29tKQBUUEUxAAAAIQAAA8OVwr7Cs8Kkw4vDmMKyw4Qoc2MuY2hpbmF6LmNvbSkAUFJJVgAAABEAAEF2ZXJhZ2VMZXZlbAB7DAAAUFJJVgAAAA4AAFBlYWtWYWx1ZQAhewAAVFNTRQAAABMAAANVUFlVTiBUcmFuc2NvZGluZwAAAAAAAAAAAAAA//uQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAARAAAdYgAcHBwcHCoqKioqKjg4ODg4OEdHR0dHR1VVVVVVVWNjY2NjY3FxcXFxcX9/f39/f46Ojo6OnJycnJycqqqqqqqquLi4uLi4x8fHx8fH1dXV1dXV4+Pj4+Pj8fHx8fHx//////8AAAAATGF2YzU4LjM1AAAAAAAAAAAAAAAAJAJAAAAAAAAAHWJUiMoVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uQZAAI81BSOKmGTTAAAA0gAAABD/09FhTGAAAAADSCgAAEAJAVbVtVpKZFAPBHOIWq2r/9/TOMqjc8XwGpRbVm9nOIhwsIPKmlLVlTqk4uIts2C6zjCOE6TWIRcTihGldXJzE6/9Xu5ue5Re2xf91F72NzYLpMubYnC/8zc3JRacSI1Llm5v+5ubjbcKr218Dh21VYSCYlBMD5PfzU4Cw/o2wXxLBoTIvqSxHecmxIdX/S7B+dk+BkzXnZPilOZiWjcbucKDs/YZEMRyeeVX4weOQ2P70c6862s67FJ9juO4zisY4Fi9X0kV5zfXktX0ziwwP2N9gSCYeV5iI7fmWKHZPfYcxYspkJmSy2/Hz3Do0EgdDgjCIRAQTrYEsCm0aRgGMVvUeViS3EjDGkRylySjhmxgdxXG/fuMiSRxdNidBmjkuuwE9DCzgACh524Etu/qKQKGCGWCgu/cTj0zSTkIrLFQBQplk465sKGgVI5TIeySkfyWUsDwmlS4MgQxBERJGtCvGsqtyilD8zEtp6LO+rhOtx77bvBFKSekMd//uSZEmABw1hTG5nIAAAAA0gwAAAGIVhVfmcAAAAADSDAAAA7XlGrFB9i3Us8zl0sYApoXbfNphjil83vpu6jd7tLe7Uln2Kt3VJR7uWtloyy6a7E0v2TwI4brq4pf//////////5+HP//////tssjF2wzkyiYAQAQBRngYBAUAwGkHUoYnESIx7LX2ulnAECj5bFhUPhACWAlaFlstL1KXQU6SkQcdGWRRZdkAR9lTeO+XrcJbwQJgEu3FJFYpZ5dKpUJKwxfHH+x+KQPKKK/J00XwjrVWYSScfnt6iksUpLkowuyuT3KatfiMQy53/ktNUm7+GqXCT09qNWsKaNSXnLef4Ycp62X0EooOXr04+1FJqCdlupmzbsW6etup+dr62W7n4b+r/43c8f//////+1ij6yyI8AAAAAJmuneg/VEzFQEeKTqBQDEqDqVrgJqhUMARsYFhmLYpnAWLGKKRhIUQhxiIgYaNmhG5sAjByWEPJjRJ+nKW2NBa73HpZTP7lqMwoBF7GGN2et/KRhqsIkOlz0vlFmLwxDDwoBQEGlv/7kmQ1hvYzStNPb2ACAAANIOAAARVdOU3OYZVAAAA0gAAABO1xrBLPgiPRNMVlLS4Bp2TTWD/OnA09RQLbtcvRvLnMr9itTUkZkeql7dqpL4blj+UWGu00WlU5Kae5LK9PKrmFPT50dWlraxzq4U9vDD8+6u5Uk0iMZdj/2/+E8qAAGnjg/chdiKQM8RZcw2jU4pDbiDnQ4lWIBmYJpAVA5MAJibUeYe3JgJgkhGbxXF37ncu4y1hICCLbyv7q1pdOonAprrWIdoLMaXkhKOPAlFPHtyO+zqRMoCNyu/Fo3yasOCiByW52t8vRJVNpEm/9bxxjMFQdK8Zl2+uror6tqfPFMRN33LLmoDYDiy9v8xQiUHcc1eZd7vZv/w12uTMp2gVO4C4AFgaqLJMAYAACAAADkWKMvaXbdpCe8CW4YABk5It4snXkYGALxqoDwuJIsAj3G2mt9SQ+2r8rHMQBRZ8st6q1Y02BNQOB1atjr/rtLMGgJ87tacwyyX2ikWta64N+9N+9aEtUi3Gfuo1qn+MJykxGnjYVhoCGrN9Rb1//+5JkO4D1UFfTe49HEgAADSAAAAEVIT9HjeF1QAAANIAAAAQrutoSjEIkUB0TFXLFi4hiFbMtiyi4YepW4MQQgUqan1KE+pMTc39CCIj/enAs73/qMfMfIAAAAAASrePMwSwuxw0bBYXOSQR4MgeO3mxMDUgZaVmVnQEGEV1gViMoeGqmOF00MYYMjbu35XjNI7AqTfYT2Vj5XEW4SudrWq9FA0uR9UFdWb+3WjyYggKzVtbvZzGcgtB8WTKZjG/nT226M/X7Oa1lW+5N1LPP2fYeBIMS2nq1uG8fScfW10RvTDEhTJLcXSwxLzptZxhyp1WVzLUuPuuO1En4qc4lSmQAEAAAAAAmIwa6Cy3jhuUPiSESbmmbOQNdjLxRsyR03Ng0ClSxY0jguUL2MIXMKeMEDmrTdS/+zmbYFY2cVkg2lit0kHTKvryy5awsq0fQ4jNgB/FubTQuLpNQySrrgSsVvn831ONlVVn6wrcn+7++K8JIg02W6GCsYNTis+LnSDvhMlikI33fwWMvR9gbE87DK10pXL9l8Nvw+7I0njDi//uSZFED9FRD0nNPTTIAAA0gAAABEUEvPgykdcgAADSAAAAEPKkUAVdLk62bufGkvmDLmgaGRfzJVW2rmclNrREBRdk1iA6kWsmPxFCwhD6ECASPoCoqZVILApphps+nLEBV9IVftNybfGJk2qik2cVDyN0KqPGJB/Wj5nZTUeirQ99kilXPilC1JvX1MkFgW9M9uS9WijVIAAAoTqNmBhM+noBoC7lwS9A2kfNpCfDqtqDvjzYS0lhTTr6bRZJ4MBDWpfKSRW+tNZ0JdR9FoESoS5ZNBUoEEItQojmGniTQQ+UEl2jbC0q0rXXh3y3h6ddciVZ2TBckcziirgehSNAZ//BC9VFvbbD+cdzXwGIUtXJkggAJRl0QUGadflbKnPS9fCGpVFokuZp8OkA4nWgEGTxCKh4gEIZMo3QPQuQZSclrRBOhIVkwfNVbmVlRMyqowXWXZRY487H3C4MAjCh934SVB4MMiU7pzLTUxkJIdkTZZNuLmDTXU1EBKdsxfyYRNaZebMNoNoF76p5CoAAAADFBRYyxmsMXkErZDFXWev/7kmSFg/PjStBDDDSQAAANIAAAAQ81GT0MJNFAAAA0gAAABKHn1dKYo6WMhkGwZlZh+IjEkaFIhx1RImTWSm5pemaqa0tganV45rygnCp5BOcqu2JrRqSubsN6cJM0rOC87KpQIunHIKrtIUqe+ElJtKu9xtIi9MqHIehJgdJn8l/+1v/oACwIIGAAC0nnp44a4wsCsLQO5BxkypGIg9lMw3htzpmzrSXtgSuahaJc2lQ1AdiWU4OOHFZgRtBD7SNht6kx0CmgsKMsGLlujJo1SXYYoZ+kj4ACGCAmbBlqBADoNWqt2My+extwucHgQXCIapaFvhkDAFBGozLIaq137qX5flgnokmY0KhISPHi4OERN5WdSK7EpZA8Ay3CM0taWO5PwwkwOAlWp4GAKFwRZi3QLgZa+jty1wW4QVA7k8yfi3J5Rbmrkss0/QSJac6NE0FDdnSqq11Nl0TP1qb///////7n////////8YZP2mdWhoiFhWdkRrvNrbI2gADIQYqAaiJaD0cpgMDy+YABJhMIigBQFGAwUYQF5UIZlSP/+5JkyYADtUFP5WEgAgAADSCgAAEdXYEbGa0AAAAANIMAAADhAiMHDsws9M7Ozt3A0sHkb1Gok5sRwBA00x3MxRjVR5f0NNeBwuRAjS1vNCYe87oz8qcJQZWUu3GlrwwmVRgQAFgkvbEZxpTYlBntSbhxpj0PA6q5SIMWQ+S5XK1T9Xkps7DQ4Ga5AjXWT4NxdiBlV5BFrUq07NyNP85MBuBDTbvi6kMZwbDM1DbrZulp6u1ZTr62NWq4rfNbcedrUMzF5dduXcKWcs6q1Q0HcjKf3EhxONwOCQ2GMJAkAgAE8beG31SsmvGwQ+6YODjQhowECDB2nZaYkZCILMeNzBAd+XVP9kxb1FIPf9y6wFINAgAXKxLveliiYEArHAB5csYlMUovzDCwyLwGPJQAYAZASaaeZisGQWuUHSq4gRTGLNPVqRTZgrSLAMLRmR4KBkeR0FWiXtJjluWw1Rw/DExFJu+4S2H6aarbDK3oddqEtu0d/KK3UwvZ9tZVXCtQdBeDrvhH5ZFm3jzWmCv+0yIOhz//n7//905JG4KpalLT//uSZNeABwdJUP5zYAAAAA0gwAAAHFU/M7m8gBAAADSDAAAAZ0e4W/dE883Uikows2v6hifgqH76IEAAAD8FUBYq/bwTjiukyyMx19JK6anbhOyygIye4gBRn4QQuJLlWaQ9Tef5TWgn6n3BVPXZxqZXKlgWHiPY1avFwWE8ag9nZQHyfrCXJDDMsb4sK2rH1mKp2TotdFGfbaquiJ1sqjnmkcZsMZ0p85k64rCAqfieZXNYcF0ha4MhUSsU1G1WlmkzGaCamUYch9phFLgv6BPYvk6TRxmKM+TXSa4VzabsiPUDcwttUQ8guLdElhv82vSPOS0CQ5oiAIAGFjEQKjURYEqbyJjN6jkUDS3wF2sOiUs2Ss0SwIIChzo5Dxql4JQp2qT9qMmoq+mZoGGkNtrh31CCKDCVP1aMTRUlOYZL7EMgdtLhR0tVvWnmYx6xlBrLMkyxsDF0laVDE00KNMUg9G5M71O8LjkL5XTVO6ABEQAAAAMEoxh4VBpHvglBugQB4LtD0PUQtitHcL8I4Ogv51nGJIdI/znW106HyDiAg//7kmS0gvXhVEzHZeACAAANIOAAAQ8BNUXHpM/AAAA0gAAABBBml4QPYmd4wHOZpTjUBRbgOosqTjBpkqeYy3aT3p3aO0Z3b/2zd2aHxHTKxHi3cvEgM9OxTkSzdc2bgwhDpvSRQQKg9bFSKuhe4pUAQRhlVdUkCp7GKB8YWahkQLpyiQNMCAFW4woNBATQ1vnpngbnOJqsJJoATUcPDoi5A6RtPjpiGoUKTHWeZhg6GpgklOgYNAO/bXHbgB3l6M0bG762mku0tEuuGDsPa2/S4Ef33X0vFW9myPaDSChbB7V0WH7ijW1lo5y+XOxSx5+AKGMY5vQCeW1pYb1vVk5+Oo1hMQlNqLFjeMPOwXfbYpNkKpy5SzeWZWa26savjyd5O4kGhOFAA0IW8tYqS0NAAgAAAAMWBFdRF9YKWWMk43AHTEgQBQAZPAbpF7jHdJNumUw8CJIw9iA0DzCxWBIRBAEQrljV0nkGjLQDX40F7qGVU6TJEfZnN8lCuhaRm8Yk0GRmXHMchgny5D6v4tkEVKqK4Ze9LyVwagPoF2Ii7z7/+5Jk2QHz6EnS8e8xcAAADSAAAAEYBSVJbmWPwAAANIAAAATx9eZuJLkb1rcdc7QXPT4axL5hucuYCkHDcgo79PVXvhf8/XHIMwaOEMte0ZlQsOYsfgtE2v/IBWJaljkbR6fq2FTLDJ2vpt61bX5T8v1/cnOlgd1gxLvyZSwCAAAA2bjLHDrrLU6MYgYmCjcHApq60jAhNONlEDCNqDtMfiAJDBlUxGVAdDMjwtvgZZHeqsfzOMrfYudBtbnMZ2XIIlLKLd+kT2QvCKOvTaxbkXeJDtkhNNOwIpkqMoAweXY4u0xJEFRxmlm/H2VOu0Fl8j+/DMJay+j8WMasM2FnwkShUMiA+QPihyElG/7gzKEHLkTXlresUDToQRfMdybFBZF/u/8OVWtQAgAAAAAAAUiGr5l2UCDAVDFZwslw4Bw/m6k67AUGJ0iSDwEg2o3idKd4MARq4VsOma16bwFCR66rvleZgoQmSmz3CUWoALhzmtyuFXhGEaQF3tqzUgsxEziKX9DsxlecICiNfyqRu9thooO396pjQYTitzyZ1rkz//uSZPkD9mNRU3OZZVAAAA0gAAABFVkPVc5hM4gAADSAAAAE9M7tH+vdQfSUdiFnF4ZFnCh5hUIMde5K3DcLSOfTt1Gwe7uXUpZqt9bbufq3rt/+WO//LjtPv4TPAhP85rPyVoABEwExWNuxI3ySvMTBHAyBhcDUGV9w6pUYCAecXreYBAKqZT5cYwPARyTAQQhKFmfQ6+rrUccHGwMQ7saxg+346lM0/34rTVAo2wfHN+J+y+4umyyVXH/qx0YMNjuFwzBjrzUpTQH04HlDpy3T/Er6/71aG7tLOA1VUMeudnpVgX+tYfn8xcIgYpGtXu8iVz692lxwjbQs6ZmJgOgQRSPixW0rAyqtt4Nx2xFOerBdEV7SFu/b0Qv/+frV8tTyykxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqfQCAAAAAABqtFdpCy482NFwwspgMLodYa1SDWqAwIHdFQBgvzBeiCrgA0IhE4NBbnc76h4s2z2zf7ivKtf+bsbmE9IVV3J9Q+/gsmM45xq7BQP/7kmT8BvXLWlR7mVzgAAANIAAAARgBW0ku5XPAAAA0gAAABMUA9RWTxCesLAGIiFWeUZ+gUoKEyfH6mUslBMHP8bXx932S0VrDsCGDbeJthQPjronGBwEo8fEPCALB8qQ9JDVC2/VVd1Uul89s8/+9f/lSjNvsABKA5FGIsndVq6QoCwYsYE0BUGK7Y0IQeYaoxoOKmBhAWrVjKAIRApXZVtBzsE24lKaebMRNXuNPTWvxQpnO/qVVET0odVbExWQbMlBpuqSVZx4wlD3CXteh6H50ZBA2yENarf3gXsLttpFn9fa88K3jMDajZlGdRrAiBdWU/PcwCgVY3Fl0ZSZ+p2qcCcK6TUXAGNarvZUK5BOLmZpTuWfHbaCCYVI1I49MQU1FMy4xMDCqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpJUAEAAB9AABeJgJp1kTHLWAUPMiFsOCbponvxAzeGGSQc1Co0H2WQA+r4x8QJX5znb9WmRyT5VUcOCIrI3oTNo6O/y22J2a/f/83ZREn/+5Jk6Ab1HVbT65hEcAAADSAAAAEVbSdHbmUxwAAANIAAAAR/MKnI4FWUmdSU7vLAjxb28a3aiqzN93M7X0KQsD/ju9uAmn26mvz0b3iKg7KjTbZWDwkMV1qKmJqMHmQ2FAXDxBTJcBNl0fmjAAAwAAAAQJTsGQHHl9jgaMA4oRgZrhEGYkIwCKAoxnNzoswMPhEIAiJi8xYMlzTApvDAu5Fi7SZ3DEPSraRk28ZfFsUX+M25VYm2GK+7fxkdVsZwqtChiT1JywIIkI2hxrOHo2wsCjMSpppypVEY2GLX4znuUQY+Is1LLFJH6FYAaEfOGKs5RXc8refb05XaPB0/rCtnYvfvLHCRABnF4K05G76zZG/ba2/nXjuuSKuFT+pFTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUpAAAAACoAAF4oEZWsKxqZboxkzdtVDEljSiKppGDKZ8AghC/z9xpyHZBQaRBdNnzW5tPpjzeTL301Z//uSZOYA9LREVHuYLHAAAA0gAAABFoUtQ05lM8AAADSAAAAEmE9/3tVppxtfz8tI7qmleGGV2UEgNEI/3uGZ+I11WucZPdLdqxukMkUe2fhyMBH7gw83oBV/1fd/rtUXMyx8XEzViqX7w+381u81qg64FJqx3D47AGAAEgSnHKLk32YpvGdRUIxvGBgBc9pjxGCgkHDwYlACOs/LJk0k7iAUAwFovPSm1SEqR4ER1MyibvNSpfvXLOmqKEUm5dWjESMUWAyuxPyGNjhBg7THehcXkbcQaRmt14cJiVpppDN/HZdTzDZQLMiDKc4ei/IZYNIreNDK62IAETmxRhITMecU9KFVG2Wji0C7PwgQio8VG8BEkM6qnEy1vOfuM3/mVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVSmAYAAACAAABUoAKqun9yWLLzjUtoalKg0plLuGGhx+wG51SihxmEKQ/j2OO98IQurKIjWmZDUg7HX//twluVnerLxojSfCYxp6q//7kmTchPRvTVR7b0cQAAANIAAAARUtNUWO4ROAAAA0gAAABAT3WMqeesugLNnJmkqZ6T13c7dsyhfbmZa7q/K1g7W7V7LUTfliZsgYlHJCwqkaXpFeHPIjjCxKLh4+ULDDt7nDq/UmAAJCGITwoAmsAgAFgcm9nYnDAwOFqhphkTmPzSbR8Z7QdGSBcDAOYLHZAMEakgb7KoOjedE4RgWX7n8bnv+1hrNq5Z3Mu2kE887B0tvsHKhSizsx5riuIRNDhWDSqal7GmWp1DeKCRPtDkpec8mgx9Yu69I6gp+OuBIofuwtP8u9Tuo5HJmWihZqKagy9MZ/fr27FSxFf1fy1OUE/nf/l3Kkzsdyps7NvOraxoLdb7/eVdVcbrERthVMQU1FMy4xMDBVVVWUgAAABJpLQABGcoWEIyBAUMB0BmDgYYmJRmNamJggZOXBicFiqzGjYYNsoZNQriTGgBMJV0wgFHBB5nDRDOM1Q5iRIAPLPuMEIEwc2ALBQCG1vP0i++jsXFO3sTTXfmsR0wEo8bNGoRItzWLADNJQjUx9rzv/+5Jk5IT0cUPTe3gccAAADSAAAAEXJS9AlcwACAAANIKAAARYltbRATG41Cih6eXKx9tW6oAHMZ8s9nCimlH2KS9kTWhYGq4Fm21FgduULyc6NR9472U7ParU3c9WcblWvLKsYgSYf+V08CTFLQV5+H6TWM3b7qtZqS+vSYz93H3HgvF5HUkz/wHNu5GP/////////+5c7///////4S+X25ZSWJfT26SksU9P////4EDGraAAABARclN0elZN4txOjSUTeT4gw9RClUiRbQcoGUAIRj5cuXLjIyWrQUFBQYKCgoKN/wUG/+BQKCisjgoKfF+KCgov//IFFfFBv/4X//Tf/gUK//v/+FX/+kv/8gUV0FBgr4QUCiugoMFPCgoFTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//uSZPmACBVmUmZzIAAAAA0gwAAADew7Vbz2AAgAADSDgAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ=="};function Zg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=document.createElement(e);if(t)for(var r in t)null!==t[r]&&i.setAttribute(r,t[r]);return n&&n.forEach((function(e){if(e)if("string"==typeof e){var t=document.createElement("span");t.innerText=e,i.appendChild(t)}else"string"==typeof e.html?i.innerHTML+=e.html:i.appendChild(e)})),i}var Qg=function(){function e(){(0,P._)(this,e),this.storeMap={},this.itemMap={}}return(0,A._)(e,[{key:"setStore",value:function(e,t){this.storeMap=e,this.itemMap=t}},{key:"updateStoreByElements",value:function(e,t){var n=this;e.map((function(e){if(e.type&&"gap"!==e.type&&"ok"!==e.type&&"ok_cancel"!==e.type&&"ok_cancel_other"!==e.type)if("cluster"!==e.type&&"view"!==e.type){if(e.item_id)switch(e.type){case"check_box":case"radio":var i=t.find("#"+e.item_id).is(":checked");n.storeMap[e.item_id].value=i;break;case"static_text":case"button":var r=t.find("#"+e.item_id).text();n.storeMap[e.item_id].value=r;break;case"edit_text":var o=t.find("#"+e.item_id).val();n.storeMap[e.item_id].value=o}}else n.updateStoreByElements(e.elements,t)}))}},{key:"getAlignStyle",value:function(e){var t="";switch(e){case"align_left":t+="text-align:left;";break;case"align_center":t+="text-align:center;";break;case"align_right":t+="text-align:right;"}return t}},{key:"getElementStyle",value:function(e){var t,n="";if(e.width&&!j.isMobile&&(n+="width:"+e.width+"px;"),e.height&&(j.isMobile?n+="min-height:200px;":n+="height:"+e.height+"px;"),e.char_width&&!j.isMobile&&(n+="width:"+10*e.char_width+"px;"),e.char_height&&(n+="height:"+10*e.char_height+"px;"),"edit_text"===e.type){var i="resize:none;";e.width||e.char_width||(i+="width:100%;"),n+=i}else"check_box"===e.type||e.type;return e.align_children&&(n+=this.getAlignStyle(e.align_children)),e.alignment&&(n+=this.getAlignStyle(e.alignment)),e.multiline||"static_text"!==e.type&&"edit_text"!==e.type||(n+="white-space: nowrap;"),(t=e.whiteSpace)&&(n+="white-space: ".concat(t,";")),e.bold&&(n+="font-weight:600;"),e.italic&&(n+="font-style:italic;"),e.border&&(n+="border:"+e.border),n}},{key:"buildWithWrapper",value:function(e,t){var n="js-item-wrapper";return t&&"button"===t.type&&(n+=" btn-wrapper"),Zg("div",{class:n},[e])}},{key:"buildCheckBox",value:function(e,t){var n=e.name,i=this.storeMap[e.item_id],r=document.createDocumentFragment();return r.appendChild(Zg("input",{type:"checkbox",checked:i&&!0===i.value?i.value:null,id:e.item_id,style:t})),r.appendChild(Zg("span",{},[n])),this.buildWithWrapper()}},{key:"buildRadio",value:function(e,t){var n=e.name,i=e.group_id,r=this.storeMap[e.item_id],o=document.createDocumentFragment();return o.appendChild(Zg("input",{type:"radio",checked:r&&!0===r.value?r.value:null,name:i,id:e.item_id,style:t})),o.appendChild(Zg("span",{},[n])),this.buildWithWrapper(o)}},{key:"buildStaticText",value:function(e,t){var n=e.name?e.name:"";if(n=unescape(n.replace(/\\/g,"%")),e.item_id){var i=this.storeMap[e.item_id];i&&i.value&&(n=i.value+"")}return this.buildWithWrapper(Zg("div",{id:e.item_id,style:t},[n]))}},{key:"buildButton",value:function(e,t,n){if(!n){n=e.name?e.name:"",n=unescape(n.replace(/\\/g,"%"));var i=this.storeMap[e.item_id];i&&i.value&&(n=i.value+"")}return n||(n=Zg("span",{style:"color: transparent"},["A"])),this.buildWithWrapper(Zg("button",{style:t,type:"submit",id:e.item_id,class:"pdf_js_btn btn btn-outline btn-xs btn-circle"},[n]))}},{key:"buildEditText",value:function(e,t){e.readonly;var n,i=this.storeMap[e.item_id],r="";return i&&i.value&&(r=i.value),0==r.length&&(r=e.value),n=e.multiline?e.readonly?Zg("div",{style:t+";height:unset",name:"",id:e.item_id,readonly:"true"},[Zg("pre",{style:"white-space:pre-line"},[r])]):Zg("textarea",{style:t,name:"",id:e.item_id},[r]):e.password?Zg("input",{style:t,type:"password",value:r,name:"",id:e.item_id,readonly:e.readonly?"true":null}):e.SpinEdit?Zg("input",{style:t,type:"number",value:r,name:"",id:e.item_id,readonly:e.readonly?"true":null}):Zg("input",{style:t,type:"text",value:r,name:"",id:e.item_id,readonly:e.readonly?"true":null}),this.buildWithWrapper(n||document.createDocumentFragment())}},{key:"buildListBox",value:function(e,t){}},{key:"buildView",value:function(e,t){var n=[];for(var i in e.elements)n.push(this.JSWindowToHTML(e.elements[i]));var r="js-view-component";return"align_row"===e.align_children&&(r+=" children-in-row"),Zg("div",{class:r,style:t},n)}},{key:"buildCluster",value:function(e,t){var n=[];for(var i in e.elements)n.push(this.JSWindowToHTML(e.elements[i]));var r="js-cluster-component";"align_row"===e.align_children&&(r+=" children-in-row");var o=e.name?e.name:"";return Zg("div",{class:r,style:t+"position:relative;"},[Zg("fieldset",{style:"text-align: left; border-color: gray; border-style: solid; border-width: 1px;"},[Zg("legend",{style:"background:white"},[Zg("span",{},[o=unescape(o.replace(/\\/g,"%"))])]),Zg("div",{},n)])])}},{key:"buildOkCancelOther",value:function(e,t){var n=document.createDocumentFragment(),i=this.buildButton({item_id:"jscancle",type:"button"},"",e.cancel_name?e.cancel_name:"Cancel"),r=this.buildButton({item_id:"jsok",type:"button"},"",e.ok_name?e.ok_name:"Ok"),o=this.buildButton({item_id:"jsother",type:"button"},"",e.other_name?e.other_name:"Other");if("ok"===e.type)n.appendChild(r);else if("ok_cancel"===e.type)n.appendChild(r),n.appendChild(i);else{if("ok_cancel_other"!==e.type)return n;n.appendChild(r),n.appendChild(o),n.appendChild(i)}return Zg("div",{class:"js-buttons",style:t},[n])}},{key:"JSWindowToHTML",value:function(e){e&&e.item_id&&e.type&&(this.itemMap[e.item_id]||(this.itemMap[e.item_id]={}),this.storeMap[e.item_id]||(this.storeMap[e.item_id]={}),this.storeMap[e.item_id].type=e.type,this.itemMap[e.item_id].type=e.type);var t,n=this.getElementStyle(e);switch(e.type){case"button":t=this.buildButton(e,n);break;case"check_box":t=this.buildCheckBox(e,n);break;case"radio":t=this.buildRadio(e,n);break;case"list_box":case"hier_list_box":case"popup":case"gap":break;case"static_text":t=this.buildStaticText(e,n);break;case"edit_text":t=this.buildEditText(e,n);break;case"ok":case"ok_cancel":case"ok_cancel_other":t=this.buildOkCancelOther(e,n);break;case"view":t=this.buildView(e,n);break;case"cluster":t=this.buildCluster(e,n)}return t||document.createDocumentFragment()}},{key:"buildDialogWrapper",value:function(e,t,n){return'<div id="'+e+'" class="js-window-modal modal fade bs" ><div class="js-modal-dialog modal-dialog " style="'+t+'" ><div class="modal-content "><div class="modal-header" ><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><div class="modal-title">'+n.i18n.t("viewer_:pdfjs.windowTitle")+'</div></div><div class="modal-body" ></div><div class="js-warning-footer" ><div class="js-warning" ><span >'+n.i18n.t("viewer_:pdfjs.windowWarning")+"</span></div></div></div></div></div>"}}]),e}(),ev=function(){function e(t,n){(0,P._)(this,e),this.componentUtils=new Qg,this.callback=n,this.dialogId="jsWindow",this.monitor=t,this.width=void 0,this.height=void 0,this.storeMap={},this.itemMap={},this.componentUtils.setStore(this.storeMap,this.itemMap)}return(0,A._)(e,[{key:"updateComponents",value:function(){if(this.$dialog)for(var e in this.itemMap){this.itemMap[e].disabled?this.$dialog.find("#"+e).addClass("disabled"):this.$dialog.find("#"+e).removeClass("disabled")}}},{key:"enable",value:function(e){for(var t in e){var n=e[t];this.itemMap[t]||(this.itemMap[t]={}),this.itemMap[t].disabled=!n}this.updateComponents()}},{key:"end",value:function(e){this.callback&&this.callback(e),this.$dialog&&this.$dialog.remove()}},{key:"load",value:function(e){for(var t in e){var n=e[t];this.updateStoreItem(t,n)}}},{key:"store",value:function(){if(!this.$dialog)return{};this.componentUtils.updateStoreByElements(this.monitor.description.elements,this.$dialog);var e={};for(var t in this.storeMap){var n=this.storeMap[t];e[t]=n.value}return e}},{key:"updateStoreItem",value:function(e,t){this.storeMap[e]={value:t}}},{key:"getStore",value:function(){return this.storeMap}},{key:"getCallbacks",value:function(e){var t="";for(var n in e)if("description"!==n&&"initialize"!==n&&"validate"!==n&&"commit"!==n&&"destroy"!==n){var i=e[n];"function"==typeof i&&(this.itemMap[n]||(this.itemMap[n]={}),""!==t&&(t+=","),t+="#"+n,this.itemMap[n].callback=i)}return t}},{key:"initialize",value:function(e){var t=this,n="";void 0!==this.monitor.description.width&&(this.width=this.monitor.description.width,n+="width:"+this.width+"px;"),void 0!==this.monitor.description.height&&(this.height=this.monitor.description.height,n+="min-height:"+this.height+"px;"),this.monitor.initialize(this);var i=document.createDocumentFragment();for(var r in this.monitor.description.elements)i.appendChild(this.componentUtils.JSWindowToHTML(this.monitor.description.elements[r]));var o=this.dialogId,a=this.componentUtils.buildDialogWrapper(o,n,e),s=this.getCallbacks(this.monitor),u=O()(a);return u.find(".modal-body").append(i),this.containerPromise=e.viewerUI.getRootElement().then((function(e){O()(e);return O()(document.body).append(u),O()(document.body)})),this.$dialog=u,this.updateComponents(),u.find("#jsok").off("click").on("click",(function(e){t.monitor.validate&&t.monitor.validate(t),t.monitor.commit&&t.monitor.commit(t),t.monitor.ok&&t.monitor.ok(t),t.monitor.destroy&&t.monitor.destroy(t),t.end("ok")})),u.find("#jscancle,.close").off("click").on("click",(function(e){t.monitor.cancel&&t.monitor.cancel(t),t.monitor.destroy&&t.monitor.destroy(t),t.end("cancel")})),u.find("#jsother").off("click").on("click",(function(e){t.monitor.other&&t.monitor.other(t),t.monitor.destroy&&t.monitor.destroy(t),t.end("other")})),u.find(".modal-dialog").off("click",s).on("click",s,(function(e){for(var n=e.target;!n.id;)n=n.parentElement;var i=n.id;t.itemMap[i].callback&&t.itemMap[i].callback(t)})),!0}},{key:"doModal",value:function(){var e=this;this.containerPromise&&this.containerPromise.then((function(t){t.append(e.$dialog),e.$dialog&&e.$dialog.show()}))}}]),e}();const tv=ev;var nv=function(){function e(){for(var t in(0,P._)(this,e),this)"function"==typeof this[t]&&(this[t].toString=function(){return"function(){[native code]}"})}return(0,A._)(e,[{key:"toString",value:function(){return"[object "+this.constructor.name+"]"}}],[{key:"name",get:function(){return"Object"}}]),e}(),iv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;(0,P._)(this,n),e=t.call(this);var i=arguments[0];return e.change="",e.changeEx="",e.events=[],e.init(i),e}return(0,A._)(n,[{key:"init",value:function(e){for(var t in e){var n={};n[t]=e[t],this.add(n)}}},{key:"add",value:function(e){for(var t in e)this.events[t]||(this.events[t]=[]),this.events[t]=e[t]}},{key:"dispatch",value:function(){}},{key:"remove",value:function(e){}}],[{key:"name",get:function(){return"event"}}]),n}(nv);const rv=iv;var ov=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"align",get:function(){}},{key:"canResize",get:function(){}},{key:"closeReason",get:function(){}},{key:"ifOffScreen",get:function(){}},{key:"layout",get:function(){}},{key:"monitorType",get:function(){}},{key:"openCode",get:function(){}},{key:"over",get:function(){}},{key:"pageEventNames",get:function(){}},{key:"raiseCode",get:function(){}},{key:"raiseSystem",get:function(){}},{key:"renditionType",get:function(){}},{key:"stauts",get:function(){}},{key:"trace",get:function(){}},{key:"version",get:function(){}},{key:"windowType",get:function(){}},{key:"addStockEvent",value:function(){}},{key:"alertFileNotFount",value:function(){}},{key:"alertSelectFailed",value:function(){}},{key:"argsDWIM",value:function(){}},{key:"canPlayOrAlert",value:function(){}},{key:"computerFloatWinRect",value:function(){}},{key:"constrainRectToScreen",value:function(){}},{key:"createPlayer",value:function(){}},{key:"Events",value:function(e){return new rv(e)}},{key:"getAltTextData",value:function(){}},{key:"getAltTextSettings",value:function(){}},{key:"getAnnotStockEvents",value:function(){}},{key:"getAnnotTraceEvents",value:function(){}},{key:"getPlayers",value:function(){}},{key:"getPlayerStockEvents",value:function(){}},{key:"getPlayerTraceEvents",value:function(){}},{key:"getURLData",value:function(){}},{key:"getURLSettings",value:function(){}},{key:"getWindowBorderSize",value:function(){}},{key:"openPlayer",value:function(){}},{key:"removeStockEvents",value:function(){}},{key:"startPlayer",value:function(){}}],[{key:"name",get:function(){return"AppMedia"}}]),n}(nv);const av=ov;var sv={yellow:["CMYK",0,0,1,0],white:["G",1],transparent:["T"],red:["RGB",1,0,0],magenta:["CMYK",0,1,0,0],ltGray:["G",.75],green:["RGB",0,1,0],gray:["G",.5],dkGray:["G",.25],cyan:["CMYK",1,0,0,0],blue:["RGB",0,0,1],black:["G",0],equal:function(e,t){},convert:function(e,t){var n,i,r;if(t==e[0])return[].concat(e);switch(e[0]){case"T":n=-1,i=-1,r=-1;break;case"G":n=i=r=e[1];break;case"RGB":n=e[1],i=e[2],r=e[3];break;case"CMYK":n=(1-e[4])*(1-e[1]),i=(1-e[4])*(1-e[2]),r=(1-e[4])*(1-e[3])}switch(t){case"T":return;case"G":return["G",(n+r+i)/3];case"RGB":return["RGB",n,i,r];case"CMYK":var o=1-n,a=1-i,s=1-r,u=Math.min(Math.min(o,a),s);return 0!=u?(temp2=Math.round(rep_v/100*u),Math.round(100*temp2),Math.round(100*(o-temp2)),Math.round(100*(a-temp2)),Math.round(100*(s-temp2))):(Math.round(100*o),Math.round(100*a),Math.round(100*s),0),["CMYK",n,i,r]}}};const uv=sv;var cv=2,lv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this))._backgroudColor=uv.yellow,o._clickAdvances=!1,o._isFullScreen=!0,o._cursor=cv,o._defaultTransition="",o._escapeExits=!1,o._loop=!1,o._timedelay=3,o._transitions="",o._usePageTiming=!1,o._useTimer=!1,o}return(0,A._)(n,[{key:"backgroudColor",get:function(){return this._backgroudColor},set:function(e){}},{key:"clickAdvances",get:function(){return this._clickAdvances},set:function(e){}},{key:"cursor",get:function(){return this._cursor},set:function(e){}},{key:"defaultTransition",get:function(){return this._defaultTransition},set:function(e){}},{key:"escapeExits",get:function(){return this._escapeExits},set:function(e){}},{key:"isFullScreen",get:function(){return this._isFullScreen},set:function(e){this._isFullScreen=e}},{key:"loop",get:function(){return this._loop},set:function(e){}},{key:"timedelay",get:function(){return this._timedelay},set:function(e){}},{key:"transitions",get:function(){return this._transitions},set:function(e){}},{key:"usePageTiming",get:function(){return this._usePageTiming},set:function(e){}},{key:"useTimer",get:function(){return this._useTimer},set:function(e){}}]),n}(nv);const dv=lv;var hv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).jsEngine=e,r.viewerApp=i,r._calculate=!0,r._fullscreen=!0,r._fs=new dv,r.dialogQueue=Promise.resolve(),r.viewerApp.eventEmitter.on("will-close-document",(function(){r.modalDialog&&r.modalDialog.end("cancel")})),r}return(0,A._)(n,[{key:"activeDocs",get:function(){return[this.jsEngine.cacheJSDoc]}},{key:"calculate",get:function(){var e=this.jsEngine.getPDFForm();return!e||e.calculationEnabled},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this._calculate=e,this.viewerApp.setAutoCalculateFieldsFlag(e)}},{key:"constants",get:function(){return{algin:{left:0,center:1,right:2,top:3,bottom:4}}}},{key:"focusRect",get:function(){return this._focusRect},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this._focusRect=e}},{key:"formsVersion",get:function(){return 7}},{key:"fullscreen",get:function(){return this._fullscreen},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this._fullscreen=e}},{key:"fs",get:function(){return this._fs}},{key:"runtimeHighlight",get:function(){return this.viewerApp.highlightControls()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this.viewerApp.highlightForm(e)}},{key:"runtimeHighlightColor",get:function(){return this.viewerApp.getDisplayHighlightColor(this.viewerApp._runtimeColor,this.viewerApp._runtimeColorOpacity,"RGB")},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this.viewerApp.setFormHighlightColor(e)}},{key:"viewerVersion",get:function(){return 7}},{key:"viewerType",get:function(){return"Exchange-Pro"}},{key:"viewerVariation",get:function(){return"Business Tools"}},{key:"printerNames",get:function(){return["Web Printer"]}},{key:"platform",get:function(){var e=window.navigator.platform,t=null;return-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(e)?t="MAC":-1!==["Win32","Win64","Windows","WinCE"].indexOf(e)?t="WIN":!t&&/Linux/.test(e)&&(t="UNIX"),t}},{key:"language",get:function(){var e,t=navigator.language||navigator.userLanguage;return[{language:"zh-CN",code:"CHS"},{language:"zh-HK",code:"CHT"},{language:"zh-TW",code:"CHT"},{language:"da",code:"DAN"},{language:"de",code:"DEU"},{language:"en",code:"ENU"},{language:"es",code:"ESP"},{language:"fr",code:"FRA"},{language:"it",code:"ITA"},{language:"ko",code:"KOR"},{language:"ja",code:"JPN"},{language:"nl",code:"NLD"},{language:"nb",code:"NOR"},{language:"pt-BR",code:"PTB"},{language:"fi",code:"SUO"},{language:"sv",code:"SVE"}].some((function(n){t.indexOf(n.language)>-1&&(e=n.code)})),e}},{key:"numPlugIns",get:function(){return 2}},{key:"plugIns",get:function(){return[{name:"Annots",certified:!0,loaded:!0,path:"",version:7},{name:"Forms",certified:!0,loaded:!0,path:"",version:7}]}},{key:"media",get:function(){return new av(this.jsEngine)}},{key:"popUpMenu",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=this.viewerApp.i18n.t("viewer_:pdfjs.popupMenu"),r={},o=function(e){var t=1;return function(n){var a,s=Object.prototype.toString.call(n);if(s.indexOf("String")>-1&&"-"!==n)a=void 0!==e?"".concat(e,"-").concat(t):String(t),i+="".concat(a,". ").concat(n," \n"),r[a.trim()]=n,t++;else if(s.indexOf("Array")>-1){var u;u=e?"".concat(e,"-").concat(t):String(t),i+="".concat(u,". ").concat(n[0]," \n"),r[u.trim()]=n[0],void 0!==e?n.slice(1).forEach(o("  ".concat(e,"-").concat(t))):n.slice(1).forEach(o("  ".concat(t))),t++}}};t.forEach(o());var a=prompt(i,"");if(null===a)return null;for(var s in r)if(r.hasOwnProperty(s)&&a.trim()===s)return r[s]}},{key:"response",value:function(e){var t=e.cQuestion,n=(e.cTitle,e.cDefault);e.bPassword,e.cLabel;return window.prompt(t,n||"")}},{key:"beep",value:function(e){var t;switch(e){case 0:default:t="error";break;case 1:t="warning"}var n=new Audio(Xg[t]);n.addEventListener("load",(function(){n.play()}),!0),n.autoplay=!0}},{key:"alert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.jsEngine.getEvent().isSensitiveCheck&&!this.jsEngine.getEvent().isLoading){var i=this.jsEngine.getEvent();if(!i.isSensitiveCheck&&!i.isLoading){var r,o;e&&e.nType;switch(r=n,e&&void 0!==e.nType&&(r=e.nType),o=null==e?"undefined":function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e)?e.cMsg+"":e+"",r){default:case 0:return alert(o),0;case 1:return confirm(o)?1:2;case 2:case 3:return confirm(o)?4:3}}}}},{key:"alertAsync",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.alert.apply(this,t)}},{key:"clearInterval",value:function(e){clearInterval(e)}},{key:"clearTimerOut",value:function(e){clearTimeout(e)}},{key:"launchURL",value:function(e){if(this.jsEngine.getEvent().isSensitiveCheck||this.jsEngine.getEvent().isLoading)this.jsEngine.sensitiveOp=!0;else{if(/\w*:\/\/[\s\S]*/.test(e)){if("file"===e.match(/(\w*):\/+[\s\S]*/)[0])return}else e="http://"+e;var t=e.lastIndexOf("@"),n=e;if(-1!=t){n=e.substr(t+1);var i=e.indexOf("//");-1!=i&&(n=e.substr(0,i+2)+n)}var r=this.viewerApp,o=JSON.parse(localStorage.getItem("TRUST_SITE_SET"))||{},a=o.siteList,s=void 0===a?[]:a,u=o.siteRight,c=void 0===u?"always":u,l=o.type,d=void 0===l?"custom":l,h=r.i18n.t("viewer_:pdfjs.launchURLHint"),f=r.i18n.t("viewer_:pdfjs.blockTip");if("custom"===d){var g=s.find((function(e){return n.includes(e.url)}));if(g)return"allow"===(""+g.access.split(" ")[1]).toLowerCase()?window.open(n):r.viewerUI.alert({message:"".concat(f,"\n").concat(Eg.toASCII(n)),level:"warning"});if("always"===c)return r.viewerUI.confirm(h+"\n"+Eg.toASCII(n)).then((function(){window.open(e)}),(function(){}));if("allow"===c)return window.open(n);if("block"===c)return r.viewerUI.alert({message:"".concat(f,"\n").concat(Eg.toASCII(n)),level:"warning"})}else{if("allow"===d)return window.open(n);if("block"===d)return r.viewerUI.alert({message:"".concat(f,"\n").concat(Eg.toASCII(n)),level:"warning"})}}}},{key:"_execDialog",value:function(e){var t=this;return new Promise((function(n,i){var r=new tv(e,(function(e){n(e)}));t.modalDialog=r,r.initialize(t.jsEngine.PDFViewer),r.doModal()}))}},{key:"execDialog",value:function(e,t,n){return this._execDialog(e,t,n)}},{key:"execMenuItem",value:function(){}},{key:"setInterval",value:function(e,t){return setInterval(window.eval(e),t)}},{key:"setTimeOut",value:function(e,t){var n=this;return setTimeout((function(t){return n.jsEngine.exec(e)}),t)}}],[{key:"name",get:function(){return"app"}}]),n}(nv),fv=new j.QueuedAsyncTaskExecutor;const gv=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("function"!=typeof e)return Promise.resolve();if(t)return Promise.resolve(e());var n=fv.exec(e);return n.catch((function(e){return console.error(e)})),n};const vv={always:0,never:1,tooBig:2,tooSmall:3};function pv(e){var t;if(e)for(var n=0;n<e.getControlsCount();n++)if(t=e.getControlByIndex(n).getWidget())return t;return t}function mv(e,t,n,i){if(e)return e[n].apply(e,i);t&&t.length>0&&t.forEach((function(e){return e[n].apply(e,i)}))}var yv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this)).jsEngine=e,o.field=i,o.fields=r,o.targetField=o.field||o.fields[0],o._readonly="",o._required="",o._value="",o}return(0,A._)(n,[{key:"destroy",value:function(){this.fields=null,this.field=null,this.targetField=null,this.jsEngine=null}},{key:"_update",value:function(e,t){this.field=e,this.fields=t,this.targetField=this.field||this.fields[0]}},{key:"alignment",get:function(){if(!this.targetField)return"";switch(this.targetField.getAlignment()){case 0:return"left";case 1:return"center";case 2:return"right"}},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck){var t=0;switch(e){case"left":t=0;break;case"center":t=1;break;case"right":t=2}return mv(this.field,this.fields,"setAlignmentWithString",[t,e]),e}}},{key:"borderStyle",get:function(){return this.targetField&&this.targetField.getBorderStyle()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setBorderStyle",[e]),e}},{key:"charLimit",get:function(){return this.targetField&&this.targetField.getMaxLength()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setMaxLength",[e]),e}},{key:"comb",get:function(){return!!vn.isComb(this.targetField&&this.targetField.getFlags())},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setComb",[e]),e}},{key:"currentValueIndices",get:function(){return this.targetField&&this.targetField.getValueIndex()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setValueByIndex",[e]),e}},{key:"defaultValue",get:function(){return this.targetField&&this.targetField.getDefaultValue()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setDefaultValue",[e]),e}},{key:"display",get:function(){var e=pv(this.targetField).getFlags();return 2&e?1:4&e?32&e?3:0:2},set:function(e){return mv(this.field,this.fields,"setWidgetDisplay",[e]),e}},{key:"exportValues",get:function(){return this.targetField&&this.targetField.getExportValues()},set:function(e){var t=this;if(!this.jsEngine.getEvent().isSensitiveCheck){if(this.field.getType()===gn.RadioButton||this.field.getType()===gn.CheckBox){for(var n=function(n){e[n];gv((function(i){return mv(t.field,t.fields,"setExportValue",[n,e[n]])}))},i=this.field.getControlsCount(),r=0;r<i;r++)n(r);return this.field.getExportValues()}throw"invalid field type: only radio buttons and check boxes available."}}},{key:"fillColor",get:function(){var e=pv(this.targetField).getMKProperty("fillColor");return["RGB",e>>16&1,e>>8&1,1&e]},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return null==e&&(e=0),mv(this.field,this.fields,"setFillColor",[e]),e}},{key:"hidden",get:function(){var e=pv(this.targetField).getFlags();return!!(2&e||1&e)},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setHidden",[e]),e}},{key:"highlight",get:function(){},set:function(e){this.jsEngine.getEvent().isSensitiveCheck}},{key:"lineWidth",get:function(){},set:function(e){this.jsEngine.getEvent().isSensitiveCheck}},{key:"multiline",get:function(){return!!vn.isMultiline(this.targetField&&this.targetField.getFlags())},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setMultiline",[e]),e}},{key:"name",get:function(){return this.targetField&&this.targetField.getName()}},{key:"numItems",get:function(){if(!this.targetField)return 0;if(this.targetField.getType()===gn.ListBox||this.targetField.getType()===gn.ComboBox)return this.targetField.getOptions().length;throw new Error("invalid field type: only list box and combo box available.")}},{key:"password",get:function(){return!!vn.isPassword(this.targetField&&this.targetField.getFlags())},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setPassword",[e]),e}},{key:"print",get:function(){},set:function(e){this.jsEngine.getEvent().isSensitiveCheck}},{key:"radiosInUnison",get:function(){},set:function(e){this.jsEngine.getEvent().isSensitiveCheck}},{key:"readonly",get:function(){return!!vn.isReadOnly(this.targetField&&this.targetField.getFlags())},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setReadonly",[e]),e}},{key:"required",get:function(){return!!vn.isRequired(this.targetField&&this.targetField.getFlags())},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setRequired",[e]),e}},{key:"type",get:function(){if(!this.targetField)return"unknown";switch(this.targetField.getType()){default:case 0:return"unknown";case 1:return"button";case 2:return"checkbox";case 4:return"combobox";case 5:return"listbox";case 3:return"radiobutton";case 7:return"signature";case 6:return"text"}}},{key:"value",get:function(){if(this.targetField){var e=this.targetField.getValue();return""==e?"":isNaN(e)?e:+e}},set:function(e){var t=this;if(!this.jsEngine.getEvent().isSensitiveCheck&&this.targetField){var n,i=this.jsEngine.PDFViewer.getPDFDocRender().formRender.control,r=this.targetField.getType();if(Array.isArray(e)&&r!=gn.ListBox&&(e=e.join(",")),r===gn.ListBox||r===gn.ComboBox){var o=this.field.getOptions();o.forEach((function(t){t.selected=t.value==e,Array.isArray(e)&&-1!=e.indexOf(t.value)&&(t.selected=!0)})),this.field.setOptions(o)}e:if(!i||!(n=i.annot.getField())||!this.field||this.field.getName()!==n.getName()){mv(this.field,this.fields,"setValue",[e]);var a=this.field?this.field.form:this.fields&&this.fields[0]?this.fields[0].form:void 0;if(!a)break e;a.tempTimer&&(clearTimeout(a.tempTimer),delete a.tempTimer),a.tempTimer=setTimeout((function(){a.calculate(t.field),clearTimeout(a.tempTimer),delete a.tempTimer}),0)}return r!==gn.RadioButton&&r!==gn.CheckBox||this.jsEngine.setStatus("calculate",this.targetField),e}}},{key:"valueAsString",get:function(){return this.targetField?this.targetField.getValue().toString():""}},{key:"strokeColor",get:function(){var e=this.targetField.getBorderColor();return["RGB",e>>16&1,e>>8&1,1&e]},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return mv(this.field,this.fields,"setBorderColor",[e]),e}},{key:"textColor",get:function(){var e=this.targetField&&this.targetField.getDAFontColor();return["RGB",e>>16&1,e>>8&1,1&e]},set:function(e){return mv(this.field,this.fields,"setDAFontColor",[e]),e}},{key:"userName",get:function(){return this.PDFFieldgetAlternateName()},set:function(e){if(this.field)return this.field.update("alternateName",e);this.fields.forEach((function(t){t.update("alternateName",e)}))}},{key:"rect",get:function(){var e,t=pv(this.targetField);return[(e=t?t.getRect():this.targetField.rect).left,e.top,e.right,e.bottom]},set:function(e){if(Array.isArray(e)&&!(e.length<4)){if(e[0]>e[2]){var t=e[0];e[0]=e[2],e[2]=t}if(e[3]>e[1]){var n=e[3];e[3]=e[1],e[1]=n}mv(this.field,this.fields,"setRect",[{left:e[0],top:e[1],right:e[2],bottom:e[3]}])}}},{key:"style",get:function(){return pv(this.targetField).getMKProperty("normalCaption")},set:function(e){switch(e){case"check":e="4";break;case"cross":e="8";break;case"diamond":e="u";break;case"circle":e="l";break;case"star":e="H";break;case"square":e="n"}return mv(this.field,this.fields,"setMKProperty",["normalCaption",e])}},{key:"buttonScaleWhen",get:function(){if(this.targetField&&this.targetField.getType()===gn.PushButton){var e=0;switch(pv(this.targetField).info.iconFit.scaleWayType){case 1:e=0;break;case 4:e=1;break;case 2:e=2;break;case 3:e=3}return e}},set:function(e){if(this.targetField&&this.targetField.getType()===gn.PushButton){var t,n=pv(this.targetField),i=n.info.iconFit;switch(e){case vv.always:t="e_ScaleWayAlways",i.scaleWayType=1;break;case vv.never:t="e_ScaleWayNever",i.scaleWayType=4;break;case vv.tooBig:t="e_ScaleWayBigger",i.scaleWayType=2;break;case vv.tooSmall:t="e_ScaleWaySmaller",i.scaleWayType=3;break;default:t="e_ScaleWayAlways",i.scaleWayType=1}var r={scale_way_type:t,is_proportional_scaling:i.isProportionalScaling+"",fit_bounds:i.fitBounds,horizontal_fraction:(100*i.horizontalFraction).toFixed(0),vertical_fraction:(100*i.verticalFraction).toFixed(0)};gv((function(e){n.setWidgetIconFitOption(r)}))}}},{key:"setItems",value:function(e){if(Array.isArray(e))return mv(this.field,this.fields,"setItems",[e]),e}},{key:"buttonGetIcon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=pv(this.targetField)&&pv(this.targetField).getIconObjNum(e);return"number"==typeof t?{_objNum:t}:t}},{key:"buttonSetIcon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;mv(this.field,this.fields,"setIconObj",[e,t])}},{key:"browseForFileToSubmit",value:function(){}},{key:"buttonGetCaption",value:function(e){switch(e||(e=0),e){case 0:e="normalCaption";break;case 1:e="downCaption";break;case 2:e="rolloverCaption"}return pv(this.targetField).getMKProperty(e)}},{key:"buttonImportIcon",value:function(e,t){var n=this,i=this;return new Promise((function(e){n.$jsBrowserFile&&n.$jsBrowserFile.remove(),n.$jsBrowserFile=O()('<input id="jsBrowserFile" type="file" style="display: block;visibility:hidden" accept="image/jpg,image/jpeg,image/bmp,image/png"/>'),O()("body").append(n.$jsBrowserFile),n.$jsBrowserFile.off("change").on("change",(function(t){var n=t.target.files[0];if(!n)return-2;var r=new FileReader;r.readAsArrayBuffer(n),r.onload=function(){var t=new Uint8Array(r.result);i.buttonSetIcon(t,0),e(0)}})),n.$jsBrowserFile.click()}))}},{key:"buttonSetCaption",value:function(e,t){if(!this.jsEngine.getEvent().isSensitiveCheck){switch(t||(t=0),Array.isArray(e)&&1===e.length&&(e=e[0]),"string"!=typeof e&&(e+=""),t){case 0:t="normalCaption";break;case 1:t="downCaption";break;case 2:t="rolloverCaption"}pv(this.targetField)._setMKProperty(t,e),mv(this.field,this.fields,"setMKProperty",[t,e])}}},{key:"checkThisBox",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.jsEngine.getEvent().isSensitiveCheck){var n=this.field;if(n.getType()===gn.RadioButton||n.getType()===gn.CheckBox){var i=n.getWidget(e);if(!i)return n.getControlByIndex(e).getWidgetAnnot().then((function(e){return r(e)}));r(i)}}function r(e){var i=e.getOnAS();t?(e._setAS(i,e.info.objectNumber),n.setValue(i,e)):n.getValue()===i&&(e._setAS("off",e.controls[0].info.objectNumber),n.setValue("Off",null,!0))}}},{key:"clearItems",value:function(){this.jsEngine.getEvent().isSensitiveCheck||mv(this.field,this.fields,"clearItems",[])}},{key:"defaultIsChecked",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.jsEngine.getEvent().isSensitiveCheck&&this.targetField&&(this.targetField.getType()===gn.RadioButton||this.targetField.getType()===gn.CheckBox)){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e&&e.getControlByIndex(t).getWidget()}(this.targetField,e),i="Off";t&&(i=n?n.getOnAS():"Yes"),mv(this.field,this.fields,"setDefaultValue",[i]),mv(this.field,this.fields,"setValue",[i])}}},{key:"deleteItemAt",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.field.getValueIndex();if(!this.jsEngine.getEvent().isSensitiveCheck){if("number"!=typeof e&&(e=parseInt(e)),void 0===e)throw new Error("invalid parameter, expected integer.");mv(this.field,this.fields,"deleteItems",[e])}}},{key:"getArray",value:function(){}},{key:"getItemAt",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("number"!=typeof e&&(e=parseInt(e)),void 0===e)throw new Error("invalid parameter, expected integer.");var n=this.targetField;if(n.getType()===gn.ListBox||n.getType()===gn.ComboBox){var i=n.getOptions();-1===e&&(e=i.length-1);var r=i[e];return t?r.value:r.label}return""}},{key:"insertItemAt",value:function(e,t,n){if(!this.jsEngine.getEvent().isSensitiveCheck&&this.targetField){var i=this.targetField;i.getType()!==gn.ListBox&&i.getType()!==gn.ComboBox||mv(this.field,this.fields,"insertItemAt",[e,t,n])}}},{key:"isBoxChecked",value:function(e){if(!this.targetField)return!1;var t=this.targetField;if(t.getType()===gn.RadioButton||t.getType()===gn.CheckBox){var n=t.getWidget(e);if(n)return"Off"!=n.getAS()}return!1}},{key:"isDefaultChecked",value:function(e){if(!this.targetField)return!1;var t=this.targetField;if(t.getType()===gn.RadioButton||t.getType()===gn.CheckBox){var n=t.getWidget(e);if(n){var i=n.getOnAS();return i===t.getDefaultValue()||"1"===i}if(n=t.getControlByIndex(e))return n.info.isDefaultChecked}return!1}},{key:"setAction",value:function(e,t){mv(this.field,this.fields,"setAction",[-1,t])}},{key:"setFocus",value:function(){var e=this;if(this.targetField){var t=function(e){var t=e.page.info.index,o=function(e){e.page.getIndex()==t&&(n.focus(),i.off(de.renderPageSuccess,o))};i.on(de.renderPageSuccess,o),r.PDFViewer.goToPage(t)},n=this.targetField,i=this.jsEngine.PDFViewer.getEventEmitter(),r=this.jsEngine,o=this.targetField.controls[0].getWidget();if(o)this.jsEngine.PDFViewer.getPDFDocRender().getCurrentPageIndex()==o.getPage().getIndex()?this.targetField.focus():t(o);else gv((function(n){return e.targetField.controls[0].getWidgetAnnot().then((function(e){e&&t(e)}))}))}}}],[{key:"name",get:function(){return"Field"}}]),n}(nv);const kv=yv;const bv=function(){function e(t,n){(0,P._)(this,e),this.jsEngine=t,this.doc=n,this.params={}}return(0,A._)(e,[{key:"printerName",get:function(){return"Web Printer"},set:function(e){}},{key:"firstPage",get:function(){return void 0!==this.params.firstPage?this.params.firstPage:0},set:function(e){this.params.firstPage=e}},{key:"lastPage",get:function(){return void 0!==this.params.lastPage?this.params.lastPage:this.doc.numPages},set:function(e){this.params.lastPage=e}},{key:"pageHandling",get:function(){return void 0!==this.params.pageHandling?this.params.pageHandling:3},set:function(e){this.params.pageHandling=e}},{key:"constants",get:function(){return{interactionLevel:{automatic:1,full:0,silent:2},handling:{none:1,fit:2,shrink:3,tileAll:4,tileLarge:5,nUp:6,booklet:7},flagValues:{applyOverPrint:131072,applySoftProofSettings:2097152,applyWorkingColorSpaces:262144,emitHalftones:1,emitPostScriptXObjects:524288,emitFormsAsPSForms:4194304,maxJP2KRes:8388608,setPageSize:1024,suppressBG:16,suppressCenter:256,suppressCJKFontSubst:64,suppressCropClip:4,suppressRotate:128,suppressTransfer:8,suppressUCR:32,useTrapAnnots:16777216,usePrintersMarks:33554432},bookletBindings:{Left:0,Right:1,LeftTall:2,RightTall:3},bookletDuplexMode:{BothSides:0,FrontSideOnly:1,BackSideOnly:2},colorOverrides:{auto:0,gray:1,mono:2},fontPolicies:{everyPage:2,jobStart:0,pageRange:1},nUpPageOrders:{Horizontal:0,HorizontalReversed:1,Vertical:2},printContents:{doc:0,docAndComments:1,formFieldsOnly:3},rasterFlagValues:{textToOutline:1,strokesToOutline:2,allowComplexClip:4,preserveOverprint:8},subsets:{all:-3,even:-5,odd:-4},tileMarks:{none:0,west:1,east:2},usages:{auto:0,use:1,noUse:2},duplexTypes:{Simplex:0,DuplexFlipLongEdge:1,DuplexFlipShortEdge:2}}}},{key:"flags",get:function(){return void 0!==this.params.flags?this.params.flags:0},set:function(e){this.params.flags=e}},{key:"interactive",get:function(){return void 0!==this.params.interactive?this.params.interactive:0},set:function(e){this.params.interactive=e}},{key:"fileName",get:function(){return void 0!==this.params.fileName?this.params.fileName:""},set:function(e){this.params.fileName=e}}]),e}();var wv=function(){function e(t,n,i){(0,P._)(this,e),this.templateObject=t,this.templateHidden=n,this.pdfDoc=i}return(0,A._)(e,[{key:"hidden",get:function(){return this.templateHidden},set:function(e){if(e!==this.templateHidden)return this.pdfDoc?this.pdfDoc.hideTemplate(this.templateObject,e):void 0}},{key:"name",get:function(){return this.templateObject.name}},{key:"spawn",value:function(e,t,n,i){if(this.pdfDoc){if("object"==typeof e){var r=e;e=r.nPage,t=r.bRename,n=r.bOverlay,i=r.oXObject}return i&&"object"==typeof i&&(this.pdfDoc=i.pdfDoc,this.templateObject=i.templateObject,this.templateHidden=i.templateHidden),null==e&&(e=-1),t=!1!==t,n=!0,this.pdfDoc.spawnPage(this.templateObject,e,t,n),this}}}]),e}(),_v={},Pv=function(e){e?delete _v[e]:_v={}},Av=function(e){return _v[e]||[]},Sv="R",xv="Group",Cv=function(){function e(t,n,i){(0,P._)(this,e),this.delayValue=!1,this.annot=t,this.annotData=n,this.app=i}return(0,A._)(e,[{key:"_delayOrExec",value:function(e){if(!this.delay)return e();var t,n,i;t=this.annot.getId(),n=e,(i=Av(t)).push(n),_v[t]=i}},{key:"type",get:function(){return"Annotation"}},{key:"component",get:function(){return this.app.viewerApp.getPDFPageRender(this.annotData.page).annotsRender.getAnnotRender(this.name).component}},{key:"author",get:function(){return this.annot?this.annot.getTitle():this.annotData.author},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){return t.annot.setTitle(e)}))}))}},{key:"borderEffectIntensity",get:function(){return this.annot?this.annot.getCloudIntensity():this.annotData.borderEffectIntensity},set:function(e){var t=this;this.annot&&(this.annot.info.borderInfo.cloudIntensity=e),gv((function(n){return t._delayOrExec((function(){return t.annot.setBorderStyle(5,e)}))}))}},{key:"borderEffectStyle",get:function(){return this.annot?5===this.annot.getBorderStyle()?"C":"":this.annotData.borderEffectStyle},set:function(e){var t=this;if(""!==e&&"C"!==e)throw new TypeError('effectStyle either empty string or "C"');this.annot&&(this.annot.info.borderInfo.style="C"===e?5:0),gv((function(n){return t._delayOrExec((function(){return"C"===e?t.annot.setBorderStyle(5,1):t.annot.setBorderStyle(0,[])}))}))}},{key:"contents",get:function(){return this.annot?this.annot.getContent():this.annotData.contents},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){return t.annot.setContent(e)}))}))}},{key:"creationDate",get:function(){return this.annot?this.annot.getCreateDateTime():this.annotData.creationDate}},{key:"delay",get:function(){return this.delayValue},set:function(e){if(!1===e){this.delayValue=!1;var t=this.annot.getId();Av(t).forEach((function(e){e&&e()})),Pv(t)}else!0===e&&(this.delayValue=!0)}},{key:"doc",get:function(){return this.app.jsEngine.jsEnv.globalVariables.doc}},{key:"hidden",get:function(){return this.annot?2==(2&this.annot.getFlags()):this.annotData.hidden||!1},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=2:n&=-3,t.annot.setFlags(n)}))}))}},{key:"inReplyTo",get:function(){if(!this.annot)return this.annotData.inReplyTo;var e=this.annot.info.IRT;if(e&&"R"===this.annot.info.RT){var t=this.annot.page.annots.find((function(t){return t.getId()==e}));t&&(e=t.getName())}else e="";return e},set:function(e){var t=this;gv((function(n){t._delayOrExec((function(){t.annot.info.IRT=e}))}))}},{key:"intent",get:function(){return this.annot?this.annot.getIntent():this.annotData.intent},set:function(e){var t=this;this.annot&&(this.annot.info.intent=e),gv((function(n){return t._delayOrExec((function(){return t.annot.setIntent(e)}))}))}},{key:"lock",get:function(){return this.annot?128==(128&this.annot.getFlags()):this.annotData.lock||!1},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=128:n&=-129,t.annot.setFlags(n)}))}))}},{key:"modDate",get:function(){return this.annot?this.annot.getModifiedDateTime():this.annotData.modDate},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){return t.annot.setModifiedDateTime(e)}))}))}},{key:"name",get:function(){return this.annot?this.annot.getName():this.annotData.name},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){return t.annot.setUniqueID(e)}))}))}},{key:"noView",get:function(){return this.annot?32==(32&this.annot.getFlags()):this.annotData.noView||!1},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=32:n&=-33,t.annot.setFlags(n)}))}))}},{key:"opacity",get:function(){return this.annot?this.annot.getOpacity():this.annotData.opacity||1},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){if(Object.prototype.toString.call(e).indexOf("Number")<0)throw new Error("only accept Number");if(e<0||e>1)throw new Error("opacity range: 0 - 1");return t.annot.setOpacity(e)}))}))}},{key:"page",get:function(){return this.annot?this.annot.getPage().getIndex():this.annotData.page},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){var n=t.annot.getPage().getIndex();if(e!=n){var i=t.app.viewerApp.getPDFPageRender(n).annotsRender.getAnnotRender(t.name).component;t.app.viewerApp.getPDFPageRender(e).getPDFPage().then((function(e){return t.moveAnnot([i],t.annot.getPage(),e)}))}}))}))}},{key:"print",get:function(){return this.annot?4==(4&this.annot.getFlags()):this.annotData.print||!1},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=4:n&=-5,t.annot.setFlags(n)}))}))}},{key:"rect",get:function(){if(!this.annot)return this.annotData.rect;var e=this.annot.getRect(),t=e.left,n=e.right,i=e.top;return[t,e.bottom,n,i]},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){if(!Array.isArray(e))throw new Error("only accept Array");return t.annot.setRect({left:e[0],right:e[2],top:e[3],bottom:e[1]})}))}))}},{key:"readOnly",get:function(){return this.annot?64==(64&this.annot.getFlags()):this.annotData.readOnly||!1},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=64:n&=-65,t.annot.setFlags(n)}))}))}},{key:"refType",get:function(){if(!this.annot)return this.annotData.refType;this.annot.info.RT},set:function(e){var t=this;gv((function(n){t._delayOrExec((function(){if(e!==Sv&&e!==xv)throw new TypeError('refType should be "R" or "Group"');t.annot.info.RT=e}))}))}},{key:"richContents",get:function(){},set:function(e){}},{key:"seqNum",get:function(){return this.annot?this.annot.info.index:0}},{key:"strokeColor",get:function(){return this.annot?this.annot.info.hasBorderColor?(0,j.convertFromNumberToJSColor)(this.annot.info.borderColor):["T"]:this.annotData.strokeColor},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){var n=(0,j.colorConvertor)(e,"int",t.annot.getOpacity());return t.annot.setBorderColor(n)}))}))}},{key:"style",get:function(){return this.annot?this.annot.getBorderStyle():this.annotData.style},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){var n=0,i=0;return"D"==e&&(n=1,i=[3]),t.annot.setBorderStyle(n,i)}))}))}},{key:"subject",get:function(){return this.annot?this.annot.getSubject():this.annotData.subject},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){return t.annot.setSubject(e)}))}))}},{key:"toggleNoView",get:function(){return this.annot?256==(256&this.annot.getFlags()):this.annotData.toggleNoView},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){var n=t.annot.getFlags();return e?n|=256:n&=-257,t.annot.setFlags(n)}))}))}},{key:"popupOpen",get:function(){if("freetext"!==this.type&&"sound"!==this.type&&"fileattachment"!==this.type)return this.annot?this.annot.getPopup().getOpenStatus():this.annotData.popupOpen},set:function(e){var t=this;"freetext"!==this.type&&"sound"!==this.type&&"fileattachment"!==this.type&&gv((function(n){return t._delayOrExec((function(){return t.annot.getPopup().setOpenStatus(e).then((function(){e&&t.component.showReplyDialog("comment")}))}))}))}},{key:"popupRect",get:function(){if("freetext"!==this.type&&"sound"!==this.type&&"fileattachment"!==this.type){if(!this.annot)return this.annotData.popupRect;var e=this.annot.getPopup().getRect(),t=e.left,n=e.right,i=e.top;return[t,e.bottom,n,i]}},set:function(e){var t=this;"freetext"!==this.type&&"sound"!==this.type&&"fileattachment"!==this.type&&gv((function(n){return t._delayOrExec((function(){if(!Array.isArray(e))throw new Error("only accept Array");return t.annot.getPopup().setRect({left:e[0],right:e[2],top:e[3],bottom:e[1]})}))}))}},{key:"destroy",value:function(){var e=this;this.annot&&this.annot.getPage().removeAnnotByObjectNumber(this.annot.getId()).then((function(){Pv(e.annot.getId()),e.annot=null}))}},{key:"getProps",value:function(){var e=this,t={},n=[],i=Object.getOwnPropertyNames(this.constructor.prototype),r=this;return i.map((function(t){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);i&&!i.get||n.push(t)})),Object.getOwnPropertyNames(this.constructor.prototype.__proto__.__proto__).map((function(t){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype.__proto__.__proto__,t);i&&!i.get||n.push(t)})),console.log("key:",n),n.map((function(e){var n=r[e];void 0!==n?(t[e]=n,console.log("this."+e+"=",t[e])):console.log("this."+e+'="undefined"')})),t}},{key:"setProps",value:function(e){var t=this,n=[],i=this;Object.getOwnPropertyNames(this.constructor.prototype).map((function(e){var i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e);i&&!i.set||n.push(e)}));var r=Object.getOwnPropertyNames(this.constructor.prototype.__proto__.__proto__);for(var o in r.map((function(e){var i=Object.getOwnPropertyDescriptor(t.constructor.prototype.__proto__.__proto__,e);i&&!i.set||n.push(e)})),i.delay=!0,e)i[o]=e[o],console.log("this."+o+"=",e[o]);i.delay=!1}},{key:"getStateInModel",value:function(e){if(this.annot&&"text"===this.annot.info.type)return"Marked"===e?[this.annot.getMarkedState(0)]:"Review"===e?[this.annot.getReviewState(0)]:void 0}},{key:"moveAnnot",value:function(e,t,n){var i=this,r=t.getIndex(),o=n.getIndex(),a=t.doc,s=e.reduce((function(e,t){return t.getRelevanceRenders?(0,I._)(e).concat((0,I._)(t.getRelevanceRenders(!0))):(0,I._)(e).concat([t.annot.getId()])}),[]).reduce((function(e,n){var i=t.annotIdMap[n],r={},o={};return"popup"!==i.getType()&&(o=r="FreeTextCallout"==i.getIntent()?annotRender.backupProperty.rect:i.getRect()),e[n]={rect:o,oldRect:r},e}),{}),u=Object.keys(s).map((function(e){return Number(e)}));return t.getAnnotsByObjectNumArray(u).then((function(e){var u=e.reduce((function(e,t){return e[t.getUniqueID()]=s[t.getObjectNumber()],e}),{});return a.moveAnnotsToPage(t,n,s).then((function(e){return i.app.viewerApp.collaborate(yo.MOVE_ANNOTS_BETWEEN_PAGES,{fromPageIndex:r,toPageIndex:o,annots:u}),e}))}))}}]),e}(),Dv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return n}(Cv);const Ev=Dv;var Iv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Caret"}},{key:"caretSymbol",get:function(){},set:function(e){}}]),n}(Ev);const Rv=Iv;var Tv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Circle"}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getFillColor();return(0,j.convertFromNumberToJSColor)(e)},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=(0,j.colorConvertor)(e,"int",0);return t.annot.setFillColor(n)}))}))}},{key:"width",get:function(){return this.annot?this.annot.getBorderWidth():this.annotData.width},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setBorderWidth(e)}))}))}}]),n}(Ev),Fv={Paperclip:"Paperclip",PushPin:"PushPin",Graph:"Graph",Tag:"Tag"},Mv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"FileAttachment"}},{key:"attachIcon",get:function(){return this.annot?this.annot.getIconName():this.annotData.attachIcon},set:function(e){var t=this;Fv[e]&&gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setIconName(e)}))}))}},{key:"point",get:function(){if(!this.annot)return this.annotData.point;var e=this.annot.getRect();return[e.left,e.top]},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(e&&Array.isArray(e)&&!(e.length<2))return t.annot.moveTo({left:e[0],top:e[1],action:"move"})}))}))}}]),n}(Ev),Ov=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"FreeText"}},{key:"alignment",get:function(){return this.annot?this.annot.getInfo().justification:this.annotData.alignment},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setAlignment(e)}))}))}},{key:"callout",get:function(){if(!this.annot)return this.annotData.callout;var e=this.annot.getCalloutLinePoints(),t=[];return e.map((function(e){t.push(e.x,e.y)})),t},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Ap(e);return t.annot.setCalloutLinePoints(n)}))}))}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getFillColor();return(0,j.convertFromNumberToJSColor)(e)},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=(0,j.colorConvertor)(e,"int",0);return t.annot.setFillColor(n)}))}))}},{key:"lineEnding",get:function(){if(!this.annot)return this.annotData.lineEnding;var e=this.annot.getCalloutLineEndingStyle();return be[e]},set:function(e){var t=this;e||(e="None"),gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=we[e];return t.annot.setCalloutLineEndingStyle(n)}))}))}},{key:"richDefaults",get:function(){},set:function(e){}},{key:"rotate",get:function(){if(!this.annot)return this.annotData.rotate;var e=360-this.annot.getRotation();return 360===e&&(e=0),e},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=0;return 0!==e&&(n=360-e),t.annot.setRotation(n)}))}))}},{key:"textFont",get:function(){},set:function(e){}},{key:"textSize",get:function(){return this.annot?this.annot.getDefaultAppearance().textSize:this.annotData.textSize},set:function(e){var t=this;return gv((function(i){(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=t.annot.getDefaultAppearance();return n.textSize=e,t.annot.setDefaultAppearance(n).then((function(e){}))}))}))}},{key:"width",get:function(){return this.annot?this.annot.getBorderWidth():this.annotData.width||1},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setBorderWidth(e)}))}))}}]),n}(Ev),Lv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Highlight"}},{key:"quads",get:function(){if(!this.annot)return this.annotData.quads;var e=this.annot.getQuadPoints(),t=[];return e.map((function(e){e.map((function(e){t.push(e.x,e.y)}))})),t},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Pp(e);return t.annot.setRect(n)}))}))}}]),n}(Ev),Nv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Ink"}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"gestures",get:function(){if(!this.annot)return this.annotData.gestures;var e,t=this.annot.getInkList(),n=[];return t.map((function(t){1===t.type&&(e=[],n.push(e)),e.push([t.x,t.y])})),n},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=_p(e);return t.annot.setInkList(n)}))}))}},{key:"width",get:function(){return this.annot?this.annot.getBorderWidth():annotData.width||0},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setBorderWidth(e)}))}))}}]),n}(Ev),Vv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Line"}},{key:"arrowBegin",get:function(){if(!this.annot)return this.annotData.arrowBegin;var e=this.annot.getStartStyle();return be[e]},set:function(e){var t=this;e||(e="None"),gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=we[e];return t.annot.setEndingStyle(!0,n)}))}))}},{key:"arrowEnd",get:function(){if(!this.annot)return this.annotData.arrowEnd;var e=this.annot.getEndingStyle();return be[e]},set:function(e){var t=this;e||(e="None"),gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=we[e];return t.annot.setEndingStyle(!1,n)}))}))}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"doCaption",get:function(){return this.annot?this.annot.hasCaption():this.annotData.doCaption},set:function(e){var t=this;gv((function(n){return t.annot.enableCaption(e)}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getStyleFillColor();return(0,j.convertFromNumberToJSColor)(e)},set:function(e){var t=this;gv((function(n){return t._delayOrExec((function(){var n=(0,j.colorConvertor)(e,"int",0);return t.annot.setStyleFillColor(n)}))}))}},{key:"leaderExtend",get:function(){return this.annot?this.annot.getLeaderLineExtend():this.annotData.leaderExtend},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setLeaderLineExtend(e)}))}))}},{key:"leaderLength",get:function(){return this.annot?this.annot.getLeaderLineLength():this.annotData.leaderLength},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setLeaderLineLength(e)}))}))}},{key:"width",get:function(){return this.annot?this.annot.getBorderWidth():this.annotData.width},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setBorderWidth(e)}))}))}}]),n}(Ev);const Bv=Vv;var jv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"PolyLine"}},{key:"arrowBegin",get:function(){if(!this.annot)return this.annotData.arrowBegin;var e=this.annot.getStartStyle();return be[e]},set:function(e){var t=this;e||(e="None"),gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=we[e];return t.annot.setEndingStyle(!0,n)}))}))}},{key:"arrowEnd",get:function(){if(!this.annot)return this.annotData.arrowEnd;var e=this.annot.getEndingStyle();return be[e]},set:function(e){var t=this;e||(e="None"),gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(n){var i=we[e];return t.annot.setEndingStyle(!1,i)}))}))}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getFillColor();return(0,j.convertFromNumberToJSColor)(e)},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=(0,j.colorConvertor)(e,"int",0);return t.annot.setFillColor(n)}))}))}},{key:"vertices",get:function(){if(!this.annot)return this.annotData.vertices;var e=this.annot.getVertexes(),t=[];return e.map((function(e){t.push(e.x,e.y)})),t},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Ap(e);return t.annot.setVertexes(n)}))}))}}]),n}(Ev),Uv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Polygon"}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getFillColor();return(0,j.convertFromNumberToJSColor)(e)},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=(0,j.colorConvertor)(e,"int",0);return t.annot.setFillColor(n)}))}))}},{key:"vertices",get:function(){if(!this.annot)return this.annotData.vertices;var e=this.annot.getVertexes(),t=[];return e.map((function(e){t.push(e.x,e.y)})),t},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Ap(e);return t.annot.setVertexes(n)}))}))}}]),n}(Ev),Hv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Sound"}},{key:"point",get:function(){if(!this.annot)return this.annotData.point;var e=this.annot.getRect();return[e.left,e.top]},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(e&&Array.isArray(e)&&!(e.length<2))return t.annot.moveTo({left:e[0],top:e[1],action:"move"})}))}))}},{key:"soundIcon",get:function(){},set:function(e){}}]),n}(Ev),Wv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Square"}},{key:"dash",get:function(){return this.annot?this.annot.getBorderInfo().dashes:this.annotData.dash},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(Array.isArray(e))return t.annot.setBorderStyle(1,e)}))}))}},{key:"fillColor",get:function(){if(!this.annot)return this.annotData.fillColor;var e=this.annot.getFillColor();return(0,j.convertFromNumberToJSColor)(e)},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=(0,j.colorConvertor)(e,"int",0);return t.annot.setFillColor(n)}))}))}},{key:"width",get:function(){return this.annot,this.annot.getBorderWidth()},set:function(e){var t=this;return gv((function(i){(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setBorderWidth(e)}))}))}}]),n}(Ev),Yv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Squiggly"}},{key:"quads",get:function(){if(!this.annot)return this.annotData.quads;var e=this.annot.getQuadPoints(),t=[];return e.map((function(e){e.map((function(e){t.push(e.x,e.y)}))})),t},set:function(e){var t=this;return gv((function(i){(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Pp(e);return t.annot.setRect(n)}))}))}}]),n}(Ev),qv={Approved:"Approved",AsIs:"AsIs",Confidential:"Confidential",Departmental:"Departmental",Draft:"Draft",Experimental:"Experimental",Expired:"Expired",Final:"Final",ForComment:"ForComment",ForPublicRelease:"ForPublicRelease",NotApproved:"NotApproved",NotForPublicRelease:"NotForPublicRelease",Sold:"Sold",TopSecret:"TopSecret"},Kv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Stamp"}},{key:"AP",get:function(){if(!this.annot)return this.annotData.AP;var e=this.annot.getIconName();if(e&&"#"===e[0]){var t=e.substr(1);(t=qv[t])&&(e=t)}return e},set:function(e){}}]),n}(Ev),$v=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"StrikeOut"}},{key:"quads",get:function(){if(!this.annot)return this.annotData.quads;var e=this.annot.getQuadPoints(),t=[];return e.map((function(e){e.map((function(e){t.push(e.x,e.y)}))})),t},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Pp(e);return t.annot.setRect(n)}))}))}}]),n}(Ev),zv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,e,i,r)).stateModelValue="Review",o}return(0,A._)(n,[{key:"type",get:function(){return"Text"}},{key:"noteIcon",get:function(){return this.annot?this.annot.getIconName():this.annotData.noteIcon||"Note"},set:function(e){var t=this;e||(e="Note"),gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return t.annot.setIconName(e).then((function(e){}))}))}))}},{key:"point",get:function(){if(!this.annot)return this.annotData.point;var e=this.annot.getRect();return[e.left,e.top]},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if(e&&Array.isArray(e)&&!(e.length<2))return t.annot.moveTo({left:e[0],top:e[1],action:"move"})}))}))}},{key:"state",get:function(){return this.annot?"Marked"===this.stateModel?this.annot.getMarkedState(0):this.annot.getReviewState(0):this.annotData.state},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){if("Review"===t.stateModelValue){switch(e){case"accepted":case"rejected":case"cancelled":case"completed":case"none":break;default:e="none"}return t.annot.addReviewState(e)}if("Marked"===t.stateModelValue)return"marked"!==e&&"unmarked"!==e&&(e="unmarked"),t.annot.addMarkedState(e)}))}))}},{key:"stateModel",get:function(){return this.stateModelValue},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){return"Marked"!==e&&"Review"!==e&&(e="Review"),t.stateModelValue=e}))}))}}]),n}(Ev),Gv=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"type",get:function(){return"Underline"}},{key:"quads",get:function(){if(!this.annot)return this.annotData.quads;var e=this.annot.getQuadPoints(),t=[];return e.map((function(e){e.map((function(e){t.push(e.x,e.y)}))})),t},set:function(e){var t=this;gv((function(i){return(0,S._)((0,x._)(n.prototype),"_delayOrExec",t).call(t,(function(){var n=Pp(e);return t.annot.setRect(n)}))}))}}]),n}(Ev),Jv=function(){function e(t,n,i){(0,P._)(this,e),this.annot=t,this.annotData=n,this.app=i}return(0,A._)(e,[{key:"activated",get:function(){return!this.annot&&this.annotData.activated}},{key:"context3D",get:function(){this.activated}},{key:"innerRect",get:function(){}},{key:"name",get:function(){return this.annot?this.annot.getName():this.annotData.name}},{key:"page",get:function(){return this.annot?this.annot.getPage().getIndex():this.annotData.page}},{key:"rect",get:function(){if(!this.annot)return this.annotData.rect;var e=this.annot.getRect(),t=e.left,n=e.right,i=e.top;return[t,e.bottom,n,i]}}]),e}(),Xv=function(e,t,n){var i=e.getEvent();if(!i.isSensitiveCheck){var r=i.target.valueAsString;if(i.param.value&&(r=i.param.value),""!=r){var o=op(r,n);if(!r||!o){i.rc=!1;var a=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return a+=' "'.concat(n,'" '),void t.alertAsync(a)}var s=rp(r,n);if(!s){i.rc=!1;var u=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return u+=' "'.concat(n,'" '),void t.alert(u)}i.value=ip(n,s),i.rc=!0}}},Zv=function(e,t,n,i,r,o,a,s){var u=e.getEvent(),c=i;if((c<0||c>3)&&(c=0),u.value){var l=u.value;if(!/^[0-9\.\-]+$/.test(l)){u.rc=!1;var d=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return d+=' "Number" ',void t.alertAsync(d)}var h=u.change,f=l;if(u.willCommit){var g=f.trimLeft();if(0==g.length){u.rc=!0;var v=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return v+=' "Number" ',void t.alertAsync(v)}var p=g;if(p=p.replace(/,/g,"."),!/^[0-9\.\-]+$/.test(p)){var m=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return m+=' "Number" ',t.alert(m),void(u.rc=!1)}u.rc=!0}else{var y=f,k=h||"",b=".";switch(c){case 0:case 1:b=".";break;case 2:case 3:b=","}for(var w=-1!=y.indexOf(b),_=0;_<k.length;_++)if(k[_]!=b)if("-"!=k[_]){if(!/[0-9\.]/.test(k[_]))return void(u.rc=!1)}else{if(bHasSign)return void(u.rc=!1);if(0!=_)return void(u.rc=!1);if(0!=u.selStart)return void(u.rc=!1);bHasSign=!0}else{if(w){u.rc=!1;var P=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return P+=' "Number" ',void t.alertAsync(P)}w=!0}var A,S=y.substr(0,u.selStart);u.selEnd<y.length&&(A=y.substr(u.selEnd)||""),l=f=y=S+k+A,u.rc=!0}}else u.rc=!0};function Qv(e,t,n,i){var r=".",o=",",a="";switch(n){case 0:break;case 1:o="";break;case 2:r=",",o=".";break;case 3:r=",",o="";break;case 4:r=",",o=" "}var s=e.length%3;a=e.substr(0,s);for(var u=s;u<e.length;u+=3)0!==a.length&&(a+=o),a+=e.substr(u,3);if(i>0){for(t=t.substring(0,i);t.length<i;)t+="0";a=a+r+t}return a}function ep(e){var t=e.toString().split(".",2);return null==t||t.length<2?(t=null,0):t[1].length}var tp="January[1]February[2]March[3]April[4]May[5]June[6]July[7]August[8]September[9]October[10]November[11]December[12]Jan[1]Feb[2]Mar[3]Apr[4]Jun[6]Jul[7]Aug[8]Sep[9]Oct[10]Nov[11]Dec[12]";function np(e){var t=new RegExp("(\\w+)\\["+e+"\\]").exec(tp);return t?t[1]:null}var ip=function(e,t){e=e.replace(/%/g,"%69");var n=[],i=t.getFullYear().toString();i="0000"+i,e=(e=e.replace(/([^y])y{4}(?!y)|(^)y{4}(?!y)/g,"$1"+i.substr(i.length-4,4))).replace(/([^y])y{2}(?!y)|(^)y{2}(?!y)/g,"$1"+i.substr(i.length-2,2)),i=np(t.getMonth()+1),n["%mmmm"]=i,e=e.replace(/([^m])m{4}(?!m)|(^)m{4}(?!m)/g,"$1%mmmm"),n["%mmm"]=i.substr(0,3),e=(e=e.replace(/([^m])m{3}(?!m)|(^)m{3}(?!m)/g,"$1%mmm")).replace(/([^m])m{1}(?!m)|(^)m{1}(?!m)/g,"$1"+(t.getMonth()+1)),1===(i=(t.getMonth()+1).toString()).length&&(i="0"+i),e=e.replace(/([^m])m{2}(?!m)|(^)m{2}(?!m)/g,"$1"+i),i=function(e){var t=new RegExp("(\\w+)\\["+e+"\\]").exec("Sunday[0]Monday[1]Tuesday[2]Wednesday[3]Thursday[4]Friday[5]Saturday[6]");return t?t[1]:null}(t.getDay()),n["%dddd"]=i,e=e.replace(/([^d])d{4}(?!d)|(^)d{4}(?!d)/g,"$1%dddd"),n["%ddd"]=i.substr(0,3),e=(e=e.replace(/([^d])d{3}(?!d)|(^)d{3}(?!d)/g,"$1%ddd")).replace(/([^d])d{1}(?!d)|(^)d{1}(?!d)/g,"$1"+t.getDate()),1===(i=t.getDate().toString()).length&&(i="0"+i),e=(e=e.replace(/([^d])d{2}(?!d)|(^)d{2}(?!d)/g,"$1"+i)).replace(/([^H])H{1}(?!H)|(^)H{1}(?!H)/g,"$1"+t.getHours()),1===(i=t.getHours().toString()).length&&(i="0"+i),e=e.replace(/([^H])H{2}(?!H)|(^)H{2}(?!H)/g,"$1"+i);var r=t.getHours()>12?t.getHours()-12:t.getHours();return 0==r&&(r=12),e=e.replace(/([^h])h{1}(?!h)|(^)h{1}(?!h)/g,"$1"+r),1===(i=r.toString()).length&&(i="0"+i),e=(e=e.replace(/([^h])h{2}(?!h)|(^)h{2}(?!h)/g,"$1"+i)).replace(/([^M])M{1}(?!M)|(^)M{1}(?!M)/g,"$1"+t.getMinutes()),1===(i=t.getMinutes().toString()).length&&(i="0"+i),e=(e=e.replace(/([^M])M{2}(?!M)|(^)M{2}(?!M)/g,"$1"+i)).replace(/([^s])s{1}(?!s)|(^)s{1}(?!s)/g,"$1"+t.getSeconds()),1===(i=t.getSeconds().toString()).length&&(i="0"+i),e=e.replace(/([^s])s{2}(?!s)|(^)s{2}(?!s)/g,"$1"+i),i=function(e){return e>11?"PM":"AM"}(t.getHours()),e=e.replace(/([^t])t{2}(?!t)|(^)t{2}(?!t)/g,"$1"+i),1===i.length&&(i=i.charAt(0)),e=(e=(e=(e=(e=e.replace(/([^t])t{1}(?!t)|(^)t{1}(?!t)/g,"$1"+i)).replace(/%mmmm/g,n["%mmmm"])).replace(/%mmm/g,n["%mmm"])).replace(/%dddd/g,n["%dddd"])).replace(/%ddd/g,n["%ddd"]),n=null,e=e.replace(/%69/g,"%")},rp=function(e,t){return op(e,t)};function op(e,t){var n=function(e,t){var n=new Date,i=n.getFullYear(),r=n.getMonth()+1,o=n.getDate(),a=0,s=0,u=0,c=99,l="",d=!1,h=!1,f=["/","-",",","."],g=["/","-",",","."],v=function(e,t){for(var n=function(n,i){var r=e.charAt(n);if(t){if(void 0!==g.find((function(e){return e==r})))return{v:!0}}else if(void 0!==f.find((function(e){return e==r})))return{v:!0}},i=0,r=e.length;i<r;i++){var o=n(i,r);if("object"===(0,R._)(o))return o.v}return!1},p=function(e,t){var n=e;if(t){var i=!0,r=!1,o=void 0;try{for(var a,s=g[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value,c=new RegExp("\\"+u,"g");n=n.replace(c,"")}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}}else{var l=!0,d=!1,h=void 0;try{for(var v,p=f[Symbol.iterator]();!(l=(v=p.next()).done);l=!0){var m=v.value;c=new RegExp("\\"+m,"g");n=n.replace(c,"")}}catch(e){d=!0,h=e}finally{try{l||null==p.return||p.return()}finally{if(d)throw h}}}return n},m=v(t,!1),y=v(e,!0);m&&!y?t=p(t,!1):!m&&y&&(e=p(e,!0));var k=0,b=0;for(;k<t.length&&!d;){var w=t.charAt(k);switch(w){case"y":case"m":case"d":case"H":case"h":case"M":case"s":case"t":var _=b,P=0,A=null;if(t.charAt(k+1)!==w)switch(w){case"y":k++,b++;break;case"m":r=(A=sp(e,b,2)).nRet,k++,b+=P=A.nSkip;break;case"d":o=(A=sp(e,b,2)).nRet,k++,b+=P=A.nSkip;break;case"H":case"h":a=(A=sp(e,b,2)).nRet,k++,b+=P=A.nSkip;break;case"M":s=(A=sp(e,b,2)).nRet,k++,b+=P=A.nSkip;break;case"s":u=(A=sp(e,b,2)).nRet,k++,b+=P=A.nSkip;break;case"t":l="p"===e.charAt(k)||"P"==e.charAt(k),k++,b++}else if(t.charAt(k+1)===w&&t.charAt(k+2)!==w)switch(w){case"y":i=(A=sp(e,b,4)).nRet,k+=2,b+=P=A.nSkip;break;case"m":A=sp(e,b,2),0!=a?s=A.nRet:r=A.nRet,k+=2,b+=P=A.nSkip;break;case"d":A=sp(e,b,2),(k+=2)>=t.length&&(A=sp(e,b,4)),o=A.nRet,b+=P=A.nSkip;break;case"H":case"h":a=(A=sp(e,b,2)).nRet,k+=2,b+=P=A.nSkip;break;case"M":s=(A=sp(e,b,2)).nRet,k+=2,b+=P=A.nSkip;break;case"s":u=(A=sp(e,b,2)).nRet,k+=2,b+=P=A.nSkip;break;case"t":l=!("p"!==e.charAt(b)&&"P"!=e.charAt(b)||"m"!==e.charAt(b+1)&&"M"!==e.charAt(b+1)),k+=2,b+=2}else if(t.charAt(k+1)===w&&t.charAt(k+2)===w&&t.charAt(k+3)!==w)switch(w){case"m":P=(A=up(e,b)).nSkip;for(var S=A.swRet,x=!1,C=0;C<12;C++)if(S.toLowerCase()===np(C+1).substr(0,3).toLowerCase()){r=C+1,k+=3,b+=P,x=!0;break}x||(r=(A=sp(e,b,3)).nRet,k+=3,b+=P=A.nSkip);break;case"y":break;default:k+=3,b+=3}else if(t.charAt(k+1)===w&&t.charAt(k+2)===w&&t.charAt(k+3)===w&&t.charAt(k+4)!==w)switch(w){case"y":i=(A=sp(e,b,4)).nRet,b+=P=A.nSkip,k+=4,i<100&&(i=-1,h=!0);break;case"m":x=!1;P=(A=up(e,b)).nSkip,S=(S=A.swRet).toLowerCase();for(C=0;C<12;C++){var D=np(C+1);if((D=D.toLowerCase()).indexOf(S,0)>=0){r=C+1,k+=4,b+=P,x=!0;break}}x||(r=(A=sp(e,b,4)).nRet,k+=4,b+=P=A.nSkip);break;default:k+=4,b+=4}else t.charAt(k)!==e.charAt(b)&&(h=!0,d=!0),k++,b++;_===b&&(h=!0,d=!0);break;default:if(e.length<=b)d=!0;else{var E=ap(t.charAt(k)),I=ap(e.charAt(b));(E&&!I||!E&&I)&&(h=!0,d=!0)}k++,b++}}l&&a<12&&(a+=12);!1===l&&12==a&&(a=0);i>=0&&i<=c&&(i+=2e3);(r<1||r>12)&&(h=!0);(o<1||o>31)&&(h=!0);(a<0||a>23)&&(h=!0);(s<0||s>60)&&(h=!0);(u<0||u>60)&&(h=!0);if(!h)return 2!=r||29!=o||t.match(/y/)||(i&=1048572),new Date(i,r-1,o,a,s,u);return null}(e,t);return null==n&&(n=function(e){for(var t=new Date,n=t.getFullYear(),i=t.getMonth()+1,r=t.getDate(),o=t.getHours(),a=t.getMinutes(),s=t.getSeconds(),u=[],c=0;c<6;c++)u[c]=0;var l=!1,d=0,h=0,f=e.length;for(;h<f&&!(d>5);){var g=e.charAt(h);if(ap(g)){var v=sp(e,h,4);u[d++]=v.nRet,h+=v.nSkip}else":"===g&&(l=!0),h++}var p=!0;if(l){if(d<=3)(m=lp(d,u[0],u[1],u[2],o,a,s))&&(o=m.h,a=m.M,s=m.s,p=!1);else if(4===d){(m=cp(2,u[0],u[1],0,n,i,r))&&(n=m.y,i=m.m,r=m.d,(m=lp(2,u[2],u[3],0,o,a,s))&&(o=m.h,a=m.M,s=m.s,p=!1))}else if(5===d){if((m=cp(3,u[0],u[1],u[2],n,i,r))&&(n=m.y,i=m.m,r=m.d,(m=lp(2,u[3],u[4],0,o,a,s))&&(o=m.h,a=m.M,s=m.s,p=!1)),p)(m=cp(2,u[0],u[1],0,n,i,r))&&(n=m.y,i=m.m,r=m.d,(m=lp(3,u[2],u[3],u[4],o,a,s))&&(o=m.h,a=m.M,s=m.s,p=!1))}else if(6===d){(m=cp(3,u[0],u[1],u[2],n,i,r))&&(n=m.y,i=m.m,r=m.d,(m=lp(3,u[3],u[4],u[5],o,a,s))&&(o=m.h,a=m.M,s=m.s,p=!1))}}if(p){var m;(m=cp(d,u[0],u[1],u[2],n,i,r))&&(n=m.y,i=m.m,r=m.d,p=d>3)}if(p)return null;return new Date(n,i-1,r,o,a,s)}(e)),n}function ap(e){return e>="0"&&e<="9"}function sp(e,t,n){var i=[];i.nRet=0,i.nSkip=0;for(var r=t,o=e.length;r<o&&!(r-t>10);r++){var a=e.charAt(r);if(!ap(a))break;if(i.nRet=10*i.nRet+(a-"0"),i.nSkip=r-t+1,i.nSkip>=n)break}return i}function up(e,t){var n=[];n.swRet="",n.nSkip=0;for(var i=t,r=e.length;i<r;i++){var o=e.charAt(i);if(!(o>="a"&&o<="z"||o>="A"&&o<="Z"))break;n.swRet+=o,n.nSkip=i-t+1}return n}function cp(e,t,n,i,r,o,a){var s=[];if(s.y=r,s.m=o,s.d=a,2===e){if(t>=1&&t<=12&&n>=1&&n<=31)return s.m=t,s.d=n,s;if(t>=1&&t<=31&&n>=1&&n<=12)return s.m=n,s.d=t,s}else if(e>=3){if(t>12&&n>=1&&n<=12&&i>=1&&i<=31)return s.y=t,s.m=n,s.d=i,s;if(t>=1&&t<=12&&n>=1&&n<=31&&i>31)return s.y=i,s.m=t,s.d=n,s;if(t>=1&&t<=31&&n>=1&&n<=12&&i>31)return s.y=i,s.m=n,s.d=t,s}return null}function lp(e,t,n,i,r,o,a){var s=[];if(s.h=r,s.M=o,s.s=a,2===e){if(t>=0&&t<=23&&n>=0&&n<=59)return s.h=t,s.M=n,s.s=0,s}else if(3===e&&t>=0&&t<=23&&n>=0&&n<=59&&i>=0&&i<=59)return s.h=t,s.M=n,s.s=i,s;return null}var dp=function(e,t,n){for(var i="",r=0,o=0;o<t.length;o++)switch(t[o]){case"9":for(;r<e.length;){var a=r;if(r++,e[a]>="0"&&e[a]<="9"){i+=e[a];break}}if(r>=e.length&&n)return i;break;case"A":if(!(r<e.length))return i;i+=e[r++];break;case"O":var s=r;if(r++,e[s].match(/[0-9a-zA-Z]/)&&(i+=e[s]),r>=e.length&&n)return i;break;case"X":i+=e[r++];break;default:i+=t[o],t[o]==e[r]&&r++}return i},hp=function(e,t){switch(t){case"9":var n=parseInt(e);return 0<=n&&n<=9;case"A":return/[a-zA-Z]/.test(e);case"O":var i=parseInt(e);return 0<=i&&i<=9||/[a-zA-Z]/.test(e);case"X":case" ":return!0;default:return e===t}},fp=function(e,t,n){var i=e.getEvent(),r=i.value;if(0!=r.length){var o=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");if(o+=' "'+n+'" ',i.willCommit){if(r.length>n.length)return i.rc=!1,void t.alertAsync(o);var a=0;if((r=dp(r,n,!0)).length==n.length)for(var s=0;s<r.length&&hp(r[s],n[a]);s++)a++;return a!=n.length||a!=r.length&&n.length>0?(i.rc=!1,void t.alertAsync(o)):(i.change=r,r)}var u=i.change;if(u&&0!=u.length){var c;i.selStart;if((c=i.selStart<i.selEnd?r.replace(r.substr(i.selStart,i.selEnd),u):r.substr(0,i.selStart)+u+r.substr(i.selEnd)).length>n.length){var l=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return l+=' "'+n+'" ',t.alert(l),void(i.rc=!1)}var d=dp(c,n);if(d.length>n.length){i.rc=!1;var h=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return h+=' "'+n+'" ',void t.alertAsync(h)}return i.rc=!0,d}i.rc=!0}else i.rc=!0};const gp={AFSimple_Calculate:function(e,t,n){var i=e.getEvent();if(!i.isSensitiveCheck){var r="",o=0,a=NaN;switch(t){case"AVG":for(var s=0;s<n.length;s++){var u=parseFloat(e.getFieldValue(n[s]));if(!isNaN(u)){var c=ep(u);o=o>c?o:c,isNaN(a)&&(a=0),a+=u}}r=isNaN(a)?"0":a/n.length;break;case"SUM":for(var l=0;l<n.length;l++){var d=parseFloat(e.getFieldValue(n[l]));if(!isNaN(d)){var h=ep(d);o=o>h?o:h,isNaN(a)&&(a=0),a+=d,a=+parseFloat(a.toPrecision(12))}}r=isNaN(a)?"0":a;break;case"PRD":for(var f=NaN,g=0;g<n.length;g++){var v=parseFloat(e.getFieldValue(n[g]));isNaN(v)&&(v=0);var p=ep(v);o=o>p?o:p,isNaN(f)&&(f=1),f*=v}r=isNaN(f)?"0":f;break;case"MIN":for(var m=NaN,y=0;y<n.length;y++){var k=parseFloat(e.getFieldValue(n[y]));if(!isNaN(k)){var b=ep(k);o=o>b?o:b,isNaN(m)&&(m=k),m>k&&(m=k)}}r=isNaN(m)?"0":m;break;case"MAX":for(var w=NaN,_=0;_<n.length;_++){var P=parseFloat(e.getFieldValue(n[_]));if(!isNaN(P)){var A=ep(P);o=o>A?o:A,isNaN(w)&&(w=P),w<P&&(w=P)}}r=isNaN(w)?"0":w}i.valueSetted=!0,i.value=r,i.rc=!0}},AFRange_Validate:function(e,t,n,i,r,o){var a=e.getEvent();if(!a.isSensitiveCheck){var s,u=a.target,c="",l=a.value;s=parseFloat(l),isNaN(s)?a.value=u.value:(n&&r?(s<i||s>o)&&(c="Value should be greater than "+i+" and less than "+o+"."):n?s<i&&(c="Value should be greater than "+i+"."):r&&s>o&&(c="Value should be less than "+o+"."),""!==c?(t.alert(c),a.value=u.value,a.rc=!1):a.rc=!0)}},AFNumber_Format:function(e,t,n,i,r,o,a,s){var u=e.getEvent();if(!u.isSensitiveCheck){var c=u.value;if((u.param.value||0===u.param.value)&&(c=u.param.value),""!==c){if(isNaN(c)){u.value="",u.rc=!1;var l=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return l+=' "Number" ',void t.alertAsync(l)}var d=(c=parseFloat(c))<0?-1:1;if(isNaN(c)){u.value=c,u.rc=!1;var h=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return h+=' "Number" ',void t.alertAsync(h)}var f="";f=(2===r||3===r)&&d<0?"(":"",s&&(f+=a);var g=(c*=d).toString().split(".",2),v=g[0],p="";g.length>1&&(p=g[1]),f+=Qv(v,p,i,n),s||(f+=a),(2===r||3===r)&&d<0&&(f+=")"),(0!==r||s)&&(c=Math.abs(c)),1!==r&&3!==r||(d<0?u.engineTarget.setDAFontColor(["RGB",1,0,0]):u.engineTarget.setDAFontColor(["RGB",0,0,0])),d<0&&0===r&&(f="-"+f),u.value=f,u.rc=!0}else u.value=""}},AFTime_Format:function(e,t,n){if("number"==typeof(n=["HH:MM","h:MM tt","HH:MM:ss","h:MM:ss tt"][n])){var i=n;n=i>=0&&i<cFormat.length?cFormat[i]:""}Xv(e,t,n)},AFTime_FormatEx:Xv,AFDate_FormatEx:function(e,t,n){var i=e.getEvent();if(i.format=n,!i.isSensitiveCheck){n&&0!=n.length||(n="mm/dd/yyyy");var r=i.target.valueAsString;if(i.param.value&&(r=i.param.value),""!=r){if(!r){i.rc=!1;var o=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return o+=' "'.concat(n,'" '),void t.alertAsync(o)}var a=rp(r,n);if(!a){i.rc=!1;var s=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return s+=' "'.concat(n,'" '),void t.alert(s)}i.value=ip(n,a),i.rc=!0}}},AFPercent_Format:function(e,t,n,i){var r=e.getEvent();if(!r.isSensitiveCheck){var o=r.target.value;if(o&&""!=o){if(o=parseFloat(100*o),isNaN(o)){r.value=r.target.value,r.rc=!0;var a=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return a+=' "Percentage" ',void t.alertAsync(a)}var s=o.toString().split(".",2),u=s[0],c="";s.length>1&&(c=s[1]);var l=Qv(u,c,i,n)+"%";r.value=l,r.rc=!0}}},AFMergeChange:function(e){var t,n,i=e.value;return e.willCommit?e.value:(t=e.selStart>=0?i.substring(0,e.selStart):"",n=e.selEnd>=0&&e.selEnd<=i.length?i.substring(e.selEnd,i.length):"",t+e.change+n)},AFNumber_Keystroke:Zv,AFParseDateEx:rp,AFMakeNumber:function(e){return parseFloat(e)||0},AFDate_KeystrokeEx:function(e,t,n){var i=e.getEvent();if(!i.isSensitiveCheck){var r=i.target.valueAsString;if(r){var o=rp(r,n);if(!o){i.rc=!1;var a=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return a+=' "'.concat(n,'" '),void t.alertAsync(a)}i.value=ip(n,o),i.rc=!0}else i.rc=!0}},AFSpecial_Format:function(e,t,n){var i=e.getEvent(),r=i.value;if(!r||r.length<1)i.rc=!0;else{var o;switch(r=""+r,n){case 0:o="99999";break;case 1:o="99999-9999";break;case 2:o=r.length>=10?"(999) 999-9999":"999-9999";break;case 3:o="999-99-9999"}var a=dp(r,o);if(a.length!=o.length){i.rc=!1;var s=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");return s+=' "'.concat(o,'" '),void t.alertAsync(s)}i.value=a,i.rc=!0}},FXFormatDate:ip,AFSpecial_Keystroke:function(e,t,n){var i=e.getEvent(),r=i.value;if(!(r.length<1)){var o,a=i.change;switch(n){case 0:o="99999";break;case 1:case 3:o="999999999";break;case 2:var s=r;if(0==s.length&&0==a.length)return void(i.rc=!0);if(i.willCommit){var u=s.match(/^(\(\d{3}\)\s?)?\d{3}-?\d{4}$|^(\d{3}\s?)?\d{3}-?\d{4}$/);if(i.rc=!!u,!u){var c=e.PDFViewer.i18n.t("viewer_:pdfjs.valueChangedError");c+=' "/^((d{3})s?)?d{3}-?d{4}$|^(d{3}s?)?d{3}-?d{4}$/" ',t.alert(c)}return}var l=i.selStart,d=i.selEnd;if(d<0&&(d=strSrc.length-1),(s=s.substr(0,l)+a+s.substr(d)).length-14>0)return void(i.rc=!1);var h=s.match(/^\(?\d*\)?\s?\d*-?\d*$/);return void(i.rc=!!h)}return fp(e,t,o)}i.rc=!0},AFPercent_Keystroke:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Zv.apply(void 0,(0,I._)(t))},AFSpecial_KeystrokeEx:function(e,t,n){var i=e.getEvent(),r=fp(e,t,n);void 0!==r&&(i.target.value=r)},ANSB_None:0,ANSB_Page:1,ANSB_Author:2,ANSB_ModDate:3,ANSB_Type:4,ANFB_ShouldNone:7,ANFB_ShouldPrint:0,ANFB_ShouldView:1,ANFB_ShouldEdit:2,ANFB_ShouldAppearInPanel:3,ANFB_ShouldSummarize:4,ANFB_ShouldExport:5};var vp=gp.ANSB_Author,pp=gp.ANSB_ModDate,mp=gp.ANSB_Type,yp=gp.ANFB_ShouldPrint,kp=gp.ANFB_ShouldView,bp=gp.ANFB_ShouldEdit,wp={line:Bv,circle:Tv,square:Wv,highlight:Lv,squiggly:Yv,underline:Gv,strikeout:$v,freetext:Ov,caret:Rv,ink:Nv,stamp:Kv,polyline:jv,polygon:Uv,text:zv,fileattachment:Mv,sound:Hv,"3d":Jv},_p=function(e){var t=[];return e.map((function(e){var n=e[0];if(Array.isArray(n))e.map((function(e,n){var i={};i.type=0===n?1:2,i.x=e[0],i.y=e[1],t.push(i)}));else for(var i=Math.floor(e.length/2),r=e,o=0;o<i;o++){var a=r.slice(2*o,2*o+2),s={};s.type=0===o?1:2,s.x=a[0],s.y=a[1],t.push(s)}})),t},Pp=function(e){for(var t,n,i,r,o=Math.floor(e.length/2),a=[],s=[],u=e,c=0;c<2*o;c++)[c]%2==0?s.push(u[c]):a.push(u[c]);return{left:(t=Math).min.apply(t,(0,I._)(s)),bottom:(n=Math).min.apply(n,(0,I._)(a)),right:(i=Math).max.apply(i,(0,I._)(s)),top:(r=Math).max.apply(r,(0,I._)(a))}},Ap=function(e){for(var t=[],n=Math.floor(e.length/2),i=e,r=0;r<n;r++){var o=i.slice(2*r,2*r+2);t.push({x:o[0],y:o[1]})}return t},Sp=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t}return(0,A._)(e,[{key:"getAnnotClass",value:function(e){var t=wp[e];return t||Cv}},{key:"getAnnots",value:function(e,t,n,i){var r;return r=t===yp?e.filter((function(e){return e.print})):t===kp?e.filter((function(e){return!e.noView})):t===bp?e.filter((function(e){return!e.readOnly})):(0,I._)(e),n===vp?r.sort((function(e,t){var n=e.author,i=t.author;return n.localeCompare(i)})):n===pp&&r.sort((function(e,t){var n=e.modDate,i=t.modDate;if(null===n&&null===i)return 0;if(null!==n&&null===i)return 1;if(null===n&&null!==i)return-1;var r=n.getTime(),o=i.getTime();return r>o?1:r<o?-1:0})),n===mp&&r.sort((function(e,t){var n=e.type,i=t.type;return n.localeCompare(i)})),i?r.reverse():r}},{key:"getAnnot",value:function(e,t,n){var i=e.getType(),r=this.getAnnotClass(i);return r===Cv?null:new r(e,{page:t},n)}},{key:"addAnnot",value:function(e){var t=this,n=e.type=e.type.toLowerCase(),i=null;switch(n){case"line":i=this.buildLineJson(e);break;case"stamp":i=this.buildStampJson(e);break;case"fileattachment":case"text":i=this.buildIconShapeJson(e);break;case"freetext":i=this.buildFreeTextJson(e);break;case"circle":case"square":case"caret":i=this.buildSimpleShapeJson(e),"square"!==n&&"circle"!==n||!e.dash||(i.borderStyle=1,i.borderStyleParam=e.dash);break;case"polyline":case"polygon":case"ink":case"highlight":case"underline":case"strikeout":case"squiggly":i={type:e.type,date:new Date},"polygon"===n&&"PolygonCloud"===e.intent&&(i.intent="PolygonCloud"),"polyline"!==n&&"polygon"!==n&&"ink"!==n||!e.dash||(i.borderStyle=1,i.borderStyleParam=e.dash);break;case"sound":i=this.buildScreenShapeJson(e)}if(!i)return null;i=this.buildJsonKeyValue(e,i);var r=this.getAnnotClass(n);e.creationDate=i.date,e.modDate||(e.modDate=i.date);var o=new r(null,e),a=this.pdfViewer;return gv((function(){return a.currentPDFDoc.addAnnot(e.page,i).then((function(t){return[a.getPDFPageRender(e.page),t]})).then((function(e){var t=e[0];if(t.isRendered)return e;var n=t.pagesRender;return n.getPageScale(t.index,n.scale).then((function(i){return t.render(i,n.rotate).then((function(){return e}))}))})).then((function(n){var r=(0,E._)(n,2),a=r[0],s=r[1][0],u=a.annotsRender.getAnnotRender(s.getId()).component,c=u.annot;c.info.author=i.author,t.doUpdatePropsAfterAdd(c,e,(function(t){t&&u.redraw(),e.open&&u.showReplyDialog("comment"),o.annot=c}))}))})),o}},{key:"showFileDialog",value:function(e){var t=this;return new Promise((function(n){t.$jsFileAttachment&&t.$jsFileAttachment.remove(),t.$jsFileAttachment=O()('<input id="jsFileAttachment" type="file" style="display: none;"/>'),O()("body").append(t.$jsFileAttachment),t.$jsFileAttachment.off("change").on("change",(function(i){var r=i.target.files[0];if(r){var o=new FileReader;o.readAsArrayBuffer(r),o.onload=function(){var i=new Uint8Array(o.result);e.contentType=r.type,e.buffer=i,e.fileName=r.name;var a=t.addAnnot(e);n(a)}}})),t.$jsFileAttachment.click()}))}},{key:"doUpdatePropsAfterAdd",value:function(e,t,n){n&&n()}},{key:"buildRectByPoint",value:function(e){var t=e[0],n=e[1];return{left:t,bottom:n-20,right:t+20,top:n}}},{key:"buildSimpleShapeJson",value:function(e){var t=Pp(e.rect),n=t.left,i=t.bottom,r=t.right,o=t.top;return{type:e.type,date:new Date,rect:{left:n,bottom:i,right:r,top:o}}}},{key:"buildIconShapeJson",value:function(e){var t;t=e.point?this.buildRectByPoint(e.point):Pp(e.rect);var n=e.AttachIcon,i=e.noteIcon,r="";switch(e.type){case"fileattachment":r=n;break;case"text":r=i}return{type:e.type,date:new Date,rect:t,icon:r}}},{key:"buildScreenShapeJson",value:function(e){var t;return t=e.point?this.buildRectByPoint(e.point):Pp(e.rect),{type:"screen",date:new Date,rect:t}}},{key:"buildStampJson",value:function(e){var t=Pp(e.rect),n=t.left,i=t.bottom,r=t.right,o=(t.top,.3*(r-n));return{type:e.type,date:new Date,rect:{left:n,bottom:i,right:r,top:i+o}}}},{key:"buildFreeTextJson",value:function(e){var t={type:e.type,date:new Date};"FreeTextCallout"===e.intent&&e.callout&&(t.calloutLinePoints=Ap(e.callout)),t.defaultAppearance={textColor:0,textSize:0},e.textSize&&(e.textSize>=4||e.textSize<=144)&&(t.defaultAppearance.textSize=e.textSize),e.dash&&(t.borderStyle=1,t.borderStyleParam=e.dash),t.intent=e.intent;var n,i=(0,I._)(e.rect);t.calloutLinePoints&&(n=i).push.apply(n,(0,I._)(e.callout));return t.rect=Pp(i),t.innerRect=Pp(e.rect),t}},{key:"buildLineJson",value:function(e){var t;if(e.points&&2===e.points.length){var n=e.points[0],i=e.points[1],r=n[0],o=n[1],a=i[0];t={left:r,bottom:i[1],right:a,top:o}}else t=Pp(e.rect);e.doCaption&&e.doCaption;var s={type:"line",date:new Date,rect:t,startStyle:we.None,endStyle:we.None};return e.intent&&(s.intent=e.intent),e.arrowBegin&&(s.startStyle=we[e.arrowBegin]),e.arrowEnd&&(s.endStyle=we[e.arrowEnd]),e.leaderLength&&(s.leaderLineLength=e.leaderLength),e.leaderExtend&&(s.leaderLineExtend=e.leaderExtend),e.dash&&(s.borderStyle=1,s.borderStyleParam=e.dash),s}},{key:"buildFlags",value:function(e,t){return e.hidden?t.flags=2|t.flags:t.flags=-3&t.flags,e.print||void 0===e.print?t.flags=4|t.flags:t.flags=-5&t.flags,e.noView?t.flags=32|t.flags:t.flags=-33&t.flags,e.readOnly?t.flags=64|t.flags:t.flags=-65&t.flags,e.lock?t.flags=128|t.flags:t.flags=-129&t.flags,e.toggleNoView?t.flags=256|t.flags:t.flags=-257&t.flags,t}},{key:"buildCoords",value:function(e,t){var n=[];if(e.quads)for(var i=Math.floor(e.quads.length/8),r=e.quads,o=0;o<i;o++){var a,s,u,c,l=r.slice(8*o,8*o+8),d=(a=Math).min.apply(a,[l[0],l[2],l[4],l[6]]),h=(s=Math).max.apply(s,[l[1],l[3],l[5],l[7]]),f=(u=Math).max.apply(u,[l[0],l[2],l[4],l[6]]),g=(c=Math).min.apply(c,[l[1],l[3],l[5],l[7]]);n.push({left:d,top:h,right:f,bottom:g,rotation:0})}else{var v=Pp(e.rect),p=v.left,m=v.bottom,y=v.right,k=v.top;n.push({left:p,top:k,right:y,bottom:m,rotation:0})}return t.coords=n,t}},{key:"calcRectByVertices",value:function(e){var t={},n=0,i=0,r=0,o=0;return e.map((function(e,t){var a=e.x,s=e.y;0===t?(n=a,i=a,r=s,o=s):(n=a<n?a:n,i=a>i?a:i,r=s<r?s:r,o=s>o?s:o)})),t.left=n,t.right=i,t.bottom=r,t.top=o,t}},{key:"buildVertices",value:function(e,t){if(!e.vertices)return t;if("polygon"===e.type||"polyline"===e.type){for(var n=[],i=Math.floor(e.vertices.length/2),r=e.vertices,o=0;o<i;o++){var a=r.slice(2*o,2*o+2);n.push({x:a[0],y:a[1]})}t.vertexes=n,t.rect=this.calcRectByVertices(n)}return t}},{key:"buildFillColor",value:function(e,t){return e.fillColor?("circle"!==e.type&&"square"!==e.type&&"line"!==e.type&&"polygon"!==e.type&&"polyline"!==e.type&&"freetext"!==e.type||(t["interior-color"]=(0,j.colorConvertor)(e.fillColor,"int",0),t.interiorColor=t["interior-color"]),t):t}},{key:"buildGestures",value:function(e,t){if("ink"!==e.type||!e.gestures)return e.rect&&(t.rect=Pp(e.rect)),t;var n=_p(e.gestures);return t.inkList=n,t.rect={left:0,right:0,top:0,bottom:0},t}},{key:"buildStampAP",value:function(e,t){if("stamp"!==e.type)return t;var n,i=this.pdfViewer,r="approved";switch(e.AP&&(r=e.AP.toLowerCase()),r){case"approved":default:n="Approved";break;case"confidential":n="Confidential";break;case"draft":n="Draft";break;case"expired":n="Expired";break;case"final":n="Final"}t.icon=n,t.iconCategory="Static",t.url=Ks(i.libPath,"stamps/",i.getCurrentLanguage(),"StandardStamps",t.icon+".pdf");var o={annotType:"stamp",category:t.iconCategory,name:t.icon,fileType:"pdf",url:t.url};return t.iconInfo=o,t}},{key:"buildJsonKeyValue",value:function(e,t){return e.strokeColor&&(t.color=(0,j.colorConvertor)(e.strokeColor,"int",0),"freetext"===e.type&&(t.defaultAppearance.textColor=t.color)),e.popupOpen&&"freetext"!==e.type&&"sound"!==e.type&&"fileattachment"!==e.type&&(t.open="yes"),e.contents&&(t.contents=e.contents),e.name&&(t.name=e.name),e.author&&(t.title=e.author),e.opacity&&(t.opacity=e.opacity),e.width&&(t.borderWidth=e.width),"C"===e.borderEffectStyle&&(t.borderStyle=5,t.borderStyleParam=0,e.borderEffectIntensity&&(t.borderStyleParam=e.borderEffectIntensity)),t=this.buildFlags(e,t),"highlight"!==e.type&&"strikeout"!==e.type&&"underline"!==e.type&&"squiggly"!==e.type||((t=this.buildCoords(e,t)).rect={left:0,right:0,top:0,bottom:0}),"fileattachment"===e.type?(e.buffer&&(t.buffer=e.buffer,t.fileName=e.fileName),e.attachIcon&&(t.icon=e.attachIcon)):"sound"===e.type&&e.buffer&&(t.multiBuffer=e.buffer,t.fileName=e.fileName,t.contentType=e.contentType),t=this.buildFillColor(e,t),t=this.buildGestures(e,t),t=this.buildStampAP(e,t),t=this.buildVertices(e,t)}}]),e}(),xp=function(){function e(t,n,i){(0,P._)(this,e),this.id=t,this.info=n,this.doc=i}return(0,A._)(e,[{key:"state",get:function(){return this.info.visible},set:function(e){return this.doc.setLayerNodeVisible(this.id,e),this.info.visible=e}},{key:"name",get:function(){return this.info.name}}]),e}(),Cp=gp.ANSB_None,Dp=gp.ANFB_ShouldNone,Ep=function(e){return e.jsEngine.getPDFDoc()},Ip=function(e){return e.jsEngine.getPDFForm()},Rp={},Tp=function(){for(var e in Rp){Rp[e].destroy(),delete Rp[e]}Rp={}},Fp=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).jsEngine=e,r.jsApp=i,r._dirty=!1,r._layout="",r._arrTemplate=new Array,r.printParams=new bv(r.jsEngine,(0,w._)(r)),r.annotManage=new Sp(i.viewerApp),r}return(0,A._)(n,[{key:"author",get:function(){return Ep(this).getMetadataValue("Author")},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return Ep(this).setMetadataValue("Author",e)}},{key:"calculate",get:function(){return Ip(this).calculationEnabled},set:function(e){return Ip(this).calculationEnabled=e}},{key:"creationDate",get:function(){return Ep(this).getMetadataValue("CreationDate")},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return Ep(this).setMetadataValue("CreationDate",e)}},{key:"dirty",get:function(){return this._dirty},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return this._dirty=e}},{key:"docID",get:function(){return Ep(this).info.fileID.slice(0,2)}},{key:"creator",get:function(){return Ep(this).getMetadataValue("Creator")},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return Ep(this).setMetadataValue("Creator",e)}},{key:"documentFileName",get:function(){return Ep(this).info.fileName}},{key:"external",get:function(){return!1}},{key:"filesize",get:function(){return Ep(this).info.fileSize}},{key:"info",get:function(){return Ep(this).metadata}},{key:"icons",get:function(){return Ep(this).getNameTreeIcons()}},{key:"keywords",get:function(){return Ep(this).getMetadataValue("Keywords")}},{key:"layout",get:function(){switch(this.jsEngine.PDFViewer.getPDFDocRender().getViewMode().constructor.getName()){case"single-page-view-mode":return"SinglePage";case"continuous-view-mode":return"OneColumn";case"facing-page-view-mode":return"TwoPageLeft";case"facing-continuous-page-view-mode":return"TwoColumnLeft";case"h-continuous-view-mode":return"OneRow"}}},{key:"modDate",get:function(){return Ep(this).getMetadataValue("ModDate")}},{key:"numFields",get:function(){return Ep(this).getPDFForm().getFieldCount()}},{key:"numPages",get:function(){return Ep(this).getPageCount()}},{key:"path",get:function(){return"c:/fakepath/"+Ep(this).info.fileName}},{key:"pageNum",get:function(){var e=this.jsEngine.PDFViewer,t=e.getCurrentActivatable();return t&&t.annot?t.annot.getPage().getIndex():e.getPDFDocRender().getCurrentViewMode().getCurrentPageIndex()},set:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck)return e>=this.numPages&&(e=this.numPages-1),this.jsEngine.PDFViewer.goToPage(e,0,0,!1),e}},{key:"templates",get:function(){}},{key:"addField",value:function(e,t,n,i){switch(t){case"text":t=6;break;case"button":t=1;break;case"combobox":t=4;break;case"listbox":t=5;break;case"checkbox":t=2;break;case"radiobutton":t=3;break;case"signature":return null}if(i[2]<i[0]){var r=i[0];i[0]=i[2],i[2]=r}if(i[3]>i[1]){var o=i[1];i[1]=i[3],i[3]=o}var a=Ip(this).addControl(n,e,t,{left:i[0],top:i[1],right:i[2],bottom:i[3]});return gv((function(){return a})),this.getField(e)}},{key:"getOCGs",value:function(){var e=[],t=Ep(this).ocgs;for(var n in t.children)Mp(t.children[n],e,Ep(this));return e}},{key:"getPrintParams",value:function(){return this.printParams}},{key:"getTemplate",value:function(e){if(!e||""===e)return null;if(this._arrTemplate.length<=0){var t=Ep(this).visibleTemplates;if(t&&t.length>0)for(var n=0;n<t.length;n++){if(e===t[n].name)return new wv(t[n],!1,Ep(this))}if((t=Ep(this).invisibleTemplates)&&t.length>0)for(var i=0;i<t.length;i++){if(e===t[i].name)return new wv(t[i],!0,Ep(this))}return null}for(var r=0;r<this._arrTemplate.length;r++){var o=this._arrTemplate[r];if(o.name===e)return o}return null}},{key:"removeTemplate",value:function(e){if(!e||""===e)return!1;if(Ep(this)){var t=this;Ep(this).removeTemplate(e).then((function(n){for(var i=0;i<t._arrTemplate.length;i++){if(t._arrTemplate[i].name===e){t._arrTemplate.splice(i,1);break}}}))}}},{key:"print",value:function(e,t,n,i,r,o,a,s,u){var c=this;if(!this.jsEngine.PDFViewer.webPDFSRPromise&&!this.jsEngine.getEvent().isSensitiveCheck){var l;l="object"==typeof e?{startIndex:e.firstPage,endIndex:e.lastPage,silent:e.interactive,printType:["page","annot"]}:u?{startIndex:u.firstPage,endIndex:u.lastPage+1,silent:u.interactive,printType:["page","annot"]}:{ui:e,startIndex:t,endIndex:n,silent:i,shrinkToFit:r,asImage:o,reverse:a,printType:["page","annot"]};var d=this.jsEngine.PDFViewer.getPDFDocRender();d&&d.isPrinting()||Ip(this).addTask((function(e){return c.jsEngine.PDFViewer.printPDFDocumentEx(l)}),!0)}}},{key:"addAnnot",value:function(e){return"FileAttachment"!==e.type&&"Sound"!==e.type?this.annotManage.addAnnot(e):this.annotManage.showFileDialog(e)}},{key:"syncAnnotScan",value:function(){return Ep(this).getAnnots()}},{key:"getAnnots",value:function(e){var t=function(){var e,t=u[c];if(!t)return c++,"continue";var n=Object.keys(t.annotIdMap);if(!n.length)return c++,"continue";var r=n.map((function(e){return{pageIndex:c,annot:t.annotIdMap[e]}}));if((e=l).push.apply(e,(0,I._)(r)),-1!==i)return"break";c++},n=this,i=-1,r=Dp,o=Cp,a=!1;e&&(e.nPage>=0&&(i=e.nPage),e.nSortBy>=0&&(o=e.nSortBy),e.nFilterBy>=0&&(r=e.nFilterBy),e.bReverse&&(a=e.bReverse));var s=this.numPages,u=Ep(this).pageCache,c=0,l=[];if(-1!==i&&(c=i),c>=s)return null;do{if("break"===t())break}while(c<s);var d=[];return l.map((function(e){var t=e.pageIndex,i=e.annot,r=n.annotManage.getAnnot(i,t);r&&d.push(r)})),this.annotManage.getAnnots(d,r,o,a)}},{key:"getAnnot",value:function(e,t){var n,i=Ep(this).pageCache;if(!(n=i[e]))return null;var r=Object.keys(n.annotIdMap);if(!r.length)return null;var o=r.map((function(e){return n.annotIdMap[e]})).find((function(e){return e.getName()==t}));return o?this.annotManage.getAnnot(o,e,this.jsApp):null}},{key:"calculateNow",value:function(){}},{key:"closeDoc",value:function(){this.jsEngine.getEvent().isSensitiveCheck||this.jsEngine.closeDoc()}},{key:"deletePages",value:function(e){var t=e.nStart,n=e.nEnd;return void 0===t&&(t=0),void 0===n&&(n=0),t===n?Ep(this).removePages([[t]]):Ep(this).removePages([[t,n],[n]])}},{key:"exportAsFDF",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.aFields,n=e.bAnnotations,i=void 0!==n&&n,r=Ep(this),o=this.documentFileName.replace(/.pdf$/i,".fdf"),a=1;i&&(a=3);var s=Promise.resolve(),u=[];t&&(s=r.getAnnots().then((function(e){e.forEach((function(e){e.forEach((function(e){var n=e.objectNumber,i=e.getPage().getId();if(t.indexOf(n)>-1){var r=u[i]||[];r.push(n),u[i]=r}}))}))}))),s.then((function(){return r.api.exportToFDF(r.id,0,a,u)})).then((function(e){Fa(e,o,"application/vnd.fdf")}))}},{key:"getField",value:function(e){if(!e)return null;var t,n=Ep(this).getPDFForm().getField(e);return n||(t=Ep(this).getPDFForm().getField(e,!0))?Rp[e]?(Rp[e]._update(n,t),Rp[e]):Rp[e]=new kv(this.jsEngine,n,t):null}},{key:"getNthFieldName",value:function(e){if("number"!=typeof e&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid index number: "+e);return Ep(this).getPDFForm().getFieldByIndex(e).getName()}},{key:"getPageBox",value:function(e,t){return[0,0,612,792]}},{key:"getPageRotation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return 90*Ep(this).pageCache[e].getRotation()}},{key:"getURL",value:function(){}},{key:"importAnFDF",value:function(){var e=this,t="import-an-fdf",n=document.querySelector("."+t);n&&n.remove();var i=document.createElement("label");i.setAttribute("class",t),i.style.display="none";var r=document.createElement("input");r.type="file",r.accept=".fdf",i.addEventListener("change",(function(t){var n=t.target.files[0];Ep(e).importFormFromFile(n,0),i.remove()})),i.appendChild(r),document.body.append(i),setTimeout((function(){i.click()}),100)}},{key:"removeField",value:function(e){delete Rp[e],Ip(this).removeField(e)}},{key:"resetForm",value:function(e){if(!this.jsEngine.getEvent().isSensitiveCheck){var t,n=this.jsEngine.PDFViewer.getCurrentActivatable();n&&n.annot&&(t=n.annot.getField()),Ip(this).resetForm(e,0,t)}}},{key:"submitForm",value:function(e,t,n,i,r,o,a,s,u,c,l,d,h,f,g,v,p,m,y,k,b,w,_,P){var A=this,S=this.jsEngine.PDFViewer;if(!this.jsEngine.getEvent().isSensitiveCheck){var x=0;switch(1===arguments.length&&"object"==typeof arguments[0]&&(e=arguments[0].cURL,t=arguments[0].bFDF,n=arguments[0].bEmpty,i=arguments[0].aFields,r=arguments[0].bGet,o=arguments[0].bAnnotations,a=arguments[0].bXML,s=arguments[0].bIncrChanges,u=arguments[0].bPDF,c=arguments[0].bCanonical,l=arguments[0].bExclNonUserAnnots,d=arguments[0].bExclFKey,h=arguments[0].cPassword,f=arguments[0].bEmbedForm,g=arguments[0].oJavaScript,v=arguments[0].cSubmitAs,p=arguments[0].bInclNMKey,m=arguments[0].aPackets,y=arguments[0].cCharset,k=arguments[0].oXML,b=arguments[0].cPermID,w=arguments[0].cInstID,_=arguments[0].cUsageRights,P=arguments[0].bHTMLForm),r&&(x|=fn.FlagGetMethod),(u||"PDF"==v)&&(x|=fn.FlagSubmitAsPDF),(d||"EXCL"==v)&&(x|=fn.FlagExclFKey),P&&(x|=fn.FlagExportFormat),v){case"FDF":break;case"XFDF":x|=fn.FlagAsXFDF;break;case"HTML":x|=fn.FlagExportFormat;break;case"XDP":case"XML":case"XFD":return void console.error("not support submition format")}var C=S.i18n.t("viewer_:pdfjs.safeModeSubmit",{URL:e,interpolation:{escapeValue:!1}});confirm(C)&&Ip(this).submitForm(e,i,x).catch((function(e){A.jsApp.alert(S.i18n.t("viewer_:error.c-1"))}))}}},{key:"cleanFields",value:function(){Rp={}}},{key:"createIcon",value:function(e,t,n){return{name:"",stream:e,width:t,height:n}}},{key:"getAnnot3D",value:function(e,t){var n=Ep(this).pageCache[e];if(n){var i=Object.keys(n.annotIdMap);if(i.length){var r=i.map((function(e){return n.annotIdMap[e]})).find((function(e){return"3d"===e.getType()&&e.getName()==t}));if(r)return this.annotManage.getAnnot(r,e,this.jsApp)}}}},{key:"getAnnots3D",value:function(e){var t=this,n=this.numPages,i=Ep(this).pageCache;if(!(e>=n||e<0)){var r=i[e];if(r){var o=Object.keys(r.annotIdMap);if(o.length){var a=[];return o.map((function(n){var i=r.annotIdMap[n];if("3d"==i.getType()){var o=t.annotManage.getAnnot(i,e,t.jsApp);o&&a.push(o)}})),a}}}}}],[{key:"name",get:function(){return"Doc"}}]),n}(nv),Mp=function(e,t,n){for(var i in e.hasLayer&&t.push(new xp(e.id,e,n)),e.children)Mp(e.children[i],t,n)},Op=function(e){switch(Object.prototype.toString.call(e)){case"[object String]":return["true","t","yes","y","on","1"].includes(e.trim().toLowerCase());case"[object Number]":return 1===e.valueOf();case"[object Boolean]":return e.valueOf();default:return!1}},Lp=RegExp("(?:%(?<flag>([+0-]|-\\+))?(?<width>\\d+)?(?<position>\\d+\\$)?(?<precision>\\.\\d+)?(?<conversion>[%BCESb-iosux]))|(\\\\%)","g"),Np=function(e,t){return t.placeholder},Vp=function(e){var t,n=function(e,t,n){return"-"===n?e.padEnd(t," "):"-+"===n?((Number(e)>=0?"+":"")+e).padEnd(t," "):"+"===n?((Number(e)>=0?"+":"")+e).padStart(t," "):"0"===n?e.padStart(t,"0"):e.padStart(t," ")},i=null!==(t=null==e?void 0:e.formatUnboundExpression)&&void 0!==t?t:Np,r={};return function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),a=1;a<t;a++)o[a-1]=arguments[a];var s=r[e];s||(s=r[e]=function(e){for(var t,n=[],i=0,r=0,o=null;null!==(t=Lp.exec(e));){t.index>r&&(o={literal:e.slice(r,t.index),type:"literal"},n.push(o));var a=t[0];r=t.index+a.length,"\\%"===a||"%%"===a?o&&"literal"===o.type?o.literal+="%":(o={literal:"%",type:"literal"},n.push(o)):t.groups&&(o={conversion:t.groups.conversion,flag:t.groups.flag||null,placeholder:a,position:t.groups.position?Number.parseInt(t.groups.position,10)-1:i++,precision:t.groups.precision?Number.parseInt(t.groups.precision.slice(1),10):null,type:"placeholder",width:t.groups.width?Number.parseInt(t.groups.width,10):null},n.push(o))}return r<=e.length-1&&(o&&"literal"===o.type?o.literal+=e.slice(r):n.push({literal:e.slice(r),type:"literal"})),n}(e));var u="",c=!0,l=!1,d=void 0;try{for(var h,f=s[Symbol.iterator]();!(c=(h=f.next()).done);c=!0){var g=h.value;if("literal"===g.type)u+=g.literal;else{var v=o[g.position];if(void 0===v)u+=i(e,g,o);else if("b"===g.conversion)u+=Op(v)?"true":"false";else if("B"===g.conversion)u+=Op(v)?"TRUE":"FALSE";else if("c"===g.conversion)u+=v;else if("C"===g.conversion)u+=String(v).toUpperCase();else if("i"===g.conversion||"d"===g.conversion)v=String(Math.trunc(v)),null!==g.width&&(v=n(v,g.width,g.flag)),u+=v;else if("e"===g.conversion)u+=Number(v).toExponential();else if("E"===g.conversion)u+=Number(v).toExponential().toUpperCase();else if("f"===g.conversion)null!==g.precision&&(v=Number(v).toFixed(g.precision)),null!==g.width&&(v=n(String(v),g.width,g.flag)),u+=v;else if("o"===g.conversion)u+=(Number.parseInt(String(v),10)>>>0).toString(8);else if("s"===g.conversion)null!==g.width&&(v=n(String(v),g.width,g.flag)),u+=v;else if("S"===g.conversion)null!==g.width&&(v=n(String(v),g.width,g.flag)),u+=String(v).toUpperCase();else if("u"===g.conversion)u+=Number.parseInt(String(v),10)>>>0;else{if("x"!==g.conversion)throw new Error("Unknown format specifier.");v=(Number.parseInt(String(v),10)>>>0).toString(16),null!==g.width&&(v=n(String(v),g.width,g.flag)),u+=v}}}}catch(e){l=!0,d=e}finally{try{c||null==f.return||f.return()}finally{if(l)throw d}}return u}}(),Bp=function(){function e(t){(0,P._)(this,e),this.jsGlobalAPI=t}return(0,A._)(e,[{key:"isDigit",value:function(e){return e>="0"&&e<="9"}},{key:"parstDataType",value:function(e){for(var t=!1,n=0;n<e.length;n++){var i=e.substr(n,1);if("%"!==i){if(t){if("c"==i||"C"==i||"d"==i||"i"==i||"o"==i||"u"==i||"x"==i||"X"==i)return 0;if("e"==i||"E"==i||"f"==i||"g"==i||"G"==i)return 1;if("s"==i||"S"==i)return 2;if("."==i||"+"==i||"-"==i||"#"==i||" "==i||"l"==i||this.isDigit(i))continue;break}}else t=!0}return-1}},{key:"printd",value:function(e,t,n){if(!t||(0,D._)(!t,Date)||isNaN(t.getTime()))return"";if(e){if("string"==typeof e)return this.jsGlobalAPI.FXFormatDate(e,t);if("number"==typeof e)switch(e){case 0:var i="D:";return i+=t.getFullYear(),i+=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,i+=t.getDate()<10?"0"+t.getDate():t.getDate(),i+=t.getUTCHours()<10?"0"+t.getUTCHours():t.getUTCHours(),i+=t.getUTCMinutes()<10?"0"+t.getUTCMinutes():t.getUTCMinutes(),i+=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();case 1:i="";return i+=t.getFullYear()+".",i+=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,i+=".",i+=t.getDate()<10?"0"+t.getDate():t.getDate(),i+=" ",i+=t.getUTCHours()<10?"0"+t.getUTCHours():t.getUTCHours(),i+=":",i+=t.getUTCMinutes()<10?"0"+t.getUTCMinutes():t.getUTCMinutes(),i+=":",i+=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();case 2:i="";return i+=t.getFullYear()+"/",i+=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,i+="/",i+=t.getDate()<10?"0"+t.getDate():t.getDate(),i+=" ",i+=t.getUTCHours()<10?"0"+t.getUTCHours():t.getUTCHours(),i+=":",i+=t.getUTCMinutes()<10?"0"+t.getUTCMinutes():t.getUTCMinutes(),i+=":",i+=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();default:return""}return""}return""}},{key:"printf",value:function(e,t){if(!e||!t)return"";(0,D._)(t,Array)||(t=[t]);var n=arguments.length;if(n<1)return"";var i=e,r=(e=e.replace("%+d","%+1d")).indexOf("%,"),o=!1,a=",";if(-1!=r){var s=parseInt(e.substr(r+2,1));if(s>4)return"";switch(s){case 0:o=!0,a=",",".";break;case 1:".";break;case 2:o=!0,a=".",",";break;case 3:","}var u="0",c=e.substr(r+3,1);"0"===c?u="0":"+"===c&&(u="+");var l=0,d=e.indexOf(".",r+4);l=d>r+3?parseInt(e.substr(r+4,d-r-4)):parseInt(e.substr(r+4,1));var h=e.length;if(d>-1&&r+d<h){var f=e.substr(r+1,d-1);e=e.replace(f,"")}else if("."===c&&-1===d){d=r+3;f=e.substr(r+1,d-1);e=e.replace(f,"")}else{var g=h-2;if(!(r+1+g<h&&g>=0))return t;f=e.substr(r+1,g);e=e.replace(f,"")}}var v=0,p=0,m=e;m="S"+m;for(var y=new Array,k=!1;-1!=v;){var b="";b=-1===(p=m.indexOf("%",v+1))?m.substr(v):m.substr(v,p-v),y.push(b),v=p}for(var w="",_="",P=0;P<y.length;P++)if(_=w,_+=y[P],0!==P){if(P>=n)break;var A=void 0;switch(this.parstDataType(_)){case 0:var S=parseInt(t[P-1]);if(isNaN(S)&&(S=0),_.indexOf("%x")>-1){var x=_.split("%x"),C=Vp("%x",S).toLocaleUpperCase();x.splice(1,0,C),A=x.join("")}else A=Vp(_,S);k=!0;break;case 1:var E=parseFloat(t[P-1]);isNaN(E)&&(E=0),A=Vp(_,E),k=!0;break;case 2:var I=parseFloat(t[P-1]);isNaN(I)&&(I=""),A=Vp(_,I)}w=A}else w=_;""===w&&(i.replace("%,","%"),w=i);var R=(w=w.substr(1)).indexOf(".");if(R<0)R=w.length;else{f=(w=w.slice(0,R)+"."+w.slice(R)).substr(R+1,1);w=w.replace(f,"")}if(o&&k)for(var T=R-3;T>0;T-=3)w=w.slice(0,T)+a+w.slice(T);var F=w.length;if(l>F)for(T=0;T<l-F;T++)w=u+w;return w}},{key:"printx",value:function(e,t){if(!e||!t)return"";for(var n=t.length,i=e.length,r="",o=0,a=0;a<i;a++){var s=e[a];switch(s){case"?":r+=t[o],o++;break;case"X":for(;o<n;){if(t[o]>="0"&&t[o]<="9"||t[o]>="a"&&t[o]<="z"||t[o]>="A"&&t[o]<="Z"){r+=t[o],o++;break}o++}break;case"A":for(;o<n;){if(t[o]>="a"&&t[o]<="z"||t[o]>="A"&&t[o]<="Z"){r+=t[o],o++;break}o++}break;case"9":for(;o<n;){if(t[o]>="0"&&t[o]<="9"){r+=t[o],o++;break}o++}break;case"*":r+=t.substring(o),o=n-1;break;case"\\":case"=":break;case">":t=t.toLocaleUpperCase();break;case"<":t=t.toLocaleLowerCase();break;default:r+=s}}return r}},{key:"scand",value:function(e,t){return new Date(t)}}]),e}(),jp=g(4563),Up=g.n(jp);const Hp={Times:"Times-Roman",TimesB:"Times-Bold",TimesI:"Times-Italic",TimesBI:"Times-BoldItalic",Helv:"Helvetica",HelvB:"Helvetica-Bold",HelvI:"Helvetica-Oblique",HelvBI:"Helvetica-BoldOblique",Cour:"Courier",CourB:"Courier-Bold",CourI:"Courier-Oblique",CourBI:"Courier-BoldOblique",Symbol:"Symbol",ZapfD:"ZapfDingbats"};var Wp=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"setHandler",value:function(e){this.handler=e}},{key:"clear",value:function(){this.impl?this.impl.clear():window.console.clear()}},{key:"show",value:function(){return this.handler("show"),!0}},{key:"hide",value:function(){return!0}},{key:"println",value:function(e){(0,D._)(e,Object)&&(e=e.toString()),window.console.log(e)}}]),n}(nv);var Yp={border:{s:"solid",b:"beveled",d:"dashed",i:"inset",u:"underline"},style:{ch:"check",cr:"cross",di:"diamond",ci:"circle",st:"star",sq:"square"},display:{visible:0,hidden:1,noPrint:2,noView:3},global:{setPersistent:function(){}},console:new Wp,color:uv,font:Hp,scaleWhen:vv};for(var qp in Yp){var Kp=function(){};Kp.prototype=Object.freeze(Yp[qp]),Yp[qp]=new Kp}var $p=function(){function e(t,n){(0,P._)(this,e),this._JSEngine=t,this._app=n}return(0,A._)(e,[{key:"__destroy__",value:function(){this._app=null,this._JSEngine=null}},{key:"JSEngine",get:function(){if(!this._JSEngine)throw new Error("JSEngine is not initialized or destroyed!");return this._JSEngine}},{key:"app",get:function(){if(!this._app)throw new Error("JSEngine is not initialized or destroyed!");return this._app}},{key:"setJSEvent",value:function(e){window.jsEvent=e,this.jsEvent=e}},{key:"AFSimple_Calculate",value:function(e,t){return gp.AFSimple_Calculate(this.JSEngine,e,t)}},{key:"AFRange_Validate",value:function(e,t,n,i){return gp.AFRange_Validate(this.JSEngine,this.app,e,t,n,i)}},{key:"AFNumber_Format",value:function(e,t,n,i,r,o){return gp.AFNumber_Format(this.JSEngine,this._app,e,t,n,i,r,o)}},{key:"AFTime_Format",value:function(e){return gp.AFTime_Format(this.JSEngine,this._app,e)}},{key:"AFTime_FormatEx",value:function(e){return gp.AFTime_FormatEx(this.JSEngine,this._app,e)}},{key:"AFTime_Keystroke",value:function(e){return gp.AFDate_KeystrokeEx(this.JSEngine,this._app,e)}},{key:"AFTime_KeystrokeEx",value:function(e){return gp.AFDate_KeystrokeEx(this.JSEngine,this._app,e)}},{key:"AFDate_FormatEx",value:function(e){return gp.AFDate_FormatEx(this.JSEngine,this._app,e)}},{key:"AFPercent_Format",value:function(e,t){return gp.AFPercent_Format(this.JSEngine,this._app,e,t)}},{key:"AFMergeChange",value:function(e){return gp.AFMergeChange(e)}},{key:"AFNumber_Keystroke",value:function(e,t,n,i,r,o){return gp.AFNumber_Keystroke(this.JSEngine,this._app,e,t,n,i,r,o)}},{key:"AFParseDateEx",value:function(e,t){return gp.AFParseDateEx(e,t)}},{key:"AFMakeNumber",value:function(e){return gp.AFMakeNumber(e)}},{key:"AFDate_KeystrokeEx",value:function(e){return gp.AFDate_KeystrokeEx(this.JSEngine,this._app,e)}},{key:"AFSpecial_Format",value:function(e){return gp.AFSpecial_Format(this.JSEngine,this.app,e)}},{key:"FXFormatDate",value:function(e,t){return gp.FXFormatDate(e,t)}},{key:"AFSpecial_Keystroke",value:function(e){return gp.AFSpecial_Keystroke(this.JSEngine,this._app,e)}},{key:"AFPercent_Keystroke",value:function(e){return gp.AFPercent_Keystroke(this.JSEngine,this._app,(0,k._)({},e))}},{key:"AFSpecial_KeystrokeEx",value:function(e){return gp.AFSpecial_KeystrokeEx(this.JSEngine,this._app,e)}}]),e}();Object.keys(gp).forEach((function(e){"function"!=typeof gp[e]&&($p[e]=gp[e])})),Object.assign($p.prototype,Yp);var zp=URL.createObjectURL(new Blob([Up()({})],{type:"text/html"})),Gp="ActiveXObject"in self||navigator.userAgent.toLowerCase().match(/msie [\d\.]+/)||navigator.userAgent.toLowerCase().match(/MicroMessenger/i)||navigator.userAgent.toLowerCase().match(/mibrowser/i)||navigator.userAgent.toLowerCase().match(/Html5Plus/i);var Jp=function(){function e(t,n,i,r){(0,P._)(this,e),this.JSEngine=t;var o=function(e){(0,C._)(o,e);var r=(0,T._)(o);function o(){var e;(0,P._)(this,o),(e=r.call(this,t,n)).util=new Bp((0,w._)(e));var a=(0,w._)(e),s=new Proxy(i,{has:function(e,t){return Reflect.has(e,t)||Reflect.has(a,t)},set:function(e,t,n,i){return Reflect.has(a,t)&&!Reflect.has(e,t)?Reflect.set(a,t,n,a):Reflect.set(e,t,n,i)},get:function(e,t,n){return Reflect.has(e,t)?Reflect.get(e,t,n):Reflect.get(a,t,a)}});return e.doc=s,e.this=s,e.getEvent=function(e){return t.getEvent(e)},e.postRunScripts=function(e){return t.postRunScripts(e)},e}return o}($p);this.globalVariables=new o,this.noFrame=Gp||r}return(0,A._)(e,[{key:"init",value:function(){var e,t,n,i=this;if(!this.noFrame)return this.preFrame=document.createElement("iframe"),this.preFrame.style.display="none",this.preFrame.style.position="absolute",this.preFrame.style.top=0,this.enable=!1,new Promise((function(e,t){i.preFrame.onload=e,i.preFrame.onerror=t,i.preFrame.src=zp,document.body.appendChild(i.preFrame)})).then((function(e){i.enable=!0,i.preFrame.contentWindow.initJS(i.globalVariables)}));e=this.globalVariables,t=new function(){var e=this,t=function(t){if(t[0].toLowerCase()!==t[0])return"continue";Object.defineProperty(e,t,{get:function(){return window[t]},set:function(e){window[t]=e}})},n=Object.getOwnPropertyDescriptors(window);for(var i in delete n.self,delete n.top,delete n.parent,delete n.globalThis,delete n.global,n)t(i);this.top=this,this.parent=window,this.self=this,this.globalThis=this,this.global=this},n=function(){var n=["jsEngine","_calculate","_dirty","_layout","_arrTemplate","printParams","annotManage","timeStamp","cleanFields"],i=e.doc;for(var r in i)-1==n.indexOf(r)&&function(e){"function"==typeof i[e]?t[e]=function(){return i[e].apply(i,arguments)}:Object.defineProperty(t,e,{get:function(){return i[e]},set:function(t){i[e]=t}})}(r);return{docClosure:function(n){return new Function("f","globals","window","with(globals){with(globals.doc){eval(f);return function(f){return eval(f);}}}")(n,e,t)}}}(),t.appClosure=e.appClosure=n,t.runJS=e.runJS=function(t,i){var r=e.doc;e.event=i,r.timeStamp=i&&i.timeStamp;var o=function(){try{var i=Array.from(new Set(t.code.split(/\W/))).filter((function(e){r.exec||(r.exec=n.docClosure(""));try{return r.exec(e),!1}catch(e){return!0}}));r.exec=n.docClosure.call(r,t.code),i.forEach((function(t){try{var n=r.exec(t);e[t]=n}catch(e){}}))}catch(e){r.exec=n.docClosure(t.code),console.error(e)}};switch("string"==typeof t.code&&(t.code=t.code.replace(/window\.open/g,"")),t.action){case"execute":r.exec(t.code,t,i);break;case"reset":o();break;default:t.global&&o()}},this.enable=!0}},{key:"exec",value:function(e,t,n,i){var r={action:"execute",code:e,global:t,event:n.event};this.enable||console.error("js env is not ready!!");var o=this.JSEngine.events[r.event];return this.noFrame?this.globalVariables.runJS(r,o):this.preFrame.contentWindow.runJS&&this.preFrame.contentWindow.runJS(r,o),o&&o.rc}},{key:"resetClosure",value:function(e){var t={action:"reset",code:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",event:e.event};this.enable||console.error("js env is not ready!!");var n=this.JSEngine.events[t.event];return this.noFrame?this.globalVariables.runJS(t,n):this.preFrame.contentWindow.runJS&&this.preFrame.contentWindow.runJS(t,n),n.rc}},{key:"destroy",value:function(){this.globalVariables&&(this.globalVariables.__destroy__(),this.globalVariables=null),this.JSEngine=null,!this.noFrame&&this.preFrame&&(document.body.removeChild(this.preFrame),this.preFrame=null)}}]),e}();const Xp=Jp;var Zp=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),(e=t.call(this)).change="",e.changeEx="",e.commitKey="",e.fieldFull="",e.keyDown="",e.modifier="",e.name="",e.rc="",e.richChange="",e.richChangeEx="",e.richValue="",e.selEnd="",e.selStart="",e.shift="",e.source="",e.target="",e.targetName="",e.type="",e.willCommit="",e.bExtractDenpends=!1,e.depends=[],e.isLoading=!1,e.isSensitiveCheck=!1,e}return(0,A._)(n,[{key:"value",get:function(){return this.v},set:function(e){this.v=e,this.valueSetted=!0}}],[{key:"name",get:function(){return"event"}}]),n}(nv);const Qp=Zp;var em=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i,r=function(t){t in(0,w._)(i)||Object.defineProperty((0,w._)(i),t,{get:function(){return e[t]},set:function(n){e[t]=n}})};for(var o in(0,P._)(this,n),(i=t.call(this)).app=e,e)r(o);return i}return(0,A._)(n,[{key:"setActionCallback",value:function(e){this.actionCallback=e}},{key:"alert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;return this.actionCallback&&"function"==typeof this.actionCallback.alert?"object"!=typeof e||Array.isArray(e)||1!==arguments.length?this.actionCallback.alert({cMsg:e,nIcon:t,nType:n,cTitle:i}):this.actionCallback.alert(e):this.app.alert.apply(this.app,arguments)}},{key:"alertAsync",value:function(e){return this.actionCallback&&this.actionCallback.alertAsync?this.actionCallback.alertAsync(e):this.app.alertAsync.apply(this.app,arguments)}}]),n}(j.Proxy.getProxyClass(hv,(function(e,t,n,i,r){var o=e.actionCallback;switch(r){case"method":return o&&"function"==typeof o[i]?o[i].apply(o,n):t.apply(e.app,n);case"getter":return e.app[i];case"setter":e.app[i]=n[0]}}),null));var tm=function(){function e(t){var n=this;(0,P._)(this,e),this.events={},this.tasks=[],this.curEvent=null,this.PDFViewer=t,this.hasInitAnnots=!1;var i=t.config.enableJS;this.enableJS=null==i||i;var r=new hv(this,t),o=new em(r);this.originJSApp=r,this.app=o;var a=new Fp(this,o),s=t.config.noJSFrame;this.jsEnv=new Xp(this,o,a,s),setTimeout((function(){n.jsEnv.init()}),0),this.cacheJSDoc=a,this.PDFViewer.eventEmitter.on("open-file-success",(function(e){n.cacheJSDoc.dirty=!1,Tp(),Pv()})),this.PDFViewer.eventEmitter.on("will-close-document",(function(e){n.cacheJSDoc.dirty=!1,n.events={},n.curEvent=null,Tp(),Pv()})),this.jsEnv.globalVariables.console.setHandler((function(e){"show"==e&&n.PDFViewer.eventEmitter.emit("show-js-console")})),this.PDFViewer.eventEmitter.on("doc-modified",(function(){n.cacheJSDoc.dirty=!0}))}return(0,A._)(e,[{key:"setConsoleImpl",value:function(e){this.jsEnv.globalVariables.console=e}},{key:"setActionCallback",value:function(e){if(e){var t=new e(this.originJSApp);t.app||(t.app=this.originJSApp),this.app.setActionCallback(t)}else this.app.setActionCallback(null)}},{key:"setStatus",value:function(e,t){this.status=e,this.eventSource=t}},{key:"getEvent",value:function(e){return e?this.events[e]:this.events[this.cacheJSDoc.timeStamp||this.curEvent]||{}}},{key:"getEnableJS",value:function(){return this.enableJS}},{key:"setEnableJS",value:function(e,t){var n=this.enableJS;if(this.enableJS=e,!n&&e&&t){var i=t.getJsNameTree(),r="";for(var o in i)r+=i[o]+"\n";var a=t.action;a&&a.getScript&&(r+=a.getScript()),this.initEvent(13,null,null,"Init"),this.resetClosure(r)}}},{key:"resetClosure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.enableJS&&this.jsEnv.resetClosure({event:this.curEvent},e)}},{key:"getPDFDoc",value:function(){return this.PDFViewer.currentPDFDoc}},{key:"getFieldValue",value:function(e){var t=this.getPDFForm().getField(e);return t&&t.getValue()}},{key:"getPDFForm",value:function(){return this.getPDFDoc().getPDFForm()}},{key:"destroyEvent",value:function(e){e.target=null,e.engineTarget=null,e.source=null,e.doc=null}},{key:"initEvent",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};"Init"==i&&(this.events={},this.cacheJSDoc.cleanFields());var o=new Qp;o.engineTarget=n,o.name=i;var a=(new Date).valueOf()+""+i+"yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*rr()|0;return("x"==e?t:3&t|8).toString(16)}));for(t&&(a+=t.getName()+"_"),this.cacheJSDoc!==n?(o.target=this.cacheJSDoc.getField(n&&n.getName()),o.source=this.cacheJSDoc.getField(t&&t.getName()),n&&(a+=n.getName())):o.target=n,o.type=e,o.rc=!0,o.v="";this.events[a];)a+="p";o.timeStamp=this.curEvent=a,this.events[a]=o,o.changed=!1;var s=void 0;for(var u in Object.defineProperty(o,"change",{get:function(){return s},set:function(e){s=e,o.changed=!0}}),o.param=r,r)o[u]=r[u];switch(i){case vo.FieldKeyStroke:o.v=n.getValue(),o.changeEx=n.getValue(),o.targetName=n.getName();break;case vo.FieldRecalculateValue:case vo.FieldValueChanged:o.v=n.getValue(),o.targetName=n.getName();break;case"WillPrint":break;case"Focus":case vo.AnnotReceiveInputFocus:o.v=n.getValue(),o.targetName=n.getName();break;case"DidPrint":break;case"Blur":case vo.AnnotLoseInputFocus:o.v=n.getValue(),o.targetName=n.getName();break;case"WillSave":break;case"Format":case vo.FieldWillFormat:o.rc=!0,o.v=n.getValue(),o.targetName=n.getName();break;case vo.AnnotMouseButtonPressed:o.v=n.getValue(),o.targetName=n.getName()}return a}},{key:"closeDoc",value:function(){this.PDFViewer.close()}},{key:"postRunScripts",value:function(e){var t="";switch(e.name){case vo.FieldRecalculateValue:if(t=e.rc,void 0!==e.value&&e.valueSetted){var n=e.engineTarget,i=n.getType();if(4===i||5===i){var r=n.getOptions();r.forEach((function(t){t.value==e.value?t.selected=!0:t.selected=!1})),n.setOptions(r,!0),n.updateWidgetsUI(n.form,n.info.name,"setItems")}n.setValue(e.value)}break;case vo.FieldWillFormat:e.rc&&e.engineTarget.showDisplayValue(e.value),t={rc:e.rc,format:e.format,value:e.value};break;case vo.FieldKeyStroke:t=e.change,t={rc:e.rc,format:e.format,change:t};break;case vo.FieldValueChanged:t={rc:e.rc,format:e.format,value:e.value}}return"calculate"==this.status&&(this.getPDFForm().calculate(this.eventSource),this.status=""),this.destroyEvent(e),delete this.events[e.timeStamp],e=null,t}},{key:"handleJavaScripts",value:function(e,t,n){var i,r=this.events[n.event]||{};try{if(this.isBusy=!0,i=this.jsEnv.exec(e,!!t,n),this.isBusy=!1,"boolean"==typeof i)return this.postRunScripts(r)}catch(e){return this.isBusy=!1,r.rc=!0,this.postRunScripts(r),{ret:i=-1,errorInfo:e}}return i}},{key:"delayHandle",value:function(){var e=this,t=this.tasks;setTimeout((function(){if(e.isBusy)e.delayHandle();else for(var n=t.pop();n;)e.exec.apply(e,(0,I._)(n)),n=t.pop()}),10)}},{key:"exec",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e&&0!==e.trim().length&&this.enableJS?(n.event=n.event||this.curEvent,this.handleJavaScripts(e,t,n)):{rc:!0}}},{key:"waitForExecutionTask",value:function(){return(0,_._)((function(){var e;return(0,F.Jh)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,fv.waitForCurrentRunningTasks()];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return t.trys.push([3,5,,6]),[4,fv.waitUntilQuiet(10)];case 4:return t.sent(),[3,6];case 5:return e=t.sent(),j.LoggerFactory.getLogger("PDFJS",e),[3,6];case 6:return[2]}}))}))()}},{key:"destroy",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.waitForExecutionTask()];case 1:return t.sent(),e.PDFViewer=null,e.jsEnv.destroy(),[2]}}))}))()}}]),e}();const nm=tm;const im=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.stateHandlers={},this.currentStateHandler=ys,this.register(ys),this.config=t.config.stateHandlerConfig||(0,J._)({},dn.STATE_HANDLER_HAND,{enableTextSelectionTool:!0,enableAnnotationSelectionTool:!0})}return(0,A._)(e,[{key:"getStateHandlerConfig",value:function(e){return this.config[e]}},{key:"setStateHandlerConfig",value:function(e,t){this.config[e]=t}},{key:"mergeStateHandlerConfig",value:function(e,t){this.config[e]=(0,j.extendOptions)(this.config[e]||{},t)}},{key:"pushStateHandlerConfig",value:function(e,t){var n=this.config[e]||{};this.config[e]=Object.assign(n,t)}},{key:"register",value:function(e){this.stateHandlers[e.getStateName()]=e}},{key:"unregister",value:function(e){var t=this.stateHandlers[e];this.currentStateHandler===t&&this.switchTo(ys.getStateName()),delete this.stateHandlers[e]}},{key:"get",value:function(e){return this.stateHandlers[e]||ys}},{key:"switchTo",value:function(e,t){var n=this.pdfViewer.eventEmitter,i=this.currentStateHandler,r=this.get(e);if(n.emit(de.beforeSwitchStateHandler,r,i),t&&r.setParams(t,this.pdfViewer),i!==r){this.currentStateHandler=r,e&&this.pdfViewer.activeElement(null),n.emit(de.deactiveStateHandler,i),n.emit(de.switchStateHandler,r,i,t);var o=this.pdfViewer.pdfViewerRender;if(o){var a=o.pdfDocRender;if(a){a.setStateHandler(r);var s=a.pagesRender;if(s){var u=s.pageRenders;if(u)for(var c=0,l=u.length;c<l;c++){u[c].stateHandler&&u[c].setStateHandler(r)}}}}}}},{key:"getCurrentStates",value:function(){return this.currentStateHandler}}]),e}();var rm=function(){function e(){(0,P._)(this,e),this.password=null,this.dataURL=null,this.encipherment=null,this.isEncryption=!1}return(0,A._)(e,[{key:"getPassword",value:function(){return this.password}},{key:"setPassword",value:function(e){var t=this.encipherment;this.password=t?t(e):e,this.isEncryption=!!t}},{key:"setEncryptionAlgorithm",value:function(e){this.encipherment=e}},{key:"verify",value:function(e){var t;this.isEncryption?t=this.encipherment(e)===this.password:t=e===this.password;return t}},{key:"getDataURL",value:function(){return this.dataURL}},{key:"setDataURL",value:function(e){this.dataURL=e}},{key:"export",value:function(){return{password:this.password,dataURL:this.dataURL,encipherment:this.encipherment,isEncryption:this.isEncryption}}},{key:"import",value:function(e){this.password=e.password,this.dataURL=e.dataURL,this.encipherment=e.encipherment,this.isEncryption=e.isEncryption}},{key:"base64ToArrayBuffer",value:function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n);n--;)i[n]=t.charCodeAt(n);return i}},{key:"arrayBufferToBase64",value:function(e){for(var t="",n=new Uint8Array(e),i=n.byteLength,r=0;r<i;r++)t+=String.fromCharCode(n[r]);return window.btoa(t)}}]),e}(),om=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.inkSignList=[],this.currentInkSign=null,this.onceInkSign=null}return(0,A._)(e,[{key:"getList",value:function(){return this.inkSignList}},{key:"push",value:function(e){var t=this.inkSignList.length;return this.inkSignList.push(e),this.pdfViewer.eventEmitter.emit(de.inkSignAdded,this.inkSignList),t}},{key:"delete",value:function(e){this.inkSignList.splice(e,1),this.pdfViewer.eventEmitter.emit(de.inkSignDeleted,this.inkSignList)}},{key:"get",value:function(e){return this.inkSignList[e]}},{key:"addInkSign",value:function(){return new rm}},{key:"setCurrentInkSign",value:function(e){this.currentInkSign=this.inkSignList[e]}},{key:"getCurrentInkSign",value:function(){return this.currentInkSign}},{key:"setOnceInkSign",value:function(e){this.onceInkSign=e}},{key:"getOnceInkSign",value:function(){return this.onceInkSign}},{key:"setCurrentInkSignByImg",value:function(e){var t=this.addInkSign();t.setDataURL(e);var n=this.push(t);this.setCurrentInkSign(n)}}]),e}(),am=function(){function e(){(0,P._)(this,e),this.password=null,this.dataURL=null,this.encipherment=null,this.isEncryption=!1,this.id="",this.styleId="",this.signType="",this.groupId="",this.moveHammer=null,this.resizeHammer=null,this.fieldType="",this.pageIndex=0}return(0,A._)(e,[{key:"setProperty",value:function(e,t){this[e]=t}},{key:"getProperty",value:function(e){return this[e]}},{key:"setMulProperty",value:function(e){for(var t in e)this[t]=e[t]}},{key:"getId",value:function(){return this.id}},{key:"setStyleId",value:function(e){this.styleId=e}},{key:"getStyleId",value:function(){return this.styleId}},{key:"setSignType",value:function(e){this.signType=e}},{key:"getGroupId",value:function(){return this.groupId}},{key:"setGroupId",value:function(e){this.groupId=e}},{key:"getSignType",value:function(){return this.signType}},{key:"getPassword",value:function(){return this.password}},{key:"setPassword",value:function(e){var t=this.encipherment;this.password=t?t(e):e,this.isEncryption=!!t}},{key:"setEncryptionAlgorithm",value:function(e){this.encipherment=e}},{key:"verify",value:function(e){var t;this.isEncryption?t=this.encipherment(e)===this.password:t=e===this.password;return t}},{key:"getDataURL",value:function(){return this.dataURL}},{key:"setDataURL",value:function(e){this.dataURL=e}},{key:"export",value:function(){return{password:this.password,dataURL:this.dataURL,encipherment:this.encipherment,isEncryption:this.isEncryption}}},{key:"import",value:function(e){this.password=e.password,this.dataURL=e.dataURL,this.encipherment=e.encipherment,this.isEncryption=e.isEncryption}},{key:"base64ToArrayBuffer",value:function(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n);n--;)i[n]=t.charCodeAt(n);return i}},{key:"arrayBufferToBase64",value:function(e){for(var t="",n=new Uint8Array(e),i=n.byteLength,r=0;r<i;r++)t+=String.fromCharCode(n[r]);return window.btoa(t)}}]),e}(),sm=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.onlineSignList=[],this.currentOnlineSign=null}return(0,A._)(e,[{key:"getList",value:function(){return this.onlineSignList}},{key:"push",value:function(e){var t=this.onlineSignList.length;return this.onlineSignList.push(e),this.pdfViewer.eventEmitter.emit(de.onlineSignAdded,this.onlineSignList),t}},{key:"delete",value:function(e){this.onlineSignList.splice(e,1),this.pdfViewer.eventEmitter.emit(de.onlineSignDeleted,this.onlineSignList)}},{key:"get",value:function(e){return this.onlineSignList[e]}},{key:"getSignatureById",value:function(e){return this.onlineSignList.find((function(t){return t.getId()===e}))}},{key:"addOnlineSign",value:function(){return new am}},{key:"addOnlineSignWithData",value:function(e){var t=new am;t.setMulProperty(e);var n=this.push(t);return this.setCurrentOnlineSign(n),{sign:t,index:n}}},{key:"setCurrentOnlineSign",value:function(e){this.currentOnlineSign=this.onlineSignList[e]}},{key:"getCurrentOnlineSign",value:function(){return this.currentOnlineSign}},{key:"setCurrentOnlineSignByImg",value:function(e){var t=this.addOnlineSign();t.setDataURL(e);var n=this.push(t);return this.setCurrentOnlineSign(n),{sign:t,index:n}}},{key:"clear",value:function(){this.onlineSignList=[]}}]),e}(),um=function(){function e(){(0,P._)(this,e),this._keyCodeToStr=[],this._strToKeyCode={}}return(0,A._)(e,[{key:"define",value:function(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}},{key:"keyCodeToStr",value:function(e){return this._keyCodeToStr[e]}},{key:"strToKeyCode",value:function(e){return this._strToKeyCode[e.toLowerCase()]||j.KeyCodes.Unknown}}]),e}(),cm=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,null,[{key:"toString",value:function(e){return lm.keyCodeToStr(e)}},{key:"fromString",value:function(e){return lm.strToKeyCode(e)}}]),e}(),lm=new um,dm=new um;!function(){var e=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach((function(t){lm.define(e,t),dm.define(e,t)}))};e(j.KeyCodes.Unknown,"unknown"),e(j.KeyCodes.Backspace,"Backspace"),e(j.KeyCodes.Tab,"Tab"),e(j.KeyCodes.Enter,"Enter"),e(j.KeyCodes.Shift,"Shift"),e(j.KeyCodes.Ctrl,"Ctrl"),e(j.KeyCodes.Alt,"Alt"),e(j.KeyCodes.PauseBreak,"PauseBreak"),e(j.KeyCodes.CapsLock,"CapsLock"),e(j.KeyCodes.Escape,"Escape"),e(j.KeyCodes.Space,"Space"),e(j.KeyCodes.PageUp,"PageUp"),e(j.KeyCodes.PageDown,"PageDown"),e(j.KeyCodes.End,"End"),e(j.KeyCodes.Home,"Home"),e(j.KeyCodes.LeftArrow,"LeftArrow","Left"),e(j.KeyCodes.UpArrow,"UpArrow","Up"),e(j.KeyCodes.RightArrow,"RightArrow","Right"),e(j.KeyCodes.DownArrow,"DownArrow","Down"),e(j.KeyCodes.Insert,"Insert"),e(j.KeyCodes.Delete,"Delete"),e(j.KeyCodes.KEY_0,"0"),e(j.KeyCodes.KEY_1,"1"),e(j.KeyCodes.KEY_2,"2"),e(j.KeyCodes.KEY_3,"3"),e(j.KeyCodes.KEY_4,"4"),e(j.KeyCodes.KEY_5,"5"),e(j.KeyCodes.KEY_6,"6"),e(j.KeyCodes.KEY_7,"7"),e(j.KeyCodes.KEY_8,"8"),e(j.KeyCodes.KEY_9,"9"),e(j.KeyCodes.KEY_A,"A"),e(j.KeyCodes.KEY_B,"B"),e(j.KeyCodes.KEY_C,"C"),e(j.KeyCodes.KEY_D,"D"),e(j.KeyCodes.KEY_E,"E"),e(j.KeyCodes.KEY_F,"F"),e(j.KeyCodes.KEY_G,"G"),e(j.KeyCodes.KEY_H,"H"),e(j.KeyCodes.KEY_I,"I"),e(j.KeyCodes.KEY_J,"J"),e(j.KeyCodes.KEY_K,"K"),e(j.KeyCodes.KEY_L,"L"),e(j.KeyCodes.KEY_M,"M"),e(j.KeyCodes.KEY_N,"N"),e(j.KeyCodes.KEY_O,"O"),e(j.KeyCodes.KEY_P,"P"),e(j.KeyCodes.KEY_Q,"Q"),e(j.KeyCodes.KEY_R,"R"),e(j.KeyCodes.KEY_S,"S"),e(j.KeyCodes.KEY_T,"T"),e(j.KeyCodes.KEY_U,"U"),e(j.KeyCodes.KEY_V,"V"),e(j.KeyCodes.KEY_W,"W"),e(j.KeyCodes.KEY_X,"X"),e(j.KeyCodes.KEY_Y,"Y"),e(j.KeyCodes.KEY_Z,"Z"),e(j.KeyCodes.Meta,"Meta"),e(j.KeyCodes.ContextMenu,"ContextMenu"),e(j.KeyCodes.F1,"F1"),e(j.KeyCodes.F2,"F2"),e(j.KeyCodes.F3,"F3"),e(j.KeyCodes.F4,"F4"),e(j.KeyCodes.F5,"F5"),e(j.KeyCodes.F6,"F6"),e(j.KeyCodes.F7,"F7"),e(j.KeyCodes.F8,"F8"),e(j.KeyCodes.F9,"F9"),e(j.KeyCodes.F10,"F10"),e(j.KeyCodes.F11,"F11"),e(j.KeyCodes.F12,"F12"),e(j.KeyCodes.F13,"F13"),e(j.KeyCodes.F14,"F14"),e(j.KeyCodes.F15,"F15"),e(j.KeyCodes.F16,"F16"),e(j.KeyCodes.F17,"F17"),e(j.KeyCodes.F18,"F18"),e(j.KeyCodes.F19,"F19"),e(j.KeyCodes.NumLock,"NumLock"),e(j.KeyCodes.ScrollLock,"ScrollLock"),e(j.KeyCodes.US_SEMICOLON,";",";","OEM_1"),e(j.KeyCodes.US_EQUAL,"=","=","OEM_PLUS"),e(j.KeyCodes.US_COMMA,",",",","OEM_COMMA"),e(j.KeyCodes.US_MINUS,"-","-","OEM_MINUS"),e(j.KeyCodes.US_DOT,".",".","OEM_PERIOD"),e(j.KeyCodes.US_SLASH,"/","/","OEM_2"),e(j.KeyCodes.US_BACKTICK,"`","`","OEM_3"),e(j.KeyCodes.ABNT_C1,"ABNT_C1"),e(j.KeyCodes.ABNT_C2,"ABNT_C2"),e(j.KeyCodes.US_OPEN_SQUARE_BRACKET,"[","[","OEM_4"),e(j.KeyCodes.US_BACKSLASH,"\\","\\","OEM_5"),e(j.KeyCodes.US_CLOSE_SQUARE_BRACKET,"]","]","OEM_6"),e(j.KeyCodes.US_QUOTE,"'","'","OEM_7"),e(j.KeyCodes.OEM_8,"OEM_8"),e(j.KeyCodes.OEM_102,"OEM_102"),e(j.KeyCodes.NUMPAD_0,"NumPad0"),e(j.KeyCodes.NUMPAD_1,"NumPad1"),e(j.KeyCodes.NUMPAD_2,"NumPad2"),e(j.KeyCodes.NUMPAD_3,"NumPad3"),e(j.KeyCodes.NUMPAD_4,"NumPad4"),e(j.KeyCodes.NUMPAD_5,"NumPad5"),e(j.KeyCodes.NUMPAD_6,"NumPad6"),e(j.KeyCodes.NUMPAD_7,"NumPad7"),e(j.KeyCodes.NUMPAD_8,"NumPad8"),e(j.KeyCodes.NUMPAD_9,"NumPad9"),e(j.KeyCodes.NUMPAD_MULTIPLY,"NumPad_Multiply"),e(j.KeyCodes.NUMPAD_ADD,"NumPad_Add"),e(j.KeyCodes.NUMPAD_SEPARATOR,"NumPad_Separator"),e(j.KeyCodes.NUMPAD_SUBTRACT,"NumPad_Subtract"),e(j.KeyCodes.NUMPAD_DECIMAL,"NumPad_Decimal"),e(j.KeyCodes.NUMPAD_DIVIDE,"NumPad_Divide")}();var hm,fm=function(){function e(t,n,i,r,o){(0,P._)(this,e),this.ctrlKey=t,this.shiftKey=n,this.altKey=i,this.metaKey=r,this.keyCode=o}return(0,A._)(e,[{key:"equals",value:function(e){return this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}},{key:"isError",value:function(){return this.keyCode===j.KeyCodes.Unknown}},{key:"toString",value:function(){var e=[];return this.ctrlKey&&e.push("ctrl"),this.shiftKey&&e.push("shift"),this.altKey&&e.push("alt"),this.metaKey&&e.push("meta"),e.join("+")+"+"+cm.toString(this.keyCode)}}]),e}(),gm=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,P._)(this,e),this.command=t,this.keybinding=n,this.priority=i}return(0,A._)(e,[{key:"equals",value:function(e){return this.keybinding.equals(e.keybinding)}}]),e}(),vm=function(){function e(){(0,P._)(this,e),this._keybindingRules=[]}return(0,A._)(e,[{key:"registerKeyBindingRule",value:function(e){var t=this._keybindingRules.filter((function(t){return t.equals(e)}));if(t.length>0){var n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(s.equals(e)){if(s.command===e.command)return void(s.priority=e.priority);throw new Error("shortcut conflict: ".concat(s.command," and ").concat(e.command," has the same keybindings: ").concat(e.keybinding.toString()))}}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}this._keybindingRules.push(e)}},{key:"unRegisterKeyBindingRule",value:function(e){var t=this._keybindingRules.findIndex((function(t){return t.equals(e)}));-1!==t&&this._keybindingRules.splice(t,1)}},{key:"getKeyBindings",value:function(e){return this._keybindingRules.filter((function(t){return t.command===e})).sort((function(e,t){return e.priority>t.priority?-1:1})).reduce((function(e,t){var n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){if(o.value.equals(t))return}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return e.push(t),e}),[]).map((function(e){return e.keybinding}))}},{key:"getCommandOfKeybinding",value:function(e){var t=this._keybindingRules.filter((function(t){return e.equals(t.keybinding)}));if(t.length>0)return t[0].command}}]),e}(),pm=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,null,[{key:"_readModifiers",value:function(e){e=e.trim().toLowerCase();var t,n,i=!1,r=!1,o=!1,a=!1;do{t=!1,/^ctrl[\+\-]/.test(e)&&(i=!0,e=e.substring(5),t=!0),/^shift[\+\-]/.test(e)&&(r=!0,e=e.substring(6),t=!0),/^alt[\+\-]/.test(e)&&(o=!0,e=e.substring(4),t=!0),/^meta[\+\-]/.test(e)&&(a=!0,e=e.substring(5),t=!0),/^win[\+\-]/.test(e)&&(a=!0,e=e.substring(4),t=!0),/^cmd[\+\-]/.test(e)&&(a=!0,e=e.substring(4),t=!0)}while(t);var s=e.indexOf(" ");return s>0?(n=e.substring(0,s),e=e.substring(s)):(n=e,e=""),{remains:e,ctrl:i,shift:r,alt:o,meta:a,key:n}}},{key:"parseKeybinding",value:function(e){var t=this._readModifiers(e),n=cm.fromString(t.key);return new fm(t.ctrl,t.shift,t.alt,t.meta,n)}}]),e}(),mm=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,P._)(this,e),this.registry=new vm,this.name=n,this.target=t,this.priority=i,this.isActive=!0,this.nextBinders=[],this.emitter=new(js()),this.beforeEventEmitter=new(js())}return(0,A._)(e,[{key:"setKeyboard",value:function(e){this.keyboard=e}},{key:"registerKeybinding",value:function(e,t){var n=pm.parseKeybinding(t);this.registry.registerKeyBindingRule(new gm(e,n,0))}},{key:"unRegisterKeybinding",value:function(e,t){var n=pm.parseKeybinding(t);this.registry.unRegisterKeyBindingRule(new gm(e,n,0))}},{key:"getCommandOfKeybinding",value:function(e){return this.registry.getCommandOfKeybinding(e)}},{key:"hasKeybinding",value:function(e){return!!this.getCommandOfKeybinding(e)}},{key:"attach",value:function(e){this.nextBinders.push(e)}},{key:"before",value:function(e,t){var n=this;return this.beforeEventEmitter.on(e,t),function(){n.offBefore(e,t)}}},{key:"offBefore",value:function(e,t){this.beforeEventEmitter.off(e,t)}},{key:"on",value:function(e,t){var n,i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!1};return r&&(n=this.before(e,(function(e){("boolean"==typeof r&&r||r(e))&&e.preventDefault()}))),this.emitter.on(e,t),function(){n&&n(),i.off(e,t)}}},{key:"off",value:function(e,t){this.emitter.off(e,t)}},{key:"emit",value:function(e,t){this.emitter.emit(e,t)}},{key:"acceptElement",value:function(e){return e===this.target}},{key:"handleKeydownEvent",value:function(e,t){var n=this.getCommandOfKeybinding(e);return n?(this.beforeEventEmitter.emit(n,t),!0):this.nextBinders.some((function(n){return n.handleKeydownEvent(e,t)}))}},{key:"handleEvent",value:function(e,t){var n=this.getCommandOfKeybinding(e);return n?(this.emit(n,t),!0):this.nextBinders.some((function(n){return n.handleEvent(e,t)}))}}]),e}();!function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,P._)(this,n),(i=t.call(this,null,e,r)).isActive=!1,i}(0,A._)(n,[{key:"acceptElement",value:function(e){return document.activeElement===e}},{key:"handleEvent",value:function(e,t){t.stopPropagation(),(0,S._)((0,x._)(n.prototype),"handleEvent",this).call(this,e,t)}}])}(mm);hm={},(0,J._)(hm,"selectAllAnnotations",{shortcut:j.isMac?"Meta+A":"Ctrl+A",bindTo:Lo}),(0,J._)(hm,"createPolyline_DeleteLastPoint",{shortcut:"Backspace",bindTo:Lo}),(0,J._)(hm,"undo",{shortcut:j.isMac?"Meta+Z":"Ctrl+Z",bindTo:Lo}),(0,J._)(hm,"redo",{shortcut:j.isMac?"Meta+Shift+Z":"Ctrl+Y",bindTo:Lo}),(0,J._)(hm,"cancel-creating-drawing-annot",{shortcut:"Escape",bindTo:"create-annotation-keyboard-event-binder"}),(0,J._)(hm,Oo,{shortcut:"Delete",bindTo:No}),(0,J._)(hm,"FIELD_ENTER_ACTION",{shortcut:"Enter",bindTo:Lo});var ym=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.render,i=void 0===n?function(e){return e}:n,r=t.payloadFieldName,o=void 0===r?"file":r,a=t.origin,s=void 0===a?"":a,u=t.uploadSnapshotAPIPath,c=t.method,l=void 0===c?"POST":c;(0,P._)(this,e),this.render=i,this.payloadFieldName=o,this.origin=s,this.uploadSnapshotAPIPath=u,this.method=l}return(0,A._)(e,[{key:"uploadImage",value:function(e){var t=this,n=new XMLHttpRequest,i=(0,j.createDeferred)();return n.addEventListener("readystatechange",(function(e){if(4==n.readyState)if(n.status>=200&&n.status<300||304==n.status){if(0===n.responseText.indexOf("/snapshot"))return void i.resolve("".concat(t.origin).concat(n.responseText));i.resolve(n.responseText)}else i.reject(n)})),n.open(this.method,"".concat(this.origin,"/").concat(this.uploadSnapshotAPIPath,"?filefield=").concat(this.payloadFieldName),!0),n.setRequestHeader("Content-Type","image/png"),n.setRequestHeader("X-File-Name","snapshot.png"),n.send(e),i.promise}}]),e}();const km=ym;var bm=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r,o){var a;return(0,P._)(this,n),(a=t.call(this,o)).name="customRender",a.data=e,a.eUi=i,a.eHandler=r,a.customsRender=o,a}return(0,A._)(n,[{key:"init",value:function(){}},{key:"redraw",value:function(){}},{key:"active",value:function(){}},{key:"unActive",value:function(){}},{key:"destroy",value:function(){}}]),n}(te),wm=function(){function e(t){(0,P._)(this,e),this.pdfViewer=t,this.matchRules=[],this.getPageCustomData=function(){return[]},this.getCustomDataId=function(){}}return(0,A._)(e,[{key:"registerMatchRule",value:function(e){return this.matchRules.push(e),e}},{key:"unRegisterMatchRule",value:function(e){var t=this.matchRules.indexOf(e);-1!==t&&this.matchRules.splice(t,1)}},{key:"get",value:function(e){for(var t=this.matchRules,n=bm,i=t.length;i--;){var r=t[i];if("function"==typeof r){var o=r(e,n);if(o)return o}}return n}}]),e}(),_m=function(){function e(){(0,P._)(this,e),this.stackArray=[]}return(0,A._)(e,[{key:"push",value:function(e){this.stackArray.push(e)}},{key:"pop",value:function(){return this.stackArray.pop()}},{key:"size",value:function(){return this.stackArray.length}},{key:"clear",value:function(){this.stackArray=[]}},{key:"filter",value:function(e){this.stackArray=this.stackArray.filter(e)}}]),e}(),Pm=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).groupElements=[],r.replies=[],r.markedStates=[],r.reviewStates=[],r}return(0,A._)(n,[{key:"getFlags",value:function(){return-2&(0,S._)((0,x._)(n.prototype),"getFlags",this).call(this)}},{key:"reviseSummary",value:function(e){var t=this,n=this.info,i=[];this.groupHeader=""._;var r=n.groupElementsSummary.map((function(t){return Promise.resolve(e(t.objectNumber))})),o=Promise.all(r).then((function(e){t.groupElements=e}));i.push(o);var a=n.groupHeaderSummary;a&&i.push(Promise.resolve(e(a.objectNumber)).then((function(e){t.groupHeader=e})));var s=n.repliesSummary.map((function(t){return Promise.resolve(e(t.objectNumber))})),u=Promise.all(s).then((function(e){t.replies=e}));i.push(u);var c=n.markedStatesSummary.map((function(t){return Promise.resolve(e(t.objectNumber))})),l=Promise.all(c).then((function(e){t.markedStates=e}));i.push(l);var d=n.reviewStatesSummary.map((function(t){return Promise.resolve(e(t.objectNumber))})),h=Promise.all(d).then((function(e){t.reviewStates=e}));i.push(h);var f=n.popupSummary;return f&&i.push(Promise.resolve(e(f.objectNumber)).then((function(e){t.popup=e}))),Promise.all(i).then((function(){return t.reviseSummaryIsOK=!0,t}))}},{key:"getBitmap",value:function(e,t,n){var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.getAnnotBitmap(r.getId(),i.getId(),this.getId(),e,t,n,!0)}},{key:"getOpacity",value:function(){return this.info.opacity}},{key:"setOpacity",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return e=+e,this.page.doc.api.setAnnotOpacity(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(e){return Promise.all(e.map((function(e){return e._update()})))})).then((function(e){return t.eventEmitter.emit(le.annotationUpdated,e,n,en.opacityUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,e,n),e}))}},{key:"getSubject",value:function(){return this.info.subject}},{key:"setSubject",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setSubject(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.subjectUpdated)}))}},{key:"getTitle",value:function(){return this.info.title}},{key:"setTitle",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setTitle(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.titleUpdated)}))}},{key:"isGrouped",value:function(){return this.info.isGrouped}},{key:"isGroupHeader",value:function(){return this.info.isGroupHeader}},{key:"getGroupElements",value:function(){return this.groupElements}},{key:"getGroupHeader",value:function(){return this.groupHeader}},{key:"getReplyCount",value:function(){return this.replies.length}},{key:"getReply",value:function(e){return this.replies[e]}},{key:"getReplies",value:function(){return this.replies}},{key:"addReply",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc(),r=this.getGroupHeader()||this;return this.page.doc.api.annotAddReply(i.getId(),n.getId(),this.getId(),e).then((function(e){r.info.repliesSummary.push({objectNumber:e.objectNumber,id:e.objectNumber,index:e.index});var i=t.page.doc.engine.annotManager.get(e,n);return n.addReplyAnnot(i)})).then((function(e){return r.replies.push(e),t.page.doc.engine.eventEmitter.emit(le.annotationReplyAdd,e,r),t.page.doc.engine.eventEmitter.emit(le.annotationUpdated,[t],n,en.replyAdded),e}))}},{key:"removeRepliesByIdLocaly",value:function(e){if(!Array.isArray(e)||e.length<1||this.replies.length<1)return e||[];var t=e.slice(0);this.replies=this.replies.filter((function(e){var n=t.indexOf(e.getId());return n>-1&&t.splice(n,1),-1==n}));var n=e.slice(0);return this.info.repliesSummary=this.info.repliesSummary.filter((function(e){var t=n.indexOf(e.objectNumber);return t>-1&&n.splice(t,1),-1==t})),t}},{key:"getMarkedStateCount",value:function(){return this.markedStates.length}},{key:"getMarkedState",value:function(e){return this.markedStates[e]}},{key:"getMarkedStates",value:function(){return this.markedStates}},{key:"getReviewStateCount",value:function(){return this.reviewStates.length}},{key:"getReviewState",value:function(e){return this.reviewStates[e]}},{key:"getReviewStates",value:function(){return this.reviewStates}},{key:"addReviewState",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.addAnnotReviewState(i.getId(),n.getId(),this.getId(),e).then((function(e){t.info.reviewStatesSummary.push({objectNumber:e.objectNumber,id:e.objectNumber,index:e.index});var i=t.page.doc.engine.annotManager.get(e,n);return n.addAddonAnnot(i)})).then((function(e){return t.reviewStates.push(e),t.page.doc.engine.eventEmitter.emit(le.annotationReviewStateAnnotAdd,e,t),t.page.doc.engine.eventEmitter.emit(le.annotationUpdated,[t],n,en.reviewStateUpdated),e}))}},{key:"removeReviewState",value:function(){var e=this,t=this.page,n=this.getReviewStates(),i=n[n.length-1];return t.removeAnnot(i).then((function(){if(e.reviewStates.pop(),e.info.reviewStatesSummary.pop(),e.reviewStates.length>0){var i=n[e.reviewStates.length-1];i&&(i.reviewStates.pop(),i.info.reviewStatesSummary.pop())}e.page.doc.engine.eventEmitter.emit(le.removeReviewState,e),e.page.doc.engine.eventEmitter.emit(le.annotationUpdated,[e],t,en.reviewStateUpdated)}))}},{key:"addMarkedState",value:function(e){var t=this,n=arguments[1],i=this.getPDFPage(),r=i.getPDFDoc(),o=this.getGroupHeader()||this;return this.page.doc.api.addAnnotMarkedState(r.getId(),i.getId(),this.getId(),e).then((function(e){if(o.info.markedStatesSummary.length){var t=i.annotIdMap[e.objectNumber];return t.info=e,t}o.info.markedStatesSummary.push({objectNumber:e.objectNumber,id:e.objectNumber,index:e.index});var n=i.doc.engine.annotManager.get(e,i);return i.addAddonAnnot(n)})).then((function(e){return o.markedStates.push(e),t.page.doc.engine.eventEmitter.emit(le.annotationMarkedStateAnnotAdd,e,o,n),t.page.doc.engine.eventEmitter.emit(le.annotationUpdated,[t],i,en.markedStateUpdated),e}))}},{key:"removeMarkedState",value:function(){var e=this,t=this.getPDFPage(),n=t.getPDFDoc(),i=this.getGroupHeader()||this,r=i.markedStates.pop();return r?(i.info.markedStatesSummary.pop(),t.removeAnnot(r).then((function(){n.engine.eventEmitter.emit(le.removeMarkedState,e),n.engine.eventEmitter.emit(le.annotationUpdated,[e],t,en.markedStateUpdated)}))):Promise.resolve()}},{key:"removeAllStateAnnots",value:function(){var e=this;this.checkModidyPerm();var t=this.getPDFPage(),n=t.getPDFDoc(),i=this.getGroupHeader()||this;return this.page.doc.api.removeAllStateAnnots(n.getId(),t.getId(),this.getId()).then((function(n){return!!n&&(i.info.markedStatesSummary.forEach((function(e){var n=e.id;t.removeAddonAnnotById(n)})),i.info.reviewStatesSummary.forEach((function(e){var n=e.id;t.removeAddonAnnotById(n)})),i.info.markedStatesSummary=[],i.info.reviewStatesSummary=[],i.reviewStates=[],i.markedStates=[],e.page.doc.engine.eventEmitter.emit(le.annotationStatesCleared,i),e.page.doc.engine.eventEmitter.emit(le.annotationUpdated,[e],t,en.statesCleared),n)}))}},{key:"getPopup",value:function(){return this.popup}},{key:"getCreateDateTime",value:function(){var e=this.info.creationTimestamp;return e>0?new Date(e):new Date}},{key:"setCreateDateTime",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCreateDateTime(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.createDateTimeUpdated)}))}},{key:"getIntent",value:function(){return this.info.intent}},{key:"setIntent",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotIntent(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(t){for(var n=0;n<t.length;n++)t[n].info.intent=e;return t})).then((function(e){return t.eventEmitter.emit(le.annotationUpdated,e,n,en.intentUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,e,n),e}))}},{key:"getFillColor",value:function(){return this.info.fillColor}},{key:"setFillColor",value:function(e){var t=this;e=0===e?0:(0,j.colorConvertor)(e,"int");var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.setAnnotFillColor(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(en.fillColorUpdated).then((function(){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"update",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.getGroupElements();0==i.length&&(i=[this]);for(var r=[],o=0,a=i.length;o<a;o++){var s=i[o];r[o]=s._update()}return Promise.all(r).then((function(i){return e&&n&&t.eventEmitter.emit(le.annotationUpdated,i,t.getPDFPage(),e),i}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.opacity,i=ze(new Date(this.info.creationTimestamp)),r=this.info.intent,o=this.info.subject,a=this.info.title,s=this.info.IRT,u=this.info.RT;r=r&&r.length>0?{IT:r,intent:r}:{};var c=Object.assign({},e,{opacity:t,creationdate:i,subject:o,title:a,bm:this.info.bm,ca:this.info.ca},r);if(s&&u){var l=this.page.annotIdMap[s];l&&(s=l.getName(),c.inreplyto=s),c.replyType=u.toLowerCase()}return this.popup&&(c.popup=this.popup.exportToJSON()),this.info.rotation&&(c.rotation=360-this.info.rotation),this.info.measureRatio&&(c.measureConversionFactor=this.info.measureConversionFactor,c.measureRatio=this.info.measureRatio,c.measureUnit=this.info.measureUnit),c}},{key:"setContent",value:function(e){var t=this;return this.checkModidyPerm(),(this.getGroupHeader()||this)._setContent(e).then((function(e){return t.getPDFPage().getAnnotsByObjectNumArray([e])})).then((function(n){var i=n[0];if(i&&(i.info.content=e,i.info.modifiedTimestamp=(new Date).getTime()),t.eventEmitter.emit(le.annotationUpdated,n,t.getPDFPage(),en.contentUpdated),i){var r=i.info.type,o=i.info.intent;("polyline"===r&&"PolyLineDimension"===o||"polygon"===r&&"PolygonDimension"===o||"circle"===r&&"CircleDimension"===o)&&(t.eventEmitter.emit(le.annotationAppearanceUpdated,n,t.getPDFPage()),t.updateInfo(i.info))}return n}))}},{key:"getRichText",value:function(){if("freetext"!=this.info.type)return Promise.resolve();var e=this.getPDFPage(),t=e.getPDFDoc();return t.api.getRichText({path:"jr/doc/page/annot"},t.getId(),e.getId(),this.getId())}},{key:"setRichText",value:function(e){var t=this;if("freetext"!=this.info.type)return Promise.resolve();var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.setRichText({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(en.richTextUpdated).then((function(e){t.eventEmitter.emit(le.annotationAppearanceUpdated,e,t.getPDFPage())}))}))}},{key:"addRichText",value:function(e){var t=this;if("freetext"!=this.info.type)return Promise.resolve();var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.addRichText({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(en.richTextUpdated).then((function(e){t.eventEmitter.emit(le.annotationAppearanceUpdated,e,t.getPDFPage())}))}))}},{key:"insertRichText",value:function(e){var t=this;if("freetext"!=this.info.type)return Promise.resolve();var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.insertRichText({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(en.richTextUpdated).then((function(e){t.eventEmitter.emit(le.annotationAppearanceUpdated,e,t.getPDFPage())}))}))}},{key:"removeRichText",value:function(e){var t=this;if("freetext"!=this.info.type)return Promise.resolve();var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.removeRichText({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(en.richTextRemoved).then((function(e){t.eventEmitter.emit(le.annotationAppearanceUpdated,e,t.getPDFPage())}))}))}}]),n}(ln);const Am=Pm;var Sm=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getQuadPoints",value:function(){var e=this.info.quadPoints||[];if(0===e.length){var t=this.getRect(),n=t.left,i=t.top,r=t.right,o=t.bottom;return[[{x:n,y:i},{x:r,y:i},{x:n,y:o},{x:r,y:o}]]}return e}},{key:"isReplace",value:function(){return!1}},{key:"getDeviceQuadPoints",value:function(){for(var e=this.getPDFPage(),t=(e.getHeight(),e.getWidth()),n=this.getQuadPoints(),i=[],r=n.length;r--;){var o=n[r];i[r]=[{x:o[0].x,y:t-o[0].y},{x:o[1].x,y:t-o[1].y},{x:o[2].x,y:t-o[2].y},{x:o[3].x,y:t-o[3].y}]}return i}},{key:"getStartCharIndex",value:function(){return this.info.startCharIndex}},{key:"getStartCharInfo",value:function(){return this.info.startCharInfo}},{key:"getEndCharIndex",value:function(){return this.info.endCharIndex}},{key:"getEndCharInfo",value:function(){return this.info.endCharInfo}},{key:"canAccess",value:function(){return!!this.page.doc.checkPermission(Qt.extract||Qt.extractAccess)}},{key:"getText",value:function(){if(!this.page.doc.checkPermission(Qt.extract||Qt.extractAccess))throw new Error("Permission error");return this.info.text||""}},{key:"getContinuousText",value:function(){if(!this.page.doc.checkPermission(Qt.extract||Qt.extractAccess))throw new Error("Permission error");return this.info.text||""}},{key:"updateQuadPointsByCharIndex",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.updateAnnotQuadPointsByCharIndex(r.getId(),i.getId(),this.getId(),e,t).then((function(e){if(e)return n.update(en.quadPointsUpdated).then((function(t){return n.eventEmitter.emit(le.annotationAppearanceUpdated,t,n.getPDFPage()),e}))}))}},{key:"isArea",value:function(){return this.info.isArea}},{key:"exportToJSON",value:function(){for(var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.getQuadPoints(),i="",r=0;r<t.length;r++){var o=t[r];i+=o[0].x+","+o[0].y+",",i+=o[1].x+","+o[1].y+",",i+=o[2].x+","+o[2].y+",",i+=o[3].x+","+o[3].y+","}return i=i.substr(0,i.length-1),Object.assign({},e,{coords:i})}}]),n}(Am);const xm=Sm;var Cm={setContent:function(e){var t=e.method;return function(){e.host[t](e.content)}},setBorderColor:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](e.color).then((function(){n.updateRender()}))}},setOpacity:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](e.opacity).then((function(){n.updateRender()}))}},updateQuadPointsByCharIndex:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](e.start,e.end).then((function(){n.isReplace?n.caretAnnot.moveRectByCharIndex(e.end).then((function(){n.getGroupRenders().map((function(e){e.active()}))})):n.active()}))}},setStyleFillColor:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.fillColor)}},setFillColor:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.fillColor)}},setBorderWidth:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.borderWidth)}},setBorderStyle:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.borderStyle.style,e.borderStyle.param)}},setCalloutLineEndingStyle:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](+e.style).then((function(){n.activeRect(),n.redraw()}))}},setEndingStyle:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](e.isBeginning,+e.style).then((function(){n.activeRect(),n.redraw()}))}},enableCaption:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.enableCaption)}},setRotation:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i]((e.rotation+360)%360)}},setHighlightingMode:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){t.getAnnotRender(o,r).component.annot[i](e.mode)}},setRect:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(o,r).component;n.annot[i](e.rect).then((function(){n.active()}))}},eraseInk:function(e){e.host.pdfViewer;var t=e.host.annot;t.getObjectNumber(),t.getPDFPage().getIndex()},updateLinePoints:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=(e.method,n.getObjectNumber()),r=n.getPDFPage().getIndex(),o=[];return function(){var n=t.getAnnotRender(r,i).component;o.push(n.annot.setStartPoint(e.startPoint)),o.push(n.annot.setEndPoint(e.endPoint)),Promise.all(o).then((function(){n.active()}))}},setLeaderLineLength:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex(),a=e.leaderLinePoints,s=e.startPoint,u=e.endPoint,c=a.start,l=(a.end,Math.sqrt(Math.pow(s.x-c.x,2)+Math.pow(s.y-c.y,2))),d=!0;return(u.x-s.x)*(c.y-u.y)-(c.x-u.x)*(u.y-s.y)>0&&(d=!1),d&&(l=-l),function(){var e=t.getAnnotRender(o,r).component;e.annot[i](l).then((function(){e.active()}))}},updateVertexes:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=e.method,r=n.getObjectNumber(),o=n.getPDFPage().getIndex(),a=e.vertexes,s=e.index;return function(){var e=t.getAnnotRender(o,r).component;e.annot[i](s,a[s]).then((function(){e.active()}))}},removeAnnot:function(e,t){var n,i,r=e.host.pdfViewer,o=e.host.annot,a=o.getObjectNumber(),s=o.getPDFPage(),u=s.getIndex(),c=o.getReplies&&o.getReplies()||[],l=[];return c.map((function(e){l.push({id:e.getId(),content:e.getContent(),createTime:new Date(e.getCreateDateTime()).getTime(),modifiedTime:new Date(e.getModifiedDateTime()).getTime()})})),o.isGrouped&&o.isGrouped()?(n=[],o.groupElements.map((function(e,t){n.push(new Em(e).getJson()),e.isGroupHeader()&&(i=t)}))):n=new Em(o).getJson(),"before"===t?"redact"===o.getType()?function(){s.markRedactAnnot(n.rects,n.name)}:o.isGrouped&&o.isGrouped()?function(){s.addAnnotGroup(n,i).then((function(){var e=r.getAnnotRender(u,a).component;l.length>0?d(e.annot).then((function(){e.getGroupRenders().map((function(e){e.active()}))})):e.active()}))}:function(){s.addAnnot(n).then((function(){var e=r.getAnnotRender(u,a).component;l.length>0?d(e.annot).then((function(){e.active()})):e.active()}))}:function(){var e=r.getAnnotRender(u,a).component;s.removeAnnot(e.annot)};function d(e){var t=[];return l.map((function(n){t.push(e.addReply(n.content).then((function(e){e.setUniqueID(n.id).then((function(){e.setCreateDateTime(n.createTime).then((function(){e.setModifiedDateTime(n.modifiedTime)}))}))})))})),Promise.all(t)}},addAnnot:function(e,t){var n,i,r=e.host.pdfViewer,o=e.host.annot,a=o.getObjectNumber(),s=o.getPDFPage(),u=s.getIndex();return o.isGrouped&&o.isGrouped()?(n=[],o.groupElements.map((function(e,t){n.push(new Em(e).getJson()),e.isGroupHeader()&&(i=t)}))):n=new Em(o).getJson(),"before"===t?function(){s.removeAnnot(o)}:o.isGrouped&&o.isGrouped()?function(){s.addAnnotGroup(n,i).then((function(){r.getAnnotRender(u,a).component.getGroupRenders().map((function(e){e.active()}))}))}:function(){s.addAnnot(n).then((function(){r.getAnnotRender(u,a).component.active()}))}},markRedactAnnot:function(e,t){var n=e.host.pdfViewer,i=e.host.annot,r=i.getObjectNumber(),o=i.getPDFPage(),a=o.getIndex();return"before"===t?function(){o.removeAnnot(i)}:function(){var e=new Em(i).getJson();o.markRedactAnnot(e.rects,e.name).then((function(){n.getAnnotRender(a,r).component.active()}))}},makeRedactByPages:function(e,t){var n=e.host;return"before"===t?function(){n.map((function(e){e.getPDFPage().removeAnnot(e)}))}:function(){n.map((function(e){e.getPDFPage().markRedactAnnot([e.info.rect],e.id)}))}},placeRedact:function(e,t){var n=e.host;return"before"===t?function(){n.map((function(e){e.getPDFPage().removeAnnot(e)}))}:function(){n.map((function(e){e.getPDFPage().markRedactAnnot([e.info.rect],e.id)}))}},eraser:function(e,t){var n=e.inkArray,i=e.host;return function(){n.map((function(e){i.getAnnotRender(e.annot.getId()).component.annot.setInkList(e.inkList)}))}},updateCalloutPoints:function(e){var t=e.host.pdfViewer,n=e.host.annot,i=(e.method,n.getObjectNumber()),r=n.getPDFPage().getIndex();return function(){var n=t.getAnnotRender(r,i).component;n.annot._setRect(e.rect,!1).then((function(){n.annot.setInnerRectNoAction(e.innerRect).then((function(){n.annot.setCalloutLinePoints(e.calloutLinePoints).then((function(){n.annot.update().then((function(){n.redraw(),n.active()}))}))}))}))}},addReply:function(e,t){var n=e.host,i=e.replyAnnot,r=(e.component,e.pdfViewer),o=n.getPDFPage(),a=o.getIndex(),s=n.getId(),u=i.getId(),c=i.getCreateDateTime(),l=i.getModifiedDateTime();return"before"===t?function(){o.removeAnnot(i)}:function(){r.getAnnotRender(a,s).component.annot.addReply(i.getContent()).then((function(e){e.setUniqueID(u).then((function(){e.setCreateDateTime(new Date(c).getTime()).then((function(){e.setModifiedDateTime(new Date(l).getTime())}))}))}))}},deleteReply:function(e,t){var n=e.host,i=e.replyAnnot,r=e.pdfViewer,o=n.getPDFPage(),a=o.getIndex(),s=i.getId(),u=n.getId(),c=i.getCreateDateTime(),l=i.getModifiedDateTime();return"before"===t?function(){r.getAnnotRender(a,u).component.annot.addReply(i.getContent()).then((function(e){e.setUniqueID(s).then((function(){e.setCreateDateTime(new Date(c).getTime()).then((function(){e.setModifiedDateTime(new Date(l).getTime())}))}))}))}:function(){o.removeAnnotById(s)}},addAction:function(e,t){var n=e.host.pdfViewer,i=e.host.annot,r=i.getObjectNumber(),o=i.getPDFPage().getIndex(),a=i.getAction();return"before"===t?function(){i.removeAction()}:function(){!function(e,t){e.setAction(t.type).then((function(){var n=new Tm(t).toJson();return e.setActionData(n).then((function(){return Im(e.getAction(),t)}))}))}(n.getAnnotRender(o,r).component.annot,a.info)}}};const Dm=Cm;var Em=function(){function e(t){(0,P._)(this,e);var n=(0,j.colorConvertor)(t.getBorderColor(),"#");switch(this.json={objectNumber:t.info.objectNumber,name:t.getUniqueID(),rect:t.getRect(),color:n,style:t.getBorderStyle(),contents:t.getContent(),date:new Date(t.getModifiedDateTime()).getTime(),type:t.getType(),flags:t.getFlags()},(0,D._)(t,Am)&&this.markup(t),(0,D._)(t,xm)&&this.textMarkup(t),t.getType()){case"ink":this.ink(t);break;case"fileattachment":this.fileattachment(t);break;case"polygon":this.polygon(t);break;case"polyline":this.polyline(t);break;case"stamp":this.stamp(t);break;case"freetext":this.freetext(t);break;case"screen":this.screen(t);break;case"line":this.line(t);break;case"redact":this.redact(t);break;case"highlight":this.highlight(t);break;case"link":this.link(t);break;case"square":this.square(t);break;case"circle":this.circle(t)}}return(0,A._)(e,[{key:"markup",value:function(e){this.json=Object.assign({intent:e.getIntent(),opacity:e.getOpacity(),subject:e.getSubject(),title:e.getTitle(),creationTimestamp:new Date(e.getCreateDateTime()).getTime()},this.json)}},{key:"textMarkup",value:function(e){this.json=Object.assign({startCharIndex:e.getStartCharIndex(),endCharIndex:e.getEndCharIndex(),coords:e.getQuadPoints()},this.json)}},{key:"ink",value:function(e){this.json=Object.assign({inkList:e.getInkList(),borderWidth:e.getBorderWidth()},this.json)}},{key:"fileattachment",value:function(e){this.json=Object.assign({fObjNum:e.info.fObjNum},this.json)}},{key:"polygon",value:function(e){this.json=Object.assign(this.json,{vertexes:e.getVertexes(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,fillColor:e.info.fillColor,style:void 0,borderWidth:e.getBorderWidth()})}},{key:"polyline",value:function(e){this.json=Object.assign(this.json,{vertexes:e.getVertexes(),fillColor:e.info.fillColor,borderWidth:e.getBorderWidth(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0,startStyle:e.getStartStyle(),endStyle:e.getEndingStyle()})}},{key:"stamp",value:function(e){this.json=Object.assign({icon:e.info.icon,rotate:(e.getRotation()+360)%360,apObjeNum:e.info.apObjeNum},this.json)}},{key:"freetext",value:function(e){this.json=Object.assign(this.json,{calloutLinePoints:e.getCalloutLinePoints(),innerRect:e.getInnerRect(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0,"interior-color":e.getFillColor(),interiorColor:e.getFillColor(),borderWidth:e.getBorderWidth(),calloutLineEndingStyle:e.getCalloutLineEndingStyle()})}},{key:"line",value:function(e){var t=e.getMeasureRatio(),n=e.getMeasureUnit(),i=null;t&&n&&(i={unit:n,ratio:t});var r=e.getStartPoint(),o=e.getEndPoint();this.json=Object.assign(this.json,{startStyle:e.getStartStyle(),endStyle:e.getEndingStyle(),enableCaption:e.hasCaption(),startPoint:{x:r.x,y:r.y},endPoint:{x:o.x,y:o.y},measure:i,borderWidth:e.getBorderWidth(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0})}},{key:"screen",value:function(e){this.json=Object.assign({apObjNum:e.info.apObjNum,opacity:e.getOpacity(),rotate:{0:0,90:1,180:2,270:3}[e.getRotation()],iObjNum:e.info.iObjNum,aObjNum:e.info.aObjNum,borderWidth:e.getBorderWidth()},this.json)}},{key:"redact",value:function(e){var t=e.info.quadPoints,n=[];t.length>0?t.map((function(e){n.push({left:e[0].x,right:e[3].x,top:e[0].y,bottom:e[3].y})})):n.push(e.info.rect),this.json=Object.assign({rects:n},this.json)}},{key:"highlight",value:function(e){e.info.isArea&&(this.json=Object.assign(this.json,{coords:[e.getRect()],dicts:{AreaHi:"AreaHi"}}),delete this.json.startCharIndex,delete this.json.endCharIndex)}},{key:"link",value:function(e){this.json=Object.assign(this.json,{aObjNum:e.info.aObjNum,borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0,borderWidth:e.getBorderWidth()})}},{key:"circle",value:function(e){this.json=Object.assign(this.json,{fillColor:e.info.fillColor,borderWidth:e.getBorderWidth(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0})}},{key:"square",value:function(e){this.json=Object.assign(this.json,{fillColor:e.info.fillColor,borderWidth:e.getBorderWidth(),borderStyle:e.getBorderStyleWithParam().style,borderStyleParam:e.getBorderStyleWithParam().param,style:void 0})}},{key:"getJson",value:function(){return this.json}}]),e}();function Im(e,t){for(var n=function(n){r.push(e.insertSubAction(n,t.subAction[n].type).then((function(){var i=new Tm(t.subAction[n]).toJson(),r=e.getSubAction(n);return r.setActionData(i).then((function(){return Im(r,t.subAction[n])}))})))},i=t.subActionCount,r=[],o=0;o<i;o++)n(o);return Promise.all(r)}var Rm,Tm=function(){function e(t){(0,P._)(this,e),this.action=t,this.json={},this[t.type]()}return(0,A._)(e,[{key:"TypeGoto",value:function(){var e=this.action.destination;this.json=Object.assign(e,{type:e.zoomMode})}},{key:"TypeURI",value:function(){var e=this.action.uri;this.json=Object.assign({},{uri:e})}},{key:"TypeJavaScript",value:function(){var e=this.action.javascript;this.json=Object.assign({},{script:e})}},{key:"TypeNamed",value:function(){var e=this.action.name;this.json=Object.assign({},{name:e})}},{key:"TypeHide",value:function(){var e=this.action,t=e.fieldNames,n=e.hideState;this.json=Object.assign({},{fieldNames:t,hideState:n})}},{key:"TypeSubmitForm",value:function(){var e=this.action,t=e.flags,n=e.url,i=e.fieldNames;this.json=Object.assign({},{flags:t,url:n,fieldNames:i})}},{key:"TypeResetForm",value:function(){var e=this.action,t=e.flags,n=e.fieldNames;this.json=Object.assign({},{flags:t,fieldNames:n})}},{key:"TypeGoToR",value:function(){var e=this.action,t=e.destinationName,n=e.destination;this.json=Object.assign({},{destinationName:t,destination:n})}},{key:"toJson",value:function(){return this.json}}]),e}(),Fm=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,null,[{key:"undo",value:function(e){e.before()}},{key:"redo",value:function(e){e.after()}},{key:"createRecord",value:function(e,t){var n=e.method;return Dm[n](e,t)}},{key:"getUniqueId",value:function(e){return e.host&&e.host.annot?e.host.annot.getId():null}}]),e}(),Mm=function(){function e(t){var n=this;(0,P._)(this,e),this.pdfViewer=t,this.undoStack=new _m,this.redoStack=new _m,this.beforeFn=null,this.afterFn=null,this.pdfViewer.eventEmitter.on(de.willCloseDocument,(function(){n.clear()})),this.addEventListener()}return(0,A._)(e,[{key:"addEventListener",value:function(){}},{key:"removeEventListener",value:function(){}},{key:"before",value:function(e){this.beforeFn=Fm.createRecord(e,"before")}},{key:"after",value:function(e){this.afterFn=Fm.createRecord(e,"after"),this.remember(Fm.getUniqueId(e))}},{key:"remember",value:function(e){this.beforeFn&&this.afterFn&&this.undoStack.push({before:this.beforeFn,after:this.afterFn,uniqueId:e})}},{key:"removeById",value:function(e){this.undoStack.filter((function(t){return e!==t.uniqueId})),this.redoStack.filter((function(t){return e!==t.uniqueId}))}},{key:"undo",value:function(){var e=this.undoStack.pop();e&&(this.redoStack.push(e),Fm.undo(e))}},{key:"redo",value:function(){var e=this.redoStack.pop();e&&(this.undoStack.push(e),Fm.redo(e))}},{key:"clear",value:function(){this.undoStack.clear(),this.redoStack.clear()}},{key:"getUndoStack",value:function(){return this.undoStack}},{key:"getRedoStack",value:function(){return this.redoStack}}]),e}(),Om=(function(){function e(){(0,P._)(this,e)}(0,A._)(e,[{key:"show",value:function(){(0,j.notImplemented)()}},{key:"hide",value:function(){(0,j.notImplemented)()}},{key:"destroy",value:function(){(0,j.notImplemented)()}}])}(),function(){function e(){(0,P._)(this,e),this.hiddenCallbacks=[],this.shownCallbacks=[],this.isDisabled=!1}return(0,A._)(e,[{key:"setCurrentTarget",value:function(e){this.currentTarget=e}},{key:"getCurrentTarget",value:function(){return this.currentTarget}},{key:"showAt",value:function(e,t){var n=this;return this.shownCallbacks.forEach((function(e){return e.call(n)})),!0}},{key:"disable",value:function(){this.isDisabled=!0}},{key:"enable",value:function(){this.isDisabled=!1}},{key:"destroy",value:function(){(0,j.notImplemented)()}},{key:"getItem",value:function(){(0,j.notImplemented)()}},{key:"onHidden",value:function(e){"function"==typeof e&&this.hiddenCallbacks.push(e)}},{key:"onShown",value:function(e){"function"==typeof e&&this.shownCallbacks.push(e)}}]),e}()),Lm=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"prepare",value:function(e){this.pdfViewer=e}},{key:"getRootElement",value:function(){return Promise.resolve(this.pdfViewer.element.parentElement)}},{key:"showReply",value:function(e){(0,j.notImplemented)()}},{key:"showPropertiesInfo",value:function(e){(0,j.notImplemented)()}},{key:"createContextMenu",value:function(e,t,n){(0,j.notImplemented)()}},{key:"alert",value:function(e){}},{key:"confirm",value:function(e){}},{key:"prompt",value:function(e,t,n){}},{key:"promptPassword",value:function(e,t,n){}},{key:"loading",value:function(e){return function(){}}},{key:"createFreeTextTooltip",value:function(e){}},{key:"createTextSelectionTooltip",value:function(e){}},{key:"getPortfolioPreviewer",value:function(e){(0,j.notImplemented)()}},{key:"destroy",value:function(){}},{key:"openDialog",value:function(e){return Promise.resolve()}}]),e}(),Nm=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).pdfViewer=e,r.pageRender=i,r.isDisabled=!1,r.eventEmitter=new(js()),r}return(0,A._)(n,[{key:"on",value:function(e,t){var n=this;return this.eventEmitter.on(e,t),function(){return n.eventEmitter.off(e,t)}}},{key:"showAt",value:function(e,t,n,i){this.eventEmitter.emit("show")}},{key:"hide",value:function(){this.eventEmitter.emit("hide")}},{key:"disable",value:function(){this.isDisabled=!0}},{key:"enable",value:function(){this.isDisabled=!1}},{key:"destroy",value:function(){this.eventEmitter.emit("destroy"),(0,S._)((0,x._)(n.prototype),"destroy",this).call(this)}}]),n}(j.Disposable),Vm=g(3013),Bm=g.n(Vm),jm=(function(){function e(){(0,P._)(this,e),(0,J._)(this,"APPEARANCEKEY","bookmark_default_appearance"),(0,J._)(this,"pdfViewer",void 0)}(0,A._)(e,[{key:"getBookmarkById",value:function(e){var t;e=parseInt(e);var n=this.pdfViewer.getCurrentPDFDoc();if(n){var i=n.bookmarkRoot,r=function(n){var i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;if(t)break;if(c.id==e){t=c;break}c.children&&c.children.length>0&&r(c.children)}}catch(e){o=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}};return i&&r(i.children),t}}},{key:"getCurrentPosition",value:function(){var e=this.pdfViewer.getPDFDocRender().pagesRender.viewMode.getVisibleIndexes()||[],t=this.pdfViewer.getDeviceCurrentPosition(),n=t.top,i=t.left,r=t.pageIndex;i=i<0?0:i,n=Math.max(n,Math.max(8,n)),n-=8;var o=this.pdfViewer.pdfViewerRender;if(!o)return Promise.reject("BookmarkService.getCurrentPosition error");var a=o.getViewMode().getName();"single-page-view-mode"!==a&&"continuous-view-mode"!==a||(r=n<0&&e.length>1?e[1]:e[0]);var s=this.pdfViewer.getPDFPageRender(r),u=s.getScale(),c=s.getRotation();return s.getPDFPage().then((function(e){var t;return t=(0,E._)(e.reverseDevicePoint([i,n],u,c),2),i=t[0],{top:n=t[1],left:i,pageIndex:r}}))}},{key:"renameBookmark",value:function(e,t,n){this.getBookmarkById(e).setProperty({title:t},!0);var i=this.pdfViewer.viewerUI.rootComponent.pdfUI.addonInstanceMap.UndoRedoAddon.addon.bookmarkModule,r=this.getBookmarkById(e);i&&i.pushUndoStack("rename",{bookmark:r,newName:t,oldName:n})}},{key:"addBookmark",value:function(e){var t=this,n=e.bookmarkId,i=e.pageIndex,r=e.title,o=e.left,a=void 0===o?0:o,s=e.top,u=void 0===s?0:s,c=e.relationship,l=void 0===c?3:c,d=this.pdfViewer.getCurrentPDFDoc();if(!d)return Promise.reject();var h=localStorage.getItem(this.APPEARANCEKEY);return d.getRootBookmark().then((function(e){return e||(e=d.createRootBookmark()),e})).then((function(e){var o=t.getBookmarkById(parseInt(n));return o||(o=e,l=1),o?(r||(r=t.pdfViewer.i18n.t("sidebar.bookmark.untitled")),void 0===i?t.getCurrentPosition().then((function(e){var n=e.top,i=e.left,a=e.pageIndex;return o.insertBookmark(r,a,n,i,l,t.pdfViewer.getPDFDocRender().scale)})):o.insertBookmark(r,i,u,a,l,t.pdfViewer.getPDFDocRender().scale)):Promise.reject()})).then((function(e){return h&&e.setProperty(JSON.parse(h)),e}))}},{key:"performAction",value:function(e){var t=this,n=this.getBookmarkById(e);n&&n.getAction().then((function(e){return e||n.getDestination()})).then((function(e){e&&t.pdfViewer.actionManager.get(e,t).active()}))}}],[{key:"getName",value:function(){return"bookmark-service"}},{key:"inject",value:function(){return{pdfViewer:RP}}}])}(),function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).pdfViewer=e,r.pageRender=i,r.topEditBar=null,r}return(0,A._)(n,[{key:"getSelectionInfo",value:function(){var e=(0,j.createDeferred)(),t=this.pdfViewer.getStore().subscribe(xe.SELECTION_INFO,(function(n){t(),e.resolve(n)}));return this.addDestroyHook(t),e.promise}},{key:"copy",value:function(){var e,t=this;return this.getSelectionInfo().then((e=(0,_._)((function(e){return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return[4,(0,j.copyText)(e.text)];case 1:return n.sent()?t.pdfViewer.eventEmitter.emit(de.copyTextSuccess,e.text):t.pdfViewer.eventEmitter.emit(de.copyTextFailed,e.text),[2]}}))})),function(t){return e.apply(this,arguments)}))}},{key:"createTextHighlight",value:function(){return this.createTextMarkupAnnot("highlight")}},{key:"createStrikeout",value:function(){return this.createTextMarkupAnnot("strikeout")}},{key:"createUnderline",value:function(){return this.createTextMarkupAnnot("underline")}},{key:"createBookmark",value:function(){var e=this,t=this.pdfViewer.getCurrentPDFDoc();return this.hasModifyPermissions(t)?this.getSelectionInfo().then((function(t){if(t){t.page.getPDFDoc();var n=t.page.getIndex(),i=t.text,r=t.rectArray[0],o=r.left,a=r.top;e.pdfViewer.eventEmitter.emit("bookmark-create-current-view",{left:o,top:a,title:i,relationship:3,pageIndex:n}),e.pdfViewer.eventEmitter.emit("text-tooltip-click",{type:"createBookmark"})}})):Promise.resolve()}},{key:"createTextMarkupAnnot",value:function(e){var t=this;return this.pageRender.getPDFPage().then((function(n){return t.getSelectionInfo().then((function(i){return n.addAnnot({type:e,rect:{left:0,right:0,top:0,bottom:0},flags:4,coords:i.rectArray,subject:t.pdfViewer.i18n.t("viewer_:annotSubjects."+e[0].toUpperCase()+e.substr(1))}).then((function(n){var i=n[0];t.pdfViewer.eventEmitter.emit(de.addAnnotSuccess,i),t.pdfViewer.eventEmitter.emit("text-tooltip-click",{type:e}),t.pageRender.annotsRender.activeAnnot(i.getId())}))}))}))}},{key:"getBookmarkById",value:function(e,t){var n="",i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;if(n)break;if(u.id==e){n=u;break}u.children&&u.children.length>0&&(n=this.getBookmarkById(e,u.children))}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}},{key:"hasModifyPermissions",value:function(e){var t=e.getPermissions();return 8&t&&32&t}},{key:"getTopEditBar",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){switch(t.label){case 0:return e.topEditBar?[3,2]:[4,e.pdfViewer.viewerUI.rootComponent.pdfUI.getComponentByName("edit-text")];case 1:e.topEditBar=t.sent(),t.label=2;case 2:return[2,e.topEditBar]}}))}))()}},{key:"createEditText",value:function(){var e=this;return(0,_._)((function(){var t;return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return[3,2];case 1:t=n.sent(),e.getTopEditBar().then((function(n){e.pageRender.$handler.find(".fv__mark-selection-blank").remove(),n.controller.handle(t.e,!0,t)})),n.label=2;case 2:return[2]}}))}))()}},{key:"clearSelectionInfo",value:function(){this.pdfViewer.getCurrentPDFDoc().clearSelectedInfo(this.pdfViewer)}}]),n}(j.Disposable)),Um="copy_selected_text",Hm="create-text-highlight",Wm="create-strikeout",Ym="create-underline",qm=[{iconClass:"fv__icon-popup-copy",name:Um},{iconClass:"fv__icon-toolbar-text-highlight",name:Hm},{iconClass:"fv__icon-toolbar-strikeout",name:Wm},{iconClass:"fv__icon-toolbar-underline",name:Ym}].concat([]),Km=Bm()({actions:qm}),$m=(new DOMParser).parseFromString(Km,"text/html").body.firstElementChild,zm=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).selectionTool=new jm(e,i),r.init(),r}return(0,A._)(n,[{key:"init",value:function(){var e=this;this.dom=$m.cloneNode(!0),this.pageRender.$ui.get(0).appendChild(this.dom),this.dom.addEventListener("click",(function(t){if(!t.target.classList.contains("disabled")&&!t.target.parentNode.classList.contains("disabled")){var n=t.target.getAttribute("action");n&&e[n]&&e[n]().then((function(){e.hide()}))}}));var t=function(e){return e===document.activeElement||e.contains(document.activeElement)},n=t(this.dom),i=function(){var i=t(e.dom);n===i||i||e.eventEmitter.emit("blur"),n=i};document.addEventListener("focus",i,{capture:!0}),document.addEventListener("pointerup",i,{capture:!0}),this.addDestroyHook((function(){document.removeEventListener("focus",i,{capture:!0}),document.removeEventListener("pointerup",i,{capture:!0})}))}},{key:Um,value:function(){return this.selectionTool.copy()}},{key:Hm,value:function(){return this.selectionTool.createTextHighlight()}},{key:Wm,value:function(){return this.selectionTool.createStrikeout()}},{key:Ym,value:function(){return this.selectionTool.createUnderline()}},{key:"create-edit-text",value:function(){return this.selectionTool.createEditText()}},{key:"showAt",value:function(e,t){var i=this;(0,S._)((0,x._)(n.prototype),"showAt",this).call(this,e,t),this.dom.style.cssText+="\n            left: ".concat(e,"px;\n            top: ").concat(t,"px;\n        "),Promise.resolve(this.pageRender.docRender.getUserPermission().getValue()).then((function(e){i.dom.querySelectorAll("div>div.fv__selection-tool-tip-item:not(.fv__icon-popup-copy)").forEach((function(t){32&e?t.classList.remove("disabled"):t.classList.add("disabled")})),16&e?i.dom.querySelector("div>div.fv__icon-popup-copy").classList.remove("disabled"):i.dom.querySelector("div>div.fv__icon-popup-copy").classList.add("disabled"),i.dom.classList.add("fv__active"),i.dom.focus()}))}},{key:"hide",value:function(){(0,S._)((0,x._)(n.prototype),"hide",this).call(this),this.dom.classList.remove("fv__active")}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.dom.remove(),this.selectionTool.destroy()}}]),n}(Nm),Gm=(function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).selectionTool=new jm(e,i),r.init(),r}(0,A._)(n,[{key:"init",value:function(){}},{key:"showAt",value:function(e,t){(0,S._)((0,x._)(n.prototype),"showAt",this).call(this,e,t)}},{key:"hide",value:function(){(0,S._)((0,x._)(n.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){this.selectionTool.destroy()}}])}(Nm),g(564)),Jm=g.n(Gm),Xm=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this)).uniqueClassName=i.uniqueClassName,r.disabledClassName="context-menu-disabled",r.name=e,r}return(0,A._)(n,[{key:"disable",value:function(){if(this.isEnabled()){var e=this.getDOM();e&&e.classList.add(this.disabledClassName)}}},{key:"enable",value:function(){if(!this.isEnabled()){var e=this.getDOM();e&&e.classList.remove(this.disabledClassName)}}},{key:"getDOM",value:function(){return document.querySelector(this.uniqueClassName)}},{key:"isEnabled",value:function(){var e=this.getDOM();return!!e&&e.classList.contains(this.disabledClassName)}}]),n}(function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"disable",value:function(){(0,j.notImplemented)("disable")}},{key:"enable",value:function(){(0,j.notImplemented)("enable")}},{key:"isEnabled",value:function(){return(0,j.notImplemented)("isEnabled"),!1}}]),e}()),Zm=g(4528),Qm=g.n(Zm);!function(e){e.PROGRESSING="Progressing",e.SUCCESS="Success",e.FAIL="Fail"}(Rm||(Rm={}));var ey=(new DOMParser).parseFromString(Qm()(),"text/html").body.firstElementChild,ty=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return(0,P._)(this,n),(e=t.call(this)).pdfViewer=o,e.coverOn=r,e.dom=ey.cloneNode(!0),e.textElement=e.dom.querySelector(".fv__ui-progress-text"),e.updateProgress(i),e}return(0,A._)(n,[{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.coverOn;this.coverOn=e,this.updateProgress(0),e.appendChild(this.dom),this.dom.style.display="block"}},{key:"hide",value:function(){this.dom.style.display="none",this.updateProgress(0)}},{key:"updateProgress",value:function(e,t){var n=this,i="";i=t===Rm.FAIL||t===Rm.SUCCESS?this.pdfViewer.i18n.t("progress.".concat(t)):"number"==typeof e?"".concat(e,"%"):"string"==typeof e?e:"".concat(e.current," / ").concat(e.total),this.textElement.innerText=i,t!==Rm.FAIL&&t!=Rm.SUCCESS||setTimeout((function(){n.hide()}),800)}}]),n}(j.Disposable),ny=new(function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"destroy",value:function(){}}]),n}(Om)),iy=[],ry=function(){var e=Jm()({isIE:j.isIE}),t=document.createElement("div");t.innerHTML=e;var n=t.firstElementChild;return t.removeChild(n),n}();var oy=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"prepare",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"prepare",this).call(this,e);var i={},r={},o=function(n,o){if(o){var a=o.getStateName(),s=r[a];s&&s.destroy()}var u=n.getStateName(),c=i[u]||(n.getDefaultContextMenuConfig?n.getDefaultContextMenuConfig():void 0);r[u]=t.createContextMenu(u,e.$ui.get(0),c)};this.menus=r,e.eventEmitter.on(de.switchStateHandler,o),e.eventEmitter.once(de.renderFileSuccess,(function(){setTimeout((function(){e.isDestroyed||o(e.getStateHandlerManager().currentStateHandler)}),200)})),e.addDestroyHook((function(){t.menus={}}))}},{key:"createContextMenu",value:function(e,t,n){if(!n||!n.items)return ny;var i=n.items,r=this.pdfViewer.i18n;for(var o in i){var a=i[o];a.nameI18nKey&&(a.name=r.t(a.nameI18nKey));var s=(0,j.getUniqueId)(o);a.className=a.className?a.className+" "+s:s,a.uniqueClassName=s}var u=O()(t),c=new(function(e){(0,C._)(r,e);var t=(0,T._)(r);function r(){return(0,P._)(this,r),t.apply(this,arguments)}return(0,A._)(r,[{key:"destroy",value:function(){this._destroyContextMenu()}},{key:"_destroyContextMenu",value:function(){var e=O().contextMenu.menus;Object.keys(e).forEach((function(t){var n=e[t];n.context===u[0]&&(n.$menu.remove(),delete e[t],O()(n.context).off(n.ns))}))}},{key:"showAt",value:function(e,t){var n=O().Event("contextmenu",{data:{events:{preShow:function(){}}},pageX:e,pageY:t});n.target=u.find(".fv__pdf-page-annot-handler-rect")[0],u.trigger(n)}},{key:"disable",value:function(){(0,S._)((0,x._)(r.prototype),"disable",this).call(this),this._destroyContextMenu()}},{key:"enable",value:function(){(0,S._)((0,x._)(r.prototype),"enable",this).call(this),this._destroyContextMenu(),this.createRealContextmenu()}},{key:"createRealContextmenu",value:function(){var e=n.zIndex;switch(void 0===e?"undefined":(0,R._)(e)){case"number":n.zIndex=function(){return e};case"function":break;default:n.zIndex=function(){return 30}}u.contextMenu(n)}},{key:"getItem",value:function(e){if(e in i)return new Xm(e,i[e])}}]),r}(Om));return u.on("contextmenu:hide",(function(){c.hiddenCallbacks.forEach((function(e){return e.call(c)}))})),c.createRealContextmenu(),this.pdfViewer.addDestroyHook((function(){c.destroy()})),c}},{key:"alert",value:function(e){return"[object Object]"===Object.prototype.toString.call(e)&&(e=e.message),e=this.pdfViewer.i18n.t(e)||e,window.alert(e),Promise.resolve()}},{key:"confirm",value:function(e){"[object Object]"===Object.prototype.toString.call(e)&&(e=e.message),e=this.pdfViewer.i18n.t(e)||e;var t=window.confirm(e);return t?Promise.resolve(t):Promise.reject("confirm dialog has been cancelled by user!")}},{key:"prompt",value:function(e,t){"[object Object]"===Object.prototype.toString.call(t)&&(t=t.message),t=this.pdfViewer.i18n.t(t)||t;var n=window.prompt(t,e||"");return n?Promise.resolve(n):Promise.reject("prompt dialog has been cancelled by user!")}},{key:"promptPassword",value:function(e,t){t=this.pdfViewer.i18n.t(t)||t;var n=window.prompt(t,e||"");return n?Promise.resolve(n):Promise.reject("prompt dialog has been cancelled by user!")}},{key:"loading",value:function(e){var t=this;return this.renderingDOM=(0===iy.length&&iy.push(ry.cloneNode(!0)),iy.pop()),e.appendChild(this.renderingDOM),function(){t.renderingDOM.parentElement===e&&e.removeChild(t.renderingDOM),iy.push(t.renderingDOM)}}},{key:"progress",value:function(e,t){return!this.progressTool&&(this.progressTool=new ty(e,t,this.pdfViewer)),this.progressTool.show(t),this.progressTool}},{key:"createFreeTextTooltip",value:function(e){}},{key:"createAnnotTooltip",value:function(e){}},{key:"createTextSelectionTooltip",value:function(e){var t=new zm(this.pdfViewer,e);return this.pdfViewer.addDestroyHook((function(){t.destroy()})),t}},{key:"destroy",value:function(){Object.values(this.menus).forEach((function(e){return e&&e.destroy()}))}}]),n}(Lm);const ay="ffc174c9@release/10_0_0";function sy(e){var t=document.createElement("img");return new Promise((function(n){t.onload=function(){n(t)},t.src=URL.createObjectURL(e)}))}function uy(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return dy(e).then(sy).then((function(e){return n.drawImage(e,0,0),t}))}function cy(e){return dy(e).then(sy)}function ly(e){return dy(e).then((function(e){var t=new FileReader;return new Promise((function(n){t.onloadend=function(){n(t.result)},t.readAsArrayBuffer(e)}))}))}function dy(e){if(e.buffer){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d"),i=new(Uint8ClampedArray||Uint8Array)(e.buffer),r=n.createImageData(e.width,e.height);return r.data.set(i),n.putImageData(r,0,0),new Promise((function(e){t.toBlob(e)}))}return e.image?Promise.resolve(e.image):Promise.reject(e)}window.toImage=cy;var hy=function(){function e(t,n,i){(0,P._)(this,e),this.page=n,this.doc=n.doc,this.engine=i,this.info=t}return(0,A._)(e,[{key:"destroy",value:function(){this.page=null,this.doc=null,this.engine=null,this.info=null}},{key:"getId",value:function(){return this.info.id}},{key:"getPDFPage",value:function(){return this.page}},{key:"getBitmap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"canvas",i=this.getPDFPage();return i.doc.api.getGraphicsObjectBitmap(i.getPDFDoc().getId(),i.getId(),this.getId(),e*(0,j.getPtPxRatio)(),t).then((function(e){if(!e.width||!e.height)return null;switch(n||"canvas"){case"canvas":return uy(e);case"image":return cy(e);case"buffer":return ly(e);default:throw new Error("Invalid options.type: ".concat(n))}}))}},{key:"getRect",value:function(){return this.info.rect}},{key:"setRect",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var n=this.getPDFPage();this.info.rect=e;var i=arguments[1];return n.doc.api.setGraphicsObjectRect(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e,i)}))}},{key:"setMatrix",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var n=this.getPDFPage();return this.info.matrix=e,n.doc.api.setGraphicsObjectMatrix(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"getMatrix",value:function(){var e=this.info.matrix;return new nn.Z(e.a,e.b,e.c,e.d,e.e,e.f)}},{key:"getDeviceMatrix",value:function(){var e=this.getMatrix();e.translate(0,-this.getPDFPage().getHeight());var t=(0,U.F2)(1);return e.scale(t,-t),e}},{key:"getType",value:function(){return this.info.type}},{key:"getBorderDashes",value:function(){return fy(this.getType()),this.info.graphState.dashes}},{key:"getBorderStyle",value:function(){return fy(this.getType()),this.info.graphState.dashes.length>0?1:0}},{key:"setBorderStyle",value:function(e,t){var n=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");fy(this.getType());var i=this.getPDFPage();return this.info.graphState.dashes=t,i.doc.api.setGraphicsObjectBorderStyle(i.getPDFDoc().getId(),i.getId(),this.getId(),e,t).then((function(e){n.afterUpdated(e)}))}},{key:"getBorderWidth",value:function(){return fy(this.getType()),this.info.graphState.lineWidth}},{key:"setBorderWidth",value:function(e){var t=this;if(fy(this.getType()),!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var n=this.getPDFPage();return this.info.graphState.lineWidth=e,n.doc.api.setGraphicsObjectBorderWidth(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"getBorderColor",value:function(){return fy(this.getType()),(4278190080|this.info.strokeColor)>>>0}},{key:"setBorderColor",value:function(e){var t=this;if(fy(this.getType()),!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var n=this.getPDFPage();return n.doc.api.setGraphicsObjectBorderColor(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"getFillColor",value:function(){return fy(this.getType()),(4278190080|this.info.fillColor)>>>0}},{key:"setFillColor",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");fy(this.getType());var n=this.getPDFPage();return n.doc.api.setGraphicsObjectFillColor(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"getOpacity",value:function(){return((4278190080&this.info.strokeColor)>>>0)/4278190080}},{key:"setOpacity",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var n=this.getPDFPage();return n.doc.api.setGraphicsObjectOpacity(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"remove",value:function(){if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");return this.getPDFPage().removeGraphicsObject(this)}},{key:"moveToPosition",value:function(e,t){var n=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var i=this.getPDFPage();if(-1===Object.values(Lt).findIndex((function(t){return t==e})))throw new Error("Type error");var r=null;return e!=Lt.first&&e!=Lt.last&&(r=t.getId()),i.doc.api.moveGraphicsObjectByPosition(i.getPDFDoc().getId(),i.getId(),this.getId(),e,r).then((function(e){n.afterUpdated(e)}))}},{key:"afterUpdated",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return this.info;if(this.info=e,!n)return this.info;var i=this.page.getBatchProcessor(),r=function(){t.doc.engine.eventEmitter.emit(le.graphicsUpdated,t.page,t)};return i.isStarted()?i.recordFlushOperation(this,r):r(),this.info}}]),e}(),fy=function(e){if(1!=e&&2!=e&&5!=e)throw new Error("only text, path object are supported")},gy=j.LoggerFactory.getLogger("WebAppLifecycleInvoker"),vy=function(){function e(){(0,P._)(this,e),this.$hooks=[]}return(0,A._)(e,[{key:"addReleaseHook",value:function(e){var t=this;return"function"==typeof e?(this.$hooks.push(e),function(){var n=t.$hooks.indexOf(e);n>-1&&t.$hooks.splice(n,1)}):j.noop}},{key:"prepare",value:function(){}},{key:"generate",value:function(){}},{key:"release",value:function(){var e=[];this.$hooks.forEach((function(t,n){try{!1===t()&&e.push(t)}catch(e){gy.error("An error occurred while release a resource",e)}})),this.$hooks=e}},{key:"expose",value:function(){return{}}},{key:"wrap",value:function(e,t,n){var i=Object.create(e),r=e[t];if("function"!=typeof r)throw new Error("Unable to wrap a member that is not function. Actual type: "+(void 0===r?"undefined":(0,R._)(r)));return i[t]=n(r.bind(i)),i}}],[{key:"resolveInstance",value:function(t){if("object"==typeof t){if(t.invoke)return function(e){(0,C._)(i,e);var n=(0,T._)(i);function i(){return(0,P._)(this,i),n.apply(this,arguments)}return(0,A._)(i,[{key:"prepare",value:function(){"function"==typeof t.prepare&&t.prepare.apply(this,arguments)}},{key:"generate",value:function(){return t.invoke.apply(this,arguments)}}]),i}(e)}else if("function"==typeof t)return j.Reflect.isSubClassOf(t,e)?t:function(e){(0,C._)(i,e);var n=(0,T._)(i);function i(){return(0,P._)(this,i),n.apply(this,arguments)}return(0,A._)(i,[{key:"generate",value:function(){return t.apply(this,arguments)}}]),i}(e);throw new Error("incorrect lifecycle invoker")}}]),e}(),py=function(){function e(t){(0,P._)(this,e),this.parentManager=t,this.lifeCycles={},this.generators={}}return(0,A._)(e,[{key:"registerLifecycle",value:function(e){var t=this,n=e.constructor,i=n.getName();this.lifeCycles[i]=e,e.initialize();var r=n.depends();r.length>0&&r.forEach((function(n){var r=t.getLifeCycle(n);r.addReleaseHook((function(){e.release()})),r.addDestroyHook((function(){i in t.lifeCycles&&delete t.lifeCycles[i],e.destroy()}))}))}},{key:"registerResourceGenerator",value:function(e,t){this.generators[e]=vy.resolveInstance(t)}},{key:"getLifeCycle",value:function(e){if(e in this.lifeCycles)return this.lifeCycles[e];if(this.parentManager)return this.parentManager.getLifeCycle(e);throw new Error("Incorrect lifecycle name: ".concat(lifecycleName,", please make sure that has been registered via WebAppLifecycleManager.registerLifecycle()!"))}},{key:"getResourceGeneratorClass",value:function(e){if(e in this.generators)return this.generators[e];if(this.parentManager)return this.parentManager.getResourceGeneratorClass(e);throw new Error("Incorrect generator name: ".concat(e,", please make sure that has been registered via WebAppLifecycleManager.registerResourceGenerator(name, generator)!"))}},{key:"generator",value:function(e,t){var n,i=this.getLifeCycle(e),r=i.getResourceGenerator(t);r||(n="string"==typeof t?this.getResourceGeneratorClass(t):vy.resolveInstance(t),i.addResourceGenerator(t,n),r=i.getResourceGenerator(t));return r}},{key:"releaseAll",value:function(){Object.values(this.lifeCycles).forEach((function(e){e.release()}))}},{key:"destroy",value:function(){Object.values(this.lifeCycles).forEach((function(e){e.destroy()}))}}]),e}(),my=function(){function e(){(0,P._)(this,e),this.keyArray=[],this.valueArray=[]}return(0,A._)(e,[{key:"size",get:function(){return this.keyArray.filter((function(t){return t!==e.NONE})).length}},{key:"set",value:function(t,n){var i=this.keyArray,r=this.valueArray,o=i.indexOf(t);if(-1===o){var a=i.indexOf(e.NONE);-1!==a?o=a:(i.push(t),o=i.length-1)}i[o]=t,r[o]=n}},{key:"get",value:function(e){var t=this.keyArray;return this.valueArray[t.indexOf(e)]}},{key:"delete",value:function(t){var n=this.keyArray,i=this.valueArray,r=n.indexOf(t);r>-1&&(n[r]=e.NONE,i[r]=e.NONE)}},{key:"has",value:function(e){return this.keyArray.indexOf(e)>-1}},{key:"clear",value:function(){this.keyArray.length=0,this.valueArray.length=0}},{key:"keys",value:function(){return this.keyArray.filter((function(t){return t!==e.NONE}))}},{key:"values",value:function(){return this.valueArray.filter((function(t){return t!==e.NONE}))}}],[{key:"NONE",get:function(){return{}}}]),e}(),yy=j.LoggerFactory.getLogger("WebAppLifeCycle"),ky=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),(e=t.call(this)).map=new(Map||my),e.releaseHooks=[],e}return(0,A._)(n,[{key:"release",value:function(){if(!this.isDestroyed){var e=this.map.values();if(Array.isArray(e))e.forEach((function(e){return e.release()}));else{var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){r.value.release()}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}this.releaseHooks.forEach((function(e){try{e()}catch(e){yy.error("An error occurred while invoking release hook",e)}})),this.releaseHooks.length=0}}},{key:"getResourceGenerator",value:function(e){if(this.map.has(e))return this.map.get(e)}},{key:"addResourceGenerator",value:function(e,t){if(this.map.has(e))throw new Error("duplicate generator name is not supported now!");this.map.set(e,new t)}},{key:"initialize",value:function(){(0,j.notImplemented)()}},{key:"addReleaseHook",value:function(e){"function"==typeof e&&this.releaseHooks.push(e)}},{key:"destroy",value:function(){this.isDestroyed||(this.release(),this.map.clear(),delete this.map,(0,S._)((0,x._)(n.prototype),"destroy",this).call(this))}}],[{key:"getName",value:function(){(0,j.notImplemented)()}},{key:"depends",value:function(){return[]}}]),n}(j.Disposable),by=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this)).pdfViewer=e,i}return(0,A._)(n,[{key:"initialize",value:function(){var e=this,t=this.pdfViewer.destroy;this.pdfViewer.destroy=function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return t.apply(e.pdfViewer,i).then((function(){e.release()}))}}}],[{key:"getName",value:function(){return Lf.PDF_VIEWER_ALIVE}},{key:"depends",value:function(){return[Lf.BROWSER_RELOAD]}}]),n}(ky),wy=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this)).pdfViewer=e,i}return(0,A._)(n,[{key:"initialize",value:function(){var e=this,t=function(){e.release()};this.pdfViewer.eventEmitter.on(de.willCloseDocument,t),this.addDestroyHook((function(){e.pdfViewer.eventEmitter.off(de.willCloseDocument,t),delete e.pdfViewer}))}}],[{key:"getName",value:function(){return Lf.PDF_DOCUMENT_CLOSING}},{key:"depends",value:function(){return[Lf.PDF_VIEWER_ALIVE,Lf.BROWSER_RELOAD]}}]),n}(ky),_y=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"generate",value:function(e){var t=window.URL||window.webkitURL,n=t.createObjectURL(e);return this.addReleaseHook((function(){return t.revokeObjectURL(n),!0})),n}},{key:"expose",value:function(){return this.getWrappedURL()}},{key:"getWrappedURL",value:function(){var e=this;if(this.WrappedURL)return this.WrappedURL;var t=window.URL||window.webkitURL,n=this.wrap(t,"createObjectURL",(function(){return function(t){return e.generate(t)}}));return this.WrappedURL=n,n.URL=n,n}}]),n}(vy),Py=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"initialize",value:function(){}},{key:"addResourceGenerator",value:function(e,t){var i=this.map.size;(0,S._)((0,x._)(n.prototype),"addResourceGenerator",this).call(this,e,t),this.map.size>i&&this.prepareUnloadEvent()}},{key:"prepareUnloadEvent",value:function(){var e=this;if(!this.prepared)if(this.prepared=!0,"function"!=typeof window.onunload)window.onunload=function(){return e.destroy(),""};else{var t=window.onunload;window.onunload=function(n){return e.destroy(),t.call(window,n)}}}}],[{key:"getName",value:function(){return Lf.BROWSER_RELOAD}}]),n}(ky),Ay=g(5222),Sy=function(){function e(t,n){(0,P._)(this,e),this.id=t,this.page=n,this.api=n.api}return(0,A._)(e,[{key:"getId",value:function(){return this.id}},{key:"findNext",value:function(){return this.page.doc.api.textSearchFindNext(this.getId()).then((function(e){return e?new uo(e):null}))}},{key:"findPrev",value:function(){return this.page.doc.api.textSearchFindPrev(this.getId()).then((function(e){return e?new uo(e):null}))}},{key:"destroy",value:function(){if(!this.page.isDestroyed&&!this.page.doc.isDestroyed&&this.page.doc.api)return this.page.doc.api.textSearchDestroy(this.getId())}}]),e}(),xy=function(){function e(t,n,i){(0,P._)(this,e),this.doc=t,this.id=n,this.engine=i}return(0,A._)(e,[{key:"hasKey",value:function(e){return this.doc.api.hasKey(this.doc.getId(),this.id,e)}},{key:"setAt",value:function(e,t){var n=this;return this.doc.api.setAt(this.doc.getId(),this.id,e,t).then((function(e){return n.engine.eventEmitter.emit(le.docModified,n.doc),e}))}},{key:"getAt",value:function(e){return this.doc.api.getAt(this.doc.getId(),this.id,e)}}]),e}();const Cy=xy;var Dy,Ey=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"id",void 0),this.id=t}return(0,A._)(e,[{key:"getId",value:function(){return this.id}},{key:"findNext",value:function(){return Promise.resolve(null)}},{key:"findPrev",value:function(){return Promise.resolve(null)}},{key:"destroy",value:function(){}}]),e}(),Iy=["Courier","Courier-Bold","Courier-BoldOblique, Bold italic","Courier-Oblique, Italic","Helvetica","Helvetica-Bold","Helvetica-BoldOblique, Bold italic","Helvetica-Oblique, Italic","Times-Roman","Times-Bold","Times-BoldItalic","Times-Italic","Symbol","ZapfDingbats"];function Ry(e,t,n){var i,r=e.json,o=r.contentFormats,a=r.contents,s=[o.TopLeft||(a?[{type:"string",value:a.TopLeft}]:[]),o.TopCenter||(a?[{type:"string",value:a.TopCenter}]:[]),o.TopRight||(a?[{type:"string",value:a.TopRight}]:[]),o.BottomLeft||(a?[{type:"string",value:a.BottomLeft}]:[]),o.BottomCenter||(a?[{type:"string",value:a.BottomCenter}]:[]),o.BottomRight||(a?[{type:"string",value:a.BottomRight}]:[])];s=s.map((function(e){var t="";return e.forEach((function(e){switch(e.type){case"string":sn(e.value)?t="":t+=e.value;break;case"pageNumber":t+=function(e){switch(e){case wt.default:return"<<1>>";case wt.numberOfCount:return"<<1 of n>>";case wt.numberSlashCount:return"<<1/n>>";case wt.pageNumber:return"<<Page 1>>";case wt.pageNumberOfCount:return"<<Page 1 of n>>"}return"<<1>>"}(e.value);break;case"date":t+=function(e){switch(e){case bt.MSlashD:return"<<m/d>>";case bt.MSlashDSlashYY:return"<<m/d/yy>>";case bt.MSlashDSlashYYYY:return"<<m/d/yyyy>>";case bt.MMSlashDDSlashYY:return"<<mm/dd/yy>>";case bt.MMSlashDDSlashYYYY:return"<<mm/dd/yyyy>>";case bt.DSlashMSlashYY:return"<<d/m/yy>>";case bt.DSlashMSlashYYYY:return"<<d/m/yyyy>>";case bt.DDSlashMMSlashYY:return"<<dd/mm/yy>>";case bt.DDSlashMMSlashYYYY:return"<<dd/mm/yyyy>>";case bt.MMSlashYY:return"<<mm/yy>>";case bt.MMSlashYYYY:return"<<mm/yyyy>>";case bt.MDotDDotYY:return"<<m.d.yy>>";case bt.MDotDDotYYYY:return"<<m.d.yyyy>>";case bt.MMDotDDDotYY:return"<<mm.dd.yy>>";case bt.MMDotDDDotYYYY:return"<<mm.dd.yyyy>>";case bt.MMDotYY:return"<<mm.yy>>";case bt.DDotMDotYYYY:return"<<d.m.yyyy>>";case bt.DDDotMMDotYY:return"<<dd.mm.yy>>";case bt.DDDotMMDotYYYY:return"<<dd.mm.yyyy>>";case bt.YYHyphenMMHyphenDD:return"<<yy-mm-dd>>";case bt.YYYYHyphenMMHyphenDD:return"<<yyyy-mm-dd>>"}return"<<<<m/d>>"}(e.value)}})),t}));var u=(i={submitLoading:!1,showPreview:!1,fontEmbed:!1,isShrink:!1,isKeep:!1,marginLeft:72,marginRight:72,marginTop:36,marginBottom:36,pageOdd:!0,pageEven:!0,pageCount:n},(0,J._)(i,"fontEmbed",!1),(0,J._)(i,"currentPage",t),i);u.leftHeaderText=s[0],u.centerHeaderText=s[1],u.rightHeaderText=s[2],u.leftFooterText=s[3],u.centerFooterText=s[4],u.rightFooterText=s[5],u.isShrink=r.hasTextShrinked||!1,u.isKeep=r.hasFixedSized||!1,r.startPageNumber=r.startPageNumber||1,u.startPage=r.startPageNumber-1,r.range?(r.range.start=r.range.start||1,r.range.end=r.range.end||n,r.range.start<1&&(r.range.start=1),r.range.start>n&&(r.range.start=n),r.range.end<1&&(r.range.end=1),r.range.end>n&&(r.range.end=n),u.pageStart=r.range.start-1,u.pageEnd=r.range.end-1,0===r.range.filter?(u.pageOdd=!0,u.pageEven=!0):1===r.range.filter?(u.pageOdd=!1,u.pageEven=!0):2===r.range.filter&&(u.pageOdd=!0,u.pageEven=!1)):(u.pageStart=0,u.pageEnd=n-1,u.pageOdd=!0,u.pageEven=!0),r.margin&&(u.marginLeft=r.margin.left,u.marginBottom=r.margin.bottom,u.marginTop=r.margin.top,u.marginRight=r.margin.right);var c=r.font?r.font:r.fontId;return u.font=c||0,u.fontSize=r.textSize||12,u.fontColor=r.textColor||0,u.underLine=r.underline||!1,"string"==typeof u.font?u.fontName=u.font:((u.font<0||u.font>=Iy.length)&&(u.font=0),u.fontName=Iy[u.font]),u}function Ty(e,t){var n=0;!e.pageOdd&&e.pageEven?n=1:e.pageOdd&&!e.pageEven&&(n=2);var i=-1===e.pageStart?1:e.pageStart+1,r=-1===e.pageEnd?t:e.pageEnd+1,o=(0,j.colorConvertor)(e.fontColor,"int",0);return{font:e.fontName,textSize:e.fontSize,textColor:o,hasTextShrinked:e.isShrink,hasFixedSized:e.isKeep,range:{start:i,end:r,filter:n},margin:{left:e.marginLeft,right:e.marginRight,top:e.marginTop,bottom:e.marginBottom},startPageNumber:e.startPage+1,contents:{TopLeft:e.leftHeaderText,TopCenter:e.centerHeaderText,TopRight:e.rightHeaderText,BottomLeft:e.leftFooterText,BottomCenter:e.centerFooterText,BottomRight:e.rightFooterText},contentFormats:{},underline:e.underLine}}function Fy(e,t,n,i,r){var o={showAdvanceSetting:!0,showApperanceOptModal:!1,submitLoading:!1,pageCount:r,currentPage:t+1,text:"",pageNumber:t,absScale:e.absScale,filePath:"",docId:null,doc:null,file:null,scaleCkd:!0,appear:2,pageStart:n,pageEnd:i,pageOdd:!0,pageEven:!0,isPrint:!0,isScreen:!0,isKeep:!1,unit:6,isMultiline:e.isMultiline,rowSpace:e.rowSpace,columnSpace:e.columnSpace};if(o.scaleCkd=!1!==e.useRelativeScale,void 0===o.absScale&&(o.absScale=100),o.absScale<0&&(o.scale=0),o.absScale>100&&(o.scale=100),o.isMultiline&&(null==o.rowSpace&&(o.rowSpace=0),null==o.columnSpace&&(o.columnSpace=0)),"text"===e.type){o.sourceType=1,o.text=e.text;var a=Object.assign({font:0,fontSize:20,color:0,fontStyle:"normal"},e.watermarkTextProperties);o.font=a.font,o.fontSize=a.fontSize,o.fontColor=a.color,"normal"===a.fontStyle?o.underLine=!1:"underline"===a.fontStyle&&(o.underLine=!0),"string"==typeof o.font?o.fontName=o.font:((o.font<0||o.font>=Iy.length)&&(o.font=0),o.fontName=Iy[o.font])}else"bitmap"===e.type&&(o.sourceType=2,o.bitmap=e.bitmap);var s=Object.assign({position:"Center",offsetX:0,offsetY:0,flags:7,scale:1,rotation:45,opacity:100},e.watermarkSettings);switch(o.hDistance=s.offsetX,o.vDistance=s.offsetY,o.opacity=s.opacity,o.rotate=s.rotation,s.scale<0&&(s.scale=.01),s.scale>1&&(s.scale=1),o.scale=100*s.scale,s.flags&dt.asAnnot?o.isKeep=!0:o.isKeep=!1,s.flags&dt.onTop?o.appear=2:o.appear=1,s.flags&dt.unprintable?o.isPrint=!1:o.isPrint=!0,s.flags&dt.display?o.isScreen=!1:o.isScreen=!0,s.position){case lt.topLeft:o.vFrom=1,o.hFrom=1;break;case lt.topCenter:o.vFrom=1,o.hFrom=2;break;case lt.topRight:o.vFrom=1,o.hFrom=3;break;case lt.centerLeft:o.vFrom=2,o.hFrom=1;break;case lt.center:o.vFrom=2,o.hFrom=2;break;case lt.centerRight:o.vFrom=2,o.hFrom=3;break;case lt.bottomLeft:o.vFrom=3,o.hFrom=1;break;case lt.bottomCenter:o.vFrom=3,o.hFrom=2;break;case lt.bottomRight:o.vFrom=3,o.hFrom=3}return o}!function(e){e.EDIT_GRAPHICS_OBJECT="edit-graphics-object"}(Dy||(Dy={}));var My=j.LoggerFactory.getLogger("engine-pdf-page-batch-processor"),Oy=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dy.EDIT_GRAPHICS_OBJECT;(0,P._)(this,e),(0,J._)(this,"page",void 0),(0,J._)(this,"kind",void 0),(0,J._)(this,"flushOperations",void 0),(0,J._)(this,"started",void 0),this.page=t,this.kind=n,this.flushOperations=new Map,this.started=!1}return(0,A._)(e,[{key:"start",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){return e.started=!0,[2,e.callAPI("start")]}))}))()}},{key:"isStarted",value:function(){return!this.isDestroyed()&&this.started}},{key:"flush",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){return e.isStarted()?(e.flushLocally(),[2,e.callAPI("flush")]):[2]}))}))()}},{key:"end",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){return e.started=!1,e.flushLocally(),[2,e.callAPI("end")]}))}))()}},{key:"flushLocally",value:function(){var e=this.flushOperations.values();try{var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){(0,r.value)()}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}catch(e){My.error(e)}finally{this.flushOperations.clear()}}},{key:"isDestroyed",value:function(){return this.page.isDestroyed}},{key:"callAPI",value:function(e){if(!this.isDestroyed()){var t=this.page.doc,n=this.page.getId(),i=t.getId();return t.api.emitPageBatchProcessor({path:"jr/doc/page"},i,n,{action:e,kind:this.kind})}}},{key:"recordFlushOperation",value:function(e,t){this.flushOperations.set(e,t)}}]),e}(),Ly=["highlight","strikeout","underline","squiggly","caret","text","fileattachment","freetext","ink","line","link","circle","square","polygon","polyline","stamp","screen"];function Ny(e,t){if(-1==Ly.indexOf(e.type))throw new Error("Annot type error");if(t&&t.isTextAsContent){["highlight","strikeout","underline","squiggly"].includes(e.type)&&!e.contents&&e.coords[0]&&e.coords[0].text&&(e.contents=e.coords[0].texts||e.coords[0].text)}return e.iconCatagory&&(e.iconCategory=e.iconCatagory),e.iconInfo&&e.iconInfo.catagory&&(e.iconInfo.category=e.iconInfo.catagory),e}var Vy=function(){function e(t,n){(0,P._)(this,e),this.info=t,this.isDestroyed=!1,this.doc=n,this.engine=n.engine,this.api=n.api,this._pxWdith=(0,U.F2)(this.getWidth()),this._pxHeight=(0,U.F2)(this.getHeight()),this.annots=[],this.annotIdMap={},this.graphicObjects=[],this.info.AA[0]&&(this.openAction=this.doc.engine.actionFactory.createAction(this.info.AA[0],n,this.doc.api,this.doc.engine.eventEmitter,this)),this.info.AA[1]&&(this.closeAction=this.doc.engine.actionFactory.createAction(this.info.AA[1],n,this.doc.api,this.doc.engine.eventEmitter,this)),n.pageIdMap[t.id]=this,this.batchProcessor=new Oy(this),this.queuedTaskExecutor=new j.QueuedAsyncTaskExecutor}return(0,A._)(e,[{key:"getAction",value:function(e){return"open"==e?this.openAction:this.closeAction}},{key:"getActions",value:function(e){var t=this;return this.doc.api.getPageAction(this.getPDFDoc().getId(),this.getId(),e).then((function(e){if(e)return t.doc.engine.actionFactory.createAction(e,t.doc,t.doc.api,t.engine.eventEmitter,t)}))}},{key:"setAction",value:function(e,t){var n=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(i){return[2,n.doc.api.setPageAction(n.getPDFDoc().getId(),n.getId(),e,t.info).then((function(e){return n.doc.engine.eventEmitter.emit(le.docModified,n.doc),e}))]}))}))()}},{key:"setActionData",value:function(){this.doc.api.updatePageAction()}},{key:"moveAction",value:function(e){var t=this;return this.doc.api.movePageAction(this.getPDFDoc().getId(),this.getId(),e).then((function(e){return t.doc.engine.eventEmitter.emit(le.docModified,t.doc),e}))}},{key:"removeAction",value:function(e,t){var n=this;return this.doc.api.removePageAction(this.getPDFDoc().getId(),this.getId(),e,t?t.info:null).then((function(e){return n.doc.engine.eventEmitter.emit(le.docModified,n.doc),e}))}},{key:"getId",value:function(){return this.info.id}},{key:"getInfo",value:function(){return this.info}},{key:"getPDFDoc",value:function(){return this.doc}},{key:"getIndex",value:function(){return this.info.index}},{key:"getWidth",value:function(){return this.info.width}},{key:"getHeight",value:function(){return this.info.height}},{key:"updateInfo",value:function(){var e=this;return this.doc.api.updatePageInfo(this.getPDFDoc().getId(),this.getId()).then((function(t){e._updateInfo(t)}))}},{key:"_updateInfo",value:function(e){this.info=e,this.doc.updatePageSize(e.index,this.getWidth(),this.getHeight()),this._pxWdith=(0,U.F2)(this.getWidth()),this._pxHeight=(0,U.F2)(this.getHeight()),this.doc.engine.eventEmitter.emit(le.pageInfoChange,this)}},{key:"getRotation",value:function(){return this.info.rotation}},{key:"setRotation",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");var n=this.getRotation();return e===n?Promise.resolve():(this.doc.engine.eventEmitter.emit(le.beforePageRotationChanged,this,e,n),this.doc.api.setPageRotation(this.getPDFDoc().getId(),this.getId(),e).then((function(e){return Promise.all([e,t.updateInfo()])})).then((function(e){var i=(0,E._)(e,1)[0];t.doc.engine.eventEmitter.emit(le.pageRotationChange,t,i,n)})))}},{key:"getRotationAngle",value:function(){var e=this.getRotation();if(4===e)throw new Error("Unknown rotation angle value: "+e);return 90*e}},{key:"getPxWidth",value:function(){return this._pxWdith}},{key:"getPxHeight",value:function(){return this._pxHeight}},{key:"getOriginX",value:function(){return this.info.cropBox.left}},{key:"getOriginY",value:function(){return this.info.cropBox.bottom}},{key:"getPDFMatrix",value:function(){return new nn.Z(this.info.matrix)}},{key:"getDeviceMatrix",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.getPDFMatrix(),n=this.getHeight(),i=this.getWidth();t.translate(0,-n);var r=(0,U.F2)(1);switch(t.scale(r,-r),e){case 90:t.rotate(e/180*Math.PI),t.translate(r*n,0);break;case 180:t.rotate(e/180*Math.PI),t.translate(r*i,r*n);break;case 270:t.rotate(e/180*Math.PI),t.translate(0,r*i)}return t}},{key:"getDeviceMatrix2",value:function(){var e=this.getPDFMatrix(),t=this.getRotation(),n=(0,U.F2)(1);switch(t%4){case 0:e.translate(0,-this.getHeight()),e.scale(n,-n);break;case 1:e.scale(-n,n),e.rotate(Math.PI/2);break;case 2:e.translate(-this.getWidth(),0),e.scale(-n,n);break;case 3:e.translate(this.getWidth(),this.getHeight()),e.rotate(Math.PI/2),e.scale(n,-n)}return e}},{key:"getDevicePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getDeviceMatrix(n);return i.scale(t,t),i.transformPoint(e[0],e[1])}},{key:"getDeviceRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getDeviceMatrix(n);i.scale(t,t);var r=i.transformRect(e.left,e.top,e.right,e.bottom);return{left:r[0],top:r[1],right:r[2],bottom:r[3]}}},{key:"getAnnotDeviceMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,r=e;(0,D._)(e,ln)&&(r=e.info);var o=r.flag,a=8&o,s=16&o;"text"===r.type&&(a=s=!0);var u=this.getDeviceMatrix(n);if(u.scale(t,t),!a&&!s)return u;var c=new nn.Z,l=r.rect;i&&(l=i);var d,h,f=new Zt(l.left,l.bottom,l.right,l.top);if(a)d=j.dpr,h=-j.dpr;else{var g,v,p,m,y,k;g=v=0;var b=u.transformPoint(g,v);g=b[0],v=b[1],p=1,m=0,p=(b=u.transformPoint(p,m))[0],m=b[1],p-=g,m-=v,y=0,k=1,y=(b=u.transformPoint(y,k))[0],k=b[1],y-=g,k-=v,d=Math.sqrt(p*p+m*m),h=-Math.sqrt(y*y+k*k)}c.a=d,c.b=0,c.c=0,c.d=h,!s&&n>0&&n<4&&c.Rotate(Math.PI*n/2);var w=f.left,_=f.top,P=u.transformPoint(w,_);return w=P[0],_=P[1],c.e=w-f.left*c.a-f.top*c.c,c.f=_-f.left*c.b-f.top*c.d,c}},{key:"getAnnotDeviceRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0,r=this.getAnnotDeviceMatrix(e,t,n,i),o=e;(0,D._)(e,ln)&&(o=e.info);var a=new Zt(o.rect.left,o.rect.bottom,o.rect.right,o.rect.top);i&&(a=i);var s=r.transformRect(a.left,a.top,a.right,a.bottom);return{left:s[0],top:s[1],right:s[2],bottom:s[3]}}},{key:"reverseDevicePoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getDeviceMatrix(n);return i.scale(t,t),i.setReverse(),i.transformPoint(e[0],e[1])}},{key:"reverseDeviceOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getDeviceMatrix(n);return i.e=i.f=0,i.scale(t,t),i.setReverse(),i.transformPoint(e[0],e[1])}},{key:"reverseDeviceRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.getDeviceMatrix(n);i.scale(t,t),i.setReverse();var r=(0,E._)(i.transformRect(e.left,e.top,e.right,e.bottom),4),o=r[0],a=r[1],s=r[2],u=r[3],c=Math.min(o,s),l=Math.max(o,s);return{left:c,top:Math.max(a,u),right:l,bottom:Math.min(a,u)}}},{key:"render",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:["page"],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"view";if(!this.doc.checkPermission(Qt.print||Qt.printHigh))throw new Error("Permission error");if(e*=4/3,-1==r.indexOf("page")&&r.push("page"),"view"!=o&&"print"!=o)throw new Error("Param error: usage should be one of 'view', 'print'. Got '"+o+"' instead.");return this.getPageBitmap(e,t,n,r,o).then((function(a){var s=function(a){return a.rate<100?i.doc.api.continueProgress(a.progressiveId).then(s):a.buffer||a.image?a:i.getPageBitmap(e,t,n,r,o)};return a.rate>=100?a:s(a)}))}},{key:"getPageBitmap",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:["page"],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"view",o=arguments[5]||"",a=arguments[6];return this.doc.api.getPageBitmap(this.getPDFDoc().getId(),this.getId(),e,t,n,i,r,o,!1,a)}},{key:"clearDesignerAssitCache",value:function(){return this.doc.api.clearDesignerAssitCache(this.getPDFDoc().getId(),this.getId())}},{key:"getPageAndHighlightBitmap",value:function(e,t,n,i){return this.doc.api.getPageAndHighlightBitmap(this.getPDFDoc().getId(),this.getId(),e,t,n,i)}},{key:"getAnnotBitmap",value:function(e,t,n,i,r,o,a){var s=this;return!0===r?this.doc.api.getAnnotBitmap(this.getPDFDoc().getId(),this.getId(),e,t,n,i,o):this.getAnnots().then((function(r){if(e.trim().length<1)return null;var a=s.getAnnotObjectNum(e);return 0==a?null:s.doc.api.getAnnotBitmap(s.getPDFDoc().getId(),s.getId(),a,t,n,i,o)}))}},{key:"getPageObjNum",value:function(){return this.info.objectNumber}},{key:"getAnnotObjectNum",value:function(e){var t=this;if(e.trim().length<1)return 0;var n=Object.keys(this.annotIdMap);if(!n.length)return 0;var i=n.find((function(n){return t.annotIdMap[n].getName()==e}));return parseInt(i)}},{key:"getAnnotBitmapByRange",value:function(e,t,n,i){return this.doc.api.getAnnotBitmapByRange(this.getPDFDoc().getId(),this.getId(),e,t,n,i)}},{key:"getAnnotCount",value:function(){return this.annots.length||this.info.annotCount}},{key:"resetWidgetsControl",value:function(){this.annots.forEach((function(e){"widget"==e.getType()&&e.mapFormControl()}))}},{key:"getAnnots",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t&&(this.annots.length=0,this.annotIdMap={},this.annotsPromise=null),this.annotIdMap){var i=Object.keys(this.annotIdMap);if(this.annots.length&&i.length){var r=i.map((function(t){return e.annotIdMap[t]}));return r.sort(By),Promise.resolve(r)}}var o=this.doc.engine;return o?this.annotsPromise=this.annotsPromise||this.doc.api.getAnnots(this.getPDFDoc().getId(),this.getId(),null,t).then((function(t){return e.isDestroyed?[]:t.map((function(t){return o.annotManager.get(t,e)}))})).then((function(t){if(e.isDestroyed)return[];var i=[];e.annotIdMap=t.reduce((function(e,t,n){if(e){var r=t.getId();return r in e||i.push(t),e[r]=t,e}}),e.annotIdMap);var r=t.map((function(t){return t.reviseSummary((function(t){return e.annotIdMap[t]}))}));return Promise.all(r).then((function(){return e.annots?(e.annots.length=0,t.sort(By),t.forEach((function(t){return e.annots.push(t)})),e.info.annotCount=t.length,e.annotsPromise=null,n&&o.eventEmitter.emit(le.annotationLoaded,e,i,t),e.annots):[]}))})):Promise.resolve()}},{key:"setAnnots",value:function(e){e.sort(By),this.annots=e}},{key:"getMarkupAnnots",value:function(){var e=!0===arguments[0];return this.getAnnots().then((function(t){return function(t){var n=function(e){return"popup"===e},i=function(e){return"widget"===e};t=t.filter((function(e){return e.isMarkup()&&!e.isDeleted()&&!n(e.getType())&&!i(e.getType())&&e.getReplies&&(!e.isStateAnnot||!e.isStateAnnot())}));var r=[],o=[];t.forEach((function(e){var t,n,i,a=e.getReplies();(t=r).push.apply(t,(0,I._)(a)),r.forEach((function e(t){var n;if(!t&&t.getReplies){var i=t.getReplies();(n=r).push.apply(n,(0,I._)(i)),i.forEach(e)}})),(n=o).push.apply(n,(0,I._)(e.getReviewStates())),(i=o).push.apply(i,(0,I._)(e.getMarkedStates()))}));var a=t.filter((function(e){return-1===r.indexOf(e)&&-1===o.indexOf(e)}));return e?a.reduce((function(e,t){var n=t.getGroupHeader&&t.getGroupHeader()||t;return-1===e.indexOf(n)&&e.push(n),e}),[]):(a.forEach((function(e){"Replace"===e.getIntent()&&e.groupElements.forEach((function(t){if(t!==e){var n=a.indexOf(t);n>-1&&a.splice(n,1)}}))})),a)}(t)}))}},{key:"filterAnnot",value:function(e,t){for(var n=!e,i=0;i<this.annots.length;i++){var r=this.annots[i];if(n&&r.getType()==t)return r;r.info.objectNumber==e&&(n=!0)}return null}},{key:"filterPrevAnnot",value:function(e,t){for(var n=!e,i=this.annots.length-1;i>=0;i--){var r=this.annots[i];if(n&&r.getType()==t)return r;r.info.objectNumber==e&&(n=!0)}return null}},{key:"getAnnotTree",value:function(){var e=this,t=!0===arguments[0];return this.getMarkupAnnots(t).then((function(t){return e.getAnnots().then((function(e){var n=e.filter((function(e){return!e.isMarkup()&&!e.isDeleted()&&"popup"!==e.info.type}));return t.concat(n).sort((function(t,n){return e.indexOf(t)-e.indexOf(n)}))}))}))}},{key:"getAnnotIdAtDevicePoint",value:function(e,t,n){return this.doc.api.getAnnotIdAtDevicePoint(this.getPDFDoc().getId(),this.getId(),{x:e[0],y:e[1]},t,n)}},{key:"getAnnotObjectNumAtDevicePoint",value:function(e,t,n){return this.doc.api.getAnnotObjectNumAtDevicePoint(this.getPDFDoc().getId(),this.getId(),{x:e[0],y:e[1]},t,n)}},{key:"getCharInfoAtPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!this.doc.checkPermission(Qt.extract||Qt.extractAccess))throw new Error("Permission error");return this.doc.api.getCharInfoAtPoint(this.getPDFDoc().getId(),this.getId(),{x:e[0],y:e[1]},t)}},{key:"removeAnnot",value:function(e){return this.removeAnnotByObjectNumber(e.getId())}},{key:"removeAnnotById",value:function(e){var t=this;return this.getAnnots().then((function(n){var i=n.find((function(t){return e&&e===t.getUniqueID()}));return i&&i.getObjectNumber?t.removeAnnotByObjectNumber(i.getObjectNumber()):[]}))}},{key:"removeAnnotByObjectNumber",value:function(e){var t=this;return this.queuedTaskExecutor.exec((function(){return t._removeAnnotByObjectNumber(e)}))}},{key:"_removeAnnotByObjectNumber",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.annotForm))throw new Error("Permission error");return this.getAnnots().then((function(n){return n.filter((function(e){return e.getType()!==Hi.widget})).map((function(e){return e.getId()})).length?t.doc.api.removeAnnot(t.getPDFDoc().getId(),t.getId(),e):[]})).then((function(e){return t.clearRelatives(e),t.clearAnnotIds(e)})).then((function(e){var n=0;e.forEach((function(e){e.getIndex()<n&&(n=e.getIndex())}));var i=[];return t.annots.forEach((function(e){return e.getIndex()>n&&i.push(e._update())})),Promise.all(i).then((function(t){return e}))})).then((function(e){return t.doc.engine.eventEmitter.emit(le.annotationRemoved,e,t),e}))}},{key:"removeAllAnnot",value:function(){var e,t=this;if(!this.doc.checkPermission(Qt.annotForm))throw new Error("Permission error");return this.getAnnots().then((function(n){var i=n.filter((function(e){return e.getType()!==Hi.widget}));return(e=i.map((function(e){return e.getId()}))).length?t.doc.api.removePageAllAnnot(t.getPDFDoc().getId(),t.getId()):[]})).then((function(){return t.clearRelatives(e),t.clearAnnotIds(e)})).then((function(e){return t.doc.engine.eventEmitter.emit(le.annotationRemoved,e,t),e}))}},{key:"getThumb",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,j.assertThat)((0,j.isValidRotationAngle)(e),"Incorrect rotation degree: ".concat(e,", it should be 0, 90, 180, or 270"));var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.getThumb(n,i,e,t)}},{key:"getMediaBoxBitmap",value:function(e,t){var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.getMediaBoxBitmap(n,i,e,t)}},{key:"clearRelatives",value:function(e){if(Array.isArray(e)&&e){var t=e.slice(0);this.getAnnots().then((function(e){e.some((function(e){return!(!(0,D._)(e,Am)||0!=(t=e.removeRepliesByIdLocaly(t)).length)}))}))}}},{key:"clearAnnotIds",value:function(e){for(var t=this,n=function(n){var a=e[n];i[n]=r[a],i[n]&&(i[n].info.isDeleted=!0,delete r[a],o.annotCount--),t.annots.forEach((function(e){e.getId()==a&&(e.info.isDeleted=!0)}))},i=[],r=this.annotIdMap,o=this.info,a=e.length;a--;)n(a);for(var s=i.length;s--;)i[s]||i.splice(s,1);return this.annots=this.annots.filter((function(t){return-1===e.map((function(e){return String(e)})).indexOf(String(t.getId()))})),i}},{key:"addReplyAnnot",value:function(e){if(!this.doc.checkPermission(Qt.annotForm))throw new Error("Permission error");return this.addAddonAnnot(e)}},{key:"addAddonAnnot",value:function(e){var t=this,n=e.getId();return this.info.annotCount++,this.annots.push(e),this.annotIdMap[n]=e,e.reviseSummary((function(e){return t.annotIdMap[e]}))}},{key:"removeAddonAnnotById",value:function(e){if(this.annotIdMap[e]){this.info.annotCount-=1;for(var t=this.annots,n=t.length;n--;){e===t[n].objectNumber&&t.splice(n,1)}return delete this.annotIdMap[e]}return!1}},{key:"addAnnot",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.annotForm))throw new Error("Permission error");"number"==typeof(e=Ny(e,this.engine.getUserCommentConfig())).page&&(e=function(e){var t,n={type:e.type,opacity:e.opacity,name:e.name,contents:e.contents,subject:e.subject,title:e.title,icon:e.icon,intent:e.intent||e.IT,DA:e.defaultappearance,alignment:e.justification,enableCaption:"yes"==e.caption,rotation:e.rotation},i=e.fontColor;i&&(n.fontColor=parseInt(i.replace("#",""),16)),(t=e.color)&&(n.color=(0,j.colorConvertor)(t,"int"));var r=e["interior-color"]||e.interiorColor;r&&(n.styleFillColor=n.fillColor=parseInt(r.replace("#",""),16));var o=e.flags||"print",a=o.split(",");for(var s in o=0,Pe)-1!=a.indexOf(Pe[s])&&(o|=1<<parseInt(s));n.flag=o;var u=(e.rect||"").split(",");u.length&&(n.rect={left:+u[0],top:+u[3],right:+u[2],bottom:+u[1]});var c=(e.fringe||"").split(",");4===c.length&&(n.innerRect={left:n.rect.left+ +c[0],top:n.rect.top-+c[3],right:n.rect.right-+c[2],bottom:n.rect.bottom+ +c[1]});var l=e.coords;if(l){l=l.split(","),n.coords=[];for(var d=0,h=l.length;d<h;d+=8){var f=Math.min(+l[d],+l[d+2],+l[d+4],+l[d+6]),g=Math.max(+l[d],+l[d+2],+l[d+4],+l[d+6]),v=Math.max(+l[d+1],+l[d+3],+l[d+5],+l[d+7]),p=Math.min(+l[d+1],+l[d+3],+l[d+5],+l[d+7]);n.coords.push({left:f,right:g,top:v,bottom:p})}}var m=e.callout;if(m){m=m.split(","),n.calloutLinePoints=[];for(var y=0,k=m.length;y<k;y+=2)n.calloutLinePoints.push({x:+m[y],y:+m[y+1]})}var b=e.head;b&&(n.startStyle=Xt(b));var w=e.tail;w&&(n.endStyle=Xt(w));var _=e.vertices;if(_){n.vertexes=[],_=_.split(";");for(var P=0;P<_.length;P++){var A=_[P].split(",");n.vertexes.push({x:+A[0],y:+A[1]})}}var S=e.inklist;if(S){n.inkList=[],S=JSON.parse("["+S.replace(/;/g,",")+"]");for(var x=0;x<S.length;x++)for(var C=S[x],D=0;D<C.length;D+=2){var E=C[D],I=0==D?1:2;n.inkList.push({x:E,y:C[D+1],type:I})}}var R=Qe[e.style||"solid"];n.borderInfo={style:R,width:e.width||1};var T=e.dashes;T&&(n.borderInfo.dashes=JSON.parse("["+T+"]"));var F=e.intensity;F&&(n.borderInfo.cloudIntensity=F);var M=e.start;M&&(M=M.split(","),n.startPoint={x:+M[0],y:+M[1]});var O=e.end;return O&&(O=O.split(","),n.endPoint={x:+O[0],y:+O[1]}),n}(e));var n=arguments,i=this.getPDFDoc().getId(),r=this.getId(),o=this.doc.engine.getDefaultAnnotConfig()(e.type,e.intent);return e=(0,j.extendOptions)({},o,e),this.doc.api.addAnnot(i,r,e).then((function(e){return t._doAfterAddAnnots(e,"boolean"!=typeof(i=n[n.length-1])||i);var i}),(function(e){var t=(0,j.createDeferred)();return t.reject(e),t.promise}))}},{key:"markRedactAnnot",value:function(e){var t,n=this;if(arguments&&arguments[1]&&(t=arguments[1]),!this.doc.checkPermission(Qt.annotForm))throw new Error("Permission error");var i=this.getPDFDoc().getId(),r=this.getId();return this.doc.api.markRedactAnnot(i,r,e,t).then((function(e){return n._doAfterAddAnnots(e)}))}},{key:"addAnnotGroup",value:function(e,t){var n=this;if(!this.doc.checkPermission(Qt.annotForm))throw new Error("Permission error");e.forEach((function(e){if(!e.type)throw new Error("Annot type error")}));var i=this.getPDFDoc().getId(),r=this.getId();return e=e.map((function(e){var t=n.doc.engine.getDefaultAnnotConfig()(e.type,e.intent);return(0,j.extendOptions)({},t,e)})),this.doc.api.addAnnotGroup(i,r,e,t).then((function(e){return n._doAfterAddAnnots(e)}))}},{key:"_doAfterAddAnnots",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e.map((function(e){return e&&t.doc.engine.annotManager.get(e,t)}));i.reduce((function(e,t){return e[t.getId()]=t,e}),this.annotIdMap);var r=i.map((function(e){return e.reviseSummary((function(e){return t.annotIdMap[e]}))}));return this.annots=this.annots.concat(i),this.info.annotCount=this.annots.length,Promise.all(r).then((function(){return n&&t.doc.engine.eventEmitter.emit(le.annotationAdd,i,t),i}))}},{key:"getUnloadedAnnots",value:function(){var e=this;return this.queuedTaskExecutor.exec((function(){return e._getUnloadedAnnots()}))}},{key:"_getUnloadedAnnots",value:function(){var e=this,t=this.getPDFDoc().getId(),n=this.getId();return this.doc.api.getPageAnnotIDList(t,n).then((function(i){var r=i.filter((function(t){return!e.annotIdMap[t]}));return(r.length?e.doc.api.getAnnots(t,n,r):Promise.resolve([])).then((function(t){return t.map((function(t){return t?e.doc.engine.annotManager.get(t,e):null})).filter((function(e){return!!e}))})).then((function(t){var n=t.reduce((function(e,t){return e[t.getId()]=t,e}),{});return e.annotIdMap=i.reduce((function(t,i){var r=e.annotIdMap[i]||n[i];return r&&(t[i]=r),t}),{}),Promise.all(Object.keys(e.annotIdMap).map((function(t){var n=e.annotIdMap[t];return n&&n._update(!0)}))).then((function(e){return t}))})).then((function(t){e.setAnnots(e.annots.concat(t)),e.info.annotCount=e.annots.length;var n=e.annots.map((function(t){return t.reviseSummary((function(t){return e.annotIdMap[t]}))}));return Promise.all(n).then((function(){e.doc.engine.eventEmitter.emit(le.annotationLoaded,e,t,e.annots)})),t})).catch((function(t){if(!e.doc||e.doc.isDestroyed)return[];throw t}))}))}},{key:"getTextRectsAtRect",value:function(e){return this.doc.api.getTextRectsAtRect(this.getPDFDoc().getId(),this.getId(),e)}},{key:"getTextRects",value:function(e){return this.doc.api.getTextRects({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e)}},{key:"getTextContinuousRectsAtRect",value:function(e){return this.doc.api.getTextContinuousRectsAtRect(this.getPDFDoc().getId(),this.getId(),e)}},{key:"getTextContinuousRectsAtPoints",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return this.doc.api.getTextContinuousRectsAtPoints(this.getPDFDoc().getId(),this.getId(),e,t,n,i,r,arguments[5])}},{key:"getTextByIndex",value:function(e,t){return this.doc.api.getTextByIndex({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getTextIndexAtPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return this.doc.api.getTextIndexAtPoint({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getTextRectsByIndexes",value:function(e,t){return this.doc.api.getTextRectsByIndexes({path:"jr/doc/page"},this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getDoubleClickTextRectAtPoint",value:function(e,t){return this.doc.api.getDoubleClickTextRectAtPoint(this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getTextContinuousCharsAtRect",value:function(e,t){return this.doc.api.getTextContinuousCharsAtRect(this.getPDFDoc().getId(),this.getId(),e,t)}},{key:"getTextSearch",value:function(e,t){var n=this;return this.isVirtual()?Promise.resolve(new Ey):this.doc.api.getTextSearch(this.getPDFDoc().getId(),this.getId(),e,t).then((function(e){return new Sy(e,n)}))}},{key:"destroy",value:function(){return this.isDestroyed=!0,this.annots.forEach((function(e){return e.destroy()})),this.graphicObjects.forEach((function(e){return e.destroy()})),this.graphicObjects=null,this.annots=null,this.annotIdMap=null,this.info=null,this.doc=null,this.api=null,Promise.resolve()}},{key:"normalize",value:function(){return this.doc.api.normalizePage(this.getPDFDoc().getId(),this.getId())}},{key:"getAnnotsByIdArray",value:function(e){return this.getAnnots().then((function(t){for(var n=[],i=0,r=e.length;i<r;i++)for(var o=0;o<t.length;o++)if(e[i]===t[o].getUniqueID()){n.push(t[o]);break}return n}))}},{key:"getAnnotsByObjectNumArray",value:function(e){var t=this;return this.getAnnots().then((function(){for(var n=t.annotIdMap,i=[],r=0,o=e.length;r<o;r++){var a;(a=n[e[r]])&&i.push(a)}return i}))}},{key:"getAnnotsSync",value:function(e){for(var t=this.annotIdMap,n=[],i=0,r=e.length;i<r;i++){var o;(o=t[e[i]])&&n.push(o)}return n}},{key:"flatten",value:function(e){var t=this;if((e|3-e)<0)throw new Error("Param option error.");var n=this.doc;if(!(n.isXFA()||n.checkPermission(Qt.annotForm)&&n.checkPermission(Qt.modify)&&n.checkPermission(Qt.assemble|Qt.modify)))throw new Error("Permission error");return this.doc.api.flatten(this.getPDFDoc().getId(),this.getId(),e).then((function(e){var i;return t.annotIdMap={},t.annots.length=0,t.info.annotCount=0,(i=t.doc.getPDFForm())&&i.reduceControl(t.getIndex(),e),t.doc.engine.eventEmitter.emit(le.flattened,t.getIndex(),t),t.doc.engine.eventEmitter.emit(le.docModified,n),!0}))}},{key:"addImage",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this.doc.checkPermission(8)){var r=(4294967292&this.doc.info.oriPerm)>>>0;if(!!!(256&r||32&r||8&r))throw new Error("Permission error")}var o={x:t.left,y:t.bottom},a=t.right-t.left,s=t.top-t.bottom;return this.doc.api.addPageImage(this.getPDFDoc().getId(),this.getId(),e,o,a,s,i).then((function(e){if(e){var t=n.doc.engine.graphicsObjectManager.get(e,n);return t&&n.graphicObjects.push(t),n.doc.engine.eventEmitter.emit(le.imageAdded,n),n.doc.engine.eventEmitter.emit(le.graphicsUpdated,n,t),t}return e}))}},{key:"addWatermark",value:function(e){var t=this,n=e.type,i=e.text;if("text"===n&&sn(i))return Promise.resolve(null);if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var r=Fy(e,this.getIndex(),this.getIndex(),this.getIndex(),this.doc.getPageCount());return this.doc.getPageFormat("watermark").then((function(e){return t.doc.addPageFormat("watermark",r).then((function(e){if(e>0){var n={};return r.isKeep&&(n=t.annots[t.annots.length-1].info,t.doc.engine.eventEmitter.emit(le.annotationAdd,t.annots,t)),t.doc.engine.eventEmitter.emit(le.watermarkAdded,t),n}return e}))}))}},{key:"getGraphicsObjectsInRect",value:function(e,t,n){var i=this;if(n<0||n>3)throw new Error("Type error, only 0~3 are available. current is: "+n);return this.doc.api.getGraphicsObjectAtPoint(this.getPDFDoc().getId(),this.getId(),null,t,n,e).then((function(e){return e.map((function(e){var t=i.doc.engine.graphicsObjectManager.get(e,i);return t&&i.graphicObjects.push(t),t}))}))}},{key:"getTextLineUnderPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=this;return(0,_._)((function(){var i,r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:return[4,n.getLineTextObjectsUnderPoint(e,t)];case 1:return(i=a.sent())&&i.length?(r=i.reduce((function(e,t){var n=t.getRect(),i=n.top,r=n.bottom;return e.top=Math.max(e.top,i),e.bottom=Math.min(e.bottom,r),e}),Object.assign({},i[0].getRect(),{left:0,right:n.getWidth()})),o=i.map((function(e){return e.getText()||""})).join(" "),[2,{text:o,rect:r,textGraphicsObjects:i}]):[2,{textGraphicsObjects:i}]}}))}))()}},{key:"getLineTextObjectsUnderPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=this;return(0,_._)((function(){var i,r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:return[4,n.getGraphicsObjectAtPoint(e,t,Mt.Text)];case 1:return(i=a.sent())?(r=i.getRect(),o={left:0,right:n.getWidth(),top:r.top,bottom:r.bottom},[4,n.getGraphicsObjectsByRect({rect:o,tolerance:0,type:Mt.Text,isInRect:!1})]):[2,Promise.resolve([])];case 2:return[2,a.sent()]}}))}))()}},{key:"getGraphicsObjectsByRect",value:function(e){var t=this;return(0,_._)((function(){var n,i,r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:if(!(n=e.rect))throw new Error("[PDFPage.getGraphicsObjectsByRect] Missing required parameter: options.rect");return i=isFinite(e.tolerance)?e.tolerance:0,r=void 0===e.type?Mt.ALL:e.type,o=!1!==e.isInRect,[4,t.doc.api.getGraphicsObjectsByRect(t.getPDFDoc().getId(),t.getId(),n,i,r,o)];case 1:return[2,a.sent().map((function(e){return t.doc.engine.graphicsObjectManager.get(e,t)}))]}}))}))()}},{key:"getGraphicsObjectAtPoint",value:function(e,t,n){var i=this;return this.doc.api.getGraphicsObjectAtPoint(this.getPDFDoc().getId(),this.getId(),e,t,n).then((function(e){var t=i.doc.engine.graphicsObjectManager.get(e,i);return t&&i.graphicObjects.push(t),t}))}},{key:"getGraphicsObjectByIndex",value:function(e){var t=this;return e<0?Promise.resolve(null):this.doc.api.getGraphicsObjectByIndex(this.getPDFDoc().getId(),this.getId(),e).then((function(e){var n=t.doc.engine.graphicsObjectManager.get(e,t);return n&&t.graphicObjects.push(n),n}))}},{key:"getGraphicsObjectsCount",value:function(){return this.doc.api.getGraphicsObjectsCount(this.getPDFDoc().getId(),this.getId())}},{key:"setGraphicsObjectMatrix",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");return this.doc.api.setGraphicsObjectRect(this.getPDFDoc().getId(),e).then((function(e){t.doc.engine.eventEmitter.emit(le.graphicsUpdated,t)}))}},{key:"addGraphicsObject",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");return this.doc.api.addGraphicsObject(this.getPDFDoc().getId(),this.getId(),e).then((function(e){var n=t.doc.engine.graphicsObjectManager.get(e,t);return n&&t.graphicObjects.push(n),t.doc.engine.eventEmitter.emit(le.graphicsUpdated,t,n),n}))}},{key:"removeGraphicsObject",value:function(e){return this.removeGraphicsObjectEx(e,!0)}},{key:"removeGraphicsObjectEx",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var i=null;return this.graphicObjects=this.graphicObjects.filter((function(e){return e.getId()!=e.getId()||(i=e,!1)})),this.doc.api.removeGraphicsObject(this.getPDFDoc().getId(),this.getId(),e.getId(),n).then((function(e){n&&t.doc.engine.eventEmitter.emit(le.graphicsUpdated,t,i)}))}},{key:"pasteAnnot",value:function(e,t){var n=this;if(!this.doc.checkPermission(Qt.annotForm))throw new Error("Permission error");if([Hi.popup,Hi.widget,Hi.strikeOut,Hi.highlight,Hi.squiggly,Hi.underline,Hi.caret].includes(e.getType()))throw new Error("Not support strikeout, highlight, squiggly, underline, caret, popup and widget annotations.");var i=this.getPDFDoc().getId(),r=this.getId();return this.doc.api.paste(i,r,e.getPage().getId(),"annot",e.getId(),t).then((function(e){return n._doAfterAddAnnots(e)}),(function(e){return Promise.reject(e)}))}},{key:"pasteGraphicObject",value:function(e,t,n){var i=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var r=this.getPDFDoc().getId(),o=this.getId();return this.doc.api.paste(r,o,this.doc.pageCache[t].getId(),"graphicObject",e,n).then((function(e){var t=i.doc.engine.graphicsObjectManager.get(e,i);return i.doc.engine.eventEmitter.emit(le.graphicsUpdated,i,t),t}),(function(e){var t=(0,j.createDeferred)();return t.reject(e),t.promise}))}},{key:"getMediaWidth",value:function(){return this.info.mediaWidth}},{key:"getMediaHeight",value:function(){return this.info.mediaHeight}},{key:"isCropped",value:function(){return this.info.isCropped}},{key:"isVirtual",value:function(){return!!this.info.isVirtual}},{key:"calcPageContentBBox",value:function(e){return this.doc.api.calcPageContentBBox(this.getPDFDoc().getId(),this.getIndex(),e)}},{key:"getPageBox",value:function(e){return this.doc.api.getPageBox(this.getPDFDoc().getId(),this.getIndex(),e)}},{key:"getAllBoxes",value:function(){return this.doc.api.getAllBoxes(this.getPDFDoc().getId(),this.getIndex())}},{key:"setPageBox",value:function(e,t){return this.doc.api.setPageBox(this.getPDFDoc().getId(),this.getIndex(),e,t)}},{key:"setPageSize",value:function(e,t){var n=this;return(0,j.assertThat)("number"==typeof e,"width must be a number, but got "+(void 0===e?"undefined":(0,R._)(e))),(0,j.assertThat)("number"==typeof t,"height must be a number, but got "+(void 0===t?"undefined":(0,R._)(t))),(0,j.assertThat)((0,j.isValidNumber)(e)&&e>0,"width must be a valid positive number, but got "+e),(0,j.assertThat)((0,j.isValidNumber)(t)&&t>0,"height must be a valid positive number, but got "+t),this.doc.api.setPageSize(this.getPDFDoc().getId(),this.getIndex(),e,t).then((function(){n.info.width=e,n.info.height=t,n._updateInfo(n.info),n.doc.engine.eventEmitter.emit(le.pagesBoxChange,[n])}))}},{key:"getAnnotIdArrayByOrder",value:function(){return this.doc.api.getAnnotIdArrayByOrder(this.getPDFDoc().getId(),this.getId())}},{key:"getDict",value:function(){var e=this;return this.doc.api.getPageDictionary(this.getPDFDoc().getId(),this.getId()).then((function(t){return new Cy(e.doc,t.id,e.doc.engine)}))}},{key:"createWebLinks",value:function(e){var t=this,n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.createWebLinks(n,i,e).then((function(e){var n=t.doc;return n.engine.eventEmitter.emit(le.docModified,n),e}))}},{key:"removeWebLinks",value:function(e){var t=this,n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.removeWebLinks(n,i,e).then((function(e){var n=t.doc;return n.engine.eventEmitter.emit(le.docModified,n),e}))}},{key:"deleteDestination",value:function(e){var t=this.getPDFDoc().getId(),n=this.getId();return this.doc.api.deleteDestination(t,n,e)}},{key:"renameDestination",value:function(e,t){var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.renameDestination(n,i,e,t)}},{key:"createDestination",value:function(e,t){var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.createDestination(n,i,e,t)}},{key:"resetDestination",value:function(e,t){var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.resetDestination(n,i,e,t)}},{key:"addAnnotObjects",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.doc.api.addAnnotObjects(this.doc.getId(),this.getId(),e).then((function(e){return e=e.map((function(e){return e?t.doc.engine.annotManager.get(e,t):null})).filter((function(e){return!!e})),e.forEach((function(e){t.annotIdMap[e.getId()]=e})),e})).then((function(e){t.annots=t.annots.concat(e);var i=t.annots.map((function(e){return e.reviseSummary((function(e){return t.annotIdMap[e]}))}));return Promise.all(i).then((function(){return n&&t.doc.engine.eventEmitter.emit(le.annotationAdded,e,t),e}))}))}},{key:"getSuggestedFormDesignerRect",value:function(e){return this.doc.api.getSuggestedFormDesignerRect(this.getPDFDoc().getId(),this.getId(),e)}},{key:"getSnappedPoint",value:function(e,t){var n=this.getPDFDoc().getId(),i=this.getId();return this.doc.api.getSnappedPoint(n,i,e,t)}},{key:"getTextRectCount",value:function(){var e=this.getPDFDoc().getId(),t=this.getId();return this.doc.api.getPageTextRectCount(e,t)}},{key:"getTextByRectIndex",value:function(e){var t=this.getPDFDoc().getId(),n=this.getId();return this.doc.api.getPageTextByRectIndex(t,n,e)}},{key:"cloneGraphicObject",value:function(e,t){return this.doc.api.cloneGraphicObject(this.getPDFDoc().getId(),this.getId(),this.doc.pageCache[e].getId(),t)}},{key:"addReviewStateAnnotObject",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.doc.api.addAnnotObjects(this.doc.getId(),this.getId(),t).then((function(t){var i=t[0];e.info.reviewStatesSummary.push({objectNumber:i.objectNumber,id:i.objectNumber,index:i.index});var r=n.doc.engine.annotManager.get(i,n);return n.addAddonAnnot(r)})).then((function(t){return e.reviewStates.push(t),i&&n.doc.engine.eventEmitter.emit(le.annotationReviewStateAnnotAdd,t,e),i&&n.doc.engine.eventEmitter.emit(le.annotationUpdated,[e],n,en.reviewStateUpdated),t}))}},{key:"addMarkedStateAnnotObject",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments[3],o=e.getGroupHeader()||e;return this.doc.api.addAnnotObjects(this.doc.getId(),this.getId(),t).then((function(e){var t=e[0];if(o.info.markedStatesSummary.length){var i=n.annotIdMap[t.objectNumber];return i.info=t,i}o.info.markedStatesSummary.push({objectNumber:t.objectNumber,id:t.objectNumber,index:t.index});var r=n.doc.engine.annotManager.get(t,n);return n.addAddonAnnot(r)})).then((function(t){return o.markedStates.push(t),i&&n.doc.engine.eventEmitter.emit(le.annotationMarkedStateAnnotAdd,t,o,r),i&&n.doc.engine.eventEmitter.emit(le.annotationUpdated,[e],n,en.reviewStateUpdated),t}))}},{key:"getViewportRect",value:function(){return this.doc.api.getViewportRect(this.doc.getId(),this.getId())}},{key:"getMeasureScaleRatio",value:function(){return this.doc.api.getMeasureScaleRatio(this.doc.getId(),this.getId()).then((function(e){var t=e.scale,n=e.ratio,i=e.unit,r=n&&n.trim()?n.split(" = ").map((function(e){var t=e.split(" ");return{value:t[0],unit:t[1]}})):[];return{scale:t,ratio:n,ratioMap:r,unitName:i}}))}},{key:"setMeasureScaleRatio",value:function(e,t,n,i){var r=this;if(!this.doc.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");if(n){var o=n.split(" = ").map((function(e){var t=e.split(" ");return{value:t[0],unit:t[1]}}));if(2!==o.length||!o.every((function(e){return/^[+-]?(0|([1-9]\d*))(\.\d+)?$/.test(e.value)}))||!o.every((function(e){return ki[e.unit]})))throw new Error("Ratio format error. Please refer to: 1 inch = 1 ft")}return this.doc.api.setMeasureScaleRatio(this.doc.getId(),this.getId(),e,{unit:t,ratio:n,scale:i}).then((function(e){return r.getAnnotsByObjectNumArray(e).then((function(e){return r.doc.engine.eventEmitter.emit(le.pageMeasureScaleRatioChanged,r,e),e}))}))}},{key:"getTransition",value:function(){return this.doc.api.getPageTransition(this.doc.getId(),this.getId())}},{key:"isScannedPage",value:function(){return this.doc.api.isScannedPage(this.doc.getId(),this.getId())}},{key:"getPureTexts",value:function(e){return this.doc.api.getPureTexts(this.doc.getId(),this.getId(),e)}},{key:"getTexts",value:function(e){var t=e.settings,n=e.minWidth,i=e.eol;return this.doc.api.getPageTexts(this.doc.getId(),this.getId(),t,n,i)}},{key:"handleGroupMarkup",value:function(e,t){var n=this,i=this.doc,r=this.getId();if(!i.checkPermission(Qt.modify)&&!i.checkPermission(Qt.annotForm))throw new Error("Permission error");return i.api.handleGroupMarkup(i.getId(),r,e,t).then((function(t){var r=e.map((function(e){var i=n.annotIdMap[e];return i.info=t[e],i.reviseSummary((function(e){return n.annotIdMap[e]}))}));Promise.all(r).then((function(e){n.doc.engine.eventEmitter.emit(le.docModified,i),n.doc.engine.eventEmitter.emit(le.annotationUpdated,e,n)}))}))}},{key:"getTextInRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.doc;if(!n.checkPermission(Qt.extract))throw new Error("Permission error");if(n.isStaticXFA())throw new Error("File type error, current is Static documents");return this.doc.api.getTextInRect(this.doc.getId(),this.getId(),e,t)}},{key:"scaleClipRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.transformClipRect(e,t,0,0)}},{key:"translateClipRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.transformClipRect(1,1,e,t)}},{key:"transformClipRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.doc.api.transformPage(this.doc.getId(),this.getId(),{scaleX:e,scaleY:t,translateX:n,translateY:i})}},{key:"getAnnotRects",value:function(){return this.annots.length?Promise.resolve(this.annots.map((function(e){return e.info}))):this.doc.api.getAnnotRects(this.doc.getId(),this.getId())}},{key:"getBatchProcessor",value:function(){return this.batchProcessor}},{key:"clearRenderCache",value:function(){return this.doc.api.clearPageRenderCache(this.doc.getId(),this.getId())}},{key:"clearCacheObjects",value:function(){return this.doc.engine.eventEmitter.emit("before-clear-pageCache",this.getIndex()),this.doc.api.clearCacheObejcts({path:"jr/doc/page"},this.doc.getId(),this.getId())}},{key:"getWordCount",value:function(){return this.doc.api.getWordCount({path:"jr/doc/page"},this.doc.getId(),this.getId())}},{key:"changeAnnotOrder",value:function(e,t){var n=this;if(!this.doc.checkPermission(Qt.annotForm))throw new Error("Permission error");if([Hi.popup,Hi.watermark].includes(t.getType()))throw new Error("Not support Popup and Watemark.");return this.doc.api.changeAnnotOrder({path:"jr/doc/page"},this.doc.getId(),this.getId(),t.getId(),e).then((function(i){var r=[];return n.annots.forEach((function(e){return r.push(e._update())})),Promise.all(r).then((function(i){n.annots.sort(By),n.doc.engine.eventEmitter.emit(le.annotationOrderChanged,[t],n,e)}))}))}},{key:"moveAnnotOrder",value:function(e,t){var n=this;if(!this.doc.checkPermission(Qt.annotForm))throw new Error("Permission error");return this.doc.api.moveAnnotOrder({path:"jr/doc/page"},this.doc.getId(),this.getId(),e.getId(),t).then((function(t){var i=[];return n.annots.forEach((function(e){return i.push(e._update())})),Promise.all(i).then((function(t){n.annots.sort(By),n.doc.engine.eventEmitter.emit(le.annotationOrderChanged,[e],n,0===e.getIndex()?Lt.first:Lt.last)}))}))}}]),e}();function By(e,t){return e.getIndex()>t.getIndex()?1:-1}const jy=Vy;var Uy=function(){function e(t,n,i){(0,P._)(this,e),this.doc=t,this.form=n,this.info=i,this.controls=[],this.updateControls(this.info.controls)}return(0,A._)(e,[{key:"destroy",value:function(){this.destroyed=!0,this.doc=null,this.form=null,this.controls.forEach((function(e){return e.destroy()})),this.controls=[],this.info=null}},{key:"getWidget",value:function(e){return this.controls[e].getWidget()}},{key:"getLoadedWidgets",value:function(){return this.controls.map((function(e){return e.getWidget()})).filter((function(e){return e}))}},{key:"getIndex",value:function(){return this.info.index}},{key:"updateWidgetsUI",value:function(e,t,n,i,r){var o=this,a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(!this.doc)return Promise.resolve();-1!==["value","comb","multiline","choiceMultiSelect","comboEdit","maxLength","hidden","password","readonly","required","noScroll","clearItems","deleteItems","setItems","icon","insertItemAt"].indexOf(n)&&this.doc.engine.eventEmitter.emit(le.formValueChanged);var s=[];return this.controls.forEach((function(e){var t,u=e.getWidget();u?(t=r?o.form.addTask((function(e){return r(u).then((function(e){return u.updateUI({type:n,value:i})}))}),a):o.form.addTask((function(e){return u.updateUI({type:n,value:i})}),a),s.push(t)):s.push(o.form.addTask((function(t){return e.updateProperty(n,i).then((function(t){return e.info&&e.info.objectNumber>0&&e.getWidgetAnnot().then((function(e){if(e&&r)return r(e)}))}))}),a))})),Promise.all(s).then((function(e){return!0}))}},{key:"getControlById",value:function(e){for(var t=0;t<this.controls.length;t++){var n=this.controls[t];if(n.info.objectNumber==e)return n}}},{key:"getPDFForm",value:function(){return this.form}},{key:"getName",value:function(){return this.info.name}},{key:"getAlternateName",value:function(){return this.info.alternateName}},{key:"setAlternateName",value:function(e){var t=this;this.form.checkFillPerm(),this.info.alternateName=e,this.update("alternateName",e).then((function(e){t.triggerUpdateEvent(en.formFieldAlternateName)}))}},{key:"getMappingName",value:function(){return this.info.mappingName}},{key:"setMappingName",value:function(e){var t=this;this.form.checkFillPerm(),this.getType()!==gn.Sign&&(this.info.mappingName=e,this.update("mappingName",e).then((function(e){t.triggerUpdateEvent(en.formFieldMappingName)})))}},{key:"getType",value:function(){return this.info.type}},{key:"getFlags",value:function(){return this.info.flag}},{key:"setFlags",value:function(e){var t=this,n=function(e){var n=void 0,o=void 0,c=function(){return Promise.resolve()};u&&a[e]==s?(n="value",o=t.getValue()):(n=b[a[e]],o=r[a[e]]),"hidden"==n&&(c=function(e){var t=e.info.flag;return o?(t&=-2,t&=-33,t|=6):(t&=-2,t&=-3,t&=-33,t|=4),e.setFlagValue(t)}),t.controls.forEach((function(e){var t,r=e.getWidget();r?(t=c(r).then((function(e){return r.updateUI({type:n,value:o})})),k.push(t)):k.push(i.form.addTask((function(t){return e.updateProperty(n,o)})))}))},i=this;this.form.checkFillPerm();var r={};Object.entries(vn).forEach((function(t){"number"==typeof t[1]&&(e&vn[t[0]])>0?r[t[0]]=!0:r[t[0]]=!1}));var o=Promise.resolve(),a=Object.keys(r),s="ButtonRadiosInUnison",u=this.getType()==gn.RadioButton,c=this.info.flag,l=!0,d=!1,h=void 0;try{for(var f,g=Object.entries(r)[Symbol.iterator]();!(l=(f=g.next()).done);l=!0){var v=(0,E._)(f.value,2),p=v[0],m=v[1];"Hidden"!==p&&(m?c|=vn[p]:c&=~vn[p])}}catch(e){d=!0,h=e}finally{try{l||null==g.return||g.return()}finally{if(d)throw h}}this.info.flag=c;var y=(0,I._)(Object.keys(vn)).filter((function(e){return["NoExport","CommitOnSelChange"].every((function(t){return t!==e}))}));(0,I._)(a).filter((function(e){return-1!==y.indexOf(e)})).length&&this.doc.engine.eventEmitter.emit(le.formValueChanged);for(var k=[],b={ReadOnly:"readonly",Required:"required",Hidden:"hidden",TextMultiline:"multiline",TextPassword:"password",TextDoNotSpellCheck:"noSpellCheck",TextDoNotScroll:"noScroll",TextComb:"comb",ComboEdit:"comboEdit",ChoiceMultiSelect:"choiceMultiSelect"},w=0;w<a.length;w++)n(w);o.then((function(e){var t=[];return i.controls.forEach((function(e){e.getWidget()&&t.push(i.update("flag",i.info.flag))})),Promise.all(t)})).then((function(e){return i.triggerUpdateEvent(en.flagsUpdated),Promise.all(k).then((function(e){return!0}))}))}},{key:"setComb",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|vn.TextComb:this.info.flag&~vn.TextComb,this.updateWidgetsUI(this.form,this.info.name,"comb",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(en.flagsUpdated)}))}},{key:"setMultiline",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|vn.TextMultiline:this.info.flag&~vn.TextMultiline,this.updateWidgetsUI(this.form,this.info.name,"multiline",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(en.flagsUpdated)}))}},{key:"setChoiceMultiSelect",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|vn.ChoiceMultiSelect:this.info.flag&~vn.ChoiceMultiSelect,this.updateWidgetsUI(this.form,this.info.name,"choiceMultiSelect",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(en.flagsUpdated)}))}},{key:"setComboEdit",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|vn.ComboEdit:this.info.flag&~vn.ComboEdit,this.updateWidgetsUI(this.form,this.info.name,"comboEdit",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(en.flagsUpdated)}))}},{key:"update",value:function(e,t){var n=this;return this.form.addTask((function(i){return n.doc.api.updateField(n.doc.id,n.info.name,e,t)}))}},{key:"getValue",value:function(){return this.info&&String(this.info.value).length>0?this.info.value:""}},{key:"getValueIndex",value:function(){if(!this.info)return-1;for(var e=this.info.options,t=0;t<e.length;t++)if(e[t].value==this.info.value)return t;return-1}},{key:"getDefaultValue",value:function(){return this.info?this.info.defaultValue:""}},{key:"setDefaultValue",value:function(e){var t=this;this.form.checkFillPerm(),this.update("defaultValue",e);var n=this.getType();return(n==gn.RadioButton||n==gn.CheckBox)&&this.info.controls.forEach((function(n){var i=t.getControlById(n.objectNumber),r=i.widget&&i.widget.getOnAS();n.isDefaultChecked=r===e,n.isDefaultChecked=r===e})),this.info.defaultValue=e}},{key:"getAlignment",value:function(){return this.info.alignment}},{key:"setAlignment",value:function(e){var t,n=this;if(this.form.checkFillPerm(),1===this.getType())return Promise.resolve();switch(+e){case 0:t="left";break;case 1:t="center";break;case 2:t="right";break;default:throw new Error("Unknown alignment: "+e)}return this.updateWidgetsUI(this.form,this.info.name,"align",t,(function(t){return t.updateMKProperty("alignment",+e)})).then((function(t){return n.update("align",e),n.info.alignment=e}))}},{key:"setAlignmentWithString",value:function(e,t){return this.form.checkFillPerm(),this.updateWidgetsUI(this.form,this.info.name,"align",t||e),this.update("align",e),this.info.alignment=e}},{key:"getBorderStyle",value:function(){var e=this.controls[0].getWidget(),t=0;switch(e&&(t=e.getBorderStyle()),t){case 0:return"solid";case 1:return"dashed";case 2:return"underline";case 3:return"beveled";case 4:return"inset"}}},{key:"getRotation",value:function(){var e=this.controls[0].getWidget(),t=0;return e&&(t=e.getRotation()),-90*t}},{key:"setBorderStyle",value:function(e){var t,n;switch(this.form.checkFillPerm(),e){case"solid":n=0;break;case"dashed":n=1,t=[3,3];break;case"underline":n=2;break;case"beveled":n=3,e="outset";break;case"inset":n=4;break;default:return}return this.setBorderStyleWithParam(n,e,t)}},{key:"setBorderStyleWithParam",value:function(e,t,n){return this.updateWidgetsUI(this.form,this.info.name,"borderStyle",t,(function(t){return t.setBorderStyle(e,n)}))}},{key:"setBorderWidth",value:function(e){var t,n=this;switch(this.form.checkFillPerm(),e){case"thin":t=1;break;case"medium":t=2;break;case"thick":t=3;break;default:return}return this.updateWidgetsUI(this.form,this.info.name,"borderWidth",e,(function(e){var i=e.setBorderWidth(t);return n.form.engine.eventEmitter.emit(le.annotationUpdated,[e],e.getPDFPage(),en.borderWidthUpdated),i}))}},{key:"setBorderColor",value:function(e){var t=this;return this.form.checkFillPerm(),e=0===e?0:(0,j.colorConvertor)(e,"int"),this.form.addTask((function(n){return t.updateWidgetsUI(t.form,t.info.name,"borderColor",e,(function(n){var i=n.setMKProperty("borderColor",e);return t.form.engine.eventEmitter.emit(le.annotationUpdated,[n],n.getPDFPage(),en.borderColorUpdated),i}))}))}},{key:"getBorderColor",value:function(){var e=this.controls[0].getWidget();return e?e.getMKProperty("borderColor"):0}},{key:"setFillColor",value:function(e){var t=this;return this.form.checkFillPerm(),e=0===e?e:(0,j.colorConvertor)(e,"int"),this.form.addTask((function(n){return t.updateWidgetsUI(t.form,t.info.name,"fillColor",e,(function(n){var i=n.setMKProperty("fillColor",e);return t.form.engine.eventEmitter.emit(le.annotationUpdated,[n],n.getPDFPage(),en.fillColorUpdated),i}))}))}},{key:"getFillColor",value:function(){var e=this.controls[0].getWidget();return e?e.getMKProperty("fillColor"):0}},{key:"getOptions",value:function(){return this.info.options||[]}},{key:"getMaxLength",value:function(){return this.info.maxLength}},{key:"setMaxLength",value:function(e){var t=this;return this.form.checkFillPerm(),this.getType()!==gn.Text?0:(this.info.maxLength=e,this.form.addTask((function(n){return t.triggerUpdateEvent(en.formFieldsMaxLengthUpdated),t.updateWidgetsUI(t.form,t.info.name,"maxLength",e)})),this.update("maxLength",e),e)}},{key:"setValueWithoutAction",value:function(e){this.info&&((0,D._)(e,Array)?this.info.value=e:this.info.value=""+e)}},{key:"syncValue",value:function(e){var t=this;if(!this.info)return Promise.resolve();this.info.value=e;var n=this.info.name;return this.doc.api.setFieldValue(this.doc.id,n,e).then((function(i){var r=t.controls.map((function(e){return e.getWidget()}));return t.triggerUpdateEvent(en.formFieldValueUpdated,"value",r),t.updateWidgetsUI(t.form,n,"value",e)}))}},{key:"setValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.setValueEx(e,t)}},{key:"setValueEx",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e=i?i.info.objectNumber:this.controls[0].info.objectNumber,!this.doc.checkPermission(Qt.fillForm|Qt.annotForm))throw new Error("Permission error");var a=this.getType();if(7===a||1===a)return Promise.resolve();var s=this.getValue();if(a!==gn.RadioButton&&s===n&&!o)return Promise.resolve();var u=a==gn.RadioButton||a==gn.CheckBox,c=a==gn.ListBox,l=a==gn.ComboBox;if(u){var d=!1;this.info.controls.forEach((function(e){if(e.exportValue==n)e.isChecked=!0,d=!0;else{var i=t.getControlById(e.objectNumber),r=i.widget&&i.widget.info.ApStates;r&&r.indexOf(n)>-1&&(d=!0),e.isChecked=!1}})),d||(n="Off")}var h=this.getOptions();if(c&&r){if(Array.isArray(n)){for(var f=function(e){if(!h.find((function(t){return t.value===n[e]})))return g=!1,"break"},g=!0,v=n.length;v--;){if("break"===f(v))break}g||(n="")}else h.find((function(e){return e.value===n}))||(n="");h.forEach((function(e){(Array.isArray(n)?n.indexOf(e.value)>-1:e.value==n)?e.selected=!0:e.selected=!1}))}else l&&h.forEach((function(e){(Array.isArray(n)?n.indexOf(e.value)>-1:e.value==n)?e.selected=!0:e.selected=!1}));if(Array.isArray(n)||(n=""+n),this.info.value==n&&!u&&!o)return Promise.resolve(n);this.info.value=n;var p=this.info.name,m=[];return a==gn.RadioButton&&this.controls.forEach((function(e){var t=e.getWidget();t&&m.push(t.getAS())})),this.doc.api.setFieldValue(this.doc.id,p,n).then((function(r){var o=Promise.resolve();return u&&t.controls.forEach((function(t){var i=t.getWidget();i&&(o=i.update().then((function(t){return i.setAS(n,e)})))})),t.NeedExecuteValidateAction=!0,o.then((function(e){return t.updateWidgetsUI(t.form,p,"value",n)})).then((function(){var e=i&&(0,D._)(i,ho)?[i]:[];if(a==gn.RadioButton){var r=[];if(t.controls.forEach((function(e){var t=e.getWidget();t&&r.push(t.getAS())})),m.toString()!=r.toString())for(var o=0;o<r.length;o++)r[o]!=m[o]&&e.push(t.controls[o].getWidget());if(s!==n&&!e.length){var u=t.controls[0].getWidget();e=u?[u]:[]}}else{var c=t.controls[0].getWidget();e=c?[c]:[]}t.triggerUpdateEvent(en.formFieldValueUpdated,"value",e),t.NeedExecuteValidateAction=!1}))}))}},{key:"triggerUpdateEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(this.form&&this.form.engine){var i=this.form.engine.eventEmitter;if(e==en.formFieldValueUpdated){if(!n.length)return;return i.emit(le.annotationUpdated,n,n[0].getPDFPage(),e,t)}this.controls.forEach((function(n){var r=n.getWidget();r&&i.emit(le.annotationUpdated,[r],r.getPDFPage(),e,t)}))}}},{key:"setValueByIndex",value:function(e){this.form.checkFillPerm();var t=this.info.options[e].value;return this.setValue(t),e}},{key:"setHidden",value:function(e){this.form.checkFillPerm(),this.updateWidgetsUI(this.form,this.info.name,"hidden",e,(function(t){var n=t.info.flag;return e?(n&=-2,n&=-33,n|=6):(n&=-2,n&=-3,n&=-33,n|=4),t.setFlagValue(n)}),!0)}},{key:"setPassword",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|vn.TextPassword:this.info.flag&~vn.TextPassword,this.updateWidgetsUI(this.form,this.info.name,"password",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(en.flagsUpdated)}))}},{key:"setReadonly",value:function(e){var t=this;return this.form.checkFillPerm(),this.info.flag=e?this.info.flag|vn.ReadOnly:this.info.flag&~vn.ReadOnly,this.updateWidgetsUI(this.form,this.info.name,"readonly",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(en.flagsUpdated)}))}},{key:"setRequired",value:function(e){var t=this;return this.form.checkFillPerm(),this.info.flag=e?this.info.flag|vn.Required:this.info.flag&~vn.Required,this.updateWidgetsUI(this.form,this.info.name,"required",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(en.flagsUpdated)}))}},{key:"setNoScroll",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|vn.TextDoNotScroll:this.info.flag&~vn.TextDoNotScroll,this.updateWidgetsUI(this.form,this.info.name,"noScroll",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(en.flagsUpdated)}))}},{key:"setNoSpellCheck",value:function(e){var t=this;this.form.checkFillPerm(),this.info.flag=e?this.info.flag|vn.TextDoNotSpellCheck:this.info.flag&~vn.TextDoNotSpellCheck,this.updateWidgetsUI(this.form,this.info.name,"noSpellCheck",e),this.update("flag",this.info.flag).then((function(){t.triggerUpdateEvent(en.flagsUpdated)}))}},{key:"setInUnison",value:function(e){var t=this;this.form.checkFillPerm();var n=Promise.resolve();if(e)this.info.flag=this.info.flag|vn.ButtonRadiosInUnison;else{this.info.flag=this.info.flag&~vn.ButtonRadiosInUnison;var i=this.info.controls[0].exportValue;n=n.then((function(e){return t.doc.api.setFieldValue(t.doc.id,t.getName(),i)}))}n.then((function(e){return t.update("flag",t.info.flag)})).then((function(e){t.triggerUpdateEvent(en.flagsUpdated);var n=t.getValue();t.updateWidgetsUI(t.form,name,"value",n)}))}},{key:"setMKProperty",value:function(e,t){this.updateWidgetsUI(this.form,this.info.name,e,t,(function(n){return n.setMKProperty(e,t)}))}},{key:"clearItems",value:function(){this.form.checkFillPerm(),this.info.options.length=0,this.info.value="",this.updateWidgetsUI(this.form,this.info.name,"clearItems"),this.update("clearItems")}},{key:"deleteItems",value:function(e){this.form.checkFillPerm(),e<0||e>=this.info.options.length||(this.info.options[e].value==this.info.value&&(this.info.value=""),this.info.options.splice(e,1),this.updateWidgetsUI(this.form,this.info.name,"deleteItems",e),this.update("deleteItems",e))}},{key:"insertItemAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.form.checkFillPerm();var i=this.info.options;-1==n&&(n=i.length),t||(t=e);var r=n==i.length?n-1:n;i[r]&&i[r].value==t?this.info.value=t:(this.info.options=[].concat(i.slice(0,n),{label:e,value:t,defaultSelected:!1,selected:!1},i.slice(n,i.length)),this.info.value=t,this.updateWidgetsUI(this.form,this.info.name,"insertItemAt",n),this.update("insertItemAt",{index:n,label:e,value:t,defaultSelected:!1,selected:!1}))}},{key:"showDisplayValue",value:function(e){return this.form&&this.info?this.info.displayValue==e?Promise.resolve():void this.updateWidgetsUI(this.form,this.info.name,"displayValue",e):Promise.resolve()}},{key:"getAction",value:function(e){if(!this.engineActions)for(var t in this.engineActions={},this.info.AA)this.engineActions[t]=this.doc.engine.actionFactory.createAction(this.info.AA[t],this.doc);return this.engineActions[e]}},{key:"getDAFontSize",value:function(){return this.info.DA.textSize}},{key:"getDAFontColor",value:function(){return this.info.DA.textColor}},{key:"isDAFontEmbedded",value:function(){return this.info.DA.isEmbedded}},{key:"getDAFontBuffer",value:function(){return this.doc.api.getFontBufferByName(this.doc.id,this.info.DA.fontName)}},{key:"setDAFontColor",value:function(e){this.form.checkFillPerm();var t=(0,j.colorConvertor)(e,"int");return t==this.info.DA.textColor||(this.info.DA.textColor=t,this.updateWidgetsUI(this.form,this.info.name,"textColor",(0,j.colorConvertor)(e,"HTML"),(function(e){return e.updateMKProperty("fontColor",t)})),this.update("textColor",t)),t}},{key:"setDAFontColorAsync",value:function(e){var t=this;this.form.checkFillPerm();var n=(0,j.colorConvertor)(e,"int");return this.info.DA.textColor=n,this.updateWidgetsUI(this.form,this.info.name,"textColor",(0,j.colorConvertor)(e,"HTML"),(function(e){return e.updateMKProperty("fontColor",n)})).then((function(){return t.update("textColor",n)})).then((function(){return n}))}},{key:"getControlByIndex",value:function(e){return this.controls[e]}},{key:"removeControlInfo",value:function(e){var t;for((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.form.checkFillPerm(),t=0;t<this.info.controls.length;t++){if(this.info.controls[t].objectNumber==e){this.info.controls.splice(t,1);break}}return this.controls[t].destroy(),this.controls.splice(t,1),this.info.controls.length}},{key:"getControlsCount",value:function(){return this.info.controls.length}},{key:"focus",value:function(){var e=this.controls[0]&&this.controls[0].getWidget();e&&e.updateUI({type:"focus"})}},{key:"getControlExportValues",value:function(e){return this.info.controls[e].exportValue}},{key:"getExportValues",value:function(){for(var e=[],t=0;t<this.info.controls.length;t++)e.push(this.info.controls[t].exportValue);return e}},{key:"setExportValue",value:function(e,t){var n=this,i=this.info.controls[e];return i.exportValue=t,this.doc.api.updateFormControl(this.doc.id,this.getName(),i.objectNumber,"exportValue",t).then((function(e){n.triggerUpdateEvent(en.formFieldExportValueUpdated,"exportValue"),e.forEach((function(e,t){var i=n.controls[t];i.setExportValue(e);var r=i.getWidget();if(r)return r._update().then((function(e){return r.updateUI({})}))}))}))}},{key:"setWidgetDisplay",value:function(e,t){return this.updateWidgetsUI(this.form,this.info.name,"display",e,(function(n){return n.setDisplay(e,t)}),!0)}},{key:"setIconObj",value:function(e,t){this.form.checkFillPerm(),this.updateWidgetsUI(this.form,this.info.name,"icon",null,(function(n){return n.setIconObj(e,t)}))}},{key:"setOptions",value:function(e){var t=this;if(this.form&&(this.form.checkFillPerm(),4===this.getType()||5===this.getType())){e.length>0&&!e.some((function(e){return e.selected}))&&(e[0].selected=!0),this.info.options=e;var n=this.update("setItems",this.info.options);return arguments[1]?n:n.then((function(n){t.info.defaultValue=n.defaultValue;t.info.value;for(var i=0;i<e.length;i++)if(e[i].selected){e[i].value;break}return t.info.options=n.options,Promise.resolve()})).then((function(){var e=t.updateWidgetsUI(t.form,t.info.name,"setItems");return t.triggerUpdateEvent(en.formFieldItemsUpdated),e}))}}},{key:"setItems",value:function(e){var t=this;this.form.checkFillPerm();var n=Array.from(new Set(e.map((function(e){return JSON.stringify(e)}))));e=n.map((function(e){return JSON.parse(e)}));var i=[];return e.forEach((function(e){Array.isArray(e)?e[0]&&i.push({label:e[0].toString(),value:e[1].toString(),selected:e[2]||!1,defaultSelected:e[3]||!1}):e&&i.push({label:e.toString(),value:e.toString(),selected:!1,defaultSelected:!1})})),i.length?new Promise((function(e){t.form.addTask((function(n){e(t.setOptions(i))}))})):Promise.resolve()}},{key:"setDisplayValue",value:function(e){return this.displayValue==e?Promise.resolve():(this.displayValue=e,this.update("displayValue",e))}},{key:"getDisplayValue",value:function(){return this.displayValue}},{key:"setRect",value:function(e){this.rect=e,this.updateWidgetsUI(this.form,this.info.name,"rect",e,(function(t){return t.setRect(e)}))}},{key:"updateControls",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=0;t<e.length;t++){var n=this.controls[t];n?n.info=e[t]:(n=new so(this.doc,this,e[t]),this.controls.push(n))}this.info.controls=e}},{key:"setAction",value:function(e,t){var n=this;if(-1!=e&&(e-St.keyStroke|St.onBlur-e)<0)throw new Error("Trigger error. Please refer to Constant Action_Trigger");if(!t)throw new Error("Action should not be null.");this.form.checkDesignPerm();var i=t.info;if("string"==typeof t){var r=new Yr;r.setScript(t),i=(t=r).info}var o=this.info.name,a={trigger:e,data:i,field:o};if(e>6&&e<11){var s=this.getAction(e);return this.update("AA",a).then((function(i){n.triggerEvents(le[s?"actionUpdated":"actionAdd"],n.controls[0].getWidget()),n.triggerUpdateEvent(en[s?"formFieldActionUpdated":"addAction"]);var r=n.doc;t.init(i,r.engine.actionFactory,r,r.api,r.engine.eventEmitter,n),e==St.calculate&&n.form.addCO(n),n.info.AA[e]=i,n.engineActions&&(n.engineActions[e]=t)}))}return this.updateWidgetsUI(this.form,o,"action",a,(function(n){return n.setAction(e,t)}))}},{key:"triggerEvents",value:function(e){if(this.form&&this.form.engine){var t=this.form.engine.eventEmitter;this.controls.forEach((function(n){var i=n.getWidget();i&&t.emit(e,[i])}))}}},{key:"removeAction",value:function(e){var t=this.info.name,n={trigger:e,data:null,field:t};return e==St.calculate&&this.form.removeFieldInCO(t),this.updateWidgetsUI(this.form,t,"action",n,(function(t){return t.removeAction(e)}))}},{key:"hasControl",value:function(e){return this.info.controls.some((function(t){return t.objectNumber==e}))}},{key:"getBorderWidth",value:function(){var e=this.controls[0].getWidget();return e?e.getBorderWidth():0}},{key:"isDateType",value:function(){var e=this.getType(),t=this.info;return 6===e&&t.AA&&t.AA[St.keyStroke]&&t.AA[St.keyStroke].javascript&&t.AA[St.keyStroke].javascript.indexOf("Date")>-1}},{key:"isImageType",value:function(){var e=this.getType(),t=this.getWidget(0);if(!t)return!1;var n=t.info;return 1===e&&n.iconFit&&n.iconFit.isProportionalScaling}}]),e}();const Hy=Uy;var Wy=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,A._)(n,[{key:"isSigned",value:function(){return this.info.isSigned}},{key:"getByteRange",value:function(){return this.info.byteRange}},{key:"getFilter",value:function(){return this.info.filter}},{key:"getSubfilter",value:function(){return this.info.subfilter}},{key:"getSigner",value:function(){return this.info.signer}},{key:"setLockAction",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Array.isArray(n)||(n=n.split(",")),this.form.addTask((function(i){return t.doc.api.setLockAction(t.doc.id,t.info.name,e,n).then((function(i){return t.info.lockAction={type:e,fields:n}}))}))}},{key:"getLockAction",value:function(){return this.info.lockAction}},{key:"Verify",value:function(e){var t=this;return this.form.addTask((function(n){return t.doc.engine.ensureSideModeLoaded().then((function(n){return t.doc.api.VerifySignature(t.doc.id,t.info.name,e)}))}))}},{key:"verifySignatureLtv",value:function(e){var t=this;return this.form.addTask((function(n){return t.doc.engine.ensureSideModeLoaded().then((function(n){return t.doc.api.verifySignatureLtv(t.doc.id,t.info.name,e)}))}))}},{key:"clearSignature",value:function(e){var t=this;return this.form.addTask((function(n){return t.doc.engine.ensureSideModeLoaded().then((function(n){return t.doc.api.clearSignature(t.doc.id,t.info.name,e)}))}))}},{key:"_getDigitalSignatureInfo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.form.addTask((function(n){return e.doc.engine.ensureSideModeLoaded().then((function(n){return e.doc.api.getDigitalSignatureInfo(e.doc.id,e.info.name,t)}))}))}},{key:"getDigitalSignatureInfo",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this;return new Promise((e=(0,_._)((function(e,r){var o,a,s,u,c,l,d,h,f,g,v,p,m,y,w,_,P,A,S,x,C,D,E,I,R,T,M,O,L,N;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:if(i.destroyed)return e({}),[2];if(o={},a={},s=i.info,u=s.isSigned,c=s.signer,l=s.originalSigner,d=void 0===l?c:l,!u)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i._getDigitalSignatureInfo(t)];case 2:return a=r.sent(),h=a.certificateInfo,f=(void 0===h?{}:h).subjectChain,c=(c=((g=void 0===f?[]:f)[g.length-1]||{}).subjectName||"")||d,[3,4];case 3:return v=r.sent(),a={},console.error(v),[3,4];case 4:return n?(p=i.info,m=p.name,y=p.signTimeFormat,w=p.location,_=p.reason,P=p.contact,A=p.DN,S=p.text,x=p.isCertified,C=p.fileSizeOfSignedVersion,D=p.signedVersion,E=p.isVisible,I=p.filter,R=p.subfilter,T=p.creatorName,M={name:m,isSigned:u,isVisible:E},u&&(O={signTime:y,originalSigner:d,signer:c,location:w,reason:_,contact:P,DN:A,text:S,isCertified:x,fileSizeOfSignedVersion:C,signedVersion:D,filter:I,subfilter:R,creatorName:T},M=(0,k._)({},M,O),i.info=(0,b._)((0,k._)({},i.info,a),{signer:c,originalSigner:d})),[4,i.getControlByIndex(0).getWidgetAnnot()]):[3,6];case 5:return L=r.sent(),N={pageIndex:L?L.getPage().getIndex():0,top:L?L.info.rect.top:0,widgetId:L?L.getId():void 0},o=(0,k._)({},M,a,N),[3,7];case 6:o=(0,k._)({},i.signatureInfo||{},a),r.label=7;case 7:return e(o),[2]}}))})),function(t,n){return e.apply(this,arguments)}))}},{key:"isLast",value:function(){return this.doc.api.isLastSignature(this.doc.id,this.getName())}},{key:"getImage",value:function(){return this.getBitmap().then((function(e){if(!e)return null;var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d"),i=new(Uint8ClampedArray||Uint8Array)(e.buffer),r=n.createImageData(e.width,e.height);return r.data.set(i),n.putImageData(r,0,0),t.toDataURL()}))}},{key:"getBitmap",value:function(){return this.doc.api.getSignatureBitmap(this.doc.id,this.info.name)}},{key:"setBitmap",value:function(e){var t=this,n=this.getWidget(0);return this.doc.api.setSignatureBitmap(this.doc.id,this.info.name,e).then((function(){return t.doc.engine.eventEmitter.emit(le.annotationAppearanceUpdated,[n],n.getPDFPage()),t}))}},{key:"getSignInfo",value:function(){var e=this;return this.isSigned()?this.getControlByIndex(0).getWidgetAnnot().then((function(t){var n=t.getRect(),i=t.getPage().getIndex(),r=e.info,o=r.filter,a=r.subfilter,s=r.apFlag,u=r.signer,c=r.location,l=r.reason,d=r.DN,h=r.text,f=r.name,g=r.signTime,v=r.contact;return e.getImage().then((function(e){return{filter:o,subfilter:a,rect:n,pageIndex:i,flag:s,signer:u,reason:l,email:v,distinguishName:d,location:c,textValue:h,fieldName:f,signTime:g,image:e}}))})):Promise.resolve({})}}]),n}(Hy);const Yy=Wy;var qy=function(){function e(t,n){(0,P._)(this,e),this.doc=t,this.engine=n,this.api=n.api,this.fields=[],this.fieldsNameMap={},this.actionDepth=0,this.calculationEnabled=!0,this.queueTask=new j.QueuedAsyncTaskExecutor,this.formInfo={}}return(0,A._)(e,[{key:"destroy",value:function(){var e=this;return this.doc.api.destroyForm(this.doc.id).then((function(){e.doc=null,e.engine=null,e.api=null,e.fields.forEach((function(t){var n=t.getName();e.fieldsNameMap[n]=null,t.destroy()})),e.fields=[],e.fieldsNameMap=null}))}},{key:"checkFillPerm",value:function(){if(!this.doc.checkPermission(Qt.annotForm|Qt.fillForm))throw new Error("Permission error")}},{key:"checkDesignPerm",value:function(){if(!this.doc.checkPermission(Qt.annotForm)||!this.doc.checkPermission(Qt.modify))throw new Error("Permission error")}},{key:"setState",value:function(e){this.state=e}},{key:"reduceControl",value:function(e,t){var n=this;Object.keys(this.fieldsNameMap).forEach((function(e){t.forEach((function(t){var i=n.fieldsNameMap[e];i&&i.hasControl(t)&&n.removeControl(e,t,!1)}))}))}},{key:"isEmpty",value:function(){return!this.fields.length}},{key:"setActionHandler",value:function(e){this.actionHandler=e}},{key:"setFormJson",value:function(e){if(this.isLoaded=!0,e){this.formInfo=e;for(var t=0,n=e.fields.length;t<n;t++){var i=e.fields[t],r=this.fieldsNameMap[i&&i.name||t];r&&r.updateControls?r.updateControls(i.controls):(r=7==i.type?new Yy(this.doc,this,i):new Hy(this.doc,this,i),this.fields.push(r),this.fieldsNameMap[i&&i.name||t]=r)}}else this.formInfo={fields:[]}}},{key:"reloadPDFFieldByName",value:function(e){var t=this;return this.api.reloadFieldByName(this.doc.id,e).then((function(n){return t.updatePDFField(e,n),n}))}},{key:"updatePDFField",value:function(e,t){var n=this.fieldsNameMap[e];n&&(n.updateControls(t.controls),n.info=t,this.fieldsNameMap[e].info=t)}},{key:"getAlignment",value:function(){return this.formInfo.alignment}},{key:"getFieldCount",value:function(){return this.fields.length}},{key:"getField",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.fieldsNameMap[e];if(!t||n)return n;var i=[];for(var r in this.fieldsNameMap)r.startsWith(e)&&i.push(this.fieldsNameMap[r]);return i}},{key:"getFieldByIndex",value:function(e){return this.fields[e]}},{key:"getFieldAtPosition",value:function(e,t,n){var i=this.fields.filter((function(t){var n=t.getControlsCount()>0?t.getWidget(0):void 0;return!!n&&n.getPDFPage().getIndex()===e}));if(i)for(var r=0;r<i.length;r++){var o=i[r];if(o.getLoadedWidgets().some((function(e){var i=e.getRect();return!(t<i.left||t>i.right||n<i.bottom||n>i.top)})))return o}}},{key:"setFieldValue",value:function(e,t){if(this.checkFillPerm(),"string"==typeof e&&(e=this.fieldsNameMap[e]),e.setValue(t),this.actionDepth++,this.actionDepth<2){var n=this.formInfo.calculationOrder;for(var i in n){var r=this.getField(n[i]),o=r.getAction(vo.FieldRecalculateValue);o&&this.actionHandler&&this.actionHandler(o,e,r,vo.FieldRecalculateValue)}}this.actionDepth--}},{key:"calculate",value:function(e){if(this.checkFillPerm(),this.calculationEnabled){if("string"==typeof e&&(e=this.fieldsNameMap[e]),this.actionDepth++,this.actionDepth<2){var t=this.formInfo.calculationOrder;for(var n in t){var i=this.getField(t[n]);if(i){var r=i.getAction(vo.FieldRecalculateValue);r&&this.actionHandler&&this.actionHandler(r,e,i,vo.FieldRecalculateValue)}}}this.actionDepth--}}},{key:"resetForm",value:function(){var e=this,t=arguments,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.checkFillPerm(),this.enumFields(n,i,(function(n,i,r){var o=e.getField(i),a=o.getDefaultValue();if(6===o.getType()){var s=o.getMaxLength();a.length>s&&0!=s&&(a=a.substring(0,s))}o.setValue(a);var u=t[3]||{};u.setValue&&u.setValue(a,r,o),e.formInfo.calculationOrder.includes(i)&&e.calculate(o)}),!0),r&&this.calculate(r)}},{key:"submitForm",value:function(e,t,n){var i,r=this,o=fn.getType(n),a="application/json";switch(o){case"HTML":var s="";this.enumFields(t,n,(function(e,t,n){s+=t+"="+n+"&"}),!1,!1,!0),s=encodeURI(s.substr(0,s.length-1)),e+="?"+s,i=Promise.resolve(s);break;case"FDF":a="application/vnd.fdf",i=Promise.resolve(new Blob([this.exportFDF(t,n,!0)]));break;case"XFDF":a="application/vnd.xfdf",i=Promise.resolve(new Blob([this.exportXFDF(t,n,!0)]));break;case"PDF":var u=[];i=this.doc.getStream((function(e){var t=e.arrayBuffer;e.offset,e.size;u.push(t)})).then((function(e){return new Blob(u,{type:"application/pdf"})}))}return i.then((function(t){var i=fn.isGetMethod(n);return new Promise((function(n,o){var s=new XMLHttpRequest;s.open(i?"GET":"POST",e),s.setRequestHeader("Content-Type",a),s.send(t),s.onloadend=function(){n(s);var e=s.response.match(/\/JavaScript <<\/Before\s\(([\s\S]*?)\)>>/);if(e){e=e[1];var t=new Yr;t.setScript(e),r.actionHandler(t,null,null,-1)}}}))}))}},{key:"enumFieldsEx",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(fn.isExclude(n)){var u=Object.keys(this.fieldsNameMap);if(0==(t=u.filter((function(e){return-1==t.indexOf(e)}))).length)return}0==t.length&&(t=Object.keys(this.fieldsNameMap));var c=!1,l=0,d="enumFieldsEx",h=1;t.length>300&&(c=!0,this.doc.engine.eventEmitter.emit(de.progressChanged,d,0,Rm.PROGRESSING));for(var f=function(){c&&e.addTask((function(){if(++l>=t.length)e.doc.engine.eventEmitter.emit(de.progressChanged,d,100,Rm.SUCCESS);else{var n=Math.floor(t.length/100)*h;l>=n&&(e.doc.engine.eventEmitter.emit(de.progressChanged,d,Math.round(l/t.length*100),Rm.PROGRESSING),h++)}}),!0)},g=r?1:fn.isIncludeNoValueFields(n),v=0;v<t.length;v++){var p=t[v],m=this.getField(p);if(m){var y=m.getType(),k=m.getValue();if(a&&(y===gn.RadioButton||y===gn.CheckBox)){for(var b="Off",w=0;w<m.getControlsCount();w++)if(m.getControlByIndex(w).info.isChecked){b=m.getControlByIndex(w).getExportValue();break}k=b}var _=0;r||(_=(_=vn.isNoExport(m.getFlags()))||(s?"":!k)&&!g),o||y!=gn.Sign&&y!=gn.PushButton&&!_?(i(y,m.getName(),k||""),f()):f()}else f()}}},{key:"enumFields",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.enumFieldsEx(e,t,n,i,r,!1,o)}},{key:"exportFDF",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[37,70,68,70,45,49,46,50,10,49,32,48,32,111,98,106,10,60,60,47,70,68,70,60,60,47,70,40];Ky(i,this.getFileName()),Ky(i,")/Fields["),this.enumFieldsEx(e,t,(function(e,t,n){switch(Ky(i,"<</T("),Ky(i,t,!0),Ky(i,")/V"),e){case gn.CheckBox:case gn.RadioButton:Ky(i,"/"),Ky(i,n,!0);break;default:Ky(i,"("),Ky(i,n),Ky(i,")")}Ky(i,">>")}),!1,!1,!0,n);var r="]/ID[<".concat(this.doc.info.fileID[0],"><").concat(this.doc.info.fileID[1],">]/UF(").concat(this.getFileName(),")>>")+"/Type/Catalog>>\nendobj\ntrailer\n<</Root 1 0 R>>\n%%EOF";return Ky(i,r),new Uint8Array(i)}},{key:"xmlEncodeText",value:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/\"/g,"&quot;")}},{key:"getFileName",value:function(){return this.doc.info.fileName||""}},{key:"exportXFDF",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r='<?xml version="1.0" encoding="UTF-8"?>\n<xfdf xmlns="http://ns.adobe.com/xfdf/" xml:space="preserve">\n'+'<f href="'.concat(this.xmlEncodeText(this.getFileName()),'"/><fields>\n'),o='</fields>\n<ids original="'.concat(this.doc.info.fileID[0],'" modified="').concat(this.doc.info.fileID[1],'"/>\n</xfdf>'),a="";return this.enumFieldsEx(t,n,(function(t,n,i){(0,D._)(i,Array)?(a+='<field name="'.concat(e.xmlEncodeText(n),'">'),i.forEach((function(t){a+="<value>".concat(e.xmlEncodeText(t),"</value>")})),a+="</field>"):a+='<field name="'.concat(e.xmlEncodeText(n),'"><value>').concat(e.xmlEncodeText(i),"</value></field>")}),!1,!1,!0,i),r+a+o}},{key:"importFDF",value:function(e){this.checkFillPerm();var t=e.match(/<<\/T\([\s\S]*?\)(\/V[\s\S]*?)?>>/g);for(var n in t){var i=t[n].match(/<<\/T\(([\s\S]*?)\)(?:\/V\/?([\s\S]*?))?>>/);if(void 0!==i[2]){var r=this.getField(i[1]);if(!r)return;var o=i[2];o!==r.getValue()&&(o=r.getType()===gn.CheckBox||r.getType()===gn.RadioButton?$y(o):$y(o.match(/\(([\s\S]*)\)/)[1]),r.setValue(o))}}}},{key:"importXFDF",value:function(e){this.checkFillPerm();var t=e.match(/<field\s*name=["|'][\s\S]*?["|']\s*?>\s*?(<value\s*?(\/>|>[\s\S]*?<\/value\s*?>))?\s*?<\/field\s*?>/g);for(var n in t){var i=t[n].match(/<field name=["|']([\s\S]*?)["|']\s*?>\s*?<value\s*?(?:\/>|>([\s\S]*?)<\/value\s*?>)/);if(i&&void 0!==i[2]){var r=this.getField(i[1]);if(!r)return;var o=i[2];o!==r.getValue()&&r.setValue(o)}}}},{key:"exportXML",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i="",r={},o=0;return this.enumFieldsEx(e,t,(function(e,t,n){var a=t,s="",u=t.match(/[^0-9][a-zA-Z0-9:\-_\.]*/);if(u&&u[0].length!==t.length&&(a="fxTag"+t.replace(/[^a-zA-Z0-9]/g,""),s=' xfdf:original="'+t+'"'),isNaN(parseInt(a))||(a="fxTag"+t,s||(s=' xfdf:original="'+t+'"')),(0,D._)(n,Array))if(1===n.length)n=(0,j.escapeXMLValue)(O()("<div/>").text(n[0]).html());else{var c="";n.forEach((function(e){c+="<value>".concat((0,j.escapeXMLValue)(e),"</value>")})),n=c}else n=(0,j.escapeXMLValue)(O()("<div/>").text(n).html());for(var l=a;l in r;)l=a+o,o+=1;r[l]=!0,i+="<"+a+s+">"+n+"</"+a+">\r"}),!1,!1,!0,n),'<?xml version="1.0" encoding="UTF-8"?><fields xmlns:xfdf="http://ns.adobe.com/xfdf-transition/">'+i+"</fields>"}},{key:"importXML",value:function(e){(this.checkFillPerm(),this.isEmpty())||("string"==typeof e&&(e=O().parseXML(e)),O()(e).children().children().each((function(){var e=getNodeString(O()(this),"xfdf:original");e&&""!==e&&0!==e.length||(e=this.tagName);var t=O()(this).text(),n=this.getField(e);n&&n.setValue(t)})))}},{key:"upadateValue",value:function(e){var t=this,n=function(){var n=t.getField(l);if(!n)return c(),"continue";var i=e[l],r=n.getType();if((0,D._)(i,Array)&&5==r){n.info.value=i;var o=n.info.options,a=[];i.forEach((function(e){for(var t=0;t<o.length;t++)t!=a[t]&&(o[t].selected=o[t].value===e)&&(a[t]=t)})),n.updateWidgetsUI(t,n.getName(),"value",i).then(c)}else{var s=Promise.resolve();if(i!==n.getValue()){if(n.info.value=i,4==r||5==r)n.info.options.forEach((function(e){e.selected=e.value===i}));s=n.updateWidgetsUI(t,n.getName(),"value",i)}2!=r&&3!=r||(n.controls.forEach((function(e){var t=e.getWidget();e.info.isChecked=e.getExportValue()==i||"Off"!==i&&t&&t.getOnAS()===i})),s=n.updateWidgetsUI(t,n.getName(),"value",i,(function(e){return e.update()}))),s.then(c)}},i=this,r=0,o="upadateValue",a="upadateFormValue",s=1,u=Object.keys(e);this.doc.engine.eventEmitter.emit(a,o,0,Rm.PROGRESSING);var c=function(){if(++r>=u.length)i.doc.engine.eventEmitter.emit(a,o,100,Rm.SUCCESS);else{var e=Math.floor(u.length/100)*s;r>=e&&(i.doc.engine.eventEmitter.emit(a,o,Math.round(r/u.length*100),Rm.PROGRESSING),s++)}return Promise.resolve()};for(var l in e)n()}},{key:"updateFields",value:function(e,t,n){if("controlFlag"===t){var i=!0,r=!1,o=void 0;try{for(var a,s=Object.keys(this.fieldsNameMap)[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;u.startsWith(e)&&this.fieldsNameMap[u].setWidgetDisplay(n)}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}}}},{key:"addSignature",value:function(e,t,n,i){var r=this;return this.doc.api.addControl(this.doc.id,e,n||"",7,t,i).then((function(t){if(t.failed)throw new Error("Signature creation failed.");var n;return t.form?(r.setFormJson(t.form),n=r.getField(t.fieldName)):(n=new Yy(r.doc,r,t),r.fields.push(n),r.fieldsNameMap[t.name]=n),Promise.all([n,r.doc.getPageByIndex(e)]).then((function(e){var t=(0,E._)(e,2),n=t[0],i=t[1];return Promise.all([i,i.getUnloadedAnnots(),n])})).then((function(e){var t=(0,E._)(e,3),n=t[0],i=t[1],o=t[2],a=i.filter((function(e){return e.getType()===Hi.widget}));return r.doc.engine.eventEmitter.emit(le.annotationAdd,a,n),o}))}))}},{key:"addSignatureBatch",value:function(e,t){var n=this;return this.doc.api.addSignatureControlBatch(this.doc.id,e,t).then((function(e){var t=new Set,i=[];e.forEach((function(e){var r=e.pageIndex,o=e.json;t.add(r);var a=new Yy(n.doc,n,o);n.fields.push(a),n.fieldsNameMap[o.name]=a,i.push(a)}));var r=Promise.resolve();return Array.from(t).forEach((function(e){r=r.then((function(){return n.doc.getPageByIndex(e).then((function(e){return Promise.all([e,e.getUnloadedAnnots()])})).then((function(e){var t=(0,E._)(e,2),i=t[0],r=t[1].filter((function(e){return e.getType()===Hi.widget}));n.doc.engine.eventEmitter.emit(le.annotationAdd,r,i)})).catch((function(e){if(n.doc&&!n.doc.isDestroyed)throw e}))}))})),r.then((function(){return i}))}))}},{key:"addControlSync",value:function(e){return this.addControl(e.pageIndex,e.fieldName,e.fieldType,e.rect),this.fieldsNameMap[e.fieldName]}},{key:"createFieldByCopyControl",value:function(e){var t=this,n=e.pageIndex,i=e.newRect,r=e.srcWidget,o=e.newFieldName;this.checkDesignPerm();var a=r.info.fieldType,s=r.info.field,u=r.info.objectNumber;if(!this.isLoaded)throw new Error("please call PDFDoc.loadForm() firstly.");if(n<0||n>this.doc.getPageCount()-1||!o||!o.trim()||!a||a<1||a>6)return Promise.resolve({success:!1,newFieldName:o});var c,l=this.fieldsNameMap[o],d=!1;return l||(c=Gy(o,a),this.formInfo.fields.push(c),(l=new Hy(this.doc,this,c)).setRect(i),this.fields.push(l),this.fieldsNameMap[c.name]=l,d=!0),this.addTask((function(e){var h=1===a&&r.info.iconFit&&r.info.iconFit.isProportionalScaling;return t.doc.api.createFieldByCopyControl(t.doc.id,n,a,h,o,i,s,u).then((function(e){return d&&e.fieldName!==o&&(t.fields.pop(l),t.formInfo.fields.pop(c),o=e.fieldName,c=Gy(o,a),t.formInfo.fields.push(c),l=new Hy(t.doc,t,c),t.fields.push(l),t.fieldsNameMap[c.name]=l),e.form?t.setFormJson(e.form):l.updateControls(e.controls),t.doc.getPageByIndex(n)})).then((function(e){return Promise.all([e,e.getUnloadedAnnots()])})).then((function(e){var n=(0,E._)(e,2),i=n[0],r=n[1];return t.doc.engine.eventEmitter.emit(le.annotationAdd,r,i),{newFieldName:o,annots:r}}))}))}},{key:"hasSigField",value:function(){return this.fields.some((function(e){return 7==e.getType()}))}},{key:"addControl",value:function(e,t,n,i){var r=this;if(this.checkDesignPerm(),!this.isLoaded)throw new Error("please call PDFDoc.loadForm() firstly.");if(e<0||e>this.doc.getPageCount()-1||!t||!t.trim()||!n||n<1||n>6)return Promise.resolve({success:!1,newFieldName:t});var o,a=this.fieldsNameMap[t],s=!1;a||(o=Gy(t,n),this.formInfo.fields.push(o),(a=new Hy(this.doc,this,o)).setRect(i),this.fields.push(a),this.fieldsNameMap[o.name]=a,s=!0);var u=arguments[4];return this.addTask((function(c){return r.doc.api.addControl(r.doc.id,e,t,n,i,u).then((function(u){return s&&u.fieldName!==t&&(r.fields.pop(a),r.formInfo.fields.pop(o),t=u.fieldName,o=Gy(t,n),r.formInfo.fields.push(o),(a=new Hy(r.doc,r,o)).setRect(i),r.fields.push(a),r.fieldsNameMap[o.name]=a),u.form?r.setFormJson(u.form):a.updateControls(u.controls),u.fieldFlags&&(a.info.flag=u.fieldFlags),r.doc.getPageByIndex(e)})).then((function(e){return Promise.all([e,e.getUnloadedAnnots()])})).then((function(e){var n=(0,E._)(e,2),i=n[0],o=n[1].filter((function(e){return e.getType()===Hi.widget}));return r.doc.engine.eventEmitter.emit(le.annotationAdd,o,i),Promise.resolve({success:!0,newFieldName:t})}))}))}},{key:"validateFieldName",value:function(e,t){return this.doc.api.validateFieldName(this.doc.id,e,t)}},{key:"reloadForm",value:function(e){return e&&(this.fields.forEach((function(e){return e.destroy()})),this.fields=[],this.fieldsNameMap={},this.setFormJson(e),this.doc.pageCache.forEach((function(e){e.annots.forEach((function(e){"widget"==e.getType()&&e.mapFormControl()}))}))),e}},{key:"renameField",value:function(e,t,n){var i=this,r=this.getField(e).controls.map((function(e){return e.getWidget()})).filter((function(e){return e}));return this.doc.api.renameField(this.doc.id,e,t).then((function(e){var t=r.map((function(e){return e.update()}));return t.push(e),Promise.all(t)})).then((function(e){return i.reloadForm(e[e.length-1])})).then((function(){return r.map((function(e){return e.updateUI({type:"rename"})}))}))}},{key:"removeEngineField",value:function(e){delete this.fieldsNameMap[e];var t=0;this.fields.forEach((function(n,i){if(n.getName()==e)return t=i,!1})),this.fields.splice(t,1),this.formInfo.fields.splice(t,1),this.removeFieldInCO(e)}},{key:"removeField",value:function(e){var t=this;if(this.checkDesignPerm(),!this.fieldsNameMap[e])return Promise.resolve(!1);var n=this.getField(e);if(n.getType()==gn.Sign&&n.isSigned())throw new Error("Signed signature can't be removed.");return n.getLoadedWidgets().map((function(e){if(e){var n=e.getPage();n.clearAnnotIds([e.getId()]),t.doc.engine.eventEmitter.emit(le.annotationRemoved,[e],n)}})),this.removeFieldInCO(e),this.removeEngineField(e),this.queueTask.waitForCurrentRunningTasks().then((function(n){return t.doc.api.removeField(t.doc.id,e)}))}},{key:"removeControlByIndex",value:function(e,t){var n=this.getField(e).getControlByIndex(t);this.removeControl(e,n.info.objectNumber)}},{key:"removeControl",value:function(e,t){this.checkDesignPerm();var n=!(arguments.length>2)||arguments[2],i=this.getField(e).getControlById(t).getWidget();if(i){var r=i.getPage();r.clearAnnotIds([i.getId()]),this.doc.engine.eventEmitter.emit(le.annotationRemoved,[i],r)}return 0==this.fieldsNameMap[e].removeControlInfo(t)&&this.removeEngineField(e),n?this.doc.api.removeControl(this.doc.id,0,e,t):Promise.resolve()}},{key:"fixPageFields",value:function(e){return this.doc.api.fixPageFields(this.doc.id,e)}},{key:"getControlCount",value:function(e){return this.doc.api.getControlCount(this.doc.id,e)}},{key:"setFieldsValue",value:function(e,t,n){var i=this;return this.doc.api.setFieldsValue(this.doc.id,e,t).then((function(e){n||i.doc.engine.eventEmitter.emit(le.formValueChanged)}))}},{key:"addTask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("function"!=typeof e)return Promise.resolve();if("jsInited"==this.state&&!t)return Promise.resolve(e());var n=this.queueTask.exec(e);return n.catch((function(e){return console.error(e)})),n}},{key:"addCO",value:function(e){var t=e.getName(),n=this.formInfo.calculationOrder;-1==n.indexOf(t)&&(n.push(t),this.doc.api.setCO(this.doc.id,n),this.doc.engine.eventEmitter.emit(le.COChange,n))}},{key:"countField",value:function(e,t,n){var i=0;return this.fields.forEach((function(r){t?r.isDateType()&&i++:n?r.isImageType()&&i++:r.isDateType()||r.isImageType()||r.getType()!==e||i++})),i}},{key:"afterRemovePage",value:function(e){this.fields=this.fields.filter((function(t){var n=t.controls.filter((function(t){var n=t.getWidget();return(n&&n.getPage().getIndex())!==e}));return n.length>0&&(t.controls=n,!0)})),this.updateFieldsNameMap()}},{key:"updateFieldsNameMap",value:function(){var e=this;this.fieldsNameMap={},this.fields.forEach((function(t){e.fieldsNameMap[t.getName()]=t}))}},{key:"afterMovePage",value:function(e,t){var n=!0;e>t&&(n=!1),this.fields.forEach((function(i){i.controls.forEach((function(i){var r=i.info.pageIndex;r!=e?n?r>e&&r<=t&&(i.info.pageIndex-=1):r>=t&&r<e&&(i.info.pageIndex+=1):i.info.pageIndex=t}))}))}},{key:"afterInsertPage",value:function(e){var t=this;return this.doc.pageCache[e].getAnnotTree().then((function(n){n.forEach((function(e){if("widget"==e.getType()){var n=e.getField();if(n){var i=t.fields.findIndex((function(e){return e.getName()==n.getName()}));n.updateControls(n.info.controls),i>-1?t.fields.splice(i,1,n):t.fields.push(n)}}})),t.fields.forEach((function(t){t.controls.forEach((function(t){t.info.pageIndex>=e&&(t.info.pageIndex+=1)}))})),t.updateFieldsNameMap()}))}},{key:"afterImportPages",value:function(e,t){this.fields.forEach((function(n){n.controls.forEach((function(n){n.info.pageIndex>=e&&(n.info.pageIndex+=t)}))}))}},{key:"copyControls",value:function(e,t,n){var i=this;return this.checkDesignPerm(),this.doc.api.copyControls(this.doc.id,0,t.getIndex(),n).then((function(e){return Promise.all(e.map((function(e){var t=i.getField(e.fieldName);return t.updateControls(e.controlJsons),delete t.engineActions,i.doc.api.getAAJson(i.doc.id,e.fieldName).then((function(e){return t.info.AA=e}))})))})).then((function(e){return t.getUnloadedAnnots()})).then((function(e){return i.doc.engine.eventEmitter.emit(le.annotationAdd,e,t),e}))}},{key:"duplicateWidget",value:function(e,t,n,i){var r=this;return Promise.all(e.map((function(e){return r.doc.getPageByIndex(e)}))).then((function(e){return e.filter((function(e){return!e.isVirtual()})).map((function(e){return e.getIndex()}))})).then((function(e){if(!(e.length<1))return r.doc.api.duplicateWidget(r.doc.id,e,t,n).then((function(e){var n=r.getField(t);return n.updateControls(e),delete n.engineActions,r.doc.api.getAAJson(r.doc.id,t).then((function(e){return n.info.AA=e}))})).then((function(e){return Promise.all(i.map((function(e){return r.doc.getPageByIndex(e).then((function(e){return e.getUnloadedAnnots()}))})))})).then((function(e){e.forEach((function(e){e.length>0&&r.doc.engine.eventEmitter.emit(le.annotationAdd,e,e[0].getPage())}))}))}))}},{key:"duplicateField",value:function(e,t,n,i,r){var o=this;if(this.getField(e).controls.length>1)return Promise.reject(new Error("More than one copies appeared."));var a=r.shift(),s=t.getPage();return t.setRect(a).then((function(u){if(t.updateUI({type:"rect",value:a}),r.length<1)return Promise.resolve();o.doc.api.duplicateField(o.doc.id,e,s.getIndex(),t.getObjNum(),n,i,r).then((function(e){return Promise.all([t.update(),e])})).then((function(e){var t=(0,E._)(e,2),n=(t[0],t[1]);return o.reloadForm(n)})).then((function(e){return s.getUnloadedAnnots()})).then((function(e){o.doc.engine.eventEmitter.emit(le.annotationAdd,e,e[0].getPage())}))}))}},{key:"duplicateNewFields",value:function(e,t,n){var i=this;return(0,_._)((function(){var r,o,a;return(0,F.Jh)(this,(function(s){switch(s.label){case 0:return r=t.shift(),[4,e.setRect(r)];case 1:s.sent(),o=0,s.label=2;case 2:return o<t.length?(a=i.autoGenerateFieldName(e).newFieldName,[4,i.createFieldByCopyControl({pageIndex:n,newRect:t[o],srcWidget:e,newFieldName:a})]):[3,5];case 3:s.sent(),s.label=4;case 4:return o++,[3,2];case 5:return[2,Promise.resolve()]}}))}))()}},{key:"autoGenerateFieldName",value:function(e){var t=e.info.fieldType,n=6===t&&e.formControl.field&&e.formControl.field.info&&e.formControl.field.info.AA&&e.formControl.field.info.AA[St.keyStroke]&&e.formControl.field.info.AA[St.keyStroke].javascript&&e.formControl.field.info.AA[St.keyStroke].javascript.indexOf("Date")>-1,i=1===t&&e.info.iconFit&&e.info.iconFit.isProportionalScaling,r="";r=n?pdfui.pdfViewer.i18n.t("form-designer:prefix.9"):i?pdfui.pdfViewer.i18n.t("form-designer:prefix.8"):pdfui.pdfViewer.i18n.t("form-designer:prefix."+t);var o="",a=this.countField(t,n,i),s="";do{s=r+a,o=this.fieldsNameMap[s],a+=1}while(o);return{newFieldName:s,fieldTypeName:r}}},{key:"moveControl",value:function(e,t,n){var i=this,r=this.getField(e).controls.map((function(e){return e.getWidget()}));return r.length>1?this.doc.api.moveControl(this.doc.id,n,e,t).then((function(e){var t=r.filter((function(e){return e})).map((function(e){return e.update()}));return t.push(e),Promise.all(t)})).then((function(e){return i.reloadForm(e[e.length-1])})).then((function(){return r.map((function(e){return e.updateUI({type:"rename"})}))})):this.renameField(e,t)}},{key:"getCO",value:function(){return this.formInfo&&this.formInfo.calculationOrder||[]}},{key:"setCO",value:function(e){return this.formInfo.calculationOrder=e,this.doc.engine.eventEmitter.emit(le.COChange,e),this.doc.api.setCO(this.doc.id,e)}},{key:"removeFieldInCO",value:function(e){var t=this.formInfo.calculationOrder,n=t.indexOf(e);-1!=n&&(t.splice(n,1),this.doc.engine.eventEmitter.emit(le.COChange,t),this.doc.api.setCO(this.doc.id,t))}}]),e}();function Ky(e,t,n){var i;for(i=0;i<t.length&&!(t.charCodeAt(i)>255);i++);if(i!==t.length)for(e.push(254),e.push(255),i=0;i<t.length;i++){var r=t.charCodeAt(i)>>8;!n||40!=r&&41!=r||e.push(92),e.push(r),r=255&t.charCodeAt(i),!n||40!=r&&41!=r||e.push(92),e.push(255&t.charCodeAt(i))}else for(i=0;i<t.length;i++){var o=t.charCodeAt(i);!n||40!=o&&41!=o||e.push(92),e.push(o)}}function $y(e){if(254==e.charCodeAt(0)&&255==e.charCodeAt(1)){for(var t="",n=2;n<e.length;n+=2)t+=String.fromCharCode((e.charCodeAt(n)<<8)+e.charCodeAt(n+1));return t}return e}var zy={alignment:0,alternateName:"",controls:[{index:0,isChecked:!1,isDefaultChecked:!1,isEmpty:!1,objectNumber:-1}],DA:{flags:3,fontName:"FoxitSansOTF",textColor:4278190080,textSize:0},defaultValue:"",flag:0,mappingName:"",maxLength:0,name:"",options:[],topVisibleIndex:0,type:1,value:"",isEmpty:!1,AA:{}},Gy=function(e,t){var n=JSON.parse(JSON.stringify(zy));return n.defaultValue=n.value=2==t||3==t?"Off":"",n.name=e,n.type=t,n};const Jy=qy;var Xy=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,P._)(this,e),this.id=(0,j.getUniqueId)("doc_text_search"),this.pattern=n,this.flags=i,this.doc=t,this.api=t.api,this.startPageIndex=0,this.currentPageIndex=0,this.endPageIndex=t.getPageCount()-1,this.annotTextSearchArr=[],this.currentAnnotTextSearch=null,t.docTextSearchIdMap[this.id]=this}return(0,A._)(e,[{key:"getId",value:function(){return this.id}},{key:"findNext",value:function(){var e=this;this.startPrev=!1;var t=null;return this.getCurrentPageTextSearch().then((function(e){return t=e,e.findNext()})).then((function(n){if(n)return n;if((0,D._)(t,co)){var i=e.annotTextSearchArr.findIndex((function(t){return t.id==e.currentAnnotTextSearch.id}));return i>-1?i==e.annotTextSearchArr.length-1?(e.currentAnnotTextSearch=null,e.startPageTextSearch=!0):(e.currentAnnotTextSearch=e.annotTextSearchArr[i+1],e.startPageTextSearch=!1):(e.currentAnnotTextSearch=null,e.startPageTextSearch=!0),e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.findNext()}return e.currentPageIndex<e.endPageIndex?(e.currentPageIndex++,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.startPageTextSearch=!1,e.findNext()):(e.currentPageIndex=e.startPageIndex,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.startPageTextSearch=!1,null)}))}},{key:"findNexts",value:function(){var e=this;return this.startPrev=!1,this.getCurrentPageTextSearch().then((function(t){return new Promise((function(n,i){e.iterationPageFindNext(t,[],(function(r){if(r.length){var o=e.currentPageIndex<e.endPageIndex;if((0,D._)(t,co)){var a=e.annotTextSearchArr.findIndex((function(t){return t.id==e.currentAnnotTextSearch.id}));a>-1?a+1>=e.annotTextSearchArr.length?(e.currentAnnotTextSearch=null,e.startPageTextSearch=!0):(e.currentAnnotTextSearch=e.annotTextSearchArr[a+1],e.startPageTextSearch=!1):e.startPageTextSearch=!0,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null}return(0,D._)(t,Sy)&&(e.currentPageIndex<e.endPageIndex?(e.currentPageIndex++,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null):(e.currentPageIndex=e.startPageIndex,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null),e.currentAnnotTextSearch=null,e.startPageTextSearch=!1),n({hasMore:o,list:r})}if((0,D._)(t,Sy))return e.currentPageIndex<e.endPageIndex?(e.currentPageIndex++,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.currentAnnotTextSearch=null,e.startPageTextSearch=!1,e.findNexts().then((function(e){n(e)}),(function(){i()}))):(e.currentPageIndex=e.startPageIndex,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,n({hasMore:!1,list:r}));if((0,D._)(t,co)){var s=e.annotTextSearchArr.findIndex((function(t){return t.id==e.currentAnnotTextSearch.id}));return s>-1?s+1>=e.annotTextSearchArr.length?(e.currentAnnotTextSearch=null,e.startPageTextSearch=!0):(e.currentAnnotTextSearch=e.annotTextSearchArr[s+1],e.startPageTextSearch=!1):e.startPageTextSearch=!0,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.findNexts().then((function(e){n(e)}),(function(){i()}))}}))}))})).then((function(e){return e}))}},{key:"iterationPageFindNext",value:function(e,t,n){var i=this;e.findNext().then((function(r){if(!r)return n(t);t.push(r),i.iterationPageFindNext(e,t,n)}))}},{key:"findPrev",value:function(){var e=this;this.startPrev=!0;var t=null;return this.getCurrentPageTextSearch().then((function(e){return t=e,e.findPrev()})).then((function(n){if(n)return n;if((0,D._)(t,co)){var i=e.annotTextSearchArr.findIndex((function(t){return t.id==e.currentAnnotTextSearch.id}));return i>-1?0==i?(e.currentAnnotTextSearch=null,e.startPageTextSearch=!0):(e.currentAnnotTextSearch=e.annotTextSearchArr[i-1],e.startPageTextSearch=!1):(e.currentAnnotTextSearch=null,e.startPageTextSearch=!0),e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.findPrev()}return e.currentPageIndex>e.startPageIndex?(e.currentPageIndex--,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.startPageTextSearch=!1,e.findPrev()):(e.currentPageIndex=e.endPageIndex,e.currentPageTextSearch.destroy(),e.currentPageTextSearch=null,e.startPageTextSearch=!1,null)}))}},{key:"getCurrentPageTextSearch",value:function(){var e=this;return this.currentPageTextSearch?Promise.resolve(this.currentPageTextSearch):this.currentPageTextSearchPromise?this.currentPageTextSearchPromise:this.currentPageTextSearchPromise=this.doc.getPageByIndex(this.currentPageIndex).then((function(t){return e.currentAnnotTextSearch?Promise.resolve(e.currentAnnotTextSearch):e.startPageTextSearch?t.getTextSearch(e.pattern,e.flags):t.getAnnots().then((function(n){var i=[];return n.forEach((function(t){"widget"==t.getType()&&i.push(t.getTextSearch(e.pattern,e.flags))})),i.length?Promise.all(i).then((function(t){return e.annotTextSearchArr=t,e.currentAnnotTextSearch=e.startPrev?t[t.length-1]:t[0],Promise.resolve(e.currentAnnotTextSearch)})):t.getTextSearch(e.pattern,e.flags)}))})).then((function(t){return e.currentPageTextSearch=t,e.currentPageTextSearchPromise=null,t}))}},{key:"setStartPageIndex",value:function(e){this.startPageIndex=e}},{key:"setCurrentPageIndex",value:function(e){e<this.startPageIndex&&(e=this.startPageIndex),e>this.endPageIndex&&(e=this.endPageIndex),this.currentPageIndex!==e&&this.destroy(),this.currentPageIndex=e}},{key:"setEndPageIndex",value:function(e){this.endPageIndex=e}},{key:"destroy",value:function(){var e=this;this.currentPageTextSearch&&this.currentPageTextSearch.destroy(),this.currentPageTextSearch=null,this.currentPageTextSearchPromise&&this.currentPageTextSearchPromise.then((function(t){t.destroy(),e.currentPageTextSearch=null})),this.doc.docTextSearchIdMap[this.id]=null,this.currentPageTextSearchPromise=null}}]),e}();const Zy={None:"none",RC4:"rc4",AES128:"aes128",AES256:"aes256"};var Qy,ek,tk='<?xml version="1.0" encoding="UTF-8"?>\n<xfdf xmlns="http://ns.adobe.com/xfdf/" xml:space="preserve">\n<f href="a.pdf"/><fields>\n',nk='</fields>\n<ids original="abcdef" modified="0123456"/>\n</xfdf>';function ik(e){if(!e)return"";if('"'!==e[0])return rk(e);for(var t='"',n=1;n<e.length;n++)n!==e.length-1||'"'!==e[n]?'"'!=e[n]&&(t+=e[n]):t+='"';return rk(t)}function rk(e){return O()("<div/>").text(e).html().replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function ok(e,t){var n=Object.keys(e).map((function(n){var i=e[n],r=t.getField(n),o=rk(n);if(r&&r.type===gn.ListBox){var a=(i||"").split(/\r\n/);return'<field name="'.concat(o,'">\n            ').concat(a.map((function(e,t){return"<value>".concat(ik(e),"</value>")})).join(""),"\n            </field>\n            ")}return'<field name="'.concat(o,'">\n                <value>').concat(ik(i),"</value>\n            </field>")})).join("\r\n"),i="".concat(tk).concat(n).concat(nk);return i=i.replace(/\&nbsp;/g,"&#160;"),new Blob([i],{type:"application/vnd.xfdf"})}function ak(e){"string"==typeof(e=e.replace(/\&nbsp;/g,"&#160;"))&&(e=O().parseXML(e));var t="";return O()(e).children().children().each((function(){var e,n,i,r,o=(e=O()(this),n="xfdf:original",i="",e&&void 0!==e.attr(n)&&(r=e.attr(n),i=r.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/\r/g,"").replace(/\n/g," ")),i);o&&""!==o&&0!==o.length||(o=this.tagName);var a=O()(this).html();a.startsWith("<value>")&&a.endsWith("</value>")?t+='<field name="'.concat(o,'">').concat(a,"</field>"):t+='<field name="'.concat(o,'"><value>').concat(a,"</value></field>")})),new Blob([tk+t+nk],{type:"application/vnd.xfdf"})}!function(e){e[e.FIRST_CHILD=0]="FIRST_CHILD",e[e.LAST_CHILD=1]="LAST_CHILD",e[e.PREVIOUS_SIBLING=2]="PREVIOUS_SIBLING",e[e.NEXT_SIBLING=3]="NEXT_SIBLING",e[e.FIRST_SIBLING=4]="FIRST_SIBLING",e[e.LAST_SIBLING=5]="LAST_SIBLING"}(Qy||(Qy={})),function(e){e.ZoomFitBBox="ZoomFitBBox",e.ZoomFitBHorz="ZoomFitBHorz",e.ZoomFitBVert="ZoomFitBVert",e.ZoomFitHorz="ZoomFitHorz",e.ZoomFitVert="ZoomFitVert",e.ZoomFitPage="ZoomFitPage",e.ZoomFitRect="ZoomFitRect",e.ZoomXYZ="ZoomXYZ"}(ek||(ek={}));var sk=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"doc",void 0),this.doc=t}return(0,A._)(e,[{key:"emitEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;(r=this.doc.engine.eventEmitter).emit.apply(r,[e].concat((0,I._)(n)))}},{key:"getBookmarkChildren",value:function(e){return this.doc.api.getBookmarkChildren({path:"jr/doc"},this.doc.id,e)}},{key:"insertBookmark",value:function(e){var t=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return t.assertPermission(),t.assertRelationship(e.relationship),t.assertPageIndex(e.destination.pageIndex),[4,t.doc.api.insertBookmark({path:"jr/doc"},t.doc.id,e)];case 1:return[2,n.sent()]}}))}))()}},{key:"getBookmarkData",value:function(e){return this.doc.api.getBookmarkData({path:"jr/doc"},this.doc.id,e)}},{key:"getProperties",value:function(e){return this.doc.api.getBookmarkProperties({path:"jr/doc"},this.doc.id,e)}},{key:"setProperties",value:function(e,t){var n=this;return(0,_._)((function(){var i;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return n.assertPermission(),void 0!==(i=t.color)&&(i=(0,j.colorConvertor)(i,"int")),[4,n.doc.api.setBookmarkProperty(n.doc.id,e,t)];case 1:return[2,r.sent()]}}))}))()}},{key:"remove",value:function(e){var t=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return t.assertPermission(),[4,t.doc.api.removeBookmark(t.doc.id,e)];case 1:return[2,n.sent()]}}))}))()}},{key:"moveTo",value:function(e){var t=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return t.assertPermission(),[4,t.doc.api.moveBookmark(t.doc.id,e.srcId,e.destId,e.relationship)];case 1:return n.sent(),[2]}}))}))()}},{key:"setDestination",value:function(e,t){var n=this;return(0,_._)((function(){var i;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.doc.api.setBookmarkDestination(n.doc.id,e,t)];case 1:return(i=r.sent())?[2,n.doc.engine.actionFactory.createAction(i,n.doc,n.doc.api,n.doc.engine.eventEmitter,n)]:[2]}}))}))()}},{key:"getDestination",value:function(e){var t=this;return(0,_._)((function(){var n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.doc.api.getBookmarkDestination(t.doc.id,e)];case 1:return(n=i.sent())?[2,t.doc.engine.actionFactory.createAction(n,t.doc,t.doc.api,t.doc.engine.eventEmitter,t)]:[2]}}))}))()}},{key:"getAction",value:function(e){var t=this;return(0,_._)((function(){var n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.doc.api.getBookmarkAction(t.doc.id,e)];case 1:return(n=i.sent())?[2,t.doc.engine.actionFactory.createAction(n,t.doc,t.doc.api,t.doc.engine.eventEmitter,t)]:[2]}}))}))()}},{key:"setAction",value:function(e,t){return this.doc.api.setBookmarkAction(this.doc.getId(),e,t)}},{key:"assertPermission",value:function(){if(!this.doc.checkPermission(Qt.assemble))throw new Error("Invalid operation on Bookmark, currently does not have editing permissions.")}},{key:"assertRelationship",value:function(e){switch(e){case 0:case 4:case 1:case 5:case 3:case 2:return;default:throw new Error("Invalid relationship value: ".concat(e,"."))}}},{key:"assertPageIndex",value:function(e){var t=this.doc.getPageCount();if(!(e>=0&&e<t))throw new Error("Invalid page index: ".concat(e))}}]),e}(),uk=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;for(var o in(0,P._)(this,e),this.engine=t,this.api=t.api,this.docId=n.id,this.doc=n,this.parent=r,i)if("children"==o){this.children=[];for(var a=0;a<i[o].length;a++)this.children.push(new e(t,n,i[o][a],this))}else this[o]=i[o]}return(0,A._)(e,[{key:"destroy",value:function(){this.engine=null,this.api=null,this.doc=null,this.parent=null,this.children.forEach((function(e){return e.destroy})),this.children=null}},{key:"insertBookmark",value:function(t,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(!this.doc.checkPermission(Qt.assemble))throw new Error("Permission error");if((o|5-o)<0)throw new Error("Wrong relationship: "+o);if((n|this.doc.getPageCount()-1-n)<0)throw new Error("Wrong pageIndex: "+n);var a=arguments[5],s=this,u=this.parent?this.parent.id:void 0,c=ek.ZoomXYZ;switch(a){case"fitWidth":c=ek.ZoomFitHorz,a=0;break;case"fitPage":case"fitHeight":c=ek.ZoomFitPage,a=0;break;case"fitVisible":c=ek.ZoomFitBHorz,a=0}return s.doc.api.insertBookmark({path:"jr/doc"},this.docId,{destId:this.id,destParentId:u,relationship:o,title:t,destination:{pageIndex:n,left:r,top:i,zoomMode:c,isOldVersion:!0,zoomFactor:a}}).then((function(t){if(t){var n=new e(s.doc.engine,s.doc,t,s);if(o===st.firstChild||o===st.lastChild)s.children.push(n);else{var i=s.parent;i.children=i.children||[],i.children.push(n)}return s.doc.bookmarkRoot=null,s.doc.engine.eventEmitter.emit(le.bookmarkAdded,n),n}return null}))}},{key:"addBookmarksFromStructureRoles",value:function(e,t){var n=this;return this.doc.api.addBookmarksFromStructureRoles(this.docId,e,t).then((function(e){return n.engine.eventEmitter.emit(le.structureBookmarkAdded),e}))}},{key:"setProperty",value:function(e){var t=this,n=!(arguments.length>1||void 0!==arguments[1])||arguments[1];if(!this.doc.checkPermission(Qt.assemble))throw new Error("Permission error");void 0!==e.color&&(e.color=(0,j.colorConvertor)(e.color,"int"));var i=this;return this.doc.api.setBookmarkProperty(this.docId,this.id,e).then((function(e){if(e){for(var r in e)"children"!==r&&(i[r]=e[r]);n&&i.doc.engine.eventEmitter.emit(le.bookmarkUpdated,i)}return t}))}},{key:"remove",value:function(){var e=this;if(!this.doc.checkPermission(Qt.assemble))throw new Error("Permission error");var t=this;return this.doc.api.removeBookmark(this.docId,this.id,!0).then((function(n){if(n&&(t.doc.engine.eventEmitter.emit(le.bookmarkRemoved,t.id),t.parent)){for(var i=t.parent,r=0;r<(i.children||[]).length;r++)if(t.id==i.children[r].id){i.children.splice(r,1);break}e.destroy()}return n}))}},{key:"moveTo",value:function(e,t){var n=this;return this.doc.api.moveBookmark(this.docId,this.id,e.id,t).then((function(e){n.doc.bookmarkRoot=null,n.doc.engine.eventEmitter.emit(le.bookmarkUpdated,n)}))}},{key:"getDestination",value:function(){var e=this;return this.doc.api.getBookmarkDestination(this.docId,this.id).then((function(t){if(t)return e.doc.engine.actionFactory.createAction(t,e.doc,e.doc.api,e.engine.eventEmitter,e)}))}},{key:"setDestination",value:function(e){var t=this;if(!e)throw new Error("No GotoAction!");return this.doc.api.setBookmarkDestination(this.docId,this.id,e.info).then((function(e){if(e)return t.doc.engine.actionFactory.createAction(e,t.doc,t.doc.api,t.engine.eventEmitter,t)}))}},{key:"getAction",value:function(){var e=this;return this.doc.api.getBookmarkAction(this.docId,this.id).then((function(t){if(t)return e.doc.engine.actionFactory.createAction(t,e.doc,e.doc.api,e.engine.eventEmitter,e)}))}},{key:"setAction",value:function(e){if(!e)throw new Error("No Action!");return this.doc.api.setBookmarkAction(this.doc.getId(),this.id,e.info)}},{key:"removeAction",value:function(e,t){return this.doc.api.removeBookmarkAction(this.doc.getId(),this.id,t?t.info:null)}},{key:"updateBookmark",value:function(t){for(var n in t)if("children"==n){this.children=[];for(var i=0;i<t[n].length;i++)this.children.push(new e(this.engine,this.doc,t[n][i],this))}else this[n]=t[n]}},{key:"moveAction",value:function(e){return this.doc.api.moveBookmarkAction(this.doc.getId(),this.id,e)}}]),e}();const ck=uk;var lk,dk=function(){function e(t){(0,P._)(this,e),t?(this.json=t,this.empty=!1):(this.json={contentFormats:{},margin:{left:72,right:36,top:72,bottom:36},textSize:12,textColor:4278190080,hasTextShrinked:!1,hasFixedSized:!1,startPageNumber:1,underline:!1},this.empty=!0)}return(0,A._)(e,[{key:"destroy",value:function(){this.json=null}},{key:"isEmpty",value:function(){return this.empty}},{key:"getContent",value:function(e){return this.json.contentFormats[e]||this.json.contents[e]}},{key:"setFont",value:function(e){this.json.fontId=e,this.json.font=e}},{key:"setContentFormat",value:function(e,t){this.empty=!1,this.json.contentFormats[e]=t}},{key:"setRange",value:function(e){if(e.start<1||e.end<1)throw new Error("page range is wrong.");if(e.filter<0||e.filter>2)throw new Error("Wrong filter.");this.json.range=e}},{key:"setMargin",value:function(e){this.json.margin=e}},{key:"setTextSize",value:function(e){this.json.textSize=e}},{key:"setTextColor",value:function(e){this.json.textColor=e}},{key:"enableTextShrinked",value:function(e){this.json.hasTextShrinked=e}},{key:"enableFixedSizedForPrint",value:function(e){this.json.hasFixedSized=e}},{key:"setStartDisplayingPage",value:function(e){this.json.startPageNumber=e}},{key:"setUnderline",value:function(e){this.json.underline=e}},{key:"getUnderline",value:function(){return this.json.underline}}]),e}();!function(e){e[e.folder=1]="folder",e[e.file=2]="file"}(lk||(lk={}));var hk=function(){function e(t){(0,P._)(this,e),this.nodeData=t}return(0,A._)(e,[{key:"getNodeType",value:function(){return this.type}}]),e}(),fk=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,r)).type=lk.folder,o.engine=e,o.doc=i,o.api=e.api,o.nodeHandle=r.handle,o.name=r.fileName,o.subNodes=[],o}return(0,A._)(n,[{key:"getSortedSubNodes",value:function(){var e=this,t=this.doc;return this.api.getPortfolioSubNodes(t.getId(),this.nodeHandle).then((function(i){return e.subNodes=[],i.forEach((function(i){if(i.type===lk.folder){var r=new n(e.engine,t,i);e.subNodes.push(r)}if(i.type===lk.file){var o=new gk(e.engine,t,i);e.subNodes.push(o)}})),e.subNodes}))}},{key:"addFiles",value:function(e,t){return this.api.portfolioAddFiles(this.doc.getId(),e,t,this.nodeHandle)}},{key:"createFolder",value:function(e){var t=this;return this.api.portfolioCreateFolder(this.doc.getId(),e,this.nodeHandle).then((function(e){return new n(t.engine,t.doc,e)}))}},{key:"removeSubNodes",value:function(e){return this.api.portfolioRemoveSubNodes(this.doc.getId(),this.nodeHandle,e)}},{key:"changeSubNodesOrder",value:function(e,t){return this.api.changePortfolioSubNodesOrder(this.doc.getId(),this.nodeHandle,e,t)}},{key:"moveSubNodeToSubFolderNode",value:function(e,t){return this.api.portfolioMoveSubNodeToSubFolderNode(this.doc.getId(),this.nodeHandle,e,t)}},{key:"hasSameNameSubNode",value:function(e,t){return this.api.portfolioHasSameNameSubNode(this.doc.getId(),e,t,this.nodeHandle)}},{key:"getName",value:function(){return this.name}},{key:"getDescription",value:function(){return this.description}}]),n}(hk),gk=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;return(0,P._)(this,n),(o=t.call(this,r)).type=lk.file,o.engine=e,o.doc=i,o.api=e.api,o.nodeHandle=r.handle,o.keyName=r.keyName,o}return(0,A._)(n,[{key:"getKeyName",value:function(){return this.keyName}},{key:"getFileStream",value:function(){var e=this.doc,t=[];return this.api.getPortfolioFileStream(e.getId(),this.nodeHandle,(function(e){var n=e.arrayBuffer,i=e.blob;i?t=i:t.push(n)})).then((function(){return Array.isArray(t)?new Blob(t,{type:"application/octet-stream"}):t}))}}]),n}(hk),vk=function(){function e(t,n){(0,P._)(this,e),this.engine=t,this.doc=n,this.api=t.api,this.root=null,this.activedPDFNode=[]}return(0,A._)(e,[{key:"getInfo",value:function(){return this.api.getPortfolioInfo(this.doc.getId())}},{key:"setInfo",value:function(e){return this.api.setPortfolioInfo(this.doc.getId(),e)}},{key:"regenerateTOC",value:function(e){var t=this;return this.api.portfolioRegenerateTOC(this.doc.getId(),e).then((function(e){var n,i=e||{},r=i.oldIndexes,o=i.newPages;if(r.length){t.doc.info.pageCount-=r.length;var a=[],s=[];r.forEach((function(e){var n=t.doc.pageCache[e];a.push(e),t.doc.pageCache.splice(e,1),n&&s.push(n.info.objectNumber)})),t.engine.eventEmitter.emit(le.pagesRemoved,a,s)}t.doc.info.pageCount+=o.length;var u=[];o.forEach((function(e){var n=new jy(e,t.doc);u.push(n)})),(n=t.doc.pageCache).push.apply(n,(0,I._)(u)),t.doc.updatePageIndex(o[0].index,t.doc.info.pageCount),t.doc.updatePageLabelsByAction("insertPages",[o[0].index,u.length]),t.engine.eventEmitter.emit(le.insertPages,u)}))}},{key:"hasSameNameSubNode",value:function(e,t,n){return this.api.portfolioHasSameNameSubNode(this.doc.getId(),e,t,n)}},{key:"getStream",value:function(e){return this.api.getPortfolioStream(this.doc.getId(),e)}},{key:"getTreeNode",value:function(){var e=this;return this.api.getPortfolioTreeNode(this.doc.getId()).then((function(t){return e.treeNode=t,t.type===lk.folder&&(e.root=new fk(e.engine,e.doc,t)),t.type===lk.file&&(e.root=new gk(e.engine,e.doc,t)),Promise.resolve(e.root)}))}},{key:"getInitialNodePath",value:function(){var e=this;return this.api.getPortfolioInitialNodePath(this.doc.getId()).then((function(t){if(!Array.isArray(t))return[];var n=t.map((function(t){return t.type===lk.folder?new fk(e.engine,e.doc,t):t.type===lk.file?new gk(e.engine,e.doc,t):void 0}));return e.root=n[0],n}))}},{key:"sendSortFolioParam",value:function(e,t){return this.api.sendSortFolioParam(this.doc.getId(),e,t).then((function(e){if(e)return!0}))}},{key:"getFolioNodePDFDoc",value:function(){var e=this;return this.api.getFolioNodePDFDoc(this.doc.getId()).then((function(t){for(var n=[],i=0;i<=t.length-1;i++)n.push(new ab(t[i],e.engine,{}));return n}))}},{key:"recordPDFFileByPortFolioNode",value:function(e){var t=this,n=this.doc,i=[];for(var r in e)i.push(e[r].handle);return this.api.recordPDFFileByPortFolioNode(n.getId(),i).then((function(e){var n=e.filter((function(e){return-1===e.indexOf("password")}));if(0===e.filter((function(e){return-1!==e.indexOf("password")})).length){for(var i=[],r=0;r<=n.length-1;r++)i.push(new ab(n[r],t.engine,{}));t.activedPDFNode=i}else t.activedPDFNode=["password"]}))}},{key:"getPDFFileByPortFolioNode",value:function(e){var t=this;return(0,_._)((function(){var n,i;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:if(n=[],0==e.length)return[2,[]];for(i=0;i<e.length;i++)("1"==e[i].type||"2"==e[i].type&&".pdf"===e[i].FileName.substr(-4).toLowerCase())&&n.push(e[i]);return 0==n.length?[2,[]]:[4,t.recordPDFFileByPortFolioNode(n)];case 1:return r.sent(),[2,t.activedPDFNode]}}))}))()}},{key:"getActivedPDFFileByPortFolioNode",value:function(){return this.activedPDFNode}}]),e}();const pk=function(e,t){return new Proxy(t,{doc:e,api:e.api,get:function(e,t){var n=this;if("then"!==t)return function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return t in e?e[t]:n.api.changeEditingProperty(n.doc.id,t,r)}}})};function mk(){}mk.prototype=de;const yk=Object.assign(new mk,{addTextMarkupSuccess:"add-text-markup-success",fullscreenchange:"fullscreenchange",appendCommentListGroup:"apppend-commentlist-group",destroyCommentListGroup:"destroy-commentlist-group",appendCommentListComment:"append-commentlist-comment",appendCommentListReply:"append-commentlist-reply",destroyCommentListComment:"destroy-commentlist-comment",destroyCommentListReply:"destroy-commentlist-reply",InkImageSelected:"ink-image-selected",applicationDestroyed:"uiextension-destroyed",addReplySuccess:"add-reply-success",deleteReplySuccess:"delete-reply-success",addActionSuccess:"add-action-success",addContentSuccess:"add-content-success",markRedactionSuccess:"mark-redaction-success",addReviewStateSuccess:"add-review-state-success",addMarkedStateSuccess:"add-marked-state-success",addonLoaded:"pdfui-init-process-addon-loaded",initializationCompleted:"pdfui-intialization-completed",commentGroupAnnotationsUpdated:"pdfui-comment-group-annotations-updated",bookmarkSelected:"bookmark-selected",stampSelectedChange:"stampSelectedChange",languageChange:"languageChange",ribbonLoadFinish:"ribbonLoadFinish",editPropertiesAction:"editPropertiesAction",loupeLocked:"loupeLocked",loupeScaleChange:"loupeScaleChange",loupeRedBoxMoved:"loupeRedBoxMoved",enterReadMode:"enterReadMode",exitReadMode:"exitReadMode",toggleStatusBar:"toggleStatusBar",statusBarChange:"statusBarChange",switchNavigationPanel:"switchNavigationPanel",toggleNavigationPanels:"toggleNavigationPanels",resetNavigationPanels:"resetNavigationPanels",toggleAutoScroll:"toggleAutoScroll",changePortfolioLayout:"changePortfolioLayout",compareFilterChange:"compare-filter-change",undoRedoStoreChange:"undo-redo-store-change"});var kk=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"json",void 0),(0,J._)(this,"api",void 0),(0,J._)(this,"doc",void 0),this.json=n,this.api=t.api,this.doc=t}return(0,A._)(e,[{key:"update",value:function(e,t){for(var n=this,i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return this.api.changePEProperty(this.doc.id,e,t,r).then((function(e){var t=(0,E._)(e,2),i=t[0],r=t[1];return Promise.all([n.doc.getPageByIndex(i),r])})).then((function(e){var t=(0,E._)(e,2),i=t[0],r=t[1];return n.doc.engine.eventEmitter.emit(le.graphicsUpdated,i),n.api.handlePageEditorEvent(n.doc.id,"GetUndoManager",void 0,!1).then((function(e){n.doc.engine.eventEmitter.emit(yk.undoRedoStoreChange,e,"pageEditor",!1)})),r}))}},{key:"getHeight",value:function(){return this.json.height}},{key:"setHeight",value:function(e){return this.json.height=e,this.update("SetHeight",0,e)}},{key:"setWidth",value:function(e){return this.json.height=e,this.update("SetWidth",0,e)}},{key:"getWidth",value:function(){return this.json.width}},{key:"getOpacity",value:function(){return this.json.opacity}},{key:"setOpacity",value:function(e){return this.json.opacity=e,this.update("SetOpacity",0,e)}},{key:"rotate",value:function(e){return this.update("Rotate",0,e)}},{key:"flip",value:function(e){return this.update("Flip",0,e)}},{key:"align",value:function(e){return this.update("Align",0,{type:"GraphicsObjectAlignmentType",value:e})}},{key:"center",value:function(e){return this.update("Center",0,{type:"PageCenterAlignmentType",value:e})}},{key:"changeRenderingOrder",value:function(e){return this.update("ChangeRenderingOrder",0,{type:"RenderingOrder",value:e})}},{key:"canChangeRenderingOrder",value:function(e){return this.update("CanChangeRenderingOrder",0,{type:"RenderingOrder",value:e})}},{key:"getXPosition",value:function(){return this.json.xPosition}},{key:"setXPosition",value:function(e){return this.update("SetXPosition",0,e)}},{key:"getYPosition",value:function(){return this.json.yPosition}},{key:"setYPosition",value:function(e){return this.update("SetYPosition",0,e)}},{key:"shear",value:function(e){return e=e*Math.PI/180,this.update("Shear",0,e)}},{key:"move",value:function(e,t,n){return this.update("Move",0,{type:"EditorPage",value:e},{type:"PointF",value:t},n)}},{key:"distribute",value:function(e){return this.update("Distribute",0,e)}},{key:"size",value:function(e){return this.update("Size",0,e)}},{key:"scale",value:function(e,t){return this.update("Scale",0,e,t)}},{key:"clearClipPath",value:function(){return this.update("ClearClipPath",0)}},{key:"editClipPath",value:function(){return this.update("EditClipPath",0)}},{key:"addClipPath",value:function(e){return this.update("AddClipPath",0,{value:e})}},{key:"cut",value:function(){return this.update("Cut",0)}},{key:"copy",value:function(){return this.update("Copy",0)}},{key:"delete",value:function(){return this.update("Delete",0)}},{key:"getType",value:function(){return this.json.type}}]),e}(),bk=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"getFontName",value:function(){return this.json.fontName}},{key:"setFont",value:function(e,t,n,i){return this.update("SetFont",1,e,t,n,i)}},{key:"hasStroke",value:function(){var e=this.getTextMode();if(1==e||2==e)return!0}},{key:"hasFill",value:function(){var e=this.getTextMode();return!(0!=e&&2!=e&&!this.json.count)}},{key:"getFontSize",value:function(){return this.json.fontSize}},{key:"getFillColor",value:function(){return this.json.fillColor}},{key:"getStrokeColor",value:function(){return this.json.strokeColor}},{key:"setFontSize",value:function(e){return this.json.fontSize=e,this.update("SetFontSize",1,e)}},{key:"setColorSpace",value:function(e,t){this.json[e]=t}},{key:"setFillColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;return this.json.fillColor=e,void 0!==n&&(this.json.fillColor=n),this.update("SetFillColor",1,this.hasFill(),{type:"Color",value:e,space:this.json.fillColorSpace},t)}},{key:"setStrokeColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;return this.json.strokeColor=e,void 0!==n&&(this.json.strokeColor=n),this.update("SetStrokeColor",1,this.hasStroke(),{type:"Color",value:e,space:this.json.strokeColorSpace},t)}},{key:"getHorizontalScale",value:function(){return this.json.horizontalScale}},{key:"getCharSpace",value:function(){return this.json.charSpace}},{key:"getWordSpace",value:function(){return this.json.wordSpace}},{key:"canRemoveTextKerning",value:function(){return this.json.canRemoveTextKerning}},{key:"canMergeText",value:function(){return this.json.canMergeText}},{key:"canSplitText",value:function(){return this.json.canSplitText}},{key:"canText2Path",value:function(){return this.json.canText2Path}},{key:"isWordSpaceValid",value:function(){return this.json.isWordSpaceValid}},{key:"getFontIsBold",value:function(){return this.json.fontIsBold}},{key:"getFontIsItalic",value:function(){return this.json.fontIsItalic}},{key:"setHorizontalScale",value:function(e){return this.json.horizontalScale=e,this.update("SetHorizontalScale",1,e)}},{key:"setCharSpace",value:function(e){return this.json.charSpace=e,this.update("SetCharSpace",1,e)}},{key:"setWordSpace",value:function(e){return this.json.wordSpace=e,this.update("SetWordSpace",1,e)}},{key:"getTextMode",value:function(){return this.json.textMode}},{key:"setTextMode",value:function(e){return this.json.textMode=e,this.update("SetTextMode",1,e)}},{key:"removeTextKerning",value:function(){return this.update("RemoveTextKerning",1)}},{key:"mergeText",value:function(){return this.update("MergeText",1)}},{key:"splitText",value:function(e){return this.update("SplitText",1,{type:"Int32Array",value:e})}}]),n}(kk),wk=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"getLineWidth",value:function(){return this.json.lineWidth}},{key:"setLineWidth",value:function(e){return this.json.lineWidth=e,this.update("SetLineWidth",2,e)}},{key:"getMiterLimit",value:function(){return this.json.miterLimit}},{key:"setMiterLimit",value:function(e){return this.json.miterLimit=e,this.update("SetMiterLimit",2,e)}},{key:"getLineCap",value:function(){return this.json.lineCap}},{key:"setLineCap",value:function(e){return this.json.lineCap=e,this.update("SetLineCap",2,{type:"LineCap",value:e})}},{key:"getLineJoin",value:function(){return this.json.lineJoin}},{key:"setLineJoin",value:function(e){return this.json.lineJoin=e,this.update("SetLineJoin",2,{type:"LineJoin",value:e})}},{key:"getLineStyle",value:function(){return this.json.lineStyle}},{key:"setLineStyle",value:function(e){return this.json.lineStyle=e,this.update("SetLineStyle",2,{type:"FloatArray",value:e})}},{key:"getFillColor",value:function(){return this.json.fillColor}},{key:"setFillColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return"string"==typeof e&&(e="transparent"==e?0:parseInt(e.replace("#",""),16)),0==e&&1!=this.json.fillColorSpace&&(i=!1),this.json.fillColor=e,void 0!==n&&(this.json.fillColor=n),this.update("SetFillColor",2,i,{type:"Color",value:e,space:this.json.fillColorSpace},t)}},{key:"setColorSpace",value:function(e,t){this.json[e]=t}},{key:"getStrokeColor",value:function(){return this.json.strokeColor}},{key:"setStrokeColor",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this.json.strokeColor=e,void 0!==n&&(this.json.strokeColor=n),this.update("SetStrokeColor",2,i,{type:"Color",value:e,space:this.json.strokeColorSpace},t)}}]),n}(kk),_k=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"changeShadingColor",value:function(e){return this.update("ChangeShadingColor",4,e)}},{key:"changeColorUndoStart",value:function(){return this.update("ChangeColorUndoStart",4)}},{key:"changeColorUndoEnd",value:function(){return this.update("ChangeColorUndoEnd",4)}},{key:"changeColorUndoCancel",value:function(){return this.update("ChangeColorUndoCancel",4)}},{key:"editReferenceLine",value:function(){return this.update("EditReferenceLine",4)}},{key:"setGridientCursorColor",value:function(e){return this.update("SetGridientCursorColor",4,e)}},{key:"getGridientCursorColor",value:function(){return this.update("GetGridientCursorColor",4)}},{key:"getGridientColorAt",value:function(e){return this.update("GetGridientColorAt",4,e)}},{key:"getGridientCursorLocation",value:function(){return this.update("GetGridientCursorLocation",4)}},{key:"getGridientCursorIndex",value:function(){return this.update("GetGridientCursorIndex",4)}},{key:"setGradientColorShowRect",value:function(e){return this.update("SetGradientColorShowRect",4,{type:"RectF",value:e})}},{key:"addGradientCursorInfoBefore",value:function(e){return this.update("AddGradientCursorInfoBefore",4,{type:"RectF",value:e})}},{key:"addGradientCursorInfoExcute",value:function(e){return this.update("AddGradientCursorInfoExcute",4,{type:"RectF",value:e})}},{key:"addGradientCursorInfoEnd",value:function(){return this.update("AddGradientCursorInfoEnd",4)}},{key:"addGradientCursorInfoDblClk",value:function(e){return this.update("AddGradientCursorInfoDblClk",4,{type:"RectF",value:e})}},{key:"delGradientCursorInfo",value:function(){return this.update("DelGradientCursorInfo",4)}},{key:"defaultGradientDataInit",value:function(){return this.update("DefaultGradientDataInit",4)}},{key:"setGradientCurrentInfo",value:function(e){return this.update("SetGradientCurrentInfo",4,{type:"ShadingColorArray",value:e})}},{key:"getGradientColor",value:function(){return this.update("GetGradientColor",4)}},{key:"renderGridient",value:function(e,t){return this.update("RenderGridient",4,e,t)}}]),n}(kk),Pk=function(){function e(t){var n=this;(0,P._)(this,e),(0,J._)(this,"doc",void 0),(0,J._)(this,"notifier",void 0),(0,J._)(this,"workflow",void 0),(0,J._)(this,"filter",1),this.doc=t,t.api.registerWorkflow("out",this.workflow=function(e){var t=n.notifier[e.type];t&&t(e.msg)}),t.addDestroyHook((function(e){n.doc.api.unregisterWorkflow("out",n.workflow),n.destroy()}))}return(0,A._)(e,[{key:"createText",value:function(){return this.postOperation("CreateText")}},{key:"createPath",value:function(e){return this.postOperation("CreatePath",{type:"DrawType",value:e})}},{key:"createImage",value:function(e){var t=this;return this.postOperation("CreateImage",{type:"Image",value:e}).then((function(e){return t.postOperation("GetUndoManager",!1,!1).then((function(e){t.doc.engine.eventEmitter.emit(yk.undoRedoStoreChange,e,"pageEditor",!1)})),e})).then((function(e){return"number"==typeof e?t.doc.getPageByIndex(e).then((function(e){return t.doc.engine.eventEmitter.emit(le.graphicsUpdated,e),!0})):e}))}},{key:"createShading",value:function(e){return this.postOperation("CreateShading",{type:"DrawType",value:e})}},{key:"setObjectFilter",value:function(e){return this.filter=e,this.postOperation("SetGraphicsObjectFilter",{type:"GraphicsObjectFilter",value:e})}},{key:"text2Path",value:function(){return this.postOperation("Text2Path")}},{key:"endEdit",value:function(){return this.postOperation("EndEdit")}},{key:"startEdit",value:function(){return this.postOperation("StartEdit")}},{key:"setNotifier",value:function(e){this.notifier=e}},{key:"getActiveObject",value:function(){var e=this;return this.postOperation("GetGraphicsObjectUtils").then((function(t){return function(e,t){switch(t.type){case 1:return new bk(e,t);case 2:return new wk(e,t);case 3:case 5:return new kk(e,t);case 4:return new _k(e,t)}}(e.doc,t)}))}},{key:"getSelection",value:function(){return this.postOperation("GetSelection")}},{key:"hasSelection",value:function(){return this.postOperation("HasSelection")}},{key:"getEditingObject",value:function(){return this.postOperation("GetGraphicsObjectEditor").then((function(e){return e&&void 0!==e.type?e:void 0}))}},{key:"createEditingObjectProxy",value:function(e){return pk(this.doc,e)}},{key:"triggerPopMenuAction",value:function(e){var t=this.doc,n=t.id;return t.api.triggerPopMenuAction(n,e)}},{key:"postOperation",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o=this.doc,a=o.id;return(r=o.api).handlePageEditorEvent.apply(r,[a,e,void 0].concat((0,I._)(n)))}},{key:"destroy",value:function(){var e=this;["doc","workflow","notifier"].forEach((function(t){return e[t]=null}))}},{key:"copy",value:function(){return this.postOperation("Copy")}},{key:"canPaste",value:function(){return this.postOperation("CanPaste")}},{key:"paste",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return this.postOperation.apply(this,["Paste"].concat((0,I._)(n))).then((function(t){return e.doc.getPageByIndex(t)})).then((function(t){e.doc.engine.eventEmitter.emit(le.graphicsUpdated,t)}))}},{key:"undoRedo",value:function(e,t){var n=this;return this.postOperation("Undo",e,t).then((function(){n.postOperation("GetUndoManager",e,t).then((function(t){n.doc.engine.eventEmitter.emit(yk.undoRedoStoreChange,t,"pageEditor",e)}))}))}},{key:"getDefaultProperty",value:function(e){return this.postOperation("getDefaultProperty",e)}}]),e}(),Ak=function(){function e(t){var n=this;if((0,P._)(this,e),(0,J._)(this,"doc",void 0),(0,J._)(this,"notifier",void 0),(0,J._)(this,"workflow",void 0),t.touchup)return t.touchup;this.doc=t,t.api.registerWorkflow("touchup",this.workflow=function(e){var t=n.notifier[e.type];t&&t(e.msg)}),t.addDestroyHook((function(e){n.doc.api.unregisterWorkflow("touchup",n.workflow),n.destroy()})),t.touchup=this}return(0,A._)(e,[{key:"setNotifier",value:function(e){this.notifier=e}},{key:"handleEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o=this.doc;return(r=o.api).handleTouchUpEvent.apply(r,[o.getId(),e].concat((0,I._)(n))).then((function(e){return o.engine.eventEmitter.emit(yk.undoRedoStoreChange,e,"touchUp"),e}))}},{key:"handleFindReplaceEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r,o=this.doc;return(r=o.api).handleFindReplaceEvent.apply(r,[o.getId(),e].concat((0,I._)(n))).then((function(t){return"ReplaceAll"===e&&o.engine.eventEmitter.emit(yk.undoRedoStoreChange,t,"clearAll"),t}))}},{key:"triggerTUPopMenuAction",value:function(e,t){var n=this.doc,i=n.id;return n.api.triggerTUPopMenuAction(i,e,t)}},{key:"destroy",value:function(){var e=this;["doc","workflow","notifier"].forEach((function(t){return e[t]=null}))}}]),e}(),Sk=function(){function e(t,n){var i=this;(0,P._)(this,e),this.engine=t,this.api=t.api,this.docId=n.id,this.pdfDoc=n,this.getArticleListPromise=this.api.construct({path:"jr/doc/article",className:"PDFArticle",wasm:16},this.docId).then((function(e){return i.objId=e.objId,i.articleList=e.json}))}return(0,A._)(e,[{key:"destroy",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.getArticleListPromise];case 1:return t.sent(),[4,e.api.destroy({path:"jr/doc/article"},e.docId,e.objId)];case 2:return t.sent(),e.engine=null,e.api=null,e.docId=null,e.pdfDoc=null,[2]}}))}))()}},{key:"getArticleList",value:function(){return this.articleList&&this.articleList.length>0?Promise.resolve(this.articleList):this.getArticleListPromise}},{key:"getThread",value:function(e){return this.getArticleList().then((function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.objNum===e)return i}}))}},{key:"getBead",value:function(e,t){return this.getThread(e).then((function(e){for(var n=e.children||[],i=0;i<n.length;i++){var r=n[i];if(r.objNum===t)return r}}))}},{key:"updateBeadRect",value:function(e,t,n){var i=this;return this.getArticleListPromise.then((function(){return i.api.updateBeadRect({path:"jr/doc/article"},i.docId,i.objId,e,t,n)}))}},{key:"insertThread",value:function(e){var t=this,n=e||{},i=n.title,r=void 0===i?"":i,o=n.subject,a=void 0===o?"":o,s=n.author,u=void 0===s?"":s,c=n.keywords,l=void 0===c?"":c;return this.pdfDoc.info.hasArticle=!0,this.getArticleListPromise.then((function(){return t.api.insertThread({path:"jr/doc/article"},t.docId,t.objId,{title:r,subject:a,author:u,keywords:l}).then((function(e){return e&&(t.articleList.push(e),t.engine.eventEmitter.emit(le.articleThreadAdded,e)),e}))}))}},{key:"updateThread",value:function(e){var t=this,n=e||{},i=n.objNum,r=n.title,o=n.subject,a=n.author,s=n.keywords;return this.getThread(i).then((function(e){return t.api.updateThread({path:"jr/doc/article"},t.docId,t.objId,{objNum:i,title:r,subject:o,author:a,keywords:s}).then((function(n){return n&&(Object.assign(e,n),t.engine.eventEmitter.emit(le.articleThreadUpdated,n)),n}))}))}},{key:"removeThread",value:function(e){var t=this;return this.getThread(e).then((function(n){return t.api.removeThread({path:"jr/doc/article"},t.docId,t.objId,e).then((function(e){return e&&(t.articleList="",t.engine.eventEmitter.emit(le.articleThreadRemoved,n)),e}))}))}},{key:"insertBead",value:function(e,t,n,i){var r=this;return this.pdfDoc.info.hasArticle=!0,this.getThread(n).then((function(o){return r.api.insertBead({path:"jr/doc/article"},r.docId,r.objId,e,n,t,i).then((function(e){return e&&(o.children||(o.children=[]),void 0===i?(o.children.push(e),r.engine.eventEmitter.emit(le.articleBeadAdded,o,[e])):(r.articleList="",r.getThread(n).then((function(e){r.engine.eventEmitter.emit(le.articleBeadAdded,e,e.children)})))),{thread:o,bead:e}}))}))}},{key:"removeBead",value:function(e,t){var n=this;return this.getThread(e).then((function(i){return n.api.removeBead({path:"jr/doc/article"},n.docId,n.objId,e,t).then((function(r){return r&&(n.engine.eventEmitter.emit(le.articleBeadRemoved,[t]),1===i.children.length?n.removeThread(e):(n.articleList="",n.getThread(e).then((function(e){n.engine.eventEmitter.emit(le.articleBeadUpdated,e,e.children)})))),r}))}))}},{key:"mergeThread",value:function(e,t){var n=this;return this.getThread(t).then((function(i){return n.api.mergeThread({path:"jr/doc/article"},n.docId,n.objId,e,t).then((function(t){return t&&(i.children=t.children,n.engine.eventEmitter.emit(le.articleThreadUpdated,t),n.removeThread(e)),t}))}))}}]),e}();const xk=Sk;var Ck,Dk="progress",Ek=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"store",new j.Store),(0,J._)(this,"cancelCallback",void 0),this.cancelCallback=t}return(0,A._)(e,[{key:"cancel",value:function(){this.cancelCallback()}},{key:"onProgress",value:function(e){var t=this;return this.store.subscribe(Dk,(function(n){e.call(t,n)}))}},{key:"updateProgress",value:function(e){this.store.dispatch(Dk,e)}},{key:"getCurrentProgress",value:function(){var e=this.store.getCurrentValue(Dk);return e?e.percent:0}}]),e}();function Ik(e,t){var n=t.getCurrentPageLabelInfo(0).then((function(e){return!0===e.hasLabel}));e.hasPageLabel=n,e.hasPageLabel.then((function(){e.hasPageLabelStatus="done"})),e.hasPageLabelStatus="pending"}function Rk(e,t){"done"===e.hasPageLabelStatus&&Ik(e,t)}!function(e){e.UNINITIALIZED="uninitialized",e.PENDING="pending",e.DONE="done"}(Ck||(Ck={}));function Tk(e){if(!e)return!1;switch(e.type){case"aplication/json":case"text/json":return!0}return!("string"!=typeof e.name||!e.name.endsWith(".json"))}function Fk(e){return!!e&&("application/vnd.fdf"===e.type||"string"==typeof e.name&&e.name.endsWith(".fdf"))}function Mk(e){if(!e)return!1;switch(e.type){case"application/vnd.xfdf":case"application/vnd.adobe.xfdf":return!0}return"string"==typeof e.name&&e.name.endsWith(".xfdf")}function Ok(e){return e>=1073741824?"".concat(Math.floor(e/1073741824)," G"):e>=1048576?"".concat(Math.floor(e/1048576)," M"):e>=1024?"".concat(Math.floor(e/1024)," KB"):"".concat(e," B")}function Lk(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY/MM/DD HH:mm:ss";if(!e)return"";var n="";return e.lastModified?n=Ge(new Date(e.lastModified),t,""):e.lastModifiedDate&&(n=Ge(e.lastModifiedDate,t,"")),n}var Nk=function(e){return new Promise((function(t){var n,i,r,o,a=null,s=document.createElement("canvas"),u=s.getContext("2d",{willReadFrequently:!0}),c=new Image;c.onload=function(){var e=c.width,l=c.height;s.width=e,s.height=l,u.drawImage(c,0,0),a=u.getImageData(0,0,e,l);for(var d=0;d<a.data.length;d+=4){n=a.data[d],i=a.data[d+1],r=a.data[d+2],o=a.data[d+3],Math.sqrt(Math.pow(n-255,2)+Math.pow(i-255,2)+Math.pow(r-255,2)+Math.pow(o-255,2))<=60&&(a.data[d]=0,a.data[d+1]=0,a.data[d+2]=0,a.data[d+3]=0)}u.putImageData(a,0,0),t(s.toDataURL("image/png"))},c.src=e}))};function Vk(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",n="",i=new Uint8Array(e),r=i.byteLength,o=0;o<r;o++)n+=String.fromCharCode(i[o]);return"data:".concat(t,";base64,").concat(window.btoa(n))}function Bk(e){/^data\:.*?base64,/.test(e)&&(e=e.replace(/^data\:.*?base64,/,""));for(var t=window.atob(e),n=t.length,i=new Uint8Array(n);n--;)i[n]=t.charCodeAt(n);return i}function jk(e){return e<0||isNaN(e)}function Uk(){throw new Error("Param error: Index is out of the valid range.")}function Hk(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get";if(!Array.isArray(e))throw new Error("Param error. Only array is available.");if(0===e.length)throw new Error("Param error. Non-valid array.");if(e.forEach((function(e){if(!Array.isArray(e))throw new Error("Param error. Only array is available.");if(1!==e.length&&2!==e.length)throw new Error("Param error. Non-valid array.");1===e.length?jk(e[0])&&Uk():2===e.length&&(jk(e[0])||jk(e[1]))&&Uk()})),"insert"===n){var i=Zo(e).sort((function(e,t){return e-t})),r=t+i.length;e.forEach((function(e){e.some((function(e){return e>r}))&&Uk()}))}else if("remove"===n){var o=t-1;e.forEach((function(e){e.some((function(e){return e>o}))&&Uk()}))}else e.forEach((function(e){e.some((function(e){return e>=t}))&&Uk()}))}var Wk=g(7460),Yk=g.n(Wk),qk=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102],Kk=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,P._)(this,n),(r=t.call(this)).id=e,r.engine=i,r.parameters=o,r.api=i.api,r.pageCache=[],r.pagePromiseCache=[],r.info={fileName:o.fileName,pageSizes:{},XFARemoved:!1},r.pdfaEditable=!1,r.visibleTemplates=[],r.invisibleTemplates=[],r.metadata={FileName:o.fileName},r.docModified=!1;var a=[];for(var s in le)switch(s){case"layerVisibleChange":case"layerVisibleChanged":case"drmEncryptFailed":case"docModified":case"annotationLoaded":case"annotLoaded":case"obtainsPageFromEngine":case"permissionChanged":case"formReloaded":case"paragraphTextOnActivate":case"paragraphTextOnDeactivate":case"paragraphTextEnterEdit":case"objectStartEdit":case"objectEndEdit":break;default:a.push(le[s])}var u=function(){r.engine.eventEmitter.emit(le.docModified,(0,w._)(r)),r.docModified=!0};r.docModifiedHandler=u;var c=an(100,u);return a.map((function(e){r.engine.eventEmitter.on(e,c)})),r.engine.eventEmitter.on(de.willCloseDocument,r.willCloseDocument=function(){a.map((function(e){r.engine.eventEmitter.removeListener(e,c)}))}),r.permissionFactory={},r.pageIdMap={},r.docTextSearchIdMap={},r.spawnPageExecutor=new j.QueuedAsyncTaskExecutor,r._pageLabelInfo={hasPageLabelStatus:"uninitialized",hasPageLabel:Promise.resolve(!1)},r.otherOptions={renderConfigLineWeight:!1,disableSavePrompt:!1,isOpenNewFileAfterClose:!1},r.selectedInfo=null,r.bookmarkAPI=new sk((0,w._)(r)),r}return(0,A._)(n,[{key:"checkNoAdditionPerm",value:function(e){return void 0!==this.permissionFactory.additional&&!(this.permissionFactory.additional(this)&e)}},{key:"checkPermission",value:function(e){var t=void 0!==this.permissionFactory.standard?this.permissionFactory.standard(this):-1;return this.getPermissionsSync()&t&e}},{key:"isOwner",value:function(){return this.info.isOwner}},{key:"isDocModified",value:function(){return this.docModified}},{key:"setDocModified",value:function(){this.docModifiedHandler()}},{key:"getId",value:function(){return this.id}},{key:"getNameTreeIcons",value:function(){return this.info.icons}},{key:"getFileName",value:function(){return this.info.fileName}},{key:"createCertificateFile",value:function(e){return this.api.createCertificateFile(this.id,e)}},{key:"getCertificateSerials",value:function(){return this.api.getCertificateSerials(this.id)}},{key:"parseByCertificate",value:function(e){var t=this;return this.api.parseByCertificate(this.id,e).then((function(e){return t.afterParseHandler(e)}))}},{key:"parseByPassword",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={};if(n.encryptPassword&&(i.encryptPassword=n.encryptPassword),n.annotsJson){var r=$t.JSONToFDF(n.annotsJson);i.fdf={file:r}}return n.fdf&&(i.fdf=n.fdf),n.drm&&(i.drm=n.drm),n.fileOpen&&(i.fileOpen=n.fileOpen),n.idJWT&&(i.idJWT=n.idJWT),n.webPluginSecurity&&(0,D._)(n.webPluginSecurity,Array)&&n.webPluginSecurity.length>0&&(i.webPluginSecurity=n.webPluginSecurity||[]),n.cdrm&&(i.cdrm=n.cdrm),this.api.parsePDFDocByPassword(this.id,e,i).then((function(e){return t.afterParseHandler(e)}))}},{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.certificateInfo?this.parseByCertificate(e.certificateInfo,e):this.parseByPassword(e.password,e)}},{key:"afterParseHandler",value:function(e){var t=e.code,n=e.info;return 0!==t?Promise.reject(e):(this.info=Object.assign(this.info,n),this.pageCache=new Array(this.info.pageCount),this.info.action&&(this.action=this.engine.actionFactory.createAction(this.info.action,this,this.api,this.engine.eventEmitter,this)),this)}},{key:"getJsNameTree",value:function(){return this.info.jsNameTree}},{key:"getMetadata",value:function(){var e=this;return this.api.getMetadata(this.id).then((function(t){return e.metadata=Object.assign(e.metadata,t)})).catch((function(){return e.metadata}))}},{key:"getMetadataValue",value:function(e){return this.metadata[e]}},{key:"flatten",value:function(e){if(!(0!=this.info.fileType||this.checkPermission(Qt.annotForm)&&this.checkPermission(Qt.modify)&&this.checkPermission(Qt.assemble)))throw new Error("Permission error");for(var t=[],n=this.getPageCount(),i=0;i<n;i++){var r=this.getPageByIndex(i).then((function(t){return t.flatten(e)}));t.push(r)}return Promise.all(t)}},{key:"setMetadataValue",value:function(e,t){var n=this;if(!this.checkPermission(Qt.modify))throw new Error("Permission error");var i=Promise.resolve();return this.metadata.custom&&this.metadata.custom.hasOwnProperty(e)&&(i=this.api.removeMetadata(this.id,e).then((function(){delete n.metadata.custom[e]}))),i.then((function(){n.api.setMetadataValue(n.id,e,t).then((function(e){return n.getMetadata()})).then((function(){return n.engine.eventEmitter.emit(le.metaDataChanged,n),n}))}))}},{key:"reloadPDFForm",value:function(){var e,t=this,n=Promise.resolve();return this.PDFForm&&(e=this.PDFForm.actionHandler,n=this.PDFForm.destroy(),this.PDFForm=null),n.then((function(){return t.loadPDFForm().then((function(n){var i=!0,r=!1,o=void 0;try{for(var a,s=t.pageCache[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;u&&u.resetWidgetsControl()}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return e&&n.setActionHandler(e),t.engine.eventEmitter.emit(le.formReloaded,t),n}))}))}},{key:"loadPDFForm",value:function(){var e=this,t=this.PDFForm;return t&&!this.emptyForm?Promise.resolve(t):(t&&t.destroy(),t=this.PDFForm=new Jy(this,this.engine),this.api.loadForm(this.id).then((function(n){return e.emptyForm=!1,t.setFormJson(n),t.setState("jsInited"),t})))}},{key:"loadEmptyPDFForm",value:function(){var e=this.PDFForm;return this.emptyForm=!0,e||(e=this.PDFForm=new Jy(this,this.engine)),Promise.resolve(e)}},{key:"getPDFForm",value:function(){return this.PDFForm}},{key:"getPageCount",value:function(){return this.info.pageCount}},{key:"getPageCountAsync",value:function(){return this.info.pageCount||this.api.getPageCountAsync(this.id)}},{key:"getFileVersion",value:function(){return this.api.getFileVersion(this.id).then((function(e){return(void 0!==e?e:14)/10}))}},{key:"isLinearized",value:function(){return this.api.isLinearized(this.id)}},{key:"hasForm",value:function(){return this.api.hasForm(this.id)}},{key:"setCustomPermission",value:function(e,t){this.permissionFactory[e]=t}},{key:"getPermission",value:function(){return this.getPermissions()}},{key:"getPermissions",value:function(){return this.getPermissionsSync()}},{key:"getPermissionsSync",value:function(){if(this.permissionFactory.replaceStandard)return this.info.userPermissions=this.permissionFactory.replaceStandard(this),this.info.userPermissions;if(this.info.isOwner)return 4294967292;var e=-1;return(this.info.sigPerms||[]).forEach((function(t){return e&=t})),(e&this.info.userPermissions)>>>0}},{key:"hasSignature",value:function(){return(this.info.sigPerms||[]).length}},{key:"getStdCipherOptions",value:function(){return this.api.getStdCipherOptions(this.id)}},{key:"getPDFDocInfo",value:function(){return this.api.getPDFDocInfoById(this.id)}},{key:"getBookmarksJson",value:function(){return this.api.getBookmarks(this.id)}},{key:"getBookmarkChildren",value:function(e){return this.api.getBookmarkChildren({path:"jr/doc"},this.id,e)}},{key:"getBookmarkAPI",value:function(){return this.bookmarkAPI}},{key:"getBlankPageIndexes",value:function(){return this.api.getBlankPageIndexes(this.id)}},{key:"getCurFileSymbolId",value:function(){return this.api.getCurFileSymbolId(this.id)}},{key:"getFadeOutBackground",value:function(e){return this.api.getFadeOutBackground(this.id,e)}},{key:"getConvertToMono",value:function(e){return this.api.getConvertToMono(this.id,e)}},{key:"convertImageToBlackWhite",value:function(e){var t=this;return(0,_._)((function(){var n,i;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return[4,t.getConvertToMono(e)];case 1:return n=r.sent(),i=Vk(n[0]),[2,Nk(i)]}}))}))()}},{key:"getRootBookmark",value:function(){var e=this;if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.bookmarkRoot)return Promise.resolve(this.bookmarkRoot);var t=this.engine;return this.getBookmarksJson().then((function(n){return n?e.bookmarkRoot=new ck(t,e,n):null}))}},{key:"updateRootBookmark",value:function(){var e=this;return this.bookmarkRoot?this.getBookmarksJson().then((function(t){t&&e.bookmarkRoot.updateBookmark(t)})):Promise.resolve()}},{key:"createRootBookmark",value:function(){var e=this;if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");var t=this.engine;return this.api.createRootBookmark(this.id).then((function(n){return e.bookmarkRoot=new ck(t,e,n)}))}},{key:"getLayerNodesJson",value:function(){var e=this;return this.isDestroyed?Promise.resolve():this.ocgs?Promise.resolve(this.ocgs):this.api.getLayerNodes(this.id).then((function(t){return e.ocgs=t}))}},{key:"getRootLayerNodeChildrenCount",value:function(){return this.isDestroyed?Promise.resolve(0):this.api.getRootLayerNodeChildrenCount({path:"jr/doc"},this.id)}},{key:"setLayerNodeVisible",value:function(e,t){var n=this,i=this.getLayerNodeById(e);return i.visible===t?Promise.resolve(!0):(i.visible=t,this.api.setLayerNodeVisiable(this.id,e,t).then((function(e){return e&&n.engine.eventEmitter.emit(le.layerVisibleChange,n),e})))}},{key:"setLayerNodeVisiable",value:function(e,t){return this.setLayerNodeVisible(e,t)}},{key:"isPageLoaded",value:function(e){return!!this.pageCache[e]||!!this.pagePromiseCache[e]}},{key:"getPageRotation",value:function(e){return this.api.getPageRotation({path:"jr/doc"},this.id,e)}},{key:"getPageByIndex",value:function(e){var t,n=this,i=this.pageCache;if(t=i[e])return Promise.resolve(t);var r=this.pagePromiseCache;return r[e]=r[e]||this.api.getPageInfoByIndex(this.id,e).then((function(t){var o=i[e]=new jy(t,n);return n.engine.eventEmitter.emit(le.obtainsPageFromEngine,o),delete r[e],o}))}},{key:"getPageById",value:function(e){return this.pageIdMap[e]||null}},{key:"getCurrentDocTextSearch",value:function(){var e=Object.keys(this.docTextSearchIdMap);return this.docTextSearchIdMap[e[e.length-1]]||null}},{key:"getDocTextSearchById",value:function(e){return this.docTextSearchIdMap[e]||null}},{key:"destroy",value:function(){var e,t=this;(e=this.PDFForm)&&e.destroy(),this.PDFForm=null,this.pageIdMap={},this.docTextSearchIdMap={};for(var i=this.pageCache,r=0,o=i.length;r<o;r++){var a=i[r];a&&a.destroy(),i[r]=null}var s=this.HF;return s&&s.destroy(),this.HF=null,this.bookmarkRoot&&this.bookmarkRoot.destroy(),this.bookmarkRoot=null,this.permissionFactory={},this.engine.eventEmitter.off(de.willCloseDocument,this.willCloseDocument),this.willCloseDocument=null,this.pdfPortfolio=null,(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),Promise.resolve().then((function(){return t.api.destroyDoc(t.getId())}))}},{key:"releasePage",value:function(e){this.api.destroyPage({path:"jr/doc"},this.id,e)}},{key:"getDocBuffer",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.hasSignature()?1:0;n&&e.activeElement(null);var r=[];return Promise.resolve((e._saveBefore||function(){})()).then((function(){return t.getStream((function(e){var t=e.arrayBuffer;r.push(t)}),i,n).then((function(){return r}))}))}},{key:"getStream",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.checkNoAdditionPerm(1))throw new Error("Permission error, download disabled");return this.PDFForm?this.PDFForm.addTask().then((function(){return t.api.getPDFDocStream(t.id,e,n,i)})):this.api.getPDFDocStream(this.id,e,n,i)}},{key:"getFile",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{flags:0,fileName:this.getFileName()},n=t.flags,i=void 0===n?0:n,r=t.fileName,o=void 0===r?this.getFileName():r;if(this.checkNoAdditionPerm(Xe.download))throw new Error("Permission denied! Missing additional download permission.");var a,s=[],u=0,c=function(e){var t=e.blob,n=e.arrayBuffer,i=e.offset,r=e.size;n?(s.push({arrayBuffer:n,offset:i}),u=Math.max(i+r,u)):a=t},l=function(){return e.api.getPDFDocStream(e.id,c,i).then((function(){if(a)return[a];var e=new Uint8Array(u);return s.forEach((function(t){var n=t.arrayBuffer,i=t.offset;e.set(new Uint8Array(n),i)})),e})).then((function(e){try{return new File([e],o,{type:"application/pdf"})}catch(n){e.name=o;var t=new Date;return e.lastModified=t.getTime(),e.lastModifiedDate=t,e.webkitRelativePath="",e}}))};return this.PDFForm?this.PDFForm.addTask().then((function(){return l()})):l()}},{key:"exportAnnotsToFDF",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(0!==e&&1!==e)throw new Error("File type error, only 0 or 1 available, current is "+e);var n=arguments[2],i={};if(t)for(var r in t.forEach((function(e){var t;i[e.page.getId()]||(i[e.page.getId()]=new Set),t=i[e.page.getId()],Xk(e,t,n)})),i)i[r]=Array.from(i[r]);return this.api.exportToFDF(this.id,e,2,i)}},{key:"exportFormToFile",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if((t|5-t)<0)throw new Error("File type error.");var n=Promise.resolve();return this.PDFForm||(n=this.loadPDFForm()),n.then((function(n){switch(t){case 0:return e.api.exportToFDF(e.id,0,1);case 1:var i=e.PDFForm.exportXFDF(),r=new Blob([i],{type:"application/vnd.adobe.xfdf"});return Promise.resolve(r);case 2:var o=e.PDFForm.exportXML(),a=new Blob([o],{type:"application/xml"});return Promise.resolve(a);case 3:var s={"":e.getFileName()||"Untitled.pdf"};e.PDFForm.enumFieldsEx([],0,(function(e,t,n){Array.isArray(n)&&(n=n.join("\n")),s[t]=n}));var u=Yk().unparse([s],{delimiter:","});return Promise.resolve(new Blob(["\ufeff"+u],{type:"text/csv,charset=UTF-8"}));case 4:var c={};e.PDFForm.enumFieldsEx([],0,(function(e,t,n){Array.isArray(n)?c[t]=n.join("\n"):c[t]=n}));var l=Yk().unparse([c],{delimiter:"\t"});return Promise.resolve(new Blob([l],{type:"text/plain"}));case 5:var d=[];e.PDFForm.enumFieldsEx([],0,(function(e,t,n){var i={};i.type=e,i.name=t,i.value=n,d.push(i)}));var h=JSON.stringify(d);return Promise.resolve(new Blob([h],{type:"application/json"}))}}))}},{key:"exportToFDF",value:function(e,t){return this.api.exportToFDF(this.id,e,2).then((function(e){return new Uint8Array(e)}))}},{key:"exportDataToFDF",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(0!==e&&1!==e)throw new Error("File type error, only 0 or 1 available, current is "+e);return this.api.exportToFDF(this.id,e,t)}},{key:"exportToStardardXml",value:function(e,t){return this.api.exportToStardardXml(this.id,e,t)}},{key:"exportToImage",value:function(e,t,n,i){return this.api.exportToImage(this.id,e,t,n,i)}},{key:"exportToTxt",value:function(e,t,n){return this.api.exportToTxt(this.id,e,t,n)}},{key:"exportImageObjectToImage",value:function(e,t,n,i){return this.api.exportImageObjectToImage(this.id,e,t,n,i)}},{key:"cancelExport",value:function(){return this.api.cancelExport(this.id)}},{key:"importAnnotsFromFDF",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.checkPermission(Qt.annotForm))throw new Error("Permission error");return this.api.importFromFDF(this.id,e,2).then((function(){for(var e=function(e,t){var r=n[e];if(!r)return"continue";i.push(r.getUnloadedAnnots().then((function(e){return{page:r,newAnnots:e}})))},n=t.pageCache,i=[],r=0,o=n.length;r<o;r++)e(r);return Promise.all(i)})).then((function(e){t.engine.eventEmitter.emit(le.annotationImported,t,e),!n&&t.engine.eventEmitter.emit(le.annotationImportedEx,t,e)}))}},{key:"importFormFromFile",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"UTF-8";if(!this.checkPermission(Qt.annotForm+Qt.fillForm))throw new Error("Permission error");var r="importFieldProgress";this.engine.eventEmitter.emit(de.progressChanged,r,0,Rm.PROGRESSING),this.engine.eventEmitter.on("upadateFormValue",(function(e,t,i){n.engine.eventEmitter.emit(de.progressChanged,r,t,i),i!==Rm.SUCCESS&&i!==Rm.FAILED||(n.engine.eventEmitter.off("upadateFormValue"),i===Rm.SUCCESS&&n.engine.eventEmitter.emit(le.formFieldImported,n))}));var o=Promise.resolve();this.PDFForm||(o=this.loadPDFForm());var a=2===t;return 3===t||4==t||5==t?o=o.then((function(t){(0,D._)(e,ArrayBuffer)||(0,D._)(e,DataView)?e=new Blob([e]):(0,D._)(e,Blob)||(e=new Blob(e));var n=(0,j.createDeferred)(),r=new FileReader;return r.onloadend=function(){n.resolve(r.result)},r.onerror=n.reject,r.readAsText(e,i),n.promise})).then((function(i){var r=",";switch(t){case 3:case 5:break;case 4:r="\t";break;default:throw new Error("Unsupported file type")}if(5===t){var o=JSON.parse(i).reduce((function(e,t){return e[t.name]=t.value,e}),{});e=ok(o,n.PDFForm)}else{var a=Yk().parse(i,{delimiter:r}),s=a.data,u=a.errors;if(u.length>0)throw new Error("Parsing error: ".concat(u.join("\n")));var c=s[0].reduce((function(e,t,n){return""===t||(e[t]=s[1][n]),e}),{});e=ok(c,n.PDFForm)}})):a?(0,D._)(e,Blob)?o=new Promise((function(t,n){var i=new FileReader;i.readAsText(e),i.onload=function(n){var i=n.target.result;e=ak(i),t()}})):(0,D._)(e,ArrayBuffer)&&(o=new Promise((function(t,n){var i=new Blob([e]),r=new FileReader;r.readAsText(i),r.onload=function(n){var i=n.target.result;e=ak(i),t()}}))):o=Promise.resolve(),o.then((function(){var t=n.PDFForm;return n.api.importFromFDF(n.id,e,1).then((function(e){return n.api.getFieldsValue(n.id)})).then((function(e){return t.upadateValue(e),e})).then((function(e){for(var i in n.engine.eventEmitter.emit(le.docModified,n),e){var r=t.getField(i);if(r&&6===r.getType()){var o=r.getLoadedWidgets(),a=void 0,s=vo.FieldValueChanged;a=o.length?o[0].getAdditionalAction(s):r.getAction(s),e[i].length>0&&a&&t.actionHandler&&t.actionHandler(a,null,r,s)}}t.calculate(null)}))}))}},{key:"importFromFDFFile",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(1===n)return this.PDFForm.importFDF();var i=e,r=!1;if((0,D._)(e,Uint8Array)&&e.length>52428800){var o=new Blob([e],{type:"arraybuffer"});i=URL.createObjectURL(o),r=!0}return this.api.importFromFDFFile(this.id,i,-1,n).then((function(e){for(var n=function(e,t){var n=i[e];if(!n)return"continue";r.push(n.getUnloadedAnnots().then((function(e){return{page:n,newAnnots:e}})))},i=t.pageCache,r=[],o=0,a=i.length;o<a;o++)n(o);return Promise.all(r)})).then((function(e){r&&URL.revokeObjectURL(i);var o=le.annotationImported;1==n&&(o=le.annotationImported),t.engine.eventEmitter.emit(o,t,e)}),(function(e){console.error("some error happened. Please check fdf file exists.",e)}))}},{key:"exportAnnotsToJSON",value:function(e){var t=this,n=Promise.resolve();if(e&&0!=e.length){var i={},r=e.map((function(e,t){var n=e.exportToJSON();return"stamp"!=n.type&&"fileattachment"!=n.type||(i[t]={page:n.page,index:e.getId()}),n}));n=Promise.all([r,this.getAnnotsRawData(i)])}else n=this.getAnnots().then((function(e){for(var n={},i=[],r=0,o=e.length;r<o;r++)for(var a=e[r],s=0,u=a.length;s<u;s++){var c=a[s].getType();if("widget"!=c&&"popup"!=c&&"watermark"!=c){var l=a[s].exportToJSON();i.push(l),"stamp"!=l.type&&"fileattachment"!=l.type||(n[i.length-1]={page:r,index:a[s].getId()})}}return Promise.all([i,t.getAnnotsRawData(n)])}));return n.then((function(e){var t=(0,E._)(e,2),n=t[0];return t[1].forEach((function(e){return n[e.index].raw=e.raw})),n}))}},{key:"getAnnotsRawData",value:function(e){return e.length>0?[]:this.api.getAnnotsRawData(this.id,e)}},{key:"importAnnotsFromJSON",value:function(e){if(!this.checkPermission(Qt.annotForm))throw new Error("Permission error");var t=$t.JSONToFDF(e);return this.importAnnotsFromFDF(t)}},{key:"getPageAnnots",value:function(e){return Zk(e,this.getPageCount()),this.getPageByIndex(e).then((function(e){return e.getAnnots()}))}},{key:"getPageAnnotsIdList",value:function(e){return Zk(e,this.getPageCount()),this.getPageByIndex(e).then((function(e){return Object.keys(e.annotIdMap).map((function(e){return+e}))}))}},{key:"hasAnnots",value:function(e){return this.api.hasAnnots({path:"jr/doc"},this.id,e)}},{key:"getAllPageAnnotCount",value:function(){return this.api.getAllPageAnnotCount({path:"jr/doc"},this.id)}},{key:"getAllAnnotsData",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){return[2,e.api.getAllAnnotsData({path:"jr/doc"},e.id)]}))}))()}},{key:"getAnnots",value:function(){var e=this;return(0,_._)((function(){var t;return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return[4,e.getAllPageAnnotCount()];case 1:return t=n.sent(),[2,Promise.all(Array(e.getPageCount()).fill(null).map((function(n,i){return t[i]?e.getPageAnnots(i):[]})))]}}))}))()}},{key:"addAnnots",value:function(e){var t=this;e=e.map((function(e){var n=e.page;if(void 0===n)throw"page is required.";e.type&&(e=Ny(e,t.engine.getUserCommentConfig()));var i=t.engine.getDefaultAnnotConfig()(e.type,e.intent);return e.groupElements&&(e.groupElements=e.groupElements.map((function(e){e=Ny(e,t.engine.getUserCommentConfig());var n=t.engine.getDefaultAnnotConfig()(e.type,e.intent);return(0,j.extendOptions)({},n,e)}))),(0,j.extendOptions)({page:n},i,e)}));var n=this.getId(),i=0,r="addAnnots",o=de.progressChanged,a=e.filter((function(e){return!!e.states&&e.states.length>0})).map((function(e){return e.name}));return this.api.addAnnots(n,e,(function(e){i=e,t.engine.eventEmitter.emit(o,r,Number(i.toFixed(2)),Rm.PROGRESSING)})).then((function(e){var n=(100-i)/(e.length+1);return Promise.all(e.map((function(e){return t.getPageByIndex(e.page).then((function(s){return s.getUnloadedAnnots().then((function(t){return s.getAnnotsByIdArray(a).then((function(e){return e.flatMap((function(e){return e.getMarkedStates()})).reduce((function(e,t){return e[t.objectNumber]=t,e}),{})})).then((function(t){var n=s.annotIdMap;return e.annots.map((function(e){return n[e]||t[e]}))}))})).then((function(e){i+=n;for(var a=[],u=s.annotIdMap,c=t.engine.eventEmitter,l=0,d=e.length;l<d;l++){var h=e[l];h.getType()===Hi.text?h.isStateAnnot()?(a.length&&(c.emit(le.annotationAdd,a,s),a=[]),c.emit(1===h.info.stateMode?le.annotationMarkedStateAnnotAdded:le.annotationReviewStateAnnotAdded,h,u[h.info.IRT]),c.emit(le.annotationUpdated,[h],s,en.replyAdded)):h.isReplyAnnot()?(a.length&&(c.emit(le.annotationAdd,a,s),a=[]),c.emit(le.annotationReplyAdded,h,u[h.info.IRT]),c.emit(le.annotationUpdated,[h],s,en.markedStateUpdated)):a.push(h):a.push(h)}return a.length&&c.emit(le.annotationAdd,a,s),c.emit(o,r,Number(i.toFixed(2)),Rm.PROGRESSING),e}))}))})))})).then((function(e){t.engine.eventEmitter.emit(o,r,100,Rm.SUCCESS);var n=[];return e.forEach((function(e){n=n.concat(e)})),n})).catch((function(e){throw t.engine.eventEmitter.emit(o,r,Number(i.toFixed(2)),Rm.FAIL),e}))}},{key:"getAnnotIdMap",value:function(){for(var e=this,t=[],n={},i=0,r=this.getPageCount();i<r;i++)t.push(function(t){return e.getPageByIndex(t).then((function(e){Object.assign(n,e.annotIdMap)}))}(i));return Promise.all(t).then((function(){return n}))}},{key:"getTextSearch",value:function(e,t){return new Xy(this,e,t)}},{key:"addAnnot",value:function(e,t){if(!this.checkPermission(Qt.annotForm))throw new Error("Permission error");return Zk(e,this.getPageCount()),this.getPageByIndex(e).then((function(e){return e.addAnnot(t)}))}},{key:"addAnnotGroup",value:function(e,t,n){if(!this.checkPermission(Qt.annotForm))throw new Error("Permission error");return Zk(e,this.getPageCount()),this.getPageByIndex(e).then((function(e){return e.addAnnotGroup(t,n)}))}},{key:"setOpenAction",value:function(e,t){var n=this;if(!this.checkPermission(Qt.modify))throw new Error("Permission error");return this.api.setDocOpenAction(this.getId(),e,t).then((function(e){return n.action=n.engine.actionFactory.createAction(e,n,n.api,n.engine.eventEmitter,n)}))}},{key:"getSecurityType",value:function(){return this.api.getSecurityType(this.id)}},{key:"checkCertificatePassword",value:function(e,t){return this.api.checkCertificatePassword(this.id,e,t)}},{key:"setCertificateAndPermission",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zy.AES256,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!this.checkPermission(Qt.modify))throw new Error("Permission error");return this.api.setCertificateAndPermission(this.id,e,t,n)}},{key:"setPasswordAndPermission",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4294967292,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Zy.AES256,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments[5];if(!this.checkPermission(Qt.modify))throw new Error("Permission error");return this.api.setPasswordAndPermission(this.id,e,t,i,r,o).then((function(i){return(a&&(a.userPassword||a.ownerPassword)||e&&-1!=e||t&&-1!=t)&&i&&(n.setPasswordType(t||e&&!t?3:2),n.setHasOwnerPassword(!!t),n.engine.eventEmitter.emit(le.docPasswordChanged,n)),i}))}},{key:"removeSecurity",value:function(){var e=this;if(!this.checkPermission(Qt.modify))throw new Error("Permission error");return this.api.removeSecurity(this.id).then((function(t){return t&&e.engine.eventEmitter.emit(le.removePwdAndPerm,e),t}))}},{key:"isCorrectPassword",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe;return this.checkPassword(e).then((function(e){return 0!==e}))}},{key:"getViewerPreference",value:function(){return this.preferencePromise||(this.preferencePromise=this.api.getViewerPreference(this.id).catch((function(){return{pageLayout:"Default",uiLayout:"Default",language:"Default",viewerPreference:{}}})))}},{key:"setViewPreference",value:function(e,t){return this.preferencePromise=null,this.api.setViewPreference(this.id,e,t)}},{key:"checkPassword",value:function(e){var t=this;return this.api.checkPassword(this.id,e).then((function(e){return 3===e&&(t.info.isOwner=!0),t.engine.eventEmitter.emit(le.permissionChanged,t),e}))}},{key:"getTypeByPassword",value:function(e){var t=this;return this.api.checkPassword(this.id,e).then((function(e){return 3===e&&(t.info.isOwner=!0),e}))}},{key:"getUserPassword",value:function(e){return this.api.getUserPassword(this.id,e)}},{key:"getPasswordType",value:function(){return Promise.resolve(this.info.passwordType)}},{key:"setPasswordType",value:function(e){return this.info.passwordType=e}},{key:"hasOwnerPassword",value:function(){return!!this.info.hasOwnerPassword}},{key:"setHasOwnerPassword",value:function(e){this.info.hasOwnerPassword=!!e}},{key:"getUserPermissions",value:function(){return this.info.userPermissions}},{key:"makeRedactByPages",value:function(e){if(!this.checkPermission(Qt.annotForm))throw new Error("Permission error");for(var t=[],n=0;n<e.length;n++){var i=e[n],r=this.getPageByIndex(i).then((function(e){var t;if(!e.isVirtual())return t=1==e.info.rotation||3==e.info.rotation?{left:0,top:0,right:e.getHeight(),bottom:e.getWidth()}:{left:0,top:0,right:e.getWidth(),bottom:e.getHeight()},e.markRedactAnnot([t])}));t.push(r)}return Promise.all(t).then((function(e){return e.filter(Boolean)}))}},{key:"movePageTo",value:function(e,t){var n=this;if(!this.checkPermission(Qt.modify))throw new Error("Permission error");this.info.pageSizes={};var i=this.getPageCount();if(e<0||t<0||e>=i||t>=i)throw new Error("Param error: PageIndex or DestIndex is out of the valid range.");return this.getPageByIndex(e).then((function(i){return n.api.movePageTo(n.id,i.getId(),t).then((function(i){if(i){var r=n.pageCache[e];n.pageCache.splice(e,1),n.pageCache.splice(t,0,r);var o=Math.min(e,t),a=Math.max(e,t);n.updatePageIndex(o,a),n.engine.eventEmitter.emit(le.pageMoved,e,t)}return n.updateRootBookmark().then((function(e){return i}))}))}))}},{key:"insertBlankPages2",value:function(e,t,n){var i=this;return(0,_._)((function(){var r,o,a;return(0,F.Jh)(this,(function(s){switch(s.label){case 0:if(!i.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");if(i.info.pageSizes={},i.getPageCount(),"number"!=typeof t||"number"!=typeof n)throw new Error("param error. Only number is available.");return[4,i.api.insertBlankPages2(i.id,e,t,n)];case 1:return r=s.sent(),[4,i.api.getLayerNodes(i.id)];case 2:return o=s.sent(),delete i.ocgs,i.ocgs=o,a=r.reduce((function(e,t){if(!t)return!1;i.info.pageCount++;var n=new jy(t,i),r=t.index;return i.pageCache.splice(r,0,n),i.updatePageIndex(r+1,i.info.pageCount-1),i.PDFForm&&i.PDFForm.afterInsertPage(t.index),(0,I._)(e).concat([n])}),[]),i.updatePageLabelsByAction("insertPagesByRange",[r.map((function(e){return e.index}))]),i.engine.eventEmitter.emit(le.insertPages,a),[2,a]}}))}))()}},{key:"insertPage",value:function(e,t,n){var i=this;if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");this.info.pageSizes={};var r=this.getPageCount();if(e<0||e>r)throw new Error("Param error: PageIndex is out of the valid range.");if("number"!=typeof t||"number"!=typeof n)throw new Error("param error. Only number is available.");return this.api.insertPage(this.id,e,t,n).then((function(e){return delete i.ocgs,i.api.getLayerNodes(i.id).then((function(e){return i.ocgs=e})).then((function(t){return e}))})).then((function(t){if(!t)return!1;i.info.pageCount++;var n=new jy(t,i);i.pageCache.splice(t.index,0,n),i.updatePageIndex(t.index+1,i.info.pageCount-1);var r=i.PDFForm&&i.PDFForm.afterInsertPage(e);return i.engine.eventEmitter.emit(le.pageAdded,n),i.updateRootBookmark().then((function(){return r})).then((function(e){return n}))}))}},{key:"showNameTreePageAtTheEnd",value:function(){var e=this;return this.api.showNameTreePageAtTheEnd(this.id).then((function(t){return delete e.ocgs,e.api.getLayerNodes(e.id).then((function(t){return e.ocgs=t})).then((function(n){return e.reloadPDFForm(!0).then((function(e){return t}))}))})).then((function(t){if(!t)return!1;e.info.pageCount++;var n=new jy(t,e);return e.pageCache.splice(t.index,0,n),e.engine.eventEmitter.emit(le.pageAdded,n),e.engine.eventEmitter.emit(le.pagesLabelNeedUpdate,n),n}))}},{key:"removePage",value:function(e){var t=this;if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");this.info.pageSizes={};var n=this.getPageCount();if(e<0||e>=n)throw new Error("Param error: PageIndex is out of the valid range.");if(1==n)throw new Error("Not allowed to remove the only page.");var i=[];return this.pageCache[e]||i.push(this.getPageByIndex(e)),Promise.all(i).then((function(n){return t.api.removePage(t.id,e).then((function(n){if(n){t.PDFForm&&t.PDFForm.afterRemovePage(e),t.info.pageCount--;var i=t.pageCache[e].info.objectNumber;t.pageCache.splice(e,1),t.updatePageIndex(e,t.info.pageCount-1),t.engine.eventEmitter.emit(le.pageRemoved,e,i),t.removePageStatus=!0}return t.updateRootBookmark().then((function(e){return n}))}))}))}},{key:"hideNameTreePage",value:function(e,t){var n=this;return this.api.hideNameTreePage(this.id,e).then((function(t){if(t){var i=e;e<0&&(i=n.info.pageCount-1),n.PDFForm&&n.PDFForm.afterRemovePage(i),n.info.pageCount--;var r=n.pageCache[i]&&n.pageCache[i].info.objectNumber;n.pageCache.splice(e,1),n.updatePageIndex(e,n.info.pageCount-1),n.engine.eventEmitter.emit(le.pageRemoved,i,r),n.engine.eventEmitter.emit(le.pagesLabelNeedUpdate),n.removePageStatus=!0}return t}))}},{key:"updatePageIndex",value:function(e,t){for(var n=e;n<=t;n++)this.pageCache[n]&&(this.pageCache[n].info.index=n);this.pageCache.forEach((function(e){e&&e.annots.forEach((function(e){"link"!=e.info.type&&"screen"!=e.info.type||e._update(1)}))}))}},{key:"applyRedaction",value:function(){var e=this;if(!this.checkPermission(Qt.annotForm)||!this.checkPermission(Qt.modify))throw new Error("Permission error");return this.registerProgressFlow("applyRedaction"),this.api.applyRedaction(this.id).then((function(t){var n=function(n){var r=t[n],o=e.getPageByIndex(r.pageIndex).then((function(t){var n=t.clearAnnotIds(r.removedAnnotIds).filter((function(e){return e}));return e.engine.eventEmitter.emit(le.annotationRemoved,n,t),{pageIndex:r.pageIndex,removedAnnots:r.removedAnnotIds}}));i.push(o)};if(!t)return!1;for(var i=[],r=0;r<t.length;r++)n(r);return Promise.all(i).then((function(t){return e.engine.eventEmitter.emit(le.applyRedaction,t),t}))}))}},{key:"drmEncrypt",value:function(e){var t=this;if(!this.checkPermission(Qt.modify))throw new Error("Permission error");return this.api.drmEncrypt(this.getId(),e).then((function(e){return t.info=Object.assign(t.info,e),t.engine.eventEmitter.emit(le.drmEncryptSuccess,t),t}),(function(e){return t.engine.eventEmitter.emit(le.drmEncryptFailed,e,t),Promise.reject(e)}))}},{key:"getTemplates",value:function(){var e=this;if(this.isDestroyed)return Promise.resolve();this.api.getTemplates(this.id).then((function(t){t&&(e.visibleTemplates=t.visibleArr,e.invisibleTemplates=t.invisibleArr)}))}},{key:"hideTemplate",value:function(e,t){var n=this,i=this;if(!t)return this.api.hideTemplate(this.id,e,t).then((function(){i.visibleTemplates.push(e);for(var t=-1,n=0;n<i.invisibleTemplates.length;n++){var r=i.invisibleTemplates[n];if(r.name===e.name&&r.objNum===e.objNum){t=n;break}}i.invisibleTemplates.splice(t,1)}));for(var r=this,o=function(o){r.getPageByIndex(o).then((function(r){r.info.objectNumber===e.objNum&&i.removePage(o).then((function(){return i.api.hideTemplate(n.id,e,t).then((function(){i.invisibleTemplates=i.invisibleTemplates.push(e);for(var t=-1,n=0;n<i.visibleTemplates.length;n++){var r=i.visibleTemplates[n];if(r.name===e.name&&r.objNum===e.objNum){t=n;break}}i.visibleTemplates.splice(t,1)}))}))}))},a=this.getPageCount(),s=0;s<a;s++)o(s)}},{key:"spawnPage",value:function(e,t,n,i){var r=this,o=this.spawnPageExecutor.insert((function(){return r.api.spawnPage(r.id,e,t,n,i).then((function(e){return delete r.ocgs,r.api.getLayerNodes(r.id).then((function(e){return r.ocgs=e})).then((function(t){return e}))})).then((function(e){if(!e)return!1;r.info.pageCount++;var t=new jy(e,r);return r.pageCache.splice(e.index,0,t),r.updatePageIndex(e.index+1,r.info.pageCount-1),t})).then((function(e){return!!e&&r.reloadPDFForm().then((function(e){return r.engine.eventEmitter.emit(de.spawnPageSuccess,e),r.PDFForm.reloadForm(e.formInfo)})).then((function(){return e}))}))}));return this.spawnPageExecutor.execInverse((function(){return o.then((function(e){var t=(0,E._)(e,1)[0];return!!t&&(r.engine.eventEmitter.emit(le.pageAdded,t),r.updateRootBookmark())}))})),o.then((function(e){return(0,E._)(e,1)[0]}))}},{key:"removeTemplate",value:function(e){var t=this;return this.api.removeTemplate(this.id,e).then((function(n){for(var i=-1,r=0;r<t.invisibleTemplates.length;r++){if(t.invisibleTemplates[r].name===e){i=r;break}}t.invisibleTemplates.splice(i,1),i=-1;for(var o=0;o<t.visibleTemplates.length;o++){if(t.visibleTemplates[o].name===e){i=o;break}}return t.visibleTemplates.splice(i,1),Promise.resolve()}))}},{key:"getPageSizes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getPageCount()-t;return t<0&&(t=0),t+n>this.getPageCount()&&(n=this.getPageCount()-t),this.api.getPageSizes(this.id,t,n).then((function(t){return Object.assign(e.info.pageSizes,t),t}))}},{key:"getPageSizesByIndex",value:function(e){return this.api.getPageSizes(this.id,e,1).then((function(e){return e}))}},{key:"getPageSize",value:function(e){var t=this.pageCache[e];if(t)return{width:t.getWidth(),height:t.getHeight()};var n=this.info.pageSizes;return n[e]?Object.assign({},n[e]):void 0}},{key:"getEstimatedPageSize",value:function(e){var t=this.info.pageSizes,n=Object.keys(t);if(n.length>0)return Object.assign({},t[n.pop()])}},{key:"getPageSizesSync",value:function(){var e=this;return 0==Object.keys(this.info.pageSizes).length&&this.pageCache.forEach((function(t,n){t&&(e.info.pageSizes[n]={width:t.getWidth(),height:t.getHeight()})})),this.info.pageSizes}},{key:"isPageSameSize",value:function(){var e=this.getPageSizesSync(),t=new Set(Object.values(e).map((function(e){return e.width})));return this.pageSameSize=1==t.size}},{key:"updatePageSize",value:function(e,t,n){var i=this.info.pageSizes;i[e]&&(i[e].width=t,i[e].height=n)}},{key:"insertPages",value:function(e){var t=this,n=e.destIndex,i=e.file,r=e.password,o=void 0===r?"":r,a=e.flags,s=void 0===a?0:a,u=e.layerName,c=void 0===u?"":u,l=e.startIndex,d=e.endIndex;if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");var h=this.getPageCount();if(n<0||n>h)throw new Error("Param error: Index is out of the valid range.");if(1==s&&!c)throw new Error("Param error: If parameter flags is 1, parameter layerName should not be empty");return this.api.startImportPages(this.id,n,i,o,s,c,l,d).then((function(e){return delete t.ocgs,t.api.getLayerNodes(t.id).then((function(e){return t.ocgs=e})).then((function(t){return e}))})).then((function(e){var i;t.info.pageSizes={},t.info.pageCount+=e.length;var r=[];return e.forEach((function(e){var n=new jy(e,t);r.push(n)})),(i=t.pageCache).splice.apply(i,[n,0].concat((0,I._)(r))),t.updatePageIndex(n,t.info.pageCount-1),t.updatePageLabelsByAction("insertPages",[n,e.length]),t.engine.eventEmitter.emit(le.importPages,r),t.updateRootBookmark().then((function(e){return r}))}))}},{key:"mergePDFDoc",value:function(e){var t=e||{},n=t.insertIndex,i=t.doc,r=t.pages;if(!i)return Promise.reject(new Error("Missing required option: doc"));var o=this.getPageCount();"number"!=typeof n&&(n=o),n=Math.max(0,Math.min(o,n)),Array.isArray(r)?r.sort((function(e,t){return e>t?1:-1})):r=Array(i.getPageCount()).fill(0).map((function(e,t){return t}));var a=i.getPageCount();for(var s in r){var u=r[s];if(u<0||u>=a)return Promise.reject(new Error("Incorrect page index: ".concat(u,", it must be greater than or equal to 0 or less then total page count ").concat(a)))}return this.importPagesFromPDFDocs({destIndex:n,srcDocs:[{srcDocId:i.getId(),srcPages:r}],layerName:e.layerName})}},{key:"importPagesFromPDFDocs",value:function(e){var t=e.destIndex,n=e.srcDocs,i=void 0===n?[]:n,r=e.layerName,o=void 0===r?"":r,a=this;return(0,_._)((function(){var e,n,r,s,u,c;return(0,F.Jh)(this,(function(l){switch(l.label){case 0:if(!a.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");if(n=a.getPageCount(),t<0||t>n)throw new Error("Param error: Index is out of the valid range.");return[4,a.api.importPagesFromPDFDocs(a.id,t,i,o)];case 1:return r=l.sent(),s=r.pagesJson,u=r.errs,0===s.length?[2,{pages:[],errs:u}]:(delete a.ocgs,[4,a.api.getLayerNodes(a.id)]);case 2:return a.ocgs=l.sent(),a.info.pageSizes={},a.info.pageCount+=s.length,c=s.map((function(e){return new jy(e,a)})),(e=a.pageCache).splice.apply(e,[t,0].concat((0,I._)(c))),a.updatePageIndex(t,a.info.pageCount-1),a.updatePageLabelsByAction("insertPages",[t,s.length]),a.bookmarkRoot=null,a.engine.eventEmitter.emit(le.importPages,c),[2,{pages:c,errs:u}]}}))}))()}},{key:"exportPagesToPDFDocs",value:function(e){var t=e.srcPages,n=e.destDocs,i=void 0===n?[]:n,r=e.layerName,o=void 0===r?"":r,a=e.bookmarkTitle,s=void 0===a?"":a,u=this;return(0,_._)((function(){var e;return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return[4,u.api.exportPagesToPDFDocs(u.id,t,i.map((function(e){var t=e.destDoc,n=e.destIndex;return{destDocId:t.getId(),destIndex:n}})),o,s)];case 1:return e=n.sent(),[4,Promise.all(e.map((r=(0,_._)((function(e){var t,n,i,r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return t=e.docId,n=e.name,i={},t?[4,u.engine.getPDFDocByCacheId(t)]:[3,2];case 1:return r=o.sent(),[3,3];case 2:r=null,o.label=3;case 3:return[2,(i.doc=r,i.name=n,i)]}}))})),function(e){return r.apply(this,arguments)})))];case 2:return[2,n.sent()]}var r}))}))()}},{key:"getPDFDocById",value:function(e){return this.engine.getPDFDocByCacheId(e)}},{key:"extractPages",value:function(e){if(-4!=this.checkPermission(4294967292))throw new Error("Permission error");var t=[],n=this.getPageCount();if((0,D._)(!e,Array))throw new Error("Param error. Only array is available.");if(0===e.length)throw new Error("Param error. Non-valid array.");return e.forEach((function(e){if((0,D._)(!e,Array))throw new Error("Param error. Only array is available.");if(0===e.length||e.length>2)throw new Error("Param error. Non-valid array.");if(isNaN(e[0])||e[0]<0||e[0]>=n)throw new Error("Param error: Index is out of the valid range.");if(e[1]&&(isNaN(e[1])||e[1]<0||e[1]>=n))throw new Error("Param error: Index is out of the valid range.")})),this.api.extractPages(this.id,e,(function(e){var n=e.arrayBuffer;t.push(n)}),undefined,undefined).then((function(e){return t}))}},{key:"copyPages",value:function(e,t){var n=this.getPageCount();if(!(0,j.isInteger)(t)||t>n)throw new Error("Param error: ToPageIndex is out of the valid range.");if(!Array.isArray(e))throw new Error("Param error. Only array is available.");if(0===e.length)throw new Error("Param error. Non-valid array.");return e.forEach((function(e){if(!Array.isArray(e))throw new Error("Param error. Only array is available.");if(0===e.length||e.length>2)throw new Error("Param error. Non-valid array.");if(!(0,j.isInteger)(e[0])||e[0]<0||e[0]>=n)throw new Error("Param error: Index is out of the valid range.");if(e[1]&&(!(0,j.isInteger)(e[1])||e[1]<=e[0]||e[1]>=n))throw new Error("Param error: Index is out of the valid range.")})),this.api.copyPages(this.id,e,t).then(this._importPagesAndUpdate.bind(this,t))}},{key:"_importPagesAndUpdate",value:function(e,t){var n=this;return(0,_._)((function(){var i,r;return(0,F.Jh)(this,(function(o){return n.info.pageSizes={},n.info.pageCount+=t.length,r=[],t.forEach((function(e){var t=new jy(e,n);r.push(t)})),(i=n.pageCache).splice.apply(i,[e,0].concat((0,I._)(r))),n.updatePageIndex(e,n.info.pageCount-1),n.updatePageLabelsByAction("insertPages",[e,t.length]),n.engine.eventEmitter.emit(le.importPages,r),[2,r]}))}))()}},{key:"saveCopyPagesData",value:function(e){return this.api.saveCopyPagesData(this.id,e)}},{key:"pastePages",value:function(e){return this.api.pastePages(this.id,e).then(this._importPagesAndUpdate.bind(this,e))}},{key:"embedAllPageThumbnail",value:function(e){var t=this,n=function(i){e(i),(1===i||-1===i)&&t.api.workerPromise.off("embeddingProgress",n)};return this.api.workerPromise.on("embeddingProgress",n),this.api.embedAllPageThumbnail(this.id).then((function(e){e&&t.engine.eventEmitter.emit(le.docModified,t)}))}},{key:"removeEmbeddedPageThumbnail",value:function(e){var t=this,n=function(i){e(i),1!==i&&-1!==i||t.api.workerPromise.off("removingProgress",n)};return this.api.workerPromise.on("removingProgress",n),this.api.removeEmbeddedPageThumbnail(this.id).then((function(e){e&&(t.engine.eventEmitter.emit(le.removeEmbeddedPageThumbnail),t.removePageStatus=!0)}))}},{key:"cancelEmbedAllPageThumbnail",value:function(){return this.api.cancelEmbedAllPageThumbnail(this.id)}},{key:"cancelRemoveEmbeddedPageThumbnail",value:function(){return this.api.cancelRemoveEmbeddedPageThumbnail(this.id)}},{key:"setPagesBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.indexes,n=e.width,i=e.height,r=e.offsetX,o=e.offsetY,a=e.boxes,s=e.removeWhiteMargin;if(!Array.isArray(t))return Promise.reject(new Error("Missing require parameter or incorrect type: 'indexes'"));var u=this.getPageCount();for(var c in t){var l=t[c];if(!(0,j.isNumberInRange)(l,0,u,!0,!1))return Promise.reject(new Error("Incorrect page index: ".concat(l,", it must be in the range of 0 to ").concat(u-1,". indexes: [").concat(t.join(","),"]")))}return this.setAllBoxesByIndexes(t,n,i,r,o,a||{},s)}},{key:"getAllBoxesByPageIndex",value:function(e){var t=this.getPageCount();return(0,j.isNumberInRange)(e,0,t,!0,!1)?this.api.getAllBoxes(this.id,e).then((function(e){return e})):Promise.reject(new Error("Incorrect page index: ".concat(e,", it must be in the range of 0 to ").concat(t-1)))}},{key:"setAllBoxesByIndexes",value:function(e,t,n,i,r,o,a){var s=this;if(-4!==this.checkPermission(4294967292))throw new Error("Permission error");return this.api.setAllBoxesByIndexes(this.id,e,t,n,i,r,o,a).then((function(e){var t=[];return e.forEach((function(e){var n=e.index;s.updatePageSize(n,e.width,e.height);var i=s.pageCache,r=i[n];r?r._updateInfo(e):r=new jy(e,s),i[n]=r,t.push(r)})),s.engine.eventEmitter.emit(le.pagesBoxChange,t),t}))}},{key:"getPageFormat",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;if("batesNumbering"!==e&&-4!==this.checkPermission(4294967292))throw new Error("Permission error");return this.api.getPageFormat(this.id,e,t,n,i,r,o).then((function(e){return e}))}},{key:"getPageFormatThumb",value:function(e,t,n,i,r,o,a){if(-4!==this.checkPermission(4294967292))throw new Error("Permission error");return this.api.getPageFormatThumb(this.id,e,t,n,i,r,o,a).then((function(e){return e}))}},{key:"addPageFormat",value:function(e,t,n){var i=this;if(-4!==this.checkPermission(4294967292))throw new Error("Permission error");return this.api.addPageFormat(this.id,e,t,n).then((function(t){if(t>0&&"watermark"==e){var n=[],r=!0,o=!1,a=void 0;try{for(var s,u=i.pageCache[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;if(c){var l=c.getAnnots(!0);n.push(l)}}}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return Promise.all(n).then((function(){return i.setDocModified(),t}))}return i.setDocModified(),t}))}},{key:"removeAllPageFormat",value:function(e){var t=this;if(-4!==this.checkPermission(4294967292))throw new Error("Permission error");return this.api.removeAllPageFormat(this.id,e).then((function(n){if(n>0&&"watermark"==e){var i=[],r=!0,o=!1,a=void 0;try{for(var s,u=t.pageCache[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;if(c){var l=c.getAnnots(!0);i.push(l)}}}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return Promise.all(i).then((function(){return t.setDocModified(),n}))}return n>0&&t.setDocModified(),n}))}},{key:"extractPrintPages",value:function(e){return this.api.extractPrintPages(this.id,e).then((function(e){return e}))}},{key:"getHeaderFooter",value:function(){var e=this;return this.HF?Promise.resolve(this.HF):this.getPageFormat("headerfooter").then((function(t){if(t.res>0){var n=Ty(t.old,e.getPageCount());return e.HF=new dk(n)}return null}))}},{key:"updateHeaderFooter",value:function(e){var t=this;if(!this.checkPermission(Qt.modify))throw new Error("Permission error");var n=Ry(e,0,this.getPageCount());return this.getPageFormat("headerfooter").then((function(i){var r=!1;return i.res>0&&(r=!0),t.addPageFormat("headerfooter",n,r).then((function(i){if(i>0){var r=Ty(n,t.getPageCount());return t.HF?t.HF.json=r:t.HF=new dk(r),e.json=r,t.engine.eventEmitter.emit(le.headerFooterUpdated,e.range),t.engine.eventEmitter.emit(le.docModified,t),r}return i}))}))}},{key:"addHeaderFooter",value:function(e){var t=this;if(e.isEmpty())return Promise.resolve();if(!this.checkPermission(Qt.modify))throw new Error("Permission error");var n=Ry(e,0,this.getPageCount());return this.getPageFormat("headerfooter").then((function(i){return t.addPageFormat("headerfooter",n).then((function(i){if(i>0){var r=Ty(n,t.getPageCount());return t.HF?t.HF.json=r:t.HF=new dk(r),e.json=r,t.engine.eventEmitter.emit(le.headerFooterAdded,e.range),t.engine.eventEmitter.emit(le.docModified,t),r}return i}))}))}},{key:"removeHeaderFooter",value:function(){var e=this;if(!this.checkPermission(Qt.modify))throw new Error("Permission error");return delete this.HF,this.getPageFormat("headerfooter").then((function(t){return e.removeAllPageFormat("headerfooter").then((function(t){return e.engine.eventEmitter.emit(le.headerFooterUpdated),e.engine.eventEmitter.emit(le.docModified),t}))}))}},{key:"addWatermark",value:function(e){var t=this,n=0,i="addWatermark",r=de.progressChanged,o=e.type,a=e.text;if("text"!==o&&"bitmap"!==o)throw new Error("Param error:Type error");if("text"===o&&sn(a))throw new Error("Param error:Strings that are all space characters are invalid");if(e.useRelativeScale&&e.isMultiline)throw new Error("Param error: UseRelativeScale and isMultiline cannot be set to true at the same time");if(e.pageStart<0||e.pageStart>=this.getPageCount()||e.pageEnd<0||e.pageEnd>=this.getPageCount()||e.pageStart>e.pageEnd)throw new Error("Param error: Invalid pageStart or pageEnd");if(!this.checkPermission(Qt.modify))throw new Error("Permission error");this.engine.eventEmitter.emit(r,i,n,Rm.PROGRESSING);var s=Fy(e,0,e.pageStart,e.pageEnd,this.getPageCount());return this.getPageFormat("watermark").then((function(o){return t.engine.eventEmitter.emit(r,i,n+=30,Rm.PROGRESSING),t.addPageFormat("watermark",s).then((function(o){if(t.engine.eventEmitter.emit(r,i,n+=30,Rm.PROGRESSING),o>0){for(var a={},u=[],c=e.pageStart,l=e.pageEnd,d=c;d<=l;d++)u.push(t.getPageByIndex(d).then((function(e){s.isKeep&&e.annots.length>0&&(a=e.annots[e.annots.length-1].info,t.engine.eventEmitter.emit(le.annotationAdd,e.annots,e)),t.engine.eventEmitter.emit(le.watermarkAdded,e)})));return Promise.all(u).then((function(e){return t.engine.eventEmitter.emit(r,i,100,Rm.SUCCESS),a}))}return t.engine.eventEmitter.emit(r,i,n,Rm.FAIL),o}))})).catch((function(e){throw t.engine.eventEmitter.emit(r,i,n,Rm.FAIL),e}))}},{key:"removeAllWatermarks",value:function(){var e=this;return this.removeAllPageFormat("watermark").then((function(t){return t>0&&e.engine.eventEmitter.emit(le.watermarkRemoved),t>=0}))}},{key:"removeSignature",value:function(e){var t=this;if(!e)throw new Error("Invalid param fieldName: ".concat(e,"."));return(this.PDFForm?Promise.resolve():this.loadPDFForm()).then((function(){var n=t.PDFForm.getField(e);if(!n)throw new Error("Can not find field.");if(n.getType()!==gn.Sign)throw new Error("Unsupported field type: ".concat(n.getType(),"."));if(4===n.info.signatureType)return n.getControlByIndex(0).getWidgetAnnot().then((function(e){return t.removePagingSealSignature({pagingSigObjNum:e.getId()})})).then((function(){return Promise.resolve(!0)}));for(var i=0;i<n.getControlsCount();i++){var r=n.getControlByIndex(i).getWidget();if(r){var o=r.getPage();o.clearAnnotIds([r.getId()]),t.engine.eventEmitter.emit(le.annotationRemoved,[r],o),n.removeControlInfo(r.getId(),!1)}}return 0===n.getControlsCount()&&t.PDFForm.removeEngineField(e),t.api.removeControl(t.id,0,e,0)}))}},{key:"sign",value:function(e,t){var n=this,i=arguments,r=0,o="sign",a=de.progressChanged;try{if(this.engine.eventEmitter.emit(a,o,r,Rm.PROGRESSING),!this.checkPermission(Qt.annotForm)&&!this.checkPermission(Qt.fillForm))throw new Error("Permission error");var s=Promise.resolve();if(!e.fieldName&&void 0===e.pageIndex&&e.pagingSigConfig&&(s=s.then((function(){return ib(e.pagingSigConfig,n).then((function(){return rb(e.pagingSigConfig).then((function(t){e.pagingSigConfig=t}))}))}))),e.defaultContentsLength||(e.defaultContentsLength=7942),e.defaultContentsLength<4098)throw new Error("The default length of signature contents should not be less than 4098, in bytes");var u=e.rect;if(u&&!e.noCheckRect){var c=u.left,l=u.right,d=u.top,h=u.bottom;if(l<=c||d<=h)throw new Error("Signature rect error.")}if(!(e.filter&&e.subfilter||"string"==typeof e.shareVDictType))throw new Error("Filter and Subfilter can't be null.");e.timeFormat=Object.assign({},{format:"YYYY.MM.DD HH:mm:ss Z",timeZoneOptions:{separator:"'"}},e.timeFormat);var f=e.image;return void 0!==f&&(e.inkSign=f,delete e.image),this.isDynamicXFA()||(this.PDFForm||(s=s.then((function(){return n.loadPDFForm()}))),s=s.then((function(t){if(Array.isArray(e.pageIndex)&&Array.isArray(e.rect)){if(0===e.pageIndex.length||0===e.rect.length)throw new Error("pageIndex and rect should not be empty array.");if(e.pageIndex.length!==e.rect.length)throw new Error("pageIndex and rect should have the same length.");if(1!==e.pageIndex.length){var i=e.pageIndex.map((function(t,n){return{pageIndex:t,rect:e.rect[n]}}));return n.PDFForm.addSignatureBatch(i,e.shareVDictType).then((function(t){return n.engine.eventEmitter.emit(a,o,r+=20,Rm.PROGRESSING),delete e.pageIndex,delete e.rect,delete e.fieldName,e.fieldNames=t.map((function(e){return e.getName()})),new Promise((function(e){return setTimeout((function(){e()}),50)}))}))}e.pageIndex=e.pageIndex[0],e.rect=e.rect[0]}var s;if(s=e.fieldName){var u=n.PDFForm.getField(s);if(!u||u.getType()!=gn.Sign)throw new Error("Field type error: not a signature.")}var c=e.pageIndex;if(void 0!==c){Zk(c,n.getPageCount());var l={mkRotate:(e.rotation||0)/90%4,useExistedSignFieldName:e.useExistedSignFieldName};return n.PDFForm.addSignature(c,e.rect,s,l).then((function(t){return n.engine.eventEmitter.emit(a,o,r+=20,Rm.PROGRESSING),delete e.pageIndex,delete e.rect,e.fieldName=t.getName(),new Promise((function(e){return setTimeout((function(){e()}),50)}))}))}}))),s.then((function(t){return n.api.signDoc(n.id,e,i[2])})).then((function(t){return n.engine.eventEmitter.emit(a,o,r+=20,Rm.PROGRESSING),"pageIndex"in e?n.getPageByIndex(e.pageIndex).then((function(e){return Promise.all([e,e.getUnloadedAnnots()])})).then((function(e){var t=(0,E._)(e,2),i=t[0],r=t[1];n.engine.eventEmitter.emit(le.annotationAdd,r,i)})).then((function(e){return t})):t})).then((function(i){if(n.engine.eventEmitter.emit(a,o,r+=20,Rm.PROGRESSING),e.native)return[i];if(0===e.shareVDictType)return[];for(var s=[],u=0,c=0;c<i.byteRange.length;c+=2){var l=i.byteRange[c],d=i.byteRange[c+1];u||(u=l+d+1);var h=i.buffer.slice(l,l+d);s.push(h)}var f=new Blob(s);return Promise.all([i,t(e,f),u])})).then((function(t){var i=(0,E._)(t,3),r=i[0],s=i[1],u=i[2];if(e.native)return n.engine.eventEmitter.emit(a,o,100,Rm.SUCCESS),r;if(0!==e.shareVDictType){if(s.byteLength>e.defaultContentsLength)throw new Error("Signed data is larger than the default length, in bytes");var c=new Uint8Array(s).reduce((function(e,t){return e.push(qk[(240&t)>>>4]),e.push(qk[15&t]),e}),[]);return n.engine.eventEmitter.emit(a,o,100,Rm.SUCCESS),new Blob([r.buffer.slice(0,u),new Uint8Array(c),r.buffer.slice(u+c.length)],{type:"application/pdf"})}n.engine.eventEmitter.emit(a,o,100,Rm.SUCCESS)})).catch((function(e){throw n.engine.eventEmitter.emit(a,o,r,Rm.FAIL),e}))}catch(e){throw this.engine.eventEmitter.emit(a,o,r,Rm.FAIL),e}}},{key:"signForESignCN",value:function(e,t){var n=this;if(!this.checkPermission(Qt.annotForm)&&!this.checkPermission(Qt.fillForm))throw new Error("Permission error");var i=new Jy(this,this.engine);if(e.fields.forEach((function(e){var t;if(t=e.fieldName){var n=i.getField(t);if(!n||n.getType()!=gn.Sign)throw new Error("Field type error: not a signature.")}})),!e.config.filter||!e.config.subfilter)throw new Error("Filter and Subfilter can't be null.");var r=[Promise.resolve()];return e.fields.forEach((function(e,t){var o=e.pageIndex;if(void 0!==o){Zk(o,n.getPageCount());var a=Promise.resolve();if(!e.fieldName&&e.fieldId)return void(r[t]=a);a=i.addSignature(o,e.rect,e.fieldName,{isESignCN:!0}).then((function(t){return e.fieldName=t.getName(),new Promise((function(e){return setTimeout((function(){e()}),50)}))})),r[t]=a}})),Promise.all(r).then((function(t){return n.api.signDocForESignCN(n.id,e)})).then((function(t){var i=[Promise.resolve()];return e.fields.forEach((function(e,r){if("pageIndex"in e){var o=n.getPageByIndex(e.pageIndex).then((function(e){return Promise.all([e,e.getUnloadedAnnots()])})).then((function(e){var t=(0,E._)(e,2),i=t[0],r=t[1];n.engine.eventEmitter.emit(le.annotationAdd,r,i)})).then((function(e){return t}));i[r]=o}else i[r]=Promise.resolve()})),Promise.all(i).then((function(e){return t}))})).then((function(n){for(var i=[],r=0,o=0;o<n.byteRange.length;o+=2){var a=n.byteRange[o],s=n.byteRange[o+1];r||(r=a+s+1);var u=n.buffer.slice(a,a+s);i.push(u)}var c=new Blob(i);return Promise.all([n,t(e,c),r])})).then((function(t){var n=(0,E._)(t,3),i=n[0],r=n[1],o=n[2];if(r.byteLength>e.defaultContentsLength)throw new Error("Signed data is larger than the default length, in bytes");var a=new Uint8Array(r).reduce((function(e,t){return e.push(qk[(240&t)>>>4]),e.push(qk[15&t]),e}),[]);return new Blob([i.buffer.slice(0,o),new Uint8Array(a),i.buffer.slice(o+a.length)],{type:"application/pdf"})}))}},{key:"isESignCNSignature",value:function(e,t){return this.api.isESignCNSignature(this.id,e,t)}},{key:"addPagingSealSignature",value:function(e){var t=this;this.engine.eventEmitter.emit(de.progressChanged,"addPagingSealSignature",0,Rm.PROGRESSING);var n=(e||{}).pagingSigConfig;return ib(n,this).then((function(){return rb(n)})).then((function(e){return t.engine.eventEmitter.emit(de.progressChanged,"addPagingSealSignature",20,Rm.PROGRESSING),t.api.addPagingSealSignature(t.id,{pagingSigConfig:e})})).then((function(e){if(e&&e.pagingSigObjNum){t.engine.eventEmitter.emit(de.progressChanged,"addPagingSealSignature",40,Rm.PROGRESSING);var i=e.pagingSigObjNum,r=e.addedObjNums;return t.reloadPDFForm().then((function(){t.engine.eventEmitter.emit(de.progressChanged,"addPagingSealSignature",60,Rm.PROGRESSING);var e=[],o=!0,a=!1,s=void 0;try{for(var u,c=function(){var i=u.value;if(!i)return"continue";var o=i.getIndex();if(o+1<n.pageRange[0]||o+1>n.pageRange[1])return"continue";var a=i.getUnloadedAnnots().then((function(e){var n=e.filter((function(e){return r.includes(e.getId())}));t.engine.eventEmitter.emit(le.annotationAdded,n,i)}));e.push(a)},l=t.pageCache[Symbol.iterator]();!(o=(u=l.next()).done);o=!0)c()}catch(e){a=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}return t.engine.eventEmitter.emit(de.progressChanged,"addPagingSealSignature",80,Rm.PROGRESSING),Promise.all(e).then((function(){return t.engine.eventEmitter.emit(de.progressChanged,"addPagingSealSignature",100,Rm.SUCCESS),i}))}))}t.engine.eventEmitter.emit(de.progressChanged,"addPagingSealSignature",40,Rm.FAIL)}))}},{key:"updatePagingSealSignature",value:function(e){var t=this,n=e||{},i=n.pagingSigConfig,r=n.pagingSigObjNum;return ib(i,this).then((function(){if(!r)throw new Error("Invalid param pagingSigObjNum: ".concat(r,"."));return t.getAllPagingSealSignatures(r).then((function(e){if(!e.length)throw new Error("Can not find param pagingSigObjNum: ".concat(r," associated paging seal signature in current document."))}))})).then((function(){return rb(i)})).then((function(e){return t.api.updatePagingSealSignature(t.id,{pagingSigConfig:e,pagingSigObjNum:r})})).then((function(e){if(e&&e.pagingSigObjNum){var n=e.pagingSigObjNum,i=e.removedObjNums,r=e.addedObjNums;return t.reloadPDFForm().then((function(){var e=[],o=!0,a=!1,s=void 0;try{for(var u,c=function(){var n=u.value;if(!n)return"continue";var o=n.getAnnots().then((function(e){var r=e.filter((function(e){return i.includes(e.getId())}));r.length&&t.engine.eventEmitter.emit(le.annotationRemoved,r,n)}));e.push(o);var a=n.getAnnots(!0).then((function(e){var i=e.filter((function(e){return r.includes(e.getId())}));i.length&&t.engine.eventEmitter.emit(le.annotationAdded,i,n)}));e.push(a)},l=t.pageCache[Symbol.iterator]();!(o=(u=l.next()).done);o=!0)c()}catch(e){a=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}return Promise.all(e).then((function(){return n}))}))}}))}},{key:"getAllPagingSealSignatures",value:function(e){return this.api.getAllPagingSealSignatures(this.id,e)}},{key:"removePagingSealSignature",value:function(e){var t=this;if(!this.checkPermission(Qt.annotForm)&&!this.checkPermission(Qt.fillForm))throw new Error("Permission error");var n=(e||{}).pagingSigObjNum;if(!n)throw new Error("Invalid param pagingSigObjNum: ".concat(n,"."));return this.getAllPagingSealSignatures(n).then((function(e){if(!e.length)throw new Error("Can not find param pagingSigObjNum: ".concat(n," associated paging seal signature in current document."))})).then((function(){return t.api.removePagingSealSignature(t.id,{pagingSigObjNum:n})})).then((function(e){if(e&&e.removedObjNums){var n=e.removedObjNums;return t.reloadPDFForm().then((function(){var e=[],i=!0,r=!1,o=void 0;try{for(var a,s=function(){var i=a.value;if(!i)return"continue";var r=i.getAnnots().then((function(e){var r=e.filter((function(e){return n.includes(e.getId())}));return r.length&&t.engine.eventEmitter.emit(le.annotationRemoved,r,i),i.getAnnots(!0)}));e.push(r)},u=t.pageCache[Symbol.iterator]();!(i=(a=u.next()).done);i=!0)s()}catch(e){r=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(r)throw o}}return Promise.all(e).then((function(){}))}))}}))}},{key:"getAllPagingSigsInfo",value:function(e){return this.api.getAllPagingSigsInfo(this.id,e)}},{key:"getOriginalStream",value:function(){return this.api.getOriginalStream(this.id)}},{key:"verifySignature",value:function(e,t){return this.api.getOriginalStream(this.id).then((function(e){return(0,D._)(e,Blob)?new Promise((function(t,n){var i=new FileReader;i.onloadend=function(e){t(i.result)},i.readAsArrayBuffer(e)})):Promise.resolve(e)})).then((function(n){var i=e.getByteRange();if(4!=i.length)return Promise.resolve(64);for(var r=new Uint8Array(n),o=new Uint8Array(i[1]+i[3]),a=0,s=0;s<i.length;s+=2){var u=i[s],c=i[s+1];o.set(r.slice(u,u+c),a),a+=c}for(var l=i[2]-i[1]-2,d=i[0]+i[1]+1,h=[],f=d;f<d+l;f+=2){var g=parseInt(String.fromCharCode(r[f]),16)<<4,v=parseInt(String.fromCharCode(r[f+1]),16);h.push(g+v)}return t(e,o,new Uint8Array(h),r.byteLength>i[2]+i[3])})).then((function(e){return+e}))}},{key:"attachFile",value:function(e){if(!this.checkPermission(Qt.modify))throw new Error("Permission error");return this.api.attachFile(this.id,e).then((function(e){return e}))}},{key:"getFontsInfo",value:function(){return this.api.getFontsInfo(this.id)}},{key:"getLayerNodeByIdBAK",value:function(e){var t=(e=e.toString()).split("-");try{for(var n=this.ocgs,i=0;i<t.length;i++)n=n.children[t[i]];return n}catch(e){return null}}},{key:"getLayerNodeById",value:function(e){if(!e&&0!==e)return"";var t,n=function(i){if(i&&i.id===e+"")t=i;else if(i.children&&i.children.length>0)for(var r=0;r<i.children.length&&!t;r++){var o=i.children[r];n(o)}};return n(this.ocgs),t}},{key:"getAdditionalAction",value:function(e){return this.AdditionalActions[e]}},{key:"loadAdditionalActions",value:function(){var e=this;return this.api.getDocAdditionalActions(this.id).then((function(t){for(var n in e.AdditionalActions={},t)e.AdditionalActions[n]=oo.createAction(t[n],e);return e.AdditionalActions}))}},{key:"hasArticle",value:function(){return this.info.hasArticle}},{key:"getPdfArticle",value:function(){return this.pdfArticle||(this.pdfArticle=new xk(this.engine,this)),this.pdfArticle}},{key:"getStructureRoles",value:function(){var e=this.getId();return this.api.getStructureRoles(e)}},{key:"resetEngineInstance",value:function(e){var t=this,n=(this.engine,this.parameters),i={range:{docId:this.id},headers:{}};n.idJWT&&(i.headers.jwt=n.idJWT),n.password&&(i.headers["x-auth-doc"]=btoa(n.password));var r,o,a=this.api,s=(0,j.createDeferred)();return a.resetEngine(this.id).then((function(t){var o=(0,E._)(t,2),a=o[0],s=o[1];return r=s,i.range.url=a,e.getPDFDocByHttpRangeRequest(i,n)})).then((function(e){return e.parse(n)})).then((function(n){return o=n,e.api.syncDataCache(t.id,r)})).then((function(){t.engine=e,t.api=e.api,s.resolve(o)}),(function(){s.reject(t)})),s.promise}},{key:"setColors",value:function(e){var t=this;return this.api.setDocColors(this.getId(),e).then((function(){t.info.readColors=e}))}},{key:"getColors",value:function(){return this.info.readColors||{background:4294967295,foreground:4278190080}}},{key:"setPageDisplayPreferences",value:function(e){return this.api.setPageDisplayPreferences(this.getId(),e)}},{key:"renderTemplatesByObjNum",value:function(e){return this.api.renderTemplatesByObjNum(this.id,Number(e))}},{key:"getNameTree",value:function(e){return this.api.getNameTree(this.id,Number(e))}},{key:"addNameTreeObj",value:function(e,t,n){return this.api.addNameTreeObj(this.id,Number(e),String(t),Number(n))}},{key:"removeNameTreeObj",value:function(e,t){return this.api.removeNameTreeObj(this.id,Number(e),String(t))}},{key:"replaceNameTreeObj",value:function(e,t,n){return this.api.replaceNameTreeObj(this.id,Number(e),String(t),Number(n))}},{key:"renameNameTreeObj",value:function(e,t,n){return this.api.renameNameTreeObj(this.id,Number(e),String(t),String(n))}},{key:"getPageIndexByObjNum",value:function(e){return this.api.getPageIndexByObjNum(this.id,Number(e))}},{key:"nameTreeTemplatesToPages",value:function(e){return this.api.nameTreeTemplatesToPages(this.id,String(e))}},{key:"nameTreePagesToTemplates",value:function(e){return this.api.nameTreePagesToTemplates(this.id,String(e))}},{key:"addFileSpec",value:function(e,t,n){return this.api.addFileSpec(this.id,String(e),t,n)}},{key:"setFileSpecDesc",value:function(e,t){var n=this;return this.api.setFileSpecDesc(this.id,String(e),Number(t)).then((function(i){return i&&n.engine.eventEmitter.emit(le.documentAttachmentModify,{desc:e,objNum:t}),i}))}},{key:"getFileSpecStream",value:function(e){var t=[];return this.api.getFileSpecStream(this.id,Number(e),(function(e){var n=e.arrayBuffer,i=e.blob;e.offset,e.size;i?t=i:t.push(n)})).then((function(){return t}))}},{key:"getFileSpecStreamByName",value:function(e){var t=[];return this.api.getFileSpecStreamByName(this.id,e,(function(e){var n=e.arrayBuffer,i=e.blob;e.offset,e.size;i?t=i:t.push(n)})).then((function(){return t}))}},{key:"addEmbeddedFileByAttachments",value:function(e,t){var n=this;return this.api.addEmbeddedFileByAttachments(this.id,String(e),Number(t)).then((function(e){return e&&n.engine.eventEmitter.emit(le.documentAttachmentAdd),e}))}},{key:"setEmbeddedFileByAttachments",value:function(e,t){var n=this;return this.api.setEmbeddedFileByAttachments(this.id,String(e),Number(t)).then((function(e){return e&&n.engine.eventEmitter.emit(le.documentAttachmentModify),e}))}},{key:"removeEmbeddedFileByAttachments",value:function(e){var t=this;return this.api.removeEmbeddedFileByAttachments(this.id,String(e)).then((function(e){return e&&t.engine.eventEmitter.emit(le.documentAttachmentRemove),e}))}},{key:"moveAnnotsToPage",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=Object.keys(n).map((function(e){return+e})),a=o.map((function(t){return e.annotIdMap[t]})).filter((function(e){return!!e})),s="widget"!=a[0].getType();return this.api.moveAnnotsToPage(this.id,e.getId(),t.getId(),n).then((function(u){return Promise.resolve(e.clearAnnotIds(o)).then((function(e){return t.getUnloadedAnnots()})).then((function(o){if("popup"===o[0].info.type){var u=o[0];o[0]=o[1],o[1]=u}var c=i.engine.eventEmitter;return c.emit(le.annotationRemoved,a,e),c.emit(le.annotationAdd,o,t),r||(c.emit(le.moveAnnotsToPages,e,t,n,s),c.emit(le.annotationMovedPosition,o,t,o[o.length-1])),c.emit("updatePageAnnot",e,a,t,o),o}))}))}},{key:"getInfo",value:function(){var e=this;return this.api.getPDFDictInfo(this.id).then((function(t){return new Cy(e,t.id,e.engine)}))}},{key:"getInfos",value:function(){return this.api.getInfos(this.id)}},{key:"hasDocIsWrapped",value:function(){return this.api.hasDocIsWrapped(this.id)}},{key:"getPageLabels",value:function(e){return this.api.getPageLabels(this.id,e)}},{key:"autoRecognitionForm",value:function(){var e=this,t=0,n="autoRecognitionForm",i=de.progressChanged;return this.engine.eventEmitter.emit(i,n,t+=30,Rm.PROGRESSING),this.api.autoRecognitionForm(this.id).then((function(r){var o=[];return 0===r?(e.engine.eventEmitter.emit(i,n,100,Rm.SUCCESS),r):(e.engine.eventEmitter.emit(le.recognitionForm,e),e.reloadPDFForm().then((function(a){e.engine.eventEmitter.emit(i,n,t+=30,Rm.PROGRESSING);var s=!0,u=!1,c=void 0;try{for(var l,d=function(){var t=l.value;if(!t)return"continue";var n=t.getUnloadedAnnots().then((function(n){return n&&n.length>0&&e.engine.eventEmitter.emit(le.annotationAdd,n,t),Promise.resolve()}));o.push(n)},h=e.pageCache[Symbol.iterator]();!(s=(l=h.next()).done);s=!0)d()}catch(e){u=!0,c=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}return Promise.all(o).then((function(){return e.engine.eventEmitter.emit(i,n,100,Rm.SUCCESS),e.engine.eventEmitter.emit(le.permissionChanged,e),r}))})))}))}},{key:"isStaticXFA",value:function(){return 1==this.info.fileType}},{key:"isDynamicXFA",value:function(){return 2==this.info.fileType}},{key:"isXFA",value:function(){return Promise.resolve(0!=this.info.fileType)}},{key:"isXFARemoved",value:function(){return this.info.XFARemoved}},{key:"removeXFA",value:function(){var e=this;return this.api.removeXFA(this.id).then((function(t){return!!t&&(e.info.XFARemoved=!0,e.reloadPDFForm().then((function(t){return e.PDFForm.reloadForm(t.formInfo)})).then((function(){return!0})))}))}},{key:"pdfPortfolio",get:function(){if(this.isPortfolio())return this._pdfPortfolio||(this._pdfPortfolio=new vk(this.engine,this)),this._pdfPortfolio},set:function(e){this._pdfPortfolio=e}},{key:"isPortfolio",value:function(){return this.info.isPortfolio}},{key:"startPageEdit",value:function(e,t,n,i){return this.pageEditing?Promise.resolve():(this.pageEditing=!0,this.engine.eventEmitter.emit(le.objectStartEdit),this.api.handlePageEditorEvent(this.id,"StartEdit",!1,e,t,n,i))}},{key:"endPageEdit",value:function(){return this.pageEditing=!1,this.engine.eventEmitter.emit(le.objectEndEdit),this.api.handlePageEditorEvent(this.id,"EndEdit")}},{key:"startFormDesignerAssit",value:function(){return this.api.startFormDesignerAssit(this.id)}},{key:"stopFormDesignerAssit",value:function(){return this.api.stopFormDesignerAssit(this.id)}},{key:"reversePages",value:function(e){var t=this;return this.api.reversePages(this.id,e).then((function(e){var n=e.length;if(n>0){for(var i=0,r=n-1;i<r;i++,r--){var o=t.pageCache[i];t.pageCache[i]=t.pageCache[r],t.pageCache[r]=o}t.updatePageIndex(0,n-1);for(var a=0,s=n-1;a<s;a++,s--)t.engine.eventEmitter.emit(le.pagesMoved,e)}})).then((function(e){return t.getPageSizes()}))}},{key:"reversePagesWithMovePages",value:function(e){var t=this;return(0,_._)((function(){var n,i,r,o,a;return(0,F.Jh)(this,(function(s){switch(s.label){case 0:if(!((n=e.length)>1))return[3,6];i=0,r=n-1,s.label=1;case 1:return i<r?(o=Math.min(e[i],e[r]),a=Math.max(e[i],e[r]),[4,t.movePagesTo([[a]],0)]):[3,6];case 2:return s.sent(),[4,t.movePagesTo([[o+1]],a+1)];case 3:return s.sent(),[4,t.movePagesTo([[0]],o+1)];case 4:s.sent(),s.label=5;case 5:return i++,r--,[3,1];case 6:return t.updatePageLabelsByAction("reversePages",[Array.from(e,(function(e,t){return t}))]),[2]}}))}))()}},{key:"movePagesTo",value:function(e){var t,n,i=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=this.getPageCount();if(!e||0===e.length||(t=Math).min.apply(t,(0,I._)(e.flat()))<0||(n=Math).max.apply(n,(0,I._)(e.flat()))>o-1)throw new Error("Param error: pageRange is out of the valid range.");if(isNaN(r)||r<0||r>o)throw new Error("Param error: Index is out of the valid range.");var a=[];return e.forEach((function(e){for(var t=e[0];t<=e[e.length-1];t++)a.push(t)})),e=Array.from(new Set(a.sort((function(e,t){return e-t})))),this.api.movePagesTo(this.id,e,r).then((function(t){if(t){var n=Zo(e).sort((function(e,t){return e-t}));return i.pageCache=t.reduce((function(e,t,n){var r=i.pageIdMap[t];return r&&(r.info.index=n),e[n]=r,e}),[]),i.updatePageIndex(Math.min(r,n[0]),Math.max(r,n[n.length-1])),i.engine.eventEmitter.emit(le.pagesMoved,e,r,t),i.updateRootBookmark().then((function(e){return i.getPageSizes()})).then((function(e){return t}))}}))}},{key:"movePagesToThenUpdatePageLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this;return(0,_._)((function(){var i,r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return[4,n.movePagesTo(e,t)];case 1:return i=o.sent(),r=e.reduce((function(e,t){var n=(0,E._)(t,2),i=n[0],r=n[1];if(void 0===r)e.push(i);else{for(var o,a=[];i<=r;)a.push(i++);(o=e).push.apply(o,(0,I._)(a))}return e}),[]),e=Array.from(new Set(r.sort((function(e,t){return e-t})))),n.updatePageLabelsByAction("movePages",[e,t]),[2,i]}}))}))()}},{key:"startReplacePages",value:function(e,t,n,i){var r=this,o=[];return i.forEach((function(e){for(var t=e[0];t<=e[e.length-1];t++)o.push(t)})),i=Array.from(new Set(o.sort((function(e,t){return e-t})))),this.api.startReplacePages(this.id,e,t,n,i).then((function(n){var i;if(n&&n.error)return n;r.info.pageSizes={},r.info.pageCount-=t,r.info.pageCount+=n.length;var o=[];n.forEach((function(e){var t=new jy(e,r);o.push(t)})),(i=r.pageCache).splice.apply(i,[e,t].concat((0,I._)(o))),r.updatePageIndex(e,r.info.pageCount-1);var a=new Array(t).fill(0).map((function(t,n){return e+n}));return r.engine.eventEmitter.emit(le.pagesReplace,{delPageRange:a,pages:o}),n}))}},{key:"setPageTransition",value:function(e,t,n,i){var r=[];return i.forEach((function(e){for(var t=e[0];t<=e[e.length-1];t++)r.push(t-1)})),i=Array.from(new Set(r.sort((function(e,t){return e-t})))),this.api.setPageTransition(this.id,e,t,n,i)}},{key:"getPageTransitionByIndex",value:function(e){return this.api.getPageTransitionByIndex(this.id,e)}},{key:"getStampTypeByPageIndex",value:function(e){return this.api.getStampTypeByPageIndex(this.id,e)}},{key:"removePages",value:function(e){var t=this;if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");this.info.pageSizes={};var n=this.getPageCount();if(1===n)throw new Error("Not allowed to remove the only page.");Hk(e,n,"remove");for(var i=Zo(e).sort((function(e,t){return t-e})),r=[],o=0;o<i.length;o++){var a=i[o];this.pageCache[a]||r.push(this.getPageByIndex(a))}return Promise.all(r).then((function(n){return t.api.removePages(t.id,e).then((function(n){var r=[];return i.forEach((function(e){t.PDFForm&&t.PDFForm.afterRemovePage(e),t.info.pageCount--,r.push(t.pageCache[e].info.objectNumber),t.pageCache.splice(e,1),t.updatePageIndex(e,t.info.pageCount-1)})),t.updatePageLabelsByAction("deletePages",[e]),t.engine.eventEmitter.emit(le.pagesRemoved,e,r),t.removePageStatus=!0,t.updateRootBookmark().then((function(e){return t.getPageSizes()})).then((function(e){return n}))}))}))}},{key:"insertBlankPages",value:function(e,t,n){var i=this;if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");this.info.pageSizes={};var r=this.getPageCount();if("number"!=typeof t||"number"!=typeof n)throw new Error("param error. Only number is available.");return Hk(e,r,"insert"),this.api.insertBlankPages(this.id,e,t,n).then((function(e){var t=[];return e.forEach((function(e){t.push(Promise.resolve((delete i.ocgs,i.api.getLayerNodes(i.id).then((function(e){return i.ocgs=e})).then((function(t){return e})).then((function(e){if(!e)return!1;i.info.pageCount++;var t=new jy(e,i);return i.pageCache.splice(e.index,0,t),i.updatePageIndex(e.index+1,i.info.pageCount-1),i.PDFForm&&i.PDFForm.afterInsertPage(e.index),t})))))})),eb(t).then((function(t){return i.updatePageLabelsByAction("insertPagesByRange",[e.map((function(e){return e.index}))]),i.engine.eventEmitter.emit(le.insertPages,t),t})).then((function(e){return i.getPageSizes().then((function(t){return i.updateRootBookmark().then((function(t){return e}))}))}))}))}},{key:"rotatePages",value:function(e,t){var n=this;if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");if(Object.values(ft).every((function(e){return e!==t})))throw new Error("rotation parameter error");var i=this.getPageCount();Hk(e,i,"get");var r=Zo(e);return Qk(this,r).then((function(i){var r=i.map((function(e){return e.getRotation()}));return n.api.rotatePages(n.id,e,t).then((function(e){var o=[];return i.forEach((function(e){n.pageCache[e.getIndex()].info.rotation=t,o.push(e.updateInfo()),o.push(n.getPageSizes())})),Promise.all(o).then((function(e){n.engine.eventEmitter.emit(le.pagesRotated,i,t,r)}))}))}))}},{key:"checkDocHasPageLabel",value:function(){return function(e,t){return"uninitialized"===e.hasPageLabelStatus&&Ik(e,t),e.hasPageLabel}(this._pageLabelInfo,this)}},{key:"checkDocIsUseLogicPage",value:function(){return this.api.checkDocIsUseLogicPage(this.id)}},{key:"getPageIndexByLabelText",value:function(e){return this.api.getPageIndexByLabelText(this.id,e)}},{key:"getCurrentPageLabelInfo",value:function(e){return this.api.getCurrentPageLabelInfo(this.id,e)}},{key:"formatPageNumbers",value:function(e,t){var n=this;return this.api.formatPageNumbers(this.id,!1,e,t).then((function(e){return Rk(n._pageLabelInfo,n),n.engine.eventEmitter.emit(le.pagesLabelChange),e}))}},{key:"formatPageNumbersExtendNumbering",value:function(e){var t=this;return this.api.formatPageNumbers(this.id,!0,e).then((function(e){return Rk(t._pageLabelInfo,t),t.engine.eventEmitter.emit(le.pagesLabelChange),e}))}},{key:"updatePageLabelsByAction",value:function(e,t){var n=this;return(0,_._)((function(){var i;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.api.updatePageLabelsByAction(n.id,e,t)];case 1:return i=r.sent(),Rk(n._pageLabelInfo,n),n.engine.eventEmitter.emit(le.pagesLabelChange),[2,i]}}))}))()}},{key:"getPageEditor",value:function(){return this.pageEditor?this.pageEditor:this.pageEditor=new Pk(this)}},{key:"getTouchup",value:function(){return new Ak(this)}},{key:"getJoinSplit",value:function(){return new Ak(this)}},{key:"getSpellCheck",value:function(){return new Ak(this)}},{key:"isCPDF",value:function(){return this.api.isCPDF(this.id)}},{key:"getDocURI",value:function(){return this.api.getDocURI(this.id)}},{key:"getVersionID",value:function(){return this.api.getVersionID({path:"jr/doc"},this.id)}},{key:"convertToCPDF",value:function(e,t,n,i){return this.api.convertToCPDF(this.id,e,t,n,i).then()}},{key:"removeCDocId",value:function(e,t,n,i){return this.api.removeCDocId(this.id,e,t,n,i).then()}},{key:"removeLayerNode",value:function(e){var t=this;if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");if(!e&&0!==e)return Promise.resolve(!1);var n=this.getLayerNodeById(e);if(n.isLocked)throw new Error("The destination layer node is locked");return(n.hasLayer?this.getLayerRelatedAnnots(e).then((function(n){return n&&n.length>0&&ob(t,n).then((function(e){e.forEach((function(e){e.page.removeAnnotById(e.id)}))})),t.api.removeLayerNode(t.id,e)})):this.api.removeLayerNode(this.id,e)).then((function(n){return n&&(t.engine.eventEmitter.emit(le.layerRemoved,t),t.engine.eventEmitter.emit(le.layerVisibleChange,t),nb(t.ocgs,[e])),n}))}},{key:"flattenLayers",value:function(){var e=this,t=[],n=function(e){if(e&&e.hasLayer&&!1===e.visible&&t.push(e),e.children&&e.children.length>0)for(var i=0;i<e.children.length;i++)n(e.children[i])};n(this.ocgs);var i=[];return t.forEach((function(t){i.push(e.getLayerRelatedAnnots(t.id))})),Promise.all(i).then((function(t){return t&&t.length>0&&(t=t.reduce((function(e,t){return e=e.concat(t)}),[]),ob(e,t).then((function(e){e.forEach((function(e){e.page.removeAnnotById(e.id)}))}))),e.api.flattenLayers(e.id)})).then((function(t){return t&&(e.ocgs.children=[]),t}))}},{key:"getVisiblePageLayers",value:function(e){var t=this,n=[];return e.forEach((function(e){var i=t.pageCache[e];i&&n.push(t.api.getLayersByPage(t.id,i.getId()))})),Promise.all(n).then((function(e){var t=[];return e.forEach((function(e){t=t.concat(e)})),t}))}},{key:"updateLayerInfo",value:function(e){if(!e.id&&0!==e.id)return Promise.resolve(!1);var t=this.getLayerNodeById(e.id);return this.api.updateLayerInfo(this.id,e).then((function(n){return n&&Object.assign(t,e),n}))}},{key:"mergeLayers",value:function(e,t){var n=this;return e&&0!==e.length&&t?(e=e.filter((function(e){return e!==t})),this.api.mergeLayers(this.id,e,t).then((function(i){return i&&(nb(n.ocgs,e),n.engine.eventEmitter.emit(le.layerMerged,e,t)),i}))):Promise.resolve(!1)}},{key:"getLayerRelatedAnnots",value:function(e){return this.api.getLayerRelatedAnnots(this.id,e)}},{key:"layerMoveTo",value:function(e,t,n){var i=this;return this.api.layerMoveTo(this.id,e,t,n).then((function(e){return e?(i.ocgs="",i.getLayerNodesJson().then((function(){return e}))):e}))}},{key:"addLayerNode",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.index,r=n.name,o=n.hasLayer,a=void 0!==o&&o;if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");var s=this.getLayerNodeById(e);if(!s)throw new Error("ParentLayerId is invalid");if(s.isLocked)throw new Error("The destination layer node is locked");if(!r)throw new Error("name is required");if(i<0||i>s.children.length)throw new Error("index is invalid");return this.api.addChild({path:"jr/doc/layer"},this.id,e,{index:i,name:r,hasLayer:a}).then((function(e){return i>=s.children.length?s.children.push(e):(s.children.splice(i,0,e),s.children.forEach((function(e,t){s.isRoot?e.id=t+"":e.id=s.id+"-"+t}))),t.engine.eventEmitter.emit(le.layerAdded,e),e}))}},{key:"addLayerGraphicObject",value:function(e,t,n){if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");var i=this.getLayerNodeById(e);if(!i)throw new Error("LayerNodeId is invalid");if(i.isLocked)throw new Error("The destination layer node is locked");if("number"!=typeof t)return Promise.reject(new Error("Options missing: 'pageIndex'"));var r=this.getPageCount();return t<0||t>=r?Promise.reject(new Error("Range of 'pageIndex' must be between 0 to ".concat(r-1,"(inclusive), but actual: ").concat(t,"."))):i.hasLayer?this.api.addGraphicObject({path:"jr/doc/layer"},this.id,e,t,n).then((function(e){return e})):Promise.resolve(!1)}},{key:"removeLayerGraphicObject",value:function(e,t,n){if(!this.checkPermission(Qt.assemble|Qt.modify))throw new Error("Permission error");var i=this.getLayerNodeById(e);if(!i)throw new Error("LayerNodeId is invalid");if(i.isLocked)throw new Error("The destination layer node is locked");if("number"!=typeof t)return Promise.reject(new Error("Options missing: 'pageIndex'"));var r=this.getPageCount();return t<0||t>=r?Promise.reject(new Error("Range of 'pageIndex' must be between 0 to ".concat(r-1,"(inclusive), but actual: ").concat(t,"."))):i.hasLayer?this.api.removeGraphicObject({path:"jr/doc/layer"},this.id,e,t,n).then((function(e){return e})):Promise.resolve(!1)}},{key:"removeMetadata",value:function(e){var t=this;if(e&&0!==e.length){var n=[];return e.forEach((function(e){n.push(t.api.removeMetadata(t.id,e).then((function(){t.metadata.hasOwnProperty(e)&&delete t.metadata[e],t.metadata.custom&&t.metadata.custom.hasOwnProperty(e)&&delete t.metadata.custom[e]})))})),Promise.all(n).then((function(e){return t.engine.eventEmitter.emit(le.metaDataChanged,t),!0}))}}},{key:"getDestinationsArray",value:function(){var e=this.getId();return this.api.getDestinationsArray(e)}},{key:"getTabOrder",value:function(e){return this.api.getTabOrder(this.id,e)}},{key:"setTabOrder",value:function(e,t){var n=this;return this.api.setTabOrder(this.id,e,t).then((function(e){return n.engine.eventEmitter.emit(le.docModified,n),e}))}},{key:"setStructureOrder",value:function(e,t){var n=this,i=function(t){if(0!==t.length)return n.api.setStructureOrder(n.id,e,t).then((function(e){return n.engine.eventEmitter.emit(le.docModified,n),e}))};return t?i(t):this.getPageAnnotsIdList(e).then(i)}},{key:"getEmbeddedFontData",value:function(){return this.api.getEmbeddedFontData(this.id)}},{key:"computeAuditSpace",value:function(){return this.api.computeAuditSpace(this.id)}},{key:"optimizer",value:function(e,t){var n=this;return this.api.optimizer(this.id,e,t).then((function(e){return{fileName:n.info.fileName,buffer:e}}))}},{key:"optimizeScannedPDF",value:function(e,t){var n=this,i=this.getPageCount(),r=e.pageRange;if(r){(r+="").endsWith(",")&&(r=r.slice(0,r.length-1));var o=r.split(",").map((function(e){var t=e.split("-");if(t.length>1){var n,r;e=[];for(var o=(n=Math).min.apply(n,(0,I._)(t)),a=Math.min((r=Math).max.apply(r,(0,I._)(t)),i),s=o;s<=a;s++)e.push(s);e=e.join(",")}return e}));o=o.join(",").split(",").map((function(e){return e-1})),r=Array.from(new Set(o.sort((function(e,t){return e-t})))),e.pageRange=r}return this.api.optimizeScannedPDF(this.id,e,t).then((function(e){return!!e&&{fileName:n.info.fileName,buffer:e}}))}},{key:"importAsLayer",value:function(e){var t=this;return e.targetFileName||(e.targetFileName=this.metadata.FileName||this.metadata.Title),this.api.importAsLayer(this.id,e).then((function(e){return e&&(t.ocgs=e,t.engine.eventEmitter.emit(le.layerVisibleChange,t)),e}))}},{key:"previewImportLayer",value:function(e){return this.api.previewImportLayer(this.id,e)}},{key:"reloadLayer",value:function(){return this.api.reloadLayer(this.id)}},{key:"exportMeasureData",value:function(e){var t=this;return this.api.exportMeasureData(this.id,e).then((function(e){var n=t.info.fileName||"Untitled.pdf";return{fileName:n=n.substr(0,n.lastIndexOf("."))+".csv",buffer:e}}))}},{key:"setRenderConfigLineWeight",value:function(e){return this.api.setRenderConfigLineWeight(this.id,e)}},{key:"search",value:function(e,t,n,i){return this.api.searchDoc(this.id,e,t,n,i)}},{key:"generateDocHash",value:function(e){return this.api.generateDocHash(this.id,e)}},{key:"getSignIdForEvidence",value:function(){return this.api.getSignIdForEvidence(this.id)}},{key:"getDocAuditTrail",value:function(e){var t=this;return this.getAssignInfoForESignCN().then((function(n){var i=[],r=n&&n.recipients;return r&&r.length>0&&(i=r.reduce((function(e,t){var n=t.annots&&t.annots.map((function(e){return(0,b._)((0,k._)({},e),{assignUserName:t.userName,assignUserEmail:t.email,company:t.company})}))||[];return(0,I._)(e).concat((0,I._)(n))}),[]).filter((function(e){return"FullSignature"===e.type}))),t.api.getDocAuditTrail(t.id,e,i).then((function(e){return e}))}))}},{key:"updatePropAuthDictForESignCN",value:function(e){var t=e.fieldName,n=e.willingnessInfo;return this.api.updatePropAuthDictForESignCN(this.id,t,n)}},{key:"assignSignerForESignCN",value:function(e){return e=function(e){return e.recipients=e.recipients.map((function(e){var t,n=e.email,i=e.mobile,r=e.company,o=e.companyId;n&&(t="Email"),i&&(t="Phone"),r&&(t="Company"),o&&(t="EnterpriseId");var a=[n,i,r,o].filter((function(e){return!!e}));return a.length>1&&(t="All"),e.authType=t,e})),e}(e),this.api.assignSignerForESignCN(this.id,e)}},{key:"getAssignInfoForESignCN",value:function(){return this.api.getAssignInfoForESignCN(this.id)}},{key:"checkFieldWhetherFill",value:function(e){return this.api.checkFieldWhetherFill(this.id,e)}},{key:"getOrderOfSignFlowFile",value:function(){return this.api.getOrderOfSignFlowFile(this.id)}},{key:"setESignCNFlowSignMode",value:function(e){return this.api.setESignCNFlowSignMode(this.id,e)}},{key:"getESignCNFlowSignMode",value:function(){return this.api.getESignCNFlowSignMode(this.id)}},{key:"isESignCNFile",value:function(){return this.api.isESignCNFile(this.id)}},{key:"getESignCNMode",value:function(e){return this.api.getESignCNMode(this.id,e)}},{key:"setSignatureAP",value:function(e){var t=e.pageIndex,n=e.annotId,i=e.inkSignBuffer,r=e.pagingSigObjNum;return this.api.setSignatureAP(this.id,t,n,i,r)}},{key:"getFlowSignInfo",value:function(){return this.api.getFlowSignInfo(this.id)}},{key:"addAuditTrail",value:function(){return this.api.addAuditTrail(this.id)}},{key:"convertToTextMarkup",value:function(e){var t=this;return this.api.convertToTextMarkup(this.id,e).then((function(e){e.forEach((function(e){var n=t.pageCache[e];n&&n.getUnloadedAnnots().then((function(e){return t.engine.eventEmitter.emit(le.annotationAdd,e,n)}))}))}))}},{key:"redactSearch",value:function(e,t,n,i,r){var o=this;return this.api.redactSearch(this.id,e,t,n,i,r).then((function(e){var t=[];return e.forEach((function(e){var n=o.pageCache[e];n&&t.push(n.getUnloadedAnnots().then((function(e){o.engine.eventEmitter.emit(le.annotationAdd,e,n)})))})),Promise.all(t)}))}},{key:"isScannedDoc",value:function(){return this.api.isScannedDoc(this.id)}},{key:"getCompareFileFilterNums",value:function(){return this.api.getCompareFileFilterNums(this.id)}},{key:"readonly",value:function(){var e=this;return(0,_._)((function(){var t,n,i;return(0,F.Jh)(this,(function(r){return t=e.info.pdfaid,n=!1,(i=window.localStorage.getItem("PREFERENCES-DOCUMENTS"))&&"onlyForPDFA"===JSON.parse(i).vieMode&&(n=!0),[2,t&&n&&!e.pdfaEditable]}))}))()}},{key:"isPdfaDoc",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){switch(t.label){case 0:return e.metadata.pdfaid?[3,2]:[4,e.getMetadata()];case 1:t.sent(),t.label=2;case 2:return[2,!!e.metadata.pdfaid]}}))}))()}},{key:"setPdfaEditable",value:function(e){e&&this.api.removePDFAID(this.id),this.pdfaEditable=e}},{key:"getText",value:function(e){var t=this;if(!this.checkPermission(Qt.extract))throw new Error("Permission error");if(this.isStaticXFA())throw new Error("File type error, current is Static documents");var n=this.getPageCount();tb(e,n-1);var i=(0,j.getUniqueId)("task_progress"),r=new Ek((function(){t.api.cancelTaskProgress(t.id,i)}));return this.api.getText(this.id,e,i,(function(e){r.updateProgress(e)})),r}},{key:"createSummarizeComments",value:function(e,t){var n=this,i=this.getId();return this.PDFForm?this.PDFForm.addTask().then((function(){return n.api.createSummarizeComments(n.id,e,t)})):this.api.createSummarizeComments(i,e,t)}},{key:"hiddenDataSanitizeDocument",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.api.hiddenDataSanitizeDocument(e.id)];case 1:return t.sent(),e.otherOptions.disableSavePrompt=!0,[2]}}))}))()}},{key:"hiddenDataRemoveHiddenInfo",value:function(e){var t=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.api.hiddenDataRemoveHiddenInfo(t.id,e)];case 1:return n.sent(),t.otherOptions.disableSavePrompt=!0,[2]}}))}))()}},{key:"getLRContentForChatWithDoc",value:function(e){return this.api.getLRContentForChatWithDoc(this.id,e)}},{key:"getDocPurText",value:function(){return this.api.getDocPurText(this.id)}},{key:"docCanDoOcr",value:function(){return this.api.docCanDoOcr(this.id)}},{key:"fetchContentByType",value:function(e){return this.api.fetchContentByType(this.id,e)}},{key:"searchText",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getPageCount();return tb(e,i-1),this.search(e,t,n,!1).then((function(e){var t={},n=!0,i=!1,r=void 0;try{for(var o,a=Object.entries(e)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=(0,E._)(o.value,2),u=s[0],c=s[1],l=[],d={};c.forEach((function(e){var t=e.rects,n=e.word;d={rects:t,word:n},l.push(d)})),t[u]=l}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t}))}},{key:"loadThumbnailTemp",value:function(e){var t=this;return(0,_._)((function(){var n,i,r,o,a,s,u,c,l,d,h,f,g;return(0,F.Jh)(this,(function(v){switch(v.label){case 0:return n=e.pageIndex,i=e.scale,r=e.rotation,o=e.type,a=e.width,s=e.height,"number"!=typeof n?[2,Promise.reject(new Error("Options missing: 'pageIndex'"))]:(u=t.getPageCount(),n<0||n>=u?[2,Promise.reject(new Error("Range of 'pageIndex' must be between 0 to ".concat(u-1,"(inclusive), but actual: ").concat(n,".")))]:i?[3,2]:[4,t.api.getPageSize({path:"jr/doc"},t.id,n)]);case 1:c=v.sent(),l=(0,U.F2)(c.width),d=(0,U.F2)(c.height),a||s||(a=200,s=300),h=a/l,f=s/d,i=isNaN(h)?f:isNaN(f)?h:Math.min(h,f),g=Math.min(Be/l,je/d),i/=g,v.label=2;case 2:return[2,t.api.getThumbTemp({path:"jr/doc",transfer:!0},t.id,n,r||0,i).then((function(e){switch(o||"canvas"){case"canvas":return $k(e);case"image":return zk(e).then((function(e){return t.addDestroyHook((function(){URL.revokeObjectURL(e.src)})),e}));case"buffer":return Gk(e);default:throw new Error("Invalid options.type: ".concat(o))}}))]}}))}))()}},{key:"loadThumbnail",value:function(e){var t=this,n=e.pageIndex,i=e.scale,r=e.rotation,o=e.type,a=e.width,s=e.height;if("number"!=typeof n)return Promise.reject(new Error("Options missing: 'pageIndex'"));var u=this.getPageCount();return n<0||n>=u?Promise.reject(new Error("Range of 'pageIndex' must be between 0 to ".concat(u-1,"(inclusive), but actual: ").concat(n,"."))):this.getPageByIndex(n).then((function(e){if(!e)throw new Error("Cannot obtains the page of index: ".concat(n));if(!i){var u=e.getPxWidth(),c=e.getPxHeight();a||s||(a=200,s=300);var l=a/u,d=s/c;i=isNaN(l)?d:isNaN(d)?l:Math.min(l,d);var h=Math.min(Be/u,je/c);i/=h}return e.getThumb(r||0,i).then((function(e){switch(o||"canvas"){case"canvas":return $k(e);case"image":return zk(e).then((function(e){return t.addDestroyHook((function(){URL.revokeObjectURL(e.src)})),e}));case"buffer":return Gk(e);default:throw new Error("Invalid options.type: ".concat(o))}}))}))}},{key:"verifyDocSignature",value:function(e){var t=this,n=this.getId();return this.engine.ensureSideModeLoaded().then((function(i){return t.api.verifyDocSignature(n,e)}))}},{key:"setSelectedInfo",value:function(e){this.selectedInfo=e}},{key:"clearSelectedInfo",value:function(e){this.selectedInfo=null,e&&(e.getStore().dispatch(xe.SELECTION_INFO,null),e.getPDFDocRender().pagesRender.pageRenders.forEach((function(e){e.$handler.find(".fv__mark-selection-blank").remove()})))}},{key:"updateTextSelectInfo",value:function(){if(!this.selectedInfo||this.selectedInfo.type!=Mt.Text)return Promise.resolve([]);var e=this.selectedInfo.selectedPages,t=[],n=!0,i=!1,r=void 0;try{for(var o,a=function(){var e=o.value,n=e.pageRender.getPDFPage().then((function(t){return t.getTextByIndex(e.characterIndexStart,e.characterIndexEnd)})).then((function(t){e.text=t}));t.push(n)},s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)a()}catch(e){i=!0,r=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}return Promise.all(t)}},{key:"addTextSelectedInfo",value:function(e,t,n,i){var r=this,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,u={pageRender:e,characterIndexStart:t,characterIndexEnd:n,rectArray:i,text:arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0};if(this.selectedInfo&&this.selectedInfo.type==Mt.Text){this.selectedInfo.e=o,this.selectedInfo.panStartEvent=a,this.selectedInfo.panMoveArr=s;var c=this.selectedInfo.selectedPages,l=!1;for(var d in c)if(c[d].pageRender.index==e.index)return void(c[d]=u);for(var h in c)if(c[h].pageRender.index>e.index){c.splice(Number(h),0,u),l=!0;break}l||c.push(u)}else this.selectedInfo={type:Mt.Text,selectedPages:[u],e:o,panStartEvent:a,panMoveArr:s,getText:function(){var e="";return r.selectedInfo.selectedPages.forEach((function(t){e=(""==e?"":e+"\r\n")+t.text})),e}}}},{key:"clearAllDesignerAssistCache",value:function(){return this.api.clearAllDesignerAssistCache(this.getId())}},{key:"removeEmbeddedFileByName",value:function(e){return this.removeEmbeddedFileByAttachments(e)}},{key:"removeAllEmbeddedFiles",value:function(){var e=this;return this.api.removeAllEmbeddedFiles(this.getId()).then((function(t){return t&&e.engine.eventEmitter.emit(le.documentAttachmentRemove),t}))}},{key:"getEmbeddedFileNames",value:function(){return this.api.getEmbeddedFileNames(this.getId())}},{key:"addEmbeddedFile",value:function(e,t){var n=this;if(!this.checkPermission(Qt.modify))throw new Error("Permission error");return!(!t||!t.data)&&this.api.addEmbeddedFile({path:"jr/doc"},this.id,e,t).then((function(e){return e&&n.engine.eventEmitter.emit(le.docAttachmentAdded),e}))}},{key:"setEmbeddedFile",value:function(e,t){var n=this;if(!this.checkPermission(Qt.modify))throw new Error("Permission error");return!(!e||0===e.length||!t)&&this.api.setEmbeddedFile({path:"jr/doc"},this.id,e,t).then((function(e){return e&&n.engine.eventEmitter.emit(le.documentAttachmentModify),e}))}},{key:"getEmbeddedFile",value:function(e){return e&&0!==e.length?this.api.getEmbeddedFile({path:"jr/doc"},this.id,e):null}},{key:"compareWith",value:function(e,t,n){var i=this;this._validateCompareWithParams(e,t);var r="function"==typeof n,o=r?(0,j.getUniqueId)("compare-progress"):null;if(t.stringResource=t.stringResource||{},r){var a=function(e){100===e&&i.api.workerPromise.off(o,a),n(e)};this.api.workerPromise.on(o,a)}return this.api.comparePDFDocuments(this.getId(),e.getId(),t,o).then((function(e){var n=e.docId,r=e.parameters;return i.engine.createPDFDocById(n,Object.assign({},{fileName:t.resultFileName||"The result of Comparison.pdf"},r))}))}},{key:"_validateCompareWithParams",value:function(e,t){var n=this.getPageCount(),i=e.getPageCount(),r=t.basePageRange,o=t.otherPageRange,a=function(e,t,n){var i=e.from,r=e.end;(0,j.assertThat)((0,j.isNumberInRange)(i,0,t,!0,!1),"[".concat(n,"]: The starting page index must be between 0 and ").concat(t)),(0,j.assertThat)((0,j.isNumberInRange)(r,0,t,!0,!1),"[".concat(n,"]: The ending page index must be between 0 and ").concat(t)),(0,j.assertThat)((0,j.isValidRange)(i,r,!0),"[".concat(n,"]: The starting page index must be less than or equal to the ending page index: from: ").concat(i,", end: ").concat(r))};r?Array.isArray(r)?(t.basePageRange={from:r[0],end:r[1]},a(t.basePageRange,n,"basePageRange")):a(r,n,"basePageRange"):t.basePageRange={from:0,end:n-1},o?Array.isArray(o)?(t.otherPageRange={from:o[0],end:o[1]},a(t.otherPageRange,n,"otherPageRange")):a(o,i,"otherPageRange"):t.otherPageRange={from:0,end:i-1}}},{key:"isCompareDoc",value:function(){return this.info.isCompareDoc}},{key:"getComparisonFilterCountSummary",value:function(){return this.getCompareFileFilterNums()}},{key:"hasFixedPageFields",value:function(e){return this.api.hasFixedPageFields(this.getId(),e)}},{key:"signForESignUS",value:function(e,t,n){var i=this;if(!this.checkPermission(Qt.annotForm)&&!this.checkPermission(Qt.fillForm))throw new Error("Permission error");return this.api.signForESignUS({path:"jr/doc",transfer:!0},this.id,e,t).then((function(e){for(var t=[],n=0,i=0;i<e.byteRange.length;i+=2){var r=e.byteRange[i],o=e.byteRange[i+1];n||(n=r+o+1);var a=e.buffer.slice(r,r+o);t.push(a)}var s=new Blob(t),u=new FileReader;return Promise.all([new Promise((function(t,n){u.onload=function(){t(new Uint8Array(u.result))},u.onerror=function(e){return n(e)},u.readAsArrayBuffer(e.buffer)})),s.arrayBuffer(),n])})).then((function(e){var t=(0,E._)(e,3),r=t[0],o=t[1],a=t[2];return i.generateDocHash(o).then((function(e){var t=function(e){for(var t,n=e.split(""),i=new Uint8Array(e.length/2),r=function(e){for(var t,n=e.length,i=new Array(n),r=0;r<n;r++)48<=(t=e.charCodeAt(r))&&t<58?t-=48:t=(223&t)-65+10,i[r]=t;return i.reduce((function(e,t){return 16*e+t}),0)},o="",a=0,s=0;s<n.length;s++)o+=n[s],s>0&&s%2==1&&(i[a++]=r(o),o="");return window.btoa((t=String).fromCharCode.apply(t,(0,I._)(i)))}(e);return Promise.all([n(t),r,a])})).then((function(e){var t=(0,E._)(e,3),n=t[0],i=t[1],r=t[2],o=i,a=Bk(n).reduce((function(e,t){return e.push(qk[(240&t)>>>4]),e.push(qk[15&t]),e}),[]);o.set(a,r);var s=Vk(o,"").replace("data:;base64,","");return[new Blob([o],{type:"application/pdf"}),s]}))}))}},{key:"getFontCount",value:function(){return this.api.getFontCount({path:"jr/doc"},this.id)}},{key:"getFont",value:function(e){return this.api.getFont({path:"jr/doc"},this.id,e)}},{key:"addFillSignSignaturesToDoc",value:function(e,t,n){return(0,_._)((function(){var i,r,o,a,s,u,c,l,d,h,f,g,v,p,m,y,k,b,w,_,P,A,S,x,C,D,E,R,T,M;function O(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n);n--;)i[n]=t.charCodeAt(n);return i}function L(){var e=window.localStorage.getItem("CurFileSymbolId");if(e){var t=JSON.parse(window.sessionStorage.getItem("signedList")||"[]");if(t.length){var n=JSON.parse(window.localStorage.getItem("signedFileList")||"[]");n.find((function(t){return t.fileId===e}))?n.forEach((function(n){n.fileId===e&&(n.signedList=(0,I._)(new Set((0,I._)(n.signedList).concat((0,I._)(t)))))})):n.push({fileId:e,signedList:t}),window.localStorage.setItem("signedFileList",JSON.stringify(n))}}}return(0,F.Jh)(this,(function(F){switch(F.label){case 0:if(i=e.viewerUI.rootComponent.pdfUI,r=e.getOnlineSignList(),t||(t=r),"string"==typeof t&&(o=r.find((function(e){return e.id===t})),t=o?[o]:[]),!t.length)return[2];a={},s=!0,u=!1,c=void 0,F.label=1;case 1:F.trys.push([1,12,13,14]),l=t[Symbol.iterator](),F.label=2;case 2:if(s=(d=l.next()).done)return[3,11];h=d.value,h.signType,f=h.styleId,g=h.id,h.groupId,v=h.dataURL,p=h.rect,m=h.pageIndex,y=JSON.parse(window.sessionStorage.getItem("signedList")||"[]"),k=!1,b=e.getPDFPageRender(m),F.label=3;case 3:return F.trys.push([3,8,,9]),[4,b.getPDFPage()];case 4:return(w=F.sent())?(_=O(v.replace(/^data\:.*?base64,/,"")),[4,b.getSignaturePDFRect(g,a)]):[3,7];case 5:return P=(P=F.sent())||p,[4,w.addImage(_,P,b.getRotation())];case 6:F.sent(),k=!0,F.label=7;case 7:return[3,9];case 8:return F.sent(),e.eventEmitter.emit("needSomeTipToShow","noPermission"),n&&n(),[2];case 9:k&&(b.$handler.find("#".concat(g)).remove(),y.push(f),A=(0,I._)(new Set(y)),window.sessionStorage.setItem("signedList",JSON.stringify(A))),F.label=10;case 10:return s=!0,[3,2];case 11:return[3,14];case 12:return S=F.sent(),u=!0,c=S,[3,14];case 13:try{s||null==l.return||l.return()}finally{if(u)throw c}return[7];case 14:if(a=null,O=null,r.length===t.length)e.getOnlineSignManger().clear(),e.getStateHandlerManager().switchTo(ys.getStateName());else{x=!0,C=!1,D=void 0;try{for(E=function(){var t=T.value,n=r.findIndex((function(e){return e.id===t.id}));e.getOnlineSignManger().delete(n)},R=t[Symbol.iterator]();!(x=(T=R.next()).done);x=!0)E()}catch(e){C=!0,D=e}finally{try{x||null==R.return||R.return()}finally{if(C)throw D}}}return e.getOnlineSignList().length||(i.eventEmitter.emit("no-sign-apply"),window.sessionStorage.removeItem("curMouseClickSignRecord")),M=!1,JSON.parse(window.localStorage.getItem("pdfSignConfig")||"{}").isFlatteDocumentWhenApplyingAllSignatures&&"fill-sign"===i.activeMainPageTab.name&&(M=!0),M&&i.eventEmitter.emit("flatten-from-apply-all-fillSign"),L(),L=null,n&&n(),[2]}}))}))()}},{key:"getLastSaveFlags",value:function(){return this.api.getLastSaveFlags({path:"jr/doc"},this.id)}},{key:"saveWinlessData",value:function(){var e=[];return this.pageEditor&&e.push(this.pageEditor.endEdit()),this.touchup&&this.touchup.handleEvent("generateContent"),Promise.all(e)}},{key:"customProtectDoc",value:function(e){return this.api.customProtectDoc(this.getId(),e)}},{key:"drawTextString",value:function(e){if(e)return this.api.drawTextString(this.id,e)}},{key:"getWordCount",value:function(){return this.registerProgressFlow("getWordCount"),this.api.getAllWordCount({path:"jr/doc"},this.id)}},{key:"registerProgressFlow",value:function(e){var t=this,n=de.progressChanged,i=function(r){!function(r){var o;switch(r.state){case"start":case"progress":o=Rm.PROGRESSING;break;case"end":o=Rm.SUCCESS;break;case"error":o=Rm.FAIL}t.engine.eventEmitter.emit(n,e,r.progress,o),"end"!==r.state&&"error"!==r.state||t.api.unregisterWorkflow(e,i)}(r.msg)};this.api.registerWorkflow(e,i)}},{key:"loadAdvEditorConfigFile",value:function(e,t){var n=this;return this.advEditorConfigFile&&this.advEditorConfigFile[t]?Promise.resolve(!0):(this.advEditorConfigFile=this.advEditorConfigFile||{},this.advEditorConfigFile[t]=e,this.api.loadAdvEditorConfigFile(this.getId(),this.advEditorConfigFile[t],t).then((function(e){return!e&&delete n.advEditorConfigFile[t],e})))}},{key:"setAdvEditorTextToolStyle",value:function(e){return this.api.setAdvEditorTextToolStyle(this.getId(),e)}},{key:"setAdvEditorEditingObjectToolStyle",value:function(e){return this.api.setAdvEditorEditingObjectToolStyle(this.getId(),e)}},{key:"insertXfaPage",value:function(e){this.info.pageCount++;var t=new jy(e,this);this.pageCache.splice(e.index,0,t),this.updatePageIndex(e.index+1,this.info.pageCount-1),this.engine.eventEmitter.emit(le.pageAdded,t)}},{key:"removeXfaPage",value:function(e){var t;this.info.pageCount--,this.pageCache[e]&&(t=this.pageCache[e].info.objectNumber,this.pageCache.splice(e,1),this.updatePageIndex(e,this.info.pageCount-1)),this.engine.eventEmitter.emit(le.pageRemoved,e,t)}},{key:"has3DAnnots",value:function(){return this.api.has3DAnnots({path:"jr/doc"},this.id)}}]),n}(j.Disposable);function $k(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return Jk(e).then(sy).then((function(e){return n.drawImage(e,0,0),URL.revokeObjectURL(e.src),t}))}function zk(e){return Jk(e).then(sy)}function Gk(e){return Jk(e).then((function(e){var t=new FileReader;return new Promise((function(n){t.onloadend=function(){n(t.result)},t.readAsArrayBuffer(e)}))}))}function Jk(e){if(e.buffer){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d"),i=new(Uint8ClampedArray||Uint8Array)(e.buffer),r=n.createImageData(e.width,e.height);return r.data.set(i),n.putImageData(r,0,0),new Promise((function(e){t.toBlob(e)}))}return e.image?Promise.resolve(e.image):Promise.reject(e)}var Xk=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t.add(e.getId()),e.isMarkup()){var i=e.getReplies();i.forEach((function(e){return Xk(e,t)})),(i=e.getMarkedStates()).forEach((function(e){return t.add(e.getId())})),(i=e.getReviewStates()).forEach((function(e){return t.add(e.getId())})),n&&e.isReplace&&e.isReplace()&&(i=e.getGroupElements()).forEach((function(e){return t.add(e.getId())}))}},Zk=function(e,t){if((e|t-1-e)<0)throw new Error("Page range error.")},Qk=function(e,t){var n=[];return t.forEach((function(t){n.push(e.getPageByIndex(t))})),Promise.all(n)},eb=function(e){var t=[];return e.reduce((function(n,i,r){return n.then((function(n){return i.then((function(n){return t[r]=n,r==e.length-1?t:i}))}))}),Promise.resolve())},tb=function(e,t){if(!Array.isArray(e))throw new Error("Param error. Only array is available.");if(0===e.length)throw new Error("Param error. Non-valid array.");e.forEach((function(e){if(isNaN(e)||e<0||e>t)throw new Error("Param error: Index is out of the valid range.")}))},nb=function(e,t){var n=function(e){if(e.children&&e.children.length>0)for(var i=e.children.length-1;i>-1;i--){n(e.children[i])&&e.children.splice(i,1)}return t.indexOf(e.id)>-1?e:null},i=function(e){e.children&&e.children.length>0&&e.children.forEach((function(t,n){t.id=e.id+"-"+n,i(t)}))};n(e),i(e)},ib=function(e,t){if(!t.checkPermission(Qt.annotForm)&&!t.checkPermission(Qt.fillForm))throw new Error("Permission error");if(!e)throw new Error("Invalid param pagingSigConfig: ".concat(e,"."));if(!e.pageRange||"number"!=typeof e.pageRange[0]||e.pageRange[0]<1||"number"!=typeof e.pageRange[1]||e.pageRange[1]>t.getPageCount()||e.pageRange[0]>=e.pageRange[1])throw new Error("Invalid param pagingSigConfig.pageRange: ".concat(e.pageRange,"."));if(!["left","top","right","bottom"].includes(e.position))throw new Error("Invalid param pagingSigConfig.position: ".concat(e.position,"."));if("number"!=typeof e.width||e.width<0)throw new Error("Invalid param pagingSigConfig.width: ".concat(e.width,"."));if("number"!=typeof e.height||e.height<0)throw new Error("Invalid param pagingSigConfig.height: ".concat(e.height,"."));if("number"!=typeof e.offset||e.offset<0)throw new Error("Invalid param pagingSigConfig.offset: ".concat(e.offset,"."));if("number"!=typeof e.firstPagePercent||e.firstPagePercent<=0||e.firstPagePercent>=1)throw new Error("Invalid param pagingSigConfig.firstPagePercent: ".concat(e.firstPagePercent,"."));if(e.isDisplayMultipleSeal&&("number"!=typeof e.pageCountForEachSeal||e.pageCountForEachSeal<2))throw new Error("Invalid param pagingSigConfig.pageCountForEachSeal: ".concat(e.pageCountForEachSeal,"."));var n=e.pageRange[0]-1;return t.getPageSizesByIndex(n).then((function(t){var i=t[n];if(("left"===e.position||"right"===e.position?e.offset+e.height>i.height:e.offset+e.width>i.width)||e.width>i.width||e.height>i.height)throw new Error("Paging seal signature out of page.")}))},rb=function(e){var t,n;e=(0,b._)((0,k._)({},e),{sealPosition:null!==(t=e.position)&&void 0!==t?t:e.sealPosition,sealOffset:null!==(n=e.offset)&&void 0!==n?n:e.sealOffset});var i=Promise.resolve(e);return"string"==typeof e.image&&e.image.length>0&&(i=fetch(e.image).then((function(e){return e.blob().then((function(e){return new Promise((function(t){var n=new Image;n.src=URL.createObjectURL(e),n.onload=function(){URL.revokeObjectURL(n.getAttribute("src"));var i=new FileReader;i.readAsArrayBuffer(e),i.onloadend=function(){t(i.result)}},n.onerror=function(){URL.revokeObjectURL(n.getAttribute("src")),t()}}))}))})).then((function(t){return t&&(e.inkSign=t),e}))),delete e.position,delete e.offset,delete e.image,i},ob=function(e,t){return e.getAnnots().then((function(e){for(var n=[],i=0;i<e.length&&n.length!==t.length;i++)for(var r=e[i],o=0;o<r.length&&n.length!==t.length;o++){var a=r[o];t.indexOf(a.objectNumber)>-1&&n.push(a)}return n}))};const ab=Kk;var sb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return n}(xm);const ub=sb;var cb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"isReplace",value:function(){return"Replace"===this.info.typeAlias}}]),n}(xm);const lb=cb;var db=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return n}(xm);const hb=db;var fb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return n}(xm);const gb=fb;var vb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getEndPoint",value:function(){return this.info.endPoint}},{key:"setEndPoint",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setLineEndPoint(i.getId(),n.getId(),this.getId(),e.x,e.y).then((function(e){return t.update(en.endPointUpdated)})).then((function(){t.info.endPoint=e,t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)}))}},{key:"getStartPoint",value:function(){return this.info.startPoint}},{key:"setStartPoint",value:function(e){var t=this;this.checkModidyPerm();var n=!arguments[1],i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setLineStartPoint(r.getId(),i.getId(),this.getId(),e.x,e.y).then((function(e){return t.update(n&&en.startPointUpdated)})).then((function(){t.info.startPoint=e,n&&t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],i)}))}},{key:"getEndingStyle",value:function(){return this.info.endingStyle}},{key:"getStartStyle",value:function(){return this.info.startStyle}},{key:"setEndingStyle",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotEndingStyle(r.getId(),i.getId(),this.getId(),e,t).then((function(e){return n.update(en.endingStyleUpdated)})).then((function(){e?n.info.startStyle=t:n.info.endingStyle=t,n.eventEmitter.emit(le.annotationAppearanceUpdated,[n],i)}))}},{key:"flip",value:function(){var e=this,t=this.getStartPoint(),n=this.getEndPoint(),i=new nn.Z;return i.rotateAt(-(t.x+n.x)/2,-(t.y+n.y)/2,Math.PI,!1),t=i.transformPoint(t.x,t.y),n=i.transformPoint(n.x,n.y),this.setStartPoint({x:t[0],y:t[1]},!0).then((function(t){return e.setEndPoint({x:n[0],y:n[1]})}))}},{key:"hasCaption",value:function(){return!!this.info.hasCaption}},{key:"enableCaption",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.enableCaption({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.enableCaptionUpdated)})).then((function(){t.info.hasCaption=e,t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)}))}},{key:"getCaptionPoint",value:function(){var e=this.getCaptionOffset(),t=this.getLeaderLinePoints(),n=t.start,i=t.end,r=new pc(n.x,n.y),o=new pc(i.x,i.y),a=this.getLeaderLineOffset();if(a>0){var s=this.getLeaderLineLength()>0?1:-1,u=r.move(a,o),c=o.move(a,r);r=u.rotate(s*-Math.PI/2,r),o=c.rotate(s*Math.PI/2,o)}var l=r.distanceTo(o),d=r.move(l/2,o),h=d;if(0!==e.x||0!==e.y){var f=d.move(e.y,r).rotate(Math.PI/2,d),g=Math.PI/2;g=e.y>0?-Math.PI/2:Math.PI/2,h=f.move(e.x,d).rotate(g,f)}return h}},{key:"setContent",value:function(e){var t=this;return(0,S._)((0,x._)(n.prototype),"setContent",this).call(this,e).then((function(e){return e&&t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage()),t.updateInfo(t.info),e}))}},{key:"getStyleFillColor",value:function(){return this.info.styleFillColor}},{key:"setStyleFillColor",value:function(e){var t=this;this.checkModidyPerm(),0!==e&&(e=(0,j.colorConvertor)(e,"int"));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotFillColor(i.getId(),n.getId(),this.getId(),e).then((function(i){return i&&(t.info.styleFillColor=e,t.info.fillColor=e,t.eventEmitter.emit(le.annotationUpdated,[t],n,en.styleFillColorUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)),t.updateInfo(t.info),i}))}},{key:"getLeaderLineLength",value:function(){return this.info.leaderLineLength||0}},{key:"getLeaderLineExtend",value:function(){return this.info.leaderLineExtensionLength||0}},{key:"setLeaderLineExtend",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotLeaderLineExtend(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.leaderLineExtendUpdated)})).then((function(){t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)}))}},{key:"getLeaderLineOffset",value:function(){return this.info.leaderLineOffset}},{key:"setLeaderLineOffset",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotLeaderLineOffset(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.leaderLineOffsetUpdated)})).then((function(){t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)}))}},{key:"getCaptionPos",value:function(){return this.info.capPos}},{key:"calculateLeaderLine",value:function(){var e=this.getStartPoint(),t=this.getEndPoint(),n=t.y-e.y,i=t.x-e.x,r=this.k=-1/(n/i),o=Math.atan(r),a=this.getLeaderLineLength(),s=1,u=1;isFinite(r)?0==i?s=u=a<0?n>0?1:-1:n<0?1:-1:i>0?n>0?(s=a>0?-1:1,u=a>0?1:-1):u=s=a>0?1:-1:n>0?u=s=a>0?-1:1:(s=a>0?1:-1,u=a>0?-1:1):s=u=a>0?i>0?1:-1:i<0?1:-1;var c=s*Math.abs(Math.cos(o)*a),l=u*Math.abs(Math.sin(o)*a);this.leaderSartPoit={x:e.x+c,y:e.y+l},this.leaderEndPoint={x:t.x+c,y:t.y+l},this.Sb=this.leaderSartPoit.y-this.k*this.leaderSartPoit.x,this.Eb=this.leaderEndPoint.y-this.k*this.leaderEndPoint.x}},{key:"getLeaderLinePoints",value:function(){return this.leaderSartPoit||this.calculateLeaderLine(),{start:this.leaderSartPoit,end:this.leaderEndPoint}}},{key:"_update",value:function(){var e=this;return(0,S._)((0,x._)(n.prototype),"_update",this).call(this).then((function(t){return e.calculateLeaderLine(),e}))}},{key:"update",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._update().then((function(){var i=t.getPDFPage();return n&&e&&t.eventEmitter.emit(le.annotationUpdated,[t],i,e),t}))}},{key:"setLeaderLineLength",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotLeaderLineLength(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.leaderLineLengthUpdated)})).then((function(){t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)}))}},{key:"getMeasureInfo",value:function(){return""}},{key:"getCaptionOffset",value:function(){return this.info.captionOffset}},{key:"setCaptionOffset",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotCaptionOffset(r.getId(),i.getId(),this.getId(),e,t).then((function(){return n.update(en.leaderCaptionOffsetUpdated)})).then((function(){n.eventEmitter.emit(le.annotationAppearanceUpdated,[n],i)}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.startPoint,i=this.info.endPoint,r=this.info.leaderLineLength,o=this.info.leaderLineExtensionLength,a=this.info.leaderLineOffset,s=this.info.captionOffset,u=this.hasCaption()?"yes":"no",c=this.getCaptionColor();if(c=(0,j.convertFromNumberToHex)(16777215&c),this.info.styleFillColor){var l=(0,j.convertFromNumberToHex)(16777215&this.info.styleFillColor);e["interior-color"]=l,e.interiorColor=l}return Object.assign({},e,{start:t.x+","+t.y,end:i.x+","+i.y,head:be[this.info.startStyle],tail:be[this.info.endingStyle],leaderLength:r,leaderExtend:o,leaderOffset:a,captionOffset:s,caption:u,captionColor:c})}},{key:"getMeasureRatio",value:function(){return this.info.measureRatio}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?"inch":r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?"inch":u;this.checkModidyPerm();var l=this.getPDFPage(),d=l.getPDFDoc(),h=Object.keys(ki);if(!h.includes(o)||!h.includes(c))throw new Error("Param error. Please refer to Annot_Unit_Type");return this.page.doc.api.setMeasureRatio(d.getId(),l.getId(),this.getId(),{userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.update(en.measureRatioUpdated)})).then((function(){var t=e.getPDFPage();e.eventEmitter.emit(le.annotationAppearanceUpdated,[e],t)}))}},{key:"getMeasureUnit",value:function(){return this.info.measureUnit}},{key:"setMeasureUnit",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureUnit(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.measureUnitUpdated)})).then((function(){t.info.measureUnit=e;var n=t.getPDFPage();t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)}))}},{key:"setCaptionColor",value:function(e){var t=this;if(null==e)return Promise.resolve(!1);this.checkModidyPerm(),isNaN(e)&&(e=(0,j.colorConvertor)(e,"int",1));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCaptionColor({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(en.captionColorUpdated).then((function(){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"getCaptionColor",value:function(){return this.info.captionColor}}]),n}(Am);const pb=vb;var mb=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"startPoint",void 0),(0,J._)(this,"points",void 0),this.startPoint=t,this.points=n}return(0,A._)(e,[{key:"isEmpty",value:function(){return 0===this.points.length}},{key:"optimize",value:function(){var t=Array.from(new Set(this.points.map((function(e){return JSON.stringify(e)})))).map((function(e){return JSON.parse(e)}));if(1===t.length){var n=t[0];"lineTo"===n.type&&n.x===this.startPoint.x&&n.y===this.startPoint.y&&(t.length=0)}return new e(this.startPoint,t)}}]),e}(),yb=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"startPoint",void 0),(0,J._)(this,"points",void 0),this.startPoint=t,this.points=n}return(0,A._)(e,[{key:"getSegments",value:function(){return this.points.reduce((function(e,t){var n=e[e.length-1];return"lineTo"===t.type||"cubicBezierTo"==t.type?n.points.push(t):e.push(new mb(t,[])),e}),[new mb(this.startPoint,[])])}},{key:"toPointArray",value:function(){return[this.startPoint].concat(this.points)}},{key:"toVertexesArray",value:function(){return this.toPointArray().flatMap((function(e){return"cubicBezierTo"===e.type?e.operands.map((function(e){return{type:e.closeFigure?ye.BEZIER_TO_CLOSE_FIGURE:ye.BEZIER_TO,x:e.x,y:e.y}})):[{x:e.x,y:e.y,type:"lineTo"===e.type?e.closeFigure?ye.LINE_TO_CLOSE_FIGURE:ye.LINE_TO:ye.MOVE_TO}]}))}},{key:"updatePoint",value:function(e,t){!function(e){if((0,j.isValidNumber)(e.x)&&(0,j.isValidNumber)(e.y))return!0;throw new Error("Incorrect point: ".concat(JSON.stringify(e)))}(t);var n=[this.startPoint].concat(this.points.flatMap((function(e){return"cubicBezierTo"===e.type?e.operands:e})));n[e].x=t.x,n[e].y=t.y}},{key:"toGSDKPath",value:function(e){var t=new e.Path,n=e.PointF;return this.toPointArray().forEach((function(e){switch(e.type){case"moveTo":t.MoveTo(new n(e.x,e.y));break;case"lineTo":t.LineTo(new n(e.x,e.y)),e.closeFigure&&t.CloseFigure();break;case"cubicBezierTo":var i=e.operands;t.CubicBezierTo(new n(i[0].x,i[0].y),new n(i[1].x,i[1].y),new n(i[2].x,i[2].y));break;default:throw new Error("Incorrect point: ".concat(JSON.stringify(e),", its type must be one of 'moveTo', 'lineTo' or 'cubicBezier'"))}})),t}}],[{key:"fromGSDKPath",value:function(t,n){var i=t.GetPointCount();if(0===i)return null;for(var r=n.PointType,o=[],a=0;;){var s=t.GetPointType(a),u=t.GetPoint(a);switch(s){case r.e_TypeLineTo:case r.e_TypeLineToCloseFigure:o.push({type:"lineTo",x:u.x,y:u.y,closeFigure:s===r.e_TypeLineToCloseFigure}),a++;break;case r.e_TypeMoveTo:o.push({type:"moveTo",x:u.x,y:u.y}),a++;break;case r.e_TypeBezierTo:for(var c=[],l=a+3;a<l;a++){var d=t.GetPoint(a);c.push({x:d.x,y:d.y,closeFigure:t.GetPointType(a)===r.e_TypeBezierToCloseFigure})}o.push({type:"cubicBezierTo",operands:c})}if(a>=i-1)break}return new e(o[0],o.slice(1))}},{key:"fromPointArray",value:function(t){if(t.length<2)throw new Error("Invalid path point array! The point count must be greater than 2");if("moveTo"!==t[0].type)throw new Error("Invalid path point array!, The type of first point must be 'moveTo'");return new e(t[0],t.slice(1))}}]),e}();function kb(e){return!e||e.length<1?"":e.map((function(e){return"moveTo"===e.type||"lineTo"===e.type?[e.x,e.y].join(","):e.operands.flatMap((function(e){return[e.x,e.y]})).join(",")})).join(";")}var bb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getVertexes",value:function(){return this.info.vertexes}},{key:"getStyleFillColor",value:function(){return this.info.fillColor}},{key:"setStyleFillColor",value:function(e){return this.checkModidyPerm(),(0,S._)((0,x._)(n.prototype),"setFillColor",this).call(this,e)}},{key:"updateVertexes",value:function(e,t){var n=this,i=t.x,r=t.y;this.checkModidyPerm();var o=this.getPDFPage(),a=o.getPDFDoc();return this.page.doc.api.updateAnnotVertexes(a.getId(),o.getId(),this.getId(),e,i,r).then((function(){return n.info[e]={x:i,y:r},n.update(en.vertexesUpdated)})).then((function(){n.eventEmitter.emit(le.annotationAppearanceUpdated,[n],n.getPDFPage())}))}},{key:"setVertexes",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotVertexes(i.getId(),n.getId(),this.getId(),e).then((function(){return t.info.vertexes=e,t.update(en.vertexesUpdated)})).then((function(){t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage())}))}},{key:"getMeasureInfo",value:function(){return""}},{key:"getEndingStyle",value:function(){return this.info.endingStyle}},{key:"setEndingStyle",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotEndingStyle(r.getId(),i.getId(),this.getId(),e,t).then((function(){e?n.info.startStyle=t:n.info.endingStyle=t,n.eventEmitter.emit(le.annotationUpdated,[n],i,en.endingStyleUpdated),n.eventEmitter.emit(le.annotationAppearanceUpdated,[n],n.getPDFPage())})).then((function(e){return n._update()}))}},{key:"getStartStyle",value:function(){return this.info.startStyle}},{key:"exportToJSON",value:function(){for(var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.vertexes,i="",r=0;r<t.length;r++)i+=t[r].x+","+t[r].y+";";if(i=i.substr(0,i.length-1),this.info.fillColor){var o=(0,j.convertFromNumberToHex)(16777215&this.info.fillColor);e["interior-color"]=o,e.interiorColor=o}if("PolyLineDimension"===this.getIntent()){e.caption=this.hasCaption()?"yes":"no";var a=this.getCaptionColor();e.captionColor=(0,j.convertFromNumberToHex)(16777215&a)}return Object.assign({},e,{head:be[this.info.startStyle],tail:be[this.info.endingStyle],vertices:i,path:kb(this.info.path)})}},{key:"getMeasureRatio",value:function(){return this.info.measureRatio}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?"inch":r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?"inch":u;this.checkModidyPerm();var l=this.getPDFPage(),d=l.getPDFDoc(),h=Object.keys(ki);if(!h.includes(o)||!h.includes(c))throw new Error("Param error. Please refer to Annot_Unit_Type");return this.page.doc.api.setMeasureRatio(d.getId(),l.getId(),this.getId(),{userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.update(en.measureRatioUpdated)})).then((function(){var t=e.getPDFPage();e.eventEmitter.emit(le.annotationAppearanceUpdated,[e],t)}))}},{key:"getMeasureUnit",value:function(){return this.info.measureUnit}},{key:"setMeasureUnit",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureUnit(i.getId(),n.getId(),this.getId(),e,2).then((function(){return t.update(en.measureUnitUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],e)}))}},{key:"hasCaption",value:function(){return!!this.info.hasCaption}},{key:"enableCaption",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.enableCaption({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.enableCaptionUpdated)})).then((function(){t.info.hasCaption=e,t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)}))}},{key:"setCaptionColor",value:function(e){var t=this;if(null==e)return Promise.resolve(!1);this.checkModidyPerm(),isNaN(e)&&(e=(0,j.colorConvertor)(e,"int",1));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCaptionColor({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(en.captionColorUpdated).then((function(){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"getCaptionColor",value:function(){return this.info.captionColor}},{key:"getPath",value:function(){return this.info.path?yb.fromPointArray(this.info.path):null}},{key:"getPathVertexes",value:function(){var e=this.getPath();return e?e.toVertexesArray():[]}},{key:"updatePathVertex",value:function(e,t){var n=this,i=this.getPDFPage(),r=i.getPDFDoc();return this.api.updatePathPoint({path:"jr/doc/page/annot"},r.getId(),i.getId(),this.getId(),e,t).then((function(){return n.update(en.pathUpdated).then((function(){n.eventEmitter.emit(le.annotationAppearanceUpdated,[n],i)}))}))}}]),n}(Am);const wb=bb;var _b=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getVertexes",value:function(){return this.info.vertexes}},{key:"updateVertexes",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.updateAnnotVertexes(r.getId(),i.getId(),this.getId(),e,t.x,t.y).then((function(){return n.update(en.vertexesUpdated)})).then((function(){n.eventEmitter.emit(le.annotationAppearanceUpdated,[n],n.getPDFPage())}))}},{key:"setVertexes",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotVertexes(i.getId(),n.getId(),this.getId(),e).then((function(){return t.info.vertexes=e,t.update(en.vertexesUpdated)})).then((function(){t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage())}))}},{key:"getMeasureInfo",value:function(){return""}},{key:"exportToJSON",value:function(){for(var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.vertexes,i="",r=0;r<t.length;r++)i+=t[r].x+","+t[r].y+";";if(i=i.substr(0,i.length-1),this.info.fillColor){var o=(0,j.convertFromNumberToHex)(16777215&this.info.fillColor);e["interior-color"]=o,e.interiorColor=o}if("PolygonDimension"===this.getIntent()){e.measureRatio=this.info.measureRatio,e.measureConversionFactor=this.info.measureConversionFactor,e.measureUnit=this.info.measureUnit,e.caption=this.hasCaption()?"yes":"no";var a=this.getCaptionColor();e.captionColor=(0,j.convertFromNumberToHex)(16777215&a)}var s=kb(this.info.path);return Object.assign({},e,{vertices:i,path:s})}},{key:"getFillColor",value:function(){return this.info.fillColor}},{key:"setFillColor",value:function(e){return this.checkModidyPerm(),(0,S._)((0,x._)(n.prototype),"setFillColor",this).call(this,e)}},{key:"getMeasureRatio",value:function(){return this.info.measureRatio}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?"inch":r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?"inch":u;this.checkModidyPerm();var l=this.getPDFPage(),d=l.getPDFDoc(),h=Object.keys(ki);if(!h.includes(o)||!h.includes(c))throw new Error("Param error. Please refer to Annot_Unit_Type");return this.page.doc.api.setMeasureRatio(d.getId(),l.getId(),this.getId(),{userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.update(en.measureRatioUpdated)})).then((function(){var t=e.getPDFPage();e.eventEmitter.emit(le.annotationAppearanceUpdated,[e],t)}))}},{key:"getMeasureUnit",value:function(){return this.info.measureUnit}},{key:"setMeasureUnit",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureUnit(i.getId(),n.getId(),this.getId(),e,2).then((function(){return t.update(en.measureUnitUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],e)}))}},{key:"hasCaption",value:function(){return!!this.info.hasCaption}},{key:"enableCaption",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.enableCaption({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.enableCaptionUpdated)})).then((function(){t.info.hasCaption=e,t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)}))}},{key:"setCaptionColor",value:function(e){var t=this;if(null==e)return Promise.resolve(!1);this.checkModidyPerm(),isNaN(e)&&(e=(0,j.colorConvertor)(e,"int",1));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCaptionColor({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(en.captionColorUpdated).then((function(){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"getCaptionColor",value:function(){return this.info.captionColor}},{key:"getPath",value:function(){return this.info.path?yb.fromPointArray(this.info.path):null}},{key:"getPathVertexes",value:function(){var e=this.getPath();return e?e.toVertexesArray():[]}},{key:"updatePathVertex",value:function(e,t){var n=this,i=this.getPDFPage(),r=i.getPDFDoc();return this.api.updatePathPoint({path:"jr/doc/page/annot"},r.getId(),i.getId(),this.getId(),e,t).then((function(){return n.update(en.pathUpdated).then((function(){n.eventEmitter.emit(le.annotationAppearanceUpdated,[n],i)}))}))}}]),n}(Am);const Pb=_b;var Ab=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getFlags",value:function(){return(0,S._)((0,x._)(n.prototype),"getFlags",this).call(this)}},{key:"getIconName",value:function(){return this.info.iconName||"Note"}},{key:"setIconName",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotIconName(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(en.iconNameUpdated).then((function(){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage()),e})):e}))}},{key:"getState",value:function(){return this.info.state}},{key:"setState",value:function(e){var t=this;if(this.checkModidyPerm(),!this.isStateAnnot())return Promise.reject(new Error("Cannot set state name if it is not a state type annotation!"));if(this.getState()===e)return Promise.resolve(!0);var n=this.info.state,i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setStateName(r.getId(),i.getId(),this.getId(),e).then((function(i){return t.info.state=e,t.eventEmitter.emit(le.stateAnnotNameUpdated,t,t.getPDFPage(),n,e),i}))}},{key:"isStateAnnot",value:function(){return this.info.isStateAnnot}},{key:"isReplyAnnot",value:function(){return!this.isStateAnnot()&&"R"===this.info.RT}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t={icon:this.info.iconName};if(this.info.isStateAnnot){t.statemodel=1==this.info.stateMode?"Marked":"Review";var i=this.page.annotIdMap[this.info.IRT];t.inreplyto=i&&i.getName();var r=this.info.state;t.state=r.charAt(0).toUpperCase()+r.slice(1),delete e.contents,delete e.color}return Object.assign({},e,t)}}]),n}(Am);const Sb=Ab;var xb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getInnerRect",value:function(){return this.info.innerRect}},{key:"getFillColor",value:function(){return this.info.fillColor}},{key:"setFillColor",value:function(e){return this.checkModidyPerm(),(0,S._)((0,x._)(n.prototype),"setFillColor",this).call(this,e)}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.rect,i=this.info.innerRect,r={fringe:[i.left-t.left,i.bottom-t.bottom,t.right-i.right,t.top-i.top].toString()};if(this.info.fillColor){var o=(0,j.colorConvertor)(16777215&this.info.fillColor,"#");e["interior-color"]=o,e.interiorColor=o}if("CircleDimension"===this.getIntent()){r.measureRatio=this.getMeasureRatio(),r.measureConversionFactor=this.getMeasureConversionFactor(),r.measureUnit=this.getMeasureUnit(),r.caption=this.hasCaption()?"yes":"no";var a=this.getCaptionColor();r.captionColor=(0,j.colorConvertor)(16777215&a,"#")}return Object.assign({},e,r)}},{key:"getMeasureRatio",value:function(){return this.info.measureRatio}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?ki.inch:r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?ki.inch:u;this.checkModidyPerm();var l=this.getPDFPage(),d=l.getPDFDoc(),h=Object.keys(ki);if(!h.includes(o)||!h.includes(c))throw new Error("Param error. Please refer to Annot_Unit_Type");return this.page.doc.api.setMeasureRatio(d.getId(),l.getId(),this.getId(),{userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.update(en.measureRatioUpdated)})).then((function(){var t=e.getPDFPage();e.eventEmitter.emit(le.annotationAppearanceUpdated,[e],t)}))}},{key:"getMeasureUnit",value:function(){return this.info.measureUnit}},{key:"setMeasureUnit",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureUnit(i.getId(),n.getId(),this.getId(),e,2).then((function(){return t.update(en.measureUnitUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],e)}))}},{key:"getMeasureConversionFactor",value:function(){return this.info.measureConversionFactor}},{key:"setMeasureConversionFactor",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureConversionFactor(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.measureConversionFactorUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],e)}))}},{key:"hasCaption",value:function(){return!!this.info.hasCaption}},{key:"enableCaption",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.enableCaption({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.enableCaptionUpdated)})).then((function(){t.info.hasCaption=e,t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)}))}},{key:"setCaptionColor",value:function(e){var t=this;if(null==e)return Promise.resolve(!1);this.checkModidyPerm(),isNaN(e)&&(e=(0,j.colorConvertor)(e,"int",1));var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCaptionColor({path:"jr/doc/page/annot"},i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(en.captionColorUpdated).then((function(){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"getCaptionColor",value:function(){return this.info.captionColor}}]),n}(Am),Cb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),(r=t.call(this,e,i)).updateFileSpec(),r}return(0,A._)(n,[{key:"getIconName",value:function(){return this.info.iconName||"PushPin"}},{key:"setIconName",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotIconName(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(en.iconNameUpdated).then((function(){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage()),e})):e}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t={icon:this.info.iconName};return Object.assign({},e,t)}},{key:"update",value:function(e){var t=this;return(0,S._)((0,x._)(n.prototype),"update",this).call(this,e).then((function(e){return t.updateFileSpec(),e}))}},{key:"updateFileSpec",value:function(){var e=this.info;this.fileSpec=e.fileSpec&&new Vr(e.fileSpec)||null}},{key:"getFileSpec",value:function(){return this.fileSpec}},{key:"getFileattachmentStream",value:function(){var e=this.getPDFPage(),t=e.getPDFDoc(),n=[];return this.page.doc.api.getFileattachmentStream(t.getId(),e.getId(),this.getId(),(function(e){var t=e.arrayBuffer,i=e.blob;i?n=i:n.push(t)})).then((function(){return n}))}}]),n}(Am);const Db=Cb;var Eb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getInnerRect",value:function(){return this.info.innerRect}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.rect,i=this.info.innerRect,r=[i.left-t.left,i.bottom-t.bottom,t.right-i.right,t.top-i.top].toString();return delete e.style,delete e.width,delete e.dashPhase,delete e.intensity,Object.assign({},e,{fringe:r})}},{key:"moveRectByCharIndex",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.moveCaretRectByCharIndex(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(en.rectUpdated).then((function(){return t.eventEmitter.emit(le.annotationMovedPosition,[t],t.getPDFPage(),t),e})):e}))}}]),n}(Am);const Ib=Eb;var Rb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getFillColor",value:function(){return this.info.fillColor}},{key:"setFillColor",value:function(e){return(0,S._)((0,x._)(n.prototype),"setFillColor",this).call(this,e)}},{key:"getInnerRect",value:function(){return this.info.innerRect}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.rect,i=this.info.innerRect,r=[i.left-t.left,i.bottom-t.bottom,t.right-i.right,t.top-i.top].toString();if(this.info.fillColor){var o=(0,j.colorConvertor)(16777215&this.info.fillColor,"#");e["interior-color"]=o,e.interiorColor=o}var a={fringe:r};return"CustomDimension"===this.getIntent()&&(a.measureRatio=this.getMeasureRatio(),a.measureConversionFactor=this.getMeasureConversionFactor(),a.measureUnit=this.getMeasureUnit()),Object.assign({},e,a)}},{key:"getMeasureRatio",value:function(){return this.info.measureRatio}},{key:"setMeasureRatio",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userSpaceValue,i=void 0===n?1:n,r=t.userSpaceUnit,o=void 0===r?ki.inch:r,a=t.realValue,s=void 0===a?1:a,u=t.realUnit,c=void 0===u?ki.inch:u;this.checkModidyPerm();var l=this.getPDFPage(),d=l.getPDFDoc(),h=Object.keys(ki);if(!h.includes(o)||!h.includes(c))throw new Error("Param error. Please refer to Annot_Unit_Type");return this.page.doc.api.setMeasureRatio(d.getId(),l.getId(),this.getId(),{userSpaceValue:i,userSpaceUnit:o,realValue:s,realUnit:c}).then((function(){return e.update(en.measureRatioUpdated)})).then((function(){var t=e.getPDFPage();e.eventEmitter.emit(le.annotationAppearanceUpdated,[e],t)}))}},{key:"getMeasureUnit",value:function(){return this.info.measureUnit}},{key:"setMeasureUnit",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureUnit(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.measureUnitUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],e)}))}},{key:"getMeasureConversionFactor",value:function(){return this.info.measureConversionFactor}},{key:"setMeasureConversionFactor",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setMeasureConversionFactor(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.measureConversionFactorUpdated)})).then((function(){var e=t.getPDFPage();t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],e)}))}}]),n}(Am),Tb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){(0,P._)(this,n);var r=t.call(this,e,i);return-1===e.borderColor&&"FreeTextTypewriter"!==e.intent&&(e.borderColor=16711680),r}return(0,A._)(n,[{key:"setIsEditting",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.setAnnotIsEditing({path:"jr/doc/page"},n.getId(),t.getId(),this.getId(),e)}},{key:"setAlignment",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAlignment(i.getId(),n.getId(),this.getId(),e).then((function(){return t.info.justification=e,t.eventEmitter.emit(le.annotationUpdated,[t],n,en.alignmentUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage()),t.updateInfo(t.info),e}))}},{key:"getAlignment",value:function(){return this.info.justification}},{key:"getInnerRect",value:function(){return Object.assign({},this.info.innerRect)}},{key:"setInnerRectNoAction",value:function(e){var t=this;this.info.innerRect=e;var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotInnerRect(i.getId(),n.getId(),this.getId(),e).then((function(){var e=t.getGroupElements();0==e.length&&(e=[t]);for(var n=[],i=0,r=e.length;i<r;i++){var o=e[i];n[i]=o._update()}return Promise.all(n)}))}},{key:"getIntent",value:function(){var e=(0,S._)((0,x._)(n.prototype),"getIntent",this).call(this);return e||(e="FreeTextTextbox"),e}},{key:"setInnerRect",value:function(e){var t=this;this.checkModidyPerm(),this.info.innerRect=e;var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotInnerRect(i.getId(),n.getId(),this.getId(),e).then((function(e){return e?t.update(en.innerRectUpdated).then((function(){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage()),e})):e}))}},{key:"getDefaultAppearance",value:function(){var e=Object.assign({},this.info.defaultAppearance);return delete e.flags,e}},{key:"getFillColor",value:function(){return"FreeTextTypewriter"==this.info.intent?0:this.info.fillColor}},{key:"setFillColor",value:function(e){var t=this;this.checkModidyPerm(),e=0===e?0:(0,j.colorConvertor)(e,"int");var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotFillColor(i.getId(),n.getId(),this.getId(),e).then((function(i){return i&&(t.info.fillColor=e,t.eventEmitter.emit(le.annotationUpdated,[t],n,en.fillColorUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n),t.updateInfo(t.info)),i}))}},{key:"getCalloutLinePoints",value:function(){return this.info.calloutLinePoints}},{key:"setCalloutLinePoints",value:function(e){var t=this;return this._setCalloutLinePoints(e).then((function(e){return t._update()})).then((function(e){var n=t.getPDFPage();t.eventEmitter.emit(le.annotationUpdated,[t],n,en.calloutLinePointsUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n)}))}},{key:"_setCalloutLinePoints",value:function(e){var t=this;this.checkModidyPerm(),this.info.calloutLinePoints=e;var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCalloutLinePoints(i.getId(),n.getId(),this.getId(),e).then((function(e){return t._update()}))}},{key:"updateCalloutFigure",value:function(e,t,n){var i=this;this.checkModidyPerm(),this.info.calloutLinePoints=n;var r=this.getPDFPage(),o=r.getPDFDoc();return this.page.doc.api.updateCalloutFigure(o.getId(),r.getId(),this.getId(),e,t,n).then((function(){var e=i.getGroupElements();0==e.length&&(e=[i]);for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];t[n]=o.updateRectData()}return Promise.all(t)})).then((function(){var e=i.getPDFPage();i.eventEmitter.emit(le.annotationUpdated,[i],i.getPDFPage(),en.rectUpdated),i.eventEmitter.emit(le.annotationUpdated,[i],i.getPDFPage(),en.innerRectUpdated),i.eventEmitter.emit(le.annotationUpdated,[i],i.getPDFPage(),en.calloutLinePointsUpdated),i.eventEmitter.emit(le.annotationAppearanceUpdated,[i],e)}))}},{key:"updateRectFigure",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.info.rect,r=this.info.innerRect;e=un(e),this.info.rect=e,this.info.innerRect=t;var o=this.getPDFPage(),a=o.getPDFDoc();return this.page.doc.api.updateRectFigure(a.getId(),o.getId(),this.getId(),e,t).then((function(e){return e?n.update(en.rectUpdated).then((function(e){return n.eventEmitter.emit(le.annotationAppearanceUpdated,[n],n.getPDFPage()),!0})):(n.info.rect=i,n.info.innerRect=r,e)}))}},{key:"getCalloutLineEndingStyle",value:function(){return this.info.calloutLineEndingStyle}},{key:"setEndingStyle",value:function(e,t){return this.setCalloutLineEndingStyle(t)}},{key:"setCalloutLineEndingStyle",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setCalloutLineEndingStyle(i.getId(),n.getId(),this.getId(),e).then((function(){t.info.calloutLineEndingStyle=e,t.eventEmitter.emit(le.annotationUpdated,[t],n,en.calloutLineEndingStyleUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage()),t.updateInfo(t.info)}))}},{key:"_setRect",value:function(e,t){var i=this,r=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(o){return[2,(0,S._)((0,x._)(n.prototype),"_setRect",i).call(r,e,t)]}))}))()}},{key:"setTextSize",value:function(e){var t=this.getDefaultAppearance();return t.textSize=e,this.setDefaultAppearance(t)}},{key:"setDefaultAppearance",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc(),r=(e=Object.assign({},this.info.defaultAppearance,e)).textColor,o=e.textSize;if("number"!=typeof r||"number"!=typeof o)throw new Error("param error. Only number is available.");if(r=(4278190080|r)>>>0,this.engine.configuration.annotation.syncTextScaling){if(o<=0||!isFinite(o))throw new Error("Text size is overflow, it should not be negative and infinite.")}else if(o<6||o>40)throw new Error("Text size is overflow. Available range is 6 to 40.");return e.textColor=r,e.textSize=o,this.page.doc.api.setDefaultAp(i.getId(),n.getId(),this.getId(),e).then((function(){return t._update()})).then((function(){t.eventEmitter.emit(le.annotationUpdated,[t],n,en.defaultAppearanceUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage())}))}},{key:"getFontColor",value:function(){return 0==this.info.defaultAppearance.textColor?"#000000":(0,j.colorConvertor)(16777215&this.info.defaultAppearance.textColor,"#",0)}},{key:"setFontColor",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return e=(0,j.colorConvertor)(e,"int",1),this.info.defaultAppearance.textColor=e,this.page.doc.api.setDefaultAp(i.getId(),n.getId(),this.getId(),this.info.defaultAppearance).then((function(){t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage())}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this);e.justification=this.info.justification;var t="";this.info.fontName&&(t+="/"+this.info.fontName+" "),null!=this.info.defaultAppearance.textSize&&(t+=this.info.defaultAppearance.textSize+" Tf ");var i=(0,j.convertFromNumberToRGBA)(this.getBorderColor());switch(t+=(i.r/255).toFixed(2)+" "+(i.g/255).toFixed(2)+" "+(i.b/255).toFixed(2)+" rg",e.defaultappearance=t,e.fontColor=(0,j.colorConvertor)(16777215&this.info.defaultAppearance.textColor,"#",0),this.info.fillColor&&(i=(0,j.convertFromNumberToHex)(16777215&this.info.fillColor),e["interior-color"]=i,e.interiorColor=i),this.info.intent){case"FreeTextCallout":var r=this.info.rect,o=this.info.innerRect,a=[o.left-r.left,o.bottom-r.bottom,r.right-o.right,r.top-o.top].toString(),s=this.info.calloutLinePoints,u=s[0].x+","+s[0].y;u+=","+s[1].x+","+s[1].y,u+=","+s[2].x+","+s[2].y;var c=be[this.info.calloutLineEndingStyle];return Object.assign({},e,{fringe:a,callout:u,head:c});case"FreeTextTypewriter":break;default:var l=this.info.rect,d=this.info.innerRect,h=[d.left-l.left,d.bottom-l.bottom,l.right-d.right,l.top-d.top].toString();return Object.assign({},e,{fringe:h})}return e}},{key:"getContent",value:function(){var e="";if(this.info.RC.length>0){var t,i=(new DOMParser).parseFromString(this.info.RC,"text/xml");i.children&&i.children[0]?t=i.children.item(0):i.childNodes&&i.childNodes.length>0&&(t=i.childNodes.item(0)),e=t?t.innerText||t.textContent:e}else e=(0,S._)((0,x._)(n.prototype),"getContent",this).call(this);return e}},{key:"setContent",value:function(e){var t=this;return this.checkModidyPerm(),this.info.RC="",this._setContent(e).then((function(e){return t.getPDFPage().getAnnotsByObjectNumArray([e])})).then((function(e){return t.update(en.contentUpdated).then((function(e){return t.eventEmitter.emit(le.annotationAppearanceUpdated,e,t.getPDFPage()),e}))}))}},{key:"getWoff",value:function(){var e=this.getPDFPage();return e.doc.api.getAnnotWoff(e.getPDFDoc().getId(),e.getId(),this.getId())}},{key:"getRotation",value:function(){return this.info.rotation||0}},{key:"setRotation",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotRotation(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(n){var i=0;for(n.length;i--;)n[i].info.rotation=e;return t.info.rotation=e,n})).then((function(e){var i=[],r=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;i.push(c.update())}}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return Promise.all(i).then((function(i){return t.eventEmitter.emit(le.annotationUpdated,e,n,en.rotationUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,e,n),e}))}))}},{key:"setAppearanceWithoutFontFamily",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc(),r=(e=Object.assign({},this.info.defaultAppearance,e)).textColor,o=e.textSize;if("number"!=typeof r||"number"!=typeof o)throw new Error("param error. Only number is available.");if(r=(4278190080|r)>>>0,this.engine.configuration.annotation.syncTextScaling){if(o<=0||!isFinite(o))throw new Error("Text size is overflow, it should not be negative and infinite.")}else if(o<6||o>40)throw new Error("Text size is overflow. Available range is 6 to 40.");return e.textColor=r,e.textSize=o,this.page.doc.api.setDefaultAp(i.getId(),n.getId(),this.getId(),Object.assign({},e,{font:void 0})).then((function(){return t._update()})).then((function(){t.info.defaultAppearance=e,t.eventEmitter.emit(le.annotationUpdated,[t],n,en.defaultAppearanceUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage())}))}}]),n}(Am);const Fb=Tb;var Mb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getInnerRect",value:function(){return this.getRect()}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this);return e.icon=this.info.iconName,e}},{key:"getIconName",value:function(){return this.info.iconName||""}},{key:"setImage",value:function(e){var t=this;return function(e){return fetch(e).then((function(e){return e.blob().then((function(e){return{url:URL.createObjectURL(e),size:e.size}}))})).catch((function(e){throw new Error("Could not load image!")}))}(e).then((function(e){var n=t.getPDFPage(),i=n.getPDFDoc(),r=e.url,o=e.size;return t.page.doc.api.setAnnotAPBitmap(i.getId(),n.getId(),t.getId(),r,o).then((function(e){t.update(en.imageUpdated)}))}))}},{key:"getImage",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.getBitmapBuffer(n.getId(),t.getId(),this.getId()).then((function(t){if(!t.width||!t.height)return null;switch(e||"canvas"){case"canvas":return uy(t);case"image":return cy(t);case"buffer":return ly(t);default:throw new Error("Invalid options.type: ".concat(e))}}))}},{key:"getRotation",value:function(){return this.info.rotation<0&&(this.info.rotation+=360),this.info.rotation}},{key:"setRotation",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return e<0&&(e+=360),this.page.doc.api.setAnnotRotation(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(n){for(var i=0;i<n.length;i++)n[i].info.rotation=e;return t.info.rotation=e,n})).then((function(e){var i=[],r=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;i.push(c.update())}}catch(e){o=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return Promise.all(i).then((function(i){return t.eventEmitter.emit(le.annotationUpdated,e,n,en.rotationUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,e,n),e}))}))}}]),n}(Am);const Ob=Mb;var Lb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e,i),e.action&&(r.action=r.page.doc.engine.actionFactory.createAction(e.action,i.doc,r.page.doc.api,r.eventEmitter,(0,w._)(r))),r}return(0,A._)(n,[{key:"getFlags",value:function(){return-2&(0,S._)((0,x._)(n.prototype),"getFlags",this).call(this)}},{key:"getAction",value:function(){return this.action}},{key:"getActionPromise",value:function(){return Promise.resolve(this.action)}},{key:"getHighlightingMode",value:function(){return this.info.highlightingMode}},{key:"setHighlightingMode",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setHighlightingMode(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(e){for(var t=[],n=0,i=e.length;n<i;n++)t.push(e[n]._update());return Promise.all(t)})).then((function(e){return t.eventEmitter.emit(le.annotationUpdated,e,n,en.highlightingModeUpdated),t.eventEmitter.emit(le.annotationMovedPosition,e,n,t),e}))}},{key:"hasPA",value:function(){return this.api.linkHasPA(this.page.doc.getId(),this.page.getId(),this.getId())}},{key:"resetAByPA",value:function(){var e=this;return this.api.linkResetAByPA(this.page.doc.getId(),this.page.getId(),this.getId()).then((function(t){if(t)return e.update(en.actionDataUpdated).then((function(){e.action=e.page.doc.engine.actionFactory.createAction(e.info.action,e.page.doc,e.page.doc.api,e.eventEmitter,e)}))}))}},{key:"setAction",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vo.AnnotMouseButtonReleased,i=arguments.length>2?arguments[2]:void 0;this.checkModidyPerm();var r=this.getPDFPage(),o=r.getPDFDoc();return e=e.info?e.info:e,this.page.doc.api.setAction(o.getId(),r.getId(),this.getId(),e,n,i).then((function(e){return t.action?e.type!==t.action.getType()?t.action=t.page.doc.engine.actionFactory.createAction(e,t.page.doc,t.page.doc.api,t.eventEmitter,t):t.action.updateAction(e):t.action=t.page.doc.engine.actionFactory.createAction(e,t.page.doc,t.page.doc.api,t.eventEmitter,t),t.update(en.addAction)})).then((function(){return t.eventEmitter.emit(le.actionAdd,t),!0}))}},{key:"setActionData",value:function(e,t){var n=this;return e.setActionData(t).then((function(){return n.update(en.actionDataUpdated),!0}))}},{key:"removeAction",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=arguments.length>1?arguments[1]:void 0,i=0,r=0;n&&(i=0,r=n.info.objNumber),delete this.info.action,delete this.action;var o=this.page,a=o.doc;return a.api.removeAction(a.getId(),o.getId(),this.getId(),t,i,r).then((function(t){var n=t[0];return n&&(e.info.action=n,e.action=oo.createAction(n,e.page.getPDFDoc())),e.eventEmitter.emit(le.annotationUpdated,[e],e.getPDFPage(),en.actionDataUpdated),e.eventEmitter.emit(le.actionRemove,e),!0}))}},{key:"moveAction",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.moveAction(i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(en.moveAction)}))}}]),n}(ln);const Nb=Lb;var Vb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getInkList",value:function(){return this.info.inkList}},{key:"setInkList",value:function(e){var t=this;if(this.isDeleted())return Promise.resolve();this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setInkList(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.inkListUpdated).then((function(){t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],t.getPDFPage())}))})).then((function(){return!0}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this),t=this.info.inkList,i="[";if(t.length>0){for(var r=0;r<t.length;r++)0!=r&&1==t[r].type&&(i=i.substr(0,i.length-1),i+="],["),i+=t[r].x+","+t[r].y+";";i=i.substr(0,i.length-1)+"]"}else i="[]";return Object.assign({},e,{inklist:i})}}]),n}(Am);const Bb=Vb;var jb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e,i),e.action&&(r.action=r.page.doc.engine.actionFactory.createAction(e.action,i.doc,r.page.doc.api,r.eventEmitter,(0,w._)(r))),r}return(0,A._)(n,[{key:"getFlags",value:function(){return-2&(0,S._)((0,x._)(n.prototype),"getFlags",this).call(this)}},{key:"getAction",value:function(){return this.action}},{key:"getActionPromise",value:function(){var e=this,t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.getAction(n.getId(),t.getId(),this.getId()).then((function(t){return e.action=e.page.doc.engine.actionFactory.createAction(t,n,e.page.doc.api,e.eventEmitter,e),e.action}))}},{key:"getOpacity",value:function(){return this.info.opacity}},{key:"getRotation",value:function(){return this.info.rotation}},{key:"setRotation",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setAnnotRotation(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(n){var i=0;for(n.length;i--;)n[i].info.rotation=e;return t.info.rotation=e,n})).then((function(e){return t.eventEmitter.emit(le.annotationUpdated,e,n,en.rotationUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,e,n),e}))}},{key:"setOpacity",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return e=+e,this.page.doc.api.setAnnotOpacity(i.getId(),n.getId(),this.getId(),e).then((function(e){return n.getAnnotsByObjectNumArray(e)})).then((function(n){var i=0;for(n.length;i--;)n[i].info.opacity=e;return t._update().then((function(){return n}))})).then((function(e){return t.eventEmitter.emit(le.annotationUpdated,e,n,en.opacityUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,e,n),e}))}},{key:"setRect",value:function(e){var t=this,n=this.info.rect;this.info.rect=e;var i=this.getPDFPage(),r=i.getPDFDoc();return this.page.doc.api.setAnnotRect(r.getId(),i.getId(),this.getId(),e).then((function(r){return t.eventEmitter.emit(le.invalidRect,new Zt(n.left,n.bottom,n.right,n.top),new Zt(e.left,e.bottom,e.right,e.top),t.info.type,t.info,i),r?(t.eventEmitter.emit(le.annotationUpdated,[t],i,en.rectUpdated),t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],i),!0):r}))}},{key:"moveTo",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=t.top,r=Object.assign({},this.info.rect),o=r.right,a=r.bottom,s=n-r.left,u=i-r.top,c=this.info.rect={left:n,top:i,right:o+s,bottom:a+u},l=this.getPDFPage(),d=l.getPDFDoc().getId(),h=l.getId(),f=this.getId();return this.page.doc.api.moveAnnotTo(d,h,f,{left:n,top:i}).then((function(e){return l.getAnnotsByObjectNumArray(e)})).then((function(t){e.eventEmitter.emit(le.invalidRect,new Zt(r.left,r.bottom,r.right,r.top),new Zt(c.left,c.bottom,c.right,c.top),e.info.type,e.info,l),e.eventEmitter.emit(le.annotationUpdated,t,l,en.rectUpdated),e.eventEmitter.emit(le.annotationMovedPosition,t,l,e)}))}},{key:"removeAction",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=arguments.length>1?arguments[1]:void 0,i=0,r=0;n?(i=0,r=n.info.objNumber):delete this.info.AA[t],"-1"==t?(delete this.info.action,delete this.action):(delete this.info.AA[t],this.engineActions&&delete this.engineActions[t]);var o=this.page,a=o.doc;return a.api.removeAction(a.getId(),o.getId(),this.getId(),t,i,r).then((function(n){var i=n[0];return i&&("-1"==t?(e.info.action=i,e.action=oo.createAction(i,e.page.getPDFDoc())):(e.info.AA[t]=i,e.engineActions[t]=oo.createAction(i,e.page.getPDFDoc()))),e.eventEmitter.emit(le.annotationUpdated,[e],e.getPDFPage(),en.actionDataUpdated),e.eventEmitter.emit(le.actionRemove,e),!0}))}},{key:"setImage",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setImage(i.getId(),n.getId(),this.getId(),e).then((function(e){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n),t.update(en.imageUpdated),e}))}},{key:"setTitle",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setTitle(i.getId(),n.getId(),this.getId(),e).then((function(){return t.update(en.titleUpdated)}))}},{key:"getAdditionalAction",value:function(e){if(-1==e)return this.action;if(!this.engineActions)for(var t in this.engineActions={},this.info.AA)this.engineActions[t]=oo.createAction(this.info.AA[t],this.page.getPDFDoc());return this.engineActions[e]}},{key:"setAdditionalAction",value:function(e,t){return this.setAction(t,e)}},{key:"setAction",value:function(e,t,n){var i=this;if(!e)throw new Error("No Action!");var r=this.page,o=r.doc;return this.engineActions||this.getAdditionalAction(11),this.page.doc.api.setAction(o.getId(),r.getId(),this.getId(),e.info,t,n).then((function(a){e.init(a,i.page.doc.engine.actionFactory,o,i.page.doc.api,i.page.doc.engine.eventEmitter,i);var s=!1;return-1==t&&i.info.action&&(s=!0),-1!=t&&i.engineActions[t]&&(s=!0),n&&s?-1==t?i.action.appendSubAction(e):i.engineActions[t].appendSubAction(e):-1==t?(i.info.action=e.info,i.action=e):(i.info.AA[t]=e.info,i.engineActions[t]=e),i.eventEmitter.emit(le.annotationUpdated,[i],r,en.addAction),a}))}},{key:"setActionData",value:function(e,t){var n=this;return e.setActionData(t).then((function(){return n.update(en.actionDataUpdated),!0}))}},{key:"getImage",value:function(e){var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.getBitmapBuffer(n.getId(),t.getId(),this.getId()).then((function(t){if(!t.width||!t.height)return null;switch(e||"canvas"){case"canvas":return uy(t);case"image":return cy(t);case"buffer":return ly(t);default:throw new Error("Invalid options.type: ".concat(e))}}))}},{key:"moveAction",value:function(e){var t=this,n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.moveAction(i.getId(),n.getId(),this.getId(),e).then((function(e){return t.update(en.moveAction).then((function(e){t.updateAdditionalAction()}))}))}},{key:"updateAdditionalAction",value:function(){for(var e in this.engineActions={},this.info.AA)this.engineActions[e]=oo.createAction(this.info.AA[e],this.page.getPDFDoc())}}]),n}(ln),Ub=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;return(0,P._)(this,n),r=t.call(this,e,i),e.action&&(r.action=r.page.doc.engine.actionFactory.createAction(e.action,i.doc,r.page.doc.api,r.eventEmitter,(0,w._)(r))),r}return(0,A._)(n,[{key:"getIconName",value:function(){return this.info.iconName||"Speaker"}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this);return e.rate=this.info.soundObj&&this.info.soundObj.sampleRate,e}}]),n}(Am);const Hb=Ub;var Wb=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"getFlags",value:function(){return-2&(0,S._)((0,x._)(n.prototype),"getFlags",this).call(this)}},{key:"getOpenStatus",value:function(){return this.info.openStatus}},{key:"setOpenStatus",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setPopupOpenStatus(i.getId(),n.getId(),this.getId(),e).then((function(){t.info.openStatus=e;var i=[t];return t.eventEmitter.emit(le.annotationAppearanceUpdated,i,n),i}))}},{key:"exportToJSON",value:function(){var e=this.info.flag,t="";for(var n in Pe)e&1<<parseInt(n)&&(t+=Pe[n]+",");var i=this.info.name,r=this.page.getIndex(),o=this.info.openStatus?"yes":"no",a=this.info.rect;return{flags:t,name:i,page:r,open:o,rect:a.left+","+a.bottom+","+a.right+","+a.top,type:"popup"}}}]),n}(ln),Yb={Courier:0,"Courier-Bold":1,"Courier-BoldOblique":2,"Courier-Oblique":3,Helvetica:4,"Helvetica-Bold":5,"Helvetica-BoldOblique":6,"Helvetica-Oblique":7,"Times-Roman":8,"Times-Bold":9,"Times-BoldItalic":10,"Times-Italic":11,Symbol:12,ZapfDingbats:13};function qb(e){return Yb[e]}function Kb(e){for(var t in Yb)if(Yb[t]==e)return t;return""}var $b={FoxitFixedOTF:"Courier",FoxitSansMM:"Courier","FoxitFixedOTF-Bold":"Courier-Bold","FoxitFixedOTF-Italic":"Courier-Oblique","FoxitFixedOTF-BoldItalic":"Courier-BoldOblique",FoxitSansOTF:"Helvetica","FoxitSansOTF-Italic":"Helvetica-Oblique","FoxitSansOTF-Bold":"Helvetica-Bold","FoxitSansOTF-BoldItalic":"Helvetica-BoldOblique","FoxitSansPS-BoldItalic":"Helvetica-BoldOblique",FoxitSerifOTF:"Times-Roman","FoxitSerifOTF-Italic":"Times-Italic","FoxitSerifOTF-Bold":"Times-Bold","FoxitSerifOTF-BoldItalic":"Times-BoldItalic",FoxitSymbolOTF:"Symbol",FoxitDingbatsOTF:"ZapfDingbats"},zb=[{name:"Times Roman",value:"Times-Roman"},{name:"Times Bold",value:"Times-Bold"},{name:"Times Italic",value:"Times-Italic"},{name:"Times BoldItalic",value:"Times-BoldItalic"},{name:"Helvetica",value:"Helvetica"},{name:"Helvetica Bold",value:"Helvetica-Bold"},{name:"Helvetica Oblique",value:"Helvetica-Oblique"},{name:"Helvetica BoldOblique",value:"Helvetica-BoldOblique"},{name:"Courier",value:"Courier"},{name:"Courier Bold",value:"Courier-Bold"},{name:"Courier Oblique",value:"Courier-Oblique"},{name:"Courier BoldOblique",value:"Courier-BoldOblique"},{name:"Symbol",value:"Symbol"},{name:"ZapfDingbats",value:"ZapfDingbats"}],Gb=function(e){return zb.some((function(t){return t.value===e}))},Jb=[{name:"Courier",value:"Courier"},{name:"Helvetica",value:"Helvetica"},{name:"Times Roman",value:"Times-Roman"},{name:"Symbol",value:"Symbol"},{name:"ZapfDingbats",value:"ZapfDingbats"}],Xb=[{name:"黑体",value:"SimHei,STHeiti,Noto Serif Hebrew"},{name:"楷体",value:"CESI_KT_GB2312,KaiTi,STKaiti"},{name:"仿宋",value:"FangSong,STFangSong,CESI_FS_GB13000"},{name:"宋体",value:"SimSun,STSong,CESI_SS_GB13000"}],Zb=[{name:"Noto Sans SC Regular",family:"Noto Sans SC Regular"},{name:"Noto Sans",family:"Noto Sans"},{name:"Noto Sans Tibetan",family:"Noto Sans Tibetan"},{name:"Noto Sans CJK TC Medium",family:"Noto Sans CJK TC Medium"},{name:"Noto Sans Mono CJK KR Regular",family:"Noto Sans Mono CJK KR Regular"},{name:"Noto Sans CJK KR DemiLight",family:"Noto Sans CJK KR DemiLight"},{name:"Noto Sans Thai",family:"Noto Sans Thai"},{name:"Noto Sans Cherokee",family:"Noto Sans Cherokee"},{name:"Noto Sans CJK JP Regular",family:"Noto Sans CJK JP Regular"},{name:"Noto Sans CJK JP Thin",family:"Noto Sans CJK JP Thin"},{name:"Noto Sans CJK TC Thin",family:"Noto Sans CJK TC Thin"},{name:"Noto Sans SC Thin",family:"Noto Sans SC Thin"},{name:"Noto Sans Tai Le",family:"Noto Sans Tai Le"},{name:"Noto Sans Thaana",family:"Noto Sans Thaana"},{name:"Noto Sans SC Light",family:"Noto Sans SC Light"},{name:"Noto Sans SC Medium",family:"Noto Sans SC Medium"},{name:"Noto Sans CJK KR Medium",family:"Noto Sans CJK KR Medium"},{name:"Noto Serif Lao",family:"Noto Serif Lao"},{name:"Noto Sans TC Light",family:"Noto Sans TC Light"},{name:"Noto Sans Phags Pa",family:"Noto Sans Phags Pa"},{name:"Noto Sans Telugu",family:"Noto Sans Telugu"},{name:"Noto Sans Yi",family:"Noto Sans Yi"},{name:"Noto Sans Canadian Aboriginal",family:"Noto Sans Canadian Aboriginal"},{name:"Noto Sans Khmer",family:"Noto Sans Khmer"},{name:"Noto Sans Syriac Eastern",family:"Noto Sans Syriac Eastern"},{name:"Noto Serif Thai",family:"Noto Serif Thai"},{name:"Noto Sans Hebrew",family:"Noto Sans Hebrew"},{name:"Noto Sans CJK JP Medium",family:"Noto Sans CJK JP Medium"},{name:"Noto Sans SC Black",family:"Noto Sans SC Black"},{name:"Noto Sans Lao",family:"Noto Sans Lao"},{name:"Noto Sans Tamil",family:"Noto Sans Tamil"},{name:"Noto Sans Gujarati",family:"Noto Sans Gujarati"},{name:"Noto Sans Sinhala",family:"Noto Sans Sinhala"},{name:"Noto Sans CJK TC DemiLight",family:"Noto Sans CJK TC DemiLight"},{name:"Noto Sans Ethiopic",family:"Noto Sans Ethiopic"},{name:"Noto Sans Gujarati",family:"Noto Sans Gujarati"},{name:"Noto Serif Khmer",family:"Noto Serif Khmer"},{name:"Noto Sans CJK TC Light",family:"Noto Sans CJK TC Light"},{name:"Noto Sans CJK KR Light",family:"Noto Sans CJK KR Light"},{name:"Noto Sans CJK KR Thin",family:"Noto Sans CJK KR Thin"},{name:"Noto Sans CJK KR",family:"Noto Sans CJK KR"},{name:"Noto Sans CJK SC DemiLight",family:"Noto Sans CJK SC DemiLight"},{name:"Noto Sans CJK JP Light",family:"Noto Sans CJK JP Light"},{name:"Noto Sans Mono CJK SC Regular",family:"Noto Sans Mono CJK SC Regular"},{name:"Noto Sans Mono CJK TC Regular",family:"Noto Sans Mono CJK TC Regular"},{name:"Noto Naskh Arabic",family:"Noto Naskh Arabic"},{name:"Noto Sans Mongolian",family:"Noto Sans Mongolian"},{name:"Noto Sans Mono CJK JP Regular",family:"Noto Sans Mono CJK JP Regular"},{name:"Noto Sans CJK JP DemiLight",family:"Noto Sans CJK JP DemiLight"}],Qb=[{text:"Helvetica",value:4},{text:"Courier",value:0},{text:"Courier-Bold",value:1},{text:"Courier-BoldOblique",value:2},{text:"Courier-Oblique",value:3},{text:"Helvetica-Bold",value:5},{text:"Helvetica-BoldOblique",value:6},{text:"Helvetica-Oblique",value:7},{text:"Times-Bold",value:9},{text:"Times-BoldItalic",value:10},{text:"Times-Italic",value:11}],ew=[{text:"宋体",name:"SimSun",style:34,charset:134},{text:"楷体",name:"KaiTi",style:32,charset:134}],tw=function(){return"Helvetica"},nw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){return(0,P._)(this,n),t.call(this,e,i)}return(0,A._)(n,[{key:"isArea",value:function(){return this.info.isArea}},{key:"getRects",value:function(){var e=[];return this.info.quadPoints&&this.info.quadPoints.length>0?this.info.quadPoints.forEach((function(t){e.push({left:t[0].x,top:t[0].y,right:t[3].x,bottom:t[3].y})})):e.push(this.info.rect),e}},{key:"apply",value:function(){var e=this,t=this.getPDFPage(),n=t.getPDFDoc();if(!n.checkPermission(Qt.annotForm)||!n.checkPermission(Qt.modify))throw new Error("Permission error");return this.page.doc.api.redactApply(n.getId(),t.getId(),this.getId()).then((function(n){var i=t.clearAnnotIds(n);e.page.doc.engine.eventEmitter.emit(le.annotationRemoved,i,t);var r=[{pageIndex:t.getIndex(),removedAnnots:n}];return e.eventEmitter.emit(le.applyRedaction,r),r}))}},{key:"getOverlayText",value:function(){return this.info.overlayText}},{key:"setOverlayText",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setRedactOverlayText(i.getId(),n.getId(),this.getId(),e).then((function(n){return n?t.update(en.overlayTextUpdated).then((function(){return t.info.overlayText=e,n})):n}))}},{key:"removeOverlayText",value:function(){var e=this;this.checkModidyPerm();var t=this.getPDFPage(),n=t.getPDFDoc();return this.page.doc.api.removeRedactOverlayText(n.getId(),t.getId(),this.getId()).then((function(t){return t?e.update(en.overlayTextUpdated).then((function(){return delete e.info.overlayText,t})):t}))}},{key:"getOverlayTextAlignment",value:function(){return this.info.justification}},{key:"setOverlayTextAlignment",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setRedactOverlayTextAlignment(i.getId(),n.getId(),this.getId(),e).then((function(n){return n?t.update(en.overlayTexAlignmentUpdated).then((function(){return t.info.justification=e+"",n})):n}))}},{key:"getRepeat",value:function(){return this.info.isRepeat}},{key:"setRepeat",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setRedactRepeat(i.getId(),n.getId(),this.getId(),e).then((function(n){return n?t.update(en.repeatUpdated).then((function(){return t.info.isRepeat=e,n})):n}))}},{key:"setAutoFontSize",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setRedactAutoFontSize(i.getId(),n.getId(),this.getId(),e).then((function(n){return n?t.update(en.autoFontSizeUpdated).then((function(){return t.info.isAutoFontSize=e,n})):n}))}},{key:"getAutoFontSize",value:function(){return this.info.isAutoFontSize}},{key:"getDefaultAppearance",value:function(){var e=Object.assign({},this.info.defaultAppearance);return delete e.flags,e}},{key:"setDefaultAppearance",value:function(e){var t=this;this.checkModidyPerm();var n=this.getPDFPage(),i=n.getPDFDoc(),r=Object.assign({},this.info.defaultAppearance,e);return e.textColor&&(r.textColor=(0,j.colorConvertor)(e.textColor,"int",1)),e.textSize&&"number"==typeof e.textSize&&e.textSize<0&&(r.textSize=0),void 0===Yb[r.fontName]&&(r.fontName="Helvetica"),this.page.doc.api.setRedactDefaultAppearance(i.getId(),n.getId(),this.getId(),r).then((function(e){return e?t.update(en.redactDefaultAppearanceUpdated).then((function(){return t.info.fontName=r.fontName,delete r.fontName,t.info.defaultAppearance=r,e})):e}))}},{key:"setOpacity",value:function(e,t){var n=this;this.checkModidyPerm();var i=this.getPDFPage(),r=i.getPDFDoc();return this.info.onlyForFill=t,this.page.doc.api.setRedactOpacity(r.getId(),i.getId(),this.getId(),e,t).then((function(t){return t&&(n.info.opacity=e,n.eventEmitter.emit(le.annotationUpdated,[n],i,en.opacityUpdated)),n.updateInfo(n.info),t}))}},{key:"getFillColor",value:function(){return(0,S._)((0,x._)(n.prototype),"getFillColor",this).call(this)}},{key:"setFillColor",value:function(e){var t=this;e=0===e?0:(0,j.colorConvertor)(e,"int");var n=this.getPDFPage(),i=n.getPDFDoc();return i.api.setRedactAnnotFillColor(i.getId(),n.getId(),this.getId(),e,this.info.onlyForFill).then((function(e){return e?t.update(en.fillColorUpdated).then((function(){return t.eventEmitter.emit(le.annotationAppearanceUpdated,[t],n),e})):e}))}},{key:"getApplyFillColor",value:function(){return this.info.applyFillColor}},{key:"setRedactApplyFillColor",value:function(e){var t=this;this.checkModidyPerm(),e=(0,j.colorConvertor)(e,"int",1);var n=this.getPDFPage(),i=n.getPDFDoc();return this.page.doc.api.setRedactApplyFillColor(i.getId(),n.getId(),this.getId(),e).then((function(n){return n?t.update(en.applyFillColorUpdated).then((function(){return t.info.applyFillColor=e,n})):n}))}},{key:"exportToJSON",value:function(){var e=(0,S._)((0,x._)(n.prototype),"exportToJSON",this).call(this);e["interior-color"]=(0,j.convertFromNumberToHex)(16777215&this.getApplyFillColor()),e.interiorColor=e["interior-color"];for(var t=this.info.quadPoints,i="",r=0;r<t.length;r++){var o=t[r];i+=o[0].x+","+o[0].y+",",i+=o[1].x+","+o[1].y+",",i+=o[2].x+","+o[2].y+",",i+=o[3].x+","+o[3].y+","}e.coords=i.substr(0,i.length-1),e["overlay-text"]=this.info.overlayText,e.overlayText=this.info.overlayText;var a="";this.info.fontName&&(a+="/"+this.info.fontName+" "),null!=this.info.defaultAppearance.textSize&&(a+=this.info.defaultAppearance.textSize+" Tf ");var s=(0,j.convertFromNumberToRGBA)(this.info.defaultAppearance.textColor);return a+=(s.r/255).toFixed(2)+" "+(s.g/255).toFixed(2)+" "+(s.b/255).toFixed(2)+" RG",e.defaultappearance=a,e.fontColor=(0,j.colorConvertor)(16777215&this.info.defaultAppearance.textColor,"#",0),e.justification=this.info.justification,e.repeat=this.info.isRepeat?"yes":"no",e}},{key:"getRedactionCode",value:function(){return this.info.overlayCode}},{key:"getRedactAppearance",value:function(){return this.info}},{key:"setRedactAppearance",value:function(e){var t=this,n=e.applyFillColor,i=e.isAutoFontSize,r=e.textColor,o=e.defaultAppearance,a=e.textSize,s=e.fontName,u=e.justification,c=e.isRepeat,l=e.overlayText,d=e.redactionCode;this.checkModidyPerm(),!r&&o&&(r=o.textColor),!a&&o&&(a=o.textSize),void 0!==n&&(n=(0,j.colorConvertor)(n,"int",1)),void 0!==r&&(r=(0,j.colorConvertor)(r,"int",1));var h=this.getPDFPage(),f=h.getPDFDoc(),g={applyFillColor:n,isAutoFontSize:i,textColor:r,textSize:a,fontName:s,overlayText:l,justification:u,isRepeat:c,redactionCode:d};return this.page.doc.api.setRedactAppearance(f.getId(),h.getId(),this.getId(),g).then((function(e){if(e){var o="";return void 0!==n&&(o=en.fillColorUpdated),void 0===s&&void 0===r&&void 0===a&&void 0===l||(o=en.redactDefaultAppearanceUpdated),void 0!==i&&(o=en.autoFontSizeUpdated),void 0!==u&&(o=en.overlayTexAlignmentUpdated),void 0!==d&&(t.info.overlayCode=d),void 0!==c&&(o=en.repeatUpdated),void 0!==l&&(o=en.overlayTextUpdated),o&&t.update(o).then((function(){return e}))}return e}))}}]),n}(Am);const iw=nw;var rw=function(){function e(t){(0,P._)(this,e)}return(0,A._)(e,[{key:"get",value:function(e,t){switch(e.type){case Hi.highlight:return new ub(e,t);case Hi.squiggly:return new gb(e,t);case Hi.strikeOut:return new lb(e,t);case Hi.underline:return new hb(e,t);case Hi.line:return new pb(e,t);case Hi.polyLine:return new wb(e,t);case Hi.polygon:return new Pb(e,t);case Hi.fileAttachment:return new Db(e,t);case Hi.text:return new Sb(e,t);case Hi.circle:return new xb(e,t);case Hi.caret:return new Ib(e,t);case Hi.freeText:return new Fb(e,t);case Hi.ink:return new Bb(e,t);case Hi.sound:return new Hb(e,t);case Hi.square:return new Rb(e,t);case Hi.stamp:return new Ob(e,t);case Hi.link:return new Nb(e,t);case Hi.widget:return new ho(e,t);case Hi.screen:return new jb(e,t);case Hi.popup:return new Wb(e,t);case Hi.redact:return new iw(e,t);default:return new ln(e,t)}}}]),e}();const ow=rw;var aw={0:{id:"0",name:"StandardID_e_StdIDCourier",isBold:!1,isItalic:!1},1:{id:"1",name:"StandardID_e_StdIDCourierB",isBold:!0,isItalic:!1},2:{id:"2",name:"StandardID_e_StdIDCourierBI",isBold:!0,isItalic:!0},3:{id:"3",name:"StandardID_e_StdIDCourierI",isBold:!1,isItalic:!0},4:{id:"4",name:"StandardID_e_StdIDHelvetica",isBold:!1,isItalic:!1},5:{id:"5",name:"StandardID_e_StdIDHelveticaB",isBold:!0,isItalic:!1},6:{id:"6",name:"StandardID_e_StdIDHelveticaBI",isBold:!0,isItalic:!0},7:{id:"7",name:"StandardID_e_StdIDHelveticaI",isBold:!1,isItalic:!0},8:{id:"8",name:"StandardID_e_StdIDTimes",isBold:!1,isItalic:!1},9:{id:"9",name:"StandardID_e_StdIDTimesB",isBold:!0,isItalic:!1},10:{id:"10",name:"StandardID_e_StdIDTimesBI",isBold:!0,isItalic:!0},11:{id:"11",name:"StandardID_e_StdIDTimesI",isBold:!1,isItalic:!0},12:{id:"12",name:"StandardID_e_StdIDSymbol",isBold:!1,isItalic:!1},13:{id:"13",name:"StandardID_e_StdIDZapfDingbats",isBold:!1,isItalic:!1}},sw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,A._)(n,[{key:"put",value:function(e){}},{key:"isBold",value:function(){var e=this.info.textState.font;if(e.isStandard){if(aw[e.standardId])return aw[e.standardId].isBold;console.warn("No configuration found for standard font: ",e)}return e.isBold||262144==(262144&e.styles)}},{key:"isItalic",value:function(){var e=this.info.textState.font;if(e.isStandard){if(aw[e.standardId])return aw[e.standardId].isItalic;console.warn("No configuration found for standard font: ",e)}return e.isItalic||64==(64&e.styles)}},{key:"getText",value:function(){return this.info.textState.text}},{key:"getFontInfo",value:function(){return this.info.textState.font}},{key:"setText",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");if(this.getText()===e)return Promise.resolve();var n=this.getPDFPage();return n.doc.api.setTextObjectChar(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"setItalic",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");if(this.isItalic()===e)return Promise.resolve();var n=this.getPDFPage();return n.doc.api.setTextObjectItalic(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"setBold",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");if(this.isBold()===e)return Promise.resolve();var n=this.getPDFPage();return n.doc.api.setTextObjectBold(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"getFontSize",value:function(){return this.info.textState.size}},{key:"setFontSize",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");if(this.getFontSize()===e)return Promise.resolve();var n=this.getPDFPage();return n.doc.api.setTextObjectFontSize(n.getPDFDoc().getId(),n.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"setStandardFont",value:function(e){var t=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var n=this.info.textState.font;if(!n||n.isStandard&&e===n.stardardId)return Promise.resolve();var i=this.getPDFPage();return i.doc.api.setTextObjectStandardFont(i.getPDFDoc().getId(),i.getId(),this.getId(),e).then((function(e){t.afterUpdated(e)}))}},{key:"setFontByName",value:function(e,t,n){var i=this;if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");if(!this.info.textState.font)return Promise.resolve();var r=this.getPDFPage();return r.doc.api.setTextObjectFontByName(r.getPDFDoc().getId(),r.getId(),this.getId(),e,t,n).then((function(e){i.afterUpdated(e)}))}},{key:"getWoff",value:function(){var e=this.getPDFPage();return e.doc.api.getTextObjectWoff(e.getPDFDoc().getId(),e.getId(),this.getId())}}]),n}(hy);const uw=sw;var cw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,A._)(n,[{key:"getFillMode",value:function(){return this.info.fillMode}},{key:"setBorderColor",value:function(e){if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");return this.info.needStroke=0!==e,(0,S._)((0,x._)(n.prototype),"setBorderColor",this).call(this,e)}},{key:"getPathPoints",value:function(){return this.info.path}},{key:"needStroke",value:function(){return this.info.needStroke}}]),n}(hy),lw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){return(0,P._)(this,n),t.call(this,e,i,r)}return(0,A._)(n,[{key:"setRotation",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!t)return Promise.resolve(this.info);if(!this.doc.checkPermission(Qt.modify))throw new Error("Permission error");var n=this.getPDFPage();return n.doc.api.setImageObjectRotation(n.getPDFDoc().getId(),n.getId(),this.getId(),t).then((function(t){return e.afterUpdated(t)}))}},{key:"getStream",value:function(){var e=this.getPDFPage();return e.doc.api.getImageObjectStream(e.getPDFDoc().getId(),e.getId(),this.getId())}}]),n}(hy),dw=function(){function e(t){(0,P._)(this,e),this.engine=t}return(0,A._)(e,[{key:"get",value:function(e,t){if(!e)return null;var n=this.engine;switch(e.type){case 1:return new uw(e,t,n);case 2:return new cw(e,t,n);case 3:return new lw(e,t,n);case void 0:return null;default:return new hy(e,t,n)}}}]),e}(),hw="foxit-default-annot-prop",fw=function(){function e(t,n,i){(0,P._)(this,e),this.api=new Ay.Z(t),this.storage=i.storage,this.annotManager=new ow,this.actionFactory=oo,this.graphicsObjectManager=new dw(this),this.eventEmitter=n,this.userName=null,this.userConfig={},this.pdfDocCacheMap=new Map,this.defaultAnnotConfig=function(){}}return(0,A._)(e,[{key:"init",value:function(){return this.api.init().catch((function(e){return Promise.reject(e.error)}))}},{key:"setIcons",value:function(e){return this.api.setIcons(e)}},{key:"addIcon",value:function(e){return this.api.addIcon(e)}},{key:"removeIcon",value:function(e,t,n){return this.api.removeIcon(e,t,n)}},{key:"removePDFDocById",value:function(e){if(this.pdfDocCacheMap.has(e)){var t=this.pdfDocCacheMap.get(e);t&&(this.pdfDocCacheMap.delete(e),t.destroy())}}},{key:"createPDFDocById",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.pdfDocCacheMap.has(e)?t=this.pdfDocCacheMap.get(e):(t=new ab(e,this,n),this.pdfDocCacheMap.set(e,t)),t}},{key:"getPDFDocByFile",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.fileName=n.fileName||e.name||"",this.api.getPDFDocIdByFile(e,{jwt:n.jwt,ReadBlockOption:n.ReadBlockOption}).then((function(e){return t.createPDFDocById(e,n)}))}},{key:"checkCertificatePassword",value:function(e,t){return this.api.checkCertificatePassword(e,t)}},{key:"getCertificateInfo",value:function(e,t){return this.api.getCertificateInfo(e,t)}},{key:"createNewDoc",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"untitled.pdf",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{height:842,width:595};return this.api.createNewDoc(t,n,i).then((function(n){return e.getPDFDocByFile(n,{fileName:t})})).then((function(e){return e.parse({password:""})}))}},{key:"createNewPortfolioDoc",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Portfolio.pdf";return this.api.createNewPortfolioDoc(e,t,i).then((function(e){return n.getPDFDocByFile(e,{fileName:i})})).then((function(e){return e.parse({password:""})}))}},{key:"getPDFDocByChunk",value:function(e,t,n){var i=this;return this.api.getPDFDocIdByChunk(e,t).then((function(e){return i.createPDFDocById(e,n)}))}},{key:"getPDFDocByHttpRangeRequest",value:function(e,t){var n=this;return this.api.getPDFDocIdByHttpRangeRequest(e,{jwt:t.jwt}).then((function(e){return n.createPDFDocById(e,t)}))}},{key:"getPDFDocByArrayBuffer",value:function(e,t){var n=this;return this.api.getPDFDocIdByArrayBuffer(e).then((function(e){return n.createPDFDocById(e,t)}))}},{key:"getPDFDocByCacheId",value:function(e,t){return this.pdfDocCacheMap.has(e)?Promise.resolve(this.pdfDocCacheMap.get(e)):this.getPDFDocById(e,t)}},{key:"getPDFDocById",value:function(e,t){return Promise.resolve(this.createPDFDocById(e,t))}},{key:"setUserConfig",value:function(e){this.userConfig=e||{}}},{key:"getUserConfig",value:function(){return this.userConfig}},{key:"getUserCommentConfig",value:function(){return this.userConfig.commentPreference||{}}},{key:"setUserName",value:function(e){var t=this;return this.api.setUserName(e).then((function(n){t.userName=e}))}},{key:"getUserName",value:function(){var e=this;return this.userName?Promise.resolve(this.userName):this.api.getUserName().then((function(t){return e.userName=t,t}))}},{key:"setDynamicInfoFormula",value:function(e,t){return this.api.setDynamicInfoFormula(e,t)}},{key:"getDynamicInfoFormula",value:function(){return this.api.getDynamicInfoFormula()}},{key:"setDigitalTimeFormat",value:function(e){return this.api.setDigitalTimeFormat(e)}},{key:"setDigitalInfo",value:function(e){return this.api.setDigitalInfo(e)}},{key:"getUtils",value:function(){return i}},{key:"getDefaultAnnotConfig",value:function(){var e=this;return function(t,n){var i=e.defaultAnnotConfig(t,n),r=e.getAnnotDefaultProperty(t,n);return(0,j.extendOptions)({},i,r)}}},{key:"setDefaultAnnotConfig",value:function(e){this.defaultAnnotConfig=e}},{key:"initADPs",value:function(){return this.ADPs||(this.ADPs=this.storage.getItem(hw)||{}),this.ADPs}},{key:"getAnnotDefaultProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.initADPs(),this.ADPs[e+t]||{}}},{key:"setAnnotDefaultProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.initADPs(),Object.assign(this.ADPs,(0,J._)({},e+t,n)),this.storage.setItem(hw,this.ADPs)}},{key:"setTabOrder",value:function(e,t,n){return this.api.setTabOrder(e,t,n)}},{key:"getTabOrder",value:function(e,t){return this.api.getTabOrder(e,t)}},{key:"setStructureOrder",value:function(e,t,n){return this.api.setStructureOrder(e,t,n)}},{key:"getAllModuleLicenseRight",value:function(){return this.api.getAllModuleLicenseRight().then((function(e){return e}))}},{key:"getPDFDocFromImageFile",value:function(e){var t,n,i,r,o=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a.fileName=a.fileName||e.name||"",this.api.getPDFDocFromImageFile(e).then((function(e){var t=e.docId;return n=e.width,i=e.height,r=e.buffer,o.createPDFDocById(t,a).parse({password:""})})).then((function(e){return t=e,e.getPageByIndex(0)})).then((function(e){return e.addImage(r,{left:0,top:i,right:n,bottom:0})})).then((function(e){if(e)return t;throw new Error("faied to insert image")})).catch((function(e){return e&&console.error(e),Promise.reject(e)}))}},{key:"ensureSideModeLoaded",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"openssl";return this.api.ensureSideModeLoaded(e)}}]),e}();const gw=fw;var vw,pw=g(1551),mw=g.n(pw),yw=function(){function e(){(0,P._)(this,e),this.container=document.createElement("div"),this.printArea=new(mw())(this.container),this.imageCache=[]}return(0,A._)(e,[{key:"appendImage",value:function(e){return this.imageCache.push(this.createImageDOM(this.imageCache.length,e))}},{key:"getImageCache",value:function(){return this.imageCache}},{key:"clearImageCache",value:function(){this.imageCache=[]}},{key:"createImageDOM",value:function(e,t){var n=document.createElement("div");n.setAttribute("data-index",e),n.style.cssText="width: 100%;height: 100%; page-break-after: always;";var i=document.createElement("img");i.style.cssText="max-width: 100%; max-height: 100%;";var r=new Promise((function(e,t){i.onload=function(){e(n)},i.onerror=function(){t(n)}}));return i.src=t,n.appendChild(i),r}},{key:"print",value:function(e,t,n){var i=this;j.isIE&&e&&function(){var e="HKEY_CURRENT_USER",t="\\Software\\Microsoft Internet Explorer\\PageSetup ";try{var n,i=new ActiveXObject("WScript.Shell");n="header",i.RegWrite(e+t+n,""),n="footer",i.RegWrite(e+t+n,"")}catch(e){console.error(e)}}(),(t||this.imageCache).reduce((function(e,t){return e.then((function(){return t})).then((function(e){e&&i.container.appendChild(e)}))}),Promise.resolve()).then((function(){i.imageCache=[],i.printArea.getHead=function(){return"\n                <head>\n                <style>\n                    *{ margin: 0; padding: 0; }\n                </style>\n                ".concat(e?'\n                    <style type="text/css" media="print">\n                        @page {\n                            /* hide header and footer */\n                            size: auto;\n                            margin: 0;\n                        }\n                        a[href]:after { content: none !important; }\n                        img[src]:after { content: none !important; }\n                    </style>\n                ':"","\n                </head>\n            ")},i.printArea.print(),i.container.innerHTML=""}))}}]),e}();function kw(e,t){var n,i=(0,I._)(e.data.annots);if(t.action===yo.REMOVE_ANNOT){for(var r=t.data.slice(0),o=0;o<r.length;){for(var a=r[o],s=a.annotId,u=a.pageIndex,c=!1,l=0;l<i.length;){var d=i[l];d.name===s&&d.page===u?(i.splice(l,1),c=!0):l++}c?r.splice(o,1):o++}var h=[];return i.length>0&&h.push({version:Math.min(e.version,t.version),fileId:e.fileId,action:yo.UPDATE_ANNOT,data:{annots:i}}),r.length>0&&h.push({version:Math.max(e.version,t.version),fileId:e.fileId,action:t.action,data:r}),h}return(n=i).push.apply(n,(0,I._)(t.data.annots)),[{version:Math.max(e.version,t.version),fileId:e.fileId,action:yo.UPDATE_ANNOT,format:e.format,data:{annots:i}}]}function bw(e){var t=e;return!(t.action!==yo.UPDATE_ANNOT&&t.action!==yo.CREATE_ANNOT||t.format&&t.format!==vw.json)}function ww(e){return e.action===yo.REMOVE_ANNOT}!function(e){e.json="json",e.fdf="fdf"}(vw||(vw={}));var _w=g(8490);var Pw=g(548);function Aw(e){var t="function"==typeof Map?new Map:void 0;return Aw=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return(0,_w.L)(e,arguments,(0,x.X)(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),(0,Pw.b)(i,e)},Aw(e)}var Sw,xw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).name="CollaborationDataError",i}return n}(Aw(Error)),Cw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,'No handler found for collaboration action: "'.concat(e.action,'", that will be ignored!'))).name="NoHandlerFoundForCollaborationDataError",i}return n}(Aw(Error)),Dw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),(e=t.call(this,"No files area currently open, cannot handling the received collaboration data")).name="PDFDocumentNotOpeningError",e}return n}(Aw(Error)),Ew=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"handler",void 0),this.handler=t.reduce((function(e,t){return new Iw(t,e)}))}return(0,A._)(e,[{key:"accept",value:function(e){return Promise.resolve(!0)}},{key:"receive",value:function(e,t){return this.handler.receive(e,t)}}]),e}(),Iw=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"handler",void 0),(0,J._)(this,"prevHandler",void 0),this.handler=t,this.prevHandler=n}return(0,A._)(e,[{key:"accept",value:function(e){return Promise.resolve(!0)}},{key:"receive",value:function(e,t){return this.handler.receive(e,this.prevHandler||t)}}]),e}();function Rw(e){var t=new FileReader;return new Promise((function(n,i){t.onload=function(){n(t.result)},t.onerror=i,t.readAsDataURL(e)}))}function Tw(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],i=atob(t[1]),r=i.length,o=new Uint8Array(r);r--;)o[r]=i.charCodeAt(r);return new Blob([o],{type:n})}!function(e){e.FROM_FILE="from-file",e.FROM_URL="from-url"}(Sw||(Sw={}));var Fw=j.LoggerFactory.getLogger("Collaboration");function Mw(e,t){return e<15}var Ow=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;(0,P._)(this,n),r=t.call(this),(0,J._)((0,w._)(r),"pdfViewer",void 0),(0,J._)((0,w._)(r),"builtInHandlerInstances",void 0),(0,J._)((0,w._)(r),"userHandlerInstances",void 0),(0,J._)((0,w._)(r),"version",void 0),(0,J._)((0,w._)(r),"queuedExecutor",void 0),(0,J._)((0,w._)(r),"sessionDefer",void 0),(0,J._)((0,w._)(r),"isOpenedFromOtherClient",void 0),(0,J._)((0,w._)(r),"localDataOnDisconnected",void 0),(0,J._)((0,w._)(r),"communicator",void 0),(0,J._)((0,w._)(r),"continueToConnect",void 0),(0,J._)((0,w._)(r),"annotationDataFormat",void 0),r.pdfViewer=e,r.builtInHandlerInstances=[],r.userHandlerInstances=[],r.version=0,r.queuedExecutor=new j.QueuedAsyncTaskExecutor,r.sessionDefer=(0,j.createDeferred)(),r.isOpenedFromOtherClient=!1,r.localDataOnDisconnected=[],r.communicator=i.communicator,r.annotationDataFormat=i.annotationFormat||"json",r.continueToConnect=i.continueToConnect||Mw;var o=i.handlerClasses;return Array.isArray(o)&&o.forEach((function(e){r.registerUserHandler(e)})),r}return(0,A._)(n,[{key:"registerBuiltInHandler",value:function(e){this.builtInHandlerInstances.push(new e(this.pdfViewer))}},{key:"registerUserHandler",value:function(e){this.userHandlerInstances.push(new e(this.pdfViewer))}},{key:"registerCollabDataHandler",value:function(e,t){if("function"==typeof e){if(!e.prototype.accept||!e.prototype.receive)throw new Error("Illegal collaboration data handler: "+e);this.registerUserHandler(e)}else"string"==typeof e&&"function"==typeof t&&this.registerUserHandler(function(){function n(){(0,P._)(this,n)}return(0,A._)(n,[{key:"accept",value:function(t){return Promise.resolve(t.action===e)}},{key:"receive",value:function(e,n){return t.call(this,e,(function(e){return n?n.receive(e):Promise.resolve()}))}}]),n}())}},{key:"prepare",value:function(){var e=this;this.communicator.registerMessageReceiver((function(t){e.queuedExecutor.exec((function(){return e.handleServerMessage(t)}))}));var t=function(t){e.collaborateAddAnnotation(t)},n={},i=function(e){var t,i=e.annot;"link"!==i.info.type&&"screen"!==i.info.type&&(t=i.isGrouped&&i.isGrouped()?i.getGroupElements():[i],n[i.getId()]={action:yo.REMOVE_ANNOT,data:t.map((function(e){return{annotId:e.getUniqueID(),pageIndex:e.getPDFPage().getIndex()}}))})},r=function(t,i){var r=i.getId(),o=n[r];o&&e.send(o),delete n[r]},o=function(t){var n=t.annot;e.collaborateUpadteAnnotation(n)},a=function(t,n){e.shareAndSyncCurrentFile(t,n)},s=function(){e.isOpenedFromOtherClient=!1,e.version=0,e.communicator.disconnect(),e.sessionDefer=(0,j.createDeferred)()},u=function(e){e.normalize()},c=this.pdfViewer.eventEmitter;c.on(de.addAnnotSuccess,t),c.on(de.removeActionAnnotationBefore,i),c.on(de.removeActiveAnnotationSuccess,r),c.on(de.updateActiveAnnotation,o),c.on(de.openFileSuccess,a),c.on(de.willCloseDocument,s),c.on(de.obtainsPageFromEngine,u),this.addDestroyHook((function(){c.off(de.addAnnotSuccess,t),c.off(de.removeActionAnnotationBefore,i),c.off(de.removeActiveAnnotationSuccess,r),c.off(de.updateActiveAnnotation,o),c.off(de.openFileSuccess,a),c.off(de.willCloseDocument,s),c.off(de.obtainsPageFromEngine,u)}))}},{key:"shareAndSyncCurrentFile",value:function(e,t){var n=this;return this.isOpenedFromOtherClient?this.sessionDefer.promise.then((function(t){return n.sync().then((function(){return n.communicator.connect(t.shareId),e}))})):(delete t.options.password,this.communicator.createSession(e,t).then((function(e){return n.sessionDefer.resolve({shareId:e,openFileParams:t}),n.communicator.connect(e)})).then((function(){return n.sync()})))}},{key:"collaborateUpadteAnnotation",value:function(e){var t,n=this;if(t=(t=e.isGrouped&&e.isGrouped()?e.getGroupElements():[e]).filter((function(e){return"screen"!==e.info.type&&"link"!==e.info.type})),0!==t.length)if("json"===this.annotationDataFormat)e.page.doc.exportAnnotsToJSON(t).then((function(e){n.send({action:yo.UPDATE_ANNOT,format:vw.json,data:{annots:e}})}));else{var i="xfdf"===this.annotationDataFormat;e.page.doc.exportAnnotsToFDF(i?ut.xfdf:ut.fdf,t).then((function(e){return Rw(e)})).then((function(e){n.send({action:yo.UPDATE_ANNOT,format:vw.fdf,data:{fdf:e,annots:t.map((function(e){return{page:e.page.getIndex(),id:e.getUniqueID()}}))}})}))}}},{key:"collaborateAddAnnotation",value:function(e){var t,n=this;if(t=(t="function"==typeof e.isGrouped&&e.isGrouped()?e.getGroupElements():[e]).filter((function(e){return"screen"!==e.info.type&&"link"!==e.info.type})),0!==t.length)if("json"===this.annotationDataFormat)e.page.doc.exportAnnotsToJSON(t).then((function(e){n.send({action:yo.CREATE_ANNOT,data:{annots:e}})}));else{var i="xfdf"===this.annotationDataFormat;e.page.doc.exportAnnotsToFDF(i?ut.xfdf:ut.fdf,t).then((function(e){return Rw(e)})).then((function(e){n.send({action:yo.CREATE_ANNOT,format:vw.fdf,data:{fdf:e,annots:t.map((function(e){return{page:e.page.getIndex(),id:e.getUniqueID()}}))}})}))}}},{key:"getSessionInfo",value:function(){return this.sessionDefer.promise}},{key:"getShareId",value:function(){return this.sessionDefer.promise.then((function(e){return e.shareId}))}},{key:"send",value:function(e){var t=this;return this.communicator?this.queuedExecutor.exec((function(){return t.reconnectIfNecessary().then((function(){return t.sessionDefer.promise})).then((function(e){return t.localDataOnDisconnected.length>0?t.sync().then((function(){return e})):e})).then((function(n){var i=t.localDataOnDisconnected.concat(e).map((function(e){var i=t.pdfViewer.getCurrentPDFDoc(),r=(0,b._)((0,k._)({},e),{version:++t.version,fileId:i.info.fileID});return t.communicator.send(n,JSON.stringify(r))}));return t.localDataOnDisconnected.length=0,Promise.all(i)}),(function(n){return t.localDataOnDisconnected.push(e),Promise.reject(n)}))})):Ie}},{key:"openFileByShareId",value:function(e){var t,n=this;return this.communicator.getSessionInfo(e).then((t=(0,_._)((function(e){var t,i,r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:if(!e)throw(t=new Error("Unexpected session info for opening file: "+JSON.stringify(e))).error=Je.collaborationSession,t;switch(n.sessionDefer.resolve(e),(i=e.openFileParams).type){case Sw.FROM_FILE:return[3,1];case Sw.FROM_URL:return[3,3]}return[3,4];case 1:return n.isOpenedFromOtherClient=!0,[4,i.file()];case 2:return r=a.sent(),[2,n.pdfViewer.openPDFByFile(r,i.options||{})];case 3:return n.isOpenedFromOtherClient=!0,[2,n.pdfViewer.openPDFByHttpRangeRequest({range:i.range,size:i.size},i.options)];case 4:throw(o=new Error("Unexpected session info for opening file:"+JSON.stringify(i))).error=Je.collaborationSession,o;case 5:return[2]}}))})),function(e){return t.apply(this,arguments)}))}},{key:"destroy",value:function(){(0,S._)((0,x._)(n.prototype),"destroy",this).call(this),this.communicator.destroy()}},{key:"reconnectIfNecessary",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=function(n){if(!e.continueToConnect(t,n))throw new Error("Failed to reconnect to the collaboration server");return e.reconnectIfNecessary(t+1)};return this.communicator.isConnected().then((function(t){return!!t||e.sessionDefer.promise.then((function(t){var i=t.shareId;return e.communicator.connect(i).then((function(){return e.communicator.isConnected()})).then((function(e){if(!e)return n(i)}),(function(e){return j.LoggerFactory.getLogger("COLLABORATION").error("An error occurred while connect to the collaboration server",e),n(i)}))}))}))}},{key:"sync",value:function(){var e=this;return this.sessionDefer.promise.then((function(t){var n=t.shareId;return e.communicator.getLostData(n,e.version)})).then((function(t){if(t&&0!==t.length)return e.version=t[t.length-1].version,function(e){if(e.length<1)return e;for(var t=[e[0]],n=1,i=e.length;n<i;n++){var r,o=t[t.length-1],a=e[n];bw(o)&&(bw(a)||ww(a))?((r=t).splice.apply(r,[t.length-1,1].concat((0,I._)(kw(o,a)))),0===t.length&&(n<i-1&&t.push(e[n+1]),n++)):t.push(a)}return t.forEach((function(e){e.action===yo.UPDATE_ANNOT&&(e.data.annots=e.data.annots.reduceRight((function(e,t){var n=e.findIndex((function(e){return e.name===t.name}));return-1===n&&e.push(t),e}),[]))})),t}(t).reduce((function(t,n){return e.findHandler(n).then((function(e){var i=(0,E._)(e,2),r=i[0],o=i[1];return r?t.finally((function(){return r.receive(n,o)})):(Fw.warn(new Cw(n)),t)}))}),Ie)}))}},{key:"findHandlerAsync",value:function(e,t,n){var i=function(e,t,r){return r>=e.length?Promise.resolve(void 0):e[r].accept(t).then((function(o){if(o&&n(e[r]))return;return i(e,t,r+1)}))};return i(e,t,0)}},{key:"findFirstHandlerAsync",value:function(e,t){var n=(0,j.createDeferred)();return this.findHandlerAsync(e,t,(function(e){return n.resolve(e),!0})),n.promise}},{key:"findAllMatchHandlersAsync",value:function(e,t){var n=[];return this.findHandlerAsync(e,t,(function(e){return n.push(e),!1})).then((function(){return n}))}},{key:"findHandler",value:function(e){var t=this;return this.findAllMatchHandlersAsync(this.userHandlerInstances,e).then((function(n){return t.findFirstHandlerAsync(t.builtInHandlerInstances,e).then((function(e){switch(n.length){case 0:return[e,e];case 1:return[n[0],e]}return[new Ew(n),e]}))}))}},{key:"handleServerMessage",value:function(e){var t=this,n=this.pdfViewer.getCurrentPDFDoc();if(!n)throw new Dw;var i=n.info.fileID,r=JSON.parse(e);if(!this.isSameFileID(r.fileId,i))throw new xw("File id not match! remote: ".concat(r.fileId,", local: ").concat(i));return this.findHandler(r).then((function(n){var i=(0,E._)(n,2),o=i[0],a=i[1];if(o)return r.version-t.version!=1?t.sync():(t.version=r.version,o.receive(r,a));throw new xw("No handler found for the collaboration data: "+e)}))}},{key:"isSameFileID",value:function(e,t){return e.length===t.length&&!e.some((function(e){return-1===t.indexOf(e)}))}}]),n}(j.Disposable),Lw=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"action",void 0),this.action=t}return(0,A._)(e,[{key:"accept",value:function(e){return Promise.resolve(e.action===this.action)}}]),e}(),Nw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.CREATE_ANNOT),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=this,i=this.pdfViewer.getCurrentPDFDoc();if(function(e){return e.format===vw.fdf}(e)){var r=Tw(e.data.fdf);return i.importAnnotsFromFDF(r).then((function(){e.data.annots.forEach((function(e){var t=e.page,i=e.id,r=n.pdfViewer.getAnnotRender(t,i);r&&r.redraw(!1,!0)}))}))}var o=e.data.annots.filter((function(e){return"link"!==e.type&&"screen"!==e.type}));return i.importAnnotsFromJSON(o)}}]),n}(Lw);var Vw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.REMOVE_ANNOT),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=this.pdfViewer.getCurrentPDFDoc();return Promise.all(e.data.map((function(e){return n.getPageByIndex(e.pageIndex).then((function(t){return"string"==typeof e.annotId?t.removeAnnotById(e.annotId):t.removeAnnotByObjectNumber(e.annotId)}))}))).then(qi)}}]),n}(Lw),Bw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.UPDATE_ANNOT),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=this,i=this.pdfViewer.getCurrentPDFDoc();if(function(e){return e.format===vw.fdf}(e)){var r=Tw(e.data.fdf);return i.importAnnotsFromFDF(r).then((function(){e.data.annots.forEach((function(e){var t=e.page,i=e.id,r=n.pdfViewer.getAnnotRender(t,i);if(r){r.redraw(!1,!0);var o=r.component;o&&o.isActive&&o.active()}}))}))}var o=e.data.annots.filter((function(e){return"link"!==e.type&&"screen"!==e.type}));return i.importAnnotsFromJSON(o).then((function(e){o.forEach((function(e){var t=n.pdfViewer.getAnnotRender(e.page,e.name);if(t){t.redraw(!1,!0);var i=t.component;i&&i.isActive&&i.active()}}))}))}}]),n}(Lw);var jw,Uw,Hw,Ww,Yw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.PPO_INSERT_PAGE),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=this.pdfViewer.getCurrentPDFDoc(),i=e.data,r=i.pageIndex,o=i.width,a=i.height;return n.insertPage(r,o,a)}}]),n}(Lw),qw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.PPO_REMOVE_PAGE),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){return this.pdfViewer.getCurrentPDFDoc().removePage(e.data.pageIndex)}}]),n}(Lw),Kw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.PPO_ROTATE_PAGE),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=this.pdfViewer.getCurrentPDFDoc(),i=Math.floor((e.data.angle%360+360)%360/90)%4;return n.getPageByIndex(e.data.pageIndex).then((function(e){return e.setRotation(i)}))}}]),n}(Lw),$w=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.PPO_MOVE_PAGE),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=this,i=this.pdfViewer.getCurrentPDFDoc(),r=e.data,o=r.sourceIndex,a=r.destIndex;return i.movePageTo(o,a).then((function(){n.pdfViewer.goToPage(a,0,0,!1)}))}}]),n}(Lw),zw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.ADD_REPLY),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=e.data,i=n.pageIndex,r=n.annotId,o=n.reply;return this.pdfViewer.getCurrentPDFDoc().getPageByIndex(i).then((function(e){return"string"==typeof r?e.getAnnotsByIdArray([r]):e.getAnnotsByObjectNumArray([r])})).then((function(e){var t=(0,E._)(e,1)[0];if(t)return t.addReply(o)}))}}]),n}(Lw),Gw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.REMOVE_REPLY),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=this.pdfViewer.getCurrentPDFDoc(),i=e.data,r=i.pageIndex,o=i.replyId;return n.getPageByIndex(r).then((function(e){return"string"==typeof o?e.removeAnnotById(o):e.removeAnnotByObjectNumber(o)}))}}]),n}(Lw),Jw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.ADD_REVIEW_STATE),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=e.data,i=n.pageIndex,r=n.annotId,o=n.stateAnnotJSON;return this.pdfViewer.getCurrentPDFDoc().getPageByIndex(i).then((function(e){return"string"==typeof r?e.getAnnotsByIdArray([r]):e.getAnnotsByObjectNumArray([r])})).then((function(e){var t=(0,E._)(e,1)[0];if(t)return t.addReviewState(o)}))}}]),n}(Lw),Xw=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.UPDATE_ANNOT_CONTENT),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=e.data,i=n.pageIndex,r=n.annotId,o=n.content;return this.pdfViewer.getCurrentPDFDoc().getPageByIndex(i).then((function(e){return"string"==typeof r?e.getAnnotsByIdArray([r]):e.getAnnotsByObjectNumArray([r])})).then((function(e){var t=(0,E._)(e,1)[0];if(t)return t.setContent(o)}))}}]),n}(Lw),Zw=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,P._)(this,e),(0,J._)(this,"permissions",void 0),(0,J._)(this,"noPermission",void 0),this.permissions=t,this.noPermission=n}return(0,A._)(e,[{key:"has",value:function(e){return!this.noPermission&&(0===this.permissions.length||(this.permissions.indexOf(ld.fully)>-1||this.permissions.indexOf(e)>-1))}},{key:"ignorable",value:function(){return!this.noPermission&&0===this.permissions.length}},{key:"isModifiable",value:function(){return this.has(ld.modifiable)}},{key:"isPlayable",value:function(){return this.has(ld.playable)}},{key:"isAdjustable",value:function(){return this.has(ld.adjustable)}},{key:"isEditable",value:function(){return this.has(ld.editable)}},{key:"isDeletable",value:function(){return this.has(ld.deletable)}},{key:"isAttachmentDownloadable",value:function(){return this.has(ld.attachmentDownloadable)}},{key:"isRedactionApplicable",value:function(){return!0}},{key:"isReplyable",value:function(){return this.has(ld.replyable)}},{key:"equalsTo",value:function(t){if(!t||!(0,D._)(t,e))return!1;var n=this.permissions,i=t.permissions;return n.length===i.length&&(this.noPermission===t.noPermission&&!n.some((function(e){return-1===i.indexOf(e)})))}}],[{key:"fully",value:function(){return jw||(jw=new e([ld.fully])),jw}},{key:"ignorable",value:function(){return Uw||(Uw=new e([])),Uw}},{key:"none",value:function(){return Hw||(Hw=new e([],!0)),Hw}},{key:"union",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(n.every((function(e){return e.ignorable()})))return e.ignorable();if(n.some((function(e){return e.noPermission})))return e.none();var r=Array.from(new Set(n.map((function(e){return e.permissions})).flat())).filter((function(e){return n.every((function(t){return t.has(e)}))}));return new e(r)}}]),e}(),Qw=j.LoggerFactory.getLogger("AnnotationAuthorityManager"),e_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i){var r;(0,P._)(this,n),r=t.call(this),(0,J._)((0,w._)(r),"pdfViewer",void 0),(0,J._)((0,w._)(r),"getAnnotPermissionCallback",void 0),(0,J._)((0,w._)(r),"store",void 0),(0,J._)((0,w._)(r),"cachedAnnots",void 0),(0,J._)((0,w._)(r),"isUpdateAllAfterImport",void 0),r.pdfViewer=e,r.getAnnotPermissionCallback=i,r.store=new j.Store,r.cachedAnnots={},r.isUpdateAllAfterImport=!1;var o=function(e){Array.isArray(e)&&e.length>0&&e.forEach((function(e){var t=r.generateKey(e);delete r.cachedAnnots[t]}))},a=function(e){e.forEach((function(e){return r.update(e)}))},s=function(e){r.update(e)},u=function(e,t){r.isUpdateAllAfterImport?r.updateAll():t.forEach((function(e){e.newAnnots.forEach((function(e){return r.update(e)}))}))},c=function(e,t,n){t.forEach((function(e){r.update(e)}))},l=function(e){e.forEach((function(e){r.update(e)}))};return e.eventEmitter.on(de.annotationRemoved,o),e.eventEmitter.on(de.annotationAdd,a),e.eventEmitter.on(de.annotationImported,u),e.eventEmitter.on(de.annotationLoaded,c),e.eventEmitter.on(de.annotationReplyAdd,s),e.eventEmitter.on(de.annotationUpdated,l),r.addDestroyHook((function(){e.eventEmitter.off(de.annotationRemoved,o),e.eventEmitter.off(de.annotationAdd,a),e.eventEmitter.off(de.annotationImported,u),e.eventEmitter.off(de.annotationLoaded,c),e.eventEmitter.off(de.annotationReplyAdd,s),e.eventEmitter.on(de.annotationUpdated,l),r.clear(),r.store.destroy()})),r}return(0,A._)(n,[{key:"getPermission",value:function(e){if(!e.page||e.isDestroyed)return Promise.resolve(Zw.none());var t=this.generateKey(e);return this.store.has(t)||this.update(e),this.store.takeWhile(t)}},{key:"update",value:function(e){var t=this;if(!e||e.isDestroyed)return Promise.resolve(Zw.none());var n=this.generateKey(e);if(e.isDeleted()){var i=Promise.resolve(Zw.ignorable());return this.store.dispatch(n,i),delete this.cachedAnnots[n],i}var r=this.store.getCurrentValue(n)||Ie,o=(this.getAnnotPermissionCallback(e)||Ie).then((function(n){var i;return i=n?0===n.length?Zw.none():new Zw(n):Zw.ignorable(),r.then((function(n){if(!i.equalsTo(n))try{t.pdfViewer.eventEmitter.emit(de.annotationPermissionChanged,e,i,n)}catch(e){Qw.error("An error occurred inside the listener of ViewerEvents.annotationPermissionChanged",e)}})),i}));return this.store.dispatch(n,o),this.cachedAnnots[n]=e,o}},{key:"setAnnotPermissionCallback",value:function(e){this.getAnnotPermissionCallback=e}},{key:"subscribe",value:function(e,t){var n=this.generateKey(e);return this.store.subscribe(n,(function(n){n.then((function(n){t(n,e)}))}))}},{key:"updateAll",value:function(){var e=this;return Promise.all(Object.keys(this.cachedAnnots).filter((function(t){var n=e.cachedAnnots[t].isDeleted();return n&&delete e.cachedAnnots[t],!n})).map((function(t){return e.update(e.cachedAnnots[t])})))}},{key:"generateKey",value:function(e){return"".concat(e.page.getId(),"/").concat(e.getId())}},{key:"clear",value:function(){this.store.clear(),this.cachedAnnots={}}},{key:"setUpdateAllAfterImported",value:function(e){this.isUpdateAllAfterImport=e}}]),n}(j.Disposable),t_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.MOVE_ANNOTS_BETWEEN_PAGES),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=this.pdfViewer.getCurrentPDFDoc();return Promise.all([n.getPageByIndex(e.data.fromPageIndex),n.getPageByIndex(e.data.toPageIndex)]).then((function(t){var i=(0,E._)(t,2),r=i[0],o=i[1],a=e.data.annots,s=Object.keys(a);return r.getAnnotsByIdArray(s).then((function(e){var t=e.reduce((function(e,t){return e[t.getObjectNumber()]=a[t.getUniqueID()],e}),{});return n.moveAnnotsToPage(r,o,t)}))}))}}]),n}(Lw),n_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.ADD_MARKED_STATE),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){var n=e.data,i=n.pageIndex,r=n.annotId,o=n.stateAnnotJSON;return this.pdfViewer.getCurrentPDFDoc().getPageByIndex(i).then((function(e){return e.getAnnotsByObjectNumArray([r])})).then((function(e){var t=(0,E._)(e,1)[0];if(t)return t.addMarkedState(o)}))}}]),n}(Lw),i_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.IMPORT_ANNOTATIONS_FILE),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){for(var n=e.data.file,i=atob(n),r=new Uint8Array(new ArrayBuffer(i.length)),o=0;o<i.length;o++)r[o]=i.charCodeAt(o);return this.pdfViewer.getCurrentPDFDoc().importAnnotsFromFDF(r)}}]),n}(Lw),r_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"set",value:function(e){(0,S._)((0,x._)(n.prototype),"dispatch",this).call(this,"change",e)}},{key:"get",value:function(){return(0,S._)((0,x._)(n.prototype),"getCurrentValue",this).call(this,"change")}},{key:"onchange",value:function(e){return(0,S._)((0,x._)(n.prototype),"subscribe",this).call(this,"change",(function(t){e(t)}))}}]),n}(j.Store);!function(e){e.playing="playing",e.paused="paused",e.stopped="stopped"}(Ww||(Ww={}));var o_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),e=t.call(this),(0,J._)((0,w._)(e),"status",Ww.stopped),(0,J._)((0,w._)(e),"currentPlayingOptions",void 0),(0,J._)((0,w._)(e),"statusStore",new r_),e}return(0,A._)(n,[{key:"pause",value:function(){this.status===Ww.playing&&(this.status=Ww.paused,this.statusStore.set(this.status),this.doPause())}},{key:"resume",value:function(){this.status===Ww.paused&&(this.status=Ww.playing,this.statusStore.set(this.status),this.doResume())}},{key:"stop",value:function(){this.status!==Ww.stopped&&(this.status=Ww.stopped,this.statusStore.set(this.status),this.currentPlayingOptions=void 0,this.doStop())}},{key:"play",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{rate:1,pitch:1,volume:1};this.currentPlayingOptions=n,this.status=Ww.playing,this.statusStore.set(this.status);var i,r,o=[],a=new j.QueuedAsyncTaskExecutor,s=new j.QueuedAsyncTaskExecutor,u=!1,c=!1,l=this.statusStore.onchange((function(e){(c=e===Ww.stopped)&&(clearTimeout(r),a.cancel(),s.cancel(),l&&l())})),d=!0,h=!1,f=void 0;try{for(var g,v=function(){var e=g.value;a.exec((function(){if(!c)return e.then((function(e){var t;if(!c){var n=e.text.split(" ");if(0===n.length){if(!i)return;n[0]=i,i=void 0}else i&&("-"===i[i.length-1]?n[0]=i.substr(0,i.length-1)+n[0]:n.unshift(i),i=void 0);i=n[n.length-1],n.splice(-1,1),(t=o).push.apply(t,(0,I._)(n))}}))}))},p=e[Symbol.iterator]();!(d=(g=p.next()).done);d=!0)v()}catch(e){h=!0,f=e}finally{try{d||null==p.return||p.return()}finally{if(h)throw f}}return a.waitForCurrentRunningTasks().then((function(){u=!0,i&&(o.push(i),i=void 0)})),new Promise((function(e,n){var i=function(){if(c)s.waitForCurrentRunningTasks().then(e,n);else{if(o.length>0){var a=function(e){var t=[];return e.split(/[\n\t\.。;，]+|\s{2}/).forEach((function(e){var n;-1===e.indexOf(",")?t.push(e):(n=t).push.apply(n,(0,I._)(e.replace(/\d+(,\d{3})+|,/g,(function(e){return","===e?",,":e})).split(",,")))})),t}(o.join(" "));a.forEach((function(n){n&&s.exec((function(){return t.speakText(n,t.currentPlayingOptions)})).finally((function(){c&&e()}))}))}o.length=0,u?s.waitForCurrentRunningTasks().then(e,n):r=setTimeout(i)}};r=setTimeout(i)}))}},{key:"updateOptions",value:function(e){this.currentPlayingOptions&&(Object.assign(this.currentPlayingOptions,e),this.onCurrentPlayingOptionsUpdated())}}],[{key:"extend",value:function(e){var t=function(t){(0,C._)(i,t);var n=(0,T._)(i);function i(){return(0,P._)(this,i),n.apply(this,arguments)}return(0,A._)(i,[{key:"init",value:function(){return this.safeCall("init")}},{key:"supported",value:function(){var t=e.supported;if("function"==typeof t)return t.apply(this);throw new Error("Method not implementated: supported")}},{key:"beforePlay",value:function(){this.safeCall("beforePlay")}},{key:"getVoices",value:function(){return this.safeCall("getVoices")}},{key:"doPause",value:function(){return this.safeCall("doPause")}},{key:"doResume",value:function(){return this.safeCall("doResume")}},{key:"doStop",value:function(){return this.safeCall("doStop")}},{key:"speakText",value:function(e,t){return this.safeCall("speakText",e,t)}},{key:"onCurrentPlayingOptionsUpdated",value:function(){return this.safeCall("onCurrentPlayingOptionsUpdated")}},{key:"safeCall",value:function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];var o=e[t];if("function"==typeof o)return o.apply(this,i)}}]),i}(n);for(var i in e)i in t.prototype||(t.prototype[i]=e[i]);return t}}]),n}(function(){function e(){(0,P._)(this,e),this.init()}return(0,A._)(e,[{key:"init",value:function(){}}]),e}());var a_=window.speechSynthesis,s_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,J._)((0,w._)(e),"prepared",!1),(0,J._)((0,w._)(e),"loadedVoicesPromise",void 0),e}return(0,A._)(n,[{key:"prepare",value:function(){return this.prepared?Promise.resolve():(this.prepared=!0,this.supported()?this.loadVoices().then((function(){var e=new SpeechSynthesisUtterance(" ");a_.speak(e),a_.cancel()})):Promise.resolve())}},{key:"getVoices",value:function(){return this.loadVoices().then((function(e){return e.map((function(e){return{name:e.name,lang:e.lang}}))}))}},{key:"beforePlay",value:function(){var e=new SpeechSynthesisUtterance(" ");a_.speak(e)}},{key:"play",value:function(e,t){var i=this;return this.prepare().finally((function(){return(0,S._)((0,x._)(n.prototype),"play",i).call(i,e,t)}))}},{key:"supported",value:function(){return"object"==typeof window.speechSynthesis&&"function"==typeof window.SpeechSynthesisUtterance}},{key:"doPause",value:function(){a_.pause()}},{key:"doResume",value:function(){a_.resume()}},{key:"doStop",value:function(){a_.cancel()}},{key:"speakText",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentPlayingOptions,i=new SpeechSynthesisUtterance(e);return new Promise((function(e,r){var o=function(){i.removeEventListener("end",a),i.removeEventListener("error",r)},a=function(){e(),o()};i.addEventListener("end",a),i.addEventListener("error",(function(e){r(e),o()}));var s=Promise.resolve();if(n){i.rate=n.rate,i.pitch=n.pitch,i.lang=n.lang||i.lang;var u=n.voice;switch(void 0===u?"undefined":(0,R._)(u)){case"string":s=s.then((function(){return t.getVoiceByName(u)})).then((function(e){e&&(i.voice=e)}));break;case"object":i.voice=u}i.volume=n.volume}s.then((function(){switch(a_.speak(i),t.status){case Ww.stopped:e(),a_.cancel();break;case Ww.paused:a_.pause()}}))}))}},{key:"onCurrentPlayingOptionsUpdated",value:function(){}},{key:"getVoiceByName",value:function(e){return this.loadVoices().then((function(t){return t.find((function(t){return t.name===e||t.voiceURI===e}))}))}},{key:"loadVoices",value:function(){var e=this;return(0,_._)((function(){var t;return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return e.loadedVoicesPromise?[4,e.loadedVoicesPromise]:[3,2];case 1:if((t=n.sent()).length>0)return[2,t];n.label=2;case 2:return[2,e.loadedVoicesPromise=new Promise((function(e){var t=0;!function n(){if(!a_)return e([]);var i=a_.getVoices();i&&i.length>0?e(i):t<20?(t++,setTimeout(n,100)):e([])}()}))]}}))}))()}}]),n}(o_),u_=function(){},c_="viewer--read-page-start",l_="viewer--read-page-end",d_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,J._)((0,w._)(i),"pdfViewer",void 0),(0,J._)((0,w._)(i),"speechSynthesis",void 0),(0,J._)((0,w._)(i),"defaultOptions",void 0),(0,J._)((0,w._)(i),"stopHook",void 0),(0,J._)((0,w._)(i),"statusStore",void 0),(0,J._)((0,w._)(i),"eventEmitter",void 0),i.pdfViewer=e,i.speechSynthesis=new s_,i.defaultOptions={rate:1,pitch:1,volume:1,external:{}},i.stopHook=u_,i.statusStore=new r_,i.eventEmitter=new Bs,i}return(0,A._)(n,[{key:"setSpeechSynthesis",value:function(e){this.speechSynthesis.stop(),this.speechSynthesis=e,this.statusStore.set(Ww.stopped)}},{key:"supported",value:function(){return this.speechSynthesis.supported()}},{key:"getVoices",value:function(){return this.speechSynthesis.getVoices?this.speechSynthesis.getVoices():Promise.resolve([])}},{key:"beforeRead",value:function(){if(this.speechSynthesis.beforePlay)return this.speechSynthesis.beforePlay()}},{key:"afterRead",value:function(){}},{key:"readPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.readPages([e],t)}},{key:"readPages",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.pdfViewer.getCurrentPDFDoc().getPageCount()-1;e.forEach((function(e){if(e<0||e>i)throw new Error("Invalid page index: ".concat(e,",page index should range between 0 and ").concat(i))}));var r=new j.QueuedAsyncTaskExecutor;return this.stopHook=function(){t.stopHook=u_,r.cancel()},this.speechSynthesis.status=Ww.playing,this.statusStore.set(this.status),e.forEach((function(e){r.exec((function(){return t.eventEmitter.emit(c_,e),t.doReadPage(e,n).finally((function(){t.eventEmitter.emit(l_,e)}))}))})),r.waitForCurrentRunningTasks().finally((function(){t.isStopped()||t.stop()}))}},{key:"readText",value:function(e,t){var n=this,i=Object.assign({},this.defaultOptions,t,{external:Object.assign({},this.defaultOptions.external,(null==t?void 0:t.external)||{})}),r=function(){return n.isStopped()};return this.speechSynthesis.status=Ww.playing,this.statusStore.set(this.status),this.speechSynthesis.play(function(){return(0,F.Jh)(this,(function(t){switch(t.label){case 0:return r()?[2]:[4,Promise.resolve({text:e.text,pageIndex:e.pageIndex,rect:e.rect})];case 1:return t.sent(),[2]}}))}(),i).finally((function(){if(!r())return n.stop()}))}},{key:"pause",value:function(){this.speechSynthesis.pause(),this.statusStore.set(this.status)}},{key:"resume",value:function(){this.speechSynthesis.resume(),this.statusStore.set(this.status)}},{key:"stop",value:function(){this.speechSynthesis.stop(),this.statusStore.set(this.status),this.stopHook()}},{key:"status",get:function(){return this.speechSynthesis.status}},{key:"setDefaultOptions",value:function(e){Object.assign(this.defaultOptions,e)}},{key:"setVolume",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultOptions.volume;this.defaultOptions.volume=e,this.isStopped()||this.speechSynthesis.updateOptions({volume:e})}},{key:"setRate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultOptions.rate;this.defaultOptions.rate=e,this.isStopped()||this.speechSynthesis.updateOptions({rate:e})}},{key:"setVoice",value:function(e){this.defaultOptions.voice=e,this.isStopped()||this.speechSynthesis.updateOptions({voice:e})}},{key:"updatePlayingOptions",value:function(e){return!this.isStopped()&&(this.speechSynthesis.updateOptions(e),!0)}},{key:"isStopped",value:function(){return this.status===Ww.stopped}},{key:"isPlaying",value:function(){return this.status===Ww.playing}},{key:"onStatusChange",value:function(e){return this.statusStore.onchange(e.bind(this))}},{key:"onReadPageStart",value:function(e){var t=this;return this.eventEmitter.addListener(c_,e),function(){t.eventEmitter.removeListener(c_,e)}}},{key:"onReadPageEnd",value:function(e){var t=this;return this.eventEmitter.on(l_,e),function(){t.eventEmitter.removeListener(l_,e)}}},{key:"doReadPage",value:function(e,t){var n=this,i=function(){return n.isStopped()};if(i())return Ie;var r=this.pdfViewer.getCurrentPDFDoc(),o=r.getPageCount();return e>=o?Ie:r.getPageByIndex(e).then((function(r){if(r&&!i())return r.getTextRectCount().then((function(o){var a=Object.assign({},n.defaultOptions,t,{external:Object.assign({},n.defaultOptions.external,t.external||{})});try{return n.speechSynthesis.play(function(){var t;return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return o<=0?[4,Promise.resolve().then((function(){return{text:"blank",pageIndex:e,rect:{}}}))]:[3,2];case 1:return n.sent(),[3,6];case 2:t=0,n.label=3;case 3:return t<o?i()?[2]:[4,r.getTextByRectIndex(t).then((function(t){return{text:t.text,pageIndex:e,rect:t.rect}}))]:[3,6];case 4:n.sent(),n.label=5;case 5:return t++,[3,3];case 6:return[2]}}))}(),a)}finally{n.statusStore.set(n.status)}}))}))}}]),n}(j.Disposable),h_=function(){function e(){(0,P._)(this,e),(0,J._)(this,"service",void 0),(0,J._)(this,"executor",new j.QueuedAsyncTaskExecutor),(0,J._)(this,"viewer",void 0)}return(0,A._)(e,[{key:"allInjected",value:function(){this.service=new d_(this.viewer)}},{key:"supported",value:function(){return this.service.supported()}},{key:"setSpeechSynthesis",value:function(e){this.service.setSpeechSynthesis(e)}},{key:"readPages",value:function(e,t){var n=this;return this.stop(),this.executor.exec((function(){return n.service.readPages(e,t)}))}},{key:"readText",value:function(e,t){var n=this;return this.stop(),this.executor.exec((function(){return n.service.readText(e,t)}))}},{key:"stop",value:function(){this.executor.cancel(),this.service.stop()}},{key:"pause",value:function(){this.service.pause()}},{key:"resume",value:function(){this.service.resume()}},{key:"setVolume",value:function(e){this.service.setVolume(e)}},{key:"setRate",value:function(e){this.service.setRate(e)}},{key:"setVoice",value:function(e){this.service.setVoice(e)}},{key:"getVoices",value:function(){return this.service.getVoices()}},{key:"beforeRead",value:function(){return this.service.beforeRead()}},{key:"afterRead",value:function(){return this.service.afterRead()}},{key:"status",get:function(){return this.service.status}},{key:"onStatusChange",value:function(e){return this.service.onStatusChange(e)}},{key:"updatePlayingOptions",value:function(e){return this.service.updatePlayingOptions(e)}},{key:"onReadPageStart",value:function(e){return this.service.onReadPageStart(e)}},{key:"onReadPageEnd",value:function(e){return this.service.onReadPageEnd(e)}}],[{key:"inject",value:function(){return{viewer:RP}}}]),e}(),f_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"execute",value:function(e){var t=e.keyboard;t.setup(So);var n=function(){},i=function(e){n(),n=t.activeContext(e.getStateName())};e.eventEmitter.on(de.switchStateHandler,i),this.addDestroyHook((function(){e.eventEmitter.off(de.switchStateHandler,i)})),t.activeContext(mn)}}]),n}(j.Disposable),g_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,J._)((0,w._)(e),"undoActivation",(function(){})),e}return(0,A._)(n,[{key:"execute",value:function(e){var t=this,n=e.getKeyboard();n.withContext(bo.SELECTION,(function(n){t.addDestroyHook(n.keyup(ko.SELECT_ALL,(function(){t.selectAllAnnotOrWidget(e)}),{interceptors:[(0,j.excludeEditableElementInterceptor)(),(0,j.preventDefaultInterceptor)()]}))})),n.withContext(Zn,(function(n){t.isDestroyed||t.addDestroyHook(n.keyup(ko.SELECT_ALL,(function(n){t.selectAllAnnotOrWidget_selection_state_handler(e)}),{interceptors:[(0,j.excludeEditableElementInterceptor)(),(0,j.preventDefaultInterceptor)()]}))})),n.withContext(bo.ACTIVATION_ANY,(function(n){t.addDestroyHook(n.keyup(ko.UNSELECT_OBJECT,(function(){e.activateElement(),t.undoActivation()})),n.keyup(ko.SELECT_ALL,(function(){e.getStateHandlerManager().getCurrentStates().getStateName()===Zn?t.selectAllAnnotOrWidget_selection_state_handler(e):t.selectAllAnnotOrWidget(e)}),{interceptors:[(0,j.excludeEditableElementInterceptor)(),(0,j.preventDefaultInterceptor)()]}),n.keydown(ko.COPY_ACTIVATE_ELEMENT,(function(t){e.isShortcutKeyEnabled()&&(e.currentPDFDoc.checkPermission(Qt.extract)&&e.copy());t.preventDefault()}),{interceptors:[(0,j.excludeEditableElementInterceptor)()]}),n.keydown(ko.CUT_ACTIVATE_ELEMENT,(function(t){e.isShortcutKeyEnabled()&&e.cut(),t.preventDefault()}),{interceptors:[(0,j.excludeEditableElementInterceptor)()]}))}));var i=function(){t.handleOnActivationChanged(e,n)},r=e.eventEmitter;r.on(de.activeElementChanged,i),this.addDestroyHook((function(){r.off(de.activeElementChanged,i)}))}},{key:"selectAllAnnotOrWidget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=new Z;if(t.length){var i=[];return t.forEach((function(t){if(!t.isGrouped||!t.isGrouped()){var r=e.getAnnotRender(t.getPDFPage().getIndex(),t.getId()).component;r&&n.add(r)}"widget"===t.getType()&&i.push(t)})),void e.eventEmitter.emit("active-widgets-for-multi-select",{widgets:i,activationGroup:n})}this.getAnnotsOfCurrentPage(e).then((function(t){if(t&&!(t.length<1)){var i=e.getStateHandlerManager().getCurrentStates().getStateName();if(Object.keys(li).indexOf(i)>=0){t.forEach((function(t){if(!(t.getType()!==li[i]||t.isGrouped&&t.isGrouped())){var r=e.getAnnotRender(t.getPDFPage().getIndex(),t.getId()).component;r&&n.add(r)}})),e.bindMultiSelectActiveEvents(n),e.activationManager.active(n),e.getPDFDocRender().setCurrentAnnotHandler();var r=e.getAllActivatedElements().map((function(e){return e.annotsRender.getAnnotRender(e.getId())}));if(r.length){if(1===r.length)return e.eventEmitter.emit(de.activeAnnotation,r[0]);e.eventEmitter.emit(de.activeMultipleAnnotations,r)}}else if(Object.keys(di).indexOf(i)>=0){var o=[];t.forEach((function(e){"widget"===e.getType()&&e.info.fieldType===di[i]&&o.push(e)})),o.length&&e.eventEmitter.emit("active-widgets-for-multi-select",{widgets:o,activationGroup:n})}e.eventEmitter.emit(de.activeElementChanged)}}))}},{key:"selectAllAnnotOrWidget_selection_state_handler",value:function(e){this.getAnnotsOfCurrentPage(e).then((function(t){if(t&&!(t.length<1)){var n=new Z,i=[],r=[];if(t.forEach((function(t){if(!i.find((function(e){return e===t})))if(t.isGrouped&&t.isGrouped()){var o=t.getGroupElements()||[];if(o.length){var a=new Z;o.forEach((function(t){var n=e.getAnnotRender(t.getPDFPage().getIndex(),t.getId()).component;n&&a.add(n)})),n.add(a),i=(0,I._)(i).concat((0,I._)(o))}}else if("widget"===t.getType())r.push(t);else{var s=e.getAnnotRender(t.getPDFPage().getIndex(),t.getId()).component;s&&n.add(s)}})),r.length)e.eventEmitter.emit("active-widgets-for-multi-select",{widgets:r,activationGroup:n});else{e.bindMultiSelectActiveEvents(n),e.activationManager.active(n),e.getPDFDocRender().setCurrentAnnotHandler();var o=e.getAllActivatedElements().map((function(e){return e.annotsRender.getAnnotRender(e.getId())}));if(o.length){if(1===o.length)return e.eventEmitter.emit(de.activeAnnotation,o[0]);e.eventEmitter.emit(de.activeMultipleAnnotations,o)}}}}))}},{key:"handleOnActivationChanged",value:function(e,t){var n=e.getAllActivatedElements();if(0===n.length)this.undoActivation();else{var i=0,r=0,o=0;n.forEach((function(e){e.editingMgr?i++:e.annot?r++:e.graphicsObject&&o++}));var a,s=[i,r,o].filter((function(e){return 0!==e})).length;1===s?i>0?a=bo.ACTIVATION_WIDGET:r>0?a=bo.ACTIVATION_ANNOTATION:o>0&&(a=bo.ACTIVATION_GRAPH_OBJ):s>1&&(a=bo.ACTIVATION_ANY),a&&(this.undoActivation(),this.undoActivation=t.activeContext(a))}}},{key:"getAnnotsOfCurrentPage",value:function(e){var t,n=e.currentPDFDoc;if(!n)return Promise.resolve([]);var i=e.getPDFDocRender().getCurrentPageIndex(),r=null===(t=e.getPDFPageRender(i))||void 0===t?void 0:t.annotsRender;return n.getPageByIndex(i).then((function(e){return e.getAnnots().then((function(e){return e.filter((function(e){return"popup"!==e.getType()&&"watermark"!==e.getType()&&"R"!==e.info.RT&&!e.info.IRT&&(!r.annotFiltered||r.showAnnots.has(e.id))}))}))}))}}]),n}(j.Disposable),v_="font-map-list",p_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"execute",value:function(e){e.getKeyboard().withContext(bo.BASIC_STATE_HANDLER,(function(t){t.keydown(ko.SWITCH_TO_HAND_STATE,(function(){e.getStateHandlerManager().switchTo(mn)}))}))}}]),n}(j.Disposable);new Date;var m_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;(0,P._)(this,n),i=t.call(this),(0,J._)((0,w._)(i),"level",-1),(0,J._)((0,w._)(i),"componentClasses",[]);return e.eventEmitter.on(de.openFileSuccess,(function(e){i.componentClasses.forEach((function(t){i.getComponentInstance(t,e)}))})),e.eventEmitter.on(de.willCloseDocument,(function(){i.destroyComponents()})),i}return(0,A._)(n,[{key:"onInject",value:function(e){}},{key:"generateInstanceName",value:function(){return(0,j.getUniqueId)("pdf-doc-lifecycle")}},{key:"define",value:function(e){this.componentClasses.indexOf(e)>-1||this.componentClasses.push(e)}}]),n}(j.BasicIoCStrategy),y_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"execute",value:function(e){var t=e.getIoC(),n=t.getStrategy(j.IoCScope.SINGLETON),i={PDFViewer:e,Keyboard:e.keyboard,EventEmitter:e.eventEmitter,Store:e.store,AnnotManager:e.annotManager,StateHandlerManager:e.stateHandlerManager,ViewerUI:e.viewerUI,LifeCycleManager:e.lifeCycleManager,ActivationManager:e.activationManager};for(var r in i)n.registerComponentInstance(i[r]),n.registerComponentInstanceByName(i[r],r);t.setStrategy("PDF_DOC_LIFE_CYCLE_SCOPE_STRATEGY",new m_(e))}}]),n}(j.Disposable);var k_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:localStorage;(0,P._)(this,e),(0,J._)(this,"prefix",void 0),(0,J._)(this,"storage",void 0),this.prefix=t,this.storage=n}return(0,A._)(e,[{key:"setItem",value:function(e,t){this.storage.setItem(this.getKey(e),JSON.stringify(t))}},{key:"getItem",value:function(e){var t=this.storage.getItem(this.getKey(e));return t&&JSON.parse(t)}},{key:"getKey",value:function(e){return this.prefix+e}}]),e}(),b_=function(){function e(){(0,P._)(this,e),(0,J._)(this,"viewer",void 0)}return(0,A._)(e,[{key:"loadPDFDocByHttpRangeRequest",value:function(e,t){var n=this,i=e.range.url;if(!t.fileName&&i.endsWith(".pdf")){var r=i.lastIndexOf("/"),o=i.substring(r+1);o=decodeURIComponent(o),t.fileName=o}if(!zs(i)){var a=Us();e.range.url=Ws(a).join(i).absolute()}return this.viewer.getWebPDFJR().then((function(i){return i.getPDFDocByHttpRangeRequest(e,t).then((function(e){return n._parseDoc(e,t)}))}))}},{key:"loadPDFDocByFile",value:function(e,t){var n=this;return this.viewer.getWebPDFJR().then((function(i){return i.getPDFDocByFile(e,t).then((function(e){return n._parseDoc(e,t)}))}))}},{key:"_parseDoc",value:function(e,t){return Promise.resolve(function(e,t){if(e&&"function"==typeof e.getJWT)return e.getJWT(t)}(t)).then((function(n){t.idJWT=n||t.jwt;var i=t.errorHandler||function(e,t,n){throw n},r=function(t){return e.parse(t).catch((function(n){return i(e,t,n,r)}))};return r(t)}))}}],[{key:"inject",value:function(){return{viewer:RP}}}]),e}();var w_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this,yo.PPO_REMOVE_PAGES),(0,J._)((0,w._)(i),"pdfViewer",void 0),i.pdfViewer=e,i}return(0,A._)(n,[{key:"receive",value:function(e,t){return this.pdfViewer.getCurrentPDFDoc().removePages(e.data.pageRange)}}]),n}(Lw),__=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).cursorStyle="fv__cursor-crosshair",i}return(0,A._)(n,[{key:"pageHandler",value:function(e){var t=this;if(this.pageRender=e,j.isIOS)0===e.index&&(setTimeout((function(){t.pdfViewer.getStateHandlerManager().switchTo("hand")}),100),this.pdfViewer.viewerUI.alert("Unsupported now. Comming soon."));else{var n=e.$handler;n.addClass(this.cursorStyle);var i=this.$imageInput=O()('<input id="imageInput" type="file" style="visibility: hidden;" accept=".gif,.jpeg,.jpg,.png,.svg"/>');n.append(i);var r,o=n[0],a=this.hammer=new(vr().Manager)(o,{recognizers:[[vr().Pan,{direction:vr().DIRECTION_ALL}]]});a.on("panstart",(function(e){var t=Qa(o,e);r=[t.x,t.y]})),a.on("panmove",(function(e){var t=o.getBoundingClientRect(),i=e.srcEvent,a=P_(r,t,i),s=["top:"+a.top+"px","left:"+a.left+"px","height:"+(a.bottom-a.top)+"px","width:"+(a.right-a.left)+"px"].join(";"),u=n.find(".fv__mark-image-blank");if(0===u.length){var c=O()(document.createDocumentFragment());c.append('<div class="fv__mark-image-blank" style="'+s+'"></div>'),n.append(c)}else u.css({top:a.top,left:a.left,width:a.right-a.left,height:a.bottom-a.top})})),a.on("panend",(function(t){var i=o.getBoundingClientRect(),a=t.srcEvent,s=P_(r,i,a);n.find(".fv__mark-image-blank").remove(),n.find("#imageInput").off("click"),n.find("#imageInput").off("change").on("change",(function(t){var n=t.target.files[0];return e.getPDFPage().then((function(i){var r=e.getRotation(),o=new FileReader,a=i.reverseDeviceRect(s,e.getScale(),r);o.readAsArrayBuffer(n),o.onload=function(){var n=new Uint8Array(o.result),s=((i.getRotationAngle()+r)%360+360)%360;0!=s&&(s=(360-s)%360),i.addAnnot({flags:4,type:"screen",rect:a,rotation:s,buffer:n}).then((function(n){t.target.value="";var i=n[0];n[0].info.annotScreenDetailType="screen_img";var r=e.annotsRender.getAnnotRender(i.getId()).component;e.pdfViewer.eventEmitter.emit(de.addAnnotSuccess,r.annot),e.annotsRender.activeAnnot(i.getId())})).catch((function(e){}))}})).catch((function(e){}))})).click()}))}}},{key:"destroyPageHandler",value:function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.$imageInput&&this.$imageInput.remove()}},{key:"out",value:function(){this.destroyPageHandler()}}],[{key:"getStateName",value:function(){return xn}}]),n}(Ha);function P_(e,t,n){var i,r=Xa(n),o=Za(n),a=[r-t.left,o-t.top],s=e[0],u=e[1],c=a[0],l=a[1];return c<s&&(i=s,s=c,c=i),l<u&&(i=u,u=l,l=i),{left:s,top:u,right:c,bottom:l}}var A_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).file=null,i}return(0,A._)(n,[{key:"pageHandler",value:function(e){var t=this,n=this;this.pageRender=e;var i=this.$handler=e.$handler,r=i[0],o=this.hammer=new(vr().Manager)(r,{recognizers:[[vr().Tap],[vr().Pan,{direction:vr().DIRECTION_ALL}]]}),a=O()('<img style="position: absolute;top:-'+i.height()+"px;left:-"+i.width()+'px;border:2px solid transparent"></img>');i.append(a);var s=0,u=0;this.pdfViewer.eventEmitter.on(de.addEditImage,this.loadFile=function(e){var n=new FileReader;t.file=e,n.readAsDataURL(e),n.onload=function(e){a.prop({src:e.target.result});var t=new Image;t.onload=function(){a.css({top:-t.height,left:-t.width}),s=t.width,u=t.height},t.src=e.target.result}}),i.on("mousemove mousewheel",(function(e){var t=r.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top;a.css({top:i,left:n})})),i.on("mouseleave",(function(e){a.css({top:-u,left:-s})})),e.getPDFPage().then((function(t){e.getScale();var i=e.getRotation();o.on("tap",(function(r){var o={},s=a.width(),u=a.height();o.top=parseFloat(a.css("top")),o.left=parseFloat(a.css("left")),o.right=o.left+s*e.getScale(),o.bottom=o.top+u*e.getScale(),a.remove();var c=new FileReader;c.readAsArrayBuffer(n.file),c.onload=function(r){var a=new Uint8Array(r.target.result),s=t.reverseDeviceRect(o,e.getScale(),e.getRotation());t.addImage(a,s,i).then((function(){n.pdfViewer.getStateHandlerManager().switchTo(ys.getStateName())}))}}))}))}},{key:"destroyPageHandler",value:function(){this.$handler.off("mousemove mousewheel mouseleave"),this.$handler.empty(),this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.pdfViewer.eventEmitter.off(de.addEditImage,this.loadFile)}},{key:"out",value:function(){this.destroyPageHandler()}}],[{key:"getStateName",value:function(){return Cn}}]),n}(Ha);var S_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).cursorStyle="fv__cursor-crosshair",i}return(0,A._)(n,[{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e.$handler;n.addClass(this.cursorStyle);var i,r=n[0],o=this.hammer=new(vr().Manager)(r,{recognizers:[[vr().Pan,{direction:vr().DIRECTION_ALL}]]});o.on("panstart",(function(e){var t=Qa(r,e);i=[t.x,t.y]})),o.on("panmove",(function(e){var t=r.getBoundingClientRect(),o=e.srcEvent,a=x_(i,t,o),s=["top:"+a.top+"px","left:"+a.left+"px","width:"+(a.bottom-a.top)+"px","height:"+(a.right-a.left)+"px"].join(";"),u=n.find(".fv__mark-link-blank");if(0===u.length){var c=O()(document.createDocumentFragment());c.append('<div class="fv__mark-link-blank" style="'+s+'"></div>'),n.append(c)}else u.css({top:a.top,left:a.left,width:a.right-a.left,height:a.bottom-a.top})})),o.on("panend",(function(o){var a=r.getBoundingClientRect(),s=o.srcEvent,u=x_(i,a,s);return e.getPDFPage().then((function(i){var r=i.reverseDeviceRect(u,e.getScale(),e.getRotation()),o=t.pdfViewer.getDefaultAnnotConfig()("link");i.addAnnot({type:"link",rect:r,color:o.color?o.color:"0000FF"}).then((function(i){n.find(".fv__mark-link-blank").remove();var r=t.pageRender.getAnnotRender(i[0].getId()).component;r.showCreateDialog();t.pdfViewer;j.isMobile&&t.pdfViewer.getStateHandlerManager().switchTo(ys.getStateName()),e.pdfViewer.eventEmitter.emit(de.addAnnotSuccess,r.annot)}))}))}))}},{key:"destroyPageHandler",value:function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle)}},{key:"out",value:function(){this.destroyPageHandler()}}],[{key:"getStateName",value:function(){return Dn}}]),n}(Ha);function x_(e,t,n){var i,r=Xa(n),o=Za(n),a=[r-t.left,o-t.top],s=e[0],u=e[1],c=a[0],l=a[1];return c<s&&(i=s,s=c,c=i),l<u&&(i=u,u=l,l=i),{left:s,top:u,right:c,bottom:l}}var C_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).throttleTaskExecutor=new j.ThrottleAsyncTaskExecutor(100,!0),i}return(0,A._)(n,[{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e.doc,i=this.pdfViewer=e.pdfViewer,r=i.viewerUI.rootComponent.pdfUI,o=e.$handler.addClass("fv__select-text-image-state-handler"),a=o[0];this.eventEmitter=i.eventEmitter;var s=this.tooltip=i.viewerUI.createTextSelectionTooltip(e),u=this.hammer=new(vr().Manager)(a,{recognizers:[[vr().Pan,{direction:vr().DIRECTION_ALL,threshold:0}]]});u.add(new(vr().Tap)({event:"doubletap",taps:2})),u.add(new(vr().Tap)({event:"singletap"})),u.get("doubletap").recognizeWith("singletap"),u.get("singletap").requireFailure("doubletap"),u.on("singletap",(function(e){t.textSelectionHandler.lookUpQuick||gs(i),s&&s.hide()})),u.on("doubletap",(function(e){return t.eventEmitter.emit(de.doubleTapPage,e)}));var c=O()('<div class="fv__selection-state-contextmenu-container fv__contextmenu-container"></div>'),l=o.find(".fv__mark-selection-blank");l&&l.length>0?c.insertBefore(l[0]):o.append(c),c.data("hand-state",this),this.$contextmenuContainer=c,o.on("mousemove",this.mousemove.bind(this)),this.textSelectionHandler=new vs(u,e,s,Jn),r.openDialog("fv--selected-image-contextmenu").then((function(r){var a="click.image.".concat(e.index);O()(r.element).find("[component-type=contextmenu-item]").off(a).on(a,(function(r){var o=n.selectedInfo;if(o&&o.pageRender===e&&!O()(r.currentTarget).hasClass("disabled"))switch(O()(r.currentTarget).attr("component-name")){case"fv--contextmenu-item-copy":t.doImageCopy();break;case"fv--contextmenu-item-saveImageAs":t.doExportImageObjAs();break;case"fv--contextmenu-item-bookmark":t.textSelectionHandler.createBookmark(e);break;case"fv--contextmenu-item-editImage":gs(i),s&&s.hide(),i.stateHandlerManager.switchTo("page-editor"),t.pdfViewer.getEventEmitter().once("pageeditor-started",(function(n){setTimeout((function(){e.docRender.stateHandler.triggerClick(t.lastEvent,1)}),300)}))}})),o.on("contextmenu",".fv__mark-selection-blank[type=".concat(Mt.Image,"]"),(function(e){e.preventDefault();var n=r.getComponentByName("fv--contextmenu-item-bookmark");t.hasModifyPermissions(t.pageRender)?n.unlock():n.lock(),r.showAt(e.pageX,e.pageY)})),o.on("mouseup",t.mouseup=function(e){3===e.which&&t.eventEmitter.emit(de.rightClickPage,e)})})),r.openDialog("fv--selected-rectangle-contextmenu").then((function(i){var r="click.rectangle.".concat(e.index);O()(i.element).find("[component-type=contextmenu-item]").off(r).on(r,(function(i){var r=n.selectedInfo;if(r&&r.pageRender===e&&!O()(i.currentTarget).hasClass("disabled")&&"fv--contextmenu-item-exportSelectionAs"===O()(i.currentTarget).attr("component-name"))t.doExportSelectionRectangle()})),o.on("contextmenu",".fv__mark-selection-blank[type=rectangle]",(function(e){e.preventDefault();var n=t.checkPerm("checkExtractAccess"),r=i.getComponentByName("fv--contextmenu-item-exportSelectionAs");n?r.enable():r.disable(),i.showAt(e.pageX,e.pageY)}))})),r.eventEmitter.on("text-tooltip-click",(function(e){"highlight"===e.type&&t.pdfViewer.getPDFDocRender().pagesRender.pageRenders.forEach((function(e){e.$handler.find(".fv__mark-selection-blank").remove()}))}))}},{key:"offHammer",value:function(){this.hammer&&this.hammer.off("panstart"),this.hammer&&this.hammer.off("panmove"),this.hammer&&this.hammer.off("panend")}},{key:"destroy",value:function(){this.throttleTaskExecutor.cancel()}},{key:"destroyPageHandler",value:function(){this.tooltip&&this.tooltip.hide(),this.hammer&&this.hammer.destroy(),this.pageRender&&this.pageRender.$handler.removeClass("fv__select-text-image-state-handler"),this.pageRender.$handler.off("mouseup",this.mouseup),this.$contextmenuContainer&&this.$contextmenuContainer.remove(),this.tooltip&&this.tooltip.destroy(),this.eventEmitter.off("text-tooltip-click"),this.textSelectionHandler.destroy(),this.pageRender.$handler.off("mousemove")}},{key:"docHandler",value:function(e){var t=this;(0,S._)((0,x._)(n.prototype),"docHandler",this).call(this,e);var i=this.pdfViewer,r=e.doc;i.getKeyboard().withContext(Jn,(function(e){t.__off__copy__event__&&t.__off__copy__event__(),t.__off__copy__event__=e.keydown(ko.COPY_TEXT_IMAGE,(function(){if(r.selectedInfo){var e=r.selectedInfo.type;e===Mt.Text?t.doTextCopy():e===Mt.Image&&t.doImageCopy()}})),t.offSelectAllEvent&&t.offSelectAllEvent(),t.offSelectAllEvent=e.keydown(ko.SELECT_ALL,(function(){var e=i.getPDFDocRender().getPDFPageRender(i.getPDFDocRender().getCurrentPageIndex());t.textSelectionHandler.doTextSelectAll(e,r.selectedInfo)}),{interceptors:[(0,j.preventDefaultInterceptor)()]}),t.offAddBookmarkEvent&&t.offAddBookmarkEvent(),t.offAddBookmarkEvent=e.keydown(ko.ADD_BOOKMARK,(function(){var e=i.getPDFDocRender().getPDFPageRender(i.getPDFDocRender().getCurrentPageIndex());t.hasModifyPermissions(e)&&r.checkPermission(fa.checkAssemble)&&t.textSelectionHandler.createBookmark(e)}),{interceptors:[(0,j.preventDefaultInterceptor)()]})}));var o=null;e.$container.on("mouseleave",".fv__mark-selection-blank, .fv--ui-text-selection-tooltip",(function(e){clearTimeout(o),o=setTimeout((function(){var e=i.getPDFDocRender();if(e){var t=e.getPDFPageRender(i.getPDFDocRender().getCurrentPageIndex());t&&t.stateHandler&&t.stateHandler.tooltip&&t.stateHandler.tooltip.hide()}}),1e3)})).on("mouseenter",".fv__mark-selection-blank, .fv--ui-text-selection-tooltip",(function(e){clearTimeout(o)}))}},{key:"destroyDocHandler",value:function(){var e=this;(0,S._)((0,x._)(n.prototype),"destroyDocHandler",this).call(this),this.__off__copy__event__&&this.__off__copy__event__(),this.__off__copy__event__=qi,["offCopyEvent","offSelectAllEvent","offAddBookmarkEvent","undoSwitchKbBinder"].forEach((function(t){e[t]&&e[t](),e[t]=qi}))}},{key:"out",value:function(){this.destroyPageHandler()}},{key:"doImageCopy",value:function(){var e=this.pdfViewer.currentPDFDoc;e.selectedInfo&&e.selectedInfo.graphicsObject&&e.selectedInfo.graphicsObject.getStream().then((function(e){var t=new Blob([e],{type:"image/png"}),n=[new ClipboardItem((0,J._)({},t.type,t))];navigator.clipboard.write(n)}))}},{key:"doExportImageObjAs",value:function(){var e=this.pdfViewer.viewerUI.rootComponent.pdfUI;if(!(e.customs&&e.customs.isAccountExpired&&e.customs.isAccountExpired(!0))){var t=this.pageRender.doc;t.selectedInfo&&e.customs&&e.customs.showSaveAsDialog&&e.customs.showSaveAsDialog("convert-pdf-to-png","",t.selectedInfo)}}},{key:"doExportSelectionRectangle",value:function(){var e=this.pdfViewer.viewerUI.rootComponent.pdfUI;if(!(e.customs&&e.customs.isAccountExpired&&e.customs.isAccountExpired(!0,{btnName:"fv--contextmenu-item-exportSelectionAs",tabName:"convert_tab"}))){var t=this.pageRender,n=t.$handler.get(0).getBoundingClientRect(),i=t.$handler.find(".fv__mark-selection-blank.rectangle").get(0).getBoundingClientRect();t.reverseDeviceRect({left:i.left-n.left,right:i.right-n.left,top:i.top-n.top,bottom:i.bottom-n.top}).then((function(n){var i;i=[n],e.customs&&e.customs.showSaveAsDialog&&e.customs.showSaveAsDialog("convert-pdf-to-word",JSON.stringify([{pageIndex:t.index,rectArray:i}]))}))}}},{key:"hasModifyPermissions",value:function(e){var t=e.doc.getPermissions();return 8&t&&32&t}},{key:"checkPerm",value:function(e){return this.pageRender.docRender.getUserPermission()[e]()}},{key:"doTextCopy",value:function(){var e=this,t=this.pdfViewer.currentPDFDoc,n=t.selectedInfo.getText?t.selectedInfo.getText():void 0;void 0!==n&&(0,j.copyText)(n).then((function(t){e.pdfViewer.eventEmitter.emit(t?de.copyTextSuccess:de.copyTextFailed,n)}))}},{key:"mousemove",value:function(e){var t=this;this.textSelectionHandler&&this.textSelectionHandler.isTextSelectionToolEnabledInHandState()&&(this.textSelectionHandler.isTextSelecting()||(this.mousemoveEvent=e,this.throttleTaskExecutor.exec((function(){return t.mousemoveHandler(e)}))))}},{key:"mousemoveHandler",value:function(e){var t=this,n=this.pageRender,i={x:e.originalEvent.layerX,y:e.originalEvent.layerY};return n.getTextContinueRectAtDevicePoints([i.x,i.y],[i.x+5,i.y+5],-1,-1).then((function(i){if(i[0]){var r={x:e.originalEvent.layerX,y:e.originalEvent.layerY};if(r.x!=t.mousemoveEvent.originalEvent.layerX&&r.y!=t.mousemoveEvent.originalEvent.layerY)return;n.$handler.removeClass("fv__cursor-grab").addClass("fv__cursor-text"),t.pdfViewer.eventEmitter.emit("can-scroll",!1)}else n.$handler.removeClass("fv__cursor-text")}))}}],[{key:"getStateName",value:function(){return Jn}},{key:"getDefaultContextMenuConfig",value:function(){return{selector:".fv__selection-state-contextmenu-container"}}}]),n}(Ha),D_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).cursorStyle="fv__cursor-crosshair",i}return(0,A._)(n,[{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e.$handler.get(0);n.classList.add(this.cursorStyle);var i=new Hammer.Manager(n);this.hammer=i,i.add(new Hammer.Pan),e.getPDFPage().then((function(r){t.page=r,i.on("panstart",(function(i){var o=Qa(n,i),a={x:o.x+i.deltaX,y:o.y+i.deltaY},s=t._resolvePointsToRect(r,o,a);t.pdfViewer.eventEmitter.emit(de.createSnapshotArea,e,s),t.startPoint={x:s.left,y:s.top}})),i.on("panmove",(function(n){var i={x:t.startPoint.x+n.deltaX,y:t.startPoint.y+n.deltaY},o=t._resolvePointsToRect(r,t.startPoint,i);t.pdfViewer.eventEmitter.emit(de.updateSnapshotArea,e,o)})),i.on("panend",(function(n){var i={x:t.startPoint.x+n.deltaX,y:t.startPoint.y+n.deltaY},o=t._resolvePointsToRect(r,t.startPoint,i);t.pdfViewer.eventEmitter.emit(de.stabilizedSnapshotArea,e,o)}))}))}},{key:"_resolvePointsToRect",value:function(e,t,n){var i=this.pageRender.getShowWidth(),r=this.pageRender.getShowHeight();return{left:Math.max(0,Math.min(t.x,n.x)),right:Math.min(i,Math.max(t.x,n.x)),top:Math.max(0,Math.min(t.y,n.y)),bottom:Math.min(r,Math.max(t.y,n.y))}}},{key:"destroyPageHandler",value:function(){(this.hammer&&this.hammer.destroy(),this.pageRender)&&this.pageRender.$handler.get(0).classList.remove(this.cursorStyle)}}],[{key:"getStateName",value:function(){return"snapshot-tool"}}]),n}(Ha);var E_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e)).destroyHooks=[],i.destroyDocHooks=[],i.cursorStyle="fv__cursor-loupe",i.offsetX=0,i.offsetY=0,i.updatePosition=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=null;return function(){var i=this,r=arguments;n||(n=setTimeout((function(){e.apply(i,r),n=null}),t))}}(i.updatePosition.bind((0,w._)(i))),i}return(0,A._)(n,[{key:"docHandler",value:function(){var e,t,n=this,i=null;j.isChrome&&(e="wheel",t=function(e){var t=e.screenX,r=e.screenY,o=document.elementFromPoint(t,r);if(o&&o.className.indexOf(n.cursorStyle)&&i!==o){var a=new MouseEvent("mouseover");o.dispatchEvent(a),i=o}},document.addEventListener(e,t),n.destroyHooks.push((function(){document.removeEventListener(e,t)})))}},{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e.$handler.get(0);e.$handler.removeClass("fv__cursor-grab").addClass(this.cursorStyle);var i=this.areaRenderer=e.getPageAreaRenderer(255,400,1,!1),r=(document.getElementsByClassName("fv__pdf-viewer-layout"),function(e,i){n.addEventListener(e,i),t.destroyHooks.push((function(){n.removeEventListener(e,i)}))});r("click",(function(e){t.pdfViewer.eventEmitter.emit(de.startUpdatePageAreaRenderer,i),t.offsetX=e.offsetX,t.offsetY=e.offsetY,t.updatePosition()})),r("mouseover",(function(e){t.pdfViewer.eventEmitter.emit(de.createPageAreaRenderer,i),setTimeout((function(){t.pdfViewer.eventEmitter.emit(de.switchPageAreaRenderer,i)}))})),r("mousemove",(function(e){t.offsetX=e.offsetX,t.offsetY=e.offsetY,t.updatePosition()})),r("wheel",(function(e){t.offsetX=e.offsetX,t.offsetY=e.offsetY,t.updatePosition()}))}},{key:"updatePosition",value:function(){this.areaRenderer.setPosition(this.offsetX,this.offsetY),this.areaRenderer.update()}},{key:"destroyDocHandler",value:function(){this.destroyDocHooks.forEach((function(e){return e()})),this.pdfViewer.eventEmitter.emit(de.destroyPageAreaRenderer),this.destroyPageHandler()}},{key:"destroyPageHandler",value:function(){this.pageRender&&this.pageRender.$handler.removeClass(this.cursorStyle),this.destroyHooks.forEach((function(e){return e()})),this.updatePosition=null}}],[{key:"getStateName",value:function(){return zn}}]),n}(Ha),I_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,A._)(n,[{key:"pageHandler",value:function(e){var t=this;this.pageRender=e,this.pdfViewer=e.pdfViewer,this.selectMarkIsVisible=!1;var n=this.tooltip=this.pdfViewer.viewerUI.createTextSelectionTooltip(e),i=e;e.$ui.addClass("fv__annot-container-zindex-up");var r=i.$handler;r.addClass("fv__select-text-annotation-state-handler");var o,a=r[0],s=e.pdfViewer.eventEmitter;o=function(i){i==e&&t.pdfSelectRectArray&&t.selectMarkIsVisible&&e.getPDFPage().then((function(i){var r=e.transformRectArray(i,t.pdfSelectRectArray);t.showSelectMark(r);var o=r[0];o&&n.showAt((o.left+o.right)/2,o.top,t.selectText,r)}))},s.on(de.renderPageSuccess,o),t.removeRenderPageSuccessEvent=function(){s.off(de.renderPageSuccess,o)};var u,c=this.hammer=new(vr().Manager)(a,{recognizers:[[vr().Pan,{direction:vr().DIRECTION_ALL}]]});c.add(new(vr().Tap)({event:"doubletap",taps:2})),c.add(new(vr().Tap)({event:"singletap"})),c.get("doubletap").recognizeWith("singletap"),c.get("singletap").requireFailure("doubletap"),c.on("singletap",(function(i){t.hideSelectMark(),n.hide();var r=e.annotsRender;r?(r.unActiveAnnot(),s.emit(de.tapPage,i)):s.emit(de.tapPage,i)})),c.on("doubletap",(function(i){t.hideSelectMark(),n.hide();var r=e.annotsRender;r?(r.unActiveAnnot(),s.emit(de.doubleTapPage,i)):s.emit(de.doubleTapPage,i)})),n.on("hide",(function(){t.hideSelectMark()}));var l,d,h=-1,f=-1;c.on("panstart",(function(n){if(!1!==t.panStart(n,t)){h=-1,f=-1,l=void 0;var i=e.annotsRender;i&&i.unActiveAnnot();var r=Qa(a,n);u=[r.x,r.y],t.hideSelectMark(),d=new fe}})),c.on("panmove",(function(e){!1!==t.panMove(e,t)&&d.push((function(){var n=t.pageRender,i=[u[0]+e.deltaX,u[1]+e.deltaY];return t.getTextRect(u,i,h,f).then((function(e){var t;return(t=e[0])&&"string"==typeof t.text&&(h=t.start,f=t.end),Promise.all([n.getPDFPage(),e])})).then((function(e){var t=(0,E._)(e,2),i=t[0],r=t[1];return n.transformRectArray(i,r)})).then((function(e){t.showSelectMark(e)}))}))})),c.on("panend",(function(i){if(!1!==t.panEnd(i,t)){d.end(),d=null;var r=Ya(u,i.deltaX,i.deltaY),o=[u[0]+i.deltaX,u[1]+i.deltaY];return t.getTextRect(u,o,h,f).then((function(t){var n;return(n=t[0])&&"string"==typeof n.text&&(h=n.start,f=n.end,l=n.text),Promise.all([e.getPDFPage(),t])})).then((function(o){var a=(0,E._)(o,2),s=a[0],u=a[1];t.pdfSelectRectArray=u;var c=e.transformRectArray(s,u);t.showSelectMark(c),("string"==typeof l?Promise.resolve(l):t.getTextChar(r)).then((function(e){t.pdfViewer.getStore().dispatch(xe.SELECTION_INFO,{page:s,text:e,rectArray:u}),t.selectText=e,t.pdfViewer.eventEmitter.emit(de.selectText,{page:s,text:e,rectArray:u,e:i})}));var d=c[0];d&&n.showAt((d.left+d.right)/2,d.top,t.selectText,c)}))}}));var g=O()('<div class="fv__selection-state-contextmenu-container fv__contextmenu-container"></div>');r.append(g),g.data("hand-state",this),this.$contextmenuContainer=g}},{key:"getTextRect",value:function(e,t,n,i){return this.pageRender.getTextContinueRectAtDevicePoints(e,t,n,i)}},{key:"getTextChar",value:function(e){return this.pageRender.getTextContinuousCharAtDeviceRect(e)}},{key:"showSelectMark",value:function(e){this.selectMarkIsVisible=!0;var t=this.pageRender.$handler;t.find(".fv__mark-selection-blank").remove();for(var n=O()(document.createDocumentFragment()),i=0,r=e.length;i<r;i++){var o=e[i],a=["top:"+o.top+"px","left:"+o.left+"px","height:"+(o.bottom-o.top)+"px","width:"+(o.right-o.left)+"px"].join(";");n.append('<mark class="fv__mark-selection-blank" style="'+a+'"></mark>')}t.append(n)}},{key:"hideSelectMark",value:function(){this.selectMarkIsVisible=!1,this.pdfViewer.getStore().dispatch(xe.SELECTION_INFO,null),this.pageRender.$handler.find(".fv__mark-selection-blank").remove()}},{key:"copyText",value:function(){}},{key:"panStart",value:function(){}},{key:"panMove",value:function(){}},{key:"panEnd",value:function(){}},{key:"destroyPageHandler",value:function(){this.hammer&&this.hammer.destroy(),this.pageRender.$ui.removeClass("fv__annot-container-zindex-up"),this.pageRender.$handler.off("mouseup",this.mouseup).removeClass("fv__select-annotation-state-handler"),this.$contextmenuContainer&&this.$contextmenuContainer.remove(),this.pageRender.annotsRender&&this.pageRender.annotsRender.unActiveAnnot(),this.hideSelectMark(),this.tooltip.destroy(),this.removeRenderPageSuccessEvent()}},{key:"out",value:function(){this.destroyPageHandler()}}],[{key:"getStateName",value:function(){return Gn}},{key:"getDefaultContextMenuConfig",value:function(){return{selector:".fv__selection-state-contextmenu-container"}}}]),n}(Ha),R_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){return(0,P._)(this,n),t.call(this,e)}return(0,A._)(n,[{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n,i=e.$handler[0],r=this.hammer=new(vr().Manager)(i,{recognizers:[[vr().Pan,{direction:vr().DIRECTION_ALL}]]});r.on("panstart",(function(e){if(!1!==t.panStart(e,t)){var r=e.srcEvent,o=Xa(r),a=Za(r);n=Wa(i,o,a),t.hideToolTip(),t.hideSelectMark()}})),r.on("panmove",(function(e){!1!==t.panMove(e,t)&&t.getTextRect(Ya(n,e.deltaX,e.deltaY)).then((function(e){t.showSelectMark(e)}))})),r.on("panend",(function(e){!1!==t.panEnd(e,t)&&t.getTextRect(Ya(n,e.deltaX,e.deltaY)).then((function(e){t.showToolTip(e)}))}))}},{key:"getTextRect",value:function(e){return this.pageRender.getTextContinueRectAtDeviceRect(e)}},{key:"showSelectMark",value:function(e){var t=this.pageRender.$handler;t.find(".mark-select-text-blank").remove();for(var n=$(document.createDocumentFragment()),i=0,r=e.length;i<r;i++){var o=e[i],a=["top:"+o.top+"px","left:"+o.left+"px","width:"+(o.bottom-o.top)+"px","height:"+(o.right-o.left)+"px"].join(";");n.append('<mark class="mark-highlight-blank" style="'+a+'"></mark>')}t.append(n)}},{key:"hideSelectMark",value:function(){this.pageRender.$handler.find(".mark-highlight-blank").remove()}},{key:"showToolTip",value:function(){}},{key:"hideToolTip",value:function(){}},{key:"panStart",value:function(){}},{key:"panMove",value:function(){}},{key:"panEnd",value:function(){}},{key:"destroyPageHandler",value:function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.off("mouseup",this.mouseup).removeClass("fv__select-text-state-handler"),this.hideToolTip();try{this.hideSelectMark()}catch(e){}}},{key:"out",value:function(){this.destroyPageHandler()}}],[{key:"getStateName",value:function(){return Xn}}]),n}(Ha);const T_=R_;var F_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),(i=t.call(this,e,"square")).pdfViewer=e,i.cursorStyle="fv__cursor-marquee",i.destroyHooks=[],i}return(0,A._)(n,[{key:"start",value:function(e,t){var n=t.left,i=t.top;this.shapeControl||(this.shapeControl=new zu({resizable:!1,enableDiagonally:!0}),this.shapeControl.active(e.$handler,{left:n,top:i,width:0,height:0},{left:n,top:i,right:n,bottom:i}))}},{key:"pageHandler",value:function(e){var t=this;this.pageRender=e;var n=e.$handler.get(0);e.$handler.addClass(this.cursorStyle);var i,r=this.hammer=new(vr().Manager)(n);e.$handler;r.add(new(vr().Pan)({direction:vr().DIRECTION_ALL}));var o,a=!1,s=this;r.on("panstart",(o=(0,_._)((function(t){var r,o,u,c,l,d;return(0,F.Jh)(this,(function(h){switch(h.label){case 0:return r=s.pdfViewer.getPDFViewerRender(),a=!0,[4,r.getScaleRatio()];case 1:return o=h.sent(),a=!1,t.srcEvent.ctrlKey||t.srcEvent.metaKey?(u=s.pdfViewer.config.minScale,o<=u&&(a=!0)):(c=s.pdfViewer.config.maxScale,o>=c&&(a=!0)),a||(r&&r.disableDragToScroll(),s.startPoint=Qa(n,t),l=s.startPoint.x,d=s.startPoint.y,s.start(e,{left:l,top:d}),i=new fe),[2]}}))})),function(e){return o.apply(this,arguments)})),r.on("panmove",(function(n){if(!a){var r=e.$handler[0].getClientRects()[0],o=r.width,s=r.height;t.currentPoint={x:t.calibrationNumber({num:t.startPoint.x+n.deltaX,max:o}),y:t.calibrationNumber({num:t.startPoint.y+n.deltaY,max:s})},i.push((function(){return t.adjust(t.shapeControl,t.startPoint,t.currentPoint)}))}})),r.on("panend",(function(n){if(!a){var r=t.pdfViewer.getPDFViewerRender();r&&r.enableDragToScroll();var o=e.$handler[0].getClientRects()[0],s=o.width,u=o.height;if(!t.isStart&&t.shapeControl){var c=(0,E._)(n.pointers,1)[0];t.currentPoint={x:t.calibrationNumber({num:t.startPoint.x+n.deltaX,max:s}),y:t.calibrationNumber({num:t.startPoint.y+n.deltaY,max:u})},t.isStart=!0,setTimeout((function(){t.isStart=!1}),500),i.push((function(){return t.adjust(t.shapeControl,t.startPoint,t.currentPoint)})),c.ctrlKey||c.metaKey?t.pdfViewer.eventEmitter.emit(de.marqueeZoomOut,t.shapeControl.shape.shape,t.pageRender.index):t.pdfViewer.eventEmitter.emit(de.marqueeZoomIn,t.shapeControl.shape.shape,t.pageRender.index),t.shapeControl.destroy(),t.shapeControl=null}}})),r.on("pancancel",(function(e){var n=t.pdfViewer.getPDFViewerRender();n&&n.enableDragToScroll(),i.end(),t.shapeControl.destroy(),t.shapeControl=null}));var u=function(e,i){n.addEventListener(e,i),t.destroyHooks.push((function(){n.removeEventListener(e,i)}))};u("click",(function(n){if(!t.isStart&&!a){t.isStart=!0,setTimeout((function(){t.isStart=!1}),500);var i=n.layerX,r=n.layerY;t.start(e,{left:i,top:r}),t.shapeControl.shape.shape.clientX=n.clientX,t.shapeControl.shape.shape.clientY=n.clientY,n.ctrlKey||n.metaKey?t.pdfViewer.eventEmitter.emit(de.marqueeZoomOut,t.shapeControl.shape.shape,t.pageRender.index):t.pdfViewer.eventEmitter.emit(de.marqueeZoomIn,t.shapeControl.shape.shape,t.pageRender.index),t.shapeControl.destroy(),t.shapeControl=null}})),u("contextmenu",(function(e){e.stopPropagation(),e.preventDefault()}))}},{key:"adjust",value:function(e,t,n){var i=t.x,r=t.y,o=n.x,a=n.y;if(e){var s,u,c=Math.abs(i-o),l=Math.abs(r-a),d={left:s=Math.min(i,o),top:u=Math.min(r,a),width:c=Math.max(c,1),height:l=Math.max(l,1)},h={left:s,top:u,right:s+c,bottom:u+l};e._applyAnnotBoundary(d),e.shape.boundary=h,e.shape.shape=d,e._updatePreviewer()}}},{key:"calibrationNumber",value:function(e){var t=e.num,n=e.min,i=void 0===n?0:n,r=e.max;return t<0?i:t>r?r:t}},{key:"docHandler",value:function(e){document.addEventListener("keydown",this.keydownEventListener=function(t){(t.ctrlKey||t.metaKey)&&e.pagesRender.pageRenders.forEach((function(e){e.$handler.get(0).style.cssText+="cursor: -webkit-zoom-out;cursor: zoom-out"}))},{capture:!0}),document.addEventListener("keyup",this.keyupEventListener=function(t){switch(t.keyCode){case j.KeyCodes.Ctrl:case j.KeyCodes.Meta:e.pagesRender.pageRenders.forEach((function(e){e.$handler.get(0).style.cursor=null}))}},{capture:!0})}},{key:"destroyDocHandler",value:function(){document.removeEventListener("keydown",this.keydownEventListener,{capture:!0}),document.removeEventListener("keyup",this.keyupEventListener,{capture:!0})}},{key:"destroyPageHandler",value:function(){this.hammer&&this.hammer.destroy(),this.pageRender.$handler.removeClass(this.cursorStyle),this.pageRender.$handler.off("mousedown"),this.destroyHooks.forEach((function(e){return e()}))}}],[{key:"getStateName",value:function(){return Kn}}]),n}(Ha),M_=g(973),O_=g.n(M_),L_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"execute",value:function(e){var t=this,n=e.getStore(),i=e.ioc.getInstanceByClass(Gi).onMeasurementInfoChange((function(e){var r=t.getMeasurementInfo(e),o=r.displayUnit,a={distance:0,deltaX:0,deltaY:0,scale:r.scale,angle:0,displayUnit:o,perimeter:0,area:0,userSpaceUnit:r.userSpaceUnit};n.dispatch("measurementData",a),i()}))}},{key:"getMeasurementInfo",value:function(e){var t=e[Bi],n=e[Vi],i=e[ji],r=e.realUnit;return{userSpaceScale:t,userSpaceUnit:n,scale:"".concat(t," ").concat(n.name," = ").concat(i," ").concat(r.name),displayUnit:r,realScale:i,realUnit:r}}}]),n}(j.Disposable);function N_(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){return e/t.length})).reduce((function(e,t){return e+t}))}var V_=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"isWhite",value:function(){return!this.a||255===this.r&&255===this.g&&255===this.b}},{key:"averageLightnessColor",value:function(){return N_(this.r,this.g,this.b)}},{key:"lightnessAverageWith",value:function(e){return N_(this.averageLightnessColor(),e.averageLightnessColor())}},{key:"mix",value:function(e,t,i){return new n(this.r*t+e.r*(1-t),this.g*t+e.g*(1-t),this.b*t+e.g*(1-t),i)}},{key:"cloneRGB",value:function(e){return new n(this.r,this.g,this.b,e)}},{key:"clone",value:function(){return new n(this.r,this.g,this.b,this.a)}},{key:"asArray",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"grey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.a,t=this.averageRGB()/2,i=Math.ceil(127.5)+t;return new n(i,i,i,e)}},{key:"averageRGB",value:function(){return N_(this.r,this.g,this.b)}}],[{key:"fromHSLA",value:function(e,t,i,r){var o=(0,E._)(j.Color.convertHSL2rgb(e,t,i),3);return new n(o[0],o[1],o[2],r)}},{key:"fromRGB",value:function(e){return n.fromRGBA(e,255)}},{key:"fromARGB",value:function(e){if(e<=16777215)return n.fromRGBA(e,255);var t=255&e>>24,i=16777215&e;return n.fromRGBA(i,t)}},{key:"fromRGBA",value:function(e,t){return new n(e>>16&255,e>>8&255,255&e,t)}},{key:"fromColor",value:function(e){return(0,D._)(e,n)?e:new n(e.r,e.g,e.b,e.a)}}]),n}(j.Color);(0,J._)(V_,"TRANSPARENT",V_.fromARGB(0)),(0,J._)(V_,"WHITE",V_.fromARGB(4294967295));var B_=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"toChannelIndex",value:function(){return-1}},{key:"toPixelIndex",value:function(){return-1}},{key:"toCoords",value:function(){return{x:-1,y:-1,width:-1}}},{key:"isValid",value:function(){return!1}}]),e}(),j_=function(){function e(t,n,i){(0,P._)(this,e),(0,J._)(this,"x",void 0),(0,J._)(this,"y",void 0),(0,J._)(this,"width",void 0),this.x=t,this.y=n,this.width=i}return(0,A._)(e,[{key:"toChannelIndex",value:function(){return new U_(this.toPixelIndex(),this.width).toChannelIndex()}},{key:"toPixelIndex",value:function(){return this.y*this.width+this.x}},{key:"toCoords",value:function(){return{x:this.x,y:this.y,width:this.width}}},{key:"isValid",value:function(){return!0}}]),e}(),U_=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"pixelIndex",void 0),(0,J._)(this,"width",void 0),this.pixelIndex=t,this.width=n}return(0,A._)(e,[{key:"toChannelIndex",value:function(){return 4*this.pixelIndex}},{key:"toPixelIndex",value:function(){return this.pixelIndex}},{key:"toCoords",value:function(){var e=this.pixelIndex,t=this.width;return{x:e%t,y:Math.floor(e/t),width:t}}},{key:"isValid",value:function(){return!0}}]),e}(),H_=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"channelIndex",void 0),(0,J._)(this,"width",void 0),this.channelIndex=t,this.width=n}return(0,A._)(e,[{key:"toChannelIndex",value:function(){return this.channelIndex}},{key:"toPixelIndex",value:function(){return Math.floor(this.channelIndex/4)}},{key:"toCoords",value:function(){var e=this.toPixelIndex();return new U_(e,this.width).toCoords()}},{key:"isValid",value:function(){return!0}}]),e}(),W_=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"data",void 0),t.buffer?this.data={data:new(Uint8ClampedArray||Uint8Array)(t.buffer),width:t.width,height:t.height}:this.data=t}return(0,A._)(e,[{key:"coords",value:function(e,t){return e>=this.data.width||t>=this.data.height?new B_:new j_(e,t,this.data.width)}},{key:"pixelIndex",value:function(e){return 4*e>=this.data.data.length?new B_:new U_(e,this.data.width)}},{key:"forEach",value:function(e){var t=this;this.forEachLocation((function(n){var i=t.getPixelColorAt(n);e(n,i)}))}},{key:"forEachLocation",value:function(e){for(var t=this.data.data,n=this.data.width,i=0;i<t.length;i+=4)e(new H_(i,n))}},{key:"getCoordsByPixelIndex",value:function(e){var t=this.data.width;return{x:e%t,y:Math.floor(e/t)}}},{key:"getPixelColorAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V_.WHITE;if(!e.isValid())return t;var n=this.data.data,i=e.toChannelIndex();return new V_(n[i],n[i+1],n[i+2],n[i+3])}},{key:"updatePixelColor",value:function(e,t){if(e.isValid()){var n=e.toCoords(),i=n.x,r=n.y;this.data.data.set(t.asArray(),this.coords(i,r).toChannelIndex())}}}]),e}();function Y_(e,t,n){var i=document.createElement("canvas"),r=i.getContext("2d");return i.width=e,i.height=t,i.style.width="".concat(e/n,"px"),i.style.height="".concat(t/n,"px"),i.style.backgroundColor="white",r.fillStyle="white",i}var q_,K_=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"x",void 0),(0,J._)(this,"y",void 0),this.x=t,this.y=n}return(0,A._)(e,[{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"mult",value:function(t){return new e(this.x*t,this.y*t)}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"negate",value:function(){return new e(-this.x,-this.y)}},{key:"substract",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"normalize",value:function(){var t=this.length();return 0===t?new e(0,0):new e(this.x/t,this.y/t)}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"perp",value:function(){return new e(this.y,-this.x)}},{key:"segment",value:function(t){return{from:this,to:t,dir:new e(t.x-this.x,t.y-this.y)}}},{key:"rotate",value:function(t){var n=Math.sin(t),i=Math.cos(t);return new e(this.x*i+this.y*n,-this.x*n+this.y*i)}}]),e}(),$_=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"resolveDiffColor",value:function(e,t,n,i){var r=i.sourceOpacity,o=i.targetOpacity;if(i.showDiffColor){var a=t.lightnessAverageWith(n),s=a*((Math.abs(t.r-n.r)+Math.abs(t.g-n.g)+Math.abs(t.b-n.b))/255/3),u=a+s,c=Math.max(r,o);return new j.Color(u,a-s,u,c)}if(o>r){var l=r;return t.mix(n,l,o)}return n.cloneRGB(r)}},{key:"combinePixels",value:function(e,t,n){var i=this,r=t.width,o=t.height,a=n.showDiffColor,s=n.targetOpacity,u=n.sourceOpacity,c=n.canvasMultiplier,l=V_.fromRGB(n.targetDiffColor),d=V_.fromRGB(n.sourceDiffColor),h=new W_(e),f=new W_(t),g=Y_(Math.max(t.width,e.width),Math.max(t.height,e.height),c),v=g.getContext("2d"),p=v.createImageData(g.width,g.height),m=new W_(p),y=V_.fromARGB(n.backgroundColor),k=function(e,t,c){var h=e.x,f=e.y;if(c.isSameAs(y)&&t.isSameAs(y))return c.cloneRGB(0);if(a&&t.isSameAs(c))return c.grey(c.a);if(h<=r&&f<=o){if(t.isSameAs(y)){var g=s;return a?i.handleDiffColor(l,c,g):c.cloneRGB(g)}if(c.isSameAs(y)){var v=u;return a?i.handleDiffColor(d,t,v):t.cloneRGB(v)}return V_.fromColor(i.resolveDiffColor(e,t,c,n))}return c},b=k;if("function"==typeof n.blendColorResolver){var w=n.blendColorResolver,_=function(e){return k(e.pos,V_.fromColor(e.sourceColor),V_.fromColor(e.targetColor))};b=function(e,t,i){var r=w({pos:e,sourceColor:t,targetColor:i,combinePixelsOptions:n,callBuiltin:_});return"number"==typeof r?V_.fromARGB(r):V_.fromColor(r)}}return m.forEachLocation((function(e){var t=e.toCoords(),n=f.getPixelColorAt(f.coords(t.x,t.y),y),i=h.getPixelColorAt(h.coords(t.x,t.y),y),r=b(t,n,i);m.updatePixelColor(e,r)})),v.putImageData(p,0,0),g}},{key:"handleDiffColor",value:function(e,t,n){var i=t.averageRGB(),r=Math.min(e.r,e.g,e.b);return new V_(e.r==r?i:e.r,e.g==r?i:e.g,e.b==r?i:e.b,n)}},{key:"transformBitmap",value:function(e,t,n,i){var r=this;if(!n)return{bitmap:e,expandX:0,expandY:0};var o=n.rotate,a=void 0===o?0:o,s=n.translateX,u=void 0===s?0:s,c=n.translateY,l=void 0===c?0:c,d=n.contentX,h=void 0===d?0:d,f=n.contentY,g=void 0===f?0:f;if(i=i||{width:0,height:0},0===a){var v=Math.max(i.width,e.width+Math.abs(u)),p=Math.max(i.height,e.height+Math.abs(l)),m=Y_(v,p,1).getContext("2d",{willReadFrequently:!0});m.fillStyle=V_.fromRGB(t).toCSS_Hex(),m.fillRect(0,0,v,p);var y=this.createImageDataByPageBitmap(m,e),k=Math.max(0,u),b=Math.max(0,l);return m.putImageData(y,k,b),{bitmap:m.getImageData(0,0,v,p),expandX:u<0?-u:0,expandY:l<0?-l:0}}var w=function(){var t=Y_(e.width,e.height,1),n=t.getContext("2d"),i=r.createImageDataByPageBitmap(n,e);return n.putImageData(i,0,0),t}(),_=this.getTransformedBox(e.width,e.height,{rotate:a,translateX:u,translateY:l,contentX:h,contentY:g}),P=_.width,A=_.height,S=_.expandX,x=_.expandY,C=_.renderX,D=_.renderY,E=Math.max(P,i.width),I=Math.max(A,i.height),R=Y_(E,I,1).getContext("2d",{desynchronized:!1,willReadFrequently:!0});return R.fillStyle=V_.fromRGB(t).toCSS_Hex(),R.fillRect(0,0,E,I),R.translate(C,D),R.rotate(a),R.translate(-h,-g),R.drawImage(w,0,0),{bitmap:R.getImageData(0,0,E,I),expandX:S,expandY:x}}},{key:"createImageDataByPageBitmap",value:function(e,t){if((0,D._)(t,ImageData))return t;var n=e.createImageData(t.width,t.height);return t.buffer?n.data.set(new(Uint8ClampedArray||Uint8Array)(t.buffer),0):n.data.set(t.data),n}},{key:"getTransformedBox",value:function(e,t,n){var i,r,o,a,s=n.rotate,u=n.translateY,c=n.translateX,l=n.contentX,d=n.contentY,h=new K_(l=l||0,d=d||0),f=h.mult(-1),g=new K_(e,0).substract(h),v=new K_(e,t).substract(h),p=[f,g,new K_(0,t).substract(h),v].map((function(e){return e.rotate(-s)})),m=p.map((function(e){return e.x})),y=p.map((function(e){return e.y})),k=(i=Math).min.apply(i,(0,I._)(m)),b=(r=Math).max.apply(r,(0,I._)(m)),w=(o=Math).min.apply(o,(0,I._)(y)),_=(a=Math).max.apply(a,(0,I._)(y))-w,P=b-k+Math.abs(c),A=_+Math.abs(u),S=Math.abs(k)+(c<0?0:c),x=Math.abs(w)+(u<0?0:u),C=(k<0?-k:0)+(c<0?-c:0),D=(w<0?-w:0)+(u<0?-u:0);return u>0&&u<D?(D-=u,A-=u,x-=u):u>0&&u>D&&(A-=D,x-=D,D=0),c>0&&c<C?(C-=c,P-=c,S-=c):c>0&&c>C&&(P-=C,S-=C,C=0),{width:P,height:A,renderX:S,renderY:x,expandX:C,expandY:D}}}]),e}();!function(e){e[e.RED=16711680]="RED",e[e.GREEN=65280]="GREEN",e[e.BLUE=255]="BLUE",e[e.MAGENTA=16711935]="MAGENTA",e[e.YELLOW=16776960]="YELLOW",e[e.CYAN=65535]="CYAN"}(q_||(q_={}));var z_=function(){function e(){(0,P._)(this,e),(0,J._)(this,"showDiffColor",void 0),(0,J._)(this,"targetOpacity",void 0),(0,J._)(this,"sourceOpacity",void 0),(0,J._)(this,"targetDiffColor",void 0),(0,J._)(this,"sourceDiffColor",void 0),(0,J._)(this,"backgroundColor",void 0),(0,J._)(this,"blendColorResolver",void 0),(0,J._)(this,"store",new j.Store),this.resetToDefault()}return(0,A._)(e,[{key:"setShowDiffColor",value:function(e){this.showDiffColor=e,this.store.dispatch("showDiffColor",e)}},{key:"setTargetOpacity",value:function(e){this._set("targetOpacity",e)}},{key:"setSourceOpacity",value:function(e){this._set("sourceOpacity",e)}},{key:"setTargetDiffColor",value:function(e){this._set("targetDiffColor",e)}},{key:"setSourceDiffColor",value:function(e){this._set("sourceDiffColor",e)}},{key:"setBlendColorResolver",value:function(e){this._set("blendColorResolver",e)}},{key:"_set",value:function(e,t){this[e]=t,this.store.dispatch(e,t)}},{key:"onChange",value:function(e,t){return this.store.subscribe(e,t)}},{key:"extractAllOptions",value:function(){return{showDiffColor:this.showDiffColor,targetOpacity:this.targetOpacity,sourceOpacity:this.sourceOpacity,sourceDiffColor:this.sourceDiffColor,targetDiffColor:this.targetDiffColor,backgroundColor:this.backgroundColor,blendColorResolver:this.blendColorResolver}}},{key:"resetToDefault",value:function(){this.setShowDiffColor(!1),this.setTargetOpacity(255),this.setSourceOpacity(255),this.setTargetDiffColor(q_.BLUE),this.setSourceDiffColor(q_.RED),this.setBlendColorResolver(void 0),this.backgroundColor=4294967295}}],[{key:"scope",value:function(){return j.IOC_SHARED_SINGLETON}}]),e}(),G_=function(){function e(){(0,P._)(this,e)}return(0,A._)(e,[{key:"createCompareResultDoc",value:function(e){var t=e.pdfViewer,n=e.sourceDoc,i=e.targetDoc,r=e.fileName,o=e.onprogress,a=this;return(0,_._)((function(){var e,s,u,c,l,d,h,f,g;return(0,F.Jh)(this,(function(v){switch(v.label){case 0:return[4,t.getWebPDFJR()];case 1:return e=v.sent(),"function"!=typeof o&&(o=function(){}),s=a.getPageSize(n,i,0),o(0),[4,e.createNewDoc(r,t.getUserName(),s)];case 2:u=v.sent(),c=Math.max(n.getPageCount(),i.getPageCount()),o(1/c),l=1,v.label=3;case 3:return l<c?(d=u.getPageCount(),[4,a.getPageSize(n,i,l)]):[3,7];case 4:return h=v.sent(),f=h.width,g=h.height,[4,u.insertPage(d-1,f,g)];case 5:v.sent(),o(l/c),v.label=6;case 6:return l++,[3,3];case 7:return u.info.isOverlayComparisonDoc=!0,u.fromDoc=n,u.otherDoc=i,o(1),[2,u]}}))}))()}},{key:"comparePageBitmap",value:function(e,t){var n=e.getIoC().getInstanceByClass($_),i=e.getIoC().getInstanceByClass(z_),r=(0,j.extendOptions)({canvasMultiplier:1},i.extractAllOptions(),t.combinePixelsOptions),o=n.transformBitmap(t.targetBitmap,r.backgroundColor,t.transformation),a=o.bitmap,s=o.expandX,u=o.expandY,c=n.transformBitmap(t.sourceBitmap,r.backgroundColor,{translateX:s,translateY:u},{width:a.width,height:a.height}).bitmap;return n.combinePixels(a,c,r)}},{key:"getPageSize",value:function(e,t,n){var i=this;return(0,_._)((function(){var r,o,a,s,u,c;return(0,F.Jh)(this,(function(l){switch(l.label){case 0:return[4,i.getPageByIndex(e,n)];case 1:return r=l.sent(),[4,i.getPageByIndex(t,n)];case 2:return o=l.sent(),a=null==r?void 0:r.getWidth(),s=null==r?void 0:r.getHeight(),u=null==o?void 0:o.getWidth(),c=null==o?void 0:o.getHeight(),[2,{width:Math.max(a,u),height:Math.max(s,c)}]}}))}))()}},{key:"getPageByIndex",value:function(e,t){var n=e.getPageCount();if(!(t<0||t>n))return e.getPageByIndex(t)}}],[{key:"scope",value:function(){return j.IOC_SHARED_SINGLETON}}]),e}(),J_=function(){function e(){(0,P._)(this,e),(0,J._)(this,"pdfViewer",void 0)}return(0,A._)(e,[{key:"compareImageData",value:function(e){return this.getSharedOverlayComparisonService().comparePageBitmap(this.pdfViewer,e)}},{key:"getSharedOverlayComparisonService",value:function(){return this.pdfViewer.getIoC().getInstanceByClass(G_)}}],[{key:"inject",value:function(){return{pdfViewer:RP}}}]),e}(),X_=function(){function e(){(0,P._)(this,e),(0,J._)(this,"pdfViewerInstances",new Set),(0,J._)(this,"usedInstanceIds",new Set)}return(0,A._)(e,[{key:"addPDFViewerInstance",value:function(e){var t=this;return this.pdfViewerInstances.add(e),this.usedInstanceIds.add(e.instanceId),function(){t.removePDFViewerInstance(e)}}},{key:"removePDFViewerInstance",value:function(e){this.pdfViewerInstances.delete(e)}},{key:"isMultipleCase",value:function(){return this.pdfViewerInstances.size>1}},{key:"hasPDFViewerInstance",value:function(){return this.pdfViewerInstances.size>0}},{key:"isUsedInstanceId",value:function(e){return Array.from(this.pdfViewerInstances).some((function(t){return t.instanceId===e}))}},{key:"getNextInstanceId",value:function(){if(this.pdfViewerInstances.size>0)return"pdfviewer-instance-"+this.usedInstanceIds.size}}],[{key:"scope",value:function(){return j.IoCScope.SHARED_SINGLETON}}]),e}(),Z_=["de-DE","en-US","es-419","fr-FR","it-IT","ja-JP","ko-KR","nl-NL","zh-CN","zh-TW"],Q_=Z_.map((function(e){return e.toLowerCase().split("-")}));function eP(e){if("string"!=typeof e)return"en-US";var t,n=e.toLowerCase();if(n.indexOf("-")>-1){var i=n.split("-");t=function(e){return e[0]===i[0]&&e[1]===i[1]}}else t=function(e){return e[0]===n||e[1]===n};var r=Q_.findIndex(t);return-1!==r?Z_[r]:"en-US"}var tP=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"events",void 0),this.events={}}return(0,A._)(e,[{key:"setCallback",value:function(e,t){this.events[e]=t}},{key:"getCallback",value:function(e){return this.events[e]}},{key:"removeCallback",value:function(e){delete this.events[e]}},{key:"clear",value:function(){this.events={}}},{key:"setEmbeddedGotoCallback",value:function(e){this.setCallback(ot.gotoE,e)}},{key:"setSubmitFormCallback",value:function(e){this.setCallback(ot.submitForm,e)}}]),e}(),nP=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"execute",value:function(e){var t=j.CLIPBOARD_DATA_TYPES.PLAIN,n=j.CLIPBOARD_DATA_TYPES.HTML,i=j.CLIPBOARD_DATA_TYPES.FILES,r=function(r){if(!(0,j.isEditableElement)(document.activeElement)&&e.isShortcutKeyEnabled()&&r.clipboardData&&r.clipboardData.items){if(j.keyboardStatus.isShiftDown)return r.preventDefault(),!1;var o=e.getStateHandlerManager().getCurrentStates(),a=e.getStateHandlerManager().getStateHandlerConfig(o.getStateName());if(!a||!1!==a.enablePasting){var s=[],u=r.clipboardData;if(u&&u.items){var c=u.items,l=u.types,d=l[0],h=0;if(l.length>1){var f=l.indexOf(n);f>-1&&(h=f,d=n)}switch(d){case t:c[h].getAsString((function(t){var n;try{if("number"==typeof(n=JSON.parse(t)))throw new Error("Pure number")}catch(e){n=[{type:"string",value:t}]}n.some((function(e){var t=e.value;return"string"===e.type&&"widget"===t.type&&7===t.fieldType}))?e.viewerUI.alert({message:"form-designer:dialog.typeError",level:"warning"}):e.paste(n).then((function(){var t=e.getCurrentPDFDoc();t&&t.reloadPDFForm()}))}));break;case n:var g=u.getData(n);if(g){var v=[{type:"html",value:g}];e.paste(v).then((function(){var t=e.getCurrentPDFDoc();t&&t.reloadPDFForm()}))}break;case i:s=[{type:"file",value:c[h].getAsFile()}],e.paste(s)}}}}};document.addEventListener("paste",r),this.addDestroyHook((function(){document.removeEventListener("paste",r)}))}}]),n}(j.Disposable),iP=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,J._)((0,w._)(e),"viewer",void 0),(0,J._)((0,w._)(e),"eventEmitter",new Bs.EventEmitter),e}return(0,A._)(n,[{key:"allInjected",value:function(){var e=this;this.ownsTo(this.viewer),this.eventEmitter.emit("change"),this.addDestroyHook((function(){e.eventEmitter.removeAllListeners()}))}},{key:"updateGetAnnotComponentConfig",value:function(e){if("function"!=typeof e)throw new Error("The 'getAnnotComponentConfig' option must be a function.");this.viewer.customs.getAnnotComponentConfig=e,this.eventEmitter.emit("change")}},{key:"onGetAnnotComponentConfigUpdated",value:function(e){var t=this,n=function(){e(t.viewer)};return this.eventEmitter.on("change",n),function(){t.eventEmitter.off("change",n)}}}],[{key:"inject",value:function(){return{viewer:RP}}}]),n}(j.Disposable),rP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"FoxitWebPDFSDKForWeb";(0,P._)(this,e),(0,J._)(this,"defaultDatabaseName",void 0),(0,J._)(this,"STORE_NAME",void 0),(0,J._)(this,"databasePromise",void 0),(0,J._)(this,"removeEventListeners",void 0),(0,J._)(this,"changeEventListeners",void 0),(0,J._)(this,"pdfViewer",void 0),(0,J._)(this,"isClosed",void 0),(0,J._)(this,"notConnected",void 0),(0,J._)(this,"databaseDefer",void 0),(0,J._)(this,"waitQueue",void 0),this.defaultDatabaseName=t,this.STORE_NAME="data",this.removeEventListeners=new Set,this.changeEventListeners=new Set,this.isClosed=!1,this.notConnected=!0,this.waitQueue=new j.QueuedAsyncTaskExecutor}return(0,A._)(e,[{key:"connectDB",value:function(){var e,t,n=this,i=(null===(t=this.pdfViewer)||void 0===t||null===(e=t.customs)||void 0===e?void 0:e.storageDatabaseName)||this.defaultDatabaseName,r=window.indexedDB.open(i,1);this.databaseDefer=(0,j.createDeferred)(),this.databasePromise=this.databaseDefer.promise,this.notConnected=!1,r.onerror=function(){n.databaseDefer.reject(r.error)},r.onsuccess=function(){n.databaseDefer.resolve(r.result),r.result.onclose=function(){n.notConnected=!0}},r.onupgradeneeded=function(){r.result.createObjectStore(n.STORE_NAME).createIndex("id,feature,key",["id","feature","key"],{unique:!0})}}},{key:"useStore",value:function(e){var t=this;return(0,_._)((function(){var n,i;return(0,F.Jh)(this,(function(r){if(t.isClosed)throw new Error("Unable to execute storage operations after the driver has been closed!");var o;return t.notConnected&&t.connectDB(),o=(0,_._)((function(){var n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.databasePromise];case 1:return n=i.sent(),[2,e((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return n.transaction([t.STORE_NAME],e?"readonly":"readwrite").objectStore(t.STORE_NAME)}))]}}))})),n=function(){return o.apply(this,arguments)},i=n(),t.waitQueue.exec((function(){return i})),[2,i]}))}))()}},{key:"get",value:function(e,t){var n=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(i){return[2,n.useStore((function(i){return n.getValue(i(!0),e,t)}))]}))}))()}},{key:"onChange",value:function(e){var t=this,n={callback:e};return this.changeEventListeners.add(n),function(){t.changeEventListeners.delete(n)}}},{key:"remove",value:function(e,t){var n=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return[4,n.useStore((r=(0,_._)((function(i){var r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:return r=i().delete(IDBKeyRange.only(n.generateKeyArray(e,t))),o=(0,j.createDeferred)(),r.onerror=function(){return o.reject(r.error)},r.onsuccess=function(){return o.resolve()},[4,o.promise];case 1:return a.sent(),n.dispatchRemoveEvent(e,t),[2]}}))})),function(e){return r.apply(this,arguments)}))];case 1:return i.sent(),[2]}var r}))}))()}},{key:"removeAll",value:function(e){var t=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.useStore((i=(0,_._)((function(n){var i;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return[4,t.getAllKeys(n(!0),e)];case 1:return i=r.sent(),[4,Promise.all(i.map(function(){var i=(0,_._)((function(i){var r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:return r=n().delete(IDBKeyRange.only(i)),o=(0,j.createDeferred)(),r.onerror=function(){return o.reject(r.error)},r.onsuccess=function(){return o.resolve()},[4,o.promise];case 1:return a.sent(),t.dispatchRemoveEvent(e,i),[2]}}))}));return function(e){return i.apply(this,arguments)}}()))];case 2:return r.sent(),[2]}}))})),function(e){return i.apply(this,arguments)}))];case 1:return n.sent(),[2]}var i}))}))()}},{key:"set",value:function(e,t,n){var i=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return[4,i.useStore((o=(0,_._)((function(r){var o,a,s,u,c;return(0,F.Jh)(this,(function(l){switch(l.label){case 0:return[4,i.has(e,t)];case 1:return(o=l.sent())?[4,i.getValue(r(!0),e,t)]:[3,3];case 2:return s=l.sent(),[3,4];case 3:s=void 0,l.label=4;case 4:return(a=s)===n||JSON.stringify(a)===JSON.stringify(n)?[2]:(u=o?r().put(n,i.generateKeyArray(e,t)):r().add(n,i.generateKeyArray(e,t)),c=(0,j.createDeferred)(),u.onerror=function(){return c.reject(u.error)},u.onsuccess=function(){return c.resolve()},[4,c.promise]);case 5:return l.sent(),i.dispatchChangeEvent({context:e,key:t,oldValue:a,newValue:n}),[2]}}))})),function(e){return o.apply(this,arguments)}))];case 1:return r.sent(),[2]}var o}))}))()}},{key:"getAll",value:function(e){var t=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(n){return[2,t.useStore((i=(0,_._)((function(n){var i,r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return[4,t.getAllKeys(n(),e)];case 1:return i=o.sent(),r={},i.length?[4,Promise.all(i.map(function(){var e=(0,_._)((function(e){var t,i,o,a;return(0,F.Jh)(this,(function(s){switch(s.label){case 0:return t=n(),i=t.get(IDBKeyRange.only(e)),o=(0,j.createDeferred)(),i.onerror=function(){return o.reject(i.error)},i.onsuccess=function(){return o.resolve(i.result)},[4,o.promise];case 1:return a=s.sent(),r[e[2]]=a,[2]}}))}));return function(t){return e.apply(this,arguments)}}()))]:[2,r];case 2:return o.sent(),[2,r]}}))})),function(e){return i.apply(this,arguments)}))];var i}))}))()}},{key:"onRemove",value:function(e){var t=this,n={type:"remove",callback:e};return this.removeEventListeners.add(n),function(){t.removeEventListeners.delete(n)}}},{key:"close",value:function(){var e=this;return(0,_._)((function(){var t;return(0,F.Jh)(this,(function(n){switch(n.label){case 0:if(e.isClosed)return[2];e.isClosed=!0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.databasePromise];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return t?[4,e.waitQueue.waitForCurrentRunningTasks()]:[2];case 5:return n.sent(),[4,e.waitQueue.waitUntilQuiet(10)];case 6:return n.sent(),t.close(),[2]}}))}))()}},{key:"has",value:function(e,t){var n=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(i){return[2,n.useStore((function(i){var r=i().getKey(IDBKeyRange.only(n.generateKeyArray(e,t))),o=(0,j.createDeferred)();return r.onerror=function(){return o.reject(r.error)},r.onsuccess=function(){return o.resolve(!!r.result)},o.promise}))]}))}))()}},{key:"generateKeyArray",value:function(e,t){return[e.id||"",e.feature||""].concat(2===arguments.length?[t||""]:[])}},{key:"getValue",value:function(e,t,n){var i=IDBKeyRange.only(this.generateKeyArray(t,n)),r=e.get(i),o=(0,j.createDeferred)();return r.onerror=function(){return o.reject(r.error)},r.onsuccess=function(){return o.resolve(r.result)},o.promise}},{key:"getAllKeys",value:function(e,t){var n=this;return(0,_._)((function(){var i,r,o,a,s;return(0,F.Jh)(this,(function(u){switch(u.label){case 0:return i=e.getAllKeys(IDBKeyRange.lowerBound(n.generateKeyArray(t))),r=(0,j.createDeferred)(),i.onerror=function(){return r.reject(i.error)},i.onsuccess=function(){return r.resolve(i.result)},[4,r.promise];case 1:return o=u.sent(),a=t.id||"",s=t.feature||"",[2,o.filter((function(e){return e[0]===a&&e[1]===s}))]}}))}))()}},{key:"dispatchRemoveEvent",value:function(e,t){this.removeEventListeners.forEach((function(n){(0,n.callback)({context:e,key:t})}))}},{key:"dispatchChangeEvent",value:function(e){this.changeEventListeners.forEach((function(t){(0,t.callback)((0,k._)({},e))}))}}],[{key:"inject",value:function(){return{pdfViewer:RP}}}]),e}(),oP=function(){function e(){(0,P._)(this,e),(0,J._)(this,"pdfViewer",void 0)}return(0,A._)(e,[{key:"getAll",value:function(e){return this.getStorageDriverImpl().getAll(e)}},{key:"get",value:function(e,t){return this.getStorageDriverImpl().get(e,t)}},{key:"set",value:function(e,t,n){return this.getStorageDriverImpl().set(e,t,n)}},{key:"removeAll",value:function(e){return this.getStorageDriverImpl().removeAll(e)}},{key:"remove",value:function(e,t){return this.getStorageDriverImpl().remove(e,t)}},{key:"onChange",value:function(e){return this.getStorageDriverImpl().onChange(e)}},{key:"onRemove",value:function(e){return this.getStorageDriverImpl().onRemove(e)}},{key:"getStorageDriverImpl",value:function(){var e=this.pdfViewer.customs.storageDriver;if(e)return this.getStorageDriverImpl=function(){return e},e;var t=this.pdfViewer.getIoC().getInstanceByClass(rP);return this.getStorageDriverImpl=function(){return t},t}},{key:"close",value:function(){return this.getStorageDriverImpl().close()}},{key:"isClosed",get:function(){return this.getStorageDriverImpl().isClosed}}],[{key:"inject",value:function(){return{pdfViewer:RP}}}]),e}(),aP=function(){function e(){(0,P._)(this,e),(0,J._)(this,"pdfViewer",void 0),(0,J._)(this,"driverWrapper",void 0)}return(0,A._)(e,[{key:"driver",get:function(){if(this.driverWrapper.isClosed)throw new Error("Unable to execute storage operations after the driver has been closed!");return this.driverWrapper}},{key:"getAll",value:function(e){var t=this;return(0,_._)((function(){var n;return(0,F.Jh)(this,(function(i){return n=t.getContext(e),[2,t.driver.getAll(n)]}))}))()}},{key:"get",value:function(e,t){var n=this;return(0,_._)((function(){var i;return(0,F.Jh)(this,(function(r){return i=n.getContext(e),[2,n.driver.get(i,t)]}))}))()}},{key:"set",value:function(e,t,n){var i=this;return(0,_._)((function(){var r;return(0,F.Jh)(this,(function(o){return r=i.getContext(e),[2,i.driver.set(r,t,n)]}))}))()}},{key:"remove",value:function(e,t){var n=this;return(0,_._)((function(){var i;return(0,F.Jh)(this,(function(r){return i=n.getContext(e),[2,n.driver.remove(i,t)]}))}))()}},{key:"removeAll",value:function(e){var t=this;return(0,_._)((function(){var n;return(0,F.Jh)(this,(function(i){return n=t.getContext(e),[2,t.driver.removeAll(n)]}))}))()}},{key:"getContext",value:function(e){return{feature:e,id:this.pdfViewer.getInstanceId(),pdfViewer:this.pdfViewer}}},{key:"onChange",value:function(e){return this.driver.onChange((function(t){e((0,k._)({},t))}))}},{key:"onRemove",value:function(e){return this.driver.onRemove((function(t){e((0,k._)({},t))}))}},{key:"destroy",value:function(){if(!this.driverWrapper.isClosed)return this.driver.close()}}],[{key:"inject",value:function(){return{pdfViewer:RP,driverWrapper:oP}}}]),e}(),sP="bookmark-added-event",uP="bookmark-deleted-event",cP="bookmark-moved-event",lP="bookmark-properties-updated-event",dP=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),e=t.apply(this,arguments),(0,J._)((0,w._)(e),"pdfViewer",void 0),(0,J._)((0,w._)(e),"rootBookmarksPromise",void 0),(0,J._)((0,w._)(e),"permissionStore",new j.ValueStore(!1)),(0,J._)((0,w._)(e),"bookmarkChildrenStore",new j.ValueStore),(0,J._)((0,w._)(e),"bookmarkDataMap",new Map),(0,J._)((0,w._)(e),"currentCutBookmarkNodeInfo",void 0),(0,J._)((0,w._)(e),"pasteBookmarkStore",new j.ValueStore),(0,J._)((0,w._)(e),"pdfDocDefer",new j.Defer),(0,J._)((0,w._)(e),"eventEmitter",new Bs.EventEmitter),(0,J._)((0,w._)(e),"updateDestination",e.setDestination),e}return(0,A._)(n,[{key:"allInjected",value:function(){var e=this;this.addDestroyHook(this.pdfViewer.addEventListener(de.willCloseDocument,(function(){e.rootBookmarksPromise=void 0,e.pdfDocDefer=new j.Defer,e.bookmarkDataMap.clear(),e.pasteBookmarkStore.remove(),e.clearCutBookmark()})),this.pdfViewer.addEventListener(de.openFileSuccess,(function(t){e.pdfDocDefer.resolve(t);var n=t.checkPermission(Qt.assemble);e.permissionStore.dispatch(!!n)})),this.pdfViewer.addEventListener(de.permissionChanged,(function(){var t=e.pdfViewer.getCurrentPDFDoc();if(t){var n=t.checkPermission(Qt.assemble);e.permissionStore.dispatch(!!n)}})));var t=this.pdfViewer.getCurrentPDFDoc();t&&this.pdfDocDefer.resolve(t)}},{key:"onPermissionChange",value:function(e){return this.permissionStore.subscribe(e)}},{key:"onBookmarkChildrenReloaded",value:function(e){return this.bookmarkChildrenStore.subscribe((function(t){if(t)return e(t.parentId,t.children)}))}},{key:"reloadBookmarkChildren",value:function(e){var t=this;return(0,_._)((function(){var n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return void 0===e&&(t.rootBookmarksPromise=t.getBookmarkChildren(e)),[4,t.getBookmarkChildren(e)];case 1:return n=i.sent(),[4,t.bookmarkChildrenStore.dispatch({parentId:e,children:n})];case 2:return i.sent(),[2]}}))}))()}},{key:"getBookmarkChildren",value:function(e){var t=this;return(0,_._)((function(){var n,i,r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:return[4,t.getBookmarkAPI()];case 1:return(n=a.sent())?[4,n.getBookmarkChildren(e)]:[2,[]];case 2:return i=a.sent(),r=i.map((function(e){var n=t.bookmarkDataMap.get(e.id),i=(0,k._)({},n||{},e);return t.bookmarkDataMap.set(e.id,i),i})),e&&(o=t.bookmarkDataMap.get(e))&&(r.length>0&&(o.hasChild=!0),o.children=r),[2,r]}}))}))()}},{key:"getBookmarkData",value:function(e){return this.bookmarkDataMap.get(e)}},{key:"getParentBookmarkId",value:function(e){var t=Array.from(this.bookmarkDataMap.values()).find((function(t){var n;return!!(null===(n=t.children)||void 0===n?void 0:n.find((function(t){return t.id===e})))}));return null==t?void 0:t.id}},{key:"getFirstLevelBookmarks",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){return[2,e.rootBookmarksPromise=e.rootBookmarksPromise||e.getBookmarkChildren(void 0)]}))}))()}},{key:"getDestination",value:function(){var e=this;return(0,_._)((function(){var t,n,i,r,o,a,s,u,c,l,d,h,f;return(0,F.Jh)(this,(function(g){switch(g.label){case 0:if(8,t=e.pdfViewer.getPDFDocRender(),n=e.pdfViewer.getDeviceCurrentPosition(),i=n.top,r=n.left,o=n.pageIndex,r=Math.max(0,r),i=Math.max(i,Math.max(8,i))-8,!e.pdfViewer.pdfViewerRender)throw new Error("BookmarkService.getDestination failed: PDFViewer.pdfViewerRender is not defined!");return a=e.pdfViewer.getPDFPageRender(o),s=a.getScale(),u=a.getRotation(),[4,a.getPDFPage()];case 1:return c=g.sent(),l=(0,E._)(c.reverseDevicePoint([r,i],s,u),2),r=l[0],i=l[1],d=t.scale,f=0,"fitWidth"===d?h=ek.ZoomFitHorz:"fitPage"===d||"fitHeight"===d?h=ek.ZoomFitPage:"fitVisible"===d?h=ek.ZoomFitBHorz:(h=ek.ZoomXYZ,f=d),[2,{top:i,left:r,pageIndex:o,zoomMode:h,zoomFactor:f}]}}))}))()}},{key:"addBookmark",value:function(e){var t=this;return(0,_._)((function(){var n,i,r,o,a,s,u,c;return(0,F.Jh)(this,(function(l){switch(l.label){case 0:if("number"!=typeof e.destId)switch(e.relationship){case Qy.FIRST_CHILD:case Qy.LAST_CHILD:break;default:throw new Error("When destId is not defined, relationship must be 'BookmarkRelationship.FIRST_CHILD' or 'BookmarkRelationship.LAST_CHILD'")}return t.pdfViewer.getCurrentPDFDoc()?[4,t.getBookmarkAPI()]:[2];case 1:return(n=l.sent())?(i=localStorage.getItem("bookmark_default_appearance"),r=e.title||t.pdfViewer.i18n.t("sidebar.bookmark.untitled"),[4,t.getDestination()]):[2];case 2:return o=l.sent(),a=(0,k._)({},o,e.destination||{}),s=t.pdfViewer.getPDFDocRender().scale,"zoomFactor"in a||(a.zoomFactor=isFinite(s)?s:0),[4,n.insertBookmark({newBookmarkId:e.newBookmarkId,destId:e.destId,relationship:e.relationship,title:r,destination:a,color:e.color?(0,j.colorConvertor)(e.color,"int"):void 0,style:e.style})];case 3:return u=l.sent(),i?[4,n.setProperties(u,JSON.parse(i))]:[3,5];case 4:l.sent(),l.label=5;case 5:return[4,n.getBookmarkData(u)];case 6:return c=l.sent(),t.bookmarkDataMap.set(u,c),t.emitEvent(sP,{bookmarkId:u,data:c,options:e}),t.triggerDocModified(),[2,u]}}))}))()}},{key:"deleteBookmark",value:function(e){var t=this;return(0,_._)((function(){var n,i,r,o,a,s;return(0,F.Jh)(this,(function(u){switch(u.label){case 0:return[4,t.getBookmarkAPI()];case 1:return(r=u.sent())?(o=t.getParentBookmarkId(e),[4,r.remove(e)]):[2];case 2:if(!u.sent())throw new Error("Unable to delete bookmark for unknown reason!");return a=t.getBookmarkData(e),s=function(e){var n,i=t.getBookmarkData(e);i&&(null===(n=i.children)||void 0===n||n.forEach((function(e){return s(e.id)})),t.bookmarkDataMap.delete(e))},s(e),(null===(n=t.currentCutBookmarkNodeInfo)||void 0===n?void 0:n.id)!==e&&(null===(i=t.currentCutBookmarkNodeInfo)||void 0===i?void 0:i.parentId)!==e||t.clearCutBookmark(),t.reloadBookmarkChildren(o),t.emitEvent(uP,{bookmarkId:e,data:a}),t.triggerDocModified(),[2]}}))}))()}},{key:"setDestination",value:function(e,t){var n=this;return(0,_._)((function(){var i,r,o,a,s;return(0,F.Jh)(this,(function(u){switch(u.label){case 0:return[4,n.getBookmarkAPI()];case 1:return u.sent()?[4,n.getBookmarkData(e)]:[2];case 2:return i=u.sent(),r=i?{pageIndex:i.page,top:i.top,left:i.left,zoomMode:i.zoomMode,zoomFactor:i.zoomFactor}:{},t?[3,4]:[4,n.getDestination()];case 3:t=u.sent(),u.label=4;case 4:return o=(0,k._)({},r,t),[4,n.setProperties(e,{destination:o})];case 5:return a=u.sent(),(s=n.bookmarkDataMap.get(e))&&(s.page=o.pageIndex,s.top=o.top||0,s.left=o.left||0,s.zoomMode=o.zoomMode,s.zoomFactor=o.zoomFactor),[2,a]}}))}))()}},{key:"performAction",value:function(e){var t=this;return(0,_._)((function(){var n,i,r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return[4,t.getBookmarkAPI()];case 1:return(n=o.sent())?[4,n.getAction(e)]:[2];case 2:return(r=o.sent())?[3,4]:[4,n.getDestination(e)];case 3:r=o.sent(),o.label=4;case 4:return(i=r)?[4,t.pdfViewer.actionManager.get(i,t).active()]:[2];case 5:return o.sent(),[2]}}))}))()}},{key:"renameBookmark",value:function(e,t){var n=this;return(0,_._)((function(){var i,r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return[4,n.getBookmarkAPI()];case 1:return o.sent()?(i=n.bookmarkDataMap.get(e))&&i.title===t?[2]:[4,n.setProperties(e,{title:t})]:[2];case 2:return r=o.sent(),(i=n.bookmarkDataMap.get(e))&&(i.title=t),[2,r]}}))}))()}},{key:"setColor",value:function(e,t){var n=this;return(0,_._)((function(){var i,r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:return[4,n.getBookmarkAPI()];case 1:return a.sent()?(i=n.bookmarkDataMap.get(e))&&i.color===t?[2]:[4,n.setProperties(e,{color:(0,j.colorConvertor)(t,"int")})]:[2];case 2:return r=a.sent(),(i=n.bookmarkDataMap.get(e))&&(o=r.newProperties.color,i.color=void 0===o?void 0:(0,j.colorConvertor)(o,"#")),[2,r]}}))}))()}},{key:"setFontStyle",value:function(e,t){var n=this;return(0,_._)((function(){var i,r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return[4,n.getBookmarkAPI()];case 1:return o.sent()?[4,n.setProperties(e,{style:t})]:[2];case 2:return i=o.sent(),(r=n.bookmarkDataMap.get(e))&&(r.style=t),[2,i]}}))}))()}},{key:"setProperties",value:function(e,t){var n=this;return(0,_._)((function(){var i,r,o,a,s,u;return(0,F.Jh)(this,(function(c){switch(c.label){case 0:return[4,n.getBookmarkAPI()];case 1:return[4,(i=c.sent()).setProperties(e,t)];case 2:return r=c.sent(),o=r.oldProperties,a=r.newProperties,[4,i.getBookmarkData(e)];case 3:return(s=c.sent())&&n.bookmarkDataMap.set(e,s),n.rootBookmarksPromise?[4,n.rootBookmarksPromise]:[3,5];case 4:u=c.sent(),n.rootBookmarksPromise=Promise.resolve(u.map((function(e){return n.getBookmarkData(e.id)}))),c.label=5;case 5:return n.emitEvent(lP,{bookmarkId:e,oldProperties:o,newProperties:a}),n.triggerDocModified(),[2,{oldProperties:o,newProperties:a}]}}))}))()}},{key:"cutBookmark",value:function(e,t){this.currentCutBookmarkNodeInfo={id:e,parentId:t}}},{key:"clearCutBookmark",value:function(){this.currentCutBookmarkNodeInfo=void 0}},{key:"getCurrentCutBookmarkNodeInfo",value:function(){return this.currentCutBookmarkNodeInfo}},{key:"pasteCutBookmark",value:function(e,t,n){var i=this;return(0,_._)((function(){var r,o,a;return(0,F.Jh)(this,(function(s){switch(s.label){case 0:return i.currentCutBookmarkNodeInfo?(r=i.currentCutBookmarkNodeInfo,o=r.id,a=r.parentId,[4,i.moveBookmark(o,a,e,t,n)]):[2];case 1:return s.sent(),[4,i.pasteBookmarkStore.dispatch({destId:e,srcId:o,relationship:n,srcParentId:a,destParentId:t})];case 2:return s.sent(),i.clearCutBookmark(),[2]}}))}))()}},{key:"moveBookmark",value:function(e,t,n,i,r){var o=this;return(0,_._)((function(){var a,s;return(0,F.Jh)(this,(function(u){switch(u.label){case 0:return[4,o.getBookmarkAPI()];case 1:return(a=u.sent())&&o.bookmarkDataMap.get(e)?[4,a.moveTo({destId:n,srcId:e,relationship:r})]:[2];case 2:switch(u.sent(),s=[],r){case Qy.FIRST_CHILD:case Qy.LAST_CHILD:s.push(o.reloadBookmarkChildren(n));break;case Qy.FIRST_SIBLING:case Qy.LAST_SIBLING:case Qy.NEXT_SIBLING:case Qy.PREVIOUS_SIBLING:i!==t&&s.push(o.reloadBookmarkChildren(i))}return s.push(o.reloadBookmarkChildren(t)),[4,Promise.all(s)];case 3:return u.sent(),o.emitEvent(cP,{destId:n,srcId:e,relationship:r,srcParentId:t,destParentId:i}),o.triggerDocModified(),[2]}}))}))()}},{key:"onPasteCutBookmark",value:function(e){return this.pasteBookmarkStore.subscribe(e)}},{key:"getBookmarkAPI",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.pdfDocDefer.promise];case 1:return[2,t.sent().getBookmarkAPI()]}}))}))()}},{key:"onBookmarkDeleted",value:function(e){return this.registerEvent(uP,e)}},{key:"onBookmarkAdded",value:function(e){return this.registerEvent(sP,e)}},{key:"onBookmarkMoved",value:function(e){return this.registerEvent(cP,e)}},{key:"onBookmarkPropertiesUpdated",value:function(e){return this.registerEvent(lP,e)}},{key:"registerEvent",value:function(e,t){var n=this;return this.eventEmitter.on(e,t),function(){n.eventEmitter.off(e,t)}}},{key:"emitEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r;(r=this.eventEmitter).emit.apply(r,[e].concat((0,I._)(n)))}},{key:"triggerDocModified",value:function(){var e=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(t){switch(t.label){case 0:return[4,e.pdfDocDefer.promise];case 1:return[4,t.sent().setDocModified()];case 2:return t.sent(),[2]}}))}))()}}],[{key:"inject",value:function(){return{pdfViewer:RP}}}]),n}(j.Disposable);const hP={ActionCallback:{alert:function(e){var t=e.message;e.title,e.type,e.icon;return function(e,t,n,i){return new Promise((function(t){window.alert(e),t(1)}))}(t)},response:function(e){e.question,e.title,e.defaultValue,e.label,e.isPassword}}},fP={XFAAppProvider:{msgBox:function(e){var t=e.message;e.title,e.iconType,e.buttonType;return new Promise((function(e){window.alert(t),e(1)}))},response:function(e){e.question,e.title,e.defaultAnswer,e.isPassword}}};var gP=j.LoggerFactory.getLogger("ServiceWorker");var vP,pP=g(9901),mP=g.n(pP),yP=g(2843),kP=g.n(yP),bP=[".mp3",".wav",".ogg"],wP=bP.concat([".mp4",".m4a",".mov",".avi"]),_P=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e,i,r){var o;return(0,P._)(this,n),o=t.call(this),(0,J._)((0,w._)(o),"eContainer",void 0),(0,J._)((0,w._)(o),"annot",void 0),(0,J._)((0,w._)(o),"pdfViewer",void 0),(0,J._)((0,w._)(o),"$container",void 0),(0,J._)((0,w._)(o),"eventEmitter",void 0),(0,J._)((0,w._)(o),"rendition",void 0),(0,J._)((0,w._)(o),"player",void 0),(0,J._)((0,w._)(o),"blob",void 0),o.eContainer=e,o.annot=i,o.pdfViewer=r,o.pdfViewer=r,o.annot=i,o.$container=O()(o.eContainer),o.eventEmitter=new(js()),o}return(0,A._)(n,[{key:"isSupport",value:function(e){if("fileName"in e){var t=this.getFileExt(e.fileName);return Promise.resolve(wP.indexOf(t)>-1)}return Promise.resolve(!1)}},{key:"init",value:function(e){var t=this;return this.rendition=e,this.isSupport({buffer:e.buffer,fileName:e.fileName}).then((function(n){if(n){var i=t.createUrlfromData(e);t.createDom(t.getFileExt(e.fileName),i),t.updatePlayerRect()}else t.alertUnsupportMsg();return Promise.resolve()}))}},{key:"getFileExt",value:function(e){var t=e.substr(e.lastIndexOf(".")).toLowerCase();return t.indexOf("?")>0&&(t=t.substr(0,t.indexOf("?"))),t}},{key:"createUrlfromData",value:function(e){var t=e.buffer,n=e.fileName,i=e.contentType;if(!t)return n;var r=this.pdfViewer.resourceGenerator(Lf.PDF_DOCUMENT_CLOSING,Nf.OBJECT_URL).expose().URL,o=t;return this.blob=new Blob([o.buffer],{type:i}),r.createObjectURL(this.blob)}},{key:"createDom",value:function(e,t){var n=this,i="";if(bP.indexOf(e)>-1){var r=j.isMobile||j.isSafari?"":"fv__hide";this.$container.addClass(r),i=mP()({type:"audio",url:t})}else i=kP()({url:t});this.$container.append(i),this.player=this.$container[0].querySelector(".fv__player"),(j.isIE||j.isEdge)&&this.$container.addClass("IE-player");var o=this.$container[0].querySelector(".fv__close-video").parentNode;o.addEventListener("click",(function(e){n.player&&n.player.pause&&n.player.pause(),n.$container.hide(),e.stopPropagation()})),o.addEventListener("mousedown",(function(e){e.stopPropagation()})),o.addEventListener("pointerdown",(function(e){e.stopPropagation()})),o.addEventListener("touchstart",(function(e){e.stopPropagation()}));var a=function(e){n.eventEmitter.emit("play",n.annot)},s=function(e){n.eventEmitter.emit("pause",n.annot)},u=function(e){n.eventEmitter.emit("ended",n.annot)},c=function(e){e.preventDefault()};this.player.addEventListener("play",a),this.player.addEventListener("pause",s),this.player.addEventListener("ended",u),this.player.addEventListener("click",c),this.addDestroyHook((function(){n.player.removeEventListener("play",a),n.player.removeEventListener("pause",s),n.player.removeEventListener("ended",u),n.player.removeEventListener("click",c)}))}},{key:"on",value:function(e,t){var n=this;return this.eventEmitter.on(e,t),function(){return n.eventEmitter.off(e,t)}}},{key:"play",value:function(){var e=this;if(this.player)if(this.player.paused){var t=this.player.play();void 0!==t&&t.then((function(){j.isSafari&&e.player.play()})).catch((function(t){j.isSafari||(e.alertUnsupportMsg(),e.$container.remove())}))}else this.player.pause()}},{key:"pause",value:function(){this.player&&this.player.pause()}},{key:"updatePlayerRect",value:function(){var e=this.pdfViewer.getPDFPageRender(0),t=e.getScale(),n=e.getRotation(),i=this.annot.getDeviceRect(t,n);return this.player?(this.$container.css({left:i.left+"px",top:i.top+"px",width:i.right-i.left+"px",height:i.bottom-i.top+"px"}),i):i}},{key:"alertUnsupportMsg",value:function(){this.pdfViewer.viewerUI.alert({message:this.pdfViewer.i18n.t("viewer_:contextmenu.annot.noSptPlayPlsDownload_websdk"),level:"warning",isHTML:!0})}},{key:"download",value:function(){if(!this.blob)return this.alertUnsupportMsg();this.rendition&&this.rendition.fileName&&this.blob.type&&Fa(this.blob,this.rendition.fileName,this.blob.type)}}]),n}(j.Disposable),PP=function(){},AP=function(){return-1},SP="JR",xP="canvas",CP={annotRenderingMode:{square:xP,highlight:xP,caret:xP,squiggly:xP,underline:xP,strikeout:xP,choiceButton:xP,pushButton:xP,radioButton:xP,textField:xP,comboBox:xP,note:xP,fileAttachment:xP,sound:xP,freetext:xP,redact:xP},highPerformance:!1,enableSignature:!1},DP="undefined",EP={destroyCurrentDoc:!0},IP=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(r.preloadJR,r.preloadSR,r.libPath),a=r.jr,s=r.sr,u=r.i18n,c=r.i18nOptions,l=r.eventEmitter,d=void 0===l?new(js()):l,h=r.minScale,f=void 0===h?.01:h,g=r.maxScale,v=void 0===g?10:g,p=r.defaultScale,m=void 0===p?"fitWidth":p,y=r.scaleFrequency,k=void 0===y?0:y,b=r.tileSize,_=void 0===b?1e6:b,A=r.tileCache,S=void 0===A?2:A,x=r.getTileSize,C=void 0===x?null:x,D=r.StateHandlers,E=void 0===D?[]:D,T=r.customs,F=void 0===T?{}:T,M=(r.keymap,r.Viewmodes),O=void 0===M?[]:M,L=r.enableJS,N=r.enableSafeMode,V=r.stateHandlerConfig,B=r.watermarkConfig,U=r.actionOptions,H=void 0===U?{}:U,W=r.defaultViewMode,Y=void 0===W?"continuous-view-mode":W,q=r.snapshotServer,K=void 0===q?new km({uploadSnapshotAPIPath:"snapshot/upload"}):q,$=r.collaboration,z=void 0===$?{enable:!1,annotationFormat:"fdf",communicator:null,handlerClasses:[],continueToConnect:function(e,t){return e<15}}:$,G=r.highPerformance,J=void 0!==G&&G,X=r.annotRenderingMode,Z=(r.defaultKeyboardEventBinder,r.defaultAnnotConfig),ee=r.enableSignature,te=r.enableShortcutKey,ne=void 0===te||te,ie=r.enable3DInteraction,re=void 0===ie||ie,oe=r.enableLoad3DModule,ae=void 0===oe||oe,se=r.engineMode,ue=void 0===se?SP:se,ce=r.sharedWorker,le=void 0!==ce&&ce,he=r.noJSFrame,fe=void 0!==he&&he,ge=r.showCommentList,ve=void 0!==ge&&ge,pe=r.showAnnotTooltip,me=void 0!==pe&&pe,ye=r.showFormFieldTooltip,ke=void 0!==ye&&ye,be=r.showMeasurementInfoPanel,we=void 0===be||be,_e=r.viewerUI,Pe=r.applicationContext,Ae=r.instanceId,Se=r.messageSyncServiceWorker;(0,P._)(this,n),(i=t.call(this)).enableOpenAction=!0,i.enablePageAction=!0,i.ioc=Pe||new j.ApplicationContextImpl,i.keyboard=new j.KeyboardImpl,i.$constructorOptions=arguments[0],i.tileCache=Number(S)>0?!0===S?Number.MAX_VALUE:Number(S):0;var xe=i.ioc.getInstanceByClass(X_);if(!("instanceId"in arguments[0])&&xe.hasPDFViewerInstance()&&(Ae=xe.getNextInstanceId()),xe.isUsedInstanceId(Ae))throw new Error("There are already instances of PDFViewer that use this instanceId: ".concat(Ae,", please change it to other value."));if(i.instanceId=Ae,i.localStorage=new k_(Ae),i.addDestroyHook(xe.addPDFViewerInstance((0,w._)(i))),xe.isMultipleCase()&&(fe&&j.LoggerFactory.getLogger("PDFViewer").warn("There are currently multiple PDFViewer instances being constructed, the noJSFrame option is forced to false!"),fe=!1),o)if(zs(o));else{o=Ws(Us()).join(o).absolute(!1)}else o=Ws(Us()).absoluteDir();"/"!==o[o.length-1]&&(o+="/"),i.libPath=o;var Ce="jr-engine/gsdk";(a=a||{}).licenseKey=a.licenseKey||"",a.licenseSN=a.licenseSN||"",a.l=a.l||"";var De=a.workerPath||"";De?zs(De)||(De=Ks(o,De)):De=o;var Ee=a.enginePath;a.workerPath=De,a.enginePath=Ee,a.enginePath=a.enginePath||Ce,Ee?zs(Ee)||(Ee=Ks(o,Ee)):Ee=o+Ce,a.enginePath=Ee;var Ie=a.fontPath;Ie?zs(Ie)||(Ie=Ks(o,Ie)):Ie=Ks(o,"../external/brotli"),a.brotli=Object.assign({core:!0},a.brotli),a.fontPath=Ie,a.fontInfoPath&&(a.fontInfoPath=Ks(o,a.fontInfoPath)),Se=Se||{};var Re=location.href.match(/^\w+\:\/\//)?location:window.parent.location,Te=new URL(Se.syncBaseUrl||"/__foxitwebsdk-syncmsg__",Re).href;Se.syncBaseUrl=Te,Se.url=Se.url||$s(De,"MessageWorker.js")+"?b="+Te,a.syncBaseUrl=Te,i.snapshotServer=K;var Fe=(s=s||{}).workerPath||"";Fe=Fe?zs(Fe)?De:Ks(o,Fe):o,s.workerPath=Fe;var Me=(c=(0,j.extendOptions)({initOption:{ns:"viewer_"}},c)).path;Me?zs(Me)||(Me=Ks(o,Me)):Me=o+"locales",c.absolutePath=c.absolutePath||Me,i.i18n=u||Ls(c),function(e){if(!e.$$overrided){e.$$overrided=!0;var t=e.t;e.t=function(n,i){if(!n)return n;switch(void 0===n?"undefined":(0,R._)(n)){case"number":case"symbol":case"bigint":case"boolean":case"function":return n;case"string":break;default:if(!Array.isArray(n))return n}return e.exists(n,i)?t.call(e,n,i):n}}}(i.i18n),ue=ue.toUpperCase(),-1===[SP,"SR","MIX"].indexOf(ue)&&(ue=SP);var Oe={},Le=!0;switch(i.customs=Object.assign({closeDocBefore:PP,closeDocAfter:PP,getDocPermissions:AP,beforeRenderPDFDoc:PP,executeNavigationAction:PP,getAnnotComponentConfig:PP,storageDriver:void 0,cemicircleCloudy:!1,syncTextScaling:!1},F),ue){case"SR":X||(Oe=CP.annotRenderingMode),(void 0===J?"undefined":(0,R._)(J))!==DP&&J,Le=(void 0===ee?"undefined":(0,R._)(ee))!==DP&&ee,document.body.classList.add("fv__viewer-sr__"),i.pdfEngine=i.getWebPDFSR();break;case"MIX":document.body.classList.add("fv__viewer-sr__"),i.pdfEngine=i.getWebPDFSR(),i.mixPdfJREngine=i.getWebPDFJR();break;default:i.pdfEngine=i.getWebPDFJR()}var Ne=(0,w._)(i);i.actionOptions=Object.assign({remoteGotoActionInit:function(){var e=window.opener;if(e){var t=function(e){if(e.source!==window){var t=e.data,n=t.foxitSdkActionType,i=t.foxitSdkActionUrl,r=t.foxitSdkActionFileName,o=t.top,a=(t.bottom,t.left),s=(t.right,t.pageIndex),u=t.zoomFactor,c=t.zoomMode;"TypeGoToR"===n&&Ne.openPDFByHttpRangeRequest({range:{url:i}},{fileName:r}).then((function(){d.once(de.renderPageSuccess,(function(){switch(c){case"ZoomXYZ":var e=u;0===e?Ne.goToPage(s,o,a,0!==o):Ne.zoomTo(e,!1).then((function(){Ne.goToPage(s,o,a,0!==o)}));break;case"ZoomFitHorz":Ne.zoomTo("fitWidth",!1).then((function(){Ne.goToPage(s,o,a,0!==o)}));break;case"ZoomFitPage":Ne.zoomTo("fitHeight",!1).then((function(){Ne.goToPage(s,o,a,0!==o)}))}}))}))}};e.postMessage({isReady:!0},window.location.origin),window.addEventListener("message",t,!1),Ne.addDestroyHook((function(){window.removeEventListener("message",t,!1)}))}}},H),ne?i.keyboard.enable():i.keyboard.disable(),i.keyboardListeners=[];for(var Ve=i.viewModeManager=new Qs((0,w._)(i)),Be=0,je=O.length;Be<je;Be++)Ve.register(O[Be]);i.defaultAnnotConfig=Z||function(){return{}},N=void 0===N||N,i.config={sr:s,jr:a,minScale:f,maxScale:v,defaultScale:m,tileSize:_,getTileSize:C,enableJS:L,enableSafeMode:N,defaultViewMode:Y,stateHandlerConfig:V,watermarkConfig:B,scaleFrequency:k,highPerformance:!1,annotRenderingMode:Object.assign({highlight:"canvas",choiceButton:"native",pushButton:"native",textField:"native",comboBox:"native",note:"native",fileAttachment:"native",sound:"native",freetext:"native",square:"canvas"},Oe,X),enableSignature:Le,sizeCount:10,enableShortcutKey:ne,enable3DInteraction:re,enableLoad3DModule:ae,engineMode:ue,sharedWorker:le,noJSFrame:fe,printSetting:{quality:100,showHeaderFooter:!0},autoCompleteSetting:{level:"off",rememberNumericalData:!0},showCommentList:ve,showAnnotTooltip:me,showFormFieldTooltip:ke,showMeasurementInfoPanel:we,messageSyncServiceWorker:Se},i.eventEmitter=d,i.store=new j.Store,i.mementoManager=new Mm((0,w._)(i));var Ue=i.annotManager=new dg((0,w._)(i));"SR"===ue&&Ue.setViewerAnnotFlag((function(e){var t=e.getType();return-1===["text","caret","freetext","fileattachment","highlight","ink","line","circle","square","polygon","polyline","squiggly","strikeout","underline","widget","redact","stamp"].indexOf(t)?tn.locked|tn.readOnly:0})),i.actionManager=new Jg((0,w._)(i)),i.JSEngine=new nm((0,w._)(i)),i.inkSignManager=new om((0,w._)(i)),i.onlineSignManager=new sm((0,w._)(i)),i.viewerUI=_e||new oy;var He=i.stateHandlerManager=new im((0,w._)(i));i.viewerUI.prepare((0,w._)(i)),i.customRenderManager=new wm((0,w._)(i));var We=[__,A_,S_,C_,D_,E_,I_,T_,F_];(e=E).push.apply(e,(0,I._)(We));for(var Ye=0,qe=E.length;Ye<qe;Ye++)He.register(E[Ye]);return i.annotsEventMaps=[],i._annotMouseEventCallback=i._annotMouseEventCallback.bind((0,w._)(i)),i._runtimeColor=["RGB",.55,.55,1],i._runtimeColorOpacity=.5,i._runtimeColorRequired=["RGB",.55,.55,1],i._runtimeColorOpacityRequired=1,i._highlightControls=!0,i._highlightControlsUI=!0,i.lifeCycleManager=new py,i.lifeCycleManager.registerLifecycle(new Py),i.lifeCycleManager.registerLifecycle(new by((0,w._)(i))),i.lifeCycleManager.registerLifecycle(new wy((0,w._)(i))),i.lifeCycleManager.registerResourceGenerator(Nf.OBJECT_URL,_y),i.activationManager=new Q,i.collaborationOptions=z,i._collaborationDefer=(0,j.createDeferred)(),i.initializers=[new y_,new f_,new g_,new p_,new L_,new nP],i.initializers.forEach((function(e){e.execute((0,w._)(i))})),i.multimediaPlayers=[_P],i}return(0,A._)(n,[{key:"resourceGenerator",value:function(e,t){return this.lifeCycleManager.generator(e,t)}},{key:"getDefaultAnnotConfig",value:function(){return(this.webPDFJR||this.webPDFSR).getDefaultAnnotConfig()||PP}},{key:"setDefaultAnnotConfig",value:function(e){(this.webPDFJR||this.webPDFSR).setDefaultAnnotConfig(e)}},{key:"_annotMouseEventCallback",value:function(e){this.annotsEventMaps.map((function(t){t&&t(e)}))}},{key:"startListenAnnotMouseEvent",value:function(){this.cleanListenAnnotMouseEvent(),document.addEventListener("mouseup",this._annotMouseEventCallback,{capture:!0})}},{key:"stopListenAnnotMouseEvent",value:function(){this.cleanListenAnnotMouseEvent(),document.removeEventListener("mouseup",this._annotMouseEventCallback,{capture:!0})}},{key:"addListenAnnotMouseEvent",value:function(e){var t=this;return this.annotsEventMaps.push(e),function(){t.offListenAnnotMouseEvent(e)}}},{key:"offListenAnnotMouseEvent",value:function(e){for(var t=this.annotsEventMaps,n=t.length;n--;)if(t[n]===e){t.splice(n,1);break}}},{key:"cleanListenAnnotMouseEvent",value:function(){this.annotsEventMaps=[]}},{key:"changeLanguage",value:function(e){var t=this,n=eP(e);return e!==n&&(LOGGER.warn("You have entered an illegal language code: ".concat(e,", which will be automatically converted to a valid language code: ").concat(n)),e=n),new Promise((function(n,i){t.i18n.changeLanguage(e,(function(r){if(r)return i(r),void t.eventEmitter.emit("change-language-failed");t.eventEmitter.emit("change-language-success",e),n()}))}))}},{key:"getCurrentLanguage",value:function(){return this.i18n.language?this.i18n.language:this.i18n.options.fallbackLng?this.i18n.options.fallbackLng[0]:eP(navigator.language)}},{key:"takeSnapshot",value:function(e,t,n,i,r){var o=this.getPDFPageRender(e);if(!o)throw new Error("page not found: ".concat(e));return o.getSnapshot(t,n,i,r)}},{key:"uploadImage",value:function(e){var t=this;return this.snapshotServer.uploadImage(e).then((function(e){return t.snapshotServer.render,t.snapshotServer.render(e),Promise.resolve(e)})).catch((function(e){return console.warn(t.i18n.t("viewer_:error.snapshotServer")),Promise.reject(e)}))}},{key:"copySnapshot",value:function(e){isSecureContext||console.error("Access clipboard data requires a secure origin, either HTTPS or localhost.");try{return fetch(e).then((function(e){return e.blob()})).then((function(e){return navigator.clipboard.write([new ClipboardItem({"image/png":e})]).then((function(){return Promise.resolve(!0)}),(function(){return Promise.resolve(!1)}))}))}catch(e){return console.error(e),Promise.resolve(!1)}}},{key:"copyImage",value:function(e){this.copySnapshot(e)}},{key:"getKeyboardEventBinder",value:function(e){var t=this.keyboard.getBinder(e);if(!t)throw new Error("event binder not found error: ".concat(e));return t}},{key:"switchKeyboardEventBinder",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.keyboard.activeBinder(e,t)}},{key:"addKeyboardShortcutEventListener",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getDefaultKeyboardEventBinder();return(n=(0,D._)(i,mm)?i:this.keyboard.getBinder(i))?n.on(e,t):PP}},{key:"addEventListener",value:function(e,t){var n={};if(Array.isArray(e))e.forEach((function(e){n[e]=t}));else if(e&&"object"==typeof e)Object.keys(e).forEach((function(t){a(e[t]),n[t]=e[t]}));else{if("string"!=typeof e)throw new Error("Incorrect arguments: the arguments of addEventListener must be (string, Function) or (Record<string, Function>) or (Array<string, Function)");a(t),n[e]=t}var i=this.eventEmitter;for(var r in n)i.on(r,n[r]);var o=function(){for(var e in n)i.off(e,n[e])};return function(){o(),o=PP};function a(e){if("function"!=typeof e)throw new Error("Illegal argument! Event listener should be a function, but actual: "+(void 0===e?"undefined":(0,R._)(e)))}}},{key:"getDefaultKeyboardEventBinder",value:function(){return this.keyboard.getDefaultKeyboardEventBinder()}},{key:"getWebPDFJR",value:function(){var e=this;if(this.webPDFJRPromise)return this.webPDFJRPromise;var t=(0,j.createDeferred)();return Promise.resolve().then(g.bind(g,302)).then((function(n){var i=new(n.default(gw))(e.config.jr,e.eventEmitter,{storage:e.getDeprecatedStorage(),configuration:{annotation:{cemicircleCloudy:e.customs.cemicircleCloudy,syncTextScaling:e.customs.syncTextScaling}}});e.webPDFJR=i;var r="viewer_:error.initEngine.c2";return i.setDefaultAnnotConfig(e.defaultAnnotConfig),i.init().then((function(e){return e})).then((function(n){var o,a,s,u,c,l=n.other,d={"viewer  component":{version:ay},"core component":{version:n.version},JR:{version:!0}};if(l){var h=location.href,f=!0;if(l.h){f=!1;for(var g=l.h,v=g.length;v--;){var p=g[v];if(new RegExp(p).test(h)){f=!0;break}}}if(!f)return e.viewerUI.alert(r),void t.reject(new Error("failed to initialize WebPDF JR Engine"));var m=Date.now(),y=l.b;if(y&&!(f=m>y))return e.viewerUI.alert(r),void t.reject(new Error("failed to initialize WebPDF JR Engine"));var k=l.e;if(k&&!(f=m<k))return e.viewerUI.alert(r),void t.reject(new Error("failed to initialize WebPDF JR Engine"));if(!f)return e.viewerUI.alert(r),void t.reject(new Error("failed to initialize WebPDF JR Engine"))}return n.clientId&&(o=e.config.messageSyncServiceWorker,a=n.clientId,s=e.customs.syncMsg,c=Object.assign({},hP,fP,s),"serviceWorker"in navigator&&((o.registration?Promise.resolve(o.registration):navigator.serviceWorker.register(o.url,Object.assign({scope:"/"},o.options))).then((function(e){u=e}),(function(e){gP.warn("Your service worker registration has failed, potentially resulting in the inability to utilize features like XFA and 3D. Please confirm whether your current environment supports service workers, and double-check the configuration of the scope option and Service-Worker-Allowed response header. Original reason: ",e)})),navigator.serviceWorker.addEventListener("message",(function(e){if(u&&(e.source===u.installing||e.source===u.waiting||e.source===u.active)){var t=e.data||{};if(t.clientId===a){var n=t.type,i=c[n],r=t.action;if(i&&i[r]){var o=t.id;Promise.resolve(i[r](t.data)).then((function(t){e.source.postMessage({id:o,data:t})}),(function(t){e.source.postMessage({id:o,error:t})}))}}}})))),console.table&&console.table(d),e.eventEmitter.emit(de.jrLicenseSuccess),e.getModuleLicenseRight(),t.resolve(i)}),(function(n){e.isDestroyed||e.viewerUI.alert(e.i18n.t("viewer_:error.initEngine.c"+n||0)),t.reject(n)})),i})),this.webPDFJRPromise=t.promise}},{key:"getWebPDFSR",value:function(){var e=this;return this.webPDFSRPromise?this.webPDFSRPromise:this.webPDFSRPromise=Promise.resolve().then(PP.bind(null,g)).catch(PP).then((function(t){var n=new(t.default(gw))(e.config.sr,e.eventEmitter,{storage:e.storage});return e.webPDFSR=n,n.setDefaultAnnotConfig(e.defaultAnnotConfig),n.init().then((function(){var t={"viewer  component":{version:ay},SR:{version:!0}};console.table&&console.table(t),e.isWebPDFSR=!0,e.scaleFrequency=4,e.config.scaleFrequency=4,e.eventEmitter.emit(de.srLicenseSuccess)}),(function(t){alert(e.i18n.t(["viewer_:error.initEngine.c1","viewer_:error.initEngine.c2"][t-1]||"viewer_:error.c-1"))})),n}))}},{key:"initAnnotationIcons",value:function(e){var t=this,n=arguments;Array.isArray(e)&&(e=e.reduce((function(e,t,n){var i=t.annotType||"stamp",r=t.category,o=t.name;if(!r)throw new Error("Missing category for icon at ".concat(n,": ").concat(JSON.stringify(t,null,2)));if(!o)throw new Error("Missing name for icon at ".concat(n,": ").concat(JSON.stringify(t,null,2)));var a=e[i]=e[i]||{},s=a[r]=a[r]||{},u={url:t.url,fileType:t.fileType,width:t.width>0?t.width:150,height:t.height>0?t.height:45};return s[o]=u,e}),{}));var i=e.stamp;return i&&Object.keys(i).forEach((function(e){OP({key:"category",value:e,notSpecialChar:!0}),Object.keys(i[e]).forEach((function(e){return OP({key:"name",value:e,notSpecialChar:!0})}))})),this.pdfEngine.then((function(t){return t.setIcons(e)})).then((function(i){return!n[1]&&t.eventEmitter.emit(de.iconInited,e)}))}},{key:"addAnnotationIcon",value:function(e){var t=this;if(["url","annotType","fileType"].forEach((function(t){if(!e[t])throw new Error("Icon property lost: "+t)})),OP({key:"category",value:e.category,notSpecialChar:!0}),OP({key:"name",value:e.name,notSpecialChar:!0}),0==["png","bmp","jpg","jpeg","pdf"].filter((function(t){return e.fileType.toLowerCase()==t})).length)throw new Error("The fileType is wrong");return e.fileType=e.fileType.toLowerCase(),this.pdfEngine.then((function(t){return t.addIcon(e)})).then((function(n){n&&t.eventEmitter.emit(de.iconAdded,e)}))}},{key:"removeAnnotationIcon",value:function(e,t,n){var i=this;t||(n=null);var r=arguments[3];return this.pdfEngine.then((function(i){return i.removeIcon(e,t,n,r)})).then((function(o){return i.eventEmitter.emit(de.iconRemoved,{type:e,category:t,name:n,index:r})}))}},{key:"init",value:function(e){var t=this;this.$ui=O()(e),this.element=this.eUi=this.$ui.get(0);var n,i=this.viewModeManager.get(this.config.defaultViewMode);(this.pdfViewerRender=new As(this.$ui,i,this),this.collaborationOptions)&&(this.collaborationOptions.enable?this.initCollaboration():this._collaborationDefer.resolve(null));n="function"!=typeof this.customs.getAnnotPermissions?function(){return Ie}:this.customs.getAnnotPermissions,this.annotationAuthorityManager=new e_(this,n),this.actionCallbackManager=new tP(this);var r,o=function(){t.annotationAuthorityManager.clear()},a=this;this.progressHandler=(r=(0,_._)((function(e,t,n){var i;return(0,F.Jh)(this,(function(e){switch(e.label){case 0:return a.progressHandler.status||n!==Rm.PROGRESSING?[3,4]:a.progress?[3,2]:[4,a.viewerUI.progress(t,document.body)];case 1:return a.progress=e.sent(),[3,3];case 2:a.progress.show(document.body),a.progress.updateProgress(t,n),e.label=3;case 3:return a.progressHandler.status="start",[3,5];case 4:a.progress&&a.progress.updateProgress(t,n),n!==Rm.FAIL&&n!==Rm.SUCCESS||(i=setTimeout((function(){a.progress&&a.progress.hide()}),500),a.addDestroyHook((function(){clearTimeout(i)})),delete a.progressHandler.status),e.label=5;case 5:return[2]}}))})),function(e,t,n){return r.apply(this,arguments)});var s,u=function(e,n,i){t.progressHandler(e,n,i)};this.eventEmitter.on(de.openFileSuccess,o),this.eventEmitter.on(de.progressChanged,u),this.addDestroyHook((function(){t.annotationAuthorityManager.destroy(),t.eventEmitter.off(de.openFileSuccess,o),t.eventEmitter.off(de.progressChanged,u)}));var c=function(){clearTimeout(s),s=setTimeout((function(){var e=t.getAllActiveElements();if(e.length){var n=t.stateHandlerManager.currentStateHandler.getStateName();if(!(n!==Zn&&n!=mn&&Object.keys(li).indexOf(n)<0&&Object.keys(di).indexOf(n)<0)){var i=!e.find((function(e){var t=e.annot;if(!t)return!1;var n=t.getType(),i=!!t.isArea&&t.isArea();return"highlight"===n&&!i||"strikeout"===n||"underline"===n||"squiggly"===n||"caret"===n}));e.forEach((function(e){var t=e.shapeControl;t&&t.moveEnable&&t.moveDisable&&(i&&t.moveable?t.moveEnable():t.moveDisable())}))}}}),0)};this.eventEmitter.on(de.activeElementChanged,c),this.addDestroyHook((function(){return t.eventEmitter.off(de.activeElementChanged,c)}))}},{key:"setAnnotPermissionCallback",value:function(e){this.customs.getAnnotPermissions=e,this.annotationAuthorityManager.setAnnotPermissionCallback(e)}},{key:"getCollaboration",value:function(){return this._collaborationDefer.promise}},{key:"getAnnotAuthorityManager",value:function(){return this.annotationAuthorityManager}},{key:"getActionCallbackManager",value:function(){return this.actionCallbackManager}},{key:"collaborate",value:function(e,t){return this.getCollaboration().then((function(n){if(n)return("function"==typeof t?Promise.resolve(t()):Promise.resolve(t)).then((function(t){return n.send({action:e,data:t})}))}))}},{key:"initCollaboration",value:function(){var e=new Ow(this,this.collaborationOptions);e.registerBuiltInHandler(Bw),e.registerBuiltInHandler(Nw),e.registerBuiltInHandler(Vw),e.registerBuiltInHandler(t_),e.registerBuiltInHandler(zw),e.registerBuiltInHandler(Gw),e.registerBuiltInHandler(Jw),e.registerBuiltInHandler(n_),e.registerBuiltInHandler(Xw),e.registerBuiltInHandler(i_),e.registerBuiltInHandler($w),e.registerBuiltInHandler(Yw),e.registerBuiltInHandler(qw),e.registerBuiltInHandler(Kw),e.registerBuiltInHandler(w_),this.addDestroyHook((function(){e.destroy()})),e.prepare(),this._collaborationDefer.resolve(e)}},{key:"redraw",value:function(e){var t=this,n=arguments;return this.pdfViewerRender&&this.pdfViewerRender.pdfDocRender?(this.redrawTask||Promise.resolve()).then((function(i){var r=t.pdfViewerRender.pdfDocRender;try{var o=r.pagesRender;if(!o)return Promise.resolve(!1);e&&o.setRenderFlags(7);var a=[],s=n[1];return void 0===s&&(s=!0),s?(t.getScrollWrap().disable(1),t.store.dispatch("force-redraw",!0),a.push(t.zoomTo(o.scale,null,0).finally((function(){t.store.dispatch("force-redraw",!1)})))):a.push(o.renderVisiblePages()),t.redrawTask=Promise.all(a).then((function(e){t.getScrollWrap().disable(0),o.renderVisiblePages()})).finally((function(){delete t.redrawTask}))}catch(e){return Promise.reject(e)}})):Promise.resolve(!1)}},{key:"redrawContent",value:function(){if(!this.pdfViewerRender||!this.pdfViewerRender.pdfDocRender)return Promise.resolve(!1);try{var e=this.pdfViewerRender.pdfDocRender.pagesRender;return e.setRenderFlags(2),e.renderVisiblePages()}catch(e){return Promise.reject(e)}}},{key:"rotateTo",value:function(e,t){return(0,j.assertThat)((0,j.isValidRotationAngle)(e),"Incorrect rotation degree: ".concat(e,", It should be 0, 90, 180 or 270")),this.pdfViewerRender.rotateTo(e,t)}},{key:"getRotation",value:function(){return this.pdfViewerRender.getRotation()}},{key:"getScrollWrap",value:function(){return this.pdfViewerRender.scrollWrap}},{key:"openPDFByFile",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pdfEngine;if(this.customs.isSupportFileType&&!this.customs.isSupportFileType(e))return Promise.reject();n.isOpenNewFileAfterClose&&this.currentPDFDoc&&this.currentPDFDoc.otherOptions&&(this.currentPDFDoc.otherOptions.isOpenNewFileAfterClose=!0);var r=(0,k._)({},EP,n);return this.openFileOptions=r,e.name&&!r.fileName&&(r.fileName=e.name),void 0===r.isRenderOnDocLoaded&&(r.isRenderOnDocLoaded=!0),"function"!=typeof r.beforeRenderPDFDoc&&(r.beforeRenderPDFDoc=this.customs.beforeRenderPDFDoc),this.close().then((function(){var n=t.resourceGenerator(Lf.PDF_DOCUMENT_CLOSING,Nf.OBJECT_URL).expose().URL;return t.eventEmitter.emit(de.beforeOpenFile,n.createObjectURL(new Blob([e],{type:"application/pdf"}))),i?Promise.resolve(i):t.getWebPDFJR()}),(function(e){return j.LoggerFactory.getLogger("PDFViewer").warn("An error occurred while opening a pdf file: ",e),Promise.reject({error:-3})})).then((function(n){t.eventEmitter.emit(de.beforeLoadPDFDoc,"memory",e,r,i);var o=n.getPDFDocByFile(e,r);return r.isRenderOnDocLoaded&&t.pdfViewerRender.rendering(),o})).then((function(n){return t._reopenPDFDoc(n,r,{type:Sw.FROM_FILE,fileName:r.fileName,file:e,options:r})}),(function(e){return t.eventEmitter.emit(de.openFileFailed,e),Promise.reject(e)})).finally((function(){r.isRenderOnDocLoaded&&t.pdfViewerRender.rendered()}))}},{key:"openPDFByHttpRangeRequest",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fileName:""},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pdfEngine,r=(0,k._)({},EP,n);this.openFileOptions=r;var o=e.range.url;if(!r.fileName&&o.endsWith(".pdf")){var a=o.lastIndexOf("/"),s=o.substring(a+1);s=decodeURIComponent(s),r.fileName=s}if(void 0===r.isRenderOnDocLoaded&&(r.isRenderOnDocLoaded=!0),"function"!=typeof r.beforeRenderPDFDoc&&(r.beforeRenderPDFDoc=this.customs.beforeRenderPDFDoc),!zs(o)){var u=Us();e.range.url=Ws(u).join(o).absolute()}return this.close().then((function(){var e;return t.eventEmitter.emit(de.beforeOpenFile,o),e=i?Promise.resolve(i):t.getWebPDFJR(),r.isRenderOnDocLoaded&&t.pdfViewerRender.rendering(),e}),(function(e){throw e})).then((function(n){return t.eventEmitter.emit(de.beforeLoadPDFDoc,"http",e,r,i),n.getPDFDocByHttpRangeRequest(e,r)})).then((function(n){return t._reopenPDFDoc(n,r,{type:Sw.FROM_URL,range:e.range,size:e.size,options:r})}),(function(e){throw t.eventEmitter.emit(de.openFileFailed,e),e})).finally((function(){r.isRenderOnDocLoaded&&t.pdfViewerRender&&t.pdfViewerRender.rendered()}))}},{key:"getPDFDocByFileNoOpen",value:function(e){var t=this;return(0,_._)((function(){var n,i;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:return o=(0,_._)((function(e){var t,n,i=arguments;return(0,F.Jh)(this,(function(r){switch(r.label){case 0:t=i.length>1&&void 0!==i[1]?i[1]:"",n=i.length>2&&void 0!==i[2]?i[2]:{},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.parse((0,b._)((0,k._)({},n),{password:t}))];case 2:return r.sent(),[2,e];case 3:return[2,r.sent()];case 4:return[2]}}))})),n=function(e){return o.apply(this,arguments)},[4,t.getWebPDFJR()];case 1:return[4,r.sent().getPDFDocByFile(e)];case 2:return i=r.sent(),[4,n(i)];case 3:return[2,r.sent()]}var o}))}))()}},{key:"openPDFById",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fileName:""};return void 0===n.isRenderOnDocLoaded&&(n.isRenderOnDocLoaded=!0),this.close().then((function(){var e;return t.eventEmitter.emit(de.beforeOpenFile),e=t.getWebPDFSR(),n.isRenderOnDocLoaded&&t.pdfViewerRender.rendering(),e}),(function(e){throw e})).then((function(e){return Promise.all([e,TP(n)])})).then((function(i){var r=(0,E._)(i,2),o=r[0],a=r[1];return n.idJWT=a||n.jwt,t.eventEmitter.emit(de.beforeLoadPDFDoc,"id",e,n),o.getPDFDocById(e,n)})).then((function(e){return t._reopenPDFDoc(e,n)}),(function(e){return t.eventEmitter.emit(de.openFileFailed,e),Promise.reject(e)})).finally((function(){n.isRenderOnDocLoaded&&t.pdfViewerRender.rendered()}))}},{key:"openPDFByExistsDocId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fileName:""},n=this;return(0,_._)((function(){var i,r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:return[4,n.getWebPDFJR()];case 1:return[4,a.sent().getPDFDocById(e)];case 2:return[4,a.sent().getDocBuffer(n)];case 3:return i=a.sent(),r=new Blob(i),o=new File([r],"".concat(t.fileName),{type:"application/pdf"}),[2,n.openPDFByFile(o,t)]}}))}))()}},{key:"createNewDoc",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"untitled.pdf",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{height:842,width:595},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{isRenderOnDocLoaded:!0},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.pdfEngine;void 0===r.isRenderOnDocLoaded&&(r.isRenderOnDocLoaded=!0);var a=(0,k._)({},EP,r);return this.openFileOptions=a,this.close().then((function(){return o?Promise.resolve(o):e.getWebPDFJR()}),(function(e){return e||(e=new Error("An unknown error occurred while closing the current opening document!")),e.error=-3,Promise.reject(e)})).then((function(e){return e.createNewDoc(t,n,i)})).then((function(n){return r.password=Fe,r.fileName=t,e.reopenPDFDoc(n,r,{type:Sw.FROM_FILE,options:r,file:function(){var e=[];return n.getStream((function(t){e.push(t)})).then((function(){return new Blob(e,{type:"application/pdf"})}))}})}))}},{key:"loadPDFDocByFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getPDFDocParserService().loadPDFDocByFile(e,t)}},{key:"loadPDFDocByHttpRangeRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getPDFDocParserService().loadPDFDocByHttpRangeRequest(e,t)}},{key:"createNewPortfolioDoc",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Portfolio.pdf";return this.close().then((function(){return n.pdfEngine?Promise.resolve(n.pdfEngine):n.getWebPDFJR()}),(function(e){return e||(e=new Error("An unknown error occurred while closing the current opening document!")),e.error=-3,Promise.reject(e)})).then((function(n){return n.createNewPortfolioDoc(e,t,i)})).then((function(e){var t={isRenderOnDocLoaded:!0,password:"",fileName:i};return n.reopenPDFDoc(e,t,{type:Sw.FROM_FILE,options:t,file:function(){var t=[];return e.getStream((function(e){t.push(e)})).then((function(){return new Blob(t,{type:"application/pdf"})}))}})}))}},{key:"convertImageToPDFDoc",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"untitled.pdf",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=(arguments.length>5&&void 0!==arguments[5]||this.pdfEngine,[]),a=null,s=(0,D._)(e,ArrayBuffer),u=null;return new Promise((function(n,i){var r=new Image;if(r.onload=function(){var e=(0,j.getDPI)(),t=r.width/e.x*72,i=r.height/e.y*72;n(o=[t,i])},r.onerror=function(){i(new Error("The input file could not be loaded as an supported image."))},s){var a=new Blob([e]);r.src=u=URL.createObjectURL(a)}else r.src=e?u=URL.createObjectURL(e):t})).then((function(e){return n.createNewDoc(i,r,{height:e[1],width:e[0]},{isRenderOnDocLoaded:!1},n.pdfEngine)})).then((function(e){return(a=e).getPageByIndex(0)})).then((function(n){var i=s?Promise.resolve(e):Ns(e?u:t);return Promise.all([Promise.resolve(n),i])})).then((function(e){var t=(0,E._)(e,2),n=t[0],i=t[1];u&&URL.revokeObjectURL(u);var r={left:0,top:o[1],right:o[0],bottom:0};return n.addImage(i,r)})).then((function(e){if(e)return a;throw new Error("faied to insert image")})).catch((function(e){return n.eventEmitter.emit(de.openFileFailed,null),e&&console.error(e),Promise.reject(e)}))}},{key:"getPDFDocFromImageFile",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"untitled.pdf",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=[],a=null,s=(0,D._)(e,ArrayBuffer),u=null;return new Promise((function(n,i){var r=new Image;if(r.onload=function(){var e=(0,j.getDPI)(),t=r.width/e.x*72,i=r.height/e.y*72;n(o=[t,i])},r.onerror=function(){i(new Error("The input file could not be loaded as an supported image."))},s){var a=new Blob([e]);r.src=u=URL.createObjectURL(a)}else r.src=e?u=URL.createObjectURL(e):t})).then((function(e){return n.pdfEngine.then((function(t){return t.createNewDoc(i,r,{height:e[1],width:e[0]})}))})).then((function(e){return(a=e).getPageByIndex(0)})).then((function(n){var i=s?Promise.resolve(e):Ns(e?u:t);return Promise.all([Promise.resolve(n),i])})).then((function(e){var t=(0,E._)(e,2),n=t[0],i=t[1];u&&URL.revokeObjectURL(u);var r={left:0,top:o[1],right:o[0],bottom:0};return n.addImage(i,r)})).then((function(e){if(e)return a;throw new Error("faied to insert image")})).catch((function(e){return e&&console.error(e),Promise.reject(e)}))}},{key:"renderDoc",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.config.defaultScale;if(this.pdfViewerRender.pdfDocRender){var i=this.pdfViewerRender.pdfDocRender.pagesRender;if(e==this.currentPDFDoc&&i&&i.isPageDOMsLoaded)return Promise.resolve(!0)}return this.pdfViewerRender.rendering(),this.pdfViewerRender.renderDoc(e,n).then((function(){return t.eventEmitter.emit(de.openFileSuccess,e,{type:Sw.FROM_FILE,options:{fileName:e.info.fileName}}),t.eventEmitter.emit(de.renderFileSuccess,e),!0}),(function(n){return t.eventEmitter.emit(de.renderFileFailed,e),n||(n=new Error("An unknown error occurred while closing the current opening document!")),n.error=-3,Promise.reject(n)})).finally((function(){t.pdfViewerRender.rendered()}))}},{key:"reopenPDFDoc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},t),i=arguments[2];return this.eventEmitter.emit(de.beforeOpenFile),void 0===n.isRenderOnDocLoaded&&(n.isRenderOnDocLoaded=!0),this._reopenPDFDoc(e,n,i)}},{key:"_reopenPDFDoc",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;this.startListenAnnotMouseEvent();var r=!1,o=!1,a=!1!==n.isRenderOnDocLoaded,s=n.beforeRenderPDFDoc;if("function"!=typeof s){var u=this.customs.beforeRenderPDFDoc;s="function"!=typeof u?PP:u}return s!==PP&&(a=!0),Promise.resolve(TP(n)).then((function(t){return n.idJWT=t||n.jwt,e.parse(n)})).then((function(e){var n=e.getPageCount(),u=n<2;if((u=u||n>=500)&&t.viewModeManager.get(ua.getName()))t.viewModeManager.switchTo(ua.getName());else{var c=t.viewModeManager.get(t.config.defaultViewMode);t.viewModeManager.switchTo(c.getName())}t.currentPDFDoc=e,r=!0;var l=[e];if(a){t.eventEmitter.once(de.renderPageSuccess,(function(){o=!0}));var d=Promise.resolve(s.call(t,e)).then((function(){var n=t.pdfViewerRender.renderDoc(e);return t.eventEmitter.emit(de.openFileSuccess,e,i),n}));l.push(d)}return Promise.all(l)}),(function(n){t.currentPDFDoc=null;var i={error:n&&n.code,pdfDoc:e,encryptDict:n&&n.encryptDict};return t.eventEmitter.emit(de.openFileFailed,i),Promise.reject(i)})).then((function(e){var i,r=(0,E._)(e,1)[0];return t.mixPdfJREngine?t.mixPdfJREngine.then((function(e){return i=e,r.resetEngineInstance(e)})).then((function(e){return t.pdfEngine=i,delete t.mixPdfJREngine,t.eventEmitter.emit(de.toggleEngineSr2JrSuccess,e),a&&t.eventEmitter.emit(de.renderFileSuccess,e),e}),(function(e){return i&&(t.pdfEngine=i),n.isRenderOnDocLoaded&&t.eventEmitter.emit(de.renderFileSuccess,e),e})):(a&&t.eventEmitter.emit(de.renderFileSuccess,r),r)}),(function(n){if(r&&o)return t.eventEmitter.emit(de.renderFileSuccess,e),e;a&&t.eventEmitter.emit(de.renderFileFailed,e);var i={error:-1,pdfDoc:e};try{var s,u,c="number";(void 0===n?"undefined":(0,R._)(n))===c?s=n:(0,R._)(n.error)===c?(s=n.error,u=n.encryptDict):s=n,i={error:s,pdfDoc:e,encryptDict:u}}catch(e){}return Promise.reject(i)}))}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.customs.closeDocBefore,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.customs.closeDocAfter,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this;return(0,_._)((function(){var r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:return i.stopListenAnnotMouseEvent(),i.currentPDFDoc?(r=Object.assign({},i.openFileOptions,n),[4,i.JSEngine.waitForExecutionTask()]):[2,Promise.resolve()];case 1:return o.sent(),[2,Promise.resolve(e(i.currentPDFDoc,r)).then((function(e){if(!1===e)return Promise.reject("Document cannot be closed because it was rejected by the before callback");i.stopFormDesginerAssist(),i.activationManager.clear(),i.eventEmitter.emit(de.willCloseDocument,i.currentPDFDoc),i.currentPDFDoc=null;var t,n=i.pdfViewerRender.closeOldDocRender(r);try{t=i.pdfViewerRender.pdfDocRender}catch(e){}return t?(t.hidden(),n.then((function(e){return i.pdfViewerRender.closeOldDocRender(r)}))):n})).then((function(e){if(!1!==e)return t()}))]}}))}))()}},{key:"destroy",value:function(){var e=this,t=this;return(0,_._)((function(){var i,r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:if(t.isDestroyed)return[2,Promise.resolve()];a.label=1;case 1:return a.trys.push([1,13,,14]),[4,t.close()];case 2:return a.sent(),[4,t.JSEngine.destroy()];case 3:if(a.sent(),(0,S._)((0,x._)(n.prototype),"destroy",e).call(t),t.initializers&&t.initializers.forEach((function(e){return e.destroy()})),t.keyboard.destroy(),t.stopListenAnnotMouseEvent(),t.viewerUI.destroy(),t.viewerUI=null,t.pdfViewerRender&&(t.pdfViewerRender.destroy(),t.pdfViewerRender=null),!t.pdfEngine)return[3,8];i=t.webPDFJR,a.label=4;case 4:return a.trys.push([4,6,,7]),[4,t.pdfEngine];case 5:return i=a.sent(),[3,7];case 6:return a.sent(),[3,7];case 7:i&&i.api&&i.api.workerPromise&&i.api.workerPromise.destroy(),a.label=8;case 8:t.store.destroy(),r=t.getStorage(),a.label=9;case 9:return a.trys.push([9,11,,12]),[4,r.destroy()];case 10:return a.sent(),[3,12];case 11:return o=a.sent(),console.error("destroy storage error",o),[3,12];case 12:return t.eventEmitter.removeAllListeners(),t.ioc.destroy(),[3,14];case 13:throw a.sent();case 14:return[2]}}))}))()}},{key:"zoomTo",value:function(e,t){if("number"==typeof e){if(e<this.config.minScale)throw new Error("scale must be greater than minimum scale: ".concat(this.config.minScale,", which is specified in the PDFViewer constructor parameters"));if(e>this.config.maxScale)throw new Error("scale must be less than or equal to maximum scale: ".concat(this.config.maxScale,", which is specified in the PDFViewer constructor parameters"))}try{var n=arguments[2];return void 0===n&&(n=1),n&&this.activeElement(),"pencilStateHandler"==this.getStateHandlerManager().currentStateHandler.getStateName()&&this.stateHandlerManager.switchTo(),this.pdfViewerRender.zoomTo(e,t)}catch(e){return Promise.reject(e)}}},{key:"zoomAtPosition",value:function(e,t){if("number"==typeof e){if(e<this.config.minScale)throw new Error("scale must be greater than minimum scale: ".concat(this.config.minScale,", which is specified in the PDFViewer constructor parameters"));if(e>this.config.maxScale)throw new Error("scale must be greater than maximum scale: ".concat(this.config.maxScale,", which is specified in the PDFViewer constructor parameters"))}return this.activeElement(),this.pdfViewerRender?this.pdfViewerRender.zoomAt(e,t):Promise.resolve()}},{key:"zoom",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.25;try{return this.pdfViewerRender.getScaleRatio().then((function(n){var i=e.config.minScale,r=e.config.maxScale;n===i&&Math.floor(i/t)!==i/t&&(n=Math.floor(n/t)*t);var o=Math.max(i,Math.min(r,n+t));return o=i+Math.round((o-i)/t)*t,o=Math.max(i,Math.min(r,o)),e.zoomTo(o)}))}catch(e){return Promise.reject(e)}}},{key:"goToPage",value:function(e,t,n){var i=this,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!this.pdfViewerRender)return Promise.reject("PDFViewer has not been initialized completely!");var o=this.getPDFPageRender(e);return o?r&&"number"!=typeof t?o.getPDFPage().then((function(o){return t=o.getHeight(),i.pdfViewerRender.goToPage(e,t,n,r)})):this.pdfViewerRender.goToPage(e,t,n,r):Promise.reject('The page with index "'.concat(e,'" does not exists or the document has not been opened!'))}},{key:"setLayerNodeVisible",value:function(e,t){return this.pdfViewerRender&&this.pdfViewerRender.setLayerNodeVisible(e,t)}},{key:"setEnableJS",value:function(e){this.JSEngine.setEnableJS(e,this.currentPDFDoc),this.eventEmitter.emit(de.changeEnableJS,e)}},{key:"getEnableJS",value:function(){return this.JSEngine.getEnableJS()}},{key:"setContinuousAddPencilState",value:function(e){this.continuousAddPencil=e}},{key:"setEnableOpenAction",value:function(e){this.enableOpenAction=e}},{key:"setEnablePageAction",value:function(e){this.enablePageAction=e}},{key:"setEnableScale",value:function(e){this.enableScale=e}},{key:"getEnableScale",value:function(){return"boolean"!=typeof this.enableScale||this.enableScale}},{key:"setSafeReadingMode",value:function(e){this.config.enableSafeMode=e}},{key:"getSafeReadingMode",value:function(){return this.config.enableSafeMode}},{key:"getSmartScale",value:function(e){var t=this.config,n=t.scaleFrequency;return 0===n?e*=j.dpr:e=Math.ceil(e*j.dpr*n)/n,Math.min(Math.max(e,t.minScale*j.dpr),t.maxScale*j.dpr)}},{key:"controlStateSwitch",value:function(e){this.pdfViewerRender&&this.pdfViewerRender.controlStateSwitch(e)}},{key:"getStateHandlerManager",value:function(){return this.stateHandlerManager}},{key:"getInkSignManager",value:function(){return this.inkSignManager}},{key:"getOnlineSignManger",value:function(){return this.onlineSignManager}},{key:"getViewModeManager",value:function(){return this.viewModeManager}},{key:"getMementoManager",value:function(){return this.mementoManager}},{key:"getEventEmitter",value:function(){return this.eventEmitter}},{key:"getCurrentPDFDoc",value:function(){return this.currentPDFDoc}},{key:"getPDFViewerRender",value:function(){try{return this.pdfViewerRender}catch(e){return null}}},{key:"getDeviceCurrentPosition",value:function(){var e=this.getPDFDocRender(),t=this.getPDFViewerRender(),n=t.getViewMode(),i=e.getViewMode(),r=e.viewerRender.scrollWrap,o=r.getScrollTop(),a=r.getScrollLeft(),s=i.getCurrentPageIndex();if("single-page-view-mode"===n.getName()){var u=t.$ui.parent()[0].getBoundingClientRect(),c=e.getPDFPageRender(s).$ui.get(0).getBoundingClientRect();return{pageIndex:s,left:u.left-c.left,top:u.top-c.top}}for(var l=e.$container.find(".fv__pdf-view-mode-item"),d=0,h=0,f=0;f<l.length;f++){var g=l[f],v=O()(g).find(".fv__pdf-page-layout"),p=v.width(),m=v.height(),y=g.offsetTop,k=y+m,b=g.offsetLeft;if(k>o&&b+p>a){h=o-y,d=a-b;break}}return{pageIndex:s,left:d,top:h}}},{key:"getPDFDocRender",value:function(){try{return this.pdfViewerRender.pdfDocRender||null}catch(e){return null}}},{key:"getPDFPageRender",value:function(e){try{return this.pdfViewerRender.pdfDocRender.getPDFPageRender(e)||null}catch(e){return null}}},{key:"getAnnotRender",value:function(e,t){try{return this.getPDFPageRender(e).getAnnotRender(t)||null}catch(e){return null}}},{key:"getPDFPageRenderAsync",value:function(e){try{return this.pdfViewerRender.pdfDocRender.getPDFPageRender(e)}catch(e){return null}}},{key:"getAnnotRenderAsync",value:function(e,t){try{return this.getPDFPageRenderAsync(e).getAnnotRender(t)}catch(e){return null}}},{key:"killFocus",value:function(){return Promise.resolve(this.activeElement()||!0)}},{key:"isMultiSelectActive",value:function(){var e=this.stateHandlerManager.currentStateHandler.getStateName();return(j.isMac?j.keyboardStatus.isWinDown:j.keyboardStatus.isCtrlDown)&&(e===mn||e===Zn||Object.keys(li).indexOf(e)>=0||Object.keys(di).indexOf(e)>=0)||j.keyboardStatus.isShiftDown&&(e===mn||e===Zn)}},{key:"bindMultiSelectActiveEvents",value:function(e){var t=this,n=function(e){if(e&&!e.multiSelectEventBindInitialized&&(e.multiSelectEventBindInitialized=!0,e.shapeControl)){var n=e.shapeControl,i=n.onPrestart,r=n.onAfterEnd;n.onPrestart=function(e,r,o){t.activationManager.getAllCurrentActivatables().forEach((function(e){if(e.shapeControl&&!e.shapeControl.isDisabled){var i=t.customs,r=i.isCollaborationMode,o=void 0===r?PP:r,a=i.isAnnotOwner,s=void 0===a?PP:a;o()&&!s(e.annot.getName())||n.companion(e.shapeControl)}})),i&&i(e,r,o)},n.onAfterEnd=function(e){n.clearCompanions(),r&&r(e)}}};(0,D._)(e,Z)?e.getAllActivations().forEach((function(e){return n(e)})):n(e)}},{key:"activePageElementByRect",value:function(e,t){var n,i=this;if(!(e.right<=e.left||e.top<=e.bottom)&&t){var r=t.getIndex(),o=null===(n=this.getPDFPageRender(r))||void 0===n?void 0:n.annotsRender;t.getAnnots().then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.length){var n=new Z,r=[],a=[],s={},u=[];if(t.forEach((function(e){if(e.isGrouped&&e.isGrouped()){var t=e.getGroupHeader(),n=t.id;return s[n]||o.isAnnotHidden(t)||u.push(t),void(s[n]=t)}"popup"==e.getType()||"watermark"==e.getType()||"R"==e.info.RT&&e.info.IRT||o.annotFiltered&&!o.showAnnots.has(e.id)||o.isAnnotHidden(e)||u.push(e)})),u.reverse().forEach((function(t){if(!r.find((function(e){return e===t}))){var o=t.info.rect,s=o.left,u=o.right,c=o.top,l=o.bottom;if(s>=e.left&&s<=e.right&&c>=e.bottom&&c<=e.top||s>=e.left&&s<=e.right&&l>=e.bottom&&l<=e.top||u>=e.left&&u<=e.right&&c>=e.bottom&&c<=e.top||u>=e.left&&u<=e.right&&l>=e.bottom&&l<=e.top)if(t.isGrouped&&t.isGrouped()){var d=t.getGroupElements()||[];if(d.length){var h=new Z;d.forEach((function(e){var t=i.getAnnotRender(e.getPDFPage().getIndex(),e.getId()).component;t&&h.add(t)})),n.add(h),r=(0,I._)(r).concat((0,I._)(d))}}else if("widget"===t.getType())a.push(t);else{var f=i.getAnnotRender(t.getPDFPage().getIndex(),t.getId()).component;f&&n.add(f)}}})),a.length)i.eventEmitter.emit("active-widgets-for-multi-select",{widgets:a,activationGroup:n});else{i.bindMultiSelectActiveEvents(n),i.activationManager.active(n),i.getPDFDocRender().setCurrentAnnotHandler(),i.eventEmitter.emit(de.activeElementChanged);var c=n.getAllActivations().map((function(e){var t=e.getPDFPage().getIndex(),n=e.getPDFAnnot().getId();return i.getAnnotRender(t,n)}));if(c.length){if(1===c.length)return i.eventEmitter.emit(de.activeAnnotation,c[0]);i.eventEmitter.emit(de.activeMultipleAnnotations,c)}}}}))}}},{key:"activateElement",value:function(e){return this.activeElement(e)}},{key:"activeElement",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e){var n,i;if(null===(i=this.getPDFDocRender())||void 0===i||null===(n=i.formRender)||void 0===n||n.blurControl(),!this.activationManager.hasActivations())return;return this.activationManager.unActiveCurrent(),void(t&&this.eventEmitter.emit(de.activeElementChanged))}if(this.bindMultiSelectActiveEvents(e),this.isMultiSelectActive()){var r,o=this.activationManager.getCurrentActivatable();if(o){var a=(o.activations||[])[0];a&&a.annot&&a.annot.page.getIndex()!==((0,D._)(e,Z)?e.getAllActivations()[0]:e).annot.page.getIndex()&&this.activationManager.unActiveCurrent(),this.bindMultiSelectActiveEvents(o),o.add(e),r=o}else{var s=new Z;s.add(e),r=s}if(j.keyboardStatus.isShiftDown){var u=r.getAllActivations(),c=Number.MAX_VALUE,l=-Number.MAX_VALUE,d=-Number.MAX_VALUE,h=Number.MAX_VALUE;u.forEach((function(e){var t=e.annot.info.rect,n=t.left,i=t.right,r=t.top,o=t.bottom;c=Math.min(c,n),l=Math.max(l,i),d=Math.max(d,r),h=Math.min(h,o)}));var f={left:c,right:l,top:d,bottom:h};if(this.multiSelectActiveShiftHandlerFlag==="".concat(JSON.stringify(f),"_").concat(u.length))return;this.multiSelectActiveShiftHandlerFlag="".concat(JSON.stringify(f),"_").concat(u.length);var g=(0,D._)(e,Z)?e.getAllActivations()[0]:e;this.activePageElementByRect(f,g.annot.page)}else this.activationManager.active(r),this.getPDFDocRender().setCurrentAnnotHandler(),this.eventEmitter.emit(de.activeElementChanged)}else{var v;if((0,D._)(e,Z))v=e;else{var p=new Z;p.add(e),v=p}this.activationManager.active(v),this.getPDFDocRender().setCurrentAnnotHandler(),this.eventEmitter.emit(de.activeElementChanged,e)}}},{key:"clearMultiSelectActiveFlag",value:function(){this.multiSelectActiveShiftHandlerFlag=""}},{key:"deactivateElement",value:function(e){return this.unActiveElement(e)}},{key:"unActiveElement",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e&&e.annot&&e.annot.isGrouped&&e.annot.isGrouped()){var n=this.activationManager.getCurrentActivatable();if(!n||!(0,D._)(n,Z))return;for(var i=n.activations||[],r=i.length;r--;){var o=i[r];if((0,D._)(o,Z)&&o.contains(e)||o===e){this.activationManager.unActive(i[r]);break}}}else this.activationManager.unActive(e);t&&this.eventEmitter.emit(de.activeElementChanged)}},{key:"getCurrentActivatable",value:function(){var e=this.activationManager.getCurrentActivatable();if(!e||e.isActive)return e}},{key:"getAllActivatedElements",value:function(){return this.getAllActiveElements()}},{key:"getAllActiveElements",value:function(){return this.activationManager.getAllCurrentActivatables()}},{key:"getAnnotManager",value:function(){return this.annotManager}},{key:"registerMatchRule",value:function(e){this.annotManager.registerMatchRule(e)}},{key:"setUserConfig",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pdfEngine;return(t?Promise.resolve(t):this.getWebPDFJR()).then((function(t){return t.setUserConfig(e)}))}},{key:"setUserName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pdfEngine;return(t?Promise.resolve(t):this.getWebPDFJR()).then((function(t){return t.setUserName(e)}))}},{key:"getUserName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pdfEngine;return(e?Promise.resolve(e):this.getWebPDFJR()).then((function(e){return e.getUserName()}))}},{key:"setFormatOfDynamicStamp",value:function(e,t){return this.getWebPDFJR().then((function(n){return n.setDynamicInfoFormula(e,t)}))}},{key:"getFormatOfDynamicStamp",value:function(){return this.getWebPDFJR().then((function(e){return e.getDynamicInfoFormula()}))}},{key:"registerPrintHandler",value:function(e){if("function"!=typeof e)throw new TypeError("Callback type error");this.printHandler=e}},{key:"printByProgress",value:function(e,t,n,i,r,o,a,s,u,c){var l,d,h,f=this,g=this;return u||(d=this.pdfViewerRender.pdfDocRender,h=d.getFormRender(),l=h.getFormatedData("display")),(t.AdditionalActions?Promise.resolve():t.loadAdditionalActions()).then((function(e){return u?Promise.resolve():(d.performAction(5),f.eventEmitter.emit(de.documentWillPrint),t.PDFForm.addTask())})).then((function(e){return u?Promise.resolve():t.getPDFForm().setFieldsValue(l,!0)})).then((function(){return i({state:"start",total:e.length}),e.reduce((function(t,n){var o=n;return("object"==typeof n&&void 0!==n.rect||"object"==typeof n)&&(o=n.pageIndex),t.then((function(e){return Promise.all([v(n),e])})).then((function(t){var n=(0,E._)(t,2),a=n[0],s=n[1];return i({state:"progress",pageIndex:o,total:e.length,imageURI:a}),a?Promise.all([s,a,r.appendImage(a)]):Promise.resolve([s])})).then((function(e){var t=(0,E._)(e,2),n=t[0],i=t[1];return i&&n.push({pageIndex:o,imageURI:i}),n}))}),Promise.resolve([]))})).then((function(e){if(u)return Promise.resolve(e);if(h){var n=h.getFormatedData("value");return t.getPDFForm().setFieldsValue(n,!1).then((function(t){return e}))}return e})).then((function(t){var n=t.reduce((function(e,t){var n=t.pageIndex,i=t.imageURI;return e[n]=i,e}),{});if(i({state:"end",total:e.length,result:n}),u){var o,a=r.getImageCache();(o=s).push.apply(o,(0,I._)(a)),r.clearImageCache()}else r.print(!c),d.performAction(6);return f.eventEmitter.emit(de.documentDidPrint),n}));function v(e){var i=void 0!==e.pageIndex?e.pageIndex:e;return t.getPageByIndex(i).then((function(r){if(!r.isVirtual()){var s=0,u=0,c=0,l=0,d=0;if(void 0!==e.pageIndex){var h=g.getPDFPageRender(i),f=e.rect,v=r.reverseDeviceRect({top:f.y,bottom:f.y+f.height,left:f.x,right:f.x+f.width},h.getScale(),h.getRotation());s=(v=r.getDeviceRect(v)).left,u=v.top,c=(v.right-v.left)*(3/4),l=(v.bottom-v.top)*(3/4)}else if("number"==typeof e)if((c=r.getWidth())>(l=r.getHeight())){d=90;var p=c;c=l,l=p}else d=0;var m=4*o/300;return r.getPageBitmap(m,d,{x:s*(o/100),y:u*(o/100),width:c*m,height:l*m},a,"print").then((function(e){var i=e.buffer,o=e.width,a=e.height,s=e.image;if(s)return n.createObjectURL(s);var u=document.createElement("canvas"),c=r.getWidth()*m,l=a*r.getWidth()*m/o;u.width=c,u.height=l;var d=u.getContext("2d"),h=d.createImageData(o,a);h.data.set(new(Uint8ClampedArray||Uint8Array)(i)),d.putImageData(h,0,0),d.drawImage(d.canvas,0,0,o,a,0,0,c,l);var f=(0,j.createDeferred)();try{t.isXFA().then((function(e){e?f.resolve(u.toDataURL()):u.toBlob((function(e){f.resolve(n.createObjectURL(e))}),"image/png")}))}catch(e){f.reject(e)}return f.promise}))}}))}}},{key:"print",value:function(e){var t=e.isPortfolio,n=e.rangeType,i=e.pages,r=void 0===i?[]:i,o=e.printType,a=void 0===o?["page"]:o,s=e.progress,u=e.printer,c=e.showHeaderFooter,l=void 0===c?this.getPrintSetting("showHeaderFooter"):c,d=e.quality,h=void 0===d?this.getPrintSetting("quality")||100:d,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:PP,g=this;return(0,_._)((function(){var e,i,o,c,d,v,p,m,y,k,b,w,_,P,A,S,x,C,D;return(0,F.Jh)(this,(function(E){switch(E.label){case 0:if(!(e=g.currentPDFDoc).checkPermission(Qt.print|Qt.printHigh))throw new Error("Permission denied!");return i="object"==typeof s,o=void 0===s||!0===s,c=g.resourceGenerator(Lf.PDF_DOCUMENT_CLOSING,Nf.OBJECT_URL),d=c.expose().URL,v=f,p=0,f=function(e){switch(e.state){case"start":i?(s.show(),s.updateProgress({current:0,total:e.total},Rm.PROGRESSING)):o&&g.eventEmitter.emit(de.progressChanged,"print",{current:0,total:e.total},Rm.PROGRESSING);break;case"progress":i?s.updateProgress({current:p++,total:e.total},Rm.PROGRESSING):o&&g.eventEmitter.emit(de.progressChanged,"print",{current:p++,total:e.total},Rm.PROGRESSING);break;case"end":i?(s.updateProgress({current:p++,total:e.total},Rm.SUCCESS),setTimeout((function(){s.hide()}),0)):o&&g.eventEmitter.emit(de.progressChanged,"print",{current:p++,total:e.total},Rm.SUCCESS),p=0}v(e)},u||(u=g.printer||(g.printer=new yw)),(m=g.currentPDFDoc.pdfPortfolio&&t?g.currentPDFDoc.pdfPortfolio.root.nodeHandle:"")&&t?"allPDF"!=n?[3,2]:[4,g.currentPDFDoc.pdfPortfolio.getFolioNodePDFDoc()]:[3,10];case 1:return y=E.sent(),[3,4];case 2:return"selectedPDF"!=n?[3,4]:[4,g.currentPDFDoc.pdfPortfolio.getActivedPDFFileByPortFolioNode()];case 3:k=E.sent(),y=k,E.label=4;case 4:for(P in w=[],_=[],y)_.push(P);A=0,E.label=5;case 5:return A<_.length?(S=_[A],[4,y[S].parse()]):[3,9];case 6:for(E.sent(),b=y[S].getPageCount(),x=[],C=0;C<b;C++)x.push(C);return D=y[S],[4,g.printByProgress(x,D,d,f,u,h,a,w,m,l)];case 7:E.sent(),E.label=8;case 8:return A++,[3,5];case 9:return u.print(!l,w),[2];case 10:return[4,g.printByProgress(r,e,d,f,u,h,a,[],m,l)];case 11:return E.sent(),[2]}}))}))()}},{key:"printCurrentView",value:function(){var e=this.getPDFDocRender().getBoundingClientRects();if(!(e.length>1)){var t=e.map((function(e){return{rect:{x:e.x,y:e.y,width:e.width,height:e.height},pageIndex:e.index}}));this.print({pages:t,printType:["page","annot"]})}}},{key:"printEx",value:function(e){var t=this,n=e.type,i=e.pageRange,r=e.progress,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:PP,a=this.currentPDFDoc;if(!a.checkPermission(Qt.print|Qt.printHigh))throw new Error("Permission denied!");var s="object"==typeof r,u=void 0===r||!0===r,c=o;o=function(e){switch(e.state){case"start":s?(r.show(),r.updateProgress(0,Rm.PROGRESSING)):u&&t.eventEmitter.emit(de.progressChanged,"printEx",0,Rm.PROGRESSING);break;case"progress":s?r.updateProgress(e.progress,Rm.PROGRESSING):u&&t.eventEmitter.emit(de.progressChanged,"printEx",e.progress,Rm.PROGRESSING);break;case"end":s?(r.updateProgress(e.progress,Rm.SUCCESS),setTimeout((function(){r.hide()}),0)):u&&t.eventEmitter.emit(de.progressChanged,"printEx",e.progress,Rm.SUCCESS)}c(e)};var l=a.getPageCount();var d=this.viewerUI;var h=function(e,t){var n=function(e,t){var n=[],i=e,r=new RegExp(/[^\d\-,]/);if(r.test(i))e=i.slice(0,i.length-1);else{if(!(r=new RegExp(/[^\d]/)).test(i.substr(0,1))){for(var o=i.split(","),a=0;a<o.length;a++){var s=o[a];if(s.indexOf("-")>-1){var u=(0,E._)(s.split("-"),3),c=u[0],l=u[1];if(u[2]||""===l)return;var d=Math.min(+c,+l),h=Math.max(+c,+l);if(d<1)return;if(h>t)return h+="",void(e=i.slice(0,i.length-h.length)+t);n.push([d-1,h-1])}else{if(s<1)return;if(s>t)return void(e=i.slice(0,i.length-s.length)+t);n.push([s-1,s-1])}}return n}e=i.slice(0,i.length-1)}}(e,t)||[];if(!(n.length<1)){var i,r=[];return n.sort((function(e,t){return e[0]-t[0]})).forEach((function(e){if(r.length<1)return r.push(e),void(i=e);var t=e[0],n=e[1],o=i[1];t>=o?t>o+1?(r.push(e),i=e):i[1]=n:n>o&&(i[1]=n)})),r}d.alert({message:"dialog.error.validateRange",level:"warning"})}(i,l),f={type:n,range:h,reverse:!1,bleed:!1,useWorkFlow:!0},g=function(e){o(e.msg)};a.api.registerWorkflow("printEx",g);var v=this.pdfViewerRender.pdfDocRender;return(a.AdditionalActions?Promise.resolve():a.loadAdditionalActions()).then((function(e){v.setPrintState(!0),v.performAction(5),t.eventEmitter.emit(de.documentWillPrint)})).then((function(e){a.PDFForm.addTask((function(e){return a.extractPrintPages(f).then((function(e){if(e){var n={printable:e=window.btoa(e),type:"pdf",base64:!0};"function"==typeof t.printHandler?(f={data:n.printable,type:Number(f.type),range:f.range},t.printHandler(f)):O_()(n)}v.performAction(6),t.eventEmitter.emit(de.documentDidPrint),v.setPrintState(!1),a.api.unregisterWorkflow("printEx",g)}))}),!0)}))}},{key:"printPDFDocumentEx",value:function(e){var t=e.startIndex,n=void 0===t?0:t,i=e.endIndex,r=void 0===i?this.currentPDFDoc.getPageCount()-1:i;return r>this.currentPDFDoc.getPageCount()-1&&(r=this.currentPDFDoc.getPageCount()-1),this.printEx({type:1,pageRange:n+1+"-"+(r+1)})}},{key:"printPDFDocument",value:function(e){e.asImage;var t=e.endIndex,n=void 0===t?this.currentPDFDoc.getPageCount()-1:t,i=e.printType,r=void 0===i?["page"]:i,o=(e.reverse,e.shrinkToFit,e.silent,e.startIndex),a=void 0===o?0:o,s=(e.ui,e.rangeType),u=e.total,c=(void 0===u&&this.currentPDFDoc.getPageCount(),e.progress),l=void 0===c?this.printProgress:c,d=e.fromToArray,h=e.hideHeaderFooter,f=void 0===h?!this.getPrintSetting("showHeaderFooter"):h,g=e.quality,v=void 0===g?this.getPrintSetting("quality")||100:g,p=e.isPortfolio,m=[];if("assign"===s)for(var y=0;y<d.length;y++)if(d[y][0]===d[y][1])m.push(d[y][0]-1);else for(var k=d[y][0];k<=d[y][1];k++)m.push(k-1);else{n>this.currentPDFDoc.getPageCount()-1&&(n=this.currentPDFDoc.getPageCount()-1);for(var b=a;b<=n;b++)m.push(b)}return this.print({isPortfolio:p,rangeType:s,pages:m,printType:r,showHeaderFooter:!f,quality:v,progress:l})}},{key:"highlightControls",value:function(){return this._highlightControls}},{key:"highlightControlsUI",value:function(){return this._highlightControlsUI}},{key:"setHighlightControlsUI",value:function(e){this._highlightControlsUI=e}},{key:"getDisplayHighlightColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"HTML";return t>1&&(t=1),(0,j.colorConvertor)(e,n,t)}},{key:"highlightForm",value:function(e){if(this.pdfViewerRender){var t=this.pdfViewerRender.pdfDocRender;if(this.setHighlightControlsUI(e),t){var n=t.formRender;n&&n.setRuntimeHighlight(e)}return this.eventEmitter.emit(de.setFromFieldHighlight,e),this._highlightControls=e}}},{key:"getFormHighlightColor",value:function(){return{color:(0,j.colorConvertor)(this._runtimeColor,"int",this._runtimeColorOpacity),colorRequired:(0,j.colorConvertor)(this._runtimeColorRequired,"int",this._runtimeColorOpacityRequired)}}},{key:"setFormHighlightColor",value:function(e,t){var n=.5,i=1;(j.isChrome||j.isFirefox)&&(n=1),"number"==typeof e&&(n=(4278190080&e)>>>24,n/=255,this._runtimeColorOpacity=n,e&=16777215),"number"==typeof t?(i=(4278190080&t)>>>24,i/=255,this._runtimeColorOpacityRequired=i,t&=16777215):t=e;var r=this.pdfViewerRender.pdfDocRender;if(r){var o=r.formRender;o&&o.setRuntimeHighlightColor(e,n,t,i)}this._runtimeColor=e,this._runtimeColorRequired=t}},{key:"getStore",value:function(){return this.store}},{key:"getStorage",value:function(){return this.getIoC().getInstanceByClass(aP)}},{key:"getDeprecatedStorage",value:function(){return this.localStorage}},{key:"setJRFontMap",value:function(e){return this.getWebPDFJR().then((function(t){return t.setFontMap(e)}))}},{key:"setJRWatermarkFontMap",value:function(e){return this.getWebPDFJR().then((function(t){return t.setWatermarkFontMap(e)}))}},{key:"pasteAnnot",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=this.stateHandlerManager.getCurrentStates();if(r){var o=r.getStateName();if("edit-all"===o||"add-path-object"===o||"add-text-object"===o)return}if(e&&t&&!t.isVirtual()){var a=e.isCutAnnot,s=void 0!==a&&a,u=e.annotId;return this.currentPDFDoc.getPageByIndex(e.pageIndex).then((function(e){if(s){var t=[];if(n.cutAnnot&&n.cutAnnot.getId()===u){var i=n.cutAnnot;n.cutAnnotInfo&&n.cutAnnotInfo.objectNumber===u&&(i.info=(0,k._)({},n.cutAnnotInfo),n.cutAnnotInfo=null),t.push(i)}return Promise.resolve(t)}return e.getAnnotsByObjectNumArray([u])})).then((function(e){if(e.length){if(s){var r=(0,k._)({},e[0].getInfo());n.cutAnnot=null;var o=e[0].getRect(),a=o.right-o.left,u=o.top-o.bottom;return o.left=i.x,o.top=i.y,o.right=i.x+a,o.bottom=i.y-u,r.rect=(0,k._)({},o),r.isCutPasteCreate=!0,t.addAnnot(r)}return t.pasteAnnot(e[0],i)}})).then((function(e){if(e.length>0){var i=e[0],r=function(){return n.eventEmitter.emit(de.addAnnotSuccess,i)};if(s){var o=n.getAnnotRender(t.getIndex(),i.getId()).getComponent();n.copy([o])}var a=n.customs,u=a.isCollaborationMode,c=void 0===u?PP:u,l=a.getUserName,d=void 0===l?PP:l;if(c()){var h=d();h!==i.getTitle()?i.setTitle(h).finally(r):r()}else r()}return e})).catch(PP)}}},{key:"pasteImage",value:function(e,t){var n=this;window.URL=window.URL||window.webkitURL;var i=window.URL.createObjectURL(t),r=O()("<img style='opacity:0' />");r.on("load",(function(t){e=e.then((function(e){return n.getPDFDocRender().getViewBoxCenter(!1)})).then((function(e){var t=(0,E._)(e,2),o=t[0],a=t[1];if(o.isVirtual())throw new Error("Cannot paste image to virtual page!");var s,u,c=n.pdfViewerRender.pdfDocRender.getPDFPageRender(o.getIndex()),l=c.getRotation();90===l||270===l?(s=r.height(),u=r.width()):(s=r.width(),u=r.height());var d={left:a[0]-s/2,top:a[1]-u/2,right:a[0]+s/2,bottom:a[1]+u/2};d=o.reverseDeviceRect(d,c.scale,l);var h=new XMLHttpRequest;h.open("get",i),h.responseType="arraybuffer";var f=(0,j.createDeferred)();return h.onloadend=function(e){return f.resolve(h.response)},h.send(),Promise.all([o,f.promise,d,l])})).then((function(e){var t=(0,E._)(e,4),n=t[0],i=t[1],r=t[2],o=t[3];return n.addImage(i,r,o)})).then((function(e){window.URL.revokeObjectURL(i),r.remove()})).catch((function(){window.URL.revokeObjectURL(i),r.remove()}))})),r.attr("src",i),O()("body").append(r)}},{key:"paste",value:function(e){var t=this;e||(e=JSON.parse(vP));var n=Promise.resolve(),i=function(e){var i=e.text,r=void 0===i?"":i,o=(e.value,[]);switch(e.type){case"html":o=jd.formatRichText(e.value);break;case"string":r=e.value}var a=t.stateHandlerManager.getCurrentStates();if(a&&"hand"!==a.getStateName())return;n=n.then((function(e){var n=t.getPDFDocRender().getViewMode().getCurrentPageIndex();return t.currentPDFDoc.getPageByIndex(n)})).then((function(e){if(!e.isVirtual()){var n=e.getWidth()/2,i=e.getHeight()/2,a=t.getPDFDocRender().getPDFPageRender(e.getIndex()),s={left:n,top:i,right:n+12,bottom:i-12};return e.addAnnot({type:Hi.freeText,intent:"FreeTextTypewriter",subject:"FreeTextTypewriter",contents:r,defaultAppearance:o.length?{}:{textColor:0,textSize:12},rect:s,rotation:((360-90*e.getRotation()-a.getRotation())%360+360)%360,richText:o.length?o:null}).then((function(e){t.eventEmitter.emit(de.addAnnotSuccess,e[0])}))}})).catch(PP)};this.pastPositionInfo&&this.pastPositionInfo.times++;var r=function(n){var i=t.getPDFDocRender();return i?i.getViewBoxCenter().then((function(i){var r=(0,E._)(i,2),o=r[0],a=r[1];t.pastPositionInfo&&t.pastPositionInfo.pageIndex===o.getIndex()&&t.pastPositionInfo.pos.toString()===a.toString()||(t.pastPositionInfo={pageIndex:o.getIndex(),pos:a,times:0});var s=1e4,u=-1,c=-1,l=1e4;e.forEach((function(e){if("string"===e.type){var t=e.value;if(t.type){var n=t.rect;s=Math.min(n.left,s),u=Math.max(n.right,u),c=Math.max(n.top,c),l=Math.min(n.bottom,l)}}}));var d=u-s,h=c-l,f=o.getWidth(),g=o.getHeight(),v={x:a[0]+(5*t.pastPositionInfo.times-d/2),y:a[1]-(5*t.pastPositionInfo.times+h/2)};if(v.x+d>f){var p=f-d;v.x=p<0?0:f-d}if(v.y-h<0){var m=g-h;v.y=m<0?g:h}return[o,{x:v.x+n.left-s,y:v.y-(c-n.top)}]})):Promise.resolve({x:0,y:0})};this.pasteTimes++;var o={left:1e4,right:-1,top:-1,bottom:1e4},a=0,s=0;e[0]&&"string"===e[0].type&&e[0].value.graphicObject&&function(){e.forEach((function(e){if("string"===e.type){var n=e.value;if(n.doc&&n.graphicObject&&t.currentPDFDoc.id===n.doc){var i=n.rect;o.left=Math.min(i.left,o.left),o.right=Math.max(i.right,o.right),o.top=Math.max(i.top,o.top),o.bottom=Math.min(i.bottom,o.bottom)}}})),a=o.top-o.bottom,s=o.right-o.left;var n=Object.assign({},o);n.top-=a*t.pasteTimes,n.top<0?(t.pasteNeedRestart=!0,t.pasteRestartTimes?t.pasteRestartTimes++:t.pasteRestartTimes=1):(t.pasteNeedRestart=!1,t.pasteRestartTimes=-1)}();var u=[],c=[],l=[];if(e.forEach((function(e){if("string"===e.type)try{var d=e.value;if("number"==typeof d)return void i(e.value);d.type?"widget"===d.type?u.push(r(d.rect).then((function(e){var t=(0,E._)(e,2);return[t[0],t[1],d]}))):n=n.then((function(e){return r(d.rect).then((function(e){var n=(0,E._)(e,2),i=n[0],r=n[1];if(!i.isVirtual())return t.pasteAnnot(d,i,r).then((function(e){var t;return e&&(t=l).push.apply(t,(0,I._)(e)),l}))}))})):d.doc&&d.graphicObject&&t.currentPDFDoc.id===d.doc?c.push((f=d.rect,g=d.page,t.currentPDFDoc.getPageByIndex(g).then((function(e){var n=e.getHeight(),i=Math.abs(o.top)-Math.abs(f.top),r=Math.abs(o.left)-Math.abs(f.left),u=Object.assign({},o);return u.top-=a*t.pasteTimes,u.bottom-=a*t.pasteTimes,t.pasteNeedRestart&&(n-t.pasteRestartTimes*a<0&&(t.pasteRestartTimes=0),u.top=n-t.pasteRestartTimes*a,u.bottom=u.top-a,u.left=0,u.right=s),[e,{top:u.top-i,bottom:u.top-i-(f.top-f.bottom),left:u.left-r,right:u.left-r+(f.right-f.left)}]}))).then((function(e){var t=(0,E._)(e,2);return[t[0],t[1],d]}))):i(e)}catch(e){0}else if("file"===e.type){var h=e.value;if(!h)return;/^image.*/.test(h.type)?t.pasteImage(n,h):n=n.then((function(n){return t.currentPDFDoc.attachFile(e.blob)})).catch(PP)}else"html"===e.type&&i(e);var f,g})),u.length){var d=this.currentPDFDoc.PDFForm;n=n.then((function(e){return Promise.all(u).then((function(e){var t=e[0][0];if(!t.isVirtual()){var n=e.map((function(e){var t=(0,E._)(e,3),n=(t[0],t[1]),i=t[2],r=d.getField(i.fieldName);if(r){var o=r.getControlById(i.srcObjectNumber);if(o){i.type=i.fieldType,delete i.fieldType;var a=i.rect,s=Object.assign({},i,{rect:{left:n.x,top:n.y,right:n.x+(a.right-a.left),bottom:n.y-(a.top-a.bottom)}}),u=r.getType();return u!==gn.CheckBox&&u!==gn.RadioButton||(s.isChecked=o.info.isChecked),s}}})).filter((function(e){return!!e}));return d.copyControls(null,t,n).then((function(e){return n.forEach((function(e){var t=d.getField(e.fieldName);if(t){var n=t.getType();if(n===gn.ComboBox||n===gn.Text){var i=t.getDisplayValue();i&&t.showDisplayValue(i)}}})),e}))}}))}))}return c.length&&(n=n.then((function(e){return Promise.all(c).then((function(e){if(!e[0][0].isVirtual()){var t=e.map((function(e){var t=(0,E._)(e,3),n=t[0],i=t[1],r=t[2];return n.pasteGraphicObject(r.graphicObject,r.page,i)}));return Promise.all(t).then((function(e){return e}))}}))}))),n.then((function(e){if(t.activeElement(),Array.isArray(e)&&(0,D._)(e[0],hy)){var n=e[0].getPDFPage().getIndex(),i=new Z,r=t.getPDFPageRender(n);e.forEach((function(e){var n=new(t.addon.graphicsManager.get(e))(e,r,t.addon);i.add(n)})),t.activeElement(i)}return e}))}},{key:"copy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=document.activeElement.tagName.toLowerCase();if("textarea"!==n&&"input"!==n&&(e||(e=this.getAllActiveElements()),Array.isArray(e)||(e=[e]),0!==e.length)){var i=[],r=e.map((function(e){if(e&&e.annot&&"widget"===e.annot.getType()){var n=e.annot;return{type:"string",value:{type:n.getType(),rect:n.getRect(),fieldName:n.getField().getName(),fieldType:n.getField().getType(),srcObjectNumber:n.getObjNum()}}}if((0,D._)(e,To)){var r=e.annot.getType();if("strikeout"===r||"highlight"===r||"squiggly"===r||"underline"===r||"redact"===r||"caret"===r||"screen"===r||"sound"===r)return;return{type:"string",value:{isCutAnnot:t,type:r,rect:e.annot.getRect(),annotId:e.getId(),pageIndex:e.annot.page.getIndex()}}}if(e.graphicsObject&&(0,D._)(e.graphicsObject,hy)){var o=(e=e.graphicsObject).getPDFPage();return i.push(e),{type:"string",value:{page:o.getIndex(),graphicObject:e.getId(),rect:e.getRect(),doc:o.getPDFDoc().getId()}}}})).filter((function(e){return!!e}));if(r.length){if(i.length){var o=i[0].getPDFPage(),a=i.map((function(e){return e.getId()}));o.cloneGraphicObject(o.getIndex(),a)}vP=JSON.stringify(r),(0,j.copyText)(vP),this.eventEmitter.emit(de.copyTextSuccess),this.pasteTimes=0}}}},{key:"copyAnnots",value:function(e){if(!Array.isArray(e))throw new Error("Incorrect param format");return e.filter((function(e){var t=e.getType();return"widget"==t?e.getField().getType()!==gn.Sign:!(["strikeout","highlight","squiggly","underline","redact","caret","screen","sound","popup"].includes(t)||"R"==e.info.RT&&e.info.IRT)})).map((function(e){var t=e.getType();if("widget"===t){var n=e,i=n.getField();return{type:t,rect:n.getRect(),fieldName:i.getName(),fieldType:i.getType(),objectNumber:n.getObjNum()}}return{type:t,rect:e.getRect(),id:e.getId(),pageIndex:e.getPage().getIndex()}}))}},{key:"pasteAnnots",value:function(e){var t=[],n=[];e.forEach((function(e){var i=e.type,r=e.rect,o=e.id,a=e.pageIndex,s=e.fieldName,u=e.fieldType,c=e.objectNumber;"widget"==i?n.push({type:"string",value:{type:i,rect:r,fieldName:s,fieldType:u,srcObjectNumber:c}}):t.push({type:"string",value:{isCutAnnot:!1,type:i,rect:r,annotId:o,pageIndex:a}})}));var i=[];return t.length>0&&i.push(this.paste(t)),n.length>0&&i.push(this.paste(n)),Promise.all(i).then((function(e){return e.flat()}))}},{key:"getClipboardText",value:function(){return vP}},{key:"cut",value:function(e){e||(e=[this.getAllActiveElements()[0]]),Array.isArray(e)||(e=[e]);var t=e[0];if(t&&(0,D._)(t,To)&&"text"===t.annot.getType()&&!t.deleteDisabled()){var n=t.annot,i=n.getReplies(),r=(0,k._)({},n.getInfo());r.repliesSummary.length&&r.repliesSummary.forEach((function(e){if(!e.content){var t=i.find((function(t){return t.getId()===e.id&&t.info.IRT===n.getId()}));t&&(e.content=t.getContent())}})),this.cutAnnotInfo=(0,k._)({},r),this.cutAnnot=n,this.copy(t,!0),t.removeAnnot()}}},{key:"_setSaveBefore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:PP;this._saveBefore=e}},{key:"registerSignatureHandler",value:function(e,t,n){throw new Error("this api is not working now!!")}},{key:"setEnableShortcutKey",value:function(e){this.config.enableShortcutKey=e,e?this.keyboard.enable():this.keyboard.disable()}},{key:"isShortcutKeyEnabled",value:function(){return this.config.enableShortcutKey}},{key:"setEnableLoad3DModule",value:function(e){this.config.enableLoad3DModule=e}},{key:"isLoad3DModuleEnabled",value:function(){return this.config.enableLoad3DModule}},{key:"setEnable3DInteraction",value:function(e){var t,n,i;this.config.enable3DInteraction=e,null===(i=this.getPDFDocRender())||void 0===i||null===(n=i.pagesRender)||void 0===n||null===(t=n.pageRenders)||void 0===t||t.forEach((function(t){var n,i=null===(n=t.annotsRender)||void 0===n?void 0:n.annotRenders;if(i)for(var r in i){var o,a=i[r];"3d"===(null==a||null===(o=a.annot)||void 0===o?void 0:o.getType())&&(e?a.component.active3DHandle():a.component.disable3DHandle())}}))}},{key:"is3DInteractionEnabled",value:function(){return this.config.enable3DInteraction}},{key:"isMouseWheelZoomEnabled",value:function(){var e=window.localStorage.getItem("PREFERENCES-GENNERAL");return!!e&&JSON.parse(e).handUseMouseZoom}},{key:"onShortcutKey",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"!=typeof e||!e)throw new Error("Incorrect shortcut param format");var r=j.Shortcut.from(e);if("function"!=typeof t&&"object"!=typeof t||Array.isArray(t))throw new Error("Incorrect handler param format");var o=PP;i&&(o=this.keyboard.interceptor((function(e,t){if(e.context===n.keyboard.getDefaultShortcutContext())return t(e);e.shortcut.equals(r)||t(e)})));var a="function"==typeof t?t:t&&t.keydown,s="function"==typeof t?void 0:t&&t.keyup,u={shortcut:r,keydown:a,keyup:s},c=this.keyboard.onShortcut(r,(function(e){switch(e.opportunity){case j.ShortcutEventApportunity.keydown:u.keydown&&u.keydown(e);break;case j.ShortcutEventApportunity.keyup:u.keyup&&u.keyup(e)}}),{keydown:"function"==typeof a,keyup:"function"==typeof s}),l=function(){o(),c()};return u.remove=l,this.keyboardListeners.push(u),l}},{key:"offShortcutKey",value:function(e,t){if("string"!=typeof e||!e)throw new Error("Incorrect shortcut param format");var n="function"==typeof t?t:t&&t.keydown,i="function"==typeof t?void 0:t&&t.keyup,r=j.Shortcut.from(e);this.keyboardListeners=this.keyboardListeners.filter((function(e){var t=!1;return r.equals(e.shortcut)&&(n||i?(n===e.keydown&&(e.keydown=void 0),i===e.keyup&&(e.keyup=void 0),t=!e.keydown&&!e.keyup):t=!0),!t||(e.remove(),!1)}))}},{key:"getInkSignList",value:function(e){return(this.inkSignManager.getList()||[]).map((function(t){return{dataURL:"blob"===e?Tw(t.dataURL):t.dataURL}}))}},{key:"getOnlineSignList",value:function(){return(this.onlineSignManager.getList()||[]).map((function(e){return e}))}},{key:"setInkSignList",value:function(e){var t=this;Array.isArray(e)&&e.forEach((function(e){if(e.dataURL&&/^data:(.*?)\/(.*?);base64/g.test(e.dataURL)){var n=t.inkSignManager.addInkSign();n.setDataURL(e.dataURL),t.inkSignManager.push(n)}}))}},{key:"setOnlineSignList",value:function(e){var t=this;Array.isArray(e)&&e.forEach((function(e){if(e.dataURL&&/^data:(.*?)\/(.*?);base64/g.test(e.dataURL)){var n=t.onlineSignManager.addOnlineSign();n.setDataURL(e.dataURL),t.onlineSignManager.push(n)}}))}},{key:"setDefaultPrintSetting",value:function(e){var t=e.quality;if(void 0===t&&(t=e.quality=100),(t-100|1e3-t)<0)throw new Error("quality range error, 100 to 1000");var n=this.config.printSetting;this.config.printSetting=Object.assign(n,e)}},{key:"getPrintSetting",value:function(e){return this.config.printSetting[e]}},{key:"setAutoCompleteSetting",value:function(e){var t=this.config.autoCompleteSetting;this.config.autoCompleteSetting=Object.assign(t,e)}},{key:"getAutoCompleteSetting",value:function(){return this.config.autoCompleteSetting}},{key:"clearAllAutoCompleteEntries",value:function(){return new Ph(this).clearDbEntries()}},{key:"deleteAutoCompleteEntry",value:function(e){return new Ph(this).deleteEntry(e)}},{key:"getSavedAutoCompleteEntries",value:function(){return new Ph(this).getDbEntries()}},{key:"getAllAutoCompleteEntries",value:function(){return new Ph(this).getAllEntries()}},{key:"setPencilDrawingTimeOut",value:function(e){this.getStateHandlerManager().pushStateHandlerConfig("pencilStateHandler",{pencilTimeout:e})}},{key:"setEraserSize",value:function(e){this.getStateHandlerManager().pushStateHandlerConfig("eraserStateHandler",{width:e})}},{key:"setSnapMode",value:function(e,t){switch(e){case En:case bn:case In:case Rn:case Tn:case Fn:case Ln:case Nn:break;default:throw new Error("Incorrect state handler name: ".concat(e,"!"))}var n=this.getStateHandlerManager(),i=(n.getStateHandlerConfig(e)||{}).snapMode;n.pushStateHandlerConfig(e,{snapMode:t&&t.slice(0)}),this.eventEmitter.emit(de.snapModeChanged,e,t,i)}},{key:"getSnapMode",value:function(e){return(this.getStateHandlerManager().getStateHandlerConfig(e)||{}).snapMode||[]}},{key:"setDocReadColors",value:function(e){var t=this;if("object"!=typeof e||Array.isArray(e)||!e.hasOwnProperty("background")||!e.hasOwnProperty("foreground"))throw new Error("Nonsupport colors param format");var n=this.getCurrentPDFDoc();if(n)return n.setColors(e).then((function(){var e=t.getPDFDocRender();if(e)for(var n=e.getPDFDoc().getPageCount(),i=0;i<n;i++){var r=t.getPDFPageRender(i);r&&r.isRendered&&r.redraw(!0)}}))}},{key:"setPageDisplayPreferences",value:function(){var e=this.getCurrentPDFDoc(),t=localStorage.getItem("PAGE_DISPLAY_DATA");if(t){var n=JSON.parse(t);e&&e.setPageDisplayPreferences(n)}}},{key:"activateAnnotation",value:function(e){var t=this;if(!e.annotationId)throw new Error("Annotation id can't empty");var n=this.getPDFDocRender();if(!n||!this.currentPDFDoc)return Promise.resolve();var i=e.annotationId;return this.currentPDFDoc.getPageByIndex(e.pageIndex).then((function(e){return"number"==typeof i?e.getAnnotsByObjectNumArray([i]):e.getAnnots().then((function(t){if(i.trim().length<1)return Promise.resolve();var n=e.getAnnotObjectNum(i);return 0==n?Promise.resolve():(i=n,e.getAnnotsByObjectNumArray([n]))}))})).then((function(r){var o=r[0];if(!o)throw new Error("the annotation does not exist");var a=o.getType();if("popup"===a)throw new Error("the popup annotation can not be activated");if(e.showCommentList&&"freetext"!=a){var s=function(){var n=t.getAnnotRender(e.pageIndex,i);if(n)return Promise.resolve(n.component.showReplyDialog()).then((function(){return o}));t.getPDFPageRender(e.pageIndex).getAnnotRenderSafely(i).then((function(e){return Promise.resolve(e.component.showReplyDialog()).then((function(){return o}))}))},u=s();return u||n.goToPage(e.pageIndex,{x:o.getRect().left,y:o.getRect().top},!0).then(s).then((function(){return o}))}return o})).then((function(t){return n.goToPage(e.pageIndex,{x:t.getRect().left,y:t.getRect().top},!0)})).then((function(n){var r=t.getPDFPageRender(e.pageIndex);r.waitRendered().then((function(){r.annotsRender&&r.annotsRender.activeAnnot(i)}))}))}},{key:"convertClientCoordToPDFCoord",value:function(e){for(var t=e.clientX,n=void 0===t?0:t,i=e.clientY,r=void 0===i?0:i,o=0,a=0,s=0,u=this.getPDFDocRender().pagesRender,c=u.getViewMode().getVisibleIndexes(),l=function(e){return n>=e.left&&n<e.right&&r>=e.top&&r<e.bottom},d=0,h=c.length;d<h;d++){o=c[d];var f=u.getPDFPageRender(o).$ui[0].getBoundingClientRect();if(l(f)){a=n-f.left,s=r-f.top;break}if(d==h-1)return Promise.resolve(null)}var g=u.getPDFPageRender(o);return g.reverseDevicePoint([a,s]).then((function(e){var t=(0,E._)(e,2),n=t[0],i=t[1];return{index:o,left:n,top:i,scale:g.getScale(),rotation:g.getRotation()}}))}},{key:"setAutoCalculateFieldsFlag",value:function(e){var t=this.pdfViewerRender.pdfDocRender;if(t){var n=t.getPDFDoc();if(n){var i=n.getPDFForm();i?i.calculationEnabled=e:console.error("get form error")}else console.error("get doc error")}else console.error("get doc Render error")}},{key:"getModuleLicenseRight",value:function(){var e=this;this.getWebPDFJR().then((function(t){t.getAllModuleLicenseRight().then((function(t){e.getStore().dispatch(j.MODULE_LICENSE_INFO,t)}))}))}},{key:"addTooltipsForAllFormFields",value:function(){var e=this.currentPDFDoc.getPDFForm();e&&(e.fields||[]).forEach((function(e){e.getAlternateName()||e.setAlternateName(e.getName())}))}},{key:"setLayoutGrid",value:function(e){return e&&((e=Object.assign({unit:"inch",width:1,height:1,offsetLeft:0,offsetTop:0,subdivisions:3,color:"#7f7fff"},e)).color=(0,j.colorConvertor)(e.color),e.subdivisions=Math.max(1,e.subdivisions)),this.config.layoutGrid=e||null,this.redrawContent()}},{key:"setLayoutGridByStorageSettings",value:function(e){var t=FP(),n=t.gridOptions,i=t.settings;return!0===e&&(i.Grid=!i.Grid,MP(i)),this.config.layoutGrid=i.Grid?n:null,this.eventEmitter.emit(de.gridToggle,i.Grid,e),this.redrawContent()}},{key:"setCustomMargin",value:function(e){this.getPDFViewerRender();O()("html").css("--facing-margin",e+"px")}},{key:"setMultipage",value:function(e){var t=this,n=this.viewModeManager.currentViewMode.getName(),i=["facing-page-view-mode","multipage-view-mode","facing-continuous-page-view-mode"];if(i.forEach((function(n){t.store.dispatch("multipage-"+n,e)})),this.getPDFDocRender().doc.getPageCount()<=1)this.viewModeManager.switchTo("single-page-view-mode");else if(i.includes(n)){var r=this.viewModeManager.ViewModes[n];this.viewModeManager.currentViewMode=r,this.viewModeManager.switchTo(""),setTimeout((function(){t.viewModeManager.switchTo(n)}))}}},{key:"updateFormatPageNumbers",value:function(){this.eventEmitter.emit(de.pagesLabelChange)}},{key:"getLayoutGrid",value:function(){return this.config.layoutGrid||null}},{key:"setSnapGrid",value:function(e){e&&((e=Object.assign({unit:"inch",width:1,height:1,offsetLeft:0,offsetTop:0,subdivisions:3},e)).subdivisions=Math.max(1,e.subdivisions)),this.config.snapGrid=e||null}},{key:"setSnapGridByStorageSettings",value:function(e){var t=FP(),n=t.gridOptions,i=t.settings;!0===e&&(i.SnapGrid=!i.SnapGrid,MP(i)),this.config.snapGrid=i.SnapGrid?n:null,this.eventEmitter.emit(de.snapGridToggle,i.SnapGrid,e)}},{key:"getSnapGrid",value:function(){return this.config.snapGrid||null}},{key:"setLineWeight",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return n.currentPDFDoc?n.currentPDFDoc.otherOptions.renderConfigLineWeight===e?[2]:(n.currentPDFDoc.otherOptions.renderConfigLineWeight=e,[4,n.currentPDFDoc.setRenderConfigLineWeight(e)]):[3,2];case 1:i.sent(),i.label=2;case 2:return t?(n.pdfViewerRender.pdfDocRender.pagesRender.setRenderFlags(8),n.redrawContent(),[2]):[2]}}))}))()}},{key:"setFormFieldFocusRectangleVisible",value:function(e){this.element.classList.toggle("hide-form-field-focus-rectangle",!e)}},{key:"setJPXDownSample",value:function(e){return this.getWebPDFJR().then((function(t){return t.setJPXDownSample(e)}))}},{key:"setFormCreationContinuously",value:function(e){this.getStore().dispatch(Oe,e)}},{key:"startFormDesginerAssist",value:function(){var e=this;return this.isDesignerAssistantEnabled?Promise.resolve():this.currentPDFDoc.startFormDesignerAssit().then((function(){e.isDesignerAssistantEnabled=!0,e.eventEmitter.emit(de.designerAssistantStatusChanged,!0)}))}},{key:"stopFormDesginerAssist",value:function(){var e=this;return this.isDesignerAssistantEnabled?this.currentPDFDoc?this.currentPDFDoc.stopFormDesignerAssit().then((function(){e.isDesignerAssistantEnabled=!1,e.eventEmitter.emit(de.designerAssistantStatusChanged,!1)})):(this.isDesignerAssistantEnabled=!1,void this.eventEmitter.emit(de.designerAssistantStatusChanged,!1)):Promise.resolve()}},{key:"setActionCallback",value:function(e){this.JSEngine&&this.JSEngine.setActionCallback(e)}},{key:"addFontMaps",value:function(e){var t=this.getStore(),n=(t.getCurrentValue(v_)||{all:[]}).all;return n.length>0&&(e=e.filter((function(e){return!n.some((function(t){return t.name===e.name&&t.style===e.style&&t.charset===e.charset}))}))),t.dispatch(v_,{all:n.concat(e),new:e}),this.eventEmitter.emit(de.AddFontMaps,e),this.getWebPDFJR().then((function(t){return t.addFontMap(e)}))}},{key:"getIoC",value:function(){return this.ioc}},{key:"getReadAloudService",value:function(){return this.readAloudService||(this.readAloudService=this.ioc.getInstanceByClass(h_)),this.readAloudService}},{key:"getPDFDocParserService",value:function(){return this.ioc.getInstanceByClass(b_)}},{key:"getKeyboard",value:function(){return this.keyboard}},{key:"toggleCollaborationMode",value:function(e){this.eventEmitter.emit(de.toggleCollaborationMode,e)}},{key:"getGroupCount",value:function(){var e={"-1":[]};return this.getAllActiveElements().forEach((function(t){var n=t.annot,i=n.getGroupHeader&&n.getGroupHeader();i?(e[i.getId()]=e[i.getId()]||[]).push(t):e[-1].push(t)})),[Object.keys(e).length-1,e[-1].length,e]}},{key:"initADPs",value:function(){this.ADPs||(this.ADPs=JSON.parse(localStorage.getItem(DefaultAnnotPropertyKey))||{})}},{key:"ADPs",get:function(){var e=this.pdfEngine;return e?e.ADPs:{}}},{key:"setAnnotDefaultProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(this.webPDFJR||this.webPDFSR).setAnnotDefaultProperty(e,t,n),this.eventEmitter.emit("setAnnotDefaultProperty",{type:e,intent:t,props:n})}},{key:"getAnnotDefaultProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(this.webPDFJR||this.webPDFSR).getAnnotDefaultProperty(e,t)}},{key:"setWorker",value:function(e){var t=this;return this.getWebPDFJR().then((function(n){return n.api.setWorker(e),n.cacheFontConfig((t.config.jr.fontServer||"")+"/",[],[])}))}},{key:"previewIconDoc",value:function(e){return this.getWebPDFJR().then((function(t){return t.api.previewIconDoc(e)}))}},{key:"getBuiltInComparisonStringResource",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getCurrentLanguage();return this.i18n.getDataByLanguage(e).viewer_.compareResultStrings}},{key:"loadBuiltinComparisonTemplates",value:function(){var e=this;return(0,_._)((function(){var t,n,i,r,o,a;return(0,F.Jh)(this,(function(s){switch(s.label){case 0:return u=(0,_._)((function(t){var n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return[4,fetch(t)];case 1:return[4,i.sent().blob()];case 2:return n=i.sent(),[2,e.loadPDFDocByFile(n)]}}))})),t=function(e){return u.apply(this,arguments)},n="assets/comparison",i=$s(e.libPath,n,"new_summary.pdf"),r=$s(e.libPath,n,"old_summary.pdf"),[4,t(i)];case 1:return o=s.sent(),[4,t(r)];case 2:return a=s.sent(),[2,{newTemplateId:o.id,oldTemplateId:a.id}]}var u}))}))()}},{key:"compareDocuments",value:function(e,t,n,i){var r=this;return(0,_._)((function(){var o,a,s,u,c,l;return(0,F.Jh)(this,(function(d){switch(d.label){case 0:return n.newTemplateId&&n.oldTemplateId?[3,2]:[4,r.loadBuiltinComparisonTemplates()];case 1:o=d.sent(),a=o.newTemplateId,s=o.oldTemplateId,n.newTemplateId=a,n.oldTemplateId=s,d.label=2;case 2:return n.stringResource||(n.stringResource=r.getBuiltInComparisonStringResource()),[4,r.pdfEngine];case 3:return[4,(u=d.sent()).getPDFDocByCacheId(e,{fileName:n.baseFileName})];case 4:return c=d.sent(),[4,u.getPDFDocByCacheId(t,{fileName:n.otherFileName})];case 5:return l=d.sent(),[2,c.compareWith(l,n,i)]}}))}))()}},{key:"getOverlayComparisonService",value:function(){return this.getIoC().getInstanceByClass(J_)}},{key:"getOverlayComparisonOptionsService",value:function(){return this.getIoC().getInstanceByClass(z_)}},{key:"registerProgressHandler",value:function(e){if("function"!=typeof e)throw new TypeError("Callback type error");this.progressHandler=e}},{key:"updateCustomOptions",value:function(e){Object.assign(this.customs,e)}},{key:"getCustomOptionsUpdater",value:function(){return this.ioc.getInstanceByClass(iP)}},{key:"getInstanceId",value:function(){return this.instanceId}},{key:"getBookmarkDataService",value:function(){return this.ioc.getInstanceByClass(dP)}},{key:"registerMultimediaPlayers",value:function(e){var t;(t=this.multimediaPlayers).unshift.apply(t,(0,I._)(e))}}]),n}(j.Disposable);const RP=IP;function TP(e,t){if(e&&"function"==typeof e.getJWT)return e.getJWT(t)}function FP(){var e=JSON.parse(localStorage.getItem("layoutPreference"))||{WidthBetweenLines:"1.000",HeightBetweenLines:"1.000",GridOffsestFromLeftEdge:"1.000",GridOffsestFromTopEdge:"1.000",Subdivisions:"3",GridLineColcor:"#1e43d6",Grid:!1,SnapGrid:!1};return{gridOptions:{unit:"inch",width:e.WidthBetweenLines,height:e.HeightBetweenLines,offsetLeft:e.GridOffsestFromLeftEdge,offsetTop:e.GridOffsestFromTopEdge,subdivisions:Math.max(1,e.Subdivisions),color:(0,j.colorConvertor)(e.GridLineColcor)},settings:e}}function MP(e){localStorage.setItem("layoutPreference",JSON.stringify(e))}function OP(e){var t=e.key,n=e.value,i=e.notNull,r=void 0===i||i,o=e.notSpace,a=void 0!==o&&o,s=e.notSpecialChar;if(void 0!==s&&s&&/[~!@#'\.\$%\^&\*\(\)\=;\[\]\{\}]/.test(n))throw new Error("[Illegal Argument] Invalid ".concat(t,": Special characters is invalid."));if(a&&/\s/.test(n))throw new Error("[Illegal Argument] Invalid ".concat(t,": Space is invalid."));if(r&&0==n.length)throw new Error("[Illegal Argument] Invalid ".concat(t,": ").concat(t," is required."))}function LP(e){if(0===e.size)return Promise.resolve(new Uint8Array(0));var t=new FileReader;return new Promise((function(n,i){t.onload=function(){n(new Uint8Array(t.result))},t.onerror=function(e){return i(e)},t.readAsArrayBuffer(e)}))}function NP(e,t){if(0===e.size)return Promise.resolve("");var n=new FileReader;return new Promise((function(i,r){n.onload=function(){i(n.result)},n.onerror=function(e){return r(e)},n.readAsText(e,t)}))}function VP(e,t){for(var n=0;n<t.length;n++)if(e[n]===t.charCodeAt(n))return!0;return!1}function BP(e,t){if(0===e.size)return Promise.resolve(!1);var n;if(t){var i=t.lastIndexOf(".");n=t.substr(i+1)}return NP(e.slice(0,4)).then((function(e){return"%PDF"===e||"pdf"===n}))}function jP(e){var t=Array.from(e).slice(0,4).map((function(e){return String.fromCharCode(e)})).join("");return"%PDF"===t}function UP(e,t){return 0===e.size?Promise.resolve(!1):LP(e.slice(0,35)).then((function(e){return qP(e,t)?WP():$P(e,t)?YP():KP(e,t)}))}var HP=document.createElement("video");function WP(){return!!HP.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')}function YP(){return!!HP.canPlayType&&!!HP.canPlayType('video/ogg; codecs="theora, vorbis"')}function qP(e,t){return!!t.match(/\.mp4$/)}function KP(e,t){return!!t.match(/\.webm$/)}function $P(e,t){return 79===e[0]&&103===e[1]&&103===e[2]&&83===e[3]&&zP(e)}function zP(e){return 116===e[29]&&104===e[30]&&101===e[31]&&111===e[32]&&114===e[33]&&97===e[34]}var GP=document.createElement("audio");function JP(){return!!GP.canPlayType("audio/mp3")}function XP(){return!!GP.canPlayType&&!!GP.canPlayType('audio/ogg; codecs="vorbis"')}function ZP(e,t){return LP(e.slice(0,35)).then((function(e){return QP(e,t)?JP():!!eA(e,t)&&XP()}))}function QP(e,t){return!!t.match(/\.mp3$/)}function eA(e,t){return 79===e[0]&&103===e[1]&&103===e[2]&&83===e[3]&&tA(e)}function tA(e){return 118===e[29]&&111===e[30]&&114===e[31]&&98===e[32]&&105===e[33]&&115===e[34]}function nA(e,t){return LP(e.slice(0,4)).then((function(e){return iA(e)||rA(e)||oA(e)||aA(e)||sA(t)}))}function iA(e){return 255===e[0]&&216===e[1]&&255===e[2]}function rA(e){return 137===e[0]&&80===e[1]&&78===e[2]&&71==e[3]}function oA(e){return 71===e[0]&&73===e[1]&&70===e[2]&&56===e[3]}function aA(e){return 66===e[0]&&77===e[1]}function sA(e){return/\.svg$/.test(e)}function uA(e){return NP(e.slice(0,4)).then((function(e){return"%FDF"===e}))}function cA(e){return NP(e.slice(0,4)).then((function(e){return"%XDP"===e}))}function lA(e){return e>=0&&e<=6||e>=14&&e<=31}var dA,hA,fA=1024;function gA(e,t){return/\.xfdf/.test(t)||0===e.size?Promise.resolve(!1):uA(e).then((function(t){return!t&&cA(e).then((function(t){if(t)return!1;var n=e.size>fA?e.slice(0,fA):e;return"function"==typeof e.stream?function(e){var t=e.stream().getReader();return t.read().then((function e(n){if(n.done)return!0;for(var i=n.value,r=0;r<i.length;r++)if(lA(i[r]))return!1;return t.read().then(e)}))}(n):function(e){var t=512,n=Math.ceil(e.size/t),i=function(e){for(var t=0;t<e.length;t++)if(lA(e[t]))return!1;return!0};return Array(n).fill((function(e){return LP(e).then(i)})).reduce((function(n,i,r){return n.then((function(n){if(n){var o=t*r,a=Math.min(o+t,e.size),s=e.slice(o,a);return i(s)}return!1}))}),Promise.resolve(!0))}(n)}))}))}function vA(e){return(0,D._)(e,HTMLElement)?function(n,i){return"selection-update"===i&&n?t(n,e.getBoundingClientRect()):n}:function(n,i){return"selection-update"===i&&n?t(n,e):n};function t(e,t){var n=e.clientLeft,i=e.clientTop,r=n+e.width,o=i+e.height;return n<t.left&&(n=t.left),i<t.top&&(i=t.top),r>t.right&&(r=t.right),o>t.bottom&&(o=t.bottom),{clientLeft:n,clientTop:i,width:r-n,height:o-i}}}!function(e){e.NONE="none",e.DASHED="dashed",e.SOLID="solid",e.DOTTED="dotted"}(dA||(dA={})),function(e){e.START="selection-start",e.UPDATE="selection-update",e.END="selection-end",e.CANCEL="selection-cancel"}(hA||(hA={}));var pA=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,P._)(this,n),e=t.call(this),(0,J._)((0,w._)(e),"anchorElement",document.body),(0,J._)((0,w._)(e),"fillColor","rgba(".concat(125,",",186,",",255,", 0.3)")),(0,J._)((0,w._)(e),"borderColor","#7DBAFF"),(0,J._)((0,w._)(e),"borderStyle","solid"),(0,J._)((0,w._)(e),"borderWidth",1),(0,J._)((0,w._)(e),"removeMaskOnEnd",!0),(0,J._)((0,w._)(e),"areaEl",document.createElement("div")),(0,J._)((0,w._)(e),"builtInInteraction",!0),(0,J._)((0,w._)(e),"isPrepared",!1),(0,J._)((0,w._)(e),"isAvailable",!0),(0,J._)((0,w._)(e),"store",new j.Store),(0,J._)((0,w._)(e),"interceptors",[]),Object.keys(i).forEach((function(t){e[t]=i[t]})),e.areaEl.className="fv__viewer-selections-area",e.areaEl.style.cssText+="\n            outline: ".concat(e.borderWidth,"px ").concat(e.borderStyle," ").concat(e.borderColor,";\n            background-color: ").concat(e.fillColor,";\n        "),e.store.subscribe("selection-update",(function(t){e.areaEl.style.cssText+="\n                width: ".concat(t.width,"px;\n                height: ").concat(t.height,"px;\n                left: ").concat(t.clientLeft,"px;\n                top: ").concat(t.clientTop,"px;\n            ")})),e.addDestroyHook((function(){e.store.destroy()})),e}return(0,A._)(n,[{key:"eventInterceptor",value:function(e){this.interceptors.push(e)}},{key:"reducer",value:function(e){this.store.reducer(e)}},{key:"on",value:function(e,t){return this.builtInInteraction&&this.prepare(),this.store.subscribe(e,t)}},{key:"start",value:function(e,t){document.body.appendChild(this.areaEl);var n=this.anchorElement.getBoundingClientRect();this.store.dispatch("selection-start",{clientLeft:e,clientTop:t,left:e-n.left,top:t-n.top,width:0,height:0})}},{key:"adjust",value:function(e,t){var n=this.store.getCurrentValue("selection-start"),i=n.clientLeft+e,r=n.clientTop+t,o=Math.min(n.clientLeft,i),a=Math.min(n.clientTop,r),s=Math.abs(e),u=Math.abs(t),c=this.anchorElement.getBoundingClientRect();this.store.dispatch("selection-update",{clientLeft:o,clientTop:a,left:o-c.left,top:a-c.top,width:s,height:u})}},{key:"end",value:function(){this.removeMaskOnEnd&&this.removeMask();var e=this.store.getCurrentValue("selection-update");this.store.dispatch("selection-end",e)}},{key:"cancel",value:function(){this.removeMask(),this.store.dispatch("selection-cancel",void 0)}},{key:"removeMask",value:function(){this.areaEl.parentElement===document.body&&document.body.removeChild(this.areaEl)}},{key:"enable",value:function(){this.isAvailable=!0}},{key:"disable",value:function(){this.isAvailable=!1}},{key:"prepare",value:function(){var e=this;if(!this.isPrepared){var t=new gr.Manager(this.anchorElement);t.add(new gr.Pan({direction:gr.DIRECTION_ALL}));var n,i=!1;t.on("panstart",(function(t){e.isAvailable&&(e.interceptors.some((function(e){return!e(t)}))||(i=!0,n=t.center,e.start(t.center.x,t.center.y),e.adjust(0,0)))})),t.on("panmove",(function(t){if(e.isAvailable&&i){var r=t.center.x-n.x,o=t.center.y-n.y;e.adjust(r,o)}})),t.on("panend",(function(t){e.isAvailable&&i&&(i=!1,e.end())})),t.on("pancancel",(function(t){e.isAvailable&&i&&(i=!1,e.cancel())})),this.addDestroyHook((function(){t.destroy(),e.end()}))}}}]),n}(j.Disposable);var mA=function(e){var t={isAllowed:!1,print:2,accessibility:!0,copy:!0,change:4};return"password"===e?(0,k._)({userPassword:"",ownerPassword:"",isEncryptMetadata:!0,cipherType:Zy.AES128},t):"certificate"===e?t:{}},yA=function(e){if(void 0===e)return{};var t={};return t.print=2048&e?2:4&e?1:0,t.accessibility=!!(512&e),t.copy=!!(16&e),t.change=8&e&&32&e&&256&e?4:32&e&&256&e?3:256&e?2:1024&e?1:0,t},kA=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.print,n=e.change,i=e.accessibility,r=e.copy;if("number"!=typeof t||"number"!=typeof n||"boolean"!=typeof i||"boolean"!=typeof r)return 0;var o=65532;return t<2&&(o^=2048,t<1&&(o^=4)),i||(o^=512),r||(o^=16),4===(n=+n)?o^=1024:3===n?(o^=8,o^=1024):2===n?(o^=8,o^=32,o^=1024):1===n?(o^=8,o^=32,o^=256):0===n&&(o^=8,o^=32,o^=256,o^=1024),o+=4294901760},bA=null,wA=function(){return bA},_A=function(e){bA=e},PA="",AA=function(){return PA},SA=function(){PA=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""},xA=function(e,t){if(!e||!t)return Promise.resolve(!1);var n=t.recipientList,i=t.cipherType,r=t.isEncryptMetadata,o=e.pdfViewer.currentPDFDoc,a=n.map((function(e){return{cerFile:e.cerFile,permission:e.permissionData.isAllowed?e.permissionData:null}}));return o.setCertificateAndPermission(a,i,r).then((function(t){return t&&(e.alert({message:"password-protect:warning.apply-to-document",level:"warning",again:!0,id:"set-certificate-permission-alert"}),e.eventEmitter.emit(de.securityTypeChanged),_A(null)),t}))},CA=function(e,t){return e&&t?e.pdfViewer.currentPDFDoc.setPasswordAndPermission(t.userPassword,t.ownerPassword,t.permissionData.value,t.cipherType,t.isEncryptMetadata).then((function(n){if(n){e.alert({message:"password-protect:warning.apply-to-document",level:"warning",again:!0,id:"set-password-permission-alert"}),e.eventEmitter.emit(de.securityTypeChanged);var i=(0,b._)((0,k._)({},t,yA(t.permissionData.value)),{isAllowed:t.permissionData.isAllowed});delete i.permissionData,_A(i),SA(t.ownerPassword)}return n})):Promise.resolve(!1)},DA=function(e,t,n){if(e){var i=e.pdfViewer.currentPDFDoc,r=function(t){return e.promptPassword("","password-protect:buttons.inputOwnerPassword","password-protect:buttons.title","body",t?"error":void 0,t)},o=function(e){if(!e)return r("password-protect:error.admin-pwd-cannot-blank").then(o,(function(){}));(n||i).checkPassword(e).then((function(n){if(3!==n)return r("password-protect:warning.incorrect-owner-pwd").then(o,(function(){}));SA(e),t&&t(e)}))};r().then(o,(function(){}))}};var EA=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.$ui.get(0).parentElement;return(0,P._)(this,n),(i=t.call(this,e)).scrollHost=r,i.clientWidth=-1,i.clientHeight=-1,window.ResizeObserver&&(i.observer=new ResizeObserver((function(e){(0,E._)(e,1)[0]&&(i.clientWidth=r.clientWidth,i.clientHeight=r.clientHeight)})),i.observer.observe(r),i.addDestroyHook((function(){i.observer.unobserve(r)}))),i}return(0,A._)(n,[{key:"getScrollHost",value:function(){return this.scrollHost}},{key:"scrollBy",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto",i=this.scrollHost;i.scrollBy?i.scrollBy({top:t,left:e,behavior:n}):(i.scrollLeft=i.scrollLeft+e,i.scrollTop=i.scrollTop+t)}},{key:"scrollTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto",i=this.scrollHost,r=i.scrollLeft,o=i.scrollTop;if(i.scrollTo?i.scrollTo({left:e,top:t,behavior:n}):(i.scrollLeft=e,i.scrollTop=t),0===r||!o){var a=new Event("scroll");Object.defineProperty(a,"isMock",{value:!0}),i.dispatchEvent(a)}}},{key:"getScrollOffset",value:function(){var e=this.viewerRender.$ui.get(0),t=e.parentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{offsetLeft:Math.max(0,n.left-t.left),offsetTop:Math.max(0,n.top-t.top)}}},{key:"getScrollOffsetLeft",value:function(){return this.getScrollOffset().offsetLeft}},{key:"getScrollOffsetTop",value:function(){return this.getScrollOffset().offsetTop}},{key:"getScrollTop",value:function(){return this.scrollHost.scrollTop}},{key:"getScrollLeft",value:function(){return this.scrollHost.scrollLeft}},{key:"getScrollX",value:function(){return this.getScrollLeft()}},{key:"getScrollY",value:function(){return this.getScrollTop()}},{key:"getWidth",value:function(){var e;return-1!==this.clientWidth?(e=this.clientWidth,this.clientWidth=-1):e=this.scrollHost.clientWidth,e}},{key:"getHeight",value:function(){var e;return-1!==this.clientHeight?(e=this.clientHeight,this.clientHeight=-1):e=this.scrollHost.clientHeight,e}},{key:"addScrollEventListener",value:function(e){return(0,S._)((0,x._)(n.prototype),"addScrollEventListener",this).call(this,e)}}],[{key:"create",value:function(e){return function(t){(0,C._)(i,t);var n=(0,T._)(i);function i(t){return(0,P._)(this,i),n.call(this,t,e)}return i}(n)}}]),n}(ja);const IA=EA;var RA;!function(e){e[e.MOVE_TO=1]="MOVE_TO",e[e.LINE_TO=2]="LINE_TO"}(RA||(RA={}));var TA=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"x",void 0),(0,J._)(this,"y",void 0),this.x=t,this.y=n}return(0,A._)(e,[{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"div",value:function(e){return this.mult(1/e)}},{key:"mult",value:function(t){return new e(this.x*t,this.y*t)}},{key:"normalize",value:function(){var e=this.length();return this.div(e)}},{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"toPoint",value:function(e){return new FA(this.x,this.y,e)}}]),e}(),FA=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:RA.MOVE_TO;(0,P._)(this,e),(0,J._)(this,"x",void 0),(0,J._)(this,"y",void 0),(0,J._)(this,"type",void 0),this.x=t,this.y=n,this.type=i}return(0,A._)(e,[{key:"distanceTo",value:function(e){return this.vectorTo(e).length()}},{key:"vectorTo",value:function(e){return new TA(e.x-this.x,e.y-this.y)}},{key:"toVector",value:function(){return new TA(this.x,this.y)}},{key:"newType",value:function(t){return e.fromPoint(this,t)}}],[{key:"fromVec",value:function(t,n){return new e(t.x,t.y,n)}},{key:"fromPoint",value:function(t,n){return new e(t.x,t.y,n)}}]),e}(),MA=function(){function e(t,n){(0,P._)(this,e),(0,J._)(this,"radius",void 0),(0,J._)(this,"origin",void 0),this.radius=t,this.origin=n}return(0,A._)(e,[{key:"contains",value:function(e){return this.origin.distanceTo(e)<this.radius}},{key:"intersectsLine",value:function(e,t){var n=e.x,i=e.y,r=t.x,o=t.y,a=this.origin,s=a.x,u=a.y,c=Math.pow(r-n,2)+Math.pow(o-i,2),l=2*((r-n)*(n-s)+(o-i)*(i-u)),d=l*l-4*c*(s*s+u*u+n*n+i*i-2*(s*n+u*i)-this.radius*this.radius),h=[];if(0===d){var f=-l/(2*c),g=new FA(n+f*(r-n),i+f*(o-i));OA(e,t,g)&&h.push(g)}else if(d>0){var v=(-l-Math.sqrt(d))/(2*c),p=(-l+Math.sqrt(d))/(2*c),m=new FA(n+v*(r-n),i+v*(o-i)),y=new FA(n+p*(r-n),i+p*(o-i));OA(e,t,m)&&h.push(m),OA(e,t,y)&&h.push(y)}return h}}]),e}();function OA(e,t,n){var i=Math.min(e.x,t.x),r=Math.max(e.x,t.x),o=Math.min(e.y,t.y),a=Math.max(e.y,t.y);return n.x>=i&&n.x<=r&&n.y>=o&&n.y<=a}var LA=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"radius",void 0),this.radius=t}return(0,A._)(e,[{key:"erase",value:function(e,t){var n=e.reduce((function(e,t){return t.type===RA.MOVE_TO&&e.push([]),e[e.length-1].push(t),e}),[]),i=new MA(this.radius,t);return n.forEach((function(e){for(var t=0;t<e.length-1;){var n=e[t],r=e[t+1];if(i.contains(n))if(i.contains(r))e.splice(t,1,r.newType(RA.MOVE_TO)),t++;else{var o=i.intersectsLine(n,r);1===o.length&&e.splice(t,1,o[0].newType(RA.MOVE_TO)),t++}else{if(i.contains(r)){var a=i.intersectsLine(n,r);1===a.length&&(e.splice(t+1,1,a[0].newType(RA.LINE_TO),r.newType(RA.MOVE_TO)),t++)}else{var s=i.intersectsLine(n,r);2===s.length&&(e.splice(t+1,0,s[0].newType(RA.LINE_TO),s[1].newType(RA.MOVE_TO)),t+=2)}t++}}})),n.reduce((function(e,t){return e.concat(t)}),[])}}]),e}();var NA,VA,BA,jA,UA="unknown",HA="unknown_certify";NA={},(0,J._)(NA,UA,"unknownMsg"),(0,J._)(NA,HA,"unknownMsg_certify"),(0,J._)(NA,"unknownValidityMsg","unknownValidityMsg"),(0,J._)(NA,"validMsg","validMsg"),(0,J._)(NA,"validMsg_certify","validMsg_certify"),(0,J._)(NA,"invalidMsg","invalidMsg"),(0,J._)(NA,"invalidMsg_certify","invalidMsg_certify"),(0,J._)(NA,"invalidMsg_Upper","invalidMsg_Upper"),(0,J._)(NA,"errorSignatureMsg","errorSignatureMsg"),(0,J._)(NA,"errorByteRangeMsg","errorByteRangeMsg"),(0,J._)(NA,"errorByteRangeDetail","errorByteRangeDetail"),(0,J._)(NA,"validInfo","validInfo"),(0,J._)(NA,"validInfo_certify","validInfo_certify"),(0,J._)(NA,"invalidInfo","invalidInfo"),(0,J._)(NA,"invalidInfo_certify","invalidInfo_certify"),(0,J._)(NA,"validityUnknownInfo","validityUnknownInfo"),VA={},(0,J._)(VA,UA,"verifyUnknown"),(0,J._)(VA,"verifyNoChange","verifyNoChange_online"),(0,J._)(VA,"verifyNoChange_certify","verifyNoChange_certify"),(0,J._)(VA,"verifyFuture","verifyFuture"),(0,J._)(VA,"verifyAlteredCorrupted","verifyAlteredCorrupted"),(0,J._)(VA,"verifyChange","verifyChange_online"),(0,J._)(VA,"verifyChange_certify","verifyChange_certify"),(0,J._)(VA,"noSupportFormat","noSupportFormat"),(0,J._)(VA,"noSupportHandler","verifyChange_certify"),(0,J._)(VA,"e_StateVerifyChangeLegal","changeLegal"),(0,J._)(VA,"e_StateVerifyChangeIllegal","changeIllegal"),BA={},(0,J._)(BA,UA,"issueUnknown"),(0,J._)(BA,"issuerInvalid_mac","issuerInvalid_mac"),(0,J._)(BA,"issuerInvalid","issuerInvalid"),(0,J._)(BA,"issuerRevoke","issuerRevoke"),(0,J._)(BA,"issuerExpire_mac","issuerExpire_mac"),(0,J._)(BA,"issuerExpire","issuerExpire"),(0,J._)(BA,"issuerCurrent","issuerCurrent"),(0,J._)(BA,"issuerCurrent_certify","issuerCurrent_certify"),(0,J._)(BA,"issuerValid","issuerValid"),(0,J._)(BA,"issuerValidAndIssueRevoke","issuerValidAndIssueRevoke"),(0,J._)(BA,"issuerIdentityUnknown","issuerIdentityUnknown"),(0,J._)(BA,"identityValidAndUntrustedMsg","identityValidAndUntrustedMsg"),(0,J._)(BA,"notVerifiedIdentityMsg","notVerifiedIdentityMsg"),(0,J._)(BA,"e_StateVerifyIssueUnknown","issueUnknown"),(0,J._)(BA,"e_StateVerifyIssueUncheck","issueUncheck"),jA={},(0,J._)(jA,UA,"timestampUnknown"),(0,J._)(jA,"timestampExpire","timestampExpire_online"),(0,J._)(jA,"timestampDoc","timestampDoc_online"),(0,J._)(jA,"timestampNone","timestampNone_online"),(0,J._)(jA,"timestampEmbeddedAndExpire","timestampEmbeddedAndExpire"),(0,J._)(jA,"timestampEmbeddedAndExpire_mac","timestampEmbeddedAndExpire_mac"),(0,J._)(jA,"timestampEmbeddedAndExpire_mac_panel","timestampEmbeddedAndExpire_mac_panel"),(0,J._)(jA,"timestampEmbedded","timestampEmbedded"),(0,J._)(jA,"timestampEmbedded_mac","timestampEmbedded_mac"),(0,J._)(jA,"timestampEmbedded_mac_panel","timestampEmbedded_mac_panel"),(0,J._)(jA,"timestampEmbeddedAndNotBeVerified","timestampEmbeddedAndNotBeVerified"),(0,J._)(jA,"timestampSecure","timestampSecure"),(0,J._)(jA,"e_StateVerifyTimestampIssueUnknown","timestampIssueUnknown");var WA={NotYetVerified:"notYetVerified",Verified:"verified"};function YA(e){var t=[];if(e){var n=e.getPDFForm();if(n){var i=n.fields;i.length&&(t=i.filter((function(e){return e.getType()===gn.Sign})))}}return t}function qA(e){var t=!1,n=YA(e);return n.length&&(t=n.some((function(e){return e.signatureInfo&&e.signatureInfo.isSigned&&e.signatureInfo.isCertified}))),t}function KA(e){var t=!1,n=YA(e);return n.length&&(t=n.some((function(e){return e.signatureInfo&&e.signatureInfo.isSigned&&!e.signatureInfo.isCertified}))),t}var $A="uniqueSerialNumber",zA="TrustedCertificateList",GA=!1,JA=[{indexKey:"type"},{indexKey:"serialNumber"}],XA={Custom:"Custom",FATL:"FATL",EUTL:"EUTL"},ZA=function(){return new kh(zA,"FoxitPDFSDKForWeb_"+zA,1,$A,JA)};function QA(e){return eS.apply(this,arguments)}function eS(){return(eS=(0,_._)((function(e){var t,n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:if(!(t=ZA()))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.add(e)];case 2:return i.sent(),[2,e];case 3:return n=i.sent(),console.error(n),[2,!1];case 4:return[2,!1]}}))}))).apply(this,arguments)}function tS(e){return nS.apply(this,arguments)}function nS(){return(nS=(0,_._)((function(e){var t,n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),(t=ZA())?[4,t.remove(e)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[3,4];case 3:return n=i.sent(),console.error(n),[3,4];case 4:return[2]}}))}))).apply(this,arguments)}function iS(e){return rS.apply(this,arguments)}function rS(){return(rS=(0,_._)((function(e){var t,n,i,r;return(0,F.Jh)(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,5,,6]),!(t=ZA()))return[3,4];n=0,o.label=1;case 1:return n<e.length?(i=e[n],[4,t.remove(i)]):[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[3,6];case 5:return r=o.sent(),console.error(r),[3,6];case 6:return[2]}}))}))).apply(this,arguments)}function oS(){return"true"==localStorage.getItem("isFATLAndEUTLListInit")||GA}function aS(e){return sS.apply(this,arguments)}function sS(){return(sS=(0,_._)((function(e){var t,n;return(0,F.Jh)(this,(function(i){switch(i.label){case 0:return oS()?[3,2]:[4,uS(e)];case 1:i.sent(),i.label=2;case 2:return[4,lS(e)];case 3:if(i.sent(),!(t=ZA()))return[2,[]];i.label=4;case 4:return i.trys.push([4,6,,7]),[4,t.getAll()];case 5:return[2,i.sent()||[]];case 6:return n=i.sent(),console.error(n),[2,[]];case 7:return[2]}}))}))).apply(this,arguments)}function uS(e){return cS.apply(this,arguments)}function cS(){return cS=(0,_._)((function(e){var t,n,i,r,o,a,s,u=arguments;return(0,F.Jh)(this,(function(c){switch(c.label){case 0:if(t=u.length>1&&void 0!==u[1]&&u[1],oS()&&!t)return[2];GA=!1,c.label=1;case 1:return c.trys.push([1,7,8,9]),[4,lS(e,t)];case 2:return(n=c.sent()).length?(n.map((function(e){e.usage=3})),(i=ZA())?[4,i.getByIndex("type",XA.Custom)]:[3,6]):[3,6];case 3:return r=c.sent()||[],[4,i.clear()];case 4:return c.sent(),(o=n.concat(r)).forEach((function(e){var t=e||{},n=t.serialNumber,i=t.country,r=t.issuerName;e[$A]="".concat(n,"_").concat(i,"_").concat(r)})),a=function(e,t){var n=new Map;return e.filter((function(e){return!n.has(e[t])&&n.set(e[t],1)}))}(o,$A),[4,i.addItems(a)];case 5:c.sent(),GA=!0,c.label=6;case 6:return[3,9];case 7:return s=c.sent(),GA=!1,console.error(s),[3,9];case 8:return localStorage.setItem("isFATLAndEUTLListInit",GA),[7];case 9:return[2]}}))})),cS.apply(this,arguments)}function lS(e){return dS.apply(this,arguments)}function dS(){return dS=(0,_._)((function(e){var t,n,i,r,o=arguments;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:t=o.length>1&&void 0!==o[1]&&o[1],a.label=1;case 1:return a.trys.push([1,4,,5]),(s=e.libPath).endsWith("/")||(s+="/"),n={static_FATLUrl:{url:"".concat(s,"certFATLAndEUTL/tsfile.foxitdata1?t=").concat((new Date).getTime()),trust_type:1,type:XA.FATL},static_EUTLUrl:{url:"".concat(s,"certFATLAndEUTL/eutlfile.foxitdata1?t=").concat((new Date).getTime()),trust_type:2,type:XA.EUTL},static_FATL2Url:{url:"".concat(s,"certFATLAndEUTL/tsfile.foxitdata2?t=").concat((new Date).getTime()),trust_type:1,type:XA.FATL,purpose_code:"phantomkey"}},i=[n.static_FATLUrl,n.static_FATL2Url,n.static_EUTLUrl],[4,e.getWebPDFJR()];case 2:return[4,a.sent().getFATLAndEUTLList(i,t)];case 3:return r=a.sent(),[2,Promise.resolve(r)];case 4:return a.sent(),[2,Promise.resolve([])];case 5:return[2]}var s}))})),dS.apply(this,arguments)}function hS(e,t,n,i){return fS.apply(this,arguments)}function fS(){return(fS=(0,_._)((function(e,t,n,i){var r,o,a,s,u,c;return(0,F.Jh)(this,(function(l){switch(l.label){case 0:return r=t.getName(),o=function(e){var t=e.customs&&e.customs.getVerifySignatureRule?e.customs&&e.customs.getVerifySignatureRule:void 0,n="function"==typeof t?t():{},i=n.is_verify_signature,r=void 0===i||i,o=n.use_expired_tst,a=void 0===o||o,s=n.ignore_doc_info,u=void 0!==s&&s,c=n.time_type,l=void 0===c?0:c,d=n.verifyDocWhenOpened,h=void 0===d||d,f=n.untrustedAlterInfo;return{is_verify_signature:r,use_expired_tst:a,ignore_doc_info:u,time_type:l,verifyDocWhenOpened:h,untrustedAlterInfo:void 0!==f&&f}}(e),a=(0,J._)({},r,!!t.signatureInfo&&t.signatureInfo.isCertified),[4,aS(e)];case 1:return s=l.sent()||[],[3,3];case 2:c=l.sent(),(u=s).push.apply(u,(0,I._)(c.map((function(e){var t=e.serial,n=e.country,i=e.issuerName;return(0,k._)({isCertTrustedRoot:!0,usage:3,uniqueSerialNumber:"".concat(t,"_").concat(n||"","_").concat(i),type:"Custom"},e)})))),l.label=3;case 3:return[2,o=(0,b._)((0,k._)({},o),{trustedCertificateList:s,isCertTrusted:n,isCertTrustedRoot:i,isCertifiedMap:a})]}}))}))).apply(this,arguments)}function gS(e,t){return vS.apply(this,arguments)}function vS(){return vS=(0,_._)((function(e,t){var n,i,r,o,a,s,u,c,l,d,h=arguments;return(0,F.Jh)(this,(function(f){switch(f.label){case 0:i=(n=h.length>2&&void 0!==h[2]?h[2]:{}).isCertTrusted,r=n.isCertTrustedRoot,o=t.getName(),a={},s={},f.label=1;case 1:return f.trys.push([1,5,,6]),[4,hS(e,t,i,r)];case 2:return u=f.sent(),[4,t.Verify(u)];case 3:return a=f.sent(),[4,t.getDigitalSignatureInfo(u.trustedCertificateList,!1)];case 4:return s=f.sent(),[3,6];case 5:return c=f.sent(),console.error(c),a={},s={},[3,6];case 6:return(l=a[o]?a[o]:{}).checkTime=Ge(new Date,"YYYY.MM.DD HH:mm:ssZ",{separator:"'",suffix:"'"}),d=(0,k._)({},t.signatureInfo,s,l),t.signatureInfo&&t.signatureInfo.status===WA.NotYetVerified&&(t.signatureInfo.status=WA.Verified,d.status=WA.Verified),[2,{name:o,signatureInfo:d}]}}))})),vS.apply(this,arguments)}Date.now(),Math.random();const pS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US";e.endsWith("/")||(e+="/"),t=t.replace(/(\w*?)-(\w*)/,(function(e,t,n){return t+"-"+n.toUpperCase()}));return function(n,i,r){var o;return o={},(0,J._)(o,r,{Approved:{url:"".concat(e,"stamps/").concat(t,"/DynamicStamps/Approved.pdf"),fileType:"pdf"},Revised:{url:"".concat(e,"stamps/").concat(t,"/DynamicStamps/Revised.pdf"),fileType:"pdf"},Reviewed:{url:"".concat(e,"stamps/").concat(t,"/DynamicStamps/Reviewed.pdf"),fileType:"pdf"},Received:{url:"".concat(e,"stamps/").concat(t,"/DynamicStamps/Received.pdf"),fileType:"pdf"},Confidential:{url:"".concat(e,"stamps/").concat(t,"/DynamicStamps/Confidential.pdf"),fileType:"pdf"}}),(0,J._)(o,i,{Accepted:{url:"".concat(e,"stamps/").concat(t,"/SignHere/Accepted.pdf"),fileType:"pdf"},Witness:{url:"".concat(e,"stamps/").concat(t,"/SignHere/Witness.pdf"),fileType:"pdf"},SignHere:{url:"".concat(e,"stamps/").concat(t,"/SignHere/SignHere.pdf"),fileType:"pdf"},Rejected:{url:"".concat(e,"stamps/").concat(t,"/SignHere/Rejected.pdf"),fileType:"pdf"},Initial:{url:"".concat(e,"stamps/").concat(t,"/SignHere/Initial.pdf"),fileType:"pdf"}}),(0,J._)(o,n,{Approved:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Approved.pdf"),fileType:"pdf"},Void:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Void.pdf"),fileType:"pdf"},Verified:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Verified.pdf"),fileType:"pdf"},Revised:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Revised.pdf"),fileType:"pdf"},Reviewed:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Reviewed.pdf"),fileType:"pdf"},Received:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Received.pdf"),fileType:"pdf"},Final:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Final.pdf"),fileType:"pdf"},Expired:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Expired.pdf"),fileType:"pdf"},Emergency:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Emergency.pdf"),fileType:"pdf"},Draft:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Draft.pdf"),fileType:"pdf"},Confidential:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Confidential.pdf"),fileType:"pdf"},Completed:{url:"".concat(e,"stamps/").concat(t,"/StandardStamps/Completed.pdf"),fileType:"pdf"}}),o}.apply(undefined,(0,I._)(["Static","SignHere","Dynamic"]))};g(302);var mS=window.MozWebSocket||window.WebSocket,yS=function(){},kS=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.origin;(0,P._)(this,e),(0,J._)(this,"websocketServer",void 0),(0,J._)(this,"apiServer",void 0),(0,J._)(this,"messageReceiver",void 0),(0,J._)(this,"closeEventListener",void 0),(0,J._)(this,"connectStatusDefer",void 0),(0,J._)(this,"socket",void 0),this.websocketServer=t,this.apiServer=n,this.messageReceiver=yS,this.closeEventListener=yS,this.websocketServer=t.trim(),this.apiServer=n.trim()}return(0,A._)(e,[{key:"isConnected",value:function(){if(this.socket){switch(this.socket.readyState){case mS.OPEN:return Promise.resolve(!0);case mS.CLOSED:case mS.CLOSING:return Promise.resolve(!1)}return this.connectStatusDefer.promise}return Promise.resolve(!1)}},{key:"connect",value:function(e){var t,n=this;if(this.socket)switch(this.socket.readyState){case mS.CLOSED:case mS.CLOSING:break;default:this.socket.onclose=null,this.socket.close()}return this.connectStatusDefer=(0,j.createDeferred)(),this.socket=new mS(Ks(this.websocketServer,"collab-ws/ws")+"?shareId="+e),this.socket.onmessage=function(e){"\n"!==e.data&&n.messageReceiver(e.data)},this.socket.onclose=function(){n.closeEventListener(),clearInterval(t)},this.socket.onopen=function(){t=setInterval((function(){n.socket.send("\t")}),1e4),n.connectStatusDefer.resolve(!0)},this.socket.onerror=function(){n.connectStatusDefer.resolve(!1)},this.connectStatusDefer.promise}},{key:"disconnect",value:function(){return this.socket.onclose=null,this.socket.close(),Promise.resolve(!0)}},{key:"createSession",value:function(e,t){var n=this;return(0,_._)((function(){var e,i,r,o;return(0,F.Jh)(this,(function(a){switch(a.label){case 0:return e=Ks(n.apiServer,"collab-ws","share"),i=new FormData,t.type!==Sw.FROM_FILE?[3,2]:[4,t.file()];case 1:return o=a.sent(),(0,D._)(o,Blob)||(o=new Blob([o],{type:"application/pdf"})),i.append("file",o,t.options.fileName),r=JSON.stringify(t,(function(e,t){if("file"!==e)return t})),[3,3];case 2:r=JSON.stringify(t),a.label=3;case 3:return i.append("open-file-params",r),[2,fetch(e,{method:"POST",body:i}).then((function(e){return e.json()})).then((function(e){return e.shareId}))]}}))}))()}},{key:"getSessionInfo",value:function(e){return fetch(Ks(this.apiServer,"collab-ws/session/",e)).then((function(e){var t=e.headers.get("session-info");if("null"!==t&&t){var n,i=JSON.parse(decodeURIComponent(t)),r=i.openFileParams;if(r.type===Sw.FROM_FILE)r.file=function(){return n||(n=e.blob()),n};return i}}))}},{key:"send",value:function(e,t){return this.socket&&this.socket.send(t),Promise.resolve()}},{key:"getLostData",value:function(e,t){var n=Ks(this.apiServer,"collab-ws","data",e,""+t);return fetch(n).then((function(e){return e.json()}))}},{key:"registerMessageReceiver",value:function(e){this.messageReceiver=e}},{key:"registerLostConnectionListener",value:function(e){this.closeEventListener=e}},{key:"destroy",value:function(){this.socket&&this.socket.close()}}]),e}(),bS=g(8272),wS=g.n(bS),_S=function(){function e(t){(0,P._)(this,e),this.title=t,this.step=0;var n=document.createElement("div");n.innerHTML=wS()({title:t}),this.element=n.firstElementChild,n.removeChild(this.element),this.totalElement=this.element.querySelector(".fv__ui-print-process-total"),this.currentElement=this.element.querySelector(".fv__ui-print-process-current"),this.progressElement=this.element.querySelector(".fv__ui-print-process-percent")}return(0,A._)(e,[{key:"reset",value:function(){this.updateProgress(0,0)}},{key:"show",value:function(){this.reset(),document.body.appendChild(this.element)}},{key:"updateProgress",value:function(e,t){var n=this.total;this.total=t,n!==t&&(this.totalElement.innerText=t),this.step=e,this.currentElement.innerText=e,this.progressElement.style.cssText+="\n            width: ".concat(e/t*100,"%;\n        ")}},{key:"close",value:function(){document.body.removeChild(this.element)}}]),e}(),PS=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),e=t.call(this),(0,J._)((0,w._)(e),"pageRender",void 0),(0,J._)((0,w._)(e),"shapeDom",void 0),(0,J._)((0,w._)(e),"calloutShape",new Jd),(0,J._)((0,w._)(e),"startPoint",void 0),(0,J._)((0,w._)(e),"annotInfo",void 0),e.addDestroyHook((function(){e.calloutShape.hide(),e.startPoint=void 0})),e}return(0,A._)(n,[{key:"prepare",value:function(e){this.pageRender=e;var t=e.$handler.find(".fv__create-callout-canvas")[0];t?this.shapeDom=t:(this.shapeDom=document.createElement("canvas"),this.shapeDom.style.cssText+="position: absolute",this.shapeDom.classList.add("fv__create-callout-state-canvas"),e.$handler.append(this.shapeDom))}},{key:"start",value:function(e){this.startPoint=e}},{key:"update",value:function(e,t){var n;if(this.startPoint&&this.pageRender&&this.shapeDom){var i=this.pageRender,r=i.page,o=oh.calcCalloutPosition((0,k._)({start:[this.startPoint.x,this.startPoint.y],end:[e.x,e.y],page:r,width:r.getMediaWidth(),height:r.getMediaHeight(),borderStyle:{style:0},endingStyle:0,scale:i.scale,rotate:i.rotate},t||{}));if(o&&!o.invalid){var a=(null===(n=o.calloutLinePoints)||void 0===n?void 0:n.map((function(e){var t=e.x,n=e.y;return r.getDevicePoint([t,n],i.scale,i.rotate)})))||[],s=r.getDeviceRect(o.rect,i.scale,i.rotate),u=r.getDeviceRect(o.innerRect,i.scale,i.rotate);(0,j.cssText)(this.shapeDom,{left:s.left+"px",top:s.top+"px"}),this.calloutShape.init(null,this.shapeDom),this.calloutShape.show(a,s,u),this.annotInfo=o}}}},{key:"complete",value:function(){var e=this,t=this.pageRender;if(!t)return Promise.reject(new Error("[CreateFreeTextCalloutService] not prepared!"));if(!this.annotInfo)return Promise.reject(new Error("[CreateFreeTextCalloutService] Cannot create callout before mouse moved!"));this.calloutShape.hide(),this.startPoint=void 0;var n=t.pdfViewer;return t.getPDFPage().then((function(i){var r=n.getAnnotDefaultProperty("freetext","FreeTextCallout"),o=16777215;void 0!==r.fillColor&&(o=r.fillColor);var a=Object.assign({},{type:"freetext",intent:"FreeTextCallout",subject:n.i18n.t("viewer_:annotSubjects.Callout"),"interior-color":o,rotation:((360-90*i.getRotation()-t.getRotation())%360+360)%360,flags:4},e.annotInfo,r);return i.addAnnot(a)})).then((function(e){var i,r=e[0],o=null===(i=t.annotsRender)||void 0===i?void 0:i.getAnnotRender(r.getId()).component;return n.eventEmitter.emit(de.addAnnotSuccess,o.annot),e}))}}]),n}(j.Disposable),AS=2,SS=10,xS=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;(0,P._)(this,n),i=t.call(this,e);var r=e.pdfViewer.store;return i.multipage=r.getCurrentValue("multipage-"+i.constructor.getName(),AS),i.pageSpacing=r.getCurrentValue("pageSpacing-"+i.constructor.getName(),SS),i.isJump=!1,i.isCurrentViewMode=!0,i.lastCurrentPageIndex=0,i}return(0,A._)(n,[{key:"getJQItems",value:function(){return O()((0,S._)((0,x._)(n.prototype),"getItems",this).call(this))}},{key:"into",value:function(e,t){this.isCurrentViewMode=!0,(0,S._)((0,x._)(n.prototype),"into",this).call(this,e,t);for(var i=this.constructor.getName(),r="",o=1;o<=this.multipage;o++)r=o%2==0?(r=r+"."+i+" .fv__pdf-view-mode-item:nth-of-type("+this.multipage+"n +"+o+") {justify-self: start;}")+".facing-cover-continuous-view-mode."+i+" .fv__pdf-view-mode-item:nth-of-type("+this.multipage+"n +"+o+") {justify-self: end;}":(r=r+i+" .fv__pdf-view-mode-item:nth-of-type("+this.multipage+"n +"+o+") {justify-self: end;}")+".facing-cover-continuous-view-mode."+i+" .fv__pdf-view-mode-item:nth-of-type("+this.multipage+"n +"+o+") {justify-self: start;}",o%this.multipage==0&&(r=r+".facing-cover-continuous-view-mode."+i+" .fv__pdf-view-mode-item:nth-of-type("+this.multipage+"n +"+o+") {justify-self: end;}");var a=["<style>","."+i+" {","margin: 0 auto;","width: min-content;","display: grid;","grid-template-columns: repeat("+this.multipage+", 1fr);","justify-items: end;","}","."+i+".facing-cover-continuous-view-mode::before {",'content: "";',"width: calc("+100/this.multipage+"%);","}","."+i+"::after {",'content: "";',"width: -webkit-fill-available;","}","."+i+" .fv__pdf-view-mode-item {","display: -webkit-box;","display: -ms-flexbox;","display: -webkit-flex;","display: flex;","-ms-flex-pack: center;","-ms-flex-align: center;","-ms-justify-content: flex-end;","-webkit-justify-content: flex-end;","justify-content: flex-end;","align-items: center;","margin-left: 0;","}",r,"."+i+" .fv__pdf-view-mode-item {","margin-right: "+this.pageSpacing+"px;","}","."+i+" .fv__pdf-page-layout{","width: 100%;","}","</style>"].join("");this.$style=O()(a),this.docRender.$container.after(this.$style),this.docRender.$container.addClass(this.constructor.getName())}},{key:"bindScrollEvent",value:function(){var e=this;if(this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.docRender){var t=this.docRender.viewerRender.scrollWrap,n=!1,i=t.addScrollEventListener((function(){clearTimeout(e.scrollEventTimer),e.scrollEventTimer=setTimeout((function(){if(!n){var t=e.docRender;if(t){e.isJump=!1;var i=t.pagesRender;i&&i.renderVisiblePages().then((function(){t.isGoto?setTimeout((function(){e.isCurrentViewMode&&(t.isGoto=!1)}),40):t.setCurrentPageIndex(e.getCurrentPageIndex())}),(function(){}))}}}),100)}));this._unwatchScrollEvent=function(){n=!0,e._unwatchScrollEvent=function(){},i()}}}},{key:"out",value:function(){this.isCurrentViewMode=!1,this.docRender.$container.removeClass(this.constructor.getName()),this.docRender.pagesRender.$ui.removeAttr("style"),this.$style&&this.$style.remove(),this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.getJQItems().css({width:"",height:""});var e=this.docRender.pagesRender.pageRenders;for(var t in e){e[t].$ui[0].style.maxWidth=null}(0,S._)((0,x._)(n.prototype),"out",this).call(this)}},{key:"renderViewMode",value:function(e,t,n,i,r){if(this.docRender){var o=this.getMaxPageWidth(),a=this.multipage,s=(a-1)*this.pageSpacing;this.docRender.pagesRender.$ui.css({width:o*a*t+s})}}},{key:"fixMargin",value:function(e,t){var n=this.multipage,i=(n-1)*this.pageSpacing;this.docRender.pagesRender.$ui.css({width:e*n+i})}},{key:"getPagesLayout",value:function(){for(var e=this.docRender.doc.pageCache,t=e.length,n=this.multipage,i=Math.ceil(t/n),r=Array(n).fill(0),o=Array(i).fill(0),a=0;a<n;a++)for(var s=a;s<t;s+=n)r[a]=Math.max(r[a],e[s].getPxWidth());for(var u=0;u<i;u++)for(var c=0;c<n;c++)e[u*n+c]&&(o[u]=Math.max(o[u],e[u*n+c].getPxHeight()));var l=[];return e.forEach((function(e,t){l.push({width:r[t%n],height:o[Math.floor(t/3)]})})),l}},{key:"getMaxPageWidth",value:function(){var e,t=0,n=this.docRender.doc.getPageSizesSync(),i=this.docRender.getRotation();for(var r in e=90===i||270===i?"height":"width",n){var o=4*n[r][e]/3;o>t&&(t=o)}return t}},{key:"getFitHeight",value:function(e){var t=this.docRender.viewerRender.scrollWrap;return t.getHeight()-t.getScrollOffsetTop()}},{key:"getFitWidth",value:function(e){var t=this.getMaxPageWidth(),n=this.docRender.viewerRender.scrollWrap,i=this.multipage,r=getComputedStyle(this.pageDOMs[e]),o=na(r.marginLeft)+na(r.marginRight),a=(n.getWidth()-o-i*this.pageSpacing)/i,s=this.docRender.doc.getPageSize(e);s||(s=this.docRender.doc.getPageSize(0));var u=this.docRender.getRotation();return a*(s?90===u||270===u?s.height:s.width:90===u||270===u?this.getFitHeight(e):a)*4/(3*t)}},{key:"jumpToPage",value:function(e,t){var n=this,i=t.x,r=void 0===i?0:i,o=t.y,a=void 0===o?0:o;this.isJump=!0;var s=this.getJQItems();e>=s.length?e=s.length-1:e<0&&(e=0);var u=s.eq(e),c=this.docRender.viewerRender.scrollWrap.getOffsetOfPageElement(u[0]),l=c.left+r,d=c.top+a;this._unwatchScrollEvent&&this._unwatchScrollEvent(),this.docRender.viewerRender.scrollWrap.scrollTo(l,d),this.currentJumpPageIndex=e,this.docRender.setCurrentPageIndex(e),setTimeout((function(){n.isCurrentViewMode&&n.bindScrollEvent()}))}},{key:"getCurrentPageIndex",value:function(){if(this.isJump)return this.currentJumpPageIndex;if(this.docRender){for(var e,t=this.getJQItems(),n=this.docRender.viewerRender.scrollWrap,i=n.getScrollTop(),r=i+n.getHeight(),o=n.getScrollLeft(),a=o+n.getWidth(),s=[],u=0;u<t.length;u++){var c=t[u],l=O()(c).width(),d=O()(c).height(),h=c.offsetTop,f=h+d,g=c.offsetLeft,v=g+l,p=void 0;if(h<=i&&f>i&&f<=r?p=f-i:h>=i&&f<=r?p=d:h<=i&&f>=r?p=r-i:h>=i&&h<r&&f>=r&&(p=r-h),p){var m=void 0;g<=o&&v>o&&v<a?(m=v-o,s.push({index:u,area:p*m})):g>=o&&v<a?(m=l,s.push({index:u,area:p*m})):g<=o&&v>a?(m=a-o,s.push({index:u,area:p*m})):g>=o&&g<a&&v>a&&(m=a-g,s.push({index:u,area:p*m}))}}for(var y=0,k=0;k<s.length;k++)s[k].area>y&&(y=s[k].area,e=s[k].index);return void 0!==e&&(this.lastCurrentPageIndex=e),this.lastCurrentPageIndex}}},{key:"getNextPageIndex",value:function(){var e=this.docRender.doc.getPageCount(),t=this.getCurrentPageIndex();if(t<e-1){var n=this.docRender.viewerRender.scrollWrap,i=this.docRender.pagesRender.$ui.width(),r=n.getWidth()-16,o=this.multipage;if(r>=i)t=Math.ceil((t+1)/o)*o;else t++}return t>e-1&&(t=e-1),t}},{key:"getPrevPageIndex",value:function(){var e=this.getCurrentPageIndex();if(e>0){var t=this.docRender.viewerRender.scrollWrap,n=this.docRender.pagesRender.$ui.width(),i=t.getWidth()-16,r=this.multipage;if(i>=n)e=(Math.ceil((e+1)/r)-2)*r;else e--}return e<0&&(e=0),e}}],[{key:"getName",value:function(){return"multipage-view-mode"}},{key:"setMultipage",value:function(e){AS=e}},{key:"getMultipage",value:function(){return AS}},{key:"setPageSpacing",value:function(e){SS=e}},{key:"getPageSpacing",value:function(){return SS}}]),n}(ta);var CS=function(e){if("undefined"==typeof window||!window.document)return function(){throw new Error(e+".js requires a window with a document")};var t={add:function(e,n,i,r){t._eventFun=function(e){i&&i.call(r,e)},e.addEventListener(n,t._eventFun,!1)},remove:function(e,n){e.removeEventListener(n,t._eventFun,!1),t._eventFun=void 0}};Node.prototype.parents=function(e){var t=this.parentNode;return this.classList.contains(e)||"BODY"===t.nodeName?this:t.parents(e)},Node.prototype.hasChildren=function(e){for(var t=e;t;){if(this===t)return!0;t=t.parentNode}return!1};var n,i=function(e,t){if(e){var n={};if(e.dataset)n=e.dataset;else for(var i=0;i<e.attributes.length;i++){var r=e.attributes[i];if(0===r.name.indexOf("data-")){var o=r.name.replace("data-",""),a=r.value;n[o]=a}}for(var o in t){a=t[o];e.dataset?e.dataset[o]=a:e.setAttribute("data-"+o,a)}return n}};function r(t,n){var i=this;if(this.options=Object.assign({draggable:"",dragClass:e+"-drag",chosenClass:e+"-chosen",treeItemIconClass:"tree-item-icon",dragOverStrict:!0,endStrict:!0,inventedNode:null,onStart:"",onBeforeHover:"",onHover:"",onEnd:"",allowDrag:!0,excludeDraggable:"",enabled:!0,checkIsMoveToRight:function(){return!i.options.dragOverStrict&&i.end.classList.contains(i.options.treeItemIconClass)}},n),!t)throw new Error("el must be a dom node: "+t);if(!this.options.draggable)throw new Error("draggable class cannot be a empty string: "+this.options.draggable);this.options.enabled&&(this.el=t,this._bindEvent(),this._appendStyle(),this._cache={overData:[],doms:[]})}return"function"!=typeof Object.assign&&(Object.prototype.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}),r.prototype=(n={_addClass:function(e,t,n){n&&this._removeClass(t,e),e.classList.add(t)},_removeClass:function(e,t){var n=this;(e=(0,D._)(e,Array)?e:[e]).forEach((function(e){for(var i=n.el.querySelectorAll("."+e),r=0;r<i.length;r++){var o=i[r];t&&o===t||o.classList.remove(e)}}))},_initDragEvent:function(e){if(e){var t=this;e.draggable=this.options.allowDrag&&this._isEnabled(e),e.ondragstart=function(n){t._isEnabled(e)?t._onDragstart.call(t,n.target):n.preventDefault()},e.ondragover=function(n){if(e.draggable){var r=n.currentTarget;if(!1!==(t.options.onBeforeHover&&t.options.onBeforeHover({dom:r,attrs:Object.assign(i(r),{text:r.innerText.trim()})}))){var o={mouseX:Xa(n),mouseY:Za(n)};n.preventDefault(),t.options.enabled&&t._onDragover.call(t,n.target,o)}}},e.ondragenter=function(n){if(e.draggable){var r=n.currentTarget;if(!1!==(t.options.onBeforeHover&&t.options.onBeforeHover({dom:r,attrs:Object.assign(i(r),{text:r.innerText.trim()})}))){n.stopPropagation();var o={mouseX:Xa(n),mouseY:Za(n)};t.options.enabled&&t._onDragenter.call(t,n.target,o)}}},e.ondragleave=function(n){if(e.draggable){var i={mouseX:Xa(n),mouseY:Za(n)};t.options.enabled&&t._onDragleave.call(t,n.target,i)}},e.ondragend=function(n){if(e.draggable){var i={mouseX:Xa(n),mouseY:Za(n)};t.options.enabled&&t._onDragend.call(t,n.target,i)}},e.ondrop=function(n){e.draggable&&(n.stopPropagation(),n.preventDefault(),t.options.enabled&&t._onDrop.call(t,{target:n.target,files:n.dataTransfer.files,altKey:n.altKey,ctrlKey:n.ctrlKey,mouseX:Xa(n),mouseY:Za(n)}))}}},_getDragImage:function(){var e=document.createElement("img");return e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",e.width=0,e.height=0,e.opacity=0,e},_setInventedNode:function(){var e=this.options.draggable;if(this._inventedNodeClassName="_"+e,!this.el.querySelector("."+this._inventedNodeClassName)){var t=this.options.inventedNode;if(t)t.classList.add(e),t.classList.add(this._inventedNodeClassName),this._initDragEvent(t),this.el.insertBefore(t,this.el.lastChild.nextSibling);else{t=document.createElement("div");var n=this.el.querySelectorAll("."+e)[0].getBoundingClientRect();t.style.position="fixed",t.style.width=n.width+"px",t.style.height=parseInt(n.height/2)+"px",t.style.top=n.top+"px",t.style.left=n.left+"px",t.style.transform="rotateZ(180deg)",t.style.borderWidth="1px",t.style.overflow="hidden",t.style.backgroundColor="rgba(0, 0, 0, 0)",t.style.zIndex="999",i(t,{id:"-1"}),t.classList.add(e),t.classList.add(this._inventedNodeClassName),this._initDragEvent(t),this.el.insertBefore(t,this.el.childNodes[0])}}},_removeInventedNode:function(){var e=this.el.querySelector("."+this._inventedNodeClassName);e&&(e.remove?e.remove():e.removeNode(!0))},_isTopest:function(e){var t=this.el.getBoundingClientRect();return e.clientY-t.y<12},destroy:function(){t.remove(this.el,"pointerdown")},_bindEvent:function(){var e=this;t.add(this.el,"pointerdown",this.setDraggable,this);var n=function(t){var n,i;if((0,D._)(t,TouchEvent)){var r=t.changedTouches||t.touches;if(1!==r.length)return;var o=r[0];n=o.clientX,i=o.clientY}else"clientX"in t&&(n=t.clientX,i=t.clientY);return document.elementFromPoint(n,i).closest("."+e.options.draggable)};if(j.isTouchDevice&&!j.isChromebook){var r,o,a=!1,s=function(t){if(e.options.enabled){var i=n(t);if(i){r=i,o=null,a=!0,document.addEventListener("pointerup",(function(t){a=!1,e.end=o,e._onDragend()}),{once:!0,capture:!0});var s={mouseX:Xa(t),mouseY:Za(t)};e._onDragstart.call(e,i,s),t.preventDefault()}}},u=function(t){if(a){t.preventDefault();var s={mouseX:Xa(t),mouseY:Za(t)},u=n(t);if(!u)return o=u,void(e.options.onHover&&e.options.onHover({dom:u,info:s}));u!==r&&(o!==u&&(u&&(e._onDragenter.call(e,u,s),setTimeout((function(){e.end=u,e.setBlwAndBrw(u),e._addClass(u,e.options.chosenClass);var t=Object.assign(i(u),{text:u.innerText.trim()});e.options.onHover&&u!==e.from&&e.options.onHover({dom:u,attrs:t,info:s})}))),o&&e._onDragleave.call(e,o,s)),u&&u.ondragover(t)),o=u}else o=void 0};this.el.addEventListener("pointerdown",s,{capture:!0,passive:!1}),this.el.addEventListener("touchmove",u,{capture:!0,passive:!1}),this.unbindEventOnDocument=function(){e.el.removeEventListener("pointerdown",s,{capture:!0,passive:!1}),e.el.removeEventListener("mousemove",u,{capture:!0,passive:!1})}}},_appendStyle:function(){this._style=document.createElement("style"),document.head.appendChild(this._style)},setDraggable:function(e){var t;this.options.draggable.trim()&&(t=this.el.querySelectorAll("."+this.options.draggable)),t&&0!==t.length||(t=this.el.children);for(var n=0;n<t.length;n++){var i=t[n];this._initDragEvent(i)}if(this._cache.doms=t,this.options.excludeDraggable){var r=this.el.querySelectorAll("."+this.options.excludeDraggable)||[];for(n=0;n<r.length;n++){(i=r[n]).draggable=!1}}},_onDragstart:function(e,t){var n=this;setTimeout((function(){n._setInventedNode()}),0),this._addClass(e,this.options.dragClass,!0),this.end=null,this.from=e;var r=e.parents(this.options.draggable);this.fromAttrs=Object.assign(i(r),{text:r.innerText.trim()}),this.options.onStart&&this.options.onStart({dom:this.from,attrs:this.fromAttrs,info:t})},_onDragover:function(e,t){var n=this._getTarget(e);if(this.end=n,this.setBlwAndBrw(e,t),this._addClass(n,this.options.chosenClass),-1===this._cache.overData.indexOf(n)&&(this._cache.overData=[]),this._cache.overData.push(n),20===this._cache.overData.length){var r=Object.assign(i(n),{text:n.innerText.trim()});this.options.onHover&&n!==this.from&&this.options.onHover({dom:n,attrs:r})}},_onDragenter:function(e,t){var n=this._getTarget(e);this.end=n,this._addClass(n,this.options.chosenClass,!0),this.setBlwAndBrw(e,t)},_getTarget:function(e){var t=this.options.dragOverStrict?e.parents(this.options.draggable):e;return"#text"===t.nodeName&&(t=t.parentNode),t},setBlwAndBrw:function(e,t){var n=this.options.checkIsMoveToRight(e,t);n?(this.end.style.setProperty("--blw","0"),this.end.style.setProperty("--brw","2px")):(this.end.style.setProperty("--blw","2px"),this.end.style.setProperty("--brw","0")),this.isMoveToRight=n},_onDragleave:function(e){this._removeClass(this.options.chosenClass),this.end=null,this._cache.overData=[],this.options.onHover&&this.options.onHover({dom:null})},_onDrop:function(e){var t=e.target,n=e.files,r=e.altKey,o=e.ctrlKey,a=this.end,s=a&&a.parents(this.options.draggable),u=s&&Object.assign(i(s),{text:s.innerText.trim()}),c=this.isMoveToRight;this.options.onDrop&&this.options.onDrop({endAttrs:u,dragFiles:n,isMoveToRight:c,target:t}),t.querySelector("."+this.options.chosenClass)||(this.end.altKey=r,this.end.ctrlKey=o)},_onDragend:function(){this._cache.overData=[],this._removeClass([this.options.chosenClass]),this._removeInventedNode();var e=this.end,t=e&&e.parents(this.options.draggable),n=t&&Object.assign(i(t),{text:t.innerText.trim()});t===this.from&&this.options.endStrict||this.options.onEnd&&this.options.onEnd({from:this.from,fromAttrs:this.fromAttrs,end:e,endAttrs:n,isMoveToRight:this.isMoveToRight})},destory:function(){t.remove(this.el,"pointerdown"),document.head.removeChild(this._style),this._cache.doms.forEach((function(e){e.removeAttribute("draggable"),e.ondragstart=null,e.ondragover=null,e.ondragenter=null,e.ondragleave=null,e.ondragend=null,e.ondrop=null})),this._cache=null}},(0,J._)(n,"destroy",(function(){this.options.enabled&&this.destory()})),(0,J._)(n,"_isEnabled",(function(e){return this.options.enabled&&(!e||!("true"===e.getAttribute("disabled-drag")))})),n),r.create=function(e,t){return new r(e,t)},r.version="1.0.0",r}("Draggable");const DS=CS;const ES={cipherNone:0,cipherRC4:1,cipherAES:2};const IS={ZoomXYZ:"ZoomXYZ",ZoomFitPage:"ZoomFitPage",ZoomFitHorz:"ZoomFitHorz",ZoomFitRect:"ZoomFitRect"},RS={ThreadAction:no,ResetFormAction:zr,URIAction:Nr,JavaScriptAction:Yr,HideAction:Qr,GoToAction:Zr,SubmitFormAction:Kr,LaunchAction:jr,ImportDataAction:Jr,NamedAction:Hr,SetOCGStateAction:io,ActionFactory:oo,ZoomMode:IS};var TS=function(){function e(t){(0,P._)(this,e),this.engine=t,this.api=t.api}return(0,A._)(e,[{key:"combineFormsToCSV",value:function(e,t){return this.api.combineFormsToCSV(e,t)}},{key:"destroy",value:function(){this.engine=null,this.api=null}}]),e}();const FS=TS;var MS,OS=function(){function e(t){(0,P._)(this,e),(0,J._)(this,"pdfRect",{left:0,right:0,top:0,bottom:0}),(0,J._)(this,"deviceRect",{left:0,right:0,top:0,bottom:0}),(0,J._)(this,"pdfViewer",void 0),(0,J._)(this,"page",void 0),(0,J._)(this,"pageRender",void 0),(0,J._)(this,"scale",void 0),(0,J._)(this,"rotate",void 0),(0,J._)(this,"intent",void 0),(0,J._)(this,"annotationInfo",this.getDefaultAnnotInfo()),(0,J._)(this,"eContainer",document.createElement("div")),(0,J._)(this,"renderer",void 0),this.eContainer.classList.add("fv__viewer-fake-annot-container"),this.pdfViewer=t.pdfViewer,this.pageRender=t.pageRender,this.intent=t.info.intent,(0,j.extendOptions)(this.annotationInfo,t.info,this.getDefaultAnnotConfig()),this.annotationInfo.type=this.getType(),this.page=t.pageRender.page,this.scale=t.pageRender.scale,this.rotate=t.pageRender.rotate,this.pageRender.$annotsContainer.append(this.eContainer)}return(0,A._)(e,[{key:"setRect",value:function(e){this.deviceRect=e;var t=Math.abs(e.right-e.left),n=Math.abs(e.bottom-e.top),i=(0,U.F2)(this.annotationInfo.borderInfo.width)*this.scale*2;if(t<i){var r=.5*(i-t)*(e.right-e.left>0?1:-1);e.right+=r,e.left-=r}if(n<i){var o=.5*(i-n)*(e.bottom-e.top>0?1:-1);e.top-=o,e.bottom+=o}t=Math.abs(e.right-e.left),n=Math.abs(e.bottom-e.top);var a=this.pageRender.rotate;this.pdfRect=this.page.reverseDeviceRect(e,this.scale,a),(0,j.cssText)(this.eContainer,{left:e.left+"px",top:e.left+"px",width:t+"px",height:n+"px"})}},{key:"setContent",value:function(e){this.annotationInfo.content=e,this.annotationInfo.contents=e}},{key:"zoomTo",value:function(e){this.scale=e}},{key:"draw",value:function(){this.renderer||(this.renderer=this.generateApRenderer(),this.renderer.prepare(),this.renderer.willRender()),this.renderer.component&&this.renderer.render(this.scale,this.rotate)}},{key:"getContainerElement",value:function(){return this.eContainer}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.pdfViewer.getSmartScale(e),i=this.getDeviceRect(e,t),r=this.getOuterDeviceRect(e,t),o=this.getDeviceRect(n,t);return{annotInfo:this.annotationInfo,annotFlag:new mo(this.annotationInfo.flags),smartScale:n,rect:r,outerDeviceRect:r,innerDeviceRect:i,engineRenderingRect:o,scale:e,rotate:t,page:this.page}}},{key:"getDeviceRect",value:function(e,t){return this.page.getDeviceRect(this.pdfRect,e,t)}},{key:"getOuterDeviceRect",value:function(e,t){var n=this.annotationInfo.borderInfo;if(n&&5===n.style){var i=this.pageRender.getContainerVisibleRect(),r=i.right-i.left,o=i.bottom-i.top,a=this.page.getDeviceRect(this.pdfRect,e,t),s=(r-(a.right-a.left))/2,u=(o-(a.bottom-a.top))/2;return{left:a.left-s,right:a.right+s,top:a.top-u,bottom:a.bottom+u}}return this.page.getDeviceRect(this.pdfRect,e,t)}},{key:"apply",value:function(){var e,t=this;null===(e=this.renderer)||void 0===e||e.afterRender();var n=this.getCreationJSON();return n.endingStyle&&(n.endStyle=n.endingStyle,delete n.endingStyle),n.rect=this.pdfRect,this.page.addAnnot(n).then((function(e){var n=t.pdfViewer.addEventListener("renderAnnotSuccess",(function(){t.destroy(),n()})),i=e[0];return t.pageRender.annotsRender.activeAnnot(i.getId()),t.pdfViewer.eventEmitter.emit(de.addAnnotSuccess,i),e}))}},{key:"destroy",value:function(){var e;null===(e=this.renderer)||void 0===e||e.destroy(),this.getContainerElement().remove()}},{key:"getCreationJSON",value:function(){return this.annotationInfo}},{key:"getDefaultAnnotInfo",value:function(){return{borderInfo:{width:2,style:me.SOLID},color:16711680,opacity:1,flags:4,date:new Date}}},{key:"getDefaultAnnotConfig",value:function(){var e=this.pdfViewer.getDefaultAnnotConfig();return"function"==typeof e?e(this.getType(),this.getIntent()):{}}},{key:"getIntent",value:function(){return this.intent}}]),e}(),LS=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"getTileConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=this.pdfViewer.getSmartScale(e),i=this.pdfViewer.config.tileSize,r=this.page.getDeviceRect(this.pdfRect,1,t),o=this.page.getDeviceRect(this.pdfRect,n,t),a=o.right-o.left,s=o.bottom-o.bottom;return[Math.ceil(s/i),Math.ceil(a/i),a,s,i,n,e,t,r.left,r.top]}},{key:"getRenderingData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scale,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return Object.assign(i,{opacity:this.annotationInfo.opacity,tileConfig:this.getTileConfig(e,t)})}}]),n}(OS),NS=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"getType",value:function(){return"square"}},{key:"generateApRenderer",value:function(){return new al(this)}}]),n}(LS),VS=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"getType",value:function(){return"circle"}},{key:"generateApRenderer",value:function(){return new fl(this)}},{key:"apply",value:function(){var e=this;return(0,S._)((0,x._)(n.prototype),"apply",this).call(this).then((function(t){return"CircleDimension"===e.annotationInfo.intent?e.page.getMeasureScaleRatio().then((function(n){if(n&&n.scale){var i=e.pdfViewer.getStore().getCurrentValue("measurementData"),r=kc(e.pdfViewer),o=Oi(i.displayUnit.name)?e.pdfViewer.i18n.t("measurement.units.".concat(i.displayUnit.name)):i.displayUnit.name;return t[0].setContent(r+parseFloat(i.area).toFixed(2)+" sq "+o).then((function(e){return t}))}return t})):t}))}}]),n}(LS),BS=function(){function e(){(0,P._)(this,e),(0,J._)(this,"eventEmitter",new Bs.EventEmitter),(0,J._)(this,"isClosed",!1)}return(0,A._)(e,[{key:"getSpace",value:function(e){return[e.id,e.feature].join(".")}},{key:"getAll",value:function(e){var t=this;return(0,_._)((function(){var n;return(0,F.Jh)(this,(function(i){return n=t.getSpace(e),[2,t.getSpaceKeys(e).reduce((function(e,t){var i=t.slice(n.length+1),r=localStorage.getItem(t);return e[i]=r?JSON.parse(r):null,e}),{})]}))}))()}},{key:"get",value:function(e,t){var n=this;return(0,_._)((function(){var i,r;return(0,F.Jh)(this,(function(o){return i=n.generateUniqueKey(e,t),(r=localStorage.getItem(i))?[2,JSON.parse(r)]:[2,null]}))}))()}},{key:"set",value:function(e,t,n){var i=this;return(0,_._)((function(){var r,o,a,s;return(0,F.Jh)(this,(function(u){return null==n?[2]:(r=i.generateUniqueKey(e,t),o=localStorage.getItem(r),a=o?JSON.parse(o):void 0,s=JSON.stringify(n),o===s||(localStorage.setItem(r,s),i.emitChangeEvent({context:e,key:t,oldValue:a,newValue:n})),[2])}))}))()}},{key:"removeAll",value:function(e){var t=this;return(0,_._)((function(){return(0,F.Jh)(this,(function(n){return t.getSpaceKeys(e).forEach((function(n){var i=localStorage.getItem(n);localStorage.removeItem(n),localStorage.getItem(n)!==i&&t.emitRemoveEvent({context:e,key:n})})),[2]}))}))()}},{key:"remove",value:function(e,t){var n=this;return(0,_._)((function(){var i,r;return(0,F.Jh)(this,(function(o){return i=n.generateUniqueKey(e,t),r=localStorage.getItem(i),localStorage.removeItem(i),localStorage.getItem(i)!==r&&n.emitRemoveEvent({context:e,key:t}),[2]}))}))()}},{key:"onChange",value:function(e){return this.addEventListener("change",e)}},{key:"onRemove",value:function(e){return this.addEventListener("remove",e)}},{key:"close",value:function(){this.isClosed=!0}},{key:"addEventListener",value:function(e,t){var n=this,i=function(e){t(e)};return this.eventEmitter.addListener(e,i),function(){n.eventEmitter.removeListener(e,i)}}},{key:"generateUniqueKey",value:function(e,t){return[this.getSpace(e),t].join(".")}},{key:"getSpaceKeys",value:function(e){var t=this.getSpace(e)+".";return Array(localStorage.length).fill(0).map((function(e,t){return localStorage.key(t)})).filter((function(e){return!!e})).filter((function(e){return 0===e.indexOf(t)}))}},{key:"emitChangeEvent",value:function(e){this.eventEmitter.emit("change",e)}},{key:"emitRemoveEvent",value:function(e){this.eventEmitter.emit("remove",e)}}]),e}();!function(e){e.ICON_CLASS="icon-class",e.IMAGE_URL="image-data-uri",e.CANVAS="canvas",e.NONE="none"}(MS||(MS={}));var jS=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){var e;return(0,P._)(this,n),e=t.call(this),(0,J._)((0,w._)(e),"element",void 0),(0,J._)((0,w._)(e),"_isVisible",!1),e.element=document.createElement("div"),e.element.classList.add("fv__viewer-portfolio-previewer"),e}return(0,A._)(n,[{key:"isVisible",get:function(){return this._isVisible}},{key:"getThumb",value:function(e,t){var n=t.fileName,i="fv__icon-portfolio-file",r=n?n.match(/.*\.(.+$)/):void 0,o=r?r[1]:void 0;return o&&(i=i+" fv__icon-portfolio-ext-"+o),Promise.resolve({type:"icon-class",data:i})}},{key:"toggleVisibility",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];"boolean"!=typeof e?this.toggleVisibility(!this._isVisible):(this.element.classList.toggle("portfolio-hidden",!e),this._isVisible=e)}}]),n}(j.Disposable),US=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,J._)((0,w._)(i),"pdfViewer",void 0),(0,J._)((0,w._)(i),"previewerPDFViewer",void 0),(0,J._)((0,w._)(i),"currentFileId",void 0),(0,J._)((0,w._)(i),"executor",void 0),i.pdfViewer=e,i.currentFileId=void 0,i.executor=new j.QueuedAsyncTaskExecutor,e.eventEmitter.on(de.renderFileSuccess,(function(){i.initPDFViewer()})),i}return(0,A._)(n,[{key:"accept",value:function(e,t){return new Promise((function(t,n){var i=new FileReader;i.onload=function(){t("%PDF"===i.result)},i.onerror=function(e){return n(e)},i.readAsText(e.slice(0,4))}))}},{key:"initPDFViewer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{customs:{}};if(this.previewerPDFViewer)return this.previewerPDFViewer;var n=this.pdfViewer;if("JR"!==n.config.engineMode)throw new Error("Unsupported engine mode!");t.customs=Object.assign({},{isSupportFileType:n.$constructorOptions.customs.isSupportFileType,ScrollWrap:IA.create(this.element),getDocPermissions:function(){return 0},getAnnotPermissions:function(){return Promise.resolve([])}},t.customs);var i=Object.assign({},n.$constructorOptions,{defaultAnnotConfig:null,eventEmitter:new Bs.EventEmitter,defaultKeyboardEventBinder:Lo,collaboration:{enable:!1},enableJS:!1,enableShortcutKey:!1,viewerUI:new HS(n.viewerUI),applicationContext:new j.ApplicationContextImpl},t),r=i.jr;r.readyWorker&&(r.readyWorker=r.readyWorker.clone());var o=new RP(i),a=document.createElement("div");return a.className="fv__viewer-portfolio-pdf-previewer-container",o.init(a),this.element.appendChild(a),this.previewerPDFViewer=o,this.addDestroyHook((function(){e.element.removeChild(a),o.destroy()})),o}},{key:"redraw",value:function(){var e=this;this.executor.exec((function(){var t=e.previewerPDFViewer;return t&&t.getCurrentPDFDoc()?t.redraw():Promise.resolve()}))}},{key:"preview",value:function(e,t){var n=this,i=this.initPDFViewer();return this.currentFileId=t.handle,this.executor.exec((function(){return n.openFile(t,i,e)})),function(){return n.currentFileId=void 0,n.executor.exec((function(){return i.close()}))}}},{key:"openFile",value:function(e,t,n){var i={fileName:e.fileName,isRenderOnDocLoaded:!0};"isRenderOnDocLoaded"in e&&(i.isRenderOnDocLoaded=e.isRenderOnDocLoaded);var r=this.pdfViewer.viewerUI;return t.openPDFByFile(n,i).catch((function(e){return o(e,i)}));function o(e,t){switch(e.error){case Je.password:return a(e.pdfDoc,t,{type:Sw.FROM_FILE,fileName:t.fileName,file:n,options:t});case Je.format:r.alert("alert.formatError");break;case Je.securityHandler:r.alert("alert.securityError");break;case Je.certificate:r.alert("dialog.openFileFailed.errCertificate");break;default:return r.alert("alert.openFailed"),Promise.reject(e)}}function a(e,n,i){var s,u;return(n.password||"")&&(s="error",u="retry.invalidPassword"),r.promptPassword("","retry.inputPassword","retry.Password","body",s,u).then((function(r){return r?(n.password=r,t.reopenPDFDoc(e,n,i).catch((function(e){o(e,n)}))):a(e,n,i)}),(function(e){if(e)throw e}))}}},{key:"getThumb",value:function(e,t){if("number"!=typeof this.currentFileId&&this.currentFileId!==t.handle)return(0,S._)((0,x._)(n.prototype),"getThumb",this).call(this,e,t);if(!this.previewerPDFViewer)return(0,S._)((0,x._)(n.prototype),"getThumb",this).call(this,e,t);var i=this.previewerPDFViewer.getCurrentPDFDoc();return i?i.getPageByIndex(0).then((function(e){return e.getThumb(0).then((function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");if(e.buffer){var i=new(Uint8ClampedArray||Uint8Array)(e.buffer),r=n.createImageData(e.width,e.height);return r.data.set(i),n.putImageData(r,0,0),{type:MS.CANVAS,data:t}}if(e.image){var o=new Image;return o.onload=function(){URL.revokeObjectURL(o.src),n.drawImage(o,0,0)},o.src=URL.createObjectURL(e.image),{type:MS.CANVAS,data:t}}}))})):(0,S._)((0,x._)(n.prototype),"getThumb",this).call(this,e,t)}}]),n}(jS),HS=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;return(0,P._)(this,n),i=t.call(this),(0,J._)((0,w._)(i),"origin",void 0),(0,J._)((0,w._)(i),"contextMenu",void 0),i.origin=e,i.contextMenu=new(function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(){return(0,P._)(this,n),t.apply(this,arguments)}return(0,A._)(n,[{key:"showAt",value:function(e,t){return!1}},{key:"destroy",value:function(){}},{key:"disable",value:function(){}},{key:"enable",value:function(){}},{key:"onShown",value:function(){}},{key:"onHidden",value:function(){}}]),n}(Om)),i}return(0,A._)(n,[{key:"createContextMenu",value:function(){return this.contextMenu}},{key:"alert",value:function(e){return this.origin.alert(e)}},{key:"confirm",value:function(e){return this.origin.confirm(e)}},{key:"prompt",value:function(e,t,n){return this.origin.prompt(e,t,n)}},{key:"promptPassword",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i;return(i=this.origin).promptPassword.apply(i,(0,I._)(t))}},{key:"createFreeTextTooltip",value:function(){}},{key:"createAnnotTooltip",value:function(){}},{key:"createTextSelectionTooltip",value:function(e){return new zm(this.pdfViewer,e)}},{key:"destroy",value:function(){}}]),n}(Lm),WS=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;(0,P._)(this,n);return(i=t.call(this,e)).annotationInfo.dicts=Object.assign({AreaHi:"AreaHi"},i.annotationInfo.dicts||{}),i.eContainer.classList.add("fv__viewer-fake-highlight-area-annot"),i}return(0,A._)(n,[{key:"setRect",value:function(e){(0,S._)((0,x._)(n.prototype),"setRect",this).call(this,e),this.annotationInfo.coords=[this.pdfRect],this.annotationInfo.quadPoints=[{x:this.pdfRect.left,y:this.pdfRect.top},{x:this.pdfRect.right,y:this.pdfRect.top},{x:this.pdfRect.right,y:this.pdfRect.bottom},{x:this.pdfRect.left,y:this.pdfRect.bottom}]}},{key:"getDefaultAnnotInfo",value:function(){var e=(0,S._)((0,x._)(n.prototype),"getDefaultAnnotInfo",this).call(this);return e.color=16776960,e}},{key:"getDefaultAnnotConfig",value:function(){var e=this.pdfViewer.getDefaultAnnotConfig();return"function"==typeof e?e(this.getType(),"Area"):{}}},{key:"generateApRenderer",value:function(){return new rc(this)}},{key:"getType",value:function(){return"highlight"}},{key:"getCreationJSON",value:function(){return(0,b._)((0,k._)({},(0,S._)((0,x._)(n.prototype),"getCreationJSON",this).call(this)),{color:this.annotationInfo.color})}},{key:"getRenderingData",value:function(e,t){var i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t);return(0,b._)((0,k._)({},i),{coords:[i.outerDeviceRect],isArea:!0})}}]),n}(LS),YS=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i,r;((0,P._)(this,n),i=t.call(this,e),(0,J._)((0,w._)(i),"vertexes",[]),(0,J._)((0,w._)(i),"deviceVertexes",[]),(0,J._)((0,w._)(i),"lastPoint",{x:0,y:0}),i.annotationInfo.vertexes)&&(r=i.vertexes).push.apply(r,(0,I._)(i.annotationInfo.vertexes));return i.annotationInfo.vertexes=i.vertexes,i}return(0,A._)(n,[{key:"getVertexes",value:function(){return this.vertexes}},{key:"getDeviceVertexes",value:function(){return this.deviceVertexes}},{key:"addPoint",value:function(e,t){var n=(0,E._)(this.page.reverseDevicePoint([e,t],this.scale,this.rotate),2),i=n[0],r=n[1];this.vertexes.push({x:i,y:r}),this.lastPoint={x:i,y:r},this.deviceVertexes.push({x:e,y:t}),this.updateRect()}},{key:"setLastPoint",value:function(e,t){var n=this.deviceVertexes[this.deviceVertexes.length-1],i="number"==typeof e?e:n.x,r="number"==typeof t?t:n.y,o=(0,E._)(this.page.reverseDevicePoint([i,r],this.scale,this.rotate),2),a=o[0],s=o[1];this.lastPoint={x:a,y:s},this.updateRect()}},{key:"getLastPoint",value:function(){return this.lastPoint}},{key:"zoomTo",value:function(e){var t=this;this.scale!==e&&((0,S._)((0,x._)(n.prototype),"zoomTo",this).call(this,e),this.deviceVertexes=this.vertexes.map((function(n){var i=(0,E._)(t.page.getDevicePoint([n.x,n.y],e,t.rotate),2);return{x:i[0],y:i[1]}})),this.updateRect())}},{key:"removeLastPoint",value:function(){}},{key:"getRenderingData",value:function(e,t){var i=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this,e,t),r=G(this.vertexes).slice(0);return r.push(this.lastPoint),(0,b._)((0,k._)({},i),{vertexes:r})}},{key:"generateApRenderer",value:function(){return new jc(this)}},{key:"getType",value:function(){return"polyline"}},{key:"getOuterDeviceRect",value:function(e,t){return(0,S._)((0,x._)(n.prototype),"getDeviceRect",this).call(this,e,t)}},{key:"updateRect",value:function(){if(0!==this.deviceVertexes.length){var e=(0,E._)(this.page.getDevicePoint([this.lastPoint.x,this.lastPoint.y],this.scale,this.rotate),2),t={x:e[0],y:e[1]},n=t.x,i=t.y,r=t.x,o=t.y;this.deviceVertexes.forEach((function(e){n=Math.min(n,e.x),r=Math.max(r,e.x),i=Math.min(i,e.y),o=Math.max(o,e.y)}));var a=(0,U.F2)(this.annotationInfo.borderInfo.width)*this.scale*2+20;n-=a/2,i-=a/2,r+=a/2,o+=a/2,this.setRect({left:n,top:i,right:r,bottom:o})}}},{key:"apply",value:function(){var e=this;return(0,S._)((0,x._)(n.prototype),"apply",this).call(this).then((function(t){var n=e.annotationInfo.intent;return"PolygonDimension"===n||"PolyLineDimension"===n?e.page.getMeasureScaleRatio().then((function(i){if(i&&i.scale){var r=e.pdfViewer.getStore().getCurrentValue("measurementData"),o=kc(e.pdfViewer),a=Oi(r.displayUnit.name)?e.pdfViewer.i18n.t("measurement.units.".concat(r.displayUnit.name)):r.displayUnit.name;return t[0].setContent(o+parseFloat("PolyLineDimension"===n?r.perimeter:r.area).toFixed(2)+" "+a).then((function(e){return t}))}return t})):t}))}}]),n}(LS),qS=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;(0,P._)(this,n),i=t.call(this,e),(0,J._)((0,w._)(i),"isCloudy",!1);var r=i.annotationInfo;if(r.borderStyle)switch(r.borderInfo.style=r.borderStyle,r.borderStyle){case me.CLOUDY:i.annotationInfo.borderInfo.cloudIntensity=r.borderStyleParam,i.isCloudy=!0;break;case me.DASHED:i.annotationInfo.borderInfo.dashes=r.borderStyleParam}return r.borderInfo.style===me.CLOUDY?i.isCloudy=!0:i.isCloudy=!1,i}return(0,A._)(n,[{key:"setFlag",value:function(e,t){this.renderer.setFlag(e,t)}},{key:"generateApRenderer",value:function(){var e=this.isCloudy;return new Xc(this,e)}},{key:"getOuterDeviceRect",value:function(e,t){return this.isCloudy?Ra.on(this.getDeviceRect(e,t)).expand(100*e).extract():(0,S._)((0,x._)(n.prototype),"getDeviceRect",this).call(this,e,t)}},{key:"getType",value:function(){return"polygon"}}]),n}(YS),KS=we,$S=function(e){(0,C._)(n,e);var t=(0,T._)(n);function n(e){var i;(0,P._)(this,n);var r=(i=t.call(this,e)).annotationInfo;switch(i.annotationInfo.endStyle&&(r.endingStyle=i.annotationInfo.endStyle),r.intent){case ke.LINE_ARROW:r.endingStyle===KS.None&&(r.endingStyle=KS.OpenArrow);break;case ke.LINE_DIMENSION:r.startStyle===KS.None&&(r.startStyle=KS.OpenArrow),r.endingStyle===KS.None&&(r.endingStyle=KS.OpenArrow)}return r.hasCaption=r.enableCaption,r.leaderLinePoints.start=r.startPoint,i}return(0,A._)(n,[{key:"setRect",value:function(e){this.deviceRect=e;var t=Math.abs(e.right-e.left),n=Math.abs(e.bottom-e.top);t=Math.abs(e.right-e.left),n=Math.abs(e.bottom-e.top);var i=this.pageRender.rotate;this.pdfRect=this.page.reverseDeviceRect(e,this.scale,i),this.eContainer.style.cssText+="\n            width: ".concat(t,"px;\n            height: ").concat(n,"px;\n        ")}},{key:"generateApRenderer",value:function(){return new Pc(this)}},{key:"getType",value:function(){return"line"}},{key:"getStartPoint",value:function(){return this.annotationInfo.startPoint}},{key:"getEndPoint",value:function(){return this.annotationInfo.endPoint}},{key:"setEndPoint",value:function(e){var t=(0,E._)(this.page.reverseDevicePoint([e.x,e.y],this.scale,this.rotate),2),n=t[0],i=t[1];this.annotationInfo.endPoint={x:n,y:i},this.annotationInfo.leaderLinePoints.end=this.annotationInfo.endPoint;var r=this.annotationInfo.startPoint,o=r.x,a=r.y,s=(0,E._)(this.page.getDevicePoint([o,a],this.scale,this.rotate),2),u=s[0],c=s[1];this.setRect({left:u,top:c,right:e.x,bottom:e.y}),this.annotationInfo.intent==ke.LINE_DIMENSION&&this.calculateLeaderLinePoints()}},{key:"calculateLeaderLinePoints",value:function(){var e=this.getStartPoint(),t=this.getEndPoint(),n=t.y-e.y,i=t.x-e.x,r=-1/(n/i),o=Math.atan(r),a=1,s=(this.page.getRotationAngle()+this.rotate)%360;if(t.x<e.x&&t.y<e.y||t.x>e.x&&t.y>e.y)switch(s){case 180:case 270:a=-1;break;default:a=1}else switch(s){case 90:case 180:a=1;break;default:a=-1}var u=this.annotationInfo.leaderLineLength,c=a*Math.cos(o)*u,l=a*Math.sin(o)*u,d={x:e.x+c,y:e.y+l},h=t,f=this.pdfRect;f.left<d.x&&d.x<f.right&&f.bottom<d.y&&d.y<f.top?h={x:t.x+c,y:t.y+l}:(d={x:e.x-c,y:e.y-l},h={x:t.x-c,y:t.y-l}),this.annotationInfo.leaderLinePoints.start=d,this.annotationInfo.leaderLinePoints.end=h}},{key:"getRenderingData",value:function(){var e=(0,S._)((0,x._)(n.prototype),"getRenderingData",this).call(this);return(0,k._)({},e,this.annotationInfo)}},{key:"getOuterDeviceRect",value:function(e,t){var n=this.annotationInfo.leaderLinePoints.start,i=this.annotationInfo.startPoint,r=this.annotationInfo.leaderLineExtend,o=this.annotationInfo.borderInfo.width,a=Ai.convertTo(o,Ti)*this.scale,s=Math.max(Math.abs(n.x-i.x),Math.abs(n.y-i.y))+r,u=Ai.convertTo(s,Ti)*this.scale;return Ra.on(this.getDeviceRect(e,t)).expand(u+a).extract()}},{key:"getDefaultAnnotInfo",value:function(){var e={x:0,y:0},t={x:0,y:0};return(0,b._)((0,k._)({},(0,S._)((0,x._)(n.prototype),"getDefaultAnnotInfo",this).call(this)),{startPoint:e,endPoint:t,leaderLineLength:15,leaderLineExtend:5,captionOffset:{x:0,y:0},enableCaption:!1,leaderLinePoints:{start:e,end:t},leaderLineOffset:0,captionPos:_e.POS_INLINE,content:"",startStyle:nt.None,endingStyle:nt.None})}},{key:"apply",value:function(){var e=this;return(0,S._)((0,x._)(n.prototype),"apply",this).call(this).then((function(t){return"LineDimension"===e.annotationInfo.intent?e.page.getMeasureScaleRatio().then((function(n){if(n&&n.scale){var i=e.pdfViewer.getStore().getCurrentValue("measurementData"),r=kc(e.pdfViewer),o=Oi(i.displayUnit.name)?e.pdfViewer.i18n.t("measurement.units.".concat(i.displayUnit.name)):i.displayUnit.name;return t[0].setContent(r+parseFloat(i.distance).toFixed(2)+" "+o).then((function(e){return t}))}return t})):t}))}}]),n}(LS),zS=de,GS=IA,JS={Hammer:vr(),EventEmitter:js(),jQuery:O()},XS=JS,ZS={DiffColor:q_,OverlayComparisonOptionsService:z_,OverlayComparisonService:J_},QS=(0,b._)((0,k._)({},m),{browser:j.browser,receiveImageBuffer:Ns,units:o,download:Fa,createClass:j.createClass,DebounceAsyncTaskExecutor:j.DebounceAsyncTaskExecutor,ThrottleAsyncTaskExecutor:j.ThrottleAsyncTaskExecutor,QueuedAsyncTaskExecutor:j.QueuedAsyncTaskExecutor,areaSelections:l,cipherType:Zy,securityEncryptType:{Unknown:-1,None:0,Password:1,Certificate:2,FoxitDRM:3,Custom:4,RMS:5,CDRM:6},keyUsageType:{Unknown:-1,Signature:0,Encryption:1,SignatureAndEncryption:2},securityUtils:d,IndexDBCache:yh,IndexDBStore:kh,fileUtils:s,FileFormat:c,activation:e,keyboardStatus:j.keyboardStatus,getUnitByName:Oi,getClientX:Xa,getClientY:Za,DebouncePromiseQueue:fe,extendOptions:j.extendOptions,convertFromNumberToHex:j.convertFromNumberToHex,convertFromNumberToRGBA:j.convertFromNumberToRGBA,colorConvertor:j.colorConvertor,setThemeColor:j.setThemeColor,standardColorAsARGBNumber:j.standardColorAsARGBNumber,CalloutPointsReviser:oh,createDeferred:j.createDeferred,Store:j.Store,ValueStore:j.ValueStore,Disposable:j.Disposable,getAnnotThumbnail:function(e){e.endsWith("/")||(e+="/");var t="png",n=12,i=12;return{text:{url:"".concat(e,"annotThumbnail/Textbox_12.png"),type:t,width:n,height:i},freetext:{url:"".concat(e,"annotThumbnail/Typewriter_12.png"),type:t,width:n,height:i},line:{url:"".concat(e,"annotThumbnail/Line_12.png"),type:t,width:n,height:i},square:{url:"".concat(e,"annotThumbnail/Square Tool_12.png"),type:t,width:n,height:i},circle:{url:"".concat(e,"annotThumbnail/Ellipse Tool_12.png"),type:t,width:n,height:i},polygon:{url:"".concat(e,"annotThumbnail/Polygon Tool_12.png"),type:t,width:n,height:i},polyline:{url:"".concat(e,"annotThumbnail/Polygon Line Tool_12.png"),type:t,width:n,height:i},highlight:{url:"".concat(e,"annotThumbnail/Highlight Tool_12.png"),type:t,width:n,height:i},underline:{url:"".concat(e,"annotThumbnail/Underline Tool_12.png"),type:t,width:n,height:i},squiggly:{url:"".concat(e,"annotThumbnail/Squiggly Tool_12.png"),type:t,width:n,height:i},strikeout:{url:"".concat(e,"annotThumbnail/Strikeout Tool_12.png"),type:t,width:n,height:i},stamp:{url:"".concat(e,"annotThumbnail/Stamp_12.png"),type:t,width:n,height:i},caret:{url:"".concat(e,"annotThumbnail/Caret Tool_12.png"),type:t,width:n,height:i},ink:{url:"".concat(e,"annotThumbnail/Inksig_12.png"),type:t,width:n,height:i},fileattachment:{url:"".concat(e,"annotThumbnail/AttachAnnot_12.png"),type:t,width:n,height:i}}},getRanges:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=[];return t.forEach((function(e){"number"==typeof e?i.push(e):i=i.concat(function(e,t){for(var n=[],i=e;i<=t;i++)n.push(i);return n}(e[0],e[1]))})),Array.from(new Set(i))},DebounceTaskExecutor:j.DebounceTaskExecutor,debounce:j.debounce,eraser:h,observeResize:j.observeResize,throttle:function(e){var t,n,i,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=0,u=function(){s=!1===a.leading?0:Date.now(),t=null,r=e.apply(n,i),t||(n=i=null)};function c(){var c=Date.now();s||!1!==a.leading||(s=c);var l=o-(c-s);return n=this,i=arguments,l<=0||l>o?(t&&(clearTimeout(t),t=null),s=c,r=e.apply(n,i),t||(n=i=null)):t||!1===a.trailing||(t=setTimeout(u,l)),r}return c.cancel=function(){clearTimeout(t),s=0,t=n=i=null},c},Draggable:DS,BuiltinIntersectionObserver:j.BuiltinIntersectionObserver,getDefaultStamps:pS,Color:j.Color,isEditableElement:j.isEditableElement,attachContextMenuEvent:j.attachContextMenuEvent,eventPath:j.eventPath,createFocusEvent:j.createFocusEvent,dpr:j.dpr,getDPI:j.getDPI,resolvePath:$s}),ex={CreateFreeTextCalloutService:PS},tx={Log_Levels:j.Log_Levels,LEVELS:j.Log_Levels,setLogLevel:j.setLogLevel,LoggerFactory:j.LoggerFactory},nx={IStateHandler:Ha,HandStateHandler:ys,StateHandlerConsts:r,StateHandlerUtils:{getDevicePagePoint:Qa,deltaDeviceRect:Ya,appendSelectMark:function(e,t){$a(e);for(var n=O()(document.createDocumentFragment()),i=0,r=t.length;i<r;i++){var o=t[i],a=["top:"+o.top+"px","left:"+o.left+"px","width:"+(o.right-o.left)+"px","height:"+(o.bottom-o.top)+"px"].join(";");n.append('<mark class="'+qa+'" style="'+a+'"></mark>')}e.append(n)},removeSelectMark:$a,getBoundingPoint:Wa,getCaretRectAndRotate:za,removeTextSelectedRangeMark:Ga,showTextSelectedRangeMark:Ja},CreateMeasurementService:Gi},ix={IViewMode:ta,UsualViewModeShortcutHandler:Gs,ViewModeShortcutHandler:Qo,MultipageViewMode:xS},rx={ProgressComponent:ty,IFloatingTooltip:Nm,IViewerUI:Lm,IContextMenu:Om,TinyViewerUI:oy,TinyFloatingTooltip:zm,TextSelectionTool:jm},ox={Activatable:X,CustomOptionsUpdater:iP,ScrollWrap:ja,PDFViewerRendering:V,PDFDocRendering:da,PDFPageRendering:H,ProgressComponent:ty,TextSelectionTool:jm},ax=rx,sx={constant:Object.assign({Cipher_Type:ES,User_Permissions:Qt,DataEvents:le,AnnotUpdatedType:en,ZoomMode:IS},n),actions:RS,bookmark:{BookmarkRelationship:Qy,BookmarkZoomMode:ek},common:{FileSpec:Vr},annots:{constant:{Annot_Flags:tn,Annot_Type:Hi,Annot_Unit_Type:ki,MARKUP_ANNOTATION_STATE:ve},AnnotFlag:mo},form:{constant:{Field_Flag:vn,Field_Type:gn}},HeaderFooter:dk,DataEvents:le,Error_Code:Je,engine:{GraphicsObject:hy},Matrix:nn.Z,comparison:{},PDFPageBatchProcessor:Oy},ux={ViewerEvents:zS,STATE_HANDLER_NAMES:r,ANNOTATION_PERMISSION:ld,OPEN_FILE_TYPE:Sw,SNAP_MODE:fc,PagePointType:Yo,PROGRESS_STATUS:Rm},cx={BuiltinShortcutContext:bo,BuiltinCommand:ko,BuiltinShortcutCommand:ko,Keyboard:j.KeyboardImpl,KeyboardUtils:j.KeyboardUtils,Shortcut:j.Shortcut,interceptors:j.interceptors},lx={COLLABORATION_ACTION:yo,WebSocketCommunicator:kS},dx={PrintProgress:_S},hx=Z,fx={consts:{ADD_FONT_MAP_LIST:v_},shared:{Lazy:j.Lazy,attachKeypressEvent:j.attachKeypressEvent,preventFastClickByKeydown:j.preventFastClickByKeydown,createClickEvent:j.createClickEvent,stopPropagationOnShortcutEvent:j.stopPropagationOnShortcutEvent,IoCScope:j.IoCScope},form:{CFR_Utils:pa}},gx={PDFPageRender:Xo,PDFDocRender:Ba,annotsRender:{AnnotRender:re,ViewerAnnotManager:dg}},vx={BookmarkDataService:dP};window.PDF=sx})(),v})()));