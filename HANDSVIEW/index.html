<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ferramentas de esquema manual BVR</title>
  
  <script src="https://bvrhandschematic.web.app/P5js/p5.js"></script>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #ffffff00;
    }

    canvas {
      z-index: 1;
      max-width: 100%;
      height: auto;
      display: block;
      margin: auto;
    }

    #controls {
      position: fixed;
      top: 0;
      right: 0;
      z-index: 1000;
      background: #808080;
      padding: 5px;
      border: 3px solid #808080;
      display: flex;
      flex-direction: row;
      align-items: center;
    }

    #controls button, #controls input {
      margin: 0px 2px;
      padding: 0px;
      width: 20px;
      height: 20px;
      font-size: 8px;
      cursor: pointer;
      text-align: center;
      border: 2px solid #000000;
      background-color: #ffffff;
      color: rgb(0, 0, 0);
      border-radius: 0%;
      transition: background-color 0.3s, transform 0.2s;
    }

    #controls button:hover {
      background-color: rgb(56, 56, 56);
      color: rgb(255, 0, 0);
      transform: scale(1.1);
    }

    #controls input {
      min-width: 250px;
      font-size: 18px;
      border-radius: 3px;
      background-color: #b9b9b9;
      border: #ffe600 2px solid;
      color: rgb(0, 0, 0);
      text-align: center;
    }

    button img {
      width: 20px;
      height: 20px;
      object-fit: contain;
      border: none;
      outline: none;
      display: block;
    }

    #voltageDisplay {
     position: fixed;
      top: 0;
      left: 0;
      width: 200px;
      height: 140px;
      background: url('https://bizoonydb.github.io/PDFJS/db/MULT2.jpg') no-repeat center center;
      background-size: cover;
      padding: 10px;
      font-family: sans-serif;
      font-size: 40px;
      color: #424242;
      z-index: 100;
      display: flex;
      border-right: #ffe600 2px solid;
      align-items: center;
      justify-content: center;
      text-align: left;
    }

    #pinDisplay {
      position: fixed;
      top: 160px;
      left: 0;
      width: 200px;
      border-right: #ffe600 2px solid;
      border-bottom: #ffe600 2px solid;
      height: 70px;
      background: url('https://bizoonydb.github.io/PDFJS/db/painel2.jpg') no-repeat center center;
      background-size: cover;
      padding: 10px;
      font-family: sans-serif;
      font-size: 18px;
      color: #48ff00;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: left;
    }
  #netInput {
  display: none;
}

  </style>
</head>

<body>
  <div id="voltageDisplay"></div>

  <div id="controls">
    <datalist id="componentList"></datalist>
    <input id="searchComponent" type="text" placeholder="Buscador" list="componentList">

    <button id="btnToggle">2D</button>

    <button id="btnToggleTraces" title="Esconder pistas">
      <img src="https://bvrhandschematic.web.app/Icons/lineas visible.png" alt="Esconder pistas">
    </button>

    <button id="btnZoomIn" title="Ampliar">
      <img src="https://bvrhandschematic.web.app/Icons/zoom.png" alt="Ampliar">
    </button>

    <button id="btnZoomOut" title="Remover">
      <img src="https://bvrhandschematic.web.app/Icons/zoom+.png" alt="Remover">
    </button>

    <button id="btnTop" title="PRINCIPAL">
      <img src="https://bvrhandschematic.web.app/Icons/top.png" alt="PRINCIPAL">
    </button>

    <button id="btnBottom" title="FUNDO">
      <img src="https://bvrhandschematic.web.app/Icons/botton.png" alt="FUNDO">
    </button>

    <button id="btnAll" title="A+B">
      <img src="https://bvrhandschematic.web.app/Icons/top mas bottom.png" alt="A+B">
    </button>

    <button id="btnNextNet" title="PRÓXIMO PIN">
      <img src="https://bvrhandschematic.web.app/Icons/next pin.png" alt="Próximo PIN">
    </button>

    <button id="btnRotate" title="Girar">
      <img src="https://bvrhandschematic.web.app/Icons/girar.png" alt="Girar">
    </button>

    <button id="flipButton" title="Espelho">
      <img src="https://bvrhandschematic.web.app/Icons/espejo.png" alt="Espelho">
    </button>

    <button id="btnResize" title="Ajustar tela">
      <img src="https://bvrhandschematic.web.app/Icons/ajustar canvas.png" alt="Ajustar tela">
    </button>

    
  </div>
<input id="netInput" type="text" placeholder="malha" autocomplete="off">
    <datalist id="netList"></datalist>
  <div id="pinDisplay"></div>

<script>
  function preload() {
    let params = getURLParams();
    let fileURL = params.fileLink
      ? decodeURIComponent(params.fileLink)
      : 'https://firebasestorage.googleapis.com/v0/b/handschematic.appspot.com/o/fondos%20BVR%2F820-3437-b.bvr?alt=media&token=8de74580-2d1f-4e62-a181-a38f70791949';
    fileContent = loadStrings(fileURL);
  }
</script>

<script>
  function getParam(name) {
    const url = new URL(window.location);
    return url.searchParams.get(name);
  }

  const url = new URL(window.location);
  let param = getParam('script');

  if (!param) {
    param = 'sketch';
    url.searchParams.set('script', 'sketch');
    history.replaceState(null, '', url);
  }

  const isSketch = param === 'sketch';

  const script = document.createElement('script');
  const timestamp = Date.now();
  script.src = (isSketch ? 'sketch.js' : 'A.js') + `?t=${timestamp}`;
  document.body.appendChild(script);

  function preloadNextScript() {
    const next = isSketch ? 'A.js' : 'sketch.js';
    const link = document.createElement('link');
    link.rel = 'preload';
    link.as = 'script';
    link.href = `${next}?t=${timestamp}`;
    document.head.appendChild(link);
  }

  preloadNextScript();

  document.getElementById('btnToggle').addEventListener('click', () => {
    const newParam = isSketch ? 'A' : 'sketch';
    url.searchParams.set('script', newParam);
    window.location.href = url.toString();
  });
</script>



</body>
</html>
